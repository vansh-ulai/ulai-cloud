"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[65014],{62900:(e,t,n)=>{n.d(t,{n:()=>i});n(296540);const o={viewBox:"0 0 16 16",fittedViewBox:"2.12 3.05 11.76 9.9",directional:!0,svg:(0,n(474848).jsx)("path",{d:"M2.16 8.206q.046.13.148.236l4.32 4.32a.625.625 0 0 0 .884-.884L4.259 8.625h8.991a.625.625 0 1 0 0-1.25H4.259l3.253-3.253a.625.625 0 1 0-.884-.884l-4.32 4.32a.62.62 0 0 0-.148.648"})},i=(0,n(340498).wt)("arrowStraightLeftSmall",o)},105157:(e,t,n)=>{n.d(t,{A:()=>s});n(296540);var o=()=>n(284371),i=()=>n(398217),r=n(474848);function s(e){const{propertySchema:t,dontShowColon:n}=e,s=t.name;return(0,r.jsx)("div",{style:{display:"inline-flex",paddingTop:2},children:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"start",lineHeight:"110%",minWidth:0,fontSize:13,fill:"dark"},children:[(0,r.jsx)(i().Rl,{iconStyle:{marginTop:1},propertySchema:t,iconSize:12}),(0,r.jsx)("div",{style:{...o().RC,marginInlineStart:4,maxWidth:100},children:(0,r.jsx)("span",{children:`${s}`})}),(0,r.jsx)("span",{style:{...o().RC,marginInlineEnd:4},children:n?null:":"})]})})}},143943:(e,t,n)=>{n.d(t,{C:()=>r});var o=()=>n(726637),i=()=>n(473975);function r(e){if(!Boolean(o().A.isMobile))return!1;let t;if("discussionFormat"===e.type)t=e.format;else{if("discussionLocation"!==e.type)return!1;if("post_creator"===e.location||"mobile_post_creator"===e.location)return!1;t=(0,i().discussionLocationToDiscussionFormat)(e.location)}return t===i().DiscussionFormat.Menu||t===i().DiscussionFormat.Sidebar}},165492:(e,t,n)=>{n.d(t,{A:()=>p});n(814603),n(147566),n(198721);var o=n(296540),i=()=>n(401497),r=()=>n(718827),s=()=>n(150161),a=()=>n(252291),l=()=>n(284371),c=()=>n(496889),d=()=>n(859428),u=()=>n(473975),m=n(474848);function p({title:e,source:t,size:n,file:p,store:g,onClick:v,showBlockActionMenuButton:f}){(0,o.useEffect)((()=>()=>{"local"===(null==p?void 0:p.type)&&null!=p&&p.dataURL&&URL.revokeObjectURL(p.dataURL)}),[p]);const h=(0,i().IS)((e=>({justBackgroundHovered:{background:e.background.secondary},wrapper:{height:48,width:214,background:e.background.primary,border:`1px solid ${e.regularDividerColor}`,borderRadius:12,paddingTop:7,paddingInlineEnd:10,paddingBottom:8,paddingInlineStart:8,cursor:v?"pointer":"default"},wrapperHoveredStyle:{background:e.background.secondary},iconContainer:{height:32,width:32,minWidth:32,background:e.background.tertiaryTranslucent,borderRadius:6,display:"flex",justifyContent:"center",alignItems:"center"},fileName:{fontSize:14,fontWeight:l().Wy.medium,lineHeight:"18px",color:e.text.primary,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},fileSizeText:{fontSize:12,lineHeight:"15px",color:e.text.secondary},actionMenuHoveredStyle:{background:e.background.tertiaryTranslucent}})),[v]),y=(0,u().getIcon)(t);return(0,m.jsx)(r().Ay,{style:h.wrapper,hoveredStyle:g?h.wrapperHoveredStyle:h.justBackgroundHovered,pressedStyle:g?h.wrapperHoveredStyle:h.justBackgroundHovered,onClick:v,children:(0,m.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,m.jsx)("div",{style:h.iconContainer,children:(0,m.jsx)(a().I,{icon:y,size:"lg",colorVariant:"primary"})}),(0,m.jsx)("div",{style:{overflow:"hidden",flexGrow:1},children:(0,m.jsx)(d().A,{renderTooltip:()=>(0,m.jsx)("div",{children:e}),render:t=>(0,m.jsxs)("div",{style:{display:"flex",flexDirection:"column"},...t,children:[(0,m.jsx)("div",{style:h.fileName,children:e}),n?(0,m.jsx)("span",{style:h.fileSizeText,children:(0,u().formatFileSize)(n)}):void 0]})})}),g&&f?(0,m.jsx)(c().A,{store:g,fadeIn:!1,actionSectionGroupKey:"comment_media",hideFilterActionsInput:!0,style:{borderRadius:s().VJ.md},hoveredStyle:h.actionMenuHoveredStyle}):void 0]})})}},297813:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>o,xMarkFillIcon:()=>i});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"3.87 3.87 12.26 12.26",svg:(0,n(474848).jsx)("path",{d:"M15.869 5.369A.875.875 0 0 0 14.63 4.13L10 8.763 5.369 4.13A.875.875 0 1 0 4.13 5.37L8.763 10 4.13 14.631a.875.875 0 1 0 1.24 1.239L10 11.237l4.631 4.632a.875.875 0 1 0 1.238-1.238L11.237 10z"})},i=(0,n(340498).wt)("xMarkFill",o)},381553:(e,t,n)=>{n.d(t,{Y:()=>r});n(296540);var o=n(474848);const i={viewBox:"0 0 16 16",fittedViewBox:"2.37 2.37 11.25 11.25",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M7.053 6.407a.643.643 0 1 0 0 1.286.643.643 0 0 0 0-1.286m1.894 0a.643.643 0 1 0 0 1.286.643.643 0 0 0 0-1.286m1.893 0a.643.643 0 1 0 0 1.286.643.643 0 0 0 0-1.286M5.159 8.3a.643.643 0 1 0 0 1.287.643.643 0 0 0 0-1.286M7.053 8.3a.643.643 0 1 0 0 1.287.643.643 0 0 0 0-1.286M8.947 8.3a.643.643 0 1 0 0 1.287.643.643 0 0 0 0-1.286M10.84 8.3a.643.643 0 1 0 0 1.287.643.643 0 0 0 0-1.286m-5.681 1.894a.643.643 0 1 0 0 1.286.643.643 0 0 0 0-1.286m1.894 0a.643.643 0 1 0 0 1.286.643.643 0 0 0 0-1.286m1.894 0a.643.643 0 1 0 0 1.286.643.643 0 0 0 0-1.286"}),(0,o.jsx)("path",{d:"M4.25 2.375c-1.036 0-1.875.84-1.875 1.875v7.5c0 1.036.84 1.875 1.875 1.875h7.5c1.036 0 1.875-.84 1.875-1.875v-7.5c0-1.036-.84-1.875-1.875-1.875zm-.625 9.375V5.632h8.75v6.118c0 .345-.28.625-.625.625h-7.5a.625.625 0 0 1-.625-.625"})]})},r=(0,n(340498).wt)("viewCalendarSmall",i)},396933:(e,t,n)=>{n.d(t,{$:()=>s});var o=()=>n(56366),i=()=>n(646736),r=()=>n(617711);function s(e){const{spaceStore:t,viewedUserId:n}=e,s=(0,i().nB)(t),a=(0,i().V_)({spaceStore:t,userId:n});return(0,o().K8)((()=>(0,r().WG)({spaceStore:t,actorRole:s,viewedRole:a})),[t,s,a])}},457190:(e,t,n)=>{n.d(t,{v:()=>a});var o=()=>n(835338),i=()=>n(848259),r=()=>n(384944),s=()=>n(231297);function a(e){const{environment:t,key:n,selectedKey:a,following:l,followSettings:c,navigableBlockId:d,userId:u,spaceId:m,from:p}=e;s().createAndCommit({userAction:"UpdateSidebarFollowControl.setFollowing",environment:e.environment,canUndo:!1,perform:t=>{r().vt({environment:e.environment,table:o().Cy,args:{following:l,followSettings:c,navigableBlockId:d,userId:u,spaceId:m},inMemoryRecordCache:e.environment.defaultRecordCache.inMemoryRecordCache,transaction:t})}}),l?i().KN(t,{from:"page_updates"}):i().tm(t,{from:"page_updates"}),a!==n&&i().EV(t,{from:p,navigableBlockId:d,oldSetting:a,newSetting:n})}},465505:(e,t,n)=>{n.d(t,{P:()=>i});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"2.72 1.77 14.55 16.45",svg:(0,n(474848).jsx)("path",{d:"M10.302 1.853a.63.63 0 0 0-.604 0l-6.65 3.669c-.2.11-.323.32-.323.547v7.862c0 .228.124.437.323.547l6.65 3.67a.63.63 0 0 0 .604 0l6.65-3.67c.2-.11.323-.32.323-.547V6.069a.63.63 0 0 0-.323-.547zM3.975 7.127l5.4 2.98v6.434l-5.4-2.98zm6.65 9.414v-6.434l5.4-2.98v6.435zM15.356 6.07 10 9.024 4.644 6.069 10 3.114z"})},i=(0,n(340498).wt)("cube",o)},473975:(e,t,n)=>{n.r(t),n.d(t,{DiscussionFormat:()=>j,anyDiscussionCommentsLoading:()=>V,commentComparator:()=>L,discussionLocationToDiscussionFormat:()=>K,formatFileSize:()=>Z,getAndSortCommentStoresByTime:()=>F,getDiscussions:()=>B,getDiscussionsForSidebar:()=>T,getFirstComment:()=>E,getIcon:()=>I,getLatestRelevantComment:()=>A,getSetOfUsersInDiscussions:()=>W,hasCommentChanged:()=>N,inputIsEmpty:()=>H,isCommentAllEmojis:()=>$,lineClampForCommentCount:()=>R,sortDiscussionStoresByLatestComment:()=>U});n(898992),n(354520),n(803949),n(581454),n(737550);var o=()=>n(764880);n(296540);const i={viewBox:"0 0 20 20",fittedViewBox:"1.79 1.87 16.47 15.5",svg:(0,n(474848).jsx)("path",{d:"M9.66 1.977a.63.63 0 0 1 .785.08l2.647 2.647.08.097a.626.626 0 0 1-.866.867l-.098-.08-1.579-1.58v6.95l6.018 3.475-.577-2.155a.626.626 0 0 1 1.207-.324l.97 3.615.019.121a.625.625 0 0 1-.462.645l-3.614.967a.625.625 0 0 1-.325-1.207l2.158-.579-6.015-3.472-5.97 3.55 2.165.55.118.043a.626.626 0 0 1-.301 1.188l-.125-.02-3.627-.922a.625.625 0 0 1-.451-.76l.921-3.626a.625.625 0 0 1 1.212.308L3.4 14.52l5.98-3.554V4.008L7.8 5.588l-.099.08a.626.626 0 0 1-.786-.964l2.647-2.647z"})},r=(0,n(340498).wt)("arrow3D",i);var s=()=>n(300985),a=()=>n(575157),l=()=>n(177148),c=()=>n(251254),d=()=>n(11356),u=()=>n(435644),m=()=>n(421559),p=()=>n(973231),g=()=>n(578717),v=()=>n(916813),f=()=>n(630417),h=()=>n(811563),y=()=>n(201980),S=()=>n(496603),x=()=>n(534177),b=()=>n(939768),w=()=>n(299545),C=()=>n(448291);const k=()=>n(43371),_={doc:a().D,docx:a().D,pages:a().D,md:a().D,txt:a().D,rtf:a().D,xls:m().T,xlsx:m().T,csv:m().T,tsv:m().T,ods:m().T,pdf:n(199103).H,pptx:d().G,ppt:d().G,zip:g().p,br:g().p,bz2:g().p,gz:g().p,"7z":g().p,dmg:g().p,pkg:g().p,jar:g().p,rar:g().p,tar:g().p,xar:g().p,stl:r,obj:r,fbx:r,amf:r,iges:r,mp3:p().$,m4a:p().$,wav:p().$,aac:p().$,ogg:p().$,flac:p().$,alac:p().$,wma:p().$,mp4:c().C,m4v:c().C,gifv:c().C,webm:c().C,mkv:c().C,mov:c().C,qt:c().C,avi:c().C,wmv:c().C,asf:c().C,flv:c().C,f4v:c().C,mpeg:c().C,amv:c().C,exe:n(465505).P,otf:u().a,ttf:u().a,woff:u().a,eof:u().a,py:s().Z,java:s().Z,js:s().Z,ts:s().Z,tsx:s().Z,c:s().Z,h:s().Z,cpp:s().Z,go:s().Z,rs:s().Z,css:s().Z,php:s().Z,swift:s().Z,kt:s().Z,lua:s().Z,m:s().Z,bash_profile:s().Z,bashrc:s().Z,zshrc:s().Z,vimrc:s().Z,vim:s().Z};function I(e){const t=function(e){if(!e)return"";const{pathname:t}=b().qg(e);if(!t)return"";const n=t.split(".");return n[n.length-1]}(e).toLowerCase();return _[t]??l().Y}let j=function(e){return e[e.Menu=0]="Menu",e[e.Page=1]="Page",e[e.Sidebar=2]="Sidebar",e[e.Margin=3]="Margin",e[e.Unfurl=4]="Unfurl",e}({});function A({recordStore:e,currentUserId:t,timestamp:n}){return z({recordStore:e,currentUserId:t,timestamp:n})||E(e)}const M=6,D=3;function R(e){return e>1?D:M}function B(e){return e?w().Bw(e,{recursivelyLoadAllDiscussions:!0,includeLoadingDiscussions:!0}):[]}function T({blockStore:e,currentUserId:t,ignoreAfterTime:n}){if(!e)return[];const o=w().Bw(e,{recursivelyLoadAllDiscussions:!0,includeLoadingDiscussions:!0,includePropertyDiscussions:!0}),i=new Map;return o.forEach((e=>{const o=A({recordStore:e,currentUserId:t,timestamp:n});i.set(e.id,o)})),o.sort(((e,t)=>{const n=i.get(e.id),o=i.get(t.id);return null!=n&&n.isDefined()?null!=o&&o.isDefined()?-(n.getCreatedTime()-o.getCreatedTime()):1:-1}))}function L(e,t){return e&&e.isDefined()?t&&t.isDefined()?e.getCreatedTime()-t.getCreatedTime():1:-1}function F(e){return w().wc(e).sort(((e,t)=>L(e,t)))}function E(e){return F(e)[0]}function P(e){return z({recordStore:e,currentUserId:void 0})}function z({recordStore:e,currentUserId:t,timestamp:n}){const o=w().wc(e).filter((e=>n?e.isDefined()&&e.getCreatedTime()<n:e.isDefined())).sort(((e,t)=>L(e,t)));return o[o.length-1]}function U(e){return e.sort(((e,t)=>L(P(e),P(t))))}function H(e){const t=e.state.textStore.getValue(),n=(e.state.files??[]).length>0,o=t&&t.length>0;return!n&&!o}function N(e,t){const n=e.state.textStore.getValue(),o=e.state.files;if(!t)return n&&0!==n.length||o&&o.length>0;const i=w().gp(t).getValue();return!S().n4(i,n)||function(e,t){const n=e.state.files,o=w().dd(t);if(o.length!==n.length)return!0;return o.some(((e,t)=>e.id!==n[t].id))}(e,t)}function V(e){if(e.some((e=>!e.isReady())))return!0;return!!e.map((e=>w().wc(e))).flat().some((e=>!e.isReady()||!e.getCreatedTime()))}function K(e){switch(e){case"block_menu":case"ai_reject_all_suggestions":case"reply_menu_mentions_comments":case"reply_menu_all_updates":case"reply_menu_archive":case"reply_menu_updates_sidebar":case"updates_menu_mentions_comments":case"updates_menu_all_updates":case"updates_menu_archive":return j.Menu;case"page_discussion":case"feed_item_top_level_discussion":return j.Page;case"updates_sidebar":return j.Sidebar;case"margin_comments":case"new_discussions_sheet":return j.Margin;case"comment_unfurl":return j.Unfurl;default:(0,x().HB)(e)}}function W(e){return S().hS(S().qI(e,(e=>w().wc(e).map((e=>({store:e,pointer:e.getCreatedByPointer()}))))),(e=>{var t;return null===(t=e.pointer)||void 0===t?void 0:t.id})).filter((e=>(0,x().O9)(e.pointer))).map((({store:e,pointer:t})=>(0,C().JQ)({parentStore:e,pointer:t}))).map((e=>e.getModel())).filter(x().O9).map((e=>e instanceof h().F?(0,o().A7)(e):e instanceof f().Hj?(0,o().qt)(e):e instanceof v().T?(0,o().Mq)(e):void(0,x().HB)(e))).filter(x().O9)}function $(e){for(const n of e){if(!n.length)return!1;if(!n[1]||!n[1].some(y().nNl)){var t;const e=n[0].trim(),o=k()();if((null===(t=e.match(o))||void 0===t?void 0:t.join(""))!==e)return!1}}return!0}function Z(e){return((null==e?void 0:e.match(/[0-9.]+|[a-z]+/gi))??[]).join(" ")}},518773:(e,t,n)=>{n.d(t,{A:()=>r});var o=()=>n(835338),i=()=>n(534177);function r(e,t){switch(e){case"all":return{following:!0,followSettings:{...(0,o().JY)({explicitly_set_by_user:!0}),feed_setting:t}};case"important":return{following:!0,followSettings:{...(0,o().gK)({explicitly_set_by_user:!0}),feed_setting:t}};case"comments":return{following:!0,followSettings:{...(0,o().lx)({explicitly_set_by_user:!0}),feed_setting:t}};case"none":return{following:!1,followSettings:{...(0,o().gU)({explicitly_set_by_user:!0}),feed_setting:t}};default:(0,i().HB)(e)}}},569397:(e,t,n)=>{n.r(t),n.d(t,{arrowStraightRightSmallIcon:()=>i,iconDefinition:()=>o});n(296540);const o={viewBox:"0 0 16 16",fittedViewBox:"2.12 3.05 11.76 9.9",directional:!0,svg:(0,n(474848).jsx)("path",{d:"M9.372 3.238a.625.625 0 1 0-.884.884l3.253 3.253H2.75a.625.625 0 0 0 0 1.25h8.991l-3.253 3.253a.625.625 0 0 0 .884.884l4.32-4.32a.625.625 0 0 0 0-.884z"})},i=(0,n(340498).wt)("arrowStraightRightSmall",o)},623275:(e,t,n)=>{n.d(t,{$D:()=>c,CJ:()=>m,CY:()=>f,Sg:()=>l,iM:()=>y,kJ:()=>p,kx:()=>v,qj:()=>h,rL:()=>r,sH:()=>g,u6:()=>s,zr:()=>d});var o=()=>n(278238),i=()=>n(115512);const r=16,s=20,a=10,l=12,c=456,d=24,u=24,m=48;function p({theme:e,isMobile:t}){return{background:e.background.tertiaryTranslucent,borderRadius:8,paddingTop:8,paddingBottom:8,paddingInlineStart:8,paddingInlineEnd:8,marginInlineStart:t?0:r,marginInlineEnd:t?0:r,marginTop:4,marginBottom:8}}function g(){return{...f(),width:"unset",height:m,paddingTop:6,paddingBottom:6}}function v({environment:e}){return(0,i().ny)(e,e.device.isMobile?"UISmall":"UIRegular")}function f(){return{borderRadius:a,transition:"background 150ms ease-out"}}function h({isMobile:e}){return e?12:10}function y({theme:e,colorOverride:t,size:n=u,useLargeBorderRadius:i,useLightBackgroundColor:r,icon:s}){return{background:t||(s&&(0,o().T8)(s)?(0,o().ez)({icon:s,mode:e.mode,useLightGrayColor:r}):r?e.lightDividerColor:e.regularDividerColor),width:n,height:n,borderRadius:i?6:"0.25em"}}},640753:(e,t,n)=>{n.d(t,{A:()=>ee});n(898992),n(354520),n(803949),n(581454),n(814603),n(147566),n(198721);var o=n(296540),i=()=>n(726637),r=()=>n(484714),s=()=>n(56366),a=()=>n(401497),l=()=>n(763884),c=()=>n(69708),d=()=>n(496603),u=()=>n(284371),m=()=>n(878523),p=()=>n(319975),g=()=>n(190033),v=()=>n(231297),f=()=>n(892632),h=()=>n(38337),y=()=>n(794144),S=()=>n(693202),x=()=>n(473975),b=()=>n(363901),w=()=>n(285790),C=()=>n(859428),k=n(474848);const _=function(e){const t=(0,r().v3)(),{icon:n,onClick:o,tooltip:i,onMouseDown:s}=e,a=(0,b().A)(!0);return(0,k.jsx)(C().A,{renderTooltip:()=>i,render:e=>(0,k.jsx)(w().A,{ariaLabel:i,icon:n,iconStyle:{width:20,height:20},style:{marginInlineStart:t.device.isMobile?16:0},onClick:o,...e,...a,onMouseDown:s})})};const I=function(e){const t=(0,c().tz)(),o=(0,r().v3)(),{device:i}=o,s=(0,b().A)(!0),l=(0,a().IS)((e=>({cancelIcon:{background:e.icon.secondary,borderRadius:"50%",pointerEvents:"auto",height:20,width:20,marginInlineStart:o.device.isMobile?4:0},cancelIconHovered:{background:e.icon.tertiary}})),[o.device.isMobile]),{canSend:d,visible:u,onSend:m,onCancel:p,isEditing:g,animated:v,onMention:f,onAttach:h,sendTooltip:y}=e;return(0,k.jsx)(n(145214).A,{initial:{opacity:0},exit:{opacity:0,position:"absolute"},animate:{opacity:1},skip:!v,visible:u,style:{display:"flex",flexDirection:"column-reverse",alignItems:"end",pointerEvents:u?void 0:"none",width:"min-content"},children:(0,k.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:6},children:[(0,k.jsx)(_,{icon:n(609616).o,onClick:h,tooltip:t.formatMessage({id:"discussionInput.uploadFile.button.tooltip",defaultMessage:"Attach file"}),onMouseDown:e=>{e.preventDefault()}}),i.isMobileBrowser?void 0:(0,k.jsx)(_,{icon:n(537193).b,onClick:e=>{e.preventDefault(),f()},tooltip:t.formatMessage({id:"discussionInput.insertMention.button.tooltip",defaultMessage:"Mention a person, page, or date"}),onMouseDown:e=>{e.preventDefault()}}),g?(0,k.jsx)("div",{style:{height:14,marginInlineEnd:6},children:(0,k.jsx)(n(802790).A,{type:"vertical",size:1})}):void 0,g?(0,k.jsx)(w().A,{ariaLabel:t.formatMessage({id:"discussionInput.cancelButton.ariaLabel",defaultMessage:"Cancel editing comment"}),icon:n(66913).V,colorVariant:"primary",onClick:p,iconStyle:{fill:"white",height:o.device.isMobile?18:16,width:o.device.isMobile?18:16},style:l.cancelIcon,hoveredStyle:l.cancelIconHovered,...s}):null,g?(0,k.jsx)(w().A,{ariaLabel:t.formatMessage({id:"discussionInput.updateButton.ariaLabel",defaultMessage:"Update comment"}),icon:n(162402).q,onClick:m,colorPalette:d?"blue":void 0,colorVariant:d?"accentPrimary":"secondary",disabled:!d,iconStyle:{height:o.device.isMobile?23:21,width:o.device.isMobile?23:21},style:{pointerEvents:"auto",marginInlineStart:o.device.isMobile?16:2,height:24,width:24},...s}):(0,k.jsx)(C().A,{disableTooltip:!(0,n(534177).O9)(y),renderTooltip:()=>(0,k.jsx)(k.Fragment,{children:y}),render:e=>(0,k.jsx)(w().A,{ariaLabel:t.formatMessage({id:"discussionInput.sendButton.ariaLabel",defaultMessage:"Send comment"}),icon:n(102777).b,onClick:m,colorPalette:d?"blue":void 0,colorVariant:d?"accentPrimary":"secondary",disabled:!d,iconStyle:{height:o.device.isMobile?26:24,width:o.device.isMobile?26:24},style:{pointerEvents:"auto",marginInlineStart:o.device.isMobile?16:0,height:24,width:24},...(0,n(553965).A)(s,e)})})]})})},j=(0,c().YK)({defaultPlaceholder:{defaultMessage:"Add a comment…",id:"discussionInput.defaultPlaceholder.addComment"},pasteFileIntoCommentNotAllowed:{id:"clipboardActions.pasteFileIntoCommentError.message",defaultMessage:"Sorry, you cannot paste files into a comment."},replyInputPlaceholder:{defaultMessage:"Reply...",id:"updateSidebar.placeholder.addComment"}});var A=()=>n(304740),M=()=>n(559273),D=()=>n(360083);function R(e){const{url:t,imageNaturalHeight:n,imageNaturalWidth:i}=e,r=(0,o.useMemo)((()=>({display:"block",width:`min(${i}px, 100%)`,height:`min(${n}px, 100%)`,pointerEvents:"auto",objectFit:"cover"})),[i,n]);return(0,k.jsx)("div",{style:B,children:(0,k.jsx)(M().A,{src:t,style:r,placeholderLoadedStyle:{display:"flex",justifyContent:"center",alignItems:"center"}})})}const B={alignSelf:"center",margin:"0 auto",position:"relative",height:"100%",width:"100%",overflow:"hidden"};const T=function({file:e,isLarge:t}){const i=(0,o.useRef)(null),s=(0,r().v3)(),l=(0,a().IS)((e=>({imageThumbnail:{...{border:`1px solid ${e.border.secondary}`,borderRadius:8,cursor:"zoom-in"},...t?{objectFit:"contain",width:"auto",height:"auto",maxWidth:120,maxHeight:120,minWidth:48,minHeight:48}:{width:48,height:48}}})),[t]),c=(0,o.useCallback)((()=>{var t;const n=null===(t=i.current)||void 0===t?void 0:t.getImageDimensions();if(!n)return;const{naturalHeight:o,naturalWidth:r}=n;return"local"===e.type?(0,k.jsx)(R,{url:e.dataURL,imageNaturalHeight:o,imageNaturalWidth:r}):(0,k.jsx)(D().A,{url:e.source,render:(e,t)=>(0,k.jsx)(R,{url:t,error:e,imageNaturalHeight:o,imageNaturalWidth:r}),isAuthenticated:!0,permissionRecord:e.store.pointer})}),[e]),d=(0,o.useCallback)((e=>{var t;e.stopPropagation();const o=null===(t=i.current)||void 0===t?void 0:t.getImageDimensions();o&&n(35622).o9({environment:s,renderFullScreenNode:c,fullScreenNodeRect:o.clientRect,contentAspectRatio:o.naturalWidth/o.naturalHeight})}),[c,s]);return"local"===e.type?(0,k.jsx)(M().A,{src:e.dataURL,style:l.imageThumbnail,placeholderStyle:l.imageThumbnail,onClick:d,ref:i}):(0,k.jsx)(D().A,{url:e.source,isAuthenticated:!0,permissionRecord:e.store.pointer,render:(e,t)=>(0,k.jsx)(M().A,{src:t,style:l.imageThumbnail,placeholderStyle:l.imageThumbnail,onClick:d,ref:i})})};var L=()=>n(165492),F=()=>n(973753),E=()=>n(718827),P=()=>n(995847);function z({children:e,handleRemoveFileClicked:t}){const[n,i]=(0,o.useState)(!1),s=(0,r().v3)(),a=(0,c().tz)(),l=n||s.device.isMobile;return(0,k.jsxs)(E().Ay,{onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),style:H,hoveredStyle:N,pressedStyle:N,children:[e,l?(0,k.jsx)(w().A,{icon:P().xMarkSmallIcon,style:U,hasBackground:!0,colorVariant:"primary",hovered:!1,showShadow:!0,onClick:t,ariaLabel:a.formatMessage({id:"discussionInputAttachment.removeFileButton.label",defaultMessage:"Remove file"})}):void 0]})}const U={position:"absolute",top:-4,insetInlineEnd:-3,height:18,width:18,borderRadius:18},H={position:"relative",cursor:"pointer",width:"min-content",height:"min-content",background:"transparent"},N={background:"transparent"},V=3,K=3;function W({files:e,onRemoveFile:t}){const{images:n,nonImages:o}=(0,s().K8)((()=>{const[t,n]=d().jB(e,(e=>function(e){if("local"===e.type){const t=e.file.type,[n]=t.split("/");if("image"===n)return!0}const t=(0,A().WT)({url:"local"===e.type?e.file.name:e.source,baseUrl:i().A.domainBaseUrl,publicDomainName:i().A.publicDomainName});return"image"===t}(e)&&"local"===e.type&&e.dataURL));return{images:t,nonImages:n}}),[e]);return(0,k.jsxs)("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:4,marginTop:4},children:[(0,k.jsx)($,{files:n,onRemoveFile:t}),(0,k.jsx)(Z,{files:o,onRemoveFile:t})]})}function $(e){const{files:t,onRemoveFile:n}=e,o=(0,r().WS)(),i=(0,a().IS)((()=>({container:{display:"flex",flexDirection:"row",gap:4}})),[]);return 0===t.length?null:t.length<=V&&!o?(0,k.jsx)("div",{style:i.container,children:t.map((e=>(0,k.jsx)(z,{handleRemoveFileClicked:()=>n(e),children:(0,k.jsx)(T,{file:e,isLarge:!0})},e.id)))}):(0,k.jsx)(F().A,{children:t.map((e=>(0,k.jsx)(z,{handleRemoveFileClicked:()=>n(e),children:(0,k.jsx)(T,{file:e,isLarge:!1})},e.id)))})}function Z({files:e,onRemoveFile:t}){if(0===e.length)return null;const n=e.map((e=>{const n=e.name??"",o="remote"===e.type?e.source:n,i=e.size??"";return(0,k.jsx)(z,{handleRemoveFileClicked:()=>t(e),children:(0,k.jsx)(L().A,{title:n,source:o,size:i,showBlockActionMenuButton:!1})},e.id)}));return e.length<=K?(0,k.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:n}):(0,k.jsx)(F().A,{children:n})}const O=d().sg((e=>{n(165358).log({level:"info",from:"DiscussionInput",type:"draftCommentCreated",data:{...e,timestamp:Date.now()}})}),1e3),G=o.forwardRef((function(e,t){var b;const w=(0,r().v3)(),{device:C,currentUser:_}=w,A=(0,n(59226).X)("client_rtl_support"),{onFileUploaded:M}=e,[D,R,B]=(0,s().$y)(e.discussionInputStore),{textStore:T,files:L}=D,F=(0,s().K8)((()=>T.getValue()),[T]),[E,P]=(0,o.useState)(!1),z=(0,o.useRef)(null),{adjustWidthForDraftDiscussions:U,dontMoveCursorToInputEndOnFocus:H}=e,N=e.discussionFormat!==x().DiscussionFormat.Page;(0,o.useImperativeHandle)(t,(()=>({uploadFiles:oe})));const V=(0,s().K8)((()=>(0,n(381678)._)(w)),[w]),K=(0,o.useRef)(null===(b=e.blockStore)||void 0===b?void 0:b.clone()),$=(0,s().K8)((()=>{const e=S().default.state;return"editing"===e.mode&&(0,y().K)(e.multiSelection)&&e.multiSelection.start.store===T}),[T]),{inputIsEmptyValue:Z,inputHasNewLineCharacter:G}=(0,s().K8)((()=>({inputIsEmptyValue:(0,x().inputIsEmpty)(B),inputHasNewLineCharacter:B.hasNewLineCharacter()})),[B]),ee=$||!Z,te=(0,o.useCallback)((async()=>{const e=S().default.state;"editing"===e.mode&&(0,y().K)(e.multiSelection)&&e.multiSelection.start.store===T||((0,g().z)({store:T}),await n(908006).default.afterNextFlush())}),[T]),ne=(0,s().K8)((()=>Boolean(e.blockStore&&(0,n(337567).dL)(e.blockStore))),[e.blockStore]),oe=(0,o.useCallback)((async e=>{if(await te(),L.length+e.length>10)return void n(901389).f1((0,k.jsx)(c().sA,{id:"discussionInput.uploadFile.tooManyFilesErrorMessage",defaultMessage:"You cannot upload more than {maxFiles} files per comment.",values:{maxFiles:10}}));const t=e.map(f().x9);R({...D,files:[...L,...t]}),null==M||M()}),[te,L,R,D,M]),ie=e.discussionFormat===x().DiscussionFormat.Margin,re=e.discussionFormat===x().DiscussionFormat.Sidebar;(0,o.useEffect)((()=>{e.commentStore&&n(182034).e(B,e.commentStore)}),[B,e.commentStore]);const se=(0,o.useRef)(!1),ae=(0,o.useCallback)((t=>{t?(l().K.set({userId:_.id,key:Q(e.parentStore.id,e.inReplyToDiscussionId),value:t??null}),O({parent_id:e.parentStore.id,discussion_id:e.inReplyToDiscussionId,text_length:t.length})):l().K.remove({userId:_.id,key:Q(e.parentStore.id,e.inReplyToDiscussionId)})}),[_.id,e.inReplyToDiscussionId,e.parentStore.id]);(0,o.useEffect)((()=>{e.shouldSaveUnsentComments&&se.current&&ae(F),se.current=!0}),[e.shouldSaveUnsentComments,ae,F]);const le=(0,o.useRef)(T);(0,o.useEffect)((()=>{if(!n(263711).g.state.isOpen&&e.shouldSaveUnsentComments){const t=l().K.get({userId:_.id,key:Q(e.parentStore.id,e.inReplyToDiscussionId)});t&&v().createAndCommit({userAction:"DiscussionInput.willMount",environment:w,canUndo:!0,perform:e=>{p().R9({environment:w,store:le.current,value:t,transaction:e})}})}}),[w,_.id,e.inReplyToDiscussionId,e.parentStore.id,e.shouldSaveUnsentComments]);const ce=(0,o.useRef)(L);(0,o.useEffect)((()=>{ce.current=L}),[L]),(0,o.useEffect)((()=>()=>{ce.current&&ce.current.forEach((e=>{"local"===e.type&&e.dataURL&&URL.revokeObjectURL(e.dataURL)}))}),[]);const de=(0,o.useCallback)((({animate:e})=>{if(!K.current)return;const t=n(695625).T.findSelectableFromStore(K.current);t&&n(620689).pb({environment:w,handle:t,vertical:{reveal:"bottom"},horizontal:{reveal:"closest"},animate:e})}),[w]);(0,o.useEffect)((()=>{E&&de({animate:!0})}),[E,de]);const ue=(0,o.useCallback)((()=>{var e;return null===(e=z.current)||void 0===e?void 0:e.focus()}),[]),{autoFocus:me=!1}=e;(0,n(852507).l)((()=>{me&&ue()}));const pe=L&&L.length>0,ge=e.discussionFormat===x().DiscussionFormat.Menu&&e.inReplyToDiscussionId,ve=!e.disableFocusRing&&!ge&&(re||ie&&!e.isNewComment),fe=void 0!==e.showCtaButtons?e.showCtaButtons:e.isEditingExistingComment||ee||E,he=!e.isMobileSlideUpMenu,ye=(ie||re)&&!e.isNewComment,Se=(0,n(143943).C)({type:"discussionFormat",format:e.discussionFormat}),xe=(0,a().IS)((e=>{const t=Se?u().J.UIRegular.mobile:u().J.UIRegular.desktop;return{inputWrapper:{display:"flex",width:U?"calc(100% + 6px)":void 0,flex:U?void 0:1,minWidth:0,fontSize:t,borderRadius:6,transition:"background 300ms ease",cursor:fe?"text":"pointer",alignSelf:"center",position:"relative",flexWrap:"wrap",justifyContent:"flex-end",background:"transparent",alignItems:"center",rowGap:4,columnGap:6,paddingTop:3.5,paddingInlineEnd:4,paddingBottom:3,paddingInlineStart:4,marginTop:-3.5,marginInlineEnd:-4,marginBottom:0,marginInlineStart:-4},textFieldStyle:{fontSize:t,maxHeight:C.isMobileNative?"50vh":"70vh",WebkitOverflowScrolling:"touch",userSelect:"auto",WebkitUserSelect:"auto",lineHeight:"20px",overflow:"auto",whiteSpace:"pre-wrap",padding:"2.5px",margin:"-2.5px"},textFieldWrapper:{flexGrow:1,display:"flex",minHeight:24,paddingTop:2,width:G||i().A.isMobile?"100%":""}}}),[U,fe,C.isMobileNative,G,Se]),be=function(e){const{isEditing:t,onEditPreviousComment:o,textRef:i}=e;if(!t)return{};const r=e=>{"key"in e&&(e.metaKey||e.ctrlKey)&&i.current&&(0,n(903864).e)({store:i.current.getProps().store})},s=e=>{"key"in e&&(e.metaKey||e.ctrlKey)&&i.current&&(0,g().z)({store:i.current.getProps().store})};return{onUp:o??r,onDown:s}}({isEditing:$,shouldTrapCursorInInput:N,onEditPreviousComment:(0,s().K8)((()=>0===(T.getValue()||[]).length),[T])?e.onEditPreviousComment:void 0,textRef:z}),we=()=>{ae(void 0),e.onSubmit()},Ce=(0,k.jsx)(I,{visible:fe,onAttach:async()=>{const e=await f().dA({environment:w,supportsMobileNativeFileUpload:!0,multiple:!0});await oe(e),m().Sd(w,{type:"file_picker"})},onMention:async()=>{await te(),n(829300).Gf({environment:w,mentionTypes:{page:!0,collection:!0,heading:!0,createPage:!1,user:!0,inviteUserToWorkspace:!0,inviteUserToPage:!0,bot:!0,date:!0,reminder:!1,templateVariable:!1,group:!0,team:!0,formulaContextVariable:!1,slackSpecialMention:!1,property:!1}})},canSend:!Z&&!ne,onSend:we,onCancel:e.onCancel,isEditing:e.isEditingExistingComment||!1,animated:Boolean(ie||i().A.isMobile),inline:!0,sendTooltip:ne?(0,k.jsx)(c().sA,{id:"discussionInput.cannotSubmitBecauseOfAIEdits",defaultMessage:"Resolve pending edits before commenting"}):void 0});return(0,k.jsx)(n(998531).N,{debugName:"DiscussionInput",capture:$,onCommandEnter:d().D_,children:(0,k.jsx)(X,{enabled:Boolean(K.current)&&Boolean(e.canDrop),store:K.current,onNativeDrop:async({files:e})=>{await oe(e),m().Sd(w,{type:"drop"})},children:(0,k.jsx)("div",{className:e.isEditingExistingComment?h().d1T:h().rgg,style:{...J,...e.containerStyle||{}},onFocus:t=>{const o=t.target;var i;o instanceof HTMLElement&&(0,n(819121).p)(o)&&(null===(i=e.onFocus)||void 0===i||i.call(e),P(!0))},onBlur:t=>{var n;null===(n=e.onBlur)||void 0===n||n.call(e),P(!1)},children:(0,k.jsxs)("div",{style:q,children:[e.showAvatar?(0,k.jsx)(n(453697).A,{userStore:V,size:n(848565).eQ,avatarShouldShowShadow:!1,style:{...Y,marginTop:0,marginInlineEnd:8}}):void 0,(0,k.jsxs)("div",{className:ve?h().CCX:"",onClick:ue,style:xe.inputWrapper,tabIndex:-1,children:[(0,k.jsx)("div",{dir:A&&(0,n(209199).A1)()?"rtl":"auto",style:xe.textFieldWrapper,children:(0,k.jsx)(n(712855).A,{style:xe.textFieldStyle,store:T,parentStore:e.parentStore,disabled:!1,onChange:()=>{de({animate:!1})},onEnter:()=>{if(!i().A.isMobile)return void we();const e="editing"===S().default.state.mode&&S().default.state.multiSelection;e&&v().createAndCommit({userAction:"DiscussionInput.handleEnter",environment:w,canUndo:!0,perform:t=>{p().$D({environment:w,editorMode:"default",string:"\n",multiSelection:e,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t})}})},onCommandEnter:we,onPasteFiles:async e=>{await oe(e.files),m().Sd(w,{type:"paste"})},onEsc:e.onCancel,...be,placeholder:n(972435).A.formatMessage(ye?j.replyInputPlaceholder:j.defaultPlaceholder),ref:z,isDiscussionInput:!0,disableSlashCommands:!0,disableInsertText:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableEmbedMenu:!0,disabledMentionTypes:{reminder:!0,property:!0},disableMobileActionBar:!0,disableStyleAnnotations:C.isMobileBrowser,disableInsertedDeletedAnnotations:C.isMobileBrowser,pasteBehavior:"inline",inPageFind:n(792540).Os.none,className:"discussion-input-text-block",disableMoveCursorToEndOnFocus:H})}),pe?(0,k.jsx)(W,{files:L,onRemoveFile:e=>{const t=B.state;B.setState({...t,files:t.files.filter((t=>t.id!==e.id))})}}):void 0,Ce]}),he?(0,k.jsx)(n(594739).A,{show:$,onDismiss:()=>(0,n(749804).I)({environment:w})}):void 0]})})})})})),J={display:"flex",flexDirection:"column",width:"100%",cursor:"pointer"},q={display:"flex",alignItems:"center",flexGrow:1},Y={flexShrink:0,flexGrow:0,marginInlineEnd:6,alignSelf:"flex-start",marginTop:6};function X(e){const{enabled:t,children:o,store:i,onNativeDrop:r}=e;return t&&i?(0,k.jsx)(n(199896).Ay,{store:i,analyticsName:"discussion_input",canNativeDropOnto:!0,onNativeDrop:r,keepTextSelectionOnDrop:!0,shouldShowDropZone:!0,children:o}):(0,k.jsx)(k.Fragment,{children:o})}function Q(e,t){return t?`UnsentDiscussion-${e}-${t}`:`UnsentDiscussion-${e}`}const ee=o.memo(G)},789557:(e,t,n)=>{n.d(t,{DZ:()=>F,E3:()=>R,JO:()=>L,L6:()=>T,QA:()=>M,Tu:()=>D,lV:()=>B});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(803949);var o=()=>n(908006),i=()=>n(785082),r=()=>n(451306),s=()=>n(496603),a=()=>n(878523),l=()=>n(182641),c=()=>n(722101),d=()=>n(384944),u=()=>n(620689),m=()=>n(255460),p=()=>n(319975),g=()=>n(231297),v=()=>n(892632),f=()=>n(299545),h=()=>n(953418),y=()=>n(906537),S=()=>n(154023),x=()=>n(148832),b=()=>n(606846),w=()=>n(374026),C=()=>n(807060),k=()=>n(337090),_=()=>n(855821),I=()=>n(741817),j=()=>n(725332),A=()=>n(301523);function M(e){var t,n;const{environment:o,store:r,text:s,files:l,transaction:c,discussionLocation:d,property_id:u,blockStore:m}=e,g=f().eK(r);if(!g)return;const{filesToCreate:v,fileStoresToDelete:h}=function(e,t){const n=[],o=new Set;t.forEach((e=>{"local"===e.type?n.push(e.file):o.add(e.id)}));const i=f().dd(e),r=i.filter((e=>e.getAlive()&&!o.has(e.id)));return{filesToCreate:n,fileStoresToDelete:r}}(r,l);T({commentStore:r,fileBlocks:h,transaction:c}),(0,_().t)({commentStore:r,files:v,environment:o,transaction:c});const y=f().gp(r);p().R9({environment:o,store:y,value:s,transaction:c}),(0,A().x)(r,c);const S=null==r||null===(t=r.getParentStore())||void 0===t?void 0:t.getParentStore(),x=i().eR.includes(d),w=null==g||null===(n=g.getParentStore())||void 0===n?void 0:n.getNavigableBlockStore(),{property_type:k,collection_id:I,collection_view_id:j,view_type:M,collection_view_block_id:D}=(0,C().q)(u,m);a().ZM(o,{from:d,comment_id:r.id,discussion_id:g.id,discussion_type:g.getType(),parent_block_id:g.getParentId(),parent_collection_id:null==S?void 0:S.getParentCollectionIdUpToTwoLevels(),...x&&{inbox_session_id:b().Ay.state.sessionId,notification_page_id:null==w?void 0:w.id},property_type:k,collection_id:I,collection_view_id:j,view_type:M,collection_view_block_id:D})}function D(e){var t,n;const{environment:o,commentStore:r,transaction:s,discussionLocation:l}=e,c=f().eK(r);if(!c)return;const u=f().uB(c),m=u.getValue();if(!m)return;T({commentStore:r,fileBlocks:f().dd(r),transaction:s}),d().zv({store:r,transaction:s,data:{alive:!1}}),g().applyOperation({store:u,operation:{pointer:u.pointer,path:u.path,command:"listRemove",args:{id:r.id}},transaction:s}),(0===m.length||1===m.length&&m[0]===r.id)&&(0,I().v)({environment:o,discussionStore:c,transaction:s}),(0,A().x)(r,s);const p=i().eR.includes(l),v=null==c||null===(t=c.getParentStore())||void 0===t?void 0:t.getNavigableBlockStore();a().gN(o,{from:e.discussionLocation,discussion_id:c.id,discussion_type:c.getType(),comment_id:r.id,parent_block_id:c.getParentId(),parent_collection_id:null===(n=c.getParentStore())||void 0===n?void 0:n.getParentCollectionIdUpToTwoLevels(),...p&&{inbox_session_id:b().Ay.state.sessionId,notification_page_id:null==v?void 0:v.id}})}function R(e){var t,n;const{environment:o,commentStore:r,discussionStore:s,transaction:l,discussionLocation:c}=e;d().zv({store:s,data:{resolved:!1},transaction:l}),(0,j().U)({transaction:l,discussionStore:s});const u=i().eR.includes(c),m=null==s||null===(t=s.getParentStore())||void 0===t?void 0:t.getNavigableBlockStore();a().Jg(o,{comment_id:r.id,discussion_id:s.id,from:e.discussionLocation,parent_block_id:s.getParentId(),parent_collection_id:null===(n=s.getParentStore())||void 0===n?void 0:n.getAssociatedCollectionId(),...u&&{inbox_session_id:b().Ay.state.sessionId,notification_page_id:null==m?void 0:m.id}})}function B(e){var t,n,o;const{environment:r,discussionStore:l,textValue:c,transaction:d,files:u,property_id:m,blockStore:p}=e,{id:g}=r.currentUser;if(!g)return;const f=v().JC(u);if(s().n4(c,[])&&0===f.length)return;const h=(0,k().G)({discussionStore:l,text:c,files:f,markDiscussionRead:!0,environment:r,transaction:d}),y=i().eR.includes(e.discussionLocation),x=null===(t=l.getParentStore())||void 0===t?void 0:t.getNavigableBlockStore(),{property_type:w,collection_id:_,collection_view_id:I,view_type:j,collection_view_block_id:A}=(0,C().q)(m,p),M=(0,S().B)(null==p||null===(n=p.getAssociatedCollectionStore())||void 0===n?void 0:n.getLayoutStore());a().mw(r,{from:e.discussionLocation,comment_id:h.id,discussion_id:l.id,discussion_type:l.getType(),parent_block_id:l.getParentId(),parent_collection_id:null==l||null===(o=l.getParentStore())||void 0===o?void 0:o.getParentCollectionIdUpToTwoLevels(),...y&&{inbox_session_id:b().Ay.state.sessionId,notification_page_id:null==x?void 0:x.id},property_type:w,collection_id:_,collection_view_id:I,view_type:j,collection_view_block_id:A,page_discussion_layout_location:M})}function T(e){const{commentStore:t,fileBlocks:n,transaction:o}=e,i=f().eP(t);n.forEach((e=>{d().zv({store:e,data:{alive:!1},transaction:o}),c().TF({parentStore:i,childToRemoveStore:e,transaction:o})}))}async function L(e){var t;const{discussionStore:n,currentBlockStore:i,environment:s,topOffset:a,animate:l}=e;if(!i)return null;if(!n.isDefined())return null;function c(e){const t=(0,w().S)({discussionId:n.id,blockId:e});if(!t)return;const o=document.getElementsByClassName((0,r().wV)({discussionId:n.id}))[0];let i;if(a){var c;const e=t.getScrollerContext(),n=null==e?void 0:e.verticalScroller,r=null==n?void 0:n.getNode(),l=null==n?void 0:n.getClientRect();if(i=o?o.getBoundingClientRect():null===(c=t.getNode())||void 0===c?void 0:c.getBoundingClientRect(),n&&r&&l&&i){const e=r.scrollTop+i.top,t=l.top;(0,h().VG)({element:r,environment:s,options:{top:e-t-a,behavior:"smooth"}})}}else if(o)u().hT({element:o,environment:s,scrollerContext:t.getScrollerContext(),vertical:{reveal:"top"},horizontal:{reveal:"closest"},animate:l}),i=o.getBoundingClientRect();else{var d;u().pb({environment:s,handle:t,vertical:{reveal:"top"},horizontal:{reveal:"closest"},animate:l}),i=null===(d=t.getNode())||void 0===d?void 0:d.getBoundingClientRect()}return t.displaySelectionHalo(750),{selectable:t,rect:i}}const d=(null===(t=n.getRecordStoreUIParent())||void 0===t?void 0:t.id)??n.getParentId();let p=c(d);p||(await m().NH(s,i,[d]),await o().default.afterNextFlush(),p=c(d));return{scrollResult:p,blockStore:x().B.createChildStore(i,n.getParentPointer())}}async function F(e){const{discussionStore:t,currentBlockStore:n,environment:o,analyticsFrom:i,currentEl:r,shouldSetRect:s,animateScroll:a,discussionReadStatus:c}=e,d=await L({discussionStore:t,currentBlockStore:n,environment:o,animate:a});if(!d)return null;const{scrollResult:u,blockStore:m}=d,p=y().get(),g=null==p?void 0:p.commonAncestorContainer,v=!(null!=p&&p.collapsed)&&g&&(r===g||(null==r?void 0:r.contains(g)));l().B4({environment:o,blockStore:m||n,analyticsFrom:i,discussionIds:[t.id],shouldFocusDiscussion:!v,recursivelyLoadAllDiscussions:!1,rect:Boolean(s)?null==u?void 0:u.rect:void 0,discussionReadStatus:c})}},811879:(e,t,n)=>{n.d(t,{E:()=>p});n(296540);var o=()=>n(56366),i=()=>n(401497),r=()=>n(310442),s=()=>n(824862),a=()=>n(798880),l=()=>n(534177),c=()=>n(256863),d=()=>n(453697),u=()=>n(448291),m=n(474848);function p({authorStore:e,avatarSize:t,avatarStyle:n,hasTooltip:p=!0}){const g=(0,o().K8)((()=>(0,u().d5)(e)),[e]),v=(0,i().IS)((e=>({placeholder:{width:t,height:t,background:e.lightDividerColor,borderRadius:t/2,flexShrink:0,...n}})),[t,n]);return g.asActor?g.table===a().oo?(0,m.jsx)(d().A,{hasPersonHoverCard:!0,hasTooltip:p,userValue:g.asActor,style:n,size:t,avatarShouldShowShadow:!1}):g.table===s().GP?(0,m.jsx)(c().A,{botValue:g,size:t,style:n}):g.table===r().yj?(0,m.jsx)("div",{style:v.placeholder}):void(0,l().HB)(g):(0,m.jsx)("div",{style:v.placeholder})}},846583:(e,t,n)=>{n.d(t,{A:()=>w,T:()=>C});n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(296540);var o=()=>n(662303),i=()=>n(56366),r=()=>n(401497),s=()=>n(700500),a=()=>n(713998),l=()=>n(313028),c=()=>n(601813),d=()=>n(792071),u=()=>n(179034),m=()=>n(797809),p=()=>n(201980),g=()=>n(69708),v=()=>n(100622),f=()=>n(284371),h=()=>n(710648),y=()=>n(972435),S=()=>n(105157),x=n(474848);const b=new Set([s().xd.toggle,s().xd.bulletedList,s().xd.numberedList,s().xd.quote,s().xd.toDo,s().xd.code,s().xd.callout,s().xd.header,s().xd.subHeader,s().xd.subSubHeader,s().xd.tableRow]);function w(e){const t=(0,r().DP)(),n=(0,g().tz)(),v=(0,i().K8)((()=>{var t;return e.store.isDefined()?null===(t=e.store.getParentStore())||void 0===t?void 0:t.getValue():null}),[e.store]),w=(0,i().K8)((()=>e.blockStore.getSpaceId()),[e.blockStore]),k=(0,i().K8)((()=>{const t=e.store.getParentStore();if(null==t||!t.isType("alias"))return;const n=t.getAliasTargetStore();return(null==n?void 0:n.table)===u().ev&&n.isFormBlock()?{store:n,value:n.getValue()}:void 0}),[e.store]);let _=(0,i().K8)((()=>{if(!e.store.isDefined())return;const t=e.store.getContext(),o=t?(0,c().l8)({discussionContextData:t,discussionType:e.store.getType(),discussionId:e.store.id,intl:n}):void 0;if(!o)return;let i=p().JJ$(o,(t=>!p().iQL(t)||p().Orm(t)===e.store.id));return p().AhH(i)>50&&(i=p().JG8(i,50,[(0,p().Ey_)("…")])),i}),[e.store,n]);const I=(0,i().K8)((()=>{const t=e.blockStore.getAssociatedCollectionStore();if(!t||"collection"!==t.table)return;const n=t.getSchema(),o=e.store.getPropertyId();return void 0!==o?(0,a()._g)({schema:n,property:o}):void 0}),[e.blockStore,e.store]),j=({textValue:n,propertySchema:i,discussionParentValue:r})=>{const a=(0,x.jsx)("div",{style:{overflow:"hidden",lineHeight:"18px",maxHeight:72},children:(0,x.jsx)(h().vY,{value:{value:n,spaceId:w},propertySchema:i,labeled:!1,rootStore:e.blockStore,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!0})});if(!r)return a;const c=r.type;return c===s().xd.code?(0,x.jsx)(l().A,{title:(0,h().Ab)(r),theme:t,style:{marginTop:0,marginBottom:0},children:(0,x.jsx)("span",{style:{fontFamily:f().vc(o().locale).mono,fontSize:12,tabSize:2},children:a})}):(0,h().ux)(c)?(0,x.jsx)(l().A,{title:(0,h().ux)(c),theme:t,style:{marginTop:0,marginBottom:0},children:a}):a},A={display:"flex",width:"100%",marginTop:6,marginBottom:6,fontSize:13,color:t.text.secondary};function M(e){_||(_=[[""]]);const t=(0,m().RX)(y().A.getIntl()).title;return t?(0,x.jsx)("div",{style:A,children:(0,x.jsxs)("div",{style:{display:"flex",width:"100%"},children:[(0,x.jsx)(C,{}),I?(0,x.jsx)(S().A,{propertySchema:I,dontShowColon:""===_[0][0]}):void 0,j({textValue:_,discussionParentValue:e,propertySchema:t})]})}):null}if("updates_sidebar"===e.discussionLocation){if(!v)return null;if("text"!==v.type&&void 0===I){const t=null!=k&&k.value?k.value:v,n=null!=k&&k.store?k.store:e.blockStore;return(0,x.jsx)("div",{onClick:e.onClick,style:{display:"flex",cursor:d().Bj6.fromBlock(v).isType(s().Si)?"text":void 0},children:_&&b.has(v.type)?M(v):(0,x.jsxs)("div",{style:A,children:[(0,x.jsx)(C,{}),(0,x.jsx)(h().Ay,{blockValue:t,rootStore:n,blockPreviewLocation:"comments_sidebar"})]})})}}return(0,x.jsx)("div",{onClick:e.onClick,style:{cursor:"text"},children:M()})}function C(){const e=(0,r().IS)((e=>({bar:{width:2,marginInlineStart:1,borderRadius:4,marginInlineEnd:8,background:(0,v().eb)(e.mode),flexShrink:0}})),[]);return(0,x.jsx)("div",{style:e.bar})}},973753:(e,t,n)=>{n.d(t,{A:()=>w});var o=n(296540),i=()=>n(484714),r=()=>n(56366),s=()=>n(401497),a=()=>n(611648),l=()=>n(150669),c=()=>n(252291),d=()=>n(62900),u=()=>n(569397),m=()=>n(69708),p=()=>n(285790),g=()=>n(2143),v=()=>n(966080),f=()=>n(933765),h=()=>n(953418),y=()=>n(141333),S=n(474848);const x=.8,b=(0,m().YK)({scrollLeftButtonAriaLabel:{defaultMessage:"Scroll left",id:"FilmStrip.scrollLeftButtonAriaLabel"},scrollRightButtonAriaLabel:{defaultMessage:"Scroll right",id:"FilmStrip.scrollRightButtonAriaLabel"}});function w({children:e,shouldShowGrayFog:t}){const n=(0,m().tz)(),w=(0,o.useRef)(null),C=(0,i().v3)(),k=(0,r().uB)(void 0,l().A),_=(0,r().K8)((()=>k.state.elementRef),[k]),I=(0,y().HD)(_),j=(0,y().Xg)(_),A=(0,y().sj)(_),M=(0,o.useCallback)((()=>{var e;null===(e=w.current)||void 0===e||e.getClientRect()}),[]);(0,o.useEffect)((()=>((0,v().P)(window,"resize",M),()=>{(0,f().O)(window,"resize",M)})),[M]),(0,o.useEffect)((()=>{M()}),[M]);const D=A>0,R=Math.ceil(A+I)<j,B=(0,o.useCallback)((e=>{var t;e.stopPropagation(),h().HN({element:null===(t=w.current)||void 0===t?void 0:t.getNode(),environment:C,options:{left:-x*I,behavior:"smooth"}})}),[I,C]),T=(0,o.useCallback)((e=>{var t;e.stopPropagation(),h().HN({element:null===(t=w.current)||void 0===t?void 0:t.getNode(),environment:C,options:{left:x*I,behavior:"smooth"}})}),[I,C]),L=(0,s().IS)((e=>({scrollerWrapper:{display:"flex",position:"relative"},scroller:{overflow:"auto",display:"flex",gap:4,zIndex:0,paddingTop:6,marginTop:-6,paddingInlineEnd:4},commonArrowStyles:{position:"absolute",borderRadius:12,width:24,height:24,background:e.background.tertiaryTranslucent,top:12,boxShadow:"none"},iconHoveredStyle:{background:e.background.tertiaryTranslucent},leftArrowStyle:{insetInlineStart:0},rightArrowStyle:{insetInlineEnd:4},leftArrowContainer:{position:"absolute",height:"100%",width:30,background:`linear-gradient(to right, ${t?e.hoveredMarginDiscussionBackground:e.selectedMarginDiscussionBackground} 0px, ${e.contentBackgroundTransparent} 30px`},rightArrowContainer:{position:"absolute",height:"100%",width:30,insetInlineEnd:0,background:`linear-gradient(to left, ${t?e.hoveredMarginDiscussionBackground:e.selectedMarginDiscussionBackground} 0px, ${e.contentBackgroundTransparent} 30px`}})),[t]);return(0,S.jsxs)("div",{style:L.scrollerWrapper,children:[(0,S.jsx)(g().H,{ref:w,type:a().A.X,store:k,onScroll:M,style:L.scroller,children:e}),D?(0,S.jsx)("div",{style:L.leftArrowContainer,children:(0,S.jsx)(p().A,{icon:()=>(0,S.jsx)(c().I,{icon:d().n,size:"sm",colorVariant:"secondary"}),hovered:!1,showShadow:!0,onClick:B,ariaLabel:n.formatMessage(b.scrollLeftButtonAriaLabel),style:{...L.commonArrowStyles,...L.leftArrowStyle},hoveredStyle:L.iconHoveredStyle})}):void 0,R?(0,S.jsx)("div",{style:L.rightArrowContainer,children:(0,S.jsx)(p().A,{icon:()=>(0,S.jsx)(c().I,{icon:u().arrowStraightRightSmallIcon,size:"sm",colorVariant:"secondary"}),hovered:!1,showShadow:!0,onClick:T,ariaLabel:n.formatMessage(b.scrollRightButtonAriaLabel),style:{...L.commonArrowStyles,...L.rightArrowStyle},hoveredStyle:L.iconHoveredStyle})}):void 0]})}}}]);