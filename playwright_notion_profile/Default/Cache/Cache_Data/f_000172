"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[63248],{139466:(e,t,o)=>{o.d(t,{d:()=>m});o(296540);var a=()=>o(484714),s=()=>o(56366),i=()=>o(401497),n=()=>o(69708),r=()=>o(534177),l=()=>o(895876),c=()=>o(305390),d=()=>o(128295),u=()=>o(115512),p=o(474848);function m({spaceStore:e,collectionStore:t,menuListItemProps:o}){const s=(0,a().v3)(),n=(0,i().IS)((e=>({caption:{color:e.text.tertiary,fontSize:(0,u().ny)(s,"UISmall")}})),[s]);return(0,p.jsx)(c().A,{caption:(0,p.jsx)("div",{style:n.caption,children:(0,p.jsx)(g,{spaceStore:e,collectionStore:t})}),store:t,...o})}function g({spaceStore:e,collectionStore:t}){const o=(0,a().v3)(),i=(0,s().K8)((()=>function({environment:e,spaceStore:t,collectionStore:o}){const a=(0,l().X0)({collectionStore:o});switch(a){case"team":return null;case"private":return(0,p.jsx)(n().sA,{id:"moveToHelpers.privatePageCaptionPrefix",defaultMessage:"Private"});case"shared":return(0,p.jsx)(n().sA,{id:"moveToHelpers.sharedPageCaptionPrefix",defaultMessage:"Shared"});default:(0,r().HB)(a)}}({environment:o,spaceStore:e,collectionStore:t})),[o,e,t]),c=(0,s().K8)((()=>(0,d().a6)(t)),[t])&&(0,p.jsx)(d().Ay,{store:t,showFullPathInTooltip:!0});return c&&i?(0,p.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[i,(0,p.jsx)("div",{style:{paddingInlineStart:4,paddingInlineEnd:4},children:"/"}),c]}):c&&!i?c:(0,p.jsx)(p.Fragment,{children:i})}},276303:(e,t,o)=>{o.d(t,{wU:()=>le,OC:()=>de,wc:()=>ee,NA:()=>te,L2:()=>oe,oG:()=>ne,N$:()=>ce,DZ:()=>Z,_B:()=>me,R3:()=>pe,nG:()=>ae});o(16280),o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(430670),o(581454),o(296540);var a=()=>o(726637),s=()=>o(929219),i=()=>o(148307),n=()=>o(484392),r=()=>o(315564),l=()=>o(689094),c=()=>o(179034),d=()=>o(519831),u=()=>o(69708),p=()=>o(778078),m=()=>o(496603),g=()=>o(534177),v=()=>o(264879),S=()=>o(231297),h=()=>o(755199),y=()=>o(895876),f=()=>o(760217),M=()=>o(89924),A=()=>o(859428),T=()=>o(453697),b=()=>o(103448),x=()=>o(765957),I=()=>o(977863);var k=()=>o(381678),w=()=>o(553965),j=()=>o(500758),P=()=>o(372657),C=()=>o(37433),B=()=>o(106628),D=()=>o(832820),N=()=>o(845566),R=()=>o(188669),L=()=>o(148832),O=()=>o(543665),K=()=>o(96689),E=()=>o(854150),V=()=>o(16006),z=()=>o(299545),q=()=>o(985405),_=()=>o(95758),W=()=>o(401497),H=()=>o(305390),F=o(474848);function U(e){const{store:t,menuListItemProps:o,hidePath:a,isDisabled:s,disabledTooltip:i}=e,n=(0,W().IS)((e=>({disabledTooltip:{maxWidth:240},recordMenuItem:s?{color:e.text.secondary}:{}})),[s]);return(0,F.jsx)(A().A,{placement:"left",textWrap:!0,style:n.disabledTooltip,disableTooltip:!s,renderTooltip:()=>i,render:e=>(0,F.jsx)(H().A,{...(0,w().A)(o,e),disabled:s,store:t,hidePath:a,style:n.recordMenuItem})})}var Q=()=>o(139466);function G({spaceStore:e,value:t,showPath:o,isCreateIn:a,onAccept:s,showDataSources:i=!0,isMovingDataSource:n}){const r=function({spaceStore:e,value:t}){const{type:o}=t;switch(o){case"page":return L().B.createChildStore(e,{table:c().ev,id:t.id});case"collection":return O().m.createChildStore(e,{table:d().Vl,id:t.id});case"space":return q().SpaceStore.createChildStore(e,{table:K().NX,id:t.id});case"team":return _().h.createChildStore(e,{table:E().yK,id:t.id});case"space-private-pages":return;default:(0,g().HB)(o)}}({spaceStore:e,value:t});if(r){if((0,P().n6)()&&r instanceof O().m)return[{key:r.id,render:t=>(0,F.jsx)(Q().d,{spaceStore:e,collectionStore:r,menuListItemProps:t}),action:()=>s(t)}];{const e=function({destinationStore:e,isMovingDataSource:t}){if(e instanceof L().B&&!(0,P().qT)({destinationStore:e,isMovingDataSource:t}))return(0,F.jsx)(u().sA,{id:"moveBlockMenu.needEditAccess.tooltip",defaultMessage:"You need “Can edit” access to “{parentName}” to move this page",values:{parentName:(0,F.jsx)(V().A,{store:e,shouldWrap:!0})}});if((0,z().$R)(e)&&!e.canAddOrRemoveTopLevelPages())return(0,F.jsx)(u().sA,{id:"moveBlockMenu.TeamSidebarLocked.tooltip",defaultMessage:"This teamspace has its sidebar locked. You must be a teamspace owner to move to this teamspace."})}({destinationStore:r,isMovingDataSource:n});return[{key:r.id,render:t=>(0,F.jsx)(U,{store:r,menuListItemProps:t,hidePath:!!a&&!o,isDisabled:Boolean(e),disabledTooltip:e}),action:()=>s(t)}]}}}var $=()=>o(478495),Y=()=>o(828048);const J=5,Z=(0,u().YK)({createSubpage:{id:"moveToOrCreateMenu.createSubpage.description",defaultMessage:"Create a new sub-page where your cursor is, inside the current block."},newPageIn:{id:"moveToOrCreateMenu.newPageIn.description",defaultMessage:"Create a new page inside any existing page, then link to it in one go."},privatePagesTitle:{defaultMessage:"Private Pages",id:"moveBlockMenu.privatePagesMenuTitle"},teamspacesTitle:{defaultMessage:"Teamspaces",id:"moveBlockMenu.teamsSection.title"},pagesTitle:{defaultMessage:"Pages",id:"moveBlockMenu.pagesSection.title"},suggestedTitle:{defaultMessage:"Suggested",id:"moveBlockMenu.suggestedSection.title"}});function X(e,t,o,s,n,r,d){if(!r||!d)return;if(e.query)return;const p=x().default.state.mainEditorCurrentBlockStore;if(!p)return;const m=n?L().B.createChildStore(p,{table:c().ev,id:n}):void 0,g=v().D8(m);return g?{key:g.pageStore.id,render:e=>{const t=t=>(0,F.jsx)(f().A,{...(0,w().A)(t||{},e),icon:(0,l().W)({width:14}),title:o.length>1?(0,F.jsx)(u().sA,{id:"moveBlockMenu.currentPage.pluralAddTitle",defaultMessage:"New sub-pages"}):(0,F.jsx)(u().sA,{id:"moveBlockMenu.currentPage.singleAddTitle",defaultMessage:"New sub-page"})});return a().A.isMobile?t():(0,F.jsx)(A().A,{renderTooltip:()=>(0,F.jsx)(b().A,{imageURL:i().A.images.tooltips.pageMenu.newSubpagePng,imageWidth:140,imageHeight:100,caption:(0,F.jsx)(u().sA,{...Z.createSubpage})}),placement:"right",delayThreshold:0,render:e=>t(e)})},action:()=>s(g.createInValue)}:void 0}function ee(){return N().x.getChosenSpaceStore()??x().default.state.sidebarSpaceStore}function te(){return N().x.getChosenSpaceViewStore()??x().default.state.sidebarSpaceViewStore}function oe(e){return e.isOpen?e.queryLimit:j().p1}function ae(e,t,o){var a;t(e);const s=R().Ay.getDatabaseType(),i=null===(a=x().default.state.sidebarSpaceStore)||void 0===a?void 0:a.id;"collection"===e.type&&i&&S().createAndCommit({userAction:"TypedMoveToMenu.handleClick",environment:o,canUndo:!0,perform:t=>{h().ee({transaction:t,databaseType:s,collectionId:e.id})}})}function se(e,t,o,a,s,i){const{query:n,savedQuickAddParent:r}=e,l=ee();if(l)return t&&!n&&"space"===r.type||"page"===r.type?G({spaceStore:l,value:r,showPath:!0,isCreateIn:o,onAccept:a,showDataSources:i,isMovingDataSource:s}):void 0}async function ie(e,t,o,a,s){if(!R().Ay.state.isOpen||"untyped"===R().Ay.state.variant||!D().c.state)throw new Error("Trying to render section when it's either not open, untyped, or typed but uninitialized (i.e. the typed databases are not fetched yet)");const i=R().Ay.getDatabaseType(),r=(0,y().$O)(i),{typedDatabases:l}=D().c.state,c=await async function(e,t,o,a,s){const{databaseType:i,query:n,searchSessionId:r}=e,l=ee();if(!l)return[];const c=await B().T.searchActions.load();return(await c.searchCollectionsWithRecents({environment:o,query:n,limit:20,databaseType:i,parentStore:l,spaceStore:l,collectionViewBlockStore:void 0,searchSessionId:r,peopleBlocksToInclude:"none"})).results.flatMap((e=>G({spaceStore:l,value:{type:"collection",id:e,spaceId:l.id},showPath:!0,isCreateIn:a,onAccept:a?s:e=>ae(e,s,o),isMovingDataSource:t}))).filter(g().O9)}({query:e,databaseType:i?[i]:void 0,searchSessionId:R().Ay.state.flowId},s,t,o,a);return{typedSuggestedMenuSection:{key:"suggested",render:e=>(0,F.jsx)(M().A,{...e,title:(0,F.jsx)(u().sA,{defaultMessage:"{typedItemName} databases",id:"moveBlockMenu.typedSuggestedSection.title",values:{typedItemName:(0,n().A)(r)}}),right:(0,F.jsx)(Y().m,{typedItemName:r})}),items:c.slice(0,J)},typedSuggestedResults:l}}function ne(e,t,o,a,s,i,n,l){var c;const{query:d,chosenSpaceStore:m}=e,{sidebarSpaceStore:g}=x().default.state,v=Z.privatePagesTitle,S=a.formatMessage(v).replace(/<[^>]*>/g,""),h=d?null===(c=(0,p().It)(d,S))||void 0===c?void 0:c.score:void 0,y=d&&(h||0)>=p().sH;if((!d||y)&&n&&(!m||(0,$().VN)({itemsToMove:s,chosenSpaceStore:m,forceShowPrivatePageOption:l,sidebarSpaceStore:g})))return{key:"private",render:e=>(0,F.jsx)(f().A,{icon:(0,F.jsx)(T().A,{size:22,userStore:(0,k()._)(t)}),title:(0,F.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,F.jsx)("span",{children:(0,F.jsx)(u().sA,{...v})}),(0,C().zI)()>0?(0,F.jsx)("div",{style:{marginInlineStart:10,display:"flex",alignItems:"center"},children:(0,r().S)({width:16,height:16,fill:o.icon.secondary})}):void 0]}),...e}),action:()=>{i({type:"space-private-pages",spaceId:m.id})}}}function re(e,t,o,a,s){if(e&&!a)return[];const i=ee(),n=te();if(!i||!n)return[];let r=n.getTeamsStores();return e&&(r=(0,p().Ay)(e,r,(e=>e.getName()||""))),r.flatMap((e=>G({spaceStore:i,value:{type:"team",id:e.id,spaceId:i.id},showPath:!1,isCreateIn:t,onAccept:o,isMovingDataSource:s}))).filter(g().O9)}function le(e){const{allItemsToMoveAreNavigable:t,blockResults:o,chosenSpaceStore:a,environment:s,isAddTo:i,isCreateIn:n,isTurnIntoPage:r,showDataSources:l,onAccept:c,parentBlockId:d,query:p,recentPageResults:g,itemsToMove:v,templateResults:S,topLevelBlockResults:h}=e,y=[],f=new Set,A=e=>{if(!e)return!1;const{key:t}=e;return!f.has(t)&&(f.add(t),!0)},T=m().oE([X({query:p},0,v,c,d,i,n)]);!T.length||Boolean(r)||Boolean(i)||y.push({key:"defaults",render:e=>(0,F.jsx)(M().A,{...e}),items:T});const b=m().oE([...g.slice(0,5).flatMap((({blockId:e})=>G({spaceStore:a,value:{type:"page",id:e,spaceId:a.id},showPath:!Boolean(r)&&!Boolean(i),isCreateIn:n,showDataSources:l,onAccept:c,isMovingDataSource:(0,P().vN)(v)}))),...o.slice(0,10).flatMap((({blockId:e})=>G({spaceStore:a,value:{type:"page",id:e,spaceId:a.id},showPath:!p,isCreateIn:n,showDataSources:l,onAccept:c,isMovingDataSource:(0,P().vN)(v)}))),...h.slice(0,10).flatMap((({blockId:e})=>G({spaceStore:a,value:{type:"page",id:e,spaceId:a.id},showPath:!p,isCreateIn:n,showDataSources:l,onAccept:c,isMovingDataSource:(0,P().vN)(v)})))].slice(0,20).filter(A));b.length>0&&y.push({key:"blocks",render:e=>(0,F.jsx)(M().A,{...e,title:(0,F.jsx)(u().sA,{...Z.suggestedTitle}),topBorder:y.length>0&&!Boolean(r)&&!Boolean(i)}),items:b});const x=m().oE(re(p,n,c,t,(0,P().vN)(v)).filter(A));x.length>0&&y.push({key:"teams",render:e=>(0,F.jsx)(M().A,{...e,title:(0,F.jsx)(u().sA,{...Z.teamspacesTitle}),topBorder:y.length>0}),items:x});const I=m().oE(S.slice(0,5).flatMap((({blockId:e})=>G({spaceStore:a,value:{type:"page",id:e,spaceId:a.id},showPath:!0,isCreateIn:n,showDataSources:l,onAccept:c,isMovingDataSource:(0,P().vN)(v)}))).filter(A));return I.length>0&&y.push({key:"templates",render:e=>(0,F.jsx)(M().A,{...e,title:i?(0,F.jsx)(u().sA,{defaultMessage:"Add from template",id:"moveBlockMenu.addFromTemplate.title"}):(0,F.jsx)(u().sA,{defaultMessage:"Move to template",id:"moveBlockMenu.moveToTemplate.title"}),topBorder:y.length>0}),items:I}),T.length&&(Boolean(r)||Boolean(i))&&y.push({key:"defaults",render:e=>(0,F.jsx)(M().A,{...e,topBorder:y.length>0}),items:T}),y}async function ce(e,t,o,a,s,i,n){const{chosenSpaceStore:r,savedQuickAddParent:l,query:c,blockResults:d,recentPageResults:p}=e,{typedSuggestedMenuSection:g,typedSuggestedResults:v}=await ie(c,t,o,a,(0,P().vN)(s));if(R().Ay.state.isOpen&&"aggregated_type"===R().Ay.state.moveToContext)return[g].filter((e=>e.items.length>0));let S=P().Pk({recentPageResults:p,blockResults:d,suggestedPages:v});const h=new Set(P().rD(s));h.size>0&&(S=S.filter((e=>!h.has(e.blockId))));const y=m().hS(m().qI(m().oE([se({query:c,savedQuickAddParent:l},i,o,a,(0,P().vN)(s)),...S.map((({blockId:e})=>G({spaceStore:r,value:{type:"page",id:e,spaceId:r.id},showPath:!c,isCreateIn:o,onAccept:a,isMovingDataSource:(0,P().vN)(s)})))])),(e=>e.key)),f=m().oE(re(c,o,a,n,(0,P().vN)(s))).slice(0,J),A=g.items.length>0,T={key:"teams",render:e=>(0,F.jsx)(M().A,{...e,desktopStyle:{paddingTop:A?0:6,paddingBottom:6},title:(0,F.jsx)(u().sA,{...Z.teamspacesTitle})}),items:f},b=g.items.length>0&&0===T.items.length,x={key:"pages",render:e=>(0,F.jsx)(M().A,{...e,desktopStyle:{paddingTop:b?0:6,paddingBottom:6},title:(0,F.jsx)(u().sA,{...Z.pagesTitle})}),items:y};return[g,T,x].filter((e=>e.items.length>0))}function de(e){const{allItemsToMoveAreNavigable:t,blockResults:o,chosenSpaceStore:a,environment:s,forceShowPrivatePageOption:i,intl:n,isAddTo:r,isCreateIn:l,showDataSources:c,onAccept:d,query:p,recentPageResults:g,savedQuickAddParent:v,itemsToMove:S,theme:h}=e,y=function(e,t,o,a,s,i,n,r,l,c,d){const p=0===e.length&&t?(0,$().Fx)({spaceStore:t,itemsToMove:s}):[];return{key:"suggested",render:e=>(0,F.jsx)(M().A,{...e,title:(0,F.jsx)(u().sA,{...Z.suggestedTitle})}),items:m().oE([ne({query:e,chosenSpaceStore:t},o,a,i,s,n,l,c),...p.filter((e=>P().zO(e,s))).flatMap((e=>G({spaceStore:t,value:{type:"page",id:e.id,spaceId:t.id},showPath:!1,isCreateIn:r,onAccept:n,showDataSources:d,isMovingDataSource:(0,P().vN)(s)})))])}}(p,a,s,h,S,n,d,l,t,i,c),f=oe(R().Ay.state),A=[...g.slice(0,3),...o.slice(0,f)],T={key:"pages",render:e=>(0,F.jsx)(M().A,{...e,title:(0,F.jsx)(u().sA,{...Z.pagesTitle})}),items:m().hS(m().qI(m().oE([se({query:p,savedQuickAddParent:v},r,l,d,(0,P().vN)(S),c),...A.map((({blockId:e,collectionId:t})=>G({spaceStore:a,value:t?{type:"collection",id:t,spaceId:a.id}:{type:"page",id:e,spaceId:a.id},showPath:!p,isCreateIn:l,showDataSources:c,onAccept:d,isMovingDataSource:(0,P().vN)(S)})))])),(e=>e.key))},b={key:"teams",render:e=>(0,F.jsx)(M().A,{...e,title:(0,F.jsx)(u().sA,{...Z.teamspacesTitle})}),items:m().oE(re(p,l,d,t,(0,P().vN)(S))).slice(0,10)};return[y,b,T].filter((e=>e.items.length>0))}function ue(e,t){return!(e instanceof O().m)&&(!!t&&e.isTemplate())}function pe(){return s().A.state.online}function me({chosenSpaceStore:e,environment:t,isCreateIn:o,query:a,recentPageIds:s,searchResults:i,itemsToMove:n}){const r=[],l=[],u=[];let p=[];if(a&&i)for(const m of i){const t=m.collectionId?O().m.createChildStore(e.getPagesStore(),{table:d().Vl,id:m.collectionId}):L().B.createChildStore(e.getPagesStore(),{table:c().ev,id:m.blockId});P().zO(t,n)&&(ue(t,o)?u.push(m):r.push(m))}else if(s){p=s.map((t=>({blockId:L().B.createChildStore(e.getPagesStore(),{table:c().ev,id:t}).id}))),p=p.filter((({blockId:t})=>{const a=L().B.createChildStore(e.getPagesStore(),{table:c().ev,id:t});if(P().zO(a,n)){const e={blockId:a.id};return!ue(a,o)||(u.push(e),!1)}}));const a=function(e){const{sidebarSpaceViewStore:t,currentUserSettingsStore:o}=x().default.state;if(t)return m().KC(t.getWorkspacePages()??[],(0,I().c)(e,t,o),t.getPrivatePages(e)??[]).filter((e=>e.isNavigableBlock()));return[]}(t);for(const e of a)if(P().zO(e,n)){const t={blockId:e.id};ue(e,o)?u.push(t):l.push(t)}}return{blockResults:r,topLevelBlockResults:l,templateResults:u,recentPageResults:p}}},478495:(e,t,o)=>{o.d(t,{Cr:()=>v,Fx:()=>S,VN:()=>h});o(898992),o(823215),o(354520),o(581454),o(737550),o(296540);var a=()=>o(56366),s=()=>o(401497),i=()=>o(69708),n=()=>o(372657),r=()=>o(272509),l=()=>o(435761),c=()=>o(765957),d=()=>o(968172),u=()=>o(148832),p=()=>o(644434),m=()=>o(873643),g=o(474848);function v(e){const{spaceStore:t,spaceViewStore:o,itemsToMove:r,moveToPagesOnly:d,forceShowPrivatePageOption:u,onAccept:v}=e,y=(0,i().tz)(),f=(0,s().IS)((()=>({modal:{height:374,maxHeight:"70vh",paddingBottom:12},body:{width:"100%"}})),[]),{teams:M}=(0,l().LN)({spaceStore:t}),A=(0,l().gc)({spaceStore:t,teams:M}).map((e=>e.store)),T=(0,a().K8)((()=>A.filter((e=>e.canAddOrRemoveTopLevelPages())).slice(0,7)),[A]),b=(0,a().K8)((()=>S({spaceStore:t,itemsToMove:r})),[t,r]),x=(0,a().K8)((()=>{var e;return(null==o||null===(e=o.getWorkspacePages())||void 0===e?void 0:e.filter((e=>(0,n().zP)(e,r))))??[]}),[o,r]),I=(0,a().O$)(c().AppStoreSidebarSpaceStore),k=(0,a().K8)((()=>{if(h({itemsToMove:r,chosenSpaceStore:t,forceShowPrivatePageOption:u,sidebarSpaceStore:I}))return(0,g.jsx)(m().E,{spaceStore:t,spaceViewStore:o,store:void 0,depth:0,onAccept:v,itemsToMove:r,moveToChildrenOnly:d},"MoveToModal private item")}),[v,r,t,o,d,u,I]);return t&&o?(0,g.jsx)("div",{style:f.modal,children:(0,g.jsx)("div",{style:f.body,children:(0,g.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,g.jsx)(p().J,{spaceStore:t,spaceViewStore:o,itemStores:b,addedItems:[k],moveToPagesOnly:d,depth:0,title:y.formatMessage({defaultMessage:"Suggested",id:"moveToModal.suggestedSection.title"}),onAccept:e.onAccept,itemsToMove:e.itemsToMove}),T&&T.length>0?(0,g.jsx)(p().J,{spaceStore:t,spaceViewStore:o,itemStores:T,moveToPagesOnly:d,depth:0,title:y.formatMessage({defaultMessage:"Teamspaces",id:"moveToModal.teamsSection.title"}),onAccept:e.onAccept,itemsToMove:e.itemsToMove}):void 0,x.length>0?(0,g.jsx)(p().J,{spaceStore:t,spaceViewStore:o,itemStores:x,moveToPagesOnly:d,depth:0,title:y.formatMessage({defaultMessage:"Workspace",id:"moveToModal.workspaceSection.title"}),onAccept:e.onAccept,itemsToMove:e.itemsToMove}):void 0]})})}):null}function S({spaceStore:e,itemsToMove:t}){const o=(0,n().iH)(t),a=d().A.getWithoutSubscribing(e.id).map((({store:e})=>e)).filter((e=>(null==e?void 0:e.pathIsAccessibleAndAlive())&&!function(e,t){return t.some((t=>"block"===t.table&&t.id===e.id))}(e,t)&&e.id!==o));return a.slice(0,7)}function h({itemsToMove:e,chosenSpaceStore:t,forceShowPrivatePageOption:o,sidebarSpaceStore:a}){const s=(0,r().I)(t),i=e.every((e=>e instanceof u().B&&e.isTopLevelPrivatePage())),n=a&&t.id!==a.id;return!s&&(o||n||!i)}},568999:(e,t,o)=>{o.d(t,{g:()=>a});const a=(0,o(340498).xh)("checkmarkCircle",{default:{loader:()=>o.e(44032).then(o.bind(o,671089))},small:{loader:()=>o.e(44032).then(o.bind(o,833243))},fill:{loader:()=>o.e(44032).then(o.bind(o,209969))},fillSmall:{loader:()=>o.e(44032).then(o.bind(o,450424))}},["check","mark","tick","confirm","approve"])},572748:(e,t,o)=>{o.d(t,{t:()=>m});o(581454);var a=()=>o(484714),s=()=>o(56366),i=()=>o(401497),n=()=>o(187174),r=()=>o(69708),l=()=>o(524539),c=()=>o(372657),d=()=>o(810703),u=()=>o(765957),p=()=>o(276303);function m({allItemsToMoveAreNavigable:e,forceShowPrivatePageOption:t,isAddTo:o,isCreateIn:m,isTurnIntoPage:g,showDataSources:v,onAccept:S,parentBlockId:h,query:y,searchResults:f,itemsToMove:M}){const A=(0,r().tz)(),T=(0,i().DP)(),b=(0,a().v3)(),x=(0,s().O$)(u().AppStoreSidebarSpaceStore),I=(0,s().K8)((()=>(0,p().wc)()),[]),[k]=(0,n().Yb)((async()=>I?await(0,d().pw)({spaceStore:I,currentUserId:b.currentUser.id}):void 0),[I,b.currentUser.id]),[w]=(0,n().Yb)((async()=>!y&&I?await l()._P(I,I.id):void 0),[y,I]),{blockResults:j,topLevelBlockResults:P,templateResults:C,recentPageResults:B}=(0,s().K8)((()=>{if(!I)return{blockResults:[],topLevelBlockResults:[],templateResults:[],recentPageResults:[]};const e=f.results.map((e=>({blockId:e.id,collectionId:e.isSurrogateCollection?e.collectionId:void 0})));return(0,p()._B)({chosenSpaceStore:I,environment:b,isCreateIn:m,query:y,recentPageIds:w.value,searchResults:e,itemsToMove:M})}),[I,b,m,y,w.value,f.results,M],{useDeepEqual:!0}),D=(0,s().K8)((()=>c().n6()),[]),[N]=(0,n().Yb)((async()=>{if(D&&I&&k.value)return await(0,p().N$)({chosenSpaceStore:I,savedQuickAddParent:k.value,query:y,blockResults:j,recentPageResults:B},b,m,S,M,o,e)}),[D,I,k.value,y,j,B,b,m,S,M,o,e]);return(0,s().K8)((()=>D?N.value??[]:I&&x&&k.value?m?(0,p().wU)({allItemsToMoveAreNavigable:e,blockResults:j,chosenSpaceStore:I,environment:b,isAddTo:o,isCreateIn:m,showDataSources:v,isTurnIntoPage:g,onAccept:S,parentBlockId:h,query:y,recentPageResults:B,itemsToMove:M,templateResults:C,topLevelBlockResults:P}):(0,p().OC)({allItemsToMoveAreNavigable:e,blockResults:j,chosenSpaceStore:I,environment:b,forceShowPrivatePageOption:t,intl:A,isAddTo:o,isCreateIn:m,showDataSources:v,onAccept:S,query:y,recentPageResults:B,savedQuickAddParent:k.value,itemsToMove:M,theme:T}):[]),[e,j,I,x,b,t,A,o,m,g,S,h,y,B,k.value,D,M,C,T,P,N.value,v])}},587989:(e,t,o)=>{o.d(t,{c:()=>p});o(898992),o(672577);var a=o(296540),s=()=>o(69708),i=()=>o(939740),n=()=>o(64e3),r=()=>o(89924),l=()=>o(284371),c=o(474848);function d({loading:e,menuListItemProps:t}){const a=(0,o(484714).v3)(),{isMobile:i}=a.device,n=(0,o(401497).IS)((e=>({button:{display:"flex",flexDirection:"row",alignItems:"center",color:e.text.tertiary,...i?{fontSize:l().J.UIRegular.mobile,lineHeight:l().K_.UIRegular.mobile,padding:4}:{fontSize:l().J.UIRegular.desktop,lineHeight:l().K_.UIRegular.desktop,margin:"0px 4px 4px",padding:4,borderRadius:4}},icon:{width:14,height:14,marginInlineEnd:8,marginInlineStart:8,fill:e.icon.tertiary},loadingSpinner:{marginInlineStart:8}})),[i]);return(0,c.jsxs)(o(718827).Ay,{style:n.button,...t,children:[(0,o(158359).P)(n.icon),(0,c.jsx)(s().sA,{defaultMessage:"Load more",id:"moveToMenu.loadMoreButtonTitle"}),e?(0,c.jsx)(o(98126).A,{size:"sm",style:n.loadingSpinner}):void 0]})}const u=a.memo(d);function p({sections:e,error:t,menuListStore:o,initialFocus:l,onLoadMore:d,canLoadMore:p,loading:m}){const g=(0,a.useMemo)((()=>p&&(null==e?void 0:e.find((e=>"pages"===e.key)))),[p,e]);if(t)return(0,c.jsx)(r().A,{children:(0,c.jsx)(n().A,{title:(0,c.jsx)(s().sA,{defaultMessage:"Something went wrong.",id:"moveBlockMenu.errorOnMove.label"})})});if(e&&0===e.length)return(0,c.jsx)(r().A,{children:(0,c.jsx)(n().A,{title:(0,c.jsx)(s().sA,{defaultMessage:"No results",id:"moveBlockMenu.noResults.label"})})});const v=[...e||[],...g?[{key:"moveTo load more section",render:e=>(0,c.jsx)(r().A,{disableDesktopPadding:!0,...e}),items:[{key:"moveTo load more button",render:e=>(0,c.jsx)(u,{menuListItemProps:e,loading:m}),action:d}]}]:[]];return(0,c.jsx)("div",{children:(0,c.jsx)(i().Ay,{type:i().Oh.Vertical,initialFocus:l,sections:v,store:o})})}},644434:(e,t,o)=>{o.d(t,{J:()=>g});o(898992),o(581454),o(737550),o(296540);var a=()=>o(56366),s=()=>o(401497),i=()=>o(700500),n=()=>o(496603),r=()=>o(284371),l=()=>o(805751),c=()=>o(125565),d=()=>o(372657),u=()=>o(148832),p=()=>o(873643),m=o(474848);function g(e){const{spaceStore:t,spaceViewStore:o,itemStores:g,depth:v,addedItems:S,moveToPagesOnly:h,itemsToMove:y,onAccept:f}=e,M=(0,a().K8)((()=>{const e=g?n().oE(g.map((e=>{if((0,d().zP)(e,y)){const a=e instanceof u().B&&e.getType()===i().xd.alias,s=a?e.getAliasTargetStore():void 0,n=s instanceof u().B?s:e,r=e instanceof u().B&&e.isCollectionView()&&e.hasMultipleOwnedCollections()&&y.some((e=>e instanceof u().B));return(0,m.jsx)(p().E,{spaceStore:t,spaceViewStore:o,store:n,depth:v,onAccept:f,itemsToMove:y,isAlias:a,moveToChildrenOnly:h&&!(n instanceof u().B)||r},e.id)}}))):[];return S?[...S,...e]:e}),[g,S,h,y,f,t,o,v]),A=(0,s().IS)((e=>({sectionHeader:{color:e.text.secondary,fontSize:12,fontWeight:r().Wy.medium,paddingTop:12,paddingInlineEnd:14,paddingBottom:4,paddingInlineStart:14}})),[]);return(0,m.jsxs)(l().A,{debugName:"MoveToOutliner",capture:!0,allowEsc:!0,allowLeft:!0,children:[e.title?(0,m.jsx)("div",{style:A.sectionHeader,children:(0,m.jsx)(c().A,{isSmall:!0,children:e.title})}):void 0,(0,m.jsx)("div",{children:M})]})}},828048:(e,t,o)=>{o.d(t,{C:()=>he,m:()=>ye});o(16280),o(898992),o(823215),o(581454);var a=o(296540),s=()=>o(484714),i=()=>o(56366),n=()=>o(401497),r=()=>o(252291),l=()=>o(584262),c=()=>o(97789),d=()=>o(484392),u=()=>o(568999),p=()=>o(617668),m=()=>o(406533),g=()=>o(721479),v=()=>o(201980),S=()=>o(69708),h=()=>o(496603),y=()=>o(534177),f=()=>o(333334),M=()=>o(44729),A=()=>o(384944),T=()=>o(857783),b=()=>o(319975),x=()=>o(812182),I=()=>o(231297),k=()=>o(845147),w=()=>o(895876),j=()=>o(462032),P=()=>o(760217),C=()=>o(285790),B=()=>o(298697),D=()=>o(939740),N=()=>o(89924),R=()=>o(859428),L=()=>o(635462),O=()=>o(372657),K=()=>o(162674),E=()=>o(631524),V=()=>o(160432),z=()=>o(957963),q=()=>o(623580),_=()=>o(676007),W=()=>o(754002),H=()=>o(124749);class F extends(()=>o(757695))().Store{getInitialState(){return!1}}const U=new F;var Q=o(474848);const G=(0,S().YK)({title:{id:"tasksCreateNewDatabase.modal.title",defaultMessage:"How would you like to name your private task database?"},placeholder:{id:"tasksCreateNewDatabase.modal.placeholder",defaultMessage:"{username}’s to-do list"},create:{id:"tasksCreateNewDatabase.modal.create",defaultMessage:"Create database"},cancel:{id:"tasksCreateNewDatabase.modal.cancel",defaultMessage:"Cancel"}}),$=380,Y=24;function J(e){const{handleCreateTaskDatabase:t}=e,o=(0,S().tz)(),r=(0,H().$)(),l=(0,i().K8)((()=>null==r?void 0:r.getDisplayName(o)),[r,o]),c=(0,s().Y0)(),[d,u]=(0,a.useState)(""),p=(0,i().O$)(U),m=(0,n().IS)((e=>({container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:`${Y}px`,width:$},editPropertyTypeIcon:{width:32,height:32,fill:e.text.tertiary},title:{color:e.text.primary,textAlign:"center"},input:{width:"100%",height:36,fontSize:16,marginTop:16,marginBottom:`${Y}px`},createButton:{width:"100%",height:36,fontSize:16,marginBottom:16},cancelButton:{color:e.text.secondary,fontSize:16}})),[]),g=(0,a.useCallback)((()=>{d.trim()&&(t(d),U.setState(!1))}),[d,t]),v=(0,a.useCallback)((()=>{U.setState(!1)}),[]),h=(0,a.useCallback)((e=>{"Enter"===e.key&&g()}),[g]),y=(0,a.useCallback)((e=>{u(e.target.value)}),[u]),f=(0,a.useCallback)((()=>(0,Q.jsxs)("div",{style:m.container,children:[(0,Q.jsx)("div",{children:(0,z().j)(m.editPropertyTypeIcon)}),(0,Q.jsx)("h3",{style:m.title,children:o.formatMessage(G.title)}),(0,Q.jsx)(q().A,{value:d,onChange:y,placeholder:o.formatMessage(G.placeholder,{username:l}),style:m.input,autoFocus:!0,onKeyDown:h}),(0,Q.jsx)(V().A,{colorPalette:"blue",style:m.createButton,onClick:g,children:o.formatMessage(G.create)}),(0,Q.jsx)(E().p,{style:m.cancelButton,onClick:()=>{U.setState(!1)},children:o.formatMessage(G.cancel)})]})),[d,l,y,h,g,o,m.cancelButton,m.container,m.createButton,m.editPropertyTypeIcon,m.input,m.title]);return p?c.isPhone?(0,Q.jsx)(W()._,{fullscreen:!0,renderInner:f}):(0,Q.jsx)(_().a,{open:!0,showCloseIcon:!0,onDismiss:v,render:f}):null}var Z=()=>o(610101),X=()=>o(765957),ee=()=>o(832820),te=()=>o(188669),oe=()=>o(59226),ae=()=>o(187174),se=()=>o(519831),ie=()=>o(543665),ne=()=>o(559506);var re=()=>o(271372),le=()=>o(645873),ce=()=>o(106628),de=()=>o(361330);function ue({environment:e,spaceStore:t,joinedTeamIds:o,parentStore:a,moveToTargets:s,overrideDatabaseType:n}){const r=(0,i().K8)((()=>{const e=null==t?void 0:t.id;if(e)return function(e){if(!ee().c.state)return;if(e!==ee().c.state.spaceId)return;return ee().c.state.typedDatabases}(e)}),[null==t?void 0:t.id]),l=(0,oe().X)("typed_move_to_improved_default_results"),c=(0,le().fJ)(ce().T.searchActions),[{value:d,status:u}]=(0,ae().Yb)((async()=>{if(r)return r;if(!t||!a)return;const i=n??te().Ay.getDatabaseType();if(!i)return;if("resolved"!==c.status)return;const d=c.value;let u=[];if(l){const o=((await d.searchCollectionsWithRecents({environment:e,query:"",limit:20,databaseType:[i],spaceStore:t,parentStore:t,collectionViewBlockStore:void 0,searchSessionId:te().Ay.state.isOpen?te().Ay.state.flowId:void 0,peopleBlocksToInclude:"none"})).results||[]).map((e=>ie().m.createChildStore(a,{table:se().Vl,id:e})));u=(0,re().vl)({typedDatabases:o,blocksToFilterParents:s})}else{const s=await async function({environment:e,spaceId:t,databaseType:o,parentStore:a}){if(!t)return;const s=await ne().callApi({eventName:"getTypedDatabases",environment:e,data:{spaceId:t,databaseType:o}});return"success"===s.type?s.data.result.map((e=>ie().m.createChildStore(a,{table:se().Vl,id:e.collectionId}))):void 0}({environment:e,spaceId:t.id,databaseType:i,parentStore:a})??[];u=(0,re().gq)({environment:e,typedDatabases:s,spaceStore:t,joinedTeamIds:o})}return ee().c.setState({typedDatabases:u,spaceId:t.id}),te().Ay.update((e=>e.isOpen&&"untyped"===e.variant?{...e,variant:"typed"}:e)),u}),[r,t,a,n,c.status,c.value,l,e,s,o],{debounce:de().tu,throttle:de().tu});return r?{success:!0,typedDatabases:r}:"resolved"===u&&d?{success:!0,typedDatabases:d}:{success:!1}}var pe=()=>o(276303),me=()=>o(478495),ge=()=>o(139466),ve=()=>o(873643);const Se=7;function he(e){const{spaceStore:t,spaceViewStore:o,blocksToMove:g,menuListStore:C,onAccept:R,moveToPagesOnly:E,forceShowPrivatePageOption:V,maxMenuItems:z=Se}=e,q=(0,s().v3)(),_=(0,S().tz)(),W=(0,n().DP)(),{isMyTasksFullPage:H,sidebarSpaceStore:F}=(0,i().K8)((()=>{const{sidebarSpaceStore:e,mainEditorCurrentBlockStore:t}=X().default.state;return{isMyTasksFullPage:Boolean(t&&(0,L().s)(t.id)),sidebarSpaceStore:e}}),[]),G=(0,i().K8)((()=>o.getTeamsStores().map((e=>e.id))),[o]),$=(0,i().K8)((()=>te().Ay.getDatabaseType()),[]),Y=(0,i().K8)((()=>O().Hc()),[]),oe=ue({environment:q,spaceStore:t,parentStore:t,joinedTeamIds:G,moveToTargets:g}),ae=(0,n().IS)((e=>({modal:{maxHeight:"70vh"},loadingShimmer:{padding:16},privateMenuItem:{marginInlineStart:4,marginInlineEnd:4,borderRadius:4},menuItemFooterButton:{color:e.text.secondary,fill:e.icon.secondary}})),[]),se=(0,a.useCallback)((e=>{const o={key:e.id,render:o=>(0,Q.jsx)(ge().d,{spaceStore:t,collectionStore:e,menuListItemProps:o}),action:()=>R({type:"collection",id:e.id,spaceId:t.id})};return o}),[t,R]),ie=(0,i().K8)((()=>oe.success?oe.typedDatabases.map((e=>se(e))):[]),[oe,se]);(0,a.useEffect)((()=>{0===ie.length&&te().Ay.setState({...te().Ay.state,variant:"untyped"})}),[ie.length]);const ne=(0,i().K8)((()=>(0,me().VN)({itemsToMove:g,chosenSpaceStore:t,forceShowPrivatePageOption:V,sidebarSpaceStore:F})),[V,t,g,F]),re=(0,i().K8)((()=>{const{isMobile:e}=q.device;if(e){const e=g.every((e=>e.isNavigableBlock()));return(0,pe().oG)({query:"",chosenSpaceStore:t},q,W,_,g,R,e,V)}return{key:"privateMenuItem",render:e=>(0,Q.jsx)("div",{style:ae.privateMenuItem,children:(0,Q.jsx)(ve().E,{spaceStore:t,spaceViewStore:o,store:void 0,depth:0,onAccept:R,itemsToMove:g,moveToChildrenOnly:E,menuListItemProps:e,from:"moveToModalTyped"})}),action:()=>{}}}),[q,V,_,E,R,t,o,ae.privateMenuItem,g,W]),le=H?"home_tasks":"home_tile_tasks",ce=(0,a.useMemo)((()=>({key:"helpMenuItem",render:()=>(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(j().CollectionTasksEmptyStateModal,{from:le}),(0,Q.jsx)(P().A,{style:ae.menuItemFooterButton,icon:(0,Q.jsx)(r().I,{icon:m().questionMarkCircleIcon}),focused:!1,title:(0,Q.jsx)(S().sA,{defaultMessage:"Don’t see your database?",id:"moveToModalTyped.helpMenuItem.title"}),onClick:()=>{Z().A.setState(!0),(0,K().bS)({environment:q,from:le})}})]}),action:()=>{}})),[q,le,ae.menuItemFooterButton]),de=(0,a.useCallback)((e=>{let a,s;I().createAndCommit({userAction:"moveToModalTyped.handleCreateTodoList",environment:q,canUndo:!0,perform(i){var n;a=A().Wv({environment:q,transaction:i,type:"collection_view",inMemoryRecordCache:q.defaultRecordCache.inMemoryRecordCache}),M().NI({childStore:a,parentStore:t,transaction:i});const r=k().initializeApp({environment:q,spaceViewStore:o,appUri:c().a6,presetUri:"notion://tasks_collection_typedDBpreset",appParentStore:t,temporaryContainerBlockStore:a,transaction:i,from:"my_tasks",skipNavigation:!0});s=null==r||null===(n=r[0])||void 0===n?void 0:n.getCollectionStoreIfSingleSource(),s&&b().R9({environment:q,store:s.getNameStore(),value:(0,v().x9d)(e),transaction:i}),x().HK({id:"database_creation_toast",title:_.formatMessage({id:"moveToModalTyped.databaseCreated.title",defaultMessage:"Database created"}),message:_.formatMessage({id:"moveToModalTyped.databaseCreated.message",defaultMessage:'"{name}" has been created'},{name:e}),presentationType:"persistent",iconGroup:u().g,iconGroupColorPalette:"green",iconGroupColorVariant:"accentPrimary",actions:{primary:{title:_.formatMessage({id:"moveToModalTyped.databaseCreated.openDatabase",defaultMessage:"Open database"}),onAction:()=>{T().uK({environment:q,store:null==r?void 0:r[0],pageVisitSource:l().y8.PersonalHomePage}),x().UW("database_creation_toast")}}}})}}),s&&(0,ee().D)(s),f().VN({environment:q,clearSelection:!0})}),[q,_,t,o]),he=(0,a.useMemo)((()=>({key:"createDatabaseItem",render:()=>(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(J,{handleCreateTaskDatabase:de}),(0,Q.jsx)(P().A,{style:ae.menuItemFooterButton,icon:(0,Q.jsx)(r().I,{icon:p().plusIcon}),focused:!1,title:(0,Q.jsx)(S().sA,{defaultMessage:"New private task database",id:"moveToModalTyped.createDatabaseItem.title"}),onClick:()=>{U.setState(!0)}})]}),action:()=>{}})),[de,ae.menuItemFooterButton]);if(!oe.success||0===ie.length)return(0,Q.jsx)("div",{style:ae.loadingShimmer,children:(0,Q.jsx)(B().A,{paragraphs:[{lineHeight:18,lineMargin:4,sectionWidths:[100],repeat:1,sectionMargin:0},{lineHeight:14,lineMargin:4,sectionWidths:[100,40],repeat:1,sectionMargin:-2}]})});if(!$)throw new Error("Trying to show typed moveTo modal when database type is not available.");const fe=(0,w().$O)($),Me=h().oE([{key:"suggested",render:e=>(0,Q.jsx)(N().A,{...e,title:Y?(0,Q.jsx)(S().sA,{defaultMessage:"{typedItemName} databases",id:"moveToModalTyped.suggestedMenuSection.title",values:{typedItemName:(0,d().A)(fe)}}):(0,Q.jsx)(S().sA,{defaultMessage:"Where would you like to create your {typedItemName}?",id:"moveToModalTyped.suggestedMenuSection.titleNew",values:{typedItemName:fe}}),right:Y?(0,Q.jsx)(ye,{typedItemName:fe}):null}),items:ie.slice(0,z)},ne&&(0,y().O9)(re)&&{key:"other",render:e=>(0,Q.jsx)(N().A,{...e,title:(0,Q.jsx)(S().sA,{defaultMessage:"Other",id:"moveToModalTyped.otherSection.title"})}),items:[re]},!Y&&{key:"create-new-footer",render:e=>(0,Q.jsx)(N().A,{...e,topBorder:!0}),items:[ce,he]}]);return(0,Q.jsx)("div",{style:ae.modal,children:(0,Q.jsx)(D().Ay,{initialFocus:0,type:D().Oh.Vertical,sections:Me||[],store:C})})}function ye(e){const{typedItemName:t}=e,o=(0,S().tz)(),{isMobile:a}=(0,s().Y0)(),i=(0,n().IS)((e=>({tooltip:{width:220},icon:{width:16,height:16,fill:e.icon.secondary},iconButton:{height:18,width:18,padding:0,marginTop:-4,marginBottom:-4,marginInlineEnd:-4}})),[]);return a?null:(0,Q.jsx)(R().A,{placement:"bottom",style:i.tooltip,textWrap:!0,renderTooltip:()=>(0,Q.jsx)(S().sA,{defaultMessage:"{typedItemName} properties will be kept when moving to these locations",id:"moveTypedMenu.tooltip",values:{typedItemName:(0,d().A)(t)}}),render:e=>(0,Q.jsx)(C().A,{ariaLabel:o.formatMessage({id:"moveToModalTyped.helpIcon.ariaLabel",defaultMessage:"Help icon for moving typed pages."}),icon:g().questionMarkCircleSmallIcon,iconStyle:i.icon,style:i.iconButton,...e})})}},832820:(e,t,o)=>{o.d(t,{D:()=>s,c:()=>a});const a=o(757695).Store.createValue(void 0,{name:"CachedTypedDatabasesStore"});function s(e){const t=a.state;t&&a.setState({...t,typedDatabases:[...t.typedDatabases,e]})}},845566:(e,t,o)=>{o.d(t,{x:()=>i});o(898992),o(672577);var a=()=>o(765957);class s extends(()=>o(757695))().Store{getInitialState(){return{chosenSpaceId:void 0}}getChosenSpaceId(){const{chosenSpaceId:e}=this.state,{sidebarSpaceStore:t}=a().default.state;return e||(null==t?void 0:t.id)}getChosenSpaceStore(){var e;return null===(e=this.getChosenSpaceViewStore())||void 0===e?void 0:e.getSpaceStore()}getChosenSpaceViewStore(){const{chosenSpaceId:e}=this.state,{sidebarSpaceViewStore:t,currentUserRootStore:o}=a().default.state;if(!e&&t)return t;if(e&&o){return o.getSpaceViewStores().find((t=>t.getSpaceId()===e))}}}const i=new s},873643:(e,t,o)=>{o.d(t,{E:()=>R});o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520);var a=o(296540),s=()=>o(484714),i=()=>o(56366),n=()=>o(401497),r=()=>o(718827),l=()=>o(700500),c=()=>o(315564),d=()=>o(449552),u=()=>o(500066),p=()=>o(854150),m=()=>o(69708),g=()=>o(95313),v=()=>o(187820),S=()=>o(16006),h=()=>o(453697),y=()=>o(606273),f=()=>o(381678),M=()=>o(372657),A=()=>o(396301),T=()=>o(188669),b=()=>o(148832),x=()=>o(543665),I=()=>o(95758),k=()=>o(898808),w=()=>o(644434),j=o(474848);const P=100,C=14,B=4;function D(e){return(e+1)*C}function N({depth:e,isSidebar:t}){const o=(0,n().IS)((t=>({container:{display:"flex",flexDirection:"row"},noChildrenLabelItem:{paddingInlineStart:D(e)+B,fontSize:14,paddingBottom:6,color:t.text.tertiary}})),[e]);return(0,j.jsxs)("div",{style:o.container,children:[(0,j.jsx)(y().h,{isSidebar:t}),(0,j.jsx)("div",{style:o.noChildrenLabelItem,children:(0,j.jsx)(m().sA,{defaultMessage:"No pages inside",id:"moveToMenu.outliner.noPagesInside.placeholder"})})]})}function R(e){const{store:t,spaceStore:o,spaceViewStore:C,depth:R,isAlias:L,menuListItemProps:O,from:K,itemsToMove:E}=e,V=(0,s().v3)(),z=(0,n().DP)(),[q,_]=a.useState(!1),W=(0,n().IS)((e=>({outlinerItem:{display:"flex",flexDirection:"row",fontSize:14,height:28,paddingInlineStart:"moveToModalTyped"===K?D(R)-B:D(R),color:e.text.primary,alignItems:"center"},icon:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,flexGrow:0,width:22,height:18,marginInlineEnd:B,position:"relative"},button:{..."moveToModalTyped"===K?{borderRadius:4}:{}}})),[R,K]);function H(){const e=T().Ay.state,o=e.isOpen?e.flowId:void 0;_(!q),g().aM(V,{flowId:o,is_toggled:!q,destination_type:t?t.table:"private_pages"})}const F=(0,i().K8)((()=>{if(t){const e=(0,j.jsx)("div",{children:(0,u().G)({position:"absolute",width:"50%",height:"50%",insetInlineEnd:0,bottom:0})});return t instanceof I().h?(0,j.jsx)("div",{style:W.icon,children:(0,j.jsx)(k().x,{disabled:!0,store:t,size:18})}):(0,j.jsxs)("div",{style:W.icon,children:[(0,j.jsx)(v().B6,{icon:t.getIcon(),iconRecordCategory:(0,v().Te)(t),isEmptyPage:t instanceof b().B&&t.isEmptyPage(),size:18,disabled:!0}),L?e:void 0]})}return(0,j.jsx)(h().A,{size:16,userStore:(0,f()._)(V),style:{marginInlineStart:3}})}),[t,W.icon,V,L]),U=(0,i().K8)((()=>t?t.table===p().yK?"private"!==t.getTeamAccessLevel()?(0,j.jsx)("div",{style:{maxWidth:"80%"},children:(0,j.jsx)(S().A,{store:t})}):(0,j.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",maxWidth:"80%"},children:[(0,j.jsx)(S().A,{store:t}),(0,d().g)({width:14,height:14,marginInlineStart:B,fill:z.icon.secondary})]}):(0,j.jsx)("div",{style:{maxWidth:"80%"},children:(0,j.jsx)(S().A,{store:t})}):(0,j.jsxs)("div",{style:{display:"flex",alignItems:"center",marginInlineStart:7},children:[(0,j.jsx)(m().sA,{defaultMessage:"Private pages",id:"outliner.addToPrivatePages"}),(0,j.jsx)("div",{style:{marginInlineStart:2},children:(0,c().S)({width:14,height:14,fill:z.icon.secondary,marginInlineStart:B})})]})),[t,z.icon.secondary]),Q=(0,i().K8)((()=>{const e=new Set([l().xd.page,l().xd.collectionViewPage,l().xd.collectionView,l().xd.alias]),o=new Set([l().xd.factory]);let a=[];return t?t instanceof I().h?a=t.getTeamPagesStores():t instanceof x().m?a=[]:t.isCollectionView()?a=t.hasSingleOwnedCollection()?[]:t.getCollectionStores()??[]:t instanceof b().B&&(a=(0,A().yD)({rootStore:t,shouldSkipItemTypes:o,shouldShowItemTypes:e})):a=C.getPrivatePages(V)??[],a=a.filter((e=>(0,M().zP)(e,E))),a}),[t,C,V,E]),G=(0,i().K8)((()=>!(t instanceof x().m)&&(!(t instanceof b().B&&t.isCollectionView())||Q.length>0)),[t,Q]);const $=!0,Y=0!==Q.length?(0,j.jsx)(w().J,{spaceStore:o,spaceViewStore:C,itemStores:Q,depth:R+1,onAccept:e.onAccept,itemsToMove:E}):(0,j.jsx)(N,{depth:R,isSidebar:$});return(0,j.jsxs)("div",{...O,children:[(0,j.jsx)(r().Ay,{onClick:function(){e.moveToChildrenOnly&&G?H():t?t instanceof b().B?e.onAccept({type:"page",id:t.id,spaceId:o.id}):t instanceof x().m?e.onAccept({type:"collection",id:t.id,spaceId:o.id}):e.onAccept({type:"team",id:t.id,spaceId:o.id}):e.onAccept({type:"space-private-pages",spaceId:o.id})},style:W.button,children:(0,j.jsxs)("div",{style:W.outlinerItem,children:[G?(0,j.jsx)(y().f,{isSidebar:$,fill:!0,icon:"chevron",open:q,color:z.icon.secondary,onClick:H}):(0,j.jsx)(y().h,{isSidebar:$}),F,U]})}),q&&R<P?Y:void 0]})}},957963:(e,t,o)=>{o.d(t,{j:()=>s});o(296540);var a=o(474848);const s=(0,o(340498).wt)("editPropertyType",{viewBox:"0 0 16 16 ",svg:(0,a.jsx)("path",{d:"M11.5615 4.84473L12.2998 4.11328C12.6689 3.74414 12.6826 3.34082 12.3545 3.00586L12.0879 2.73926C11.7529 2.4043 11.3428 2.43848 10.9736 2.79395L10.2354 3.52539L11.5615 4.84473ZM3.22168 13.1641L10.9053 5.4873L9.59277 4.16797L1.90918 11.8516L1.23926 13.4512C1.16406 13.6562 1.37598 13.875 1.57422 13.7998L3.22168 13.1641ZM3.92578 13.8066H14.1045C14.4736 13.8066 14.7744 13.499 14.7744 13.1367C14.7744 12.7676 14.4736 12.4668 14.1045 12.4668H5.27246L3.92578 13.8066Z"})})},963248:(e,t,o)=>{o.d(t,{Xy:()=>te,n5:()=>ee,v8:()=>$});o(898992),o(823215),o(354520),o(581454);var a=o(296540),s=()=>o(726637),i=()=>o(484714),n=()=>o(56366),r=()=>o(401497),l=()=>o(998531),c=()=>o(97294),d=()=>o(98126),u=()=>o(631524),p=()=>o(803960),m=()=>o(765974),g=()=>o(344417),v=()=>o(245241),S=()=>o(69708),h=()=>o(496603),y=()=>o(284371),f=()=>o(895876),M=()=>o(760217),A=()=>o(802790),T=()=>o(805751),b=()=>o(419357),x=()=>o(404277),I=()=>o(187820),k=()=>o(89924),w=()=>o(933117),j=()=>o(125565),P=()=>o(722872),C=()=>o(372657),B=()=>o(232930),D=()=>o(625247),N=()=>o(665381),R=()=>o(272509),L=()=>o(135599),O=()=>o(62856),K=()=>o(765957),E=()=>o(832820),V=()=>o(970585),z=()=>o(845566),q=()=>o(188669),_=()=>o(265665),W=()=>o(572748),H=()=>o(587989),F=()=>o(276303),U=()=>o(478495),Q=()=>o(828048),G=o(474848);function $(e){const{autocompleteQuery:t,blocksToMove:o,forceShowPrivatePageOption:a=!1,isAddTo:s,isCreateIn:i,isTurnIntoPage:r,onAccept:l,parentBlockId:c}=e,d=(0,n().uB)(void 0,V().A),u=(0,n().K8)((()=>(0,F().wc)()),[]),p=(0,n().K8)((()=>(0,F().L2)(q().Ay.state)),[]),m=(0,n().K8)((()=>(0,C().iH)(o)),[o]),g=(0,L().W)({type:v().Vz.BlocksInSpace,query:t,limit:p,source:"move_to_menu",filters:{requireEditPermissions:!1,excludeTemplates:!1},options:{disable:!1,overrideSpaceStore:u},excludedBlockIds:[m].filter((e=>void 0!==e)),peopleBlocksToInclude:"none"}),S=(0,n().K8)((()=>o.length>0&&o.every((e=>e.isNavigableBlock()))),[o]),h=(0,W().t)({allItemsToMoveAreNavigable:S,forceShowPrivatePageOption:a,isAddTo:s,isCreateIn:i,isTurnIntoPage:r,onAccept:l,parentBlockId:c,query:t,searchResults:g,itemsToMove:o});return(0,G.jsx)(Y,{...e,isLoading:g.isResultsLoading,allItemsToMoveAreNavigable:S,autocompleteComponent:(0,G.jsx)(H().c,{sections:h,error:void 0,menuListStore:d,initialFocus:t?0:void 0,loading:g.isResultsLoading,canLoadMore:g.hasMoreResults,onLoadMore:()=>{var e;return null===(e=g.fetchAdditionalServerResultsOnChange)||void 0===e?void 0:e.call(g,p)}})})}function Y(e){const{blocksToMove:t,isCreateIn:o,onAccept:i,isAddTo:r,isTurnIntoPage:c,autocompleteQuery:d,onAutocompleteQueryChange:u,onMouseEnter:p,onCancel:m,desktopWidth:g,forceShowPrivatePageOption:v=!1,isLoading:h,allItemsToMoveAreNavigable:y,autocompleteComponent:f}=e,M=(0,n().uB)(void 0,V().A),A=(0,n().K8)((()=>(0,F().R3)()),[]),b=(0,n().K8)((()=>q().Ay.state.isOpen),[]),I=(0,n().K8)((()=>C().n6()),[]);if((0,a.useEffect)((()=>{z().x.reset()}),[b]),!r&&!o&&!b)return null;let k;k=s().A.isMobile?{onMouseEnter:p,menuType:P().gu.Modal,title:c?(0,G.jsx)(S().sA,{defaultMessage:"Add to another page",id:"moveBlockMenu.mobileNewPageInj.label"}):r?(0,G.jsx)(S().sA,{defaultMessage:"Add new page in",id:"moveBlockMenu.mobileAddTo.label"}):(0,G.jsx)(S().sA,{defaultMessage:"Move to",id:"moveBlockMenu.mobileMoveTo.label"}),right:(0,G.jsx)(S().sA,{defaultMessage:"Done",id:"moveBlockMenu.rightDoneButton.label"}),onClickRight:m,height:"100%"}:{onMouseEnter:p,menuType:P().gu.Popup,width:g};const w=!Boolean(d)&&!s().A.isMobile||I&&!Boolean(d)||o&&s().A.isMobile;return(0,G.jsxs)(T().A,{debugName:"MoveToOrCreateMenu",capture:!0,allowMenuList:!0,allowEsc:!0,allowLeft:!0,allowTabUntab:!1,allowUndo:!1,children:[(0,G.jsx)(l().N,{debugName:"MoveToOrCreateMenu",capture:!0,onEsc:m}),(0,G.jsxs)(x().A,{...k,onClick:e=>{e.stopPropagation()},footer:(0,G.jsx)(ee,{isCreateIn:o,isAddTo:r,allItemsToMoveAreNavigable:y}),children:[A?(0,G.jsx)(te,{autocompleteQuery:d,onAutocompleteQueryChange:u,isAddTo:r,isTurnIntoPage:c,menuListStore:M,isLoading:h}):void 0,w?(0,G.jsx)(X,{onAccept:i,blocksToMove:t,menuListStore:M,allItemsToMoveAreNavigable:y,forceShowPrivatePageOption:v}):f]})]})}function J(e){return{width:s().A.isMobile?18:10,marginInlineStart:4,fill:e.icon.tertiary}}function Z(){var e,t;return(null===(e=(0,F().wc)())||void 0===e?void 0:e.id)!==(null===(t=K().default.state.sidebarSpaceStore)||void 0===t?void 0:t.id)}function X({onAccept:e,blocksToMove:t,menuListStore:o,allItemsToMoveAreNavigable:a,forceShowPrivatePageOption:s}){const r=(0,i().v3)(),l=(0,n().K8)((()=>(0,F().wc)()),[]),c=(0,n().K8)((()=>(0,F().NA)()),[]),d=(0,n().K8)((()=>C().n6()),[]),u=(0,n().K8)((()=>(0,R().I)(l)),[l]);if(!c||!l)return null;const p=!a||u;return d?(0,G.jsx)(Q().C,{spaceStore:l,spaceViewStore:c,onAccept:t=>(0,F().nG)(t,e,r),blocksToMove:t,menuListStore:o,moveToPagesOnly:p,forceShowPrivatePageOption:s,maxMenuItems:5}):(0,G.jsx)(U().Cr,{spaceStore:l,spaceViewStore:c,onAccept:e,itemsToMove:t,moveToPagesOnly:p,forceShowPrivatePageOption:s})}function ee({isCreateIn:e,isAddTo:t,allItemsToMoveAreNavigable:o}){const a=(0,S().tz)(),l=(0,r().DP)(),c=(0,i().v3)(),{currentUserRootStore:d,sidebarSpaceStore:m}=(0,n().K8)((()=>{const{currentUserRootStore:e,sidebarSpaceStore:t}=K().default.state;return{currentUserRootStore:e,sidebarSpaceStore:t}}),[]),g=(0,n().K8)((()=>(0,F().wc)()),[]),v=(0,n().K8)((()=>o&&!(null!=m&&m.getDisableMoveToSpace())&&!e&&!t),[o,m,e,t]),y=(0,n().K8)((()=>null==d?void 0:d.getSpaceViewStores()),[d]),f=(0,n().K8)((()=>h().hS(h().oE(null==y?void 0:y.map((e=>{const t=e.getSpaceStore();return!(0,R().I)(t)&&t}))),(e=>e.id))),[y]);if(!d||!g||!m)return null;if(!v)return null;const T={menuTitle:a.formatMessage({defaultMessage:"Workspaces",id:"moveBlockMenu.spaceSwitcher.menuTitle"}),items:f,selectedItem:g,onSelect:e=>{z().x.setState({chosenSpaceId:e.id})},getKey:e=>e.id,renderItem:e=>(0,G.jsx)(M().A,{...e,isChecked:e.value.id===g.id,title:(0,N().G)(c,e.value),icon:(0,G.jsx)(I().B6,{icon:(0,D().c)(c,e.value),isEmptyPage:!1,size:20,disabled:!0,title:(0,N().G)(c,e.value)})}),renderOrigin:e=>(0,G.jsxs)(u().p,{size:s().A.isMobile?"xl":"sm",style:{fontWeight:"normal",fontSize:s().A.isMobile?16:12,flexShrink:1},...e,children:[(0,G.jsx)(I().B6,{disabled:!0,icon:g.getIcon(),iconRecordCategory:"workspace",isEmptyPage:!1,size:s().A.isMobile?22:16,title:g.getName(),style:{marginInlineEnd:s().A.isMobile?6:4}}),(0,G.jsx)(_().j,{children:(0,N().G)(c,g)}),(0,p().arrowChevronSingleDownIcon)(J(l))]}),width:150};return(0,G.jsxs)("div",{children:[(0,G.jsx)(A().A,{size:1}),(0,G.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",padding:"4px"},children:(0,G.jsx)(w().A,{...T},"space-switcher")})]})}function te({isLoading:e,autocompleteQuery:t,onAutocompleteQueryChange:o,isDataSource:a,isAddTo:i,isTurnIntoPage:l,menuListStore:u}){const p=(0,S().tz)(),v=(0,n().K8)((()=>C().n6()&&q().Ay.state.isOpen&&"typed"===q().Ay.state.variant&&!E().c.state),[]),h=(0,n().K8)((()=>function({intl:e,isDataSource:t,isAddTo:o,isTurnIntoPage:a}){if(t)return e.formatMessage({defaultMessage:"Move data source to…",id:"moveToMenuRenderer.moveDataSourceTo.label"});if(Z())return e.formatMessage({defaultMessage:"Duplicate page…",id:"moveToMenuRenderer.duplicateToSpace.label"});if(C().n6()){const t=q().Ay.getDatabaseType();if(C().Hc()){const o=(0,f().$O)(t);return e.formatMessage({defaultMessage:"Move {typedItemName} to…",id:"moveToMenuRenderer.moveTo.typedLabel"},{typedItemName:o})}{const o=(0,f().$O)(t);return e.formatMessage({defaultMessage:"Search for a {typedItemName} database…",id:"moveToMenuRenderer.createIn.typedLabel"},{typedItemName:o})}}return a?e.formatMessage({defaultMessage:"Search page to add in…",id:"moveToMenuRenderer.addNewPageIn.label"}):o?e.formatMessage({defaultMessage:"Search page to add to…",id:"moveToMenuRenderer.addTo.label"}):e.formatMessage({defaultMessage:"Move page to…",id:"moveToMenuRenderer.moveTo.teamLabel"})}({intl:p,isDataSource:a,isAddTo:i,isTurnIntoPage:l})),[p,a,i,l]),M=(0,r().IS)((e=>({moveToAnotherSpaceMessage:{background:e.palette.gray[30],marginTop:s().A.isMobile?12:8,marginInlineStart:s().A.isMobile?16:12,marginInlineEnd:s().A.isMobile?16:12,padding:s().A.isMobile?12:8,borderRadius:6},moveToAnotherSpaceIcon:{fill:e.palette.orange[400],width:14,height:14,marginInlineEnd:4,alignSelf:"center",display:"inline-block",verticalAlign:"text-bottom"},moveToAnotherSpaceLink:{color:e.palette.gray[500],fontWeight:y().Wy.semibold,marginTop:4}})),[]),A=(0,n().K8)((()=>Z()),[]),T=(0,O().A)(e,400,0);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(k().A,{extraTopPadding:!s().A.isMobile,children:(0,G.jsx)(b().Ay,{onCancel:()=>{q().Ay.state.isOpen&&q().Ay.setState({...q().Ay.state,isOpen:!1})},preventCaptureArrowShortcuts:!t,disabled:v,focus:!s().A.isMobile||void 0,focusAfterAnimation:!0,value:t,onChange:e=>{o(e.target.value),u.setState({...u.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})},placeholder:h,inputLeft:(0,G.jsx)(b().Zf,{icon:g().u}),inputRight:T&&(0,G.jsx)(d().A,{style:{marginInlineEnd:2}}),style:{marginBottom:-2}})}),A?(0,G.jsxs)(j().A,{isMultiline:!0,isSecondaryColor:!1,style:M.moveToAnotherSpaceMessage,children:[(0,m().exclamationMarkTriangleFillIcon)(M.moveToAnotherSpaceIcon),(0,G.jsx)("span",{children:(0,G.jsx)(S().sA,{id:"moveBlockMenu.duplicateToSpace.message",defaultMessage:"You can only duplicate pages into another workspace — not move them."})}),(0,G.jsx)(c().N,{href:(0,B().x)("guides.duplicateToSpace"),style:M.moveToAnotherSpaceLink,children:(0,G.jsx)(S().sA,{id:"moveBlockMenu.duplicateToSpace.learnMoreLink",defaultMessage:"Learn more"})})]}):void 0]})}}}]);