"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[69144,71204],{175213:(e,t,o)=>{o.d(t,{G:()=>r});var n=()=>o(314529),a=()=>o(242422);function r(e,t){(0,n().DO_NOT_USE_trackLegacy)(e,"delete_property",t),a().default.logEvent("delete_property")}},241319:(e,t,o)=>{o.d(t,{y:()=>r});o(898992),o(672577);var n=()=>o(534177),a=()=>o(239381);function r(e){var t;const{actionModels:o,id:r}=e,i=(0,a().y5)(r),l="action"===i.source?o.find((e=>e.id===i.action_id)):void 0,c=(0,n().O9)(l)&&l.isType("create_page")?null===(t=l.getConfig())||void 0===t?void 0:t.collection:void 0;return{automationValueInfo:i,collectionPointer:c,actionModel:l}}},299177:(e,t,o)=>{o.d(t,{A:()=>r});class n extends(()=>o(757695))().Store{getInitialState(){return{}}}const a=new n;o(852832).exposeDebugValue("SpaceWorkflowTemplateInstanceMapStore",a);const r=a},390527:(e,t,o)=>{o.r(t),o.d(t,{DEFAULT_MAX_RECURRENCE_DUPLICATION_PER_TASK:()=>O,MAXIMUM_DAILY_RECURRENCES_IN_PATH:()=>C,MAXIMUM_NESTED_RECURRENCE_LEVEL:()=>b,MAX_RECURRENCE_INTERVAL:()=>g,MAX_RECURRENCE_NUMBER_OF_RUNS:()=>v,RRULE_WEEKDAYS_MAP:()=>_,adjustedStartDateIfPossible:()=>k,areRecurrenceSchedulesEqual:()=>P,convertFromUnpersistedRecurrenceConfig:()=>V,convertToUnpersistedRecurrenceConfig:()=>D,getFormattedEndCondition:()=>R,getFormattedNextRecurrenceTime:()=>E,getNewEndTimestamp:()=>w,getNextDateUtc:()=>I,getRecurrenceAfter:()=>S,isRunningBetweenMidnightAnd3AM:()=>A,isValidRecurrenceInterval:()=>h,isValidRecurrenceNumberOfRuns:()=>M,rruleFromRecurrence:()=>T,templateAncestorsViolateRecurrenceNesting:()=>x});o(898992),o(354520),o(581454);var n=()=>o(906745);o(944114);function a(e,...t){if(0===t.length)return e.map((e=>[e]));const o=[];for(const n of e)o.push(...a(t[0],...t.slice(1)).map((e=>[n,...e])));return o}var r=()=>o(496603),i=()=>o(534177),l=()=>o(720665),c=()=>o(597777),u=()=>o(869190),s=()=>o(416504),d=()=>o(402390);class p extends(()=>o(896346))().p3{constructor(e,t){super(e,t)}after(e,t){return super.after(e,t)}}var m=()=>o(912720);const f=(0,o(69708).YK)({dateAtTime:{id:"automations.recurrenceHelpers.dateAtTime",defaultMessage:"{date} at {time}"},dateBetweenMidnightAnd3AM:{id:"automations.recurrenceHelpers.dateBetweenMidnightAnd3AM",defaultMessage:"{date} between 12â€“3 AM"},numberEndConditionDescription:{id:"automations.recurrenceHelpers.numberEndConditionDescription",defaultMessage:"{number, plural, one {After {number} run} other {After {number} runs}}"},noEndCondition:{id:"automations.recurrenceHelpers.noEndCondition",defaultMessage:"Never"}}),y={day:p.DAILY,week:p.WEEKLY,month:p.MONTHLY,year:p.YEARLY},_={MO:p.MO,TU:p.TU,WE:p.WE,TH:p.TH,FR:p.FR,SA:p.SA,SU:p.SU},g=99,v=999;function h(e){return(0,l().Et)(e)&&Number.isInteger(e)&&e>0&&e<=g}function M(e){return(0,l().Et)(e)&&Number.isInteger(e)&&e>0&&e<=v}function T(e){const{start_date:t,frequency:o,interval:n,weekdays:r,timezone:l,hour:u,minute:s}=e,d="week"===o&&r?r.map((e=>_[e])):void 0,m={};return(0,i().O9)(e.end_condition)&&("date"===e.end_condition.type?m.until=(0,c().eU)(e.end_condition.end_at):"number"===e.end_condition.type?m.count=e.end_condition.number_of_occurrences:(0,i().HB)(e.end_condition)),"month"===e.frequency&&(0,i().O9)(e.monthly_restriction)&&("monthdays"===e.monthly_restriction.type?m.bymonthday=e.monthly_restriction.monthdays:"weekdays_in_month"===e.monthly_restriction.type?m.byweekday=a(e.monthly_restriction.weekdays,e.monthly_restriction.week_numbers).map((([e,t])=>_[e].nth(t))):(0,i().HB)(e.monthly_restriction)),new p({freq:y[o],dtstart:(0,c().eU)(t),interval:n,byweekday:d,tzid:l,byhour:u??0,byminute:s??0,bysecond:0,...m})}const b=1,C=1;function x(e){var t;if(0===e.length)return{violatesConstraint:!1,templateNestingExceedsMaxDepth:!1,ancestorHasDailyTemplate:!1,nestedDepthOfAutomationAncestors:void 0,immediateAncestorRecurrenceType:void 0};const o=e.filter((e=>{var t;return"day"===(null===(t=e.getRecurrence())||void 0===t?void 0:t.frequency)})),n=e.length,a=null===(t=e[0].getRecurrence())||void 0===t?void 0:t.frequency,r=n>b,i=o.length>=C;return{violatesConstraint:r||i,templateNestingExceedsMaxDepth:r,ancestorHasDailyTemplate:i,nestedDepthOfAutomationAncestors:n,immediateAncestorRecurrenceType:a}}function k(e){var t;const{recurrence:o,afterDate:a}=e;if("number"===(null===(t=o.end_condition)||void 0===t?void 0:t.type)||o.start_date>=a)return o;let r=n().c9.fromMillis(o.start_date,{zone:"utc"});const i=n().c9.fromMillis(a,{zone:"utc"});switch(o.frequency){case"year":{const e=Math.floor(i.diff(r,"years").years/o.interval);r=r.plus({years:e*o.interval});break}case"month":{const e=Math.floor(i.diff(r,"months").months/o.interval);r=r.plus({months:e*o.interval});break}case"week":{const e=Math.floor(i.diff(r,"weeks").weeks/o.interval);r=r.plus({weeks:e*o.interval});break}case"day":{const e=Math.floor(i.diff(r,"days").days/o.interval);r=r.plus({days:e*o.interval});break}}return{...o,start_date:(0,c().DH)(r.toMillis())}}function S(e){const{recurrence:t,afterDate:o}=e;if((0,m().wt)(t)){const e=(0,c().l1)(o);return t.start_date>=e?new Date(t.start_date):void 0}{const e=T(k({recurrence:t,afterDate:o})).after((0,c().eU)(o));if(!e)return;return(0,c().h1)(e)}}function A(e){return 0===e.hour||1===e.hour||2===e.hour}function I(e){return T(e).after((0,c().eU)((0,c().Rz)()))||void 0}function E(e){const{recurrence:t,intl:o}=e,a=I(V(t));if(!a)return;const r=A(t),i=n().c9.fromJSDate(a).toUTC().setZone("local",{keepLocalTime:!0}).setLocale((0,d().H)(o)).setZone(t.timezone),l=(0,u().Yq)({date:i,dateFormat:"relative",allowRelativeDates:!0,intl:o,shortenDate:!0});if(r)return o.formatMessage(f.dateBetweenMidnightAnd3AM,{date:l});{let e=i.toLocaleString(n().c9.TIME_SIMPLE);return t.timezone!==(0,s().P)()&&(e+=` ${i.toFormat("ZZZZ")}`),o.formatMessage(f.dateAtTime,{date:l,time:e})}}function R(e,t){return(0,i().O9)(e)?"number"===e.type?t.formatMessage(f.numberEndConditionDescription,{number:e.number_of_occurrences}):"date"===e.type?(0,u().Yq)({date:n().c9.fromMillis(e.end_at),dateFormat:"relative",allowRelativeDates:!0,intl:t,shortenDate:!0}):void(0,i().HB)(e):t.formatMessage(f.noEndCondition)}const O=100;function D(e){return{...e,start_date:(0,c().l1)(e.start_date),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?{type:"date",end_at:(0,c().l1)(e.end_condition.end_at)}:(0,i().HB)(e.end_condition):void 0}}function w(e,t,o){return e.plus(o-t)}function N(e,t){const o=n().c9.fromMillis(t.end_at).set({hour:e.hour??0,minute:e.minute??0});return{type:"date",end_at:(0,c().Rz)(o.toJSDate())}}function V(e){return{...e,start_date:(0,c().Rz)(new Date(e.start_date)),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?N(e,e.end_condition):(0,i().HB)(e.end_condition):void 0}}function P(e,t){const o=r().fN(e,(e=>void 0!==e)),n=r().fN(t,(e=>void 0!==e));return r().n4(o,n)}},422540:(e,t,o)=>{o.d(t,{$0:()=>g,Fx:()=>x,Ge:()=>f,I3:()=>p,Kj:()=>b,PP:()=>k,TK:()=>S,Yy:()=>d,aE:()=>A,cQ:()=>C,kH:()=>y,m7:()=>m,nq:()=>M,nv:()=>v,tj:()=>_});o(898992),o(354520),o(737550);var n=()=>o(496603),a=()=>o(534177),r=()=>o(381283),i=()=>o(898244),l=()=>o(651124),c=()=>o(349835),u=()=>o(390066);const s={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,place:!1},d={checkbox:[{type:"checkbox"}],date:[{type:"date"}],email:[{type:"text"}],multi_select:[{type:"text"},{of:{type:"text"},type:"array"}],number:[{type:"number"}],person:[{type:"person"},{of:{type:"person"},type:"array"}],phone_number:[{type:"text"}],relation:[{type:"block"},{of:{type:"block"},type:"array"}],select:[{type:"text"},{of:{type:"text"},type:"array"}],status:[{type:"text"},{of:{type:"text"},type:"array"}],text:void 0,title:void 0,url:[{type:"text"}]};function p(e){return Boolean(s[e.type]&&!(0,i().UU)(e)&&(!(0,i().$M)(e)||void 0===(0,i().om)(e)))}function m(e){const{collectionFormat:t,collectionSchema:o,filter:r,sort:c,sourcePropertyIds:s}=e,d=(s??(0,a().uv)(o)).filter(((t,n,a)=>{const l=o[t];return!(!l||!p(l))&&(("relation"!==l.type||!e.restrictCrossSpace||!(0,i().o2)(e.spaceId,l))&&(!r||r([t,l],n,o)))}));if(0===d.length)return[];if(!t||!1===c)return d;const m=(0,u().L)(t,o,void 0,l().jf.Page).collection_page_properties||[];return n().Ul(d,(e=>m.findIndex((t=>t.property===e))))}function f(e){const{collectionFormat:t,collectionSchema:o,sort:i}=e,c=(0,a().uv)(o).filter(((e,t,n)=>{const a=o[e];return!(!a||!(0,r().J)(a))}));if(0===c.length)return[];if(!t||!1===i)return c;const s=(0,u().L)(t,o,void 0,l().jf.Page).collection_page_properties||[];return n().Ul(c,(e=>s.findIndex((t=>t.property===e))))}function y(e){return e.type===c().M9.InvalidCharacter?{type:e.type,character:e.character}:e.type===c().M9.TokenExpected?{type:e.type,token:e.token}:e.type===c().uW.MissingSchemaPropertyOnThisRow||e.type===c().uW.MissingSchemaPropertyOnCollection?{type:e.type,collectionId:e.collectionId,property:e.property}:e.type===c().uW.ThisRowBlockPropertyMismatchCollection?{type:e.type,thisRowCollection:e.thisRowCollection}:e.type===c().uW.MissingContextVariable?{type:e.type,valueId:e.valueId}:e.type===c().uW.FunctionCallTooFewArguments?{type:e.type,numArguments:e.numArguments}:e.type===c().uW.FunctionCallUnexpectedArgument?{type:e.type,parameterIndex:e.parameterIndex}:e.type===c().uW.FunctionCallArgumentWrongType?{type:e.type,argumentType:e.argumentType,libraryFunctionName:e.libraryFunction.name,parameterIndex:e.parameterIndex}:e.type===c().uW.MissingDataDependencyBlock?{type:e.type,blockPointer:e.blockPointer,node:e.node}:e.type===c().uW.MissingDataDependencyPerson?{type:e.type,personPointer:e.personPointer}:e.type===c().uW.MemberPropertyMismatchCollection?{type:e.type,blockCollection:e.blockCollection}:e.type===c().uW.DownstreamParseFailure?{type:e.type,collectionId:e.collectionId,property:e.property}:e.type===c().uW.ContextVariableWrongType?{type:e.type,valueId:e.valueId,expectedType:e.expectedType,resultType:e.resultType}:e.type===c().uW.DisallowedValueType?{type:e.type,expressionValue:e.expressionValue,allowedValueTypes:e.allowedValueTypes}:e.type===c().uW.LibraryFunctionExecutionError?{type:e.type,error:e.error,libraryFunctionName:e.libraryFunction.name}:{type:e.type}}const _={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,button:!1,file:!1,verification:!1,auto_increment_id:!1,created_by:!1,created_time:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,place:!1};function g(e){return Boolean(_[e.type])}function v(e){const{collectionFormat:t,collectionSchema:o,filter:r,sort:c}=e,s=(0,a().uv)(o).filter(((e,t,n)=>{var a;const l=o[e];return!(!l||!_[l.type])&&((!(0,i().$M)(l)||null===(a=(0,i().om)(l))||void 0===a||!a.auto_update_on_edit)&&(!r||r([e,l],t,o)))}));if(0===s.length)return[];if(!t||!1===c)return s;const d=(0,u().L)(t,o,void 0,l().jf.Page).collection_page_properties||[];return n().Ul(s,(e=>d.findIndex((t=>t.property===e))))}const h={checkbox:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,date:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,place:!1};function M(e){return h[e.type]}const T={checkbox:!0,created_by:!0,created_time:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,last_edited_by:!0,last_edited_time:!0,auto_increment_id:!1,button:!1,file:!1,formula:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,place:!1};function b(e){return T[e.type]}function C(e){return 0===e}function x(e){return function(e){return"button_block"===e||"button_property"===e}(e)}function k(e){const{property:t,collectionSchema:o}=e;return!!o&&!o[t]}function S(e){const{collectionSchema:t,property:o,type:n}=e,a=null==t?void 0:t[o];return!a||("action"===n?!p(a):!_[a.type])}function A({automationTrigger:e,collectionSchema:t}){if("event"===(null==e?void 0:e.type)){const{pagesAdded:o,pagePropertiesEdited:n,source:r,relativeDate:i}=e.event;if(void 0===r)return!1;const l="some"===n.type&&n.some,c="all"===n.type&&n.all;if((l||c||[]).some((e=>k({collectionSchema:t,property:e.property})||S({collectionSchema:t,property:e.property,type:"trigger"}))))return!1;const u="some"===n.type&&(!(0,a().O9)(n.some)||0===n.some.length),s="all"===n.type&&(!(0,a().O9)(n.all)||0===n.all.length);if(!o&&("none"===n.type||u||s)&&!i)return!1}else{if("recurrence"!==(null==e?void 0:e.type))return!1;if(!e.recurrence)return!1}return!0}},546461:(e,t,o)=>{o.d(t,{EC:()=>C,To:()=>b,YC:()=>x,or:()=>T,u:()=>M});o(16280);var n=o(296540),a=()=>o(484714),r=()=>o(792485),i=()=>o(56366),l=()=>o(496506),c=()=>o(322867),u=()=>o(69708),s=()=>o(534177),d=()=>o(813297),p=()=>o(862292),m=()=>o(698331),f=()=>o(645873),y=()=>o(190019),_=()=>o(76190),g=o(474848);const v=new WeakMap,h=(0,n.createContext)({automationStore:void 0,contextType:void 0,defined:!1,typecheckResult:void 0});h.displayName="AutomationContext";function M(e){const{automationStore:t,children:o,contextType:n}=e,M=(0,a().v3)(),T=(0,u().tz)(),{value:b}=(0,f().fJ)(p().T.formulas),{value:C}=(0,f().fJ)(d().QV.automationTypecheck),x=(0,_().n)(t),k=(0,r().S)(),S=(0,i().K8)((()=>{if(!b)return{error:new(c().N9)("Missing formulas dependency")};if(!C)return{error:new(c().N9)("Missing automation dependency")};const e=function(e){const{environment:t,automationStore:o,automationTypecheckModule:n,contextType:a,formulasModule:r,intl:i,isSubscribed:c,pageStore:u}=e,d=v.get(o);if(d)return d;{const e=new(l().ComputedStore)((()=>{const e=o.getTriggerType();let l=a;return(0,s().O9)(e)&&(0,m().x2)(e)&&(l=(0,m().H8)(e)),(0,y().Z)({environment:t,automationStore:o,automationTypecheckModule:n,contextType:l,formulasModule:r,intl:i,isSubscribed:c,pageStore:u})}),{debugName:"automationContextTypecheckResultCachedStore"});return v.set(o,e),e}}({environment:M,automationStore:t,automationTypecheckModule:C,contextType:n,formulasModule:b,intl:T,isSubscribed:x,pageStore:"button_block"===n?null==k?void 0:k.pageStore:void 0});return e.state}),[M,t,C,n,b,T,x,null==k?void 0:k.pageStore]);return(0,g.jsx)(h.Provider,{value:{automationStore:t,typecheckResult:S,contextType:n,defined:!0},children:o})}function T(e){const{automationStore:t,children:o}=e,n=(0,i().K8)((()=>{var e;return null===(e=t.getTrigger())||void 0===e?void 0:e.type}),[t]);return(0,g.jsx)(M,{automationStore:t,contextType:(0,m().H8)(n??"event"),children:o})}function b(e){var t;return null===(t=v.get(e))||void 0===t?void 0:t.state}function C(){const e=n.useContext(h);if(!1===e.defined)throw new Error("No automation context found!");return e}function x(){return n.useContext(h)}},574209:(e,t,o)=>{o.d(t,{U:()=>T});o(16280);var n=()=>o(242422),a=()=>o(929219),r=()=>o(386164),i=()=>o(388821),l=()=>o(703980),c=()=>o(314529);var u=()=>o(559506),s=()=>o(384944),d=()=>o(666144),p=()=>o(185544),m=()=>o(231297),f=()=>o(855801),y=()=>o(611191),_=()=>o(972435),g=()=>o(981265),v=(o(898992),o(672577),()=>o(564884)),h=()=>o(272006),M=()=>o(765957);async function T(e){const{environment:t,spaceStore:o,spaceViewStore:T,userSettingsStore:b,from:C}=e,{templateName:x,spaceId:k,pageId:S,options:A={}}=e.template;if(!a().A.state.online)return;const I=await u().callApi({eventName:"loadBlockSubtree",environment:t,data:{block:{id:S,spaceId:k},shallow:!1},headers:(0,r().WS)({spaceId:k})});let E;if("failed"===I.type)return void(0,l().x)(t,{getting_started_page_type:x,errorType:"loadBlockSubtreeFailed",spaceId:o.id,errorMessage:I.error.message,copyPageId:S});E=i().RecordMapWithRole.create(I.data.subtreeRecordMap);const{loadLocalSubtree:R,localDuplicate:O}=await(0,f().D6)(),{messages:{createAndDuplicatePageError:D}}=await(0,f().nd)(),w="spaceActions.createGettingStartedPageInSpace",{performResult:N,serverCommitResult:V}=m().createAndCommit({userAction:w,environment:t,canUndo:!0,isTemplateInstantiationTransaction:!0,perform:e=>{const n=p().IT({environment:t,spaceStore:o,spaceViewStore:T,parent:"private",prepend:!0,transaction:e});d()._O({environment:t,inMemoryRecordCache:n.inMemoryRecordCache,recordMap:E,debugSource:w});const a=R({environment:t,blockId:S,inMemoryRecordCache:n.inMemoryRecordCache,options:{allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!1,allowCopyExternalObjectInstances:!0,includeLegacyTransclusionBlockValues:(0,y().$J)()}}).recordMap;if(!a)throw(0,l().x)(t,{getting_started_page_type:x,errorType:"createAndDuplicatePageFailed",spaceId:o.id}),new Error(_().A.formatMessage(D));const{targetBlockStore:r,originalToDuplicate:i}=O({environment:t,sourceBlockId:S,targetBlockPointer:n.pointer,sourceBlockSubtree:a,targetInMemoryRecordCache:n.inMemoryRecordCache,transaction:e,templateInstallationMetadata:{source:"onboarding"},from:"create_getting_started",options:{allowRedundancy:!0,deepCopyTransclusionContainers:!0,isTemplateInstantiation:!0,resolveTemplateVariables:!0,preventLegacyTransclusions:(0,y().$J)()}});(0,g().ew)({environment:t,pageStore:r,originalToDuplicate:i,relativeDatesDefinition:A.relativeDatesDefinition,transaction:e});const c={},u={};return"evernote"===x?u.created_evernote_getting_started=!0:c.created_getting_started=!0,Object.keys(c).length>0&&s().zv({store:T,data:c,transaction:e}),Object.keys(u).length>0&&s().zv({store:b.getSettingsStore(),data:u,transaction:e}),n}});return V.then((()=>{!function(e,t){(0,c().DO_NOT_USE_trackLegacy)(e,"getting_started_page_create",t)}(t,{getting_started_page_type:x,getting_started_page_id:S,duplicated_from_page_id:S,duplicated_to_page_id:N.id,from:C}),n().default.checkGate({gateName:"notion_calendar_getting_started_experience"})&&async function(e){var t,o;const{pageStore:n,environment:a}=e,r=null===(t=M().default.state.sidebarSpaceViewStore)||void 0===t?void 0:t.getSpaceId();if(!r)return;"initiated"===h().V.state.calendarSignupStatus&&await h().V.waitUntil((()=>"initiated"!==h().V.state.calendarSignupStatus),{timeout:1e4});const i=h().V.state.calendarBotId;if(!i)return;const l=null===(o=n.getContentStores().find((e=>e.isCollectionView())))||void 0===o?void 0:o.getCollectionViewIds()[0];if(!l)return;"success"===(await u().callApi({eventName:"linkCollectionViewToCalendar",environment:a,data:{collectionViewId:l,spaceId:r,botId:i}})).type&&(0,v().u)({environment:a,event:{eventName:"calendar_collection_view_autolinked",eventProperties:{}}})}({pageStore:N,environment:t})})),N}},698331:(e,t,o)=>{o.d(t,{$X:()=>r,H8:()=>i,x2:()=>a});var n=()=>o(534177);function a(e){return"event"===e||"recurrence"===e}function r(e){const t=e.getTrigger();return(0,n().O9)(t)&&a(t.type)}function i(e){return"event"===e?"event":"recurrence"===e?"recurrence":void(0,n().HB)(e)}},703980:(e,t,o)=>{o.d(t,{x:()=>a});var n=()=>o(314529);function a(e,t){(0,n().DO_NOT_USE_trackLegacy)(e,"debug_getting_started_page_error",t)}},888325:(e,t,o)=>{function n(e){return`${e.table}:${e.id}`}o.d(t,{_:()=>n})},890409:(e,t,o)=>{o.d(t,{Ah:()=>g,Dk:()=>f,Iv:()=>_,SF:()=>y,YO:()=>M,_f:()=>b,c_:()=>p,dW:()=>h,gW:()=>m,sp:()=>C,vN:()=>v});o(16280),o(944114),o(898992),o(354520),o(803949),o(581454),o(737550);var n=()=>o(496603),a=()=>o(973647),r=()=>o(534177),i=()=>o(842599),l=()=>o(239381),c=()=>o(179034),u=()=>o(798880),s=()=>o(201980),d=()=>o(241319);function p(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"add_automation_step",properties:t})}function m(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"delete_automation_step",properties:t})}function f(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_create",properties:t})}function y(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_update",properties:t})}function _(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_delete",properties:t})}function g(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_enable",properties:t})}function v(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_disable",properties:t})}function h(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_action_create",properties:t})}function M(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_action_delete",properties:t})}function T(e){const{formulaAnalyticsModule:t,formulasModule:o,formulaTypecheckContextValues:n,getRecordModel:i,spaceId:c,value:u,featureGates:s}=e;if("formula"===u.type){if(!(0,r().O9)(u.value))return;const e=a().Q.unwrapOr(o.parseFormulaInputToAst(u.value),void 0);if(e){const a=o.addTypesToFormulaAST(e,{handleDataRequest:(0,l().zg)(i),spaceId:c,valueTypes:n,featureGates:s});return{...t.getFormulaAnalytics(e,{getRecordModel:i,typecheckContextValues:n}),formula_return_type:a.node.type,redacted_formula:t.getRedactedFormulaAsStringSync(e,{getRecordModel:i,typecheckContextValues:n})}}}else{if("simple"===u.type){if(!(0,r().O9)(u.value))return;return t.getSimpleFormulaAnalytics(u.value,{getRecordModel:i,typecheckContextValues:n})}(0,r().HB)(u.type)}}function b(e){const{automationActionModel:t,automationActionModels:o,formulaAnalyticsModule:a,formulasModule:c,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:f,simpleFormulasModule:y}=e;return t.isType("complete_sprint")?{automation_action_id:t.pointer.id,type:"complete_sprint"}:t.isType("create_page")?function(e){const{automationActionModel:t,formulaAnalyticsModule:o,formulasModule:n,formulaTypecheckContextValues:a,getRecordModel:i,featureGates:l}=e,c=t.getConfig();let u,s=[];const d=null==c?void 0:c.collection,p=null==c?void 0:c.properties;if((0,r().O9)(d)&&(0,r().O9)(p)&&p.length>0){const e=i(d),f=null==e?void 0:e.getNormalizedSchema();(0,r().O9)(f)&&(s=p.map((e=>{var t;return(null===(t=f[e])||void 0===t?void 0:t.type)??"unknown"})));const y=null==c?void 0:c.values;if(n&&(0,r().O9)(y)){u=[];for(const e of p){var m;const r=null===(m=y[e])||void 0===m?void 0:m.value;if(!r)continue;const c=T({formulaAnalyticsModule:o,formulasModule:n,getRecordModel:i,formulaTypecheckContextValues:a,spaceId:t.spaceId,value:r,featureGates:l});c&&u.push(c)}}}return{automation_action_id:t.pointer.id,property_formula_stats:u,property_types:s,type:"create_page"}}({automationActionModel:t,formulaAnalyticsModule:a,formulasModule:c,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:f}):t.isType("duplicate_blocks")?{automation_action_id:t.pointer.id,type:"duplicate_blocks"}:t.isType("modal_confirmation")?function(e){const{automationActionModel:t,formulaAnalyticsModule:o,formulasModule:n,formulaTypecheckContextValues:a,getRecordModel:i,featureGates:l}=e,c=t.getConfig(),u=[];if(n&&(0,r().O9)(c)&&c.text){const e=T({formulasModule:n,formulaAnalyticsModule:o,getRecordModel:i,formulaTypecheckContextValues:a,spaceId:t.spaceId,value:c.text,featureGates:l});e&&u.push(e)}return{automation_action_id:t.pointer.id,formula_stats:u,type:"modal_confirmation"}}({automationActionModel:t,formulaAnalyticsModule:a,formulasModule:c,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:f}):t.isType("open_page")?{automation_action_id:t.pointer.id,type:"open_page"}:t.isType("query_collection")?{automation_action_id:t.pointer.id,type:"query_collection"}:t.isType("send_in_app_notification")?function(e){var t;const{automationActionModel:o,formulaAnalyticsModule:n,formulasModule:a,formulaTypecheckContextValues:i,getRecordModel:l,featureGates:c,simpleFormulasModule:u}=e,d={automation_action_id:o.pointer.id,messageCharacterCount:0,type:"send_in_app_notification"},p=o.getConfig();if(!(0,r().O9)(p))return d;if((0,r().O9)(p.target))if("formula"===p.target.type&&(0,r().O9)(p.target.value)){if(d.targetData={type:"formula",numUserFormulaTargets:(0,s().Fbh)(p.target.value.value).length,numFormulaContextTargets:u.getReferencedContextValueIds(p.target.value).length},a){const e=T({formulasModule:a,formulaAnalyticsModule:n,getRecordModel:l,formulaTypecheckContextValues:i,spaceId:o.spaceId,value:p.target.value,featureGates:c});e&&(d.formula_stats??=[],d.formula_stats.push(e))}}else if("property"===p.target.type&&(0,r().O9)(p.target.propertyId)&&(0,r().O9)(p.target.collectionPointer)){const e=l(p.target.collectionPointer),t=null==e?void 0:e.getSchema();var m;(0,r().O9)(t)&&(d.targetData={type:"property",propertyType:null===(m=t[p.target.propertyId])||void 0===m?void 0:m.type})}if((0,r().O9)(null===(t=p.notification_message)||void 0===t?void 0:t.value)&&(d.messageCharacterCount=(0,s().FAw)(p.notification_message.value),a)){const e=T({formulasModule:a,formulaAnalyticsModule:n,getRecordModel:l,formulaTypecheckContextValues:i,spaceId:o.spaceId,value:p.notification_message,featureGates:c});e&&(d.formula_stats??=[],d.formula_stats.push(e))}return d}({automationActionModel:t,formulaAnalyticsModule:a,formulasModule:c,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:f,simpleFormulasModule:y}):t.isType("send_gmail_notification")?function(e){var t,o,a,l,c,d,p;const{automationActionModel:m,formulaAnalyticsModule:f,formulasModule:y,formulaTypecheckContextValues:_,getRecordModel:g,featureGates:v}=e,h=m.getConfig();if(!(0,r().O9)(h))return{automation_action_id:m.pointer.id,fields:{},recipient_domains:{},type:"send_gmail_notification"};const M=Object.fromEntries(Object.entries(h||{}).map((([e,t])=>{var o;return"formula"===(null==t?void 0:t.type)?[e,Boolean(null==t||null===(o=t.value)||void 0===o?void 0:o.value)]:"simple"===(null==t?void 0:t.type)?[e,Boolean(null==t?void 0:t.value)]:[e,Boolean(t)]}))),{to:b,cc:C,bcc:x}=h,k=[...(null==b||null===(t=b.value)||void 0===t?void 0:t.value)||[],...(null==C||null===(o=C.value)||void 0===o?void 0:o.value)||[],...(null==x||null===(a=x.value)||void 0===a?void 0:a.value)||[]],S=[...(0,s().Fbh)(k).map((e=>g({table:u().oo,id:e}))).map((e=>null==e?void 0:e.email)).filter(r().O9),...(0,i().C3)((0,s().k4p)(k))],A=n().Tr(S.map((e=>e.split("@")[1]))),I=[null===(l=h.to)||void 0===l?void 0:l.value,null===(c=h.cc)||void 0===c?void 0:c.value,null===(d=h.bcc)||void 0===d?void 0:d.value,null===(p=h.reply_to)||void 0===p?void 0:p.value,h.from_name,h.email_subject,h.email_body].map((e=>{if(y&&(0,r().O9)(e))return T({formulaAnalyticsModule:f,formulasModule:y,getRecordModel:g,formulaTypecheckContextValues:_,spaceId:m.spaceId,value:e,featureGates:v})})).filter(r().O9);return{automation_action_id:m.pointer.id,fields:M,formula_stats:I,recipient_domains:A,type:"send_gmail_notification"}}({automationActionModel:t,formulaAnalyticsModule:a,formulasModule:c,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:f}):t.isType("slack_notification")?{automation_action_id:t.pointer.id,type:"slack_notification"}:t.isType("update_pages")?function(e){const{automationActionModel:t,automationActionModels:o,formulaAnalyticsModule:n,formulasModule:a,formulaTypecheckContextValues:i,getRecordModel:c,featureGates:u}=e,s=t.getConfig(),p=[],m=[],f=[];if((0,r().O9)(s)&&(0,r().O9)(s.target)&&(0,r().O9)(s.properties)&&s.properties.length>0){let e;if("variable"===s.target.type){const t=(0,l().y5)(s.target.id);if("action"===t.source){const t=(0,d().y)({actionModels:o,id:s.target.id}).collectionPointer;if((0,r().O9)(t)){const o=c(t);e=null==o?void 0:o.getNormalizedSchema()}}else{if("global"!==t.source||"button_page"!==t.global)throw new Error("Failed loading property schema");{const t=(0,l().IV)(i,s.target.id);if("block"===(null==t?void 0:t.type.type)&&(0,r().O9)(t.type.collection)){const o=c(t.type.collection);e=null==o?void 0:o.getNormalizedSchema()}}}}else if("collection"===s.target.type){const t=c(s.target.collection);e=null==t?void 0:t.getNormalizedSchema()}(0,r().O9)(e)&&s.properties.forEach((o=>{const l=e[o];if((0,r().O9)(l)&&(p.push(l.type),a&&(0,r().O9)(s.values))){const e=s.values[o];if((0,r().O9)(e)&&(m.push({type:l.type,operator:e.action}),e.value)){const o=T({formulasModule:a,formulaAnalyticsModule:n,getRecordModel:c,formulaTypecheckContextValues:i,spaceId:t.spaceId,value:e.value,featureGates:u});o&&f.push(o)}}}))}return{automation_action_id:t.pointer.id,property_configs:m,property_formula_stats:f,property_types:p,type:"update_pages"}}({automationActionModel:t,automationActionModels:o,formulaAnalyticsModule:a,formulasModule:c,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:f}):t.isType("define_variables")?function(e){const{automationActionModel:t,formulaAnalyticsModule:o,formulasModule:n,formulaTypecheckContextValues:a,getRecordModel:i,featureGates:l}=e,c=t.getConfig(),u=[];if(n&&(0,r().O9)(c)&&c.values)for(const r of Object.values(c.values))if(r.value){const e=T({formulasModule:n,formulaAnalyticsModule:o,getRecordModel:i,formulaTypecheckContextValues:a,spaceId:t.spaceId,value:r.value,featureGates:l});e&&u.push(e)}return{automation_action_id:t.pointer.id,formula_stats:u,type:"define_variables"}}({automationActionModel:t,formulaAnalyticsModule:a,formulasModule:c,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:f}):t.isType("http_request")?{automation_action_id:t.pointer.id,type:"http_request"}:t.isType("publish_site")?{automation_action_id:t.pointer.id,type:"publish_site"}:void(0,r().HB)(t)}function C(e){const{automationModel:t,builderType:o="sidebar",formulaAnalyticsModule:n,formulasModule:a,formulaTypecheckContextValues:i,getRecordModel:l,featureGates:u,simpleFormulasModule:s,source:d}=e,p=[],m=t.getActionPointers().map((e=>l(e))).filter(r().O9);for(const c of t.getActionPointers()){const e=l(c);(0,r().O9)(e)&&p.push(b({automationActionModel:e,automationActionModels:m,formulaAnalyticsModule:n,formulasModule:a,formulaTypecheckContextValues:i,getRecordModel:l,featureGates:u,simpleFormulasModule:s}))}const f=[];let y,_,g;if(t.isEventType()){var v;const e=t.getEventConfiguration(),o=l(t.getParentPointer());y=t.getParentId();const n=t.getEventConfiguration();if("collection_view"===(null===(v=n.source)||void 0===v?void 0:v.type)){const e=l(n.source.pointer);(null==e?void 0:e.parent_table)===c().ev&&(g=null==e?void 0:e.parent_id),_=null==n?void 0:n.source.pointer.id}const a=null==o?void 0:o.getNormalizedSchema();if((0,r().O9)(a)){const{pagesAdded:t,pagePropertiesEdited:o}=e;if(t&&f.push({type:"page"}),"any"===o.type)f.push({condition:"any",type:"property"});else if("none"===o.type)f.push({condition:"none",type:"property"});else{let e=[];"some"===o.type?e=o.some??[]:"all"===o.type&&(e=o.all??[]);const t=[],n=[];e.forEach((e=>{var o;const i=null===(o=a[e.property])||void 0===o?void 0:o.type;(0,r().O9)(i)&&(t.push({type:i,operator:e.filter.operator}),n.push(i))})),f.push({condition:o.type,property_configs:t,property_types:n,type:"property"})}}}else if(t.isButtonType())f.push({type:"button"});else if(t.isRecurrenceType()){var h;f.push({type:"recurrence",frequency:null===(h=t.getTrigger().recurrence)||void 0===h?void 0:h.frequency})}else(0,r().HB)(t);return{automation_actions:p,automation_id:t.id,automation_triggers:f,collection_id:y,collection_view_id:_,collection_view_block_id:g,builder_type:o,source:d}}},966759:(e,t,o)=>{o.d(t,{i:()=>r});var n=()=>o(476492),a=()=>o(175213);function r(e){const{environment:t,collectionContextStore:o,property_type:r,from:i,property:l,...c}=e,u=(0,n().sl)(o)||{};(0,a().G)(t,{property:l,property_type:r,from:i,...c,...u})}},981265:(e,t,o)=>{o.d(t,{nH:()=>C,v7:()=>_,ew:()=>v});o(16280),o(944114),o(898992),o(823215),o(354520),o(672577),o(581454);var n=()=>o(242422),a=()=>o(713998),r=()=>o(597777),i=()=>o(604995),l=()=>o(416504),c=()=>o(179034);var u=()=>o(529316),s=()=>o(797573),d=()=>o(449412),p=()=>o(586481),m=()=>o(972435),f=()=>o(148832),y=()=>o(543665);function _(e){const{userContext:t}=e,o=function(e,t){const o=b(e,t);return null==o?void 0:o.experimentName}(n().default.getConfigKey("getting_started_template_experiment_config",t.deviceType),t);if(!o)return g({userContext:t});const a=n().default.getEligibleGroup({experimentId:o,defaultGroup:"control",disableExposureLogging:!0}),r=(n().default.getConfigKey("getting_started_experiment_templates",o)??[]).find((e=>e.groupName===a)),i=r?r.templates??(r.spaceId&&r.localizedTemplates?[{spaceId:r.spaceId,localizedTemplates:r.localizedTemplates}]:void 0):void 0,l=null==i?void 0:i.map((e=>{var o;const a=null===(o=e.localizedTemplates)||void 0===o?void 0:o[t.locale];return e.spaceId&&a?{spaceId:e.spaceId,isLandingPage:e.isLandingPage,pageId:a,relativeDatesDefinition:a?n().default.getConfigKey("getting_started_collection_subpage_relative_dates_definition",a):void 0}:void 0})).filter((e=>void 0!==e));return null!=l&&l.length?(n().default.manuallyLogExperimentExposure(o),l.map((e=>({templateName:a,pageId:e.pageId,spaceId:e.spaceId,options:{relativeDatesDefinition:e.relativeDatesDefinition,isLandingPage:e.isLandingPage}})))):("control"===a&&n().default.manuallyLogExperimentExposure(o),g({userContext:t}))}function g(e){const{userContext:t}=e,o=b(n().default.getConfigKey("getting_started_template_config",t.deviceType),t),a=o?o.templateNames??(o.templateName?[o.templateName]:void 0):void 0;if(null==a||!a.length)return;const r=a.map((e=>n().default.getConfigKey("getting_started_templates",e))),i=null==r?void 0:r.map(((e,o)=>{var r;const i=null==e||null===(r=e.localizedTemplates)||void 0===r?void 0:r[t.locale];return null!=e&&e.spaceId&&i?{name:a[o],spaceId:e.spaceId,isLandingPage:e.isLandingPage,pageId:i,relativeDatesDefinition:i?n().default.getConfigKey("getting_started_collection_subpage_relative_dates_definition",i):void 0}:void 0})).filter((e=>void 0!==e));return null!=i&&i.length?i.map((e=>({templateName:e.name,pageId:e.pageId,spaceId:e.spaceId,options:{relativeDatesDefinition:e.relativeDatesDefinition,isLandingPage:e.isLandingPage}}))):void 0}function v(e){const{environment:t,pageStore:o,originalToDuplicate:n,relativeDatesDefinition:u,transaction:s}=e;if(!u)return;const m=(0,l().P)(),_=Date.now(),g=[];for(const[l,d]of Object.entries(u)){const e={id:l,table:c().ev,spaceId:o.getSpaceId()},u=n.get(e);if(!u){g.push(l);continue}const v=f().B.createChildStore(o,u);if(!v.isDefined()){g.push(l);continue}const T=v.getAssociatedCollectionStore();if(!(T&&T instanceof y().m)){g.push(l);continue}const b=T.getSchema();if(!b){g.push(l);continue}const C=[];for(const[t,o]of Object.entries(b))o&&"date"===o.type&&C.push(t);if(0===C.length)g.push(l);else{const{startDateOffset:e,duration:o,roundUpToNearest:n,type:l,reminder:c}=d;let u=_;n&&n>0&&(u=Math.ceil(u/n)*n);const f=u+e;let y;y="date"===l&&o?i().Mk(f,f+o,m):"date"===l?i().p6(f,m):o?i().NC(f,f+o,m):i().KQ(f,m),c&&(y=(0,r().$P)(y)||(0,r().oM)(y)?{...y,reminder:h}:{...y,reminder:M});const g=(0,a().m5)(y),T={};for(const t of C)T[t]=g;(0,p().L)({environment:t,store:v,properties:T,transaction:s})}}g.length>0&&d().Fg(new Error("Getting started relative date application failed"),{data:{pageStoreId:o.id,relativeDatesDefinition:u,invalidPageIds:g,originalToDuplicateSize:n.getSize()}})}const h={unit:"day",value:0,time:r().lM,defaultTimeZone:(0,l().P)()},M={unit:"minute",value:0};function T(e,t){const o=function(e){const t=["onboardingFlowName","spaceJoinOrCreate","planType","deviceType","calendarSignupStatus","featureIntent","domainType","isNewUserOnboarding","acceptedTimedTrialOffer"];for(const o of t)if(o===e)return o}(e.key);if(!o)return!1;const n=t[o];if(void 0===n)return!1;switch(e.operator){case"equals":return`${n}`==`${e.value}`;case"notEquals":return`${n}`!=`${e.value}`;case"in":return Array.isArray(e.value)&&e.value.map((e=>`${e}`)).includes(`${n}`);case"exists":return void 0!==n;default:return!1}}function b(e,t){for(const o of e){const{eligibilityConditions:e,locales:n=["en-US"]}=o;if(e.every((e=>T(e,t)))&&n.includes(t.locale))return o}}function C(e){const{spaceId:t,rootId:o}=(0,s().B)(u().y[e],m().A.getIntl());return{templateName:e,spaceId:t,pageId:o}}}}]);