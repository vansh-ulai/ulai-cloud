"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[52986],{23815:(e,t,o)=>{o.d(t,{$6:()=>s,Vu:()=>a,zX:()=>l});var n=()=>o(66689),r=()=>o(799829),i=()=>o(685889);const l=(0,o(69708).YK)({sprintUncategorizedGroup:{defaultMessage:"Backlog (No {name})",id:"database.sprintDatabaseView.uncategorizedGroupLabel"}});function a(e){const{collectionStore:t,property:o,propertySchema:r,parentStore:l}=e;let a=!1;if(null!=t&&t.isDefined()){const e=t.getPropertyMapping();a=(null==e?void 0:e[n().yx.TaskToSprintRelation])===o}return(0,i().LQ)(r,l)===n().av||a}function s(e){return(0,r().wy)({appUri:e.getFormatStore().getKeyStore("app_config_uri").getValue(),collectionSchema:e.getSchema()})}},68207:(e,t,o)=>{o.d(t,{S:()=>r});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"4.67 2.67 10.66 15.64",svg:(0,o(474848).jsx)("path",{d:"M6.328 3c0-.18.145-.325.325-.325h6.694c.18 0 .325.146.325.325v.474c0 .948-.405 1.85-1.112 2.481l-.402.36.19 1.944.038.013a4.325 4.325 0 0 1 2.939 4.097V13c0 .18-.146.325-.325.325h-4.17v3.38a1.1 1.1 0 0 1-.1.46l-.44.956-.063.087a.35.35 0 0 1-.565-.103l-.432-.94a1.1 1.1 0 0 1-.1-.46v-3.38H5A.325.325 0 0 1 4.675 13v-.63a4.325 4.325 0 0 1 2.938-4.098l.038-.013.191-1.945-.402-.359a3.33 3.33 0 0 1-1.112-2.481z"})},r=(0,o(340498).wt)("pinFill",n)},142680:(e,t,o)=>{o.d(t,{A:()=>i});o(296540);var n=()=>o(69708),r=o(474848);const i=function({on:e,menuListItemProps:t,disabled:i}){return(0,r.jsx)(o(859428).A,{disableTooltip:!i,renderTooltip:()=>(0,r.jsx)(n().sA,{defaultMessage:"Only available for Count",id:"AggregationLimitToggle.disabled.tooltip"}),render:l=>(0,r.jsx)(o(574036).A,{...(0,o(553965).A)(t,l),on:!i&&e,disabled:i,style:{alignItems:"flex-start",paddingTop:8,paddingBottom:8},title:(0,r.jsx)(n().sA,{defaultMessage:"Show large counts as 99+",id:"BoardAggregations.aggregationLimitToggle.title"}),captionStyle:{marginTop:6},shouldWrapCaption:!0,caption:(0,r.jsx)(n().sA,{defaultMessage:"This improves performance for large databases.",id:"BoardAggregations.aggregationLimitToggle.description"})})})}},222334:(e,t,o)=>{o.r(t),o.d(t,{arrowChevronSingleRightIcon:()=>r,iconDefinition:()=>n});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"7.22 3.97 6.66 12.06",directional:!0,svg:(0,o(474848).jsx)("path",{d:"M13.692 10.442a.625.625 0 0 0 0-.884l-5.4-5.4a.625.625 0 1 0-.884.884L12.366 10l-4.958 4.958a.625.625 0 0 0 .884.884z"})},r=(0,o(340498).wt)("arrowChevronSingleRight",n)},230979:(e,t,o)=>{o.d(t,{N:()=>r});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"4.37 2.37 11.26 15.94",svg:(0,o(474848).jsx)("path",{d:"M6.653 2.375A.625.625 0 0 0 6.028 3v.474A3.62 3.62 0 0 0 7.24 6.179l.289.258-.157 1.603a4.625 4.625 0 0 0-2.997 4.33V13c0 .345.28.625.625.625h4.13v3.08c0 .158.035.317.1.46l.433.94a.35.35 0 0 0 .565.103l.063-.087.44-.956c.065-.142.1-.3.1-.46v-3.08H15c.345 0 .625-.28.625-.625v-.63a4.625 4.625 0 0 0-2.997-4.33l-.157-1.603.289-.258a3.63 3.63 0 0 0 1.212-2.705V3a.625.625 0 0 0-.625-.625zm1.42 2.871c-.468-.417-.75-1-.79-1.621h5.434a2.38 2.38 0 0 1-.79 1.621l-.525.47a.63.63 0 0 0-.206.527l.227 2.318a.63.63 0 0 0 .422.531l.237.08a3.375 3.375 0 0 1 2.293 3.197v.006h-8.75v-.006c0-1.447.922-2.733 2.293-3.197l.237-.08a.63.63 0 0 0 .422-.531l.227-2.318a.63.63 0 0 0-.206-.528z"})},r=(0,o(340498).wt)("pin",n)},239529:(e,t,o)=>{o.d(t,{S:()=>c,q:()=>s});o(898992),o(672577);var n=()=>o(381175),r=()=>o(436696),i=()=>o(577142),l=()=>o(492414),a=()=>o(177618);function s(e){const{environment:t,collectionContextStore:o,event:l,buttonPopupParent:s}=e,c=(0,a().t2)(o);if(!c)return null;const u=(0,n().V)(l);(0,i().navigate)({environment:t,url:c,openInNew:u}),u||null==s||s.close(),(0,r().X)({environment:t,collectionContextStore:o,action:"click_source_view"})}function c({environment:e,collectionStore:t,pageVisitSource:o,event:r}){var a;const s=t.getParentBlockStore();if(!s)return;const c=null===(a=s.getCollectionViewStores())||void 0===a?void 0:a.find((e=>{var o;return(null===(o=e.getCollectionStore())||void 0===o?void 0:o.id)===t.id})),u=(0,l().J8)({store:s,fullyQualified:!1,pageVisitSource:o,collectionViewId:null==c?void 0:c.id});(0,i().navigate)({environment:e,url:u,openInNew:(0,n().V)(r)})}},248662:(e,t,o)=>{o.d(t,{T:()=>p});var n=()=>o(584262),r=()=>o(970330),i=()=>o(281948),l=()=>o(766854),a=()=>o(665020),s=()=>o(635462),c=()=>o(476492),u=()=>o(177618);function d(e){const{blockId:t,collectionContextStore:o}=e,r=(0,s().s)(t),i=(0,a().W)(t),l=o.isInHomeWidgetStore.state;return i?l?n().y8.PersonalHomeTileCustomDbCreate:n().y8.PersonalHomeCustomDbCreate:r?l?n().y8.PersonalHomeTileTasksCreate:n().y8.PersonalHomeTasksCreate:n().y8.Create}function p(e){const{transaction:t,store:o,collectionContextStore:n,environment:a,shouldCoerce:s,templateStore:p,showMoveTo:g,peekModeOverride:m,from:y,isKeyboard:v}=e,f=(0,l().H)({environment:a,collectionContextStore:n,groupsPointer:[],insertAtIndex:0,shouldCoerce:s,templateStore:p,transaction:t,from:y,inMemoryRecordCache:a.defaultRecordCache.inMemoryRecordCache,isKeyboard:v});if(!f)return;const h=m??u().hH(n);i().VU({environment:a,store:f.newStore,peekMode:h,showMoveTo:g,resultsStore:void 0,collectionContextStore:n,pageVisitSource:d({blockId:o.id,collectionContextStore:n})});const S="collectionTypedView"===n.contextType?f.newStore.getAssociatedCollectionId():void 0;return r().vH(a,{from:y.createBlock,type:"page",new_page_id:f.newStore.id,creating_block_id:f.newStore.id,...c().sl(n,S)}),f.newStore}},259464:(e,t,o)=>{o.d(t,{A:()=>l});o(296540);var n=()=>o(378518);o(944114),o(898992),o(908872);var r=o(474848);const i=16;function l(e){const{startPoint:t,endPoint:o,style:i,showArrowHead:l,useRightAngles:c,cornerRadiusOverride:u,handleMouseMove:d,handleMouseLeave:p}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s,{startPoint:t,startCurvePoint:c?void 0:{x:t.x+n().g_,y:t.y},endPoint:l?{x:o.x-1.5,y:o.y}:o,endCurvePoint:c?void 0:{x:o.x-n().g_,y:o.y},cornerRadiusOverride:u,style:i,handleMouseMove:d,handleMouseLeave:p,children:e.children}),l?(0,r.jsx)(a,{endPoint:o,style:i}):void 0]})}function a(e){const{endPoint:t,style:o}=e;return(0,r.jsx)("polyline",{points:`${t.x-5},${t.y-6} ${t.x},${t.y} ${t.x-5},${t.y+6}`,style:o,fill:"transparent"})}function s(e){const{startPoint:t,startCurvePoint:o,endPoint:n,endCurvePoint:l,style:a,cornerRadiusOverride:s,handleMouseMove:c,handleMouseLeave:u}=e;let d="";d=o&&l?`M ${t.x} ${t.y} L ${o.x} ${o.y} L ${l.x} ${l.y} L ${n.x} ${n.y}`:`M ${t.x} ${t.y} L ${t.x} ${n.y} L ${n.x} ${n.y}`;const p=function(e,t){function o(e,t,o){const r=t.x-e.x,i=t.y-e.y,l=Math.sqrt(r*r+i*i);return n(e,t,Math.min(1,o/l))}function n(e,t,o){return{x:e.x+(t.x-e.x)*o,y:e.y+(t.y-e.y)*o}}function r(e,t){e.length>2&&(e[e.length-2]=t.x.toString(),e[e.length-1]=t.y.toString())}function i(e){return{x:parseFloat(e[e.length-2]),y:parseFloat(e[e.length-1])}}const l=e.split(/[,\s]/).reduce(((e,t)=>{const o=t.match("([a-zA-Z])(.+)");return o?(e.push(o[1]),e.push(o[2])):e.push(t),e}),[]).reduce((function(e,t){return!isNaN(parseFloat(t))&&e.length?e[e.length-1].push(t):e.push([t]),e}),[]);let a=[];if(l.length>1){const e=i(l[0]);let s=null;"Z"===l[l.length-1][0]&&l[0].length>2&&(s=["L",e.x.toString(),e.y.toString()],l[l.length-1]=s),a.push(l[0]);for(let c=1;c<l.length;c++){const e=a[a.length-1],u=l[c],d=u===s?l[1]:l[c+1];if(d&&e&&e.length>2&&"L"===u[0]&&d.length>2&&"L"===d[0]){const l=i(e),s=i(u),c=i(d),p=o(s,l,t),g=o(s,c,t);r(u,p),a.push(u);const m=n(p,s,.5),y=n(s,g,.5),v=["C",m.x.toString(),m.y.toString(),y.x.toString(),y.y.toString(),g.x.toString(),g.y.toString()];a.push(v)}else a.push(u)}if(s){const e=i(a[a.length-1]);a.push(["Z"]),r(a[0],e)}}else a=l;return a.reduce((function(e,t){return`${e}${t.join(" ")} `}),"")}(d,s||i);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:p,style:a,fill:"transparent"}),c||u?(0,r.jsxs)("g",{onMouseMove:c,onMouseLeave:u,children:[(0,r.jsx)("path",{d:p,style:{strokeOpacity:0,strokeWidth:16,pointerEvents:"stroke",cursor:"default"},fill:"transparent"}),e.children]}):void 0]})}},265793:(e,t,o)=>{o.d(t,{b:()=>v,v:()=>f});var n=()=>o(484714),r=()=>o(56366),i=()=>o(888325),l=()=>o(187174),a=()=>o(96689),s=()=>o(541801),c=()=>o(559506),u=()=>o(645873),d=()=>o(765957),p=()=>o(961581),g=()=>o(543665),m=()=>o(299177);const y=!1;function v(e){var t;const o=null===(t=(0,u().fJ)(s().xl).value)||void 0===t?void 0:t.loadWorkflowTemplateInstances;(0,r().K8)((()=>{if(!o)return;const t=function(e){return!(e instanceof g().m)}(e)?e.collectionStore():e;t&&o(t)}),[o,e])}function f(){const e=(0,n().v3)(),t=(0,r().K8)((()=>{var e;if(function(){const e=p().A.state.initialRenderCompleted;y&&!e&&console.log("Initial page render is not yet completed, delaying refresh of workflow template instances.");return e}())return null===(e=d().default.state.sidebarSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]);(0,l().Yb)((async()=>{if(!t)return;(m().A.debug||y)&&console.log("Refreshing workflow template instance map for space",t);const o={table:a().NX,id:t,spaceId:t},n=await c().callApi({eventName:"getWorkflowTemplateInstances",environment:e,data:{spaceId:o.spaceId,scopeTable:o.table,scopeId:o.id,enableInstanceRobustness:!0}});if("success"===n.type){const e=(0,i()._)(o);m().A.setState({...m().A.state,[e]:n.data.instanceMap[e]})}}),[e,t])}},271080:(e,t,o)=>{o.d(t,{p:()=>O});o(898992),o(581454),o(737550);var n=o(296540),r=()=>o(484714),i=()=>o(56366),l=()=>o(401497),a=()=>o(160432),s=()=>o(764880),c=()=>o(62371),u=()=>o(898244),d=()=>o(40457),p=()=>o(799829),g=()=>o(179034),m=()=>o(69708),y=()=>o(496603),v=()=>o(534177),f=()=>o(284371),h=()=>o(901389),S=()=>o(908201),x=()=>o(251126),b=()=>o(297872),C=()=>o(623580),k=()=>o(419357),A=()=>o(404277),w=()=>o(939740),j=()=>o(64e3),I=()=>o(305390),T=()=>o(89924),M=()=>o(287531),B=()=>o(862139),V=()=>o(457688),P=()=>o(594794),_=()=>o(722872),G=()=>o(106628),F=()=>o(361330),R=()=>o(970585),E=()=>o(148832),L=()=>o(543665),K=o(474848);function O(e){const{onChange:t,currentGroups:o,groupBy:l,groupFormat:a,onClose:s,schema:u,parentStore:d}=e,[p,g]=(0,n.useState)(""),y=(0,i().uB)(void 0,R().A),v=(0,r().Y0)(),f=(0,n.useCallback)((()=>{W({onChange:t,currentGroups:o,groupBy:l,groupFormat:a,inputValue:p,onClose:s})}),[o,l,a,p,t,s]);let h;return(0,n.useEffect)((()=>{var e;a&&("select"===a.value.type||"multi_select"===a.value.type)&&a.value.value?g(a.value.value):a&&(0,c().kO)(a.value)&&"exact"===(null===(e=a.value.value)||void 0===e?void 0:e.type)&&g(a.value.value.value)}),[a]),h=v.isMobile?{menuType:_().gu.Modal,title:a?(0,K.jsx)(m().sA,{defaultMessage:"Rename group",id:"codeBlock.databaseEditGroupMenu.renameGroupTitle"}):(0,K.jsx)(m().sA,{defaultMessage:"Add a group",id:"codeBlock.databaseEditGroupMenu.addGroupTitle"}),left:(0,K.jsx)(m().sA,{defaultMessage:"Cancel",id:"codeBlock.databaseEditGroupMenu.cancelButton.label"}),right:(0,K.jsx)(m().sA,{defaultMessage:"Done",id:"codeBlock.databaseEditGroupMenu.doneButton.label"}),onClickRight:f,onClickLeft:s}:{menuType:_().gu.Popup,width:z(l)?300:240,maxHeight:"50vh"},(0,K.jsx)(b().A,{capture:!0,render:e=>(0,K.jsx)(A().A,{...h,...e,children:(0,K.jsx)(Z,{groupBy:l,schema:u,onChange:t,currentGroups:o,groupFormat:a,onClose:s,parentStore:d,inputValue:p,setInputValue:g,menuListStore:y})})})}function N(){return(0,K.jsx)(m().sA,{defaultMessage:"Group already exists.",id:"database.groupExistsAlreadyError.message"})}function z(e){return"select"===e.type||"multi_select"===e.type||(0,c().Vs)(e.type)}function D({currentGroups:e,onChange:t,groupFormat:o,onClose:l,inputValue:a,menuListStore:c}){const u=(0,r().v3)(),d=(0,m().tz)(),p=(0,i().uB)(c,R().A),[g,v]=(0,n.useState)(a);return(0,K.jsx)(x().A,{request:g,performRequest:e=>async function(e,t,o){const n=await G().T.searchActions.load();return{users:await n.searchSpaceUsers({environment:t,query:e,membersOnly:!1,limit:20,shouldUseEdgeCacheRollout:!0}),groups:n.searchSpaceGroups({query:e,intl:o,limit:20}),type:"notionUsersAndGroups"}}(e,u,d),debounce:F().tu,render:(n,r,i)=>{r||(r={users:[],groups:[]});const a=[...y().oE(r.users.map((n=>({key:n.id,render:e=>(0,K.jsx)(V().A,{actor:(0,s().A7)(n),...e}),action:()=>{H({table:"notion_user",id:n.id},o,e,t,l)}})))),...y().oE(r.groups.map((n=>({key:n.group_id,render:e=>(0,K.jsx)(B()._,{group:n,menuListItemProps:e}),action:()=>{H(n.getGroupPointer(),o,e,t,l)}}))))];let c;return c=i&&r&&0===a.length?(0,K.jsx)(T().A,{children:(0,K.jsx)(j().A,{title:(0,K.jsx)(m().sA,{defaultMessage:"No results",id:"database.noPersonSearchResults.message"})})}):(0,K.jsx)(w().Ay,{type:w().Oh.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,K.jsx)(T().A,{...e}),items:a}],store:p}),(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(T().A,{children:(0,K.jsx)(k().Ay,{value:g,focus:!0,placeholder:d.formatMessage({defaultMessage:"Search for a person or groupâ€¦",id:"database.searchPersonOrGroups.placeholder"}),onChange:e=>{v(e.target.value),p.setState({...p.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}})}),c]})}})}function H(e,t,o,n,r){const i={type:"person",value:e};return t&&y().n4(i,t.value)?(null==r||r(),null):o.some((e=>(0,c().OF)(i,e.value)))?(h().f1((0,K.jsx)(N,{})),null):void n({newGroupValue:i})}function U(e,t,o,n,r,i){const l=o[n.property];if(!l||"relation"!==l.type)return null;const a=u().Nv(l);if(!a)return null;const s=L().m.createChildStore(t,a);return s.isDefined()&&i.length>0?{key:"new-page",render:e=>(0,K.jsx)(M().A,{targetCollectionStore:s,pageName:i,...e}),action:()=>{const t=(0,P().Z1)({environment:e,table:g().ev,spaceId:s.getSpaceId()}),o={table:g().ev,id:t,spaceId:s.getSpaceId()};r({newGroupValue:{type:"relation",value:o},newPage:{id:o.id,spaceId:o.spaceId,name:i}})}}:null}function W({onChange:e,currentGroups:t,groupBy:o,groupFormat:n,inputValue:r,onClose:i}){const l=r.trim().replace(/,/g,"");let a;"select"===o.type||"multi_select"===o.type?a={type:o.type,value:l}:(0,c().Vh)(o)&&(a={type:o.type,value:{type:"exact",value:l}}),a&&l?n&&y().n4(a,n.value)?null==i||i():t.some((e=>a&&(0,c().OF)(a,e.value)))?h().f1((0,K.jsx)(N,{})):e({newGroupValue:a}):null==i||i()}function $(e,t,o,n,r,i,l,a,s){const u=null==s?void 0:s.relativeVariableStore.state,d=u&&u[t.id],g=(e,o)=>{const r=L().m.createChildStore(n,t);if(!r.isDefined())return;const i=r.getFormat().app_config_uri;return i&&o?e.formatMessage(p().n$[i][o].messageDescriptor):void 0};return e.map((e=>{const t=E().B.createChildStore(n,e);if(t.isTemplate())return;const s=d?(0,p().cE)(t.id,d):void 0;return{key:t.id,render:e=>(0,K.jsx)(I().A,{store:t,titlePrefix:g(r,s),...e}),action:()=>{let t={type:"relation",value:e};s&&(t={type:"relation",value:{type:"relative",value:{type:"builtin",variable:s}}}),l&&y().n4(t,l.value)?null==a||a():o.some((e=>(0,c().OF)(t,e.value)))?h().f1((0,K.jsx)(N,{})):i({newGroupValue:t})}}}))}function q({onChange:e,currentGroups:t,groupBy:o,groupFormat:i,onClose:s,inputValue:c,setInputValue:u,menuListStore:p}){const g=(0,m().tz)(),y=(0,l().DP)(),v=(0,n.useCallback)((()=>W({onChange:e,currentGroups:t,groupBy:o,groupFormat:i,inputValue:c,onClose:s})),[e,t,o,i,c,s]),h=(0,n.useCallback)((n=>function(e,t,o,n,r,i,l){13===e.keyCode?W({onChange:t,currentGroups:o,groupBy:n,groupFormat:r,inputValue:i,onClose:l}):27===e.keyCode&&(null==l||l())}(n,e,t,o,i,c,s)),[e,t,o,i,c,s]),S=(0,n.useCallback)((e=>function(e,t,o){t(e.target.value),o.setState({...o.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}(e,u,p)),[p,u]),x=(0,r().WS)(),b=i?g.formatMessage({id:"database.collectionEditGroupMenu.renameGroupLabel.placeholder",defaultMessage:"Rename group"}):g.formatMessage({id:"database.collectionEditGroupMenu.newGroupLabel.placeholder",defaultMessage:"New group"});return x?(0,K.jsx)(T().A,{children:(0,K.jsx)(k().Ay,{value:c,focus:!0,selectAll:!0,showClearButton:!1,focusInitial:!0,placeholder:b,onChange:S,onKeyDown:h})}):(0,K.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:6,width:"100%",background:y.inputBackground},children:[(0,K.jsx)(C().A,{value:c,focus:!0,selectAll:!0,focusInitial:!0,placeholder:b,onChange:S,onKeyDown:h,format:C().C.Transparent,style:{fontSize:f().J.UIRegular.desktop}}),(0,K.jsx)(a().A,{colorPalette:"blue",size:"sm",onClick:v,iconTrailing:d().arrowTurnDownLeftSmallIcon,children:(0,K.jsx)(m().sA,{defaultMessage:"Done",id:"database.collectionEditGroupMenu.submitButton.label"})})]})}function Y({parentStore:e,schema:t,groupBy:o,currentGroups:l,onChange:a,groupFormat:s,onClose:c,inputValue:d,setInputValue:p,menuListStore:m}){const y=(0,r().v3)(),v=(0,n.useMemo)((()=>{const e=t[o.property];return!(!e||"relation"!==e.type)&&u().Nv(e)}),[o.property,t]);return(0,i().K8)((()=>{if(!v)return!1;return L().m.createChildStore(e,v).isDefined()}),[v,e])&&v?(0,K.jsx)(x().A,{request:d,performRequest:n=>async function(e,t,o,n,r){const i=o[t.property];if(!i||!(0,u().nC)(i))return;const l=u().Nv(i);if(!l)return;const a=L().m.createChildStore(n,l);if(await a.load(),!a.isDefined())return;const s=a.getSpaceId(),c=await G().T.searchActions.load();return(await c.searchPagesInCollection({environment:r,query:e,collectionId:l.id,spaceId:s,excludeTemplates:!0,source:"collection_group_value",limit:20,includePublicPagesWithoutExplicitAccess:!0,boostRecentlyViewedPages:!1})).results.map((e=>({table:g().ev,id:e,spaceId:s})))}(n,o,t,e,y),debounce:F().tu,render:(n,r=[],i)=>(0,K.jsx)(Q,{ready:i,results:r,parentStore:e,schema:t,groupBy:o,currentGroups:l,onChange:a,groupFormat:s,onClose:c,inputValue:d,setInputValue:p,menuListStore:m,collectionPointer:v,environment:y})}):null}function Q({parentStore:e,schema:t,groupBy:o,currentGroups:r,onChange:l,groupFormat:a,onClose:s,inputValue:c,setInputValue:u,menuListStore:d,results:p,ready:g,collectionPointer:v,environment:f}){const h=(0,m().tz)(),x=(0,n.useContext)(S().p2),b=(0,i().K8)((()=>y().oE([...$(p,v,r,e,h,l,a,s,x),U(f,e,t,o,l,c)])),[f,x,v,r,o,a,c,h,l,s,e,p,t]);let C;return C=g&&p&&0===b.length?(0,K.jsx)(T().A,{children:(0,K.jsx)(j().A,{title:(0,K.jsx)(m().sA,{defaultMessage:"No results",id:"database.noRelationSearchResults.message"})})}):(0,K.jsx)(w().Ay,{type:w().Oh.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,K.jsx)(T().A,{...e}),items:b}],store:d}),(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(T().A,{children:(0,K.jsx)(k().Ay,{value:c,focus:!0,placeholder:h.formatMessage({defaultMessage:"Type to search...",id:"database.searchRelation.placeholder"}),onChange:e=>{u(e.target.value),d.setState({...d.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}})}),C]})}function Z({groupBy:e,schema:t,onChange:o,currentGroups:n,groupFormat:r,onClose:i,parentStore:l,inputValue:a,setInputValue:s,menuListStore:u}){return t[e.property]?"select"===e.type||"multi_select"===e.type?(0,K.jsx)(q,{onChange:o,currentGroups:n,groupBy:e,groupFormat:r,onClose:i,inputValue:a,setInputValue:s,menuListStore:u}):"person"===e.type?(0,K.jsx)(D,{currentGroups:n,onChange:o,groupFormat:r,onClose:i,inputValue:a,menuListStore:u}):"relation"===e.type?(0,K.jsx)(Y,{parentStore:l,schema:t,groupBy:e,currentGroups:n,onChange:o,groupFormat:r,onClose:i,inputValue:a,setInputValue:s,menuListStore:u}):(0,c().Vs)(e.type)?(0,K.jsx)(q,{onChange:o,currentGroups:n,groupBy:e,groupFormat:r,onClose:i,inputValue:a,setInputValue:s,menuListStore:u}):"number"===e.type||"status"===e.type||"date"===e.type||"formula"===e.type||"checkbox"===e.type||"created_time"===e.type||"last_edited_time"===e.type||"created_by"===e.type||"last_edited_by"===e.type||"last_visited_time"===e.type||"location"===e.type?null:void(0,v().HB)(e.type):null}},274375:(e,t,o)=>{o.d(t,{Q:()=>r});o(898992),o(354520),o(672577);var n=()=>o(898244);function r(e,t){const o={property:n().rn,visible:!0,width:276},r={property:t,visible:!0},i=[o,r],l=e.getCollectionViewStores().find((e=>"table"===e.getType())),a=null==l?void 0:l.getFormatStore().getKeyStore("table_properties").getValue();if(!l||!a||0===a.length)return i;const s=a.find((e=>e.property===n().rn))??o;return[s,a.find((e=>e.property===t))??r,...a.filter((e=>e.property!==n().rn&&e.property!==t))]}},278094:(e,t,o)=>{o.d(t,{y:()=>l});var n=()=>o(62371),r=()=>o(436696),i=()=>o(896628);function l(e){const{environment:t,collectionContextStore:o,transaction:l,groupByKey:a,groupsFormatKey:s,sortType:c}=e;if("chart_config"===a)return;const u=(0,n().H2)(o.normalizedFormatStore.state,a,s),d=o.collectionViewStore();if(!u||!d)return;if((0,n().Nf)(u).includes(c)){if("formula"===u.type){const e={...u,groupBy:{...u.groupBy,sort:{type:c}}};i().zA({stores:[d],update:{[a]:e},transaction:l})}else i().zA({stores:[d],update:{[a]:{...u,sort:{type:c}}},transaction:l});(0,r().X)({environment:t,collectionContextStore:o,action:"update_group_sort"})}}},287531:(e,t,o)=>{o.d(t,{A:()=>l});var n=o(296540),r=o(474848);function i(e){const{pageName:t,targetCollectionStore:n,...i}=e,l=(0,o(484714).Y0)(),a=(0,o(56366).K8)((()=>n.getIcon()),[n]),s=(0,o(401497).IS)((e=>({medium:{color:e.text.secondary},dbName:{display:"flex",alignItems:"center",marginInlineStart:4},title:{marginInlineStart:o(246219).g1*(l.isRetina?.5:1)}})),[l.isRetina]),c=(0,r.jsxs)("div",{style:s.dbName,children:[(0,r.jsx)(o(187820).B6,{disabled:!0,icon:a,iconRecordCategory:"collection",isEmptyPage:!1,size:l.isMobile?24:20}),(0,r.jsx)(o(16006).A,{store:n,style:s.title})]});return(0,r.jsx)(o(760217).A,{title:(0,r.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,r.jsx)(o(69708).sA,{id:"database.searchRelation.createNewPageFooter",defaultMessage:"<medium>New</medium> {pageName} <medium> in</medium> {databaseNameWithIcon}",values:{medium:e=>(0,r.jsx)("span",{style:s.medium,children:e}),pageName:(0,r.jsx)("span",{style:{marginInlineStart:4,marginInlineEnd:4},children:t}),databaseNameWithIcon:c}})}),icon:(0,r.jsx)(o(252291).I,{icon:o(617668).plusIcon,colorVariant:"secondary"}),...i})}const l=n.memo(i)},287940:(e,t,o)=>{o.d(t,{A:()=>P});var n=o(296540),r=()=>o(955450),i=()=>o(484714),l=()=>o(56366),a=()=>o(401497),s=()=>o(543906),c=()=>o(252291),u=()=>o(406094),d=()=>o(761940),p=()=>o(955363),g=()=>o(69708),m=()=>o(284371),y=()=>o(497222),v=()=>o(300789),f=()=>o(131448),h=()=>o(53137),S=()=>o(712505),x=()=>o(404141),b=()=>o(583238),C=()=>o(637096),k=()=>o(320260),A=()=>o(718827),w=()=>o(953006),j=o(474848);const I=(0,g().YK)({defaultTitle:{id:"openInNotionCalendarOnboardingTooltip.header",defaultMessage:"Get Notion Calendar"},defaultContent:{id:"openInNotionCalendarOnboardingTooltip.content",defaultMessage:"View any Notion database with calendar and timeline views with your Google Calendar events"},connectCalendarTitle:{id:"openInNotionCalendarOnboardingTooltip.connectCalendarTitle",defaultMessage:"Connect Calendar"},successTitle:{id:"openInNotionCalendarOnboardingTooltip.success.header",defaultMessage:"Successfully connected"},successContent:{id:"openInNotionCalendarOnboardingTooltip.success.content",defaultMessage:"You can now view any database with calendar and timeline views in Notion Calendar"}});function T({variant:e,origin:t,onCloseClick:o,onConnectCalendarClick:n}){const r=(0,a().IS)((e=>({tooltip:{width:233},content:{opacity:1},contentInner:{display:"flex",flexDirection:"column",gap:14},contentMessage:{opacity:.8,color:e.text.inversePrimary},footer:{display:"flex",alignItems:"center",gap:12},primaryButton:{display:"flex",alignItems:"center",height:24,padding:"0 12px",marginInlineStart:"auto",borderRadius:4,background:"#FFF",color:"#1D1B16",fontSize:12,fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},primaryButtonHover:{background:"rgba(255,255,255,0.9)"},primaryButtonPressed:{background:"rgba(255,255,255,0.8)"}})),[]);return(0,j.jsx)(w().k,{origin:t,placementToOrigin:"bottom",header:(0,j.jsx)(g().sA,{..."success"===e?I.successTitle:I.defaultTitle}),content:(0,j.jsxs)("div",{style:r.contentInner,children:[(0,j.jsx)("div",{style:r.contentMessage,children:(0,j.jsx)(g().sA,{..."success"===e?I.successContent:I.defaultContent})}),"default"===e?(0,j.jsx)("div",{style:r.footer,children:(0,j.jsx)(A().Ay,{style:r.primaryButton,hoveredStyle:r.primaryButtonHover,pressedStyle:r.primaryButtonPressed,onClick:n,children:(0,j.jsx)(g().sA,{...I.connectCalendarTitle})})}):void 0]}),contentStyle:r.content,onCloseClick:o,shouldDismissUponOutsideClick:!1,enableMouseCapture:!1,pointerPosition:"33%",style:{...r.tooltip}})}function M({collectionContextStore:e,entrypoint:t}){const o=(0,i().v3)(),n=(0,l().K8)((()=>(0,b().mX)()),[]),r=(0,l().K8)((()=>f().default.isVisible("open_in_calendar_tooltip")),[]),a=(0,l().K8)((()=>{const t=x().A.state.open||e.settingsStore.state.open,o=e.isFullScreenStore.state,n=S().default.state.open;return o&&!t&&!n&&h().A.state.loaded}),[e]);(0,s().A)((()=>{v().HH(o,"open_in_calendar_tooltip")}),a);const c=(0,C().W)({collectionContextStore:e,entrypoint:t});switch(t){case"calendar_view":case"timeline_view":return(0,j.jsx)(B,{showTooltip:r,hasConnectedCalendar:n,openNotionCalendar:c});case"view_settings":return(0,j.jsx)(V,{openNotionCalendar:c})}}function B(e){const{showTooltip:t,hasConnectedCalendar:o,openNotionCalendar:r}=e,l=(0,i().v3)(),s=(0,n.useRef)(null),[c,p]=(0,n.useState)(!1),y=(0,a().IS)((e=>({button:{marginInlineEnd:8,paddingInlineEnd:12,fontSize:14,fontWeight:m().Wy.medium,height:26},calendarIcon:{height:18,width:18,marginInlineEnd:6,fill:e.text.primary}})),[]),f=(0,n.useCallback)((()=>{v().a(l,"open_in_calendar_tooltip")}),[l]),h=(0,n.useCallback)((()=>{p(!0),r()}),[r]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(u().A,{size:"lg",ref:s,style:y.button,onClick:r,children:[(0,j.jsx)(k().y,{style:y.calendarIcon}),(0,j.jsx)(g().sA,{...d().PQ.manageInCalendar})]}),t?(0,j.jsx)(T,{variant:c||o?"success":"default",origin:s,onCloseClick:f,onConnectCalendarClick:h}):void 0]})}function V(e){const{openNotionCalendar:t}=e,o=(0,a().IS)((()=>({calendarIcon:{height:18,width:18}})),[]);return(0,j.jsx)(y().A,{showChevron:!1,icon:e=>(0,j.jsx)(k().y,{style:{...e,...o.calendarIcon}}),onClick:()=>t(),right:(0,j.jsx)(c().I,{icon:p().arrowDiagonalUpRightIcon,colorVariant:"tertiary",size:18}),title:(0,j.jsx)(g().sA,{...d().PQ.manageInCalendar})})}function P(e){return(0,r().K)({collectionContextStore:e.collectionContextStore})?(0,j.jsx)(M,{...e}):null}},330918:(e,t,o)=>{o.d(t,{d:()=>$});o(898992),o(672577);var n=o(296540),r=()=>o(726637),i=()=>o(484714),l=()=>o(56366),a=()=>o(401497),s=()=>o(718827),c=()=>o(729108),u=()=>o(764880),d=()=>o(584262),p=()=>o(62371),g=()=>o(898244),m=()=>o(713998),y=()=>o(784892),v=()=>o(72135),f=()=>o(799829),h=()=>o(437607),S=()=>o(69708),x=()=>o(534177),b=()=>o(284371),C=()=>o(374562),k=()=>o(147503),A=()=>o(177618),w=()=>o(308631),j=()=>o(406699),I=()=>o(296798),T=()=>o(187820),M=()=>o(16006),B=()=>o(859428),V=()=>o(448693),P=()=>o(27356),_=()=>o(204358),G=()=>o(399762),F=()=>o(635462),R=()=>o(522827),E=()=>o(23815),L=()=>o(492414),K=()=>o(765957),O=()=>o(148832),N=()=>o(543665),z=()=>o(934201),D=()=>o(271080),H=o(474848);const U=Object.freeze({overflow:"hidden",padding:3,borderRadius:6,fontWeight:b().Wy.medium}),W=Object.freeze({overflow:"hidden",padding:3,marginInlineEnd:3,borderRadius:6,fontWeight:b().Wy.medium}),$=n.memo((function(e){const{schema:t,groupFormat:n,collectionContextStore:r,isHiddenGroup:i,style:a,uncategorizedIconStyle:s,currentGroups:c,groupBy:u,onChange:d,onClose:p,disabled:m,source:y}=e,v=(0,l().uB)(void 0,o(463830).A),f=(0,l().K8)((()=>{const e=r.groupsStore.getGroupState(n);return null==e?void 0:e.groupUiParentStore}),[r,n]),h=(0,l().K8)((()=>{const e=t[n.property];if(e&&(0,g().nC)(e)&&f)return(0,o(685889).LQ)(e,f)}),[t,n,f]),S=t[n.property];if(!S)return null;const x=n.value;if(void 0===x.value)return(0,H.jsx)(re,{groupFormat:n,schema:t,isHiddenGroup:i,collectionContextStore:r,style:a,uncategorizedIconStyle:s,parentStore:f});if("formula"===x.type){if("formula"!==x.type)return null;const e=x.value;return e?(0,H.jsx)(q,{schema:t,currentGroups:c,groupBy:u,groupFormat:n,onChange:d,onClose:p,disabled:m,style:a,isHiddenGroup:i,collectionContextStore:r,buttonPopupStore:v,parentStore:f,relatedCollectionAppConfigUri:h,groupValue:e,propertySchema:S,source:y}):null}return(0,H.jsx)(q,{schema:t,currentGroups:c,groupBy:u,groupFormat:n,onChange:d,onClose:p,disabled:m,style:a,isHiddenGroup:i,collectionContextStore:r,buttonPopupStore:v,parentStore:f,relatedCollectionAppConfigUri:h,groupValue:x,propertySchema:S,source:y})}));function q(e){const{groupValue:t,propertySchema:o,schema:n,currentGroups:r,groupBy:i,groupFormat:l,onChange:a,onClose:s,disabled:c,style:u,isHiddenGroup:d,collectionContextStore:g,buttonPopupStore:m,parentStore:y,relatedCollectionAppConfigUri:v}=e;return"select"===t.type||"multi_select"===t.type?(0,H.jsx)(ue,{schema:n,currentGroups:r,groupBy:i,groupFormat:l,onChange:a,onClose:s,disabled:c,style:u,buttonPopupStore:m,parentStore:y}):"status"===t.type?(0,H.jsx)(X,{groupFormat:l,schema:n}):(0,p().r4)(t.type)?(0,H.jsx)(de,{schema:n,currentGroups:r,groupBy:i,groupFormat:l,onChange:a,onClose:s,disabled:c,style:u,isHiddenGroup:d,buttonPopupStore:m,parentStore:y,groupValue:t}):"relation"===t.type?(0,H.jsx)(le,{schema:n,groupFormat:l,collectionContextStore:g,style:u,parentStore:y,relatedCollectionAppConfigUri:v,groupValue:t}):"location"===t.type?(0,H.jsx)(ie,{style:u,collectionContextStore:g,parentStore:y,groupValue:t}):(0,p()._o)(t.type)?(0,H.jsx)(oe,{style:u,groupValue:t}):(0,p().Vs)(t.type)?(0,H.jsx)(pe,{schema:n,currentGroups:r,groupBy:i,groupFormat:l,onChange:a,onClose:s,disabled:c,style:u,buttonPopupStore:m,parentStore:y,groupValue:t}):"number"===t.type?(0,H.jsx)(ne,{style:u,groupValue:t,propertySchema:"number"===o.type?o:void 0}):"checkbox"===t.type?(0,H.jsx)(te,{style:u,propertySchema:o,groupValue:t}):void(0,x().HB)(t.type)}function Y(e){const{isHiddenGroup:t}=e,o=(0,n.useCallback)((()=>(0,H.jsx)(S().sA,{id:"database.boardView.uncategorizedColumnTooltip",defaultMessage:"Any items with an empty <b>{name}</b> property will go here. This group cannot be removed.",values:{name:null,b:e=>(0,H.jsx)("span",{style:{fontWeight:b().Wy.semibold},children:e})}})),[]),r=(0,n.useCallback)((t=>(0,H.jsx)(Q,{...e,tooltipEvents:t})),[e]),i=(0,a().IS)((()=>({container:{width:240}})),[]);return t?(0,H.jsx)(Q,{...e,tooltipEvents:void 0}):(0,H.jsx)(B().A,{renderTooltip:o,render:r,style:i.container,textWrap:!0})}function Q(e){const{style:t,tooltipEvents:o,formattedLabelMessage:n}=e,r=(0,a().IS)((()=>({container:{display:"flex",alignItems:"center",lineHeight:1.2,paddingInlineEnd:4,whiteSpace:"nowrap",overflow:"hidden",fontWeight:b().Wy.medium,paddingInlineStart:0,...t},text:{marginInlineStart:4,...b().RC}})),[t]);return(0,H.jsx)("div",{style:r.container,...o,children:(0,H.jsx)("span",{style:r.text,children:n})})}function Z(e){const{value:t}=e;return"other"===t.type?(0,H.jsx)(S().sA,{defaultMessage:"Other",id:"database.collectionGroupValue.textGroup.otherValue"}):"alphabet_prefix"===t.type||"exact"===t.type?(0,H.jsx)(H.Fragment,{children:t.value}):void(0,x().HB)(t)}function X(e){const{groupFormat:t,schema:o}=e,n=(0,a().IS)((()=>({name:{fontWeight:500},status:{fontWeight:500,lineHeight:"normal",overflow:"hidden",paddingInlineEnd:6}})),[]),r=o[t.property];if(!r||"status"!==r.type)return null;const i=t.value;if(i.type!==r.type)return null;const{value:l}=i;if(!l)return null;const s=r.options??[],c=r.groups??[];if("by_group"===l.type){const e=c.find((e=>e.name===l.group));return e?(0,H.jsx)(w().RS,{group:e,style:n.name,showIcon:!0,showColor:!0}):null}if("by_option"===l.type){const e=(0,m().jy)(s,l.option),t=e&&c.find((t=>{var o;return null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id)}));return e?(0,H.jsx)("span",{style:n.status,children:(0,H.jsx)(G().q,{format:y().NY.Medium,isSingle:!0,value:e.value,color:e.color,showRemoveButton:!1,groupColor:null==t?void 0:t.color})}):null}(0,x().HB)(l)}function J(e){const{value:t}=e,o=(0,S().tz)();return(0,H.jsx)(H.Fragment,{children:(0,z().nc)({intl:o,value:t})})}function ee(e){const{value:t,format:o}=e,n=(0,S().tz)();return(0,H.jsx)(H.Fragment,{children:(0,z()._T)({intl:n,value:t,format:o})})}function te(e){const{groupValue:t,propertySchema:o,style:n}=e,r=(0,a().IS)((()=>({container:{...b().RC,fontWeight:b().Wy.medium,marginInlineEnd:3,display:"flex",alignItems:"center",...n},checkboxStyle:{display:"inline-flex",marginInlineEnd:6}})),[n]);return"checkbox"!==t.type?null:(0,H.jsxs)("div",{style:r.container,children:[(0,H.jsx)(c().S,{checked:t.value,size:14,disabled:!0,style:r.checkboxStyle}),(0,H.jsx)("span",{children:null==o?void 0:o.name})]})}function oe(e){const{groupValue:t,style:o}=e,n=(0,a().IS)((()=>({container:{...W,...b().RC,...o}})),[o]);return t.value&&(0,p().DH)(t)?(0,H.jsx)("div",{style:n.container,children:(0,H.jsx)(J,{value:t.value})}):null}function ne({groupValue:e,propertySchema:t,style:o}){const n=(0,a().IS)((()=>({container:{...W,...o}})),[o]);if("number"!==e.type||!e.value)return null;const r=(null==t?void 0:t.number_format)||v().C4;return(0,H.jsx)("div",{style:n.container,children:(0,H.jsx)(ee,{value:e.value,format:r})})}function re(e){const{groupFormat:t,schema:o,isHiddenGroup:n,collectionContextStore:r,style:i,uncategorizedIconStyle:a,parentStore:s}=e,c=o[t.property],u=(0,l().K8)((()=>r.collectionStore()),[r]),d=(0,l().K8)((()=>!!(null!=u&&u.isDefined()&&c&&(0,g().nC)(c)&&s)&&(0,E().Vu)({collectionStore:u,property:t.property,propertySchema:c,parentStore:s})),[u,t,c,s]);return c?d?(0,H.jsx)(Y,{style:i,uncategorizedIconStyle:a,isHiddenGroup:n,formattedLabelMessage:(0,H.jsx)(S().sA,{...E().zX.sprintUncategorizedGroup,values:{name:c.name}})}):(0,H.jsx)(Y,{style:i,uncategorizedIconStyle:a,isHiddenGroup:n,formattedLabelMessage:(0,H.jsx)(S().sA,{...z().K0.emptyGroupLabel,values:{name:c.name}})}):null}function ie(e){const{style:t,collectionContextStore:o,groupValue:r,parentStore:i}=e,s=(0,l().K8)((()=>{var e;return null===(e=o.collectionViewBlockStore())||void 0===e?void 0:e.id}),[o]),c=(0,n.useMemo)((()=>i&&"location"===r.type&&r.value?N().m.createChildStore(i,r.value):void 0),[i,r.type,r.value]),u=(0,l().K8)((()=>null==c?void 0:c.getParentBlockStore()),[c]),p=(0,l().K8)((()=>s&&(0,F().s)(s)?o.isInHomeWidgetStore.state?d().y8.PersonalHomeTileTasks:d().y8.PersonalHomePageTasks:d().y8.LocationProperty),[s,o]),g=(0,l().K8)((()=>u?(0,L().Ay)({store:u,fullyQualified:!1,pageVisitSource:p}):void 0),[u,p]),m=(0,l().K8)((()=>null==c?void 0:c.getIcon()),[c]),y=(0,a().IS)((()=>({container:{...t,display:"flex"},icon:{marginTop:2,marginInlineEnd:6},title:{fontWeight:b().Wy.medium}})),[t]);return"location"===r.type&&r.value&&i&&c?(0,H.jsxs)(I().A,{href:g,style:y.container,ignoreLocalHoverState:!0,children:[(0,H.jsx)(T().B6,{disabled:!0,icon:m,iconRecordCategory:"collection",size:20,isEmptyPage:!1,style:y.icon}),(0,H.jsx)(M().A,{store:c,underline:!0,style:y.title})]}):null}function le(e){const{groupValue:t,schema:o,groupFormat:r,collectionContextStore:i,style:a,parentStore:s,relatedCollectionAppConfigUri:c}=e,u=o[r.property],d=(0,n.useMemo)((()=>u&&"relation"===u.type?g().Nv(u):void 0),[u]),m=(0,n.useMemo)((()=>s&&d?N().m.createChildStore(s,d):void 0),[s,d]),y=(0,l().K8)((()=>null==m?void 0:m.isDefined()),[m]);return s&&"relation"===t.type&&u&&"relation"===u.type&&d&&m&&t.value?(0,p().zx)(t.value)?c&&y?(0,H.jsx)(ae,{relatedCollectionAppUri:c,groupValueInner:t.value,collectionContextStore:i,collectionPointer:d,targetCollectionStore:m,parentStore:s,style:a}):null:(0,p().WO)(t.value)?(0,H.jsx)(se,{parentStore:s,groupValueInner:t.value,collectionContextStore:i}):null:null}function ae(e){var t;const{relatedCollectionAppUri:o,groupValueInner:r,collectionContextStore:s,collectionPointer:c,targetCollectionStore:u,parentStore:p,style:g}=e,m=(0,S().tz)(),y=(0,i().v3)(),v=r.value.variable,h=(0,l().K8)((()=>u.isDefined()),[u]),w=(0,l().K8)((()=>(0,R().ax)(s,v,c,u)),[s,v,c,u]),j=(0,l().O$)(K().AppStoreMainEditorCurrentBlockStore),T=(0,l().K8)((()=>w?(0,L().Ay)({store:w,pageVisitSource:d().y8.LinkInPage}):void 0),[w]),M=(0,l().K8)((()=>w?A().wy({environment:y,store:w,mainEditorCurrentBlockStore:j,collectionContextStore:s})??(0,L().Ay)({store:w,pageVisitSource:d().y8.LinkInPage}):void 0),[y,w,j,s]);let B;"current"===v?B=m.formatMessage(C().DZ.tasksCurrentSprintV2ViewNamePrefix):"next"===v?B=m.formatMessage(C().DZ.tasksNextSprintV2ViewNamePrefix):"last"===v?B=m.formatMessage(C().DZ.tasksLastSprintV2ViewNamePrefix):(0,x().HB)(v);const P=null===(t=f().n$[o])||void 0===t?void 0:t[v],G=(0,a().IS)((()=>({noPageStoreContainer:{fontWeight:b().Wy.medium},pageStoreContainer:{display:"flex",alignItems:"center"},text:{fontWeight:b().Wy.medium,marginBottom:.25},linkContainer:{...g,marginInlineStart:1}})),[g]),F=(0,n.useCallback)((e=>{if(T&&(e.ctrlKey||e.metaKey))return e.preventDefault(),void window.open(T,"_blank");k().os({collectionSettingsStore:s.settingsStore})}),[s.settingsStore,T]);if(h){if(!w)return(0,H.jsx)("div",{style:G.noPageStoreContainer,children:(0,H.jsx)(S().sA,{...null==P?void 0:P.messageDescriptor})});if(w)return(0,H.jsxs)("div",{style:G.pageStoreContainer,children:[(0,H.jsxs)("div",{style:G.text,children:[B,":"]}),(0,H.jsx)(I().A,{style:G.linkContainer,innerStyle:W,href:M,onClick:F,children:(0,H.jsx)(_().A,{format:V().Ay.Format.Medium,blockId:w.id,isSingle:!0,shouldShrink:!0,parentStore:p,disableLinks:!0})})]})}return(0,H.jsx)("div",{style:G.text,children:(0,H.jsx)(S().sA,{...null==P?void 0:P.messageDescriptor})})}function se(e){const{parentStore:t,groupValueInner:o,collectionContextStore:r,style:a}=e,s=(0,i().v3)(),c=O().B.createChildStore(t,o),u=(0,l().O$)(K().AppStoreMainEditorCurrentBlockStore),p=(0,l().K8)((()=>A().wy({environment:s,store:c,mainEditorCurrentBlockStore:u,collectionContextStore:r})??(0,L().Ay)({store:c,pageVisitSource:d().y8.LinkInPage})),[s,c,u,r]),g=(0,l().K8)((()=>(0,L().Ay)({store:c,pageVisitSource:d().y8.LinkInPage})),[c]),m=(0,n.useCallback)((e=>{if(e.ctrlKey||e.metaKey)return e.preventDefault(),void window.open(g,"_blank");k().os({collectionSettingsStore:r.settingsStore})}),[r.settingsStore,g]);return(0,H.jsx)(I().A,{style:a,innerStyle:W,href:p,onClick:m,children:(0,H.jsx)(_().A,{format:V().Ay.Format.Medium,blockId:o.id,isSingle:!0,shouldShrink:!0,parentStore:t,disableLinks:!0})})}function ce(e){const{schema:t,currentGroups:o,groupBy:r,groupFormat:i,onChange:l,onClose:a,buttonPopupStore:s,parentStore:c}=e,u=(0,n.useCallback)((e=>{s.reset(),null==l||l(e)}),[s,l]),d=(0,n.useCallback)((()=>{s.reset(),null==a||a()}),[s,a]);return c?(0,H.jsx)(D().p,{groupFormat:i,groupBy:r,currentGroups:o,schema:t,onChange:u,onClose:d,parentStore:c}):null}function ue(e){const{schema:t,currentGroups:o,groupBy:i,groupFormat:l,onChange:c,onClose:u,disabled:d,style:p,buttonPopupStore:v,parentStore:f}=e,h=Boolean(r().A.isMobile),S=(0,a().IS)((()=>({container:{...W,...p}})),[p]),x=(0,n.useCallback)((e=>{var o;const n=t[l.property];if(!n||!g().lx(n))return null;const r=l.value;if(null===(o=n.options)||void 0===o||!o.length||void 0===r.value||r.type!==n.type)return null;const i=(0,m().jy)(n.options,r.value);return i?(0,H.jsx)(s().Ay,{style:S.container,disabled:d,...e,children:(0,H.jsx)(G().O,{format:y().NY.Medium,isSingle:!0,value:i.value,color:i.color,showRemoveButton:!1})}):null}),[d,l.property,l.value,t,S.container]),b=(0,n.useCallback)((()=>(0,H.jsx)(ce,{schema:t,currentGroups:o,groupBy:i,groupFormat:l,onChange:c,onClose:u,buttonPopupStore:v,parentStore:f})),[t,o,i,l,c,u,v,f]);return(0,H.jsx)(j().A,{render:b,renderOrigin:x,disabled:d,buttonPopupStore:v,popupType:h?j().z.BottomSheet:j().z.Popup,originGap:4})}function de(e){const{groupValue:t,schema:o,currentGroups:r,groupBy:c,groupFormat:d,onChange:g,onClose:m,disabled:y,style:v,isHiddenGroup:f,buttonPopupStore:S,parentStore:x}=e,{isMobile:b}=(0,i().Y0)(),C=(0,l().K8)((()=>{if(t.value&&(0,p().GG)(t)&&x)return"space_permission_group"===t.value.table?{type:"space_permission_group",value:(0,h().S4)({spacePermissionGroupId:t.value.id,spaceId:t.value.spaceId})}:{type:"actor",value:(0,u().xC)({pointer:t.value,getRecordValue:x.getRecordValue})}}),[t,x]),k=(0,a().IS)((()=>({container:{...W,...v}})),[v]),A=(0,n.useCallback)((e=>C&&x?"space_permission_group"===C.type?(0,H.jsx)(s().Ay,{style:k.container,disabled:y,...e,children:(0,H.jsx)(P().UISpacePermissionGroupToken,{parentStore:x,groupPointer:C.value,format:V().Ay.Format.Medium,showRemoveButton:!1,isSingle:!0,disableAvatarTooltip:f,shouldShrink:!0},C.value.id)}):C.value.asActor?(0,H.jsx)(s().Ay,{style:k.container,disabled:y,...e,children:(0,H.jsx)(V().Ay,{format:V().Ay.Format.Medium,actor:C.value,showRemoveButton:!1,isSingle:!0,disableAvatarTooltip:f,shouldShrink:!0,hasPersonHoverCard:!0})}):null:null),[C,x,y,f,k.container]),w=(0,n.useCallback)((()=>(0,H.jsx)(ce,{schema:o,currentGroups:r,groupBy:c,groupFormat:d,onChange:g,onClose:m,buttonPopupStore:S,parentStore:x})),[o,r,c,d,g,m,S,x]);return(0,p().GG)(t)&&t.value&&x&&C&&("actor"!==C.type||C.value.asActor)?(0,H.jsx)(j().A,{renderOrigin:A,render:w,disabled:y,buttonPopupStore:S,popupType:b?j().z.BottomSheet:j().z.Popup,originGap:4}):null}function pe(e){const{groupValue:t,schema:o,currentGroups:i,groupBy:l,groupFormat:c,onChange:u,onClose:d,disabled:g,style:m,buttonPopupStore:y,parentStore:v}=e,f=Boolean(r().A.isMobile),h=(0,a().IS)((()=>({container:{...U,...b().RC,...m}})),[m]),S=(0,n.useCallback)((e=>(0,p().kO)(t)&&void 0!==t.value?(0,H.jsx)(s().Ay,{style:h.container,disabled:g,...e,children:(0,H.jsx)(Z,{value:t.value})}):null),[g,t,h.container]),x=(0,n.useCallback)((()=>(0,H.jsx)(ce,{schema:o,currentGroups:i,groupBy:l,groupFormat:c,onChange:u,onClose:d,buttonPopupStore:y,parentStore:v})),[o,i,l,c,u,d,y,v]);return(0,p().kO)(t)&&void 0!==t.value?"exact"===t.value.type?(0,H.jsx)(j().A,{renderOrigin:S,render:x,disabled:g,buttonPopupStore:y,popupType:f?j().z.BottomSheet:j().z.Popup,originGap:4}):(0,H.jsx)("div",{style:U,children:(0,H.jsx)(Z,{value:t.value})}):null}},359454:(e,t,o)=>{o.d(t,{P:()=>l});var n=()=>o(391381),r=()=>o(765957),i=()=>o(543665);function l(e){const{environment:t,collectionContextStore:o}=e;let l=o.collectionStore();const a=o.collectionViewBlockStore();if(!l||!a)return;const{mainEditorCurrentBlockStore:s}=r().default.state;s&&o.isFullScreenStore.state&&(l=i().m.createChildStore(s,l.pointer)),(0,n().x)({environment:t,store:l.getNameStore(),canSelectAllBlocks:!1})}},396671:(e,t,o)=>{o.d(t,{d:()=>i});o(944114),o(898992),o(672577),o(803949),o(581454);var n=()=>o(56366),r=()=>o(62371);function i({reducerResult:e,groupBy:t,subGroupBy:o}){return(0,n().K8)((()=>{const n=[],i=[];if(!e)return{version:"v2",currentGroups:[],visibleGroups:[],hiddenGroups:[],pinnedGroups:{groups:[],aggregations:{}},hasMore:!1};if(t){var l,a;e.results.forEach((o=>{var l;const a=null===(l=e.pinnedResults)||void 0===l?void 0:l.groupResults.find((e=>(0,r().AC)(e.value)===(0,r().AC)(o.value)));o.visible?n.push({property:t.property,value:o.value,pinned:!!a||void 0}):i.push({property:t.property,value:o.value,hidden:!0,pinned:!!a||void 0})}));const o=(null===(l=e.pinnedResults)||void 0===l?void 0:l.groupResults.map((e=>({property:t.property,value:e.value,pinned:!0,hidden:!e.visible}))))??[];return{version:"v2",currentGroups:[...n,...i],visibleGroups:n,hiddenGroups:i,pinnedGroups:{groups:o,aggregations:(null===(a=e.pinnedResults)||void 0===a?void 0:a.aggregationResults)??{}},hasMore:e.hasMore}}var s;return o?(null===(s=e.subGroupResults)||void 0===s||s.forEach((e=>{e.visible?n.push({property:o.property,value:e.value}):i.push({property:o.property,value:e.value,hidden:!0})})),{version:"v2",currentGroups:[...n,...i],visibleGroups:n,hiddenGroups:i,pinnedGroups:{groups:[],aggregations:{}},hasMore:Boolean(e.hasMoreSubGroups)}):{version:"v2",currentGroups:[],visibleGroups:[],hiddenGroups:[],pinnedGroups:{groups:[],aggregations:{}},hasMore:!1}}),[e,t,o],{useDeepEqual:!0})}},424599:(e,t,o)=>{o.d(t,{M:()=>u});o(581454);var n=()=>o(594013),r=()=>o(901610),i=()=>o(384944),l=()=>o(231297),a=()=>o(177618),s=()=>o(493260),c=()=>o(147503);async function u(e){var t;const{environment:o,collectionStore:u,collectionContextStore:d,collectionSettingsStore:p,shouldSkipViewSelection:g}=e,m=d.collectionViewBlockStore(),y=d.collectionViewStore(),v=u.getParentBlockStore();if(!m||!v||!y)return;const f=null===(t=u.getModel())||void 0===t?void 0:t.getNormalizedSchema();if(!d.getIsInDashboardBuildMode()&&"chart"===y.getType()&&f){const e=y.getFormat(),t=e.chart_config;if(!t)return;const a="placeholder"===t.type?t.placeHolderType:t.type;let s;return(0,r().I)(a)?s=(0,n().EZ)({collectionSchema:f,axisChartType:a}):"donut"===a&&(s=(0,n().ZS)({collectionSchema:f})),l().createAndCommit({userAction:"slashMenu.create.chartViewExistingSource",environment:o,canUndo:!0,perform:t=>{i().zv({store:y.getFormatStore(),transaction:t,data:{...e,hide_linked_collection_name:!0,subitem_display_mode:"flattened",chart_config:s||null}})}}),void p.setState({open:!0,stack:[{type:"main"}]})}if(g)c().a2({collectionSettingsStore:p,item:{type:"main"}});else{await Promise.all([...v.getCollectionViewStores().map((e=>e.load())),...m.getCollectionViewStores().map((e=>e.load()))]);(0,a().Mf)({collectionStore:u,sourceCollectionViewBlockStore:v,currentCollectionViewBlockStore:m,currentCollectionViewStore:y,constraints:(0,s().v)(y.id)}).length>0?c().a2({collectionSettingsStore:p,item:{type:"duplicateExistingView"}}):c().a2({collectionSettingsStore:p,item:{type:"createView",analytics:void 0}})}}},430102:(e,t,o)=>{o.d(t,{I:()=>p});var n=o(296540),r=()=>o(401497),i=()=>o(718827),l=()=>o(606712),a=()=>o(150161),s=()=>o(854705),c=()=>o(100622),u=()=>o(859428),d=o(474848);const p=n.memo(n.forwardRef((function(e,t){const{style:o,color:n,title:i,onClick:l,onDropdownClick:s,mainButtonTooltip:c,dropdownTooltip:u,iconLeading:p,iconStyle:y,mainButtonStyle:v,isLoading:f,className:h,disabled:S,disableDropdown:x,size:b,variant:C="solid"}=e,k=(0,r().IS)((e=>{const t=(0,a().qq)({size:b,isButtonGapEnabled:!1});return{wrap:{position:"relative",display:"inline-flex",flexShrink:0,borderRadius:6,overflow:"hidden",height:t.height,...o},border:{position:"absolute",pointerEvents:"none",border:"outline"===C?`1px solid ${e.outlineButtonBorder}`:void 0,borderRadius:t.borderRadius,top:0,insetInlineStart:0,insetInlineEnd:0,bottom:0}}}),[b,C,o]);return(0,d.jsxs)("div",{style:k.wrap,className:h,children:[(0,d.jsx)(g,{ref:t,color:n,disabled:S,iconLeading:p,iconStyle:y,isLoading:f,mainButtonStyle:v,mainButtonTooltip:c,onClick:l,title:i,variant:C}),(0,d.jsx)(m,{ref:t,color:n,disabled:x,dropdownTooltip:u,isLoading:f,onDropdownClick:s,variant:C}),(0,d.jsx)("div",{style:k.border})]})}))),g=n.memo(n.forwardRef((function(e,t){const{mainButtonTooltip:n,onClick:l,disabled:s,isLoading:p,iconLeading:g,title:m,color:f,variant:h,mainButtonStyle:S,iconStyle:x,size:b}=e,C=(0,r().IS)((e=>{const t=(0,a().qq)({size:b,isButtonGapEnabled:!1}),n=v({color:f,variant:h,theme:e});return{mainButton:{display:"flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",borderStartStartRadius:6,borderEndStartRadius:6,paddingInlineStart:t.paddingInlineStart,paddingInlineEnd:t.paddingInlineEnd,fontSize:t.fontSize,fontWeight:o(284371).Wy.medium,...n.default,...S},icon:{width:12,marginInlineEnd:6,fill:y(f,h,{outline:n.default.color,solid:{blue:c().Tj.white,black:c().Tj.white,orange:e.palette.orange[400]}}),...x},buttonHoveredStyle:n.hovered,buttonPressedStyle:n.pressed}}),[f,x,S,b,h]);return n?(0,d.jsx)(u().A,{renderTooltip:()=>n,render:e=>(0,d.jsxs)(i().Ay,{ref:t,style:C.mainButton,onClick:l,disabled:s,disabledFeedback:!0,hoveredStyle:C.buttonHoveredStyle,pressedStyle:C.buttonPressedStyle,...e,children:[g?g(C.icon):null,m]})}):(0,d.jsxs)(i().Ay,{ref:t,style:C.mainButton,onClick:l,disabled:s||p,disabledFeedback:!0,hoveredStyle:C.buttonHoveredStyle,pressedStyle:C.buttonPressedStyle,children:[p?(0,d.jsx)(o(98126).A,{style:{marginInlineEnd:4}}):null,g?g(C.icon):null,m]})}))),m=n.memo(n.forwardRef((function(e,t){const{disableDropdown:l,disabled:p,dropdownTooltip:g,onDropdownClick:m,isLoading:f,size:h,color:S,variant:x}=e,{isMobile:b}=(0,o(484714).Y0)(),C=(0,r().IS)((e=>{const t=(0,a().qq)({size:h,isButtonGapEnabled:!1}),n=v({color:S,variant:x,theme:e});return{dropdownButton:{display:"flex",alignItems:"center",justifyContent:"center",width:b?28:24,alignSelf:"stretch",borderStartEndRadius:t.borderRadius,borderEndEndRadius:t.borderRadius,boxShadow:"outline"===x||"blue"===S||"black"===S?`inset 1px 0 0 ${e.darkDividerColor}`:"orange"===S?`${e.palette.orange["dark"===e.mode?200:100]} 1px 0 0 inset`:(0,o(534177).HB)(S),...n.default},dropdownButtonIcon:{width:o(340498).Ev.sm,marginTop:2,fill:y(S,x,{outline:n.default.color,solid:{blue:c().Tj.white,black:c().Tj.white,orange:e.palette.orange["dark"===e.mode?500:400]}})},buttonHoveredStyle:n.hovered,buttonPressedStyle:n.pressed}}),[S,b,h,x]),k=(0,n.useCallback)((e=>(0,d.jsx)(i().Ay,{ref:t,style:C.dropdownButton,onClick:m,disabledFeedback:!0,hoveredStyle:C.buttonHoveredStyle,pressedStyle:C.buttonPressedStyle,...e,children:(0,s().arrowChevronSingleDownFillSmallIcon)(C.dropdownButtonIcon)})),[m,t,C.buttonHoveredStyle,C.buttonPressedStyle,C.dropdownButton,C.dropdownButtonIcon]),A=(0,n.useCallback)((()=>g),[g]);return l||p?null:g?(0,d.jsx)(u().A,{renderTooltip:A,render:k}):(0,d.jsx)(i().Ay,{ref:t,style:C.dropdownButton,onClick:m,disabledFeedback:!0,hoveredStyle:C.buttonHoveredStyle,pressedStyle:C.buttonPressedStyle,disabled:f,children:(0,s().arrowChevronSingleDownFillSmallIcon)(C.dropdownButtonIcon)})})));function y(e,t,o){return"object"!=typeof o[t]?o[t]:o[t][e]}function v(e){const{color:t,variant:o,theme:n}=e;return{default:{background:y(t,o,{outline:void 0,solid:{blue:n.blue.background.accentPrimary,black:n.background.accentPrimary,orange:n.orange.background.secondaryTranslucent}}),color:y(t,o,{outline:{blue:n.blue.text.accentPrimary,black:n.text.primary,orange:n.orange.text.accentPrimary},solid:{blue:n.blue.text.inversePrimary,black:n.text.inversePrimary,orange:n.orange.text.accentPrimary}})},hovered:{background:y(t,o,{outline:{blue:n.blue.background.secondaryTranslucent,black:n.gray.background.secondaryTranslucent,orange:n.orange.background.secondaryTranslucent},solid:{blue:(0,l().R)({color:n.blue.background.accentPrimary,mode:n.mode}),black:(0,l().R)({color:n.background.accentPrimary,mode:"dark"}),orange:(0,l().R)({color:n.orange.background.secondaryTranslucent,mode:n.mode})}})},pressed:{background:y(t,o,{outline:{blue:(0,l().y)({color:n.blue.background.secondaryTranslucent,mode:n.mode}),black:(0,l().y)({color:n.gray.background.secondaryTranslucent,mode:n.mode}),orange:(0,l().y)({color:n.orange.background.secondaryTranslucent,mode:n.mode})},solid:{blue:(0,l().y)({color:n.blue.background.accentPrimary,mode:n.mode}),black:(0,l().y)({color:n.background.accentPrimary,mode:"dark"}),orange:(0,l().y)({color:n.orange.background.secondaryTranslucent,mode:n.mode})}})}}}},534239:(e,t,o)=>{o.d(t,{Zr:()=>m,e8:()=>v});o(296540);var n=()=>o(484714),r=()=>o(56366),i=()=>o(401497),l=()=>o(252291),a=()=>o(98126),s=()=>o(898244),c=()=>o(617871),u=()=>o(187174),d=()=>o(532940),p=()=>o(543665),g=o(474848);function m({propertyId:e,propertySchema:t,collectionContextStore:o}){return"relation"!==t.type&&"rollup"!==t.type?null:(0,g.jsx)(y,{collectionContextStore:o,propertyId:e,propertySchema:t})}function y(e){const{propertySchema:t}=e,o=(0,r().K8)((()=>{if(t&&(0,s().UU)(t)&&t.connectedRelation.integration_id===c().mn)return t.collection_pointer}),[t]),{format:n,loading:u}=v(o,{debugName:"ConnectedRelationSyncStateBadge"}),p=(0,r().K8)((()=>{var e;return n?{hasError:Boolean(n.error),isSyncing:Boolean(null===(e=n.sync_state)||void 0===e?void 0:e.syncing)}:null}),[n]),m=(0,i().IS)((e=>({container:{marginInlineStart:6,fontSize:11,padding:"1px 4px",borderRadius:4,display:"inline-flex",flexDirection:"row",alignItems:"center",gap:4,marginTop:1,color:"light"===e.mode?e.palette.blue[500]:e.palette.blue[600]},icon:{padding:2}})),[]);return p?p.isSyncing?(0,g.jsx)("span",{style:m.container,children:(0,g.jsx)(a().A,{size:"md"})}):p.hasError?(0,g.jsx)("span",{style:m.container,children:(0,g.jsx)(l().I,{icon:d().exclamationMarkTriangleIcon,colorPalette:"yellow",colorVariant:"accentPrimary",style:m.icon})}):null:null}function v(e,t={}){const o=(0,n().v3)(),[{status:i,value:l,error:a}]=(0,u().Yb)((async()=>{if(!e)return null;const t=new(p().m)(o,e);return await t.load(),t}),[o,e],{debugName:t.debugName||"useExternalCollectionFormat"});return{format:(0,r().K8)((()=>(null==l?void 0:l.getFormat())??null),[l]),loading:"pending"===i,error:a}}},604656:(e,t,o)=>{o.d(t,{m:()=>a});o(898992),o(354520),o(581454);var n=()=>o(62371),r=()=>o(436696),i=()=>o(231297),l=()=>o(800002);function a(e){var t;const{environment:o,collectionContextStore:a,currentGroups:s,groupsFormatKey:c,groupFormat:u,action:d}=e,p="toggle_group_pin"===d&&"board_columns"!==c,g=(null===(t=a.collectionViewStore())||void 0===t?void 0:t.getFormatStore().getKeyStore(c).getValue())??[],m=new Map;for(const r of g)m.set((0,n().Ix)(r),r);const y=new Map;for(const r of s)y.set((0,n().Ix)(r),r);const v=s.filter((e=>!m.has((0,n().Ix)(e)))),f=v.length>0?[...g,...v]:g;if(!a.permissionScopesStore.state.canConfigureBlock||p)return f;const h=m.get((0,n().Ix)(u))??y.get((0,n().Ix)(u))??(0,n().QF)(u.property,u.value),S=f.map((e=>(0,n().Mn)(e,h)?"toggle_group_pin"===d?{...h,pinned:!h.pinned||void 0}:"toggle_group_visibility"===d?{...h,hidden:!h.hidden}:h:e));return i().createAndCommit({userAction:"CollectionSettingsViewGroup.handleToggleGroupFormat",environment:o,canUndo:!0,perform:e=>{(0,l().o)({collectionContextStore:a,newGroups:S,groupsFormatKey:c,transaction:e})}}),(0,r().X)({environment:o,collectionContextStore:a,action:"toggle_group_pin"}),S}},610101:(e,t,o)=>{o.d(t,{A:()=>r});class n extends(()=>o(757695))().Store{getInitialState(){return!1}}const r=new n},611520:(e,t,o)=>{o.d(t,{G2:()=>i,uo:()=>a});var n=()=>o(645873);const r={CollectionSettingsConnectedRelationUpsell:new(n().O2)("CollectionSettingsConnectedRelationUpsell",(async()=>await o.e(73090).then(o.bind(o,474434))))},i=(0,n()._h)(r.CollectionSettingsConnectedRelationUpsell,(e=>e.CollectionSettingsConnectedRelationUpsell)),l={CollectionSettingsConnectedRelationUpsellMaybe:new(n().O2)("CollectionSettingsConnectedRelationUpsellMaybe",(async()=>await o.e(73090).then(o.bind(o,474434))))},a=(0,n()._h)(l.CollectionSettingsConnectedRelationUpsellMaybe,(e=>e.CollectionSettingsConnectedRelationUpsellMaybe))},680341:(e,t,o)=>{o.d(t,{v:()=>A});o(944114),o(898992),o(803949),o(581454),o(296540);var n=()=>o(726637),r=()=>o(484714),i=()=>o(30537),l=()=>o(356246),a=()=>o(67657),s=()=>o(568063),c=()=>o(69708),u=()=>o(496603),d=()=>o(760217),p=()=>o(404277),g=()=>o(939740),m=()=>o(89924),y=()=>o(859428),v=()=>o(662971),f=()=>o(478184),h=()=>o(722372),S=()=>o(722872),x=()=>o(553965),b=()=>o(142680),C=o(474848);const k=(0,c().YK)({noneText:{defaultMessage:"None",id:"database.propertyAggregationMenu.noneText"},systemShowValuesText:{defaultMessage:"Show values",id:"database.rollupProperty.aggregate.showValues"},tableAggregationTooltip:{defaultMessage:"Table aggregation",id:"database.propertyAggregationMenu.tableAggregationTooltip"}});function A({onClose:e,property:t,schema:o,currentAggregation:u,source:y,noneText:f,onChange:x}){const b=(0,r().v3)(),A=(0,c().tz)();let w;w=n().A.isMobile?{menuType:S().gu.Modal,title:A.formatMessage(k.tableAggregationTooltip),onClickRight:e}:{menuType:S().gu.Popup,width:200};const[M,B]=function({property:e,schema:t,source:o,intl:r,onChange:c,environment:u,currentAggregation:y,noneText:f}){const x=[];let b=0,A=0;const w=n().A.isMobile,M=null==y?void 0:y.aggregator,B=({aggregationType:e,enforceMaxAggregationLimit:t})=>c({aggregationType:e,enforceMaxAggregationLimit:t});if((0,s().cl)(e)){const e=[];e.push({key:"none",render:e=>(0,C.jsx)(d().A,{...e,isChecked:!y,title:r.formatMessage(k.systemShowValuesText)}),action:()=>c({aggregationType:void 0})}),e.push(j("count"===M,"count",B,!0));return[e,"count"===M?1:0]}const V=function({property:e,schema:t,currentAggregationType:o,onChangeWithLimit:n,environment:r,currentAggregation:i}){const s={},c=t[e];if(!c)return{};for(const l of a().VD)s[l]=j(l===o,l,n);if((0,a().wG)(c))for(const l of a().CG)s[l]=j(l===o,l,n);if((0,a().OC)(c))for(const l of a().Sn)s[l]=j(l===o,l,n);if((0,a().fo)(c))for(const l of a().zE)s[l]=j(l===o,l,n);if((0,a().s_)(c))for(const a of l().QO)s[a]=j(a===o,a,n);if((0,a().q0)(c))for(const l of a().nJ)s[l]=I(e,l,i,t,n);if((0,a().pe)(c))for(const l of a().A3)s[l]=j(l===o,l,n);return s}({property:e,schema:t,currentAggregationType:M,onChangeWithLimit:B,environment:u,currentAggregation:y});x.push({key:"none",render:e=>(0,C.jsx)(d().A,{...e,isChecked:!y,title:f||r.formatMessage(k.noneText)}),action:()=>c({aggregationType:void 0})});let P="tableAggregation"===o?1:2;return Object.entries(a().Kn).forEach((([e,t])=>{const n=[];for(const i of t)if(V[i]){if("show_unique"===i)switch(o){case"tableAggregation":continue;case"rollupPropertyMenu":x.splice(1,0,V[i]),(null==y?void 0:y.aggregator)===i&&(b=1);continue}n.push(V[i]),(y&&(0,a().ET)(null==y?void 0:y.aggregator)&&y.aggregator.operator===i||(null==y?void 0:y.aggregator)===i)&&(b=P,A=n.length-1)}const r=[];if("count_aggregations"===e&&"tableAggregation"===o&&r.push({key:"limitToggleSection",render:e=>(0,C.jsx)(m().A,{...e}),items:[T(y,B)]}),r.push({key:"aggregations",render:e=>(0,C.jsx)(m().A,{topBorder:!0,...e}),items:n}),n.length>0){P++;const t=h().jA[e],o={key:t,render:(e,o)=>(0,C.jsx)(v().A,{...e,onFocus:o.onFocus,popupTypeOverride:w?i().n.BottomSheet:void 0,bottomSheetInitialState:"half",disableDefaultClick:!0,renderOrigin:(e,o)=>(0,C.jsx)(d().A,{...e,ref:o,title:t}),renderExtension:(e,n)=>{let i;return i=w?{menuType:S().gu.Modal,title:t,onClickRight:n.close,...e}:{menuType:S().gu.Popup,width:250,...e},(0,C.jsx)(p().A,{...i,children:(0,C.jsx)(g().Ay,{type:g().Oh.Vertical,initialFocus:A,sections:r,onAccept:(e,t,r)=>{"aggregationLimitToggle"!==e.key&&(n.close(),o.onAccept&&o.onAccept(e,t,r))}})})}}),action:()=>null};x.push(o)}})),[x,b]}({property:t,schema:o,source:y,intl:A,onChange:x,environment:b,currentAggregation:u,noneText:f});return(0,C.jsx)(p().A,{...w,children:(0,C.jsx)(g().Ay,{type:g().Oh.Vertical,initialFocus:B??0,sections:[{key:0,render:e=>(0,C.jsx)(m().A,{...e}),items:M}],onAccept:e})})}function w({isSelected:e,aggregationType:t,label:o,props:n}){const r=h().cx[t];return(0,C.jsx)(y().A,{placement:"right",delayThreshold:0,render:t=>(0,C.jsx)(d().A,{title:o,isChecked:e,...(0,x().A)(t,n)}),renderTooltip:()=>(0,C.jsxs)("div",{style:{width:140,whiteSpace:"normal"},children:[r?(0,C.jsx)("img",{src:(0,f().L)(r),style:{borderRadius:4,width:140,marginTop:4}}):void 0,h().fp[t]]})},n.key)}function j(e,t,o,n){const r=h().zY[t],i=h().cx[t];return{key:r,render:o=>(0,C.jsx)(y().A,{placement:"right",delayThreshold:0,render:t=>(0,C.jsx)(d().A,{title:r,isChecked:e,...(0,x().A)(t,o)}),disableTooltip:n,renderTooltip:e=>(0,C.jsxs)("div",{...e,style:{width:140,whiteSpace:"normal"},children:[i?(0,C.jsx)("img",{src:(0,f().L)(i),style:{borderRadius:4,width:140,marginTop:4}}):void 0,h().fp[t]]})},o.key),action:()=>{o({aggregationType:t})}}}function I(e,t,o,r,l){const s=n().A.isMobile,c=h().zY[t],y=u().oE(function(e,t,o,n,r){const i=n[t];if(!i||"status"!==i.type)return;const l=i.groups;return l?l.map((t=>{const n=(e&&(0,a().ET)(e.aggregator)&&e.aggregator.operator===o&&e.aggregator.groupName===t.name)??!1;return{key:`${o}${t.name}`,render:e=>(0,C.jsx)(w,{isSelected:n,aggregationType:o,label:t.name,props:e}),action:()=>{r({aggregationType:{operator:o,groupName:t.name}})}}})):void 0}(o,e,t,r,l));let f=0;if(o&&(0,a().ET)(null==o?void 0:o.aggregator)&&o.aggregator.operator===t){const e=o.aggregator.groupName,n=y.findIndex((o=>o.key===`${t}${e}`));-1!==n&&(f=n)}return{key:t,render:(e,t)=>(0,C.jsx)(v().A,{...e,onFocus:t.onFocus,popupTypeOverride:s?i().n.BottomSheet:void 0,bottomSheetInitialState:"half",renderOrigin:e=>(0,C.jsx)(d().A,{...e,title:c}),renderExtension:(e,o)=>{let n;return n=s?{menuType:S().gu.Modal,title:c,onClickRight:o.close,...e}:{menuType:S().gu.Popup,width:200,...e},(0,C.jsx)(p().A,{...n,children:(0,C.jsx)(g().Ay,{type:g().Oh.Vertical,initialFocus:f,sections:[{key:"groups",render:e=>(0,C.jsx)(m().A,{...e}),items:y}],onAccept:t.onAccept})})}}),action:()=>null}}function T(e,t){const{enforceMaxAggregationLimit:o,disabled:n}=e?(0,h().NT)(e):{enforceMaxAggregationLimit:!1,disabled:!1};return{key:"aggregationLimitToggle",render:e=>(0,C.jsx)(b().A,{on:o,disabled:n,menuListItemProps:e}),action:()=>{t(e?{aggregationType:e.aggregator,enforceMaxAggregationLimit:!o}:{aggregationType:"count",enforceMaxAggregationLimit:!0})}}}},701311:(e,t,o)=>{o.d(t,{Q:()=>p,d:()=>g});o(898992),o(354520);var n=()=>o(564884),r=()=>o(636081),i=()=>o(214388),l=()=>o(62371),a=()=>o(416504),s=()=>o(274375),c=()=>o(681445),u=()=>o(476492),d=()=>o(765957);function p(e){return`${l().RO}_${e}`}function g(e){var t,o,l;const{collectionContextStore:p,environment:g,groupFormat:m,groupBy:y,temporaryViewState:v,title:f}=e,h=p.collectionViewBlockStore();if(!h)return;const S=p.normalizedSchemaStore.state,x=p.normalizedFormatStore.state,b=p.normalizedQueryStore.state,C=(null===(t=d().default.state.currentUserSettingsStore)||void 0===t?void 0:t.getSettingsStore().getKeyStore("time_zone").getValue())||(0,a().P)(),k=(0,r().K8)({schema:S,groupBy:y,group:m,propertyMapping:void 0,timeZone:C});if(!k)return;const A=y.property,w=(0,s().Q)(h,A),j=(null===(o=v.combinatorFilter)||void 0===o?void 0:o.value)??(null==b?void 0:b.filter),I={type:"table",parent_id:h.pointer.id,parent_table:h.pointer.table,alive:!0,space_id:h.getSpaceId(),format:{is_unlisted:!0,collection_pointer:x.collection_pointer,table_properties:w,property_filters:(null==v||null===(l=v.propertyFilters)||void 0===l?void 0:l.value)??(null==x?void 0:x.property_filters)},query2:{...b,filter:j?(0,i().GV)([j,k]):(0,i().GV)([k])}},T=(0,u().sl)(p);(0,n().u)({environment:g,event:{eventName:"collection_chart_drilldown_click",eventProperties:{...T,drilldown_type:"grouped",from:"board_pinned_group"}}}),c().S.openCollectionDrilldownView({collectionViewValue:I,collectionViewBlockStore:h,viewsModuleContext:p.viewsModuleContextStore.state,title:f})}},760077:(e,t,o)=>{o.d(t,{U:()=>l});var n=()=>o(384944),r=()=>o(231297),i=()=>o(407031);function l(e){const{viewToDuplicateStore:t,collectionContextStore:o,collectionViewStore:l,environment:a,temporaryStore:s}=e,c=o.collectionStore(),u=t.getType();if(!u||!c)return;const d=t.getName(),p=t.getPageSort(),g=t.getFormat(),m=t.getKeyStore("query2").getValue();r().createAndCommit({userAction:"CollectionSettingsDuplicateExistingView.duplicateViewSettings",environment:a,canUndo:!0,perform:e=>{n().zv({store:s??l,data:{name:d,type:u,page_sort:p,format:{...g,collection_pointer:c.pointer},query2:m},transaction:e})}}),(0,i().S)({collectionContextStore:o})}},776547:(e,t,o)=>{o.d(t,{m:()=>u});var n=o(296540),r=()=>o(484714),i=()=>o(56366),l=()=>o(885173),a=()=>o(147503),s=()=>o(908201),c=o(474848);const u=n.memo((function(e){const{store:t,popupType:l,dismissTooltip:a,renderOrigin:u,placementToOrigin:p}=e,g=(0,r().v3)(),m=(0,s().ET)(),y=(0,i().uB)(void 0,o(463830).A),v=(0,n.useCallback)((()=>{(0,o(436696).X)({environment:g,collectionContextStore:m,action:"click_topbar_templates_dropdown"}),a&&a()}),[m,g,a]);return(0,c.jsx)(o(406699).A,{popupType:l,bottomSheetInitialState:"half",placementToOrigin:p,alignmentToOrigin:"start",render:()=>(0,c.jsx)(d,{store:t,templateButtonPopupStore:y}),originGap:4,onClick:v,renderOrigin:u,buttonPopupStore:y})}));function d(e){const{store:t,templateButtonPopupStore:u}=e,d=(0,r().v3)(),p=(0,s().ET)(),g=(0,i().K8)((()=>p.collectionStore()),[p]),m=(0,i().K8)((()=>p.settingsStore),[p]),y=(0,i().O$)(o(929219).e),v=(0,i().K8)((()=>p.permissionScopesStore.state.canConfigureCollection),[p.permissionScopesStore]),f=(0,i().K8)((()=>t.isNonEditableState()),[t]),h=(0,o(401497).IS)((e=>({offlineMessage:{fontSize:14,color:e.text.secondary,width:280,padding:8}})),[]),S=(0,n.useCallback)((e=>{(0,l().U)({userAction:"CollectionViewBlock.handleTemplateEmptyPageClick",collectionViewBlockStore:t,collectionContextStore:p,environment:d,shouldCoerce:!1,from:{createBlock:"cvb_template_empty_page"},templateStore:void 0,useCrdt:!0}),u.reset(),a().os({collectionSettingsStore:m})}),[p,d,t,u,m]),x=(0,n.useCallback)((e=>{(0,l().U)({environment:d,collectionContextStore:p,collectionViewBlockStore:t,templateStore:e.templateStore,useCrdt:e.useCrdt,isKeyboard:e.isKeyboard,from:{createBlock:"cvb_template",initCollection:"collection_view_block"},shouldCoerce:!0}),u.reset(),a().os({collectionSettingsStore:m})}),[d,p,t,u,m]),b=(0,n.useCallback)((()=>{u.reset()}),[u]);return g?y?(0,c.jsx)(o(975318).D,{isOverlay:!0,collectionStore:g,canConfigureCollection:v,onEmptyPageClick:S,onEmptyEnter:S,onTemplateClick:x,onCancelClick:b,locked:f}):(0,c.jsx)("div",{style:h.offlineMessage,children:(0,c.jsx)(o(69708).sA,{defaultMessage:"Please go online to use a template.",id:"collectionViewBlock.actionBar.offlineTemplatePicker.message"})}):null}},800002:(e,t,o)=>{o.d(t,{o:()=>r});var n=()=>o(896628);function r(e){const{collectionContextStore:t,newGroups:o,groupsFormatKey:r,transaction:i}=e,l=t.collectionViewStore();l&&n().zA({stores:[l],update:{[r]:o},transaction:i})}},864403:(e,t,o)=>{o.d(t,{r:()=>c});o(898992),o(672577),o(581454);var n=()=>o(62371),r=()=>o(496603),i=()=>o(436696),l=()=>o(231297),a=()=>o(278094),s=()=>o(800002);function c(e){var t;const{environment:o,collectionContextStore:c,groupByKey:u,groupsFormatKey:d,currentGroups:p,newGroupIds:g,containsAllGroups:m}=e;let y=(null===(t=c.collectionViewStore())||void 0===t?void 0:t.getFormatStore().getKeyStore(d).getValue())??[];y=y.map((e=>{const t={...e};return delete t.emptyHidden,t}));let v=p||y;m||(v=0===y.length?p:y);let f=r().Ul(v,(e=>{const t=g.indexOf((0,n().Ix)(e));return t>=0?t:1/0}));f=f.map((e=>y.find((t=>(0,n().Mn)(e,t)))??e));const[h,S]=r().jB(f,(e=>!e.hidden)),x=[...h,...S];l().createAndCommit({userAction:`collectionGroupActions.handleGroupReorder#${d}`,environment:o,canUndo:!0,perform:e=>{(0,a().y)({sortType:"manual",environment:o,collectionContextStore:c,groupByKey:u,groupsFormatKey:d,transaction:e}),(0,s().o)({collectionContextStore:c,newGroups:x,groupsFormatKey:d,transaction:e})}});let b="reorder_groups";"board_columns"===d?b="board_reorder_groups":"chart_subgroups"===d&&(b="chart_reorder_groups"),(0,i().X)({environment:o,collectionContextStore:c,action:b})}},873864:(e,t,o)=>{o.d(t,{v:()=>m});var n=()=>o(908006),r=()=>o(386164),i=()=>o(388821),l=()=>o(559506),a=()=>o(885110),s=()=>o(666144),c=()=>o(231297),u=()=>o(467676),d=()=>o(180762),p=()=>o(855801),g=()=>o(447453);async function m(e){const{environment:t,collectionContextStore:o,collectionViewStore:m,collectionSettingsStore:y,intl:v,from:f}=e,h=o.isFullScreenStore.state,S=o.isRootChildStore.state,x=o.isInPeekRendererStore.state,b=o.collectionViewBlockStore(),C="form_editor"===m.getType();let k,A;if(C){var w;const e=null===(w=m.getFormat().form_block_pointer)||void 0===w?void 0:w.id;if(!e)return;const[o,n]=await Promise.all([p().VI.loadLocalSubtree.load(),p().VI.localDuplicate.load()]);if(k=o,A=n,!k||!A)return;if(!k.loadLocalSubtree({environment:t,blockId:e,inMemoryRecordCache:m.inMemoryRecordCache,options:{allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!1,allowCopyExternalObjectInstances:!1}}).recordMap){const o=await l().callApi({eventName:"loadBlockSubtree",environment:t,data:{block:{id:e,spaceId:m.getSpaceId()},shallow:!1},headers:(0,r().WS)({spaceId:m.getSpaceId()})});if("success"===o.type){const e=i().RecordMapWithRole.create(o.data.subtreeRecordMap);await s()._O({environment:t,inMemoryRecordCache:m.inMemoryRecordCache,recordMap:e,debugSource:"load_form_for_duplication"})}}}const{performResult:j}=c().createAndCommit({userAction:"collectionSettingsActions.newView",environment:t,canUndo:!0,perform:e=>{if(C){if(!k||!A)return;return(0,u().F)({environment:t,collectionViewBlockStore:b,collectionViewStore:m,intl:v,transaction:e,loadLocalSubtreeModule:k,localDuplicateModule:A})}return(0,u().t)({environment:t,collectionViewBlockStore:b,collectionViewStore:m,intl:v,transaction:e})}});j&&("chart"===j.getType()&&a().Z({environment:t,collectionContextStore:o,collectionViewId:j.id,from:f}),(0,d().t)({environment:t,collectionContextStore:o,collectionViewId:j.id,isFullScreen:h,isRootChild:S,isInPeekRenderer:x}),n().default.afterNextFlush((()=>{(0,g().O)({collectionContextStore:o,collectionSettingsStore:y,selectViewNameInitial:!0})})))}},885173:(e,t,o)=>{o.d(t,{U:()=>l});var n=()=>o(491848),r=()=>o(248662),i=()=>o(231297);function l({environment:e,collectionContextStore:t,collectionViewBlockStore:o,templateStore:l,useCrdt:a,isKeyboard:s,from:c,shouldCoerce:u,showMoveTo:d,peekModeOverride:p,userAction:g}){i().createAndCommit({userAction:"collectionTemplatePickerActions.updatePreferredDatabase",environment:e,canUndo:!0,perform:e=>{(0,n().w)({collectionContextStore:t,transaction:e})}}),i().createAndCommit({userAction:g??"collectionTemplatePickerActions.createPageFromCollectionTemplate",environment:e,canUndo:!0,perform:n=>{(0,r().T)({transaction:n,store:o,collectionContextStore:t,environment:e,shouldCoerce:u,templateStore:l,from:c,isKeyboard:s,showMoveTo:d,peekModeOverride:p})}})}},893952:(e,t,o)=>{o.d(t,{A:()=>a});o(296540);var n=()=>o(726637),r=()=>o(401497),i=()=>o(100622),l=o(474848);const a=function(e){const{color:t}=e;return(0,l.jsx)(o(760217).A,{...e,icon:(0,l.jsx)(s,{color:t}),title:(0,o(27178).mN)(t)})};function s({color:e}){const t=(0,r().IS)((t=>{const o=(0,i().LD)(t,e),r="default"===e?t.border.primaryTranslucent:t[e].border.primaryTranslucent;return{tile:{width:n().A.isMobile?24:18,height:n().A.isMobile?24:18,background:o.backgroundColor,color:o.textColor,boxShadow:`inset 0 0 0 1px ${r}`,borderRadius:4}}}),[e]);return(0,l.jsx)("div",{style:t.tile})}},937199:(e,t,o)=>{o.d(t,{LH:()=>i,Op:()=>r,bi:()=>s,sf:()=>a,v$:()=>l});o(16280);var n=o(296540);const r=(0,n.createContext)(null);function i(){const e=(0,n.useContext)(r);if(!e)throw new Error("usePageLayoutEditorContext must be used inside BaseLayoutEditorContext.Provider");return e}function l(){return(0,n.useContext)(r)}r.displayName="BaseLayoutEditorContext";const a=(0,n.createContext)(null);function s(){const e=(0,n.useContext)(a);if(!e)throw new Error("usePageLayoutEditorContext must be used inside PageLayoutEditorContextProvider");return e}a.displayName="PageLayoutEditorContext"},956675:(e,t,o)=>{o.d(t,{p:()=>i});var n=()=>o(62371),r=()=>o(452706);function i(e){const{groupBy:t,schema:o,format:i,groupsFormatKey:a,limit:s,subGroupArgs:c}=e,u=o[t.property];if(!u||!(0,n().Eg)(u))return;const d=i[a]||[],p=(0,n().w9)(t,i),g=c&&i[c.groupsFormatKey]||[];return{type:"groups",version:"v2",returnHiddenGroups:e.returnHiddenGroups,returnPinnedGroups:e.returnPinnedGroups,groupBy:p,groupSortPreference:d,limit:Math.min(s,r().O3),subGroup:c?{groupBy:c.groupBy,groupSortPreference:g,limit:c.limit}:void 0,aggregation:l({groupAggregation:e.aggregation,subGroupAggregation:null==c?void 0:c.subGroupAggregation}),blockResults:e.blockResults}}function l(e){if(!e.groupAggregation&&!e.subGroupAggregation)return;const t={type:"independent"};return e.groupAggregation&&(t.groupAggregation=e.groupAggregation),e.subGroupAggregation&&(t.subGroupAggregation=e.subGroupAggregation),t}},975318:(e,t,o)=>{o.d(t,{D:()=>A});o(898992),o(823215),o(354520),o(581454);var n=o(296540),r=()=>o(726637),i=()=>o(484714),l=()=>o(56366),a=()=>o(401497),s=()=>o(584262),c=()=>o(69708),u=()=>o(160568),d=()=>o(557281),p=()=>o(231297),g=()=>o(284371),m=o(474848);const y=n.memo((function(e){const{prefix:t,collectionName:o}=e,n=(0,a().IS)((e=>({container:{display:"flex",alignItems:"center",fontWeight:g().Wy.medium,color:e.text.secondary,paddingInlineStart:8,paddingInlineEnd:8},databaseTitle:{...g().RC}})),[]);return(0,m.jsxs)("div",{style:n.container,children:[t,(0,m.jsxs)("span",{style:n.databaseTitle,children:["Â ",o]})]})}));var v=()=>o(492414),f=()=>o(722872);const h=n.memo((function(e){const t=(0,i().v3)(),r=(0,c().tz)(),l=(0,a().IS)((e=>({link:{borderRadius:6,height:24,width:24,display:"flex"},button:{height:24,width:24,fill:e.icon.tertiary},icon:{width:20,height:20}})),[]),s=(0,n.useCallback)((()=>{o(148024).FH(t,{from:e.helpButtonContext})}),[t,e.helpButtonContext]);return(0,m.jsx)(o(97294).N,{href:e.href,external:!0,style:l.link,onClick:s,children:(0,m.jsx)(o(285790).A,{icon:o(406533).questionMarkCircleIcon,style:l.button,iconStyle:l.icon,ariaLabel:r.formatMessage({id:"helpButton.ariaLabel",defaultMessage:"Help"})})})}));var S=()=>o(763996),x=()=>o(419357),b=()=>o(939740),C=()=>o(89924);const k=(0,c().YK)({filterPlaceholder:{id:"collectionPicker.searchBarFilter.text",defaultMessage:"Filterâ€¦"}}),A=n.memo((function(e){const{collectionStore:t,isOverlay:i,onEmptyEnter:s,onEmptyPageClick:u,onCancelClick:d,canConfigureCollection:p,locked:g,onTemplateClick:y}=e,[v,h]=(0,n.useState)(""),S=(0,l().uB)(void 0,o(970585).A),x=(0,l().K8)((()=>t.getTemplatePageStores().filter((e=>e.getAlive()))),[t]),b=(0,l().K8)((()=>x.every((e=>e.isReady()))),[x]),k=(0,l().K8)((()=>i&&null!=v&&v.length?(0,o(778078).Ay)(v,x,(e=>String(e.getProperties().title||""))):x),[x,v,i]),A=(0,a().IS)((e=>({container:{fontSize:14,padding:r().A.isMobile?"12px 16px":"0 12px 4px 12px",color:e.text.tertiary,wordBreak:"keep-all",...r().A.isMobile&&{background:e.background.primary,boxShadow:`0 1px 0 ${e.regularDividerColor}`,marginBottom:1}}})),[]);if(!b)return null;if(i){const e=x.length>6,n=r().A.isMobile?{menuType:f().gu.Modal,title:(0,m.jsx)(c().sA,{defaultMessage:"Database templates",id:"database.mobileTemplatesMenu.title"})}:{menuType:f().gu.Popup,width:360};return(0,m.jsxs)(o(404277).A,{...n,header:(0,m.jsx)(w,{collectionStore:t}),children:[0===x.length?(0,m.jsx)(C().A,{children:(0,m.jsx)("div",{style:A.container,children:(0,m.jsx)(c().sA,{defaultMessage:"Create a reusable page template for this database.",id:"database.emptyTemplatesList.info"})})}):void 0,e?(0,m.jsx)(j,{templateInputValue:v,setTemplateInputValue:h}):null,(0,m.jsx)(I,{collectionStore:t,onEmptyEnter:s,onEmptyPageClick:u,onCancelClick:d,canConfigureCollection:p,isOverlay:i,locked:g,onTemplateClick:y,menuListStore:S,templateInputValue:v,filteredTemplatePageStores:k,draggable:!(e&&v)})]})}return(0,m.jsx)(I,{collectionStore:t,onEmptyEnter:s,onEmptyPageClick:u,onCancelClick:d,canConfigureCollection:p,isOverlay:i,locked:g,onTemplateClick:y,menuListStore:S,templateInputValue:v,filteredTemplatePageStores:k,draggable:!0})})),w=n.memo((function(e){const{collectionStore:t}=e,n=(0,c().tz)(),i=(0,l().K8)((()=>(0,o(697650).getCollectionNameOrDefault)({collectionStore:t,intl:n})),[t,n]),s=(0,a().IS)((()=>({container:{marginTop:6}})),[]);return r().A.isMobile?null:(0,m.jsx)(o(678553).Ay,{style:s.container,title:(0,m.jsx)(y,{prefix:(0,m.jsx)(c().sA,{id:"database.templatesList.templatesFor",defaultMessage:"Templates for"}),collectionName:i}),right:(0,m.jsx)(h,{helpButtonContext:"collection_templates_menu",href:(0,o(232930).x)("guides.databaseTemplates")})})})),j=n.memo((function(e){const{templateInputValue:t,setTemplateInputValue:l}=e,{isAndroid:s}=(0,i().Y0)(),u=(0,c().tz)(),d=(0,n.useCallback)((e=>l(e.currentTarget.value)),[l]),p=(0,a().IS)((()=>({container:{margin:r().A.isMobile?0:"10px 0"},input:{...s&&{borderBottom:"none"}}})),[s]);return(0,m.jsx)("div",{style:p.container,children:(0,m.jsx)(x().Ay,{value:t,focusInitial:!r().A.isMobile||void 0,placeholder:u.formatMessage(k.filterPlaceholder),showClearButton:!0,inputLeft:(0,m.jsx)(x().Zf,{icon:o(344417).u}),onChange:d,style:p.input})})})),I=n.memo((function(e){const{filteredTemplatePageStores:t,draggable:a,collectionStore:c,onEmptyEnter:g,onEmptyPageClick:y,onCancelClick:f,canConfigureCollection:h,isOverlay:x,locked:k,onTemplateClick:A,menuListStore:w,templateInputValue:j}=e,I=(0,i().v3)(),M=(0,n.useContext)(o(908201).p2),B=(0,n.useContext)(o(110525).n),V=(0,l().K8)((()=>(0,o(50764).E)(I)),[I]),P=(0,n.useCallback)((e=>{w.unsetFocus(),p().createAndCommit({userAction:"CollectionTemplatePicker.handleCollectionTemplatesReorder",environment:I,canUndo:!0,perform:t=>d().lU({collectionStore:c,newTemplateIds:e,transaction:t})})}),[I,c,w]),_=(0,n.useCallback)((()=>{var e;V&&(g(),u().ki(I,{template_type:"empty_page",from:"collections_template_picker",is_keyboard:!0,collection_id:c.id,collection_view_id:null==M||null===(e=M.collectionViewStore())||void 0===e?void 0:e.id}))}),[I,c,g,M,V]),G=(0,n.useCallback)((e=>{V&&(y(e.event),u().ki(I,{template_type:"empty_page",from:"collections_template_picker",is_keyboard:"keydown"===e.event.type,...M&&(0,o(476492).sl)(M)}))}),[V,M,I,y]),F=(0,n.useCallback)((()=>{var e;if(!V)return;const{performResult:t}=p().createAndCommit({userAction:"CollectionTemplatePicker.newPage",environment:I,canUndo:!0,perform:e=>d().bI({environment:I,collectionStore:c,transaction:e,title:j})});if(t){const{mainEditorCurrentBlockStore:e}=o(765957).default.state,n=e?(0,v().Ay)({store:e,peekViewBlockId:t.id,fullyQualified:!1,pageVisitSource:s().y8.Create}):(0,v().Ay)({store:t,fullyQualified:!1,pageVisitSource:s().y8.Create});B?B(n):(0,o(577142).navigate)({environment:I,url:n})}u().er(I,{collection_id:c.id,collection_view_id:null==M||null===(e=M.collectionViewStore())||void 0===e?void 0:e.id}),null==f||f()}),[V,I,c,M,j,f,B]),R=(0,n.useMemo)((()=>({key:"create-template",render:e=>(0,m.jsx)(T,{isOverlay:x,locked:k,menuListItemProps:e}),action:F})),[F,x,k]),E=(0,l().K8)((()=>{var e;return null==M||null===(e=M.defaultPageTemplateStore.state)||void 0===e?void 0:e.id}),[M]),L=(0,l().K8)((()=>({key:"empty",render:e=>0===t.length||""!==j?null:(0,m.jsx)(S().K,{collectionStore:c,canConfigureCollection:h,isOverlay:x,templateStore:void 0,isMobile:Boolean(r().A.isMobile),locked:k||!h,draggable:!0,isDefault:void 0===E,onCancelClick:f,...e}),action:G})),[h,c,E,G,x,k,f,j,t.length]),K=(0,n.useCallback)((e=>{const t=e.getAutomationStore(),i=null!=t&&t.isActive()?t.getRecurrence():void 0,l=t&&!t.canEdit(),s="disabled_duplication"===(null==t?void 0:t.getStatus())||"disabled_inactive_space"===(null==t?void 0:t.getStatus()),u={key:e.id,render:t=>(0,n.createElement)(S().K,{...t,key:e.id,isOverlay:x,collectionStore:c,canConfigureCollection:h,templateStore:e,isMobile:Boolean(r().A.isMobile),locked:k,onCancelClick:f,draggable:a,isDefault:E===e.id,recurrence:i,recurrenceDisabled:s,recurrenceButtonDisabled:l}),action:t=>{V&&A({templateStore:e,isKeyboard:"keydown"===t.event.type,useCrdt:(0,o(518736).D8)(c.getSpaceStore())})}};return u}),[h,V,c,E,a,x,k,f,A]),O=(0,l().K8)((()=>{const e=t.map((e=>e.id)),n=[0!==t.length?{key:"templates",render:t=>{if(0===t.children.length)return null;const n=t.children.slice(0,t.children.length-1),i=t.children[t.children.length-1];return(0,m.jsx)(C().A,{...t,disableDesktopPadding:!x,disableMobileBorders:!0,children:(0,m.jsxs)(m.Fragment,{children:[r().A.isMobile||k||!h?n.map(((e,t)=>n[t])):(0,m.jsx)(o(439264).Ay,{direction:"vertical",keys:e,disabled:!a,renderKey:t=>n[e.indexOf(t)],onDrop:P}),i]})})},items:[...t.map(K),L]}:null,h?{key:"create-template",render:e=>(0,m.jsx)(C().A,{topBorder:x,disableDesktopPadding:!x,disableMobileBorders:!0,...e}),items:[R]}:null];return n.filter((e=>null!==e))}),[t,K,L,h,R,x,k,a,P]);return(0,m.jsx)(b().Ay,{type:b().Oh.Vertical,store:w,sections:O,onEmptyEnter:_,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,resetFocusOnMouseOut:!0})})),T=n.forwardRef((function(e,t){const{menuListItemProps:n,isOverlay:r,locked:i}=e,l=(0,m.jsx)(c().sA,{defaultMessage:"New template",id:"database.templateView.newTemplateButton"});return r?(0,m.jsx)(o(274652).o,{title:l,color:"secondary",...n}):(0,m.jsx)(o(286611).J,{title:l,icon:(0,o(617668).plusIcon)(),type:"new_template",format:r?"collection-overlay":"page-menu-item",locked:i,...n})}))},989992:(e,t,o)=>{o.d(t,{p:()=>r});var n=()=>o(314529);function r(e,t){(0,n().DO_NOT_USE_trackLegacy)(e,"open_collection_as_page",t)}}}]);