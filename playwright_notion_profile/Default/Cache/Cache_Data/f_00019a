"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[5834,48486,61660,75681,88924,99171],{267:(e,t,n)=>{n.d(t,{_:()=>s});var i=()=>n(646736),o=()=>n(765957);function s(e){var t;const{sidebarSpaceStore:n}=o().default.state,{currentUser:s}=e.environment;return void 0!==s.id&&Boolean(null===(t=(0,i().sE)(n,s.id))||void 0===t?void 0:t.isWorkspaceOwner())}},5580:(e,t,n)=>{n.d(t,{n:()=>a});var i=()=>n(56366),o=()=>n(209199),s=()=>n(765957);function a(){return(0,i().K8)((()=>{var e;const t=(null===(e=s().default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.preferred_locale)??o().q;return(0,o().o_)(t)}),[])}},22394:(e,t,n)=>{n.d(t,{o:()=>o});n(296540);var i=n(474848);const o=(0,n(340498).wt)("circleCheck",{viewBox:"0 0 12 12",svg:(0,i.jsx)("path",{d:"M6.09277 11.1855C8.88574 11.1855 11.1855 8.88574 11.1855 6.09277C11.1855 3.30469 8.88086 1 6.08789 1C3.2998 1 1 3.30469 1 6.09277C1 8.88574 3.2998 11.1855 6.09277 11.1855ZM6.09277 10.0674C3.89062 10.0674 2.12305 8.29492 2.12305 6.09277C2.12305 3.89062 3.88574 2.11816 6.08789 2.11816C8.29492 2.11816 10.0625 3.89062 10.0674 6.09277C10.0723 8.29492 8.29492 10.0674 6.09277 10.0674ZM5.57031 8.41699C5.75586 8.41699 5.92188 8.31934 6.0293 8.15332L8.17773 4.81836C8.24609 4.71094 8.2998 4.58887 8.2998 4.47656C8.2998 4.21289 8.07031 4.03711 7.82129 4.03711C7.66016 4.03711 7.51855 4.125 7.41113 4.30078L5.55566 7.2793L4.68652 6.19043C4.56934 6.03906 4.44727 5.98047 4.2959 5.98047C4.03711 5.98047 3.82715 6.18555 3.82715 6.44922C3.82715 6.57129 3.87598 6.68359 3.96387 6.7959L5.0918 8.1582C5.22852 8.3291 5.37988 8.41699 5.57031 8.41699Z"})})},22634:(e,t,n)=>{n.d(t,{O:()=>s});n(296540);var i=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"4.42 3.97 12.16 12.06",directional:!0,svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"m5.492 4.158 5.4 5.4a.625.625 0 0 1 0 .884l-5.4 5.4a.625.625 0 1 1-.884-.884L9.566 10 4.608 5.042a.625.625 0 1 1 .884-.884"}),(0,i.jsx)("path",{d:"m16.392 10.442-5.4 5.4a.625.625 0 0 1-.884-.884L15.066 10l-4.958-4.958a.625.625 0 0 1 .884-.884l5.4 5.4a.625.625 0 0 1 0 .884"})]})},s=(0,n(340498).wt)("arrowChevronDoubleForward",o)},26517:(e,t,n)=>{n.d(t,{Wf:()=>h,YB:()=>m,aj:()=>f,f3:()=>v});n(898992),n(354520),n(581454),n(296540);var i=()=>n(401497),o=()=>n(651124),s=()=>n(69708),a=()=>n(449195),r=()=>n(722872),l=()=>n(760217),d=()=>n(404277),c=()=>n(939740),u=()=>n(89924),p=()=>n(74263),g=n(474848);function m(e){const{currentVisibility:t,propertySchema:n,onSelect:i,onClose:r}=e;let l=[...o().vj];l=l.filter((e=>"section"!==e)),(0,a()._f)({propertySchema:n})||(l=l.filter((e=>"hide_if_empty"!==e)));const d=l.map((e=>({visibility:e,label:(0,g.jsx)(s().sA,{...p().gY[e]})})));return(0,g.jsx)(y,{currentVisibility:t,visibilityLevelsWithLabels:d,onSelect:i,onClose:r})}function f(e){const{currentVisibility:t,onSelect:n,onClose:i}=e,o=(0,a().SB)(t),r=["always_show","section_collapsed","section_hide"].map((e=>({visibility:e,label:(0,g.jsx)(s().sA,{...p().vG[e]})})));return(0,g.jsx)(y,{currentVisibility:o,visibilityLevelsWithLabels:r,onSelect:n,onClose:i})}function h(e){const{currentVisibility:t,onSelect:n,onClose:i}=e,a=o().OA.filter((e=>"section_hide"!==e)).map((e=>({visibility:e,label:(0,g.jsx)(s().sA,{...p().wV[e]})}))),r="section_hide"===t?void 0:t;return(0,g.jsx)(y,{currentVisibility:r,visibilityLevelsWithLabels:a,onSelect:n,onClose:i})}function v(e){const{currentVisibility:t,onSelect:n,onClose:i}=e,a=o().RL.map((e=>({visibility:e,label:(0,g.jsx)(s().sA,{...p().PP[e]})})));return(0,g.jsx)(y,{currentVisibility:t,visibilityLevelsWithLabels:a,onSelect:n,onClose:i})}function y(e){const{currentVisibility:t,visibilityLevelsWithLabels:n,onSelect:i,onClose:o}=e,s=n.map((({visibility:e,label:n})=>({key:e,render:i=>(0,g.jsx)(b,{buttonMenuItemProps:i,isChecked:e===t,label:n}),action:()=>{i(e),o&&o()}}))),a=[{key:"visibilityLevels",render:e=>(0,g.jsx)(u().A,{...e,topBorder:0!==e.index}),items:s}],l={menuType:r().gu.Popup,width:"auto",maxWidth:360};return(0,g.jsx)(d().A,{...l,children:(0,g.jsx)(c().Ay,{type:c().Oh.Vertical,initialFocus:void 0,sections:a})})}function b(e){const{buttonMenuItemProps:t,label:n,isChecked:o}=e,s=(0,i().IS)((()=>({title:{display:"flex",alignItems:"center",width:150}})),[]),a=(0,g.jsx)("div",{style:s.title,children:n});return(0,g.jsx)(l().A,{...t,textWrapperStyle:{marginInlineEnd:0},title:a,isChecked:o})}},31902:(e,t,n)=>{n.d(t,{A:()=>s});n(296540);var i=()=>n(69708),o=n(474848);const s=function({collectionViewName:e,collectionViewType:t}){return(0,n(59226).X)("allow_empty_view_name")&&""===e?null:e?(0,o.jsx)(n(288722).A,{children:e}):"page"===t?(0,o.jsx)(i().sA,{id:"database.collectionView.untitledName.untitled",defaultMessage:"Untitled"}):(0,o.jsx)(i().sA,{...n(403905).X[t]})}},41432:(e,t,n)=>{n.d(t,{A:()=>o});class i extends(()=>n(757695))().Store{getInitialState(){return{open:!1}}}const o=new i},59110:(e,t,n)=>{n.r(t),n.d(t,{loadLocalSubtree:()=>x});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(803949);var i=()=>n(726637),o=()=>n(700500),s=()=>n(175482),a=()=>n(777447),r=()=>n(792071),l=()=>n(976618),d=()=>n(388821),c=()=>n(696706),u=()=>n(912720),p=()=>n(199378),g=()=>n(179034),m=()=>n(519831),f=()=>n(869558),h=()=>n(37165),v=()=>n(144081),y=()=>n(743246),b=()=>n(201980),S=()=>n(534177);function x(e){const{environment:t,blockId:n,inMemoryRecordCache:i,options:o}=e,s=t.currentUser.id,a=d().RecordMap.create(),r=new Set,l=[{pointer:{table:g().ev,id:n},parentId:"doesn't matter"}];for(;l.length>0;){const e=l.shift();if(!e)continue;if(r.has(e.pointer.id))continue;const t=n===e.pointer.id,d=A({pointer:e.pointer,recordMap:a,inMemoryRecordCache:i,currentUserId:s,cursors:l,cursor:e,options:o,isRootRequest:t});if(d)return d;r.add(e.pointer.id)}return{type:"success",recordMap:a}}function A(e){const{pointer:t,recordMap:n,inMemoryRecordCache:d,currentUserId:x,cursors:A,cursor:M,options:w,isRootRequest:j}=e;let k;return(0,c().Yt)(t,g().ev)?k=function(e){var t,n,l,d;const{pointer:c,recordMap:p,inMemoryRecordCache:m,currentUserId:h,cursors:v,cursor:x,options:A,isRootRequest:M}=e,w=m.getRecord({pointer:c,userId:h}),j=null==w?void 0:w.value;if(!j)return A.requireFullSubtree?{type:"error",reason:"missing_record",pointer:c}:void 0;const k=A.excludeCrdtData?s().ir(j):j;if(A.includeLegacyTransclusionBlockValues){if(!M&&k.parent_id!==x.parentId&&!x.isBlockContentChild)return}else if(!M&&k.parent_id!==x.parentId)return;if(k.type===o().xd.externalObjectInstance&&!A.allowCopyExternalObjectInstances)return{type:"error",reason:"encountered_external_object_instance",pointer:c};if(p.setValue(c,k),!A.skipNavigableChildren){const e=r().Bj6.fromBlock(k).getCollectionPointers();for(const t of e){const e=m.getRecord({pointer:t,userId:h});var I,C;if(e)(null===(I=e.value)||void 0===I?void 0:I.parent_table)===g().ev&&(null===(C=e.value)||void 0===C?void 0:C.parent_id)===k.id&&v.push({pointer:t,parentId:k.id});else if(A.requireFullSubtree)return{type:"error",reason:"missing_record",pointer:t}}if(k.view_ids)for(const t of k.view_ids)v.push({pointer:{table:f().Gy,id:t,spaceId:k.space_id},parentId:k.id})}if(!(A.skipBlockContent||A.skipTransclusionContainerChildren&&"transclusion_container"===k.type||A.skipNavigableChildren&&(0,o().$I)(k.type))){const e=r().Bj6.fromBlock(k).getRenderableContentIds();for(const t of e)v.push({pointer:{table:g().ev,id:t},parentId:k.id,isBlockContentChild:!0})}const T=r().Bj6.fromBlock(k).getNonContentChildren();for(const i of T)v.push({pointer:{table:g().ev,id:i},parentId:k.id,isBlockContentChild:!0});if(k.type===o().xd.externalObjectInstance){var _,P;const e=(null===(_=k.format)||void 0===_?void 0:_.related_external_object_uris_to_instance_ids)&&Object.values(null===(P=k.format)||void 0===P?void 0:P.related_external_object_uris_to_instance_ids)||[];for(const t of e)v.push({pointer:{table:g().ev,id:t,spaceId:k.space_id},parentId:k.id})}if(!A.skipNavigableChildren&&k.properties){const e=Object.values(k.properties).filter(S().O9);for(const t of e)for(const e of t)for(const t of b().uPN(e)){if(b().jIt(t)){const e=b().v55(t);v.push({pointer:{table:g().ev,id:e},parentId:k.id})}if(b().sh$(t)){const e=b().cQR(t),n=(0,a().lX)({url:e,baseUrl:i().A.domainBaseUrl,publicDomainName:i().A.publicDomainName});n&&v.push({pointer:{table:g().ev,id:n},parentId:k.id})}if(b().N53(t)){const e=b().T$c(t);e&&v.push({pointer:{table:g().ev,id:e,spaceId:k.space_id},parentId:k.id})}}}"form"===k.type&&null!==(t=k.format)&&void 0!==t&&t.form_layout_pointer&&v.push({pointer:k.format.form_layout_pointer,parentId:k.id});null!==(n=k.format)&&void 0!==n&&n.automation_id&&v.push({pointer:{table:u().yB,id:k.format.automation_id,spaceId:k.space_id},parentId:k.id});null!==(l=k.format)&&void 0!==l&&l.workflow_id&&v.push({pointer:{table:y().C0,id:k.format.workflow_id,spaceId:k.space_id},parentId:k.id});null!==(d=k.format)&&void 0!==d&&d.ai_instructions_page_pointer&&v.push({pointer:k.format.ai_instructions_page_pointer,parentId:k.id})}({pointer:t,recordMap:n,inMemoryRecordCache:d,currentUserId:x,cursors:A,cursor:M,options:w,isRootRequest:j}):(0,c().Yt)(t,m().Vl)?k=function(e){var t,n;const{pointer:i,recordMap:o,inMemoryRecordCache:s,currentUserId:a,cursors:r,cursor:l,options:d}=e;if(!d.allowCopyCollections)return{type:"error",reason:"encountered_collection",pointer:i};const c=s.getRecord({pointer:i,userId:a});if(null==c||!c.value)return d.requireFullSubtree?{type:"error",reason:"missing_record",pointer:i}:void 0;if(c.value.parent_id!==l.parentId)return;const p=c.value;o.setValue(i,p),s.forEachRecord(a,(({model:e})=>{e.table===g().ev&&e&&e.parent_id===i.id&&e.alive&&r.push({pointer:e.pointer,parentId:i.id})}));const m=(null===(t=p.format)||void 0===t?void 0:t.automation_ids)??[];for(const g of m)r.push({pointer:{table:u().yB,id:g,spaceId:p.space_id},parentId:p.id});p.schema&&Object.values(p.schema).forEach((e=>{e&&"button"===e.type&&e.automation_id&&r.push({pointer:{id:e.automation_id,spaceId:p.space_id,table:u().yB},parentId:p.id})}));null!==(n=p.format)&&void 0!==n&&n.layout_pointer&&r.push({pointer:p.format.layout_pointer,parentId:p.id})}({pointer:t,recordMap:n,inMemoryRecordCache:d,currentUserId:x,cursors:A,cursor:M,options:w}):(0,c().Yt)(t,f().Gy)?k=function(e){var t;const{pointer:n,recordMap:i,inMemoryRecordCache:o,currentUserId:s,cursors:a,cursor:r,options:l}=e,d=o.getRecord({pointer:n,userId:s});if(null==d||!d.value)return l.requireFullSubtree?{type:"error",reason:"missing_record",pointer:n}:void 0;if(d.value.parent_id!==r.parentId)return;"form_editor"===d.value.type&&null!==(t=d.value.format)&&void 0!==t&&t.form_block_pointer&&a.push({pointer:d.value.format.form_block_pointer,parentId:d.value.id});i.setValue(n,d.value)}({pointer:t,recordMap:n,inMemoryRecordCache:d,currentUserId:x,cursors:A,cursor:M,options:w}):(0,c().Yt)(t,u().yB)?k=function(e){const{pointer:t,recordMap:n,inMemoryRecordCache:i,currentUserId:o,cursors:s,cursor:a,options:r}=e,l=i.getRecord({pointer:t,userId:o});if(null==l||!l.value)return r.requireFullSubtree?{type:"error",reason:"missing_record",pointer:t}:void 0;if(l.value.parent_id!==a.parentId)return;n.setValue(t,l.value);for(const d of l.value.action_ids??[])s.push({pointer:{table:p().SC,id:d,spaceId:l.value.space_id},parentId:l.value.id})}({pointer:t,recordMap:n,inMemoryRecordCache:d,currentUserId:x,cursors:A,cursor:M,options:w}):(0,c().Yt)(t,p().SC)?k=function(e){const{pointer:t,recordMap:n,inMemoryRecordCache:i,currentUserId:o,cursors:s,cursor:a,options:r}=e,l=i.getRecord({pointer:t,userId:o});if(null==l||!l.value)return r.requireFullSubtree?{type:"error",reason:"missing_record",pointer:a.pointer}:void 0;if(l.value.parent_id!==a.parentId)return;n.setValue(t,l.value);for(const d of l.value.blocks??[])s.push({pointer:{table:g().ev,id:d,spaceId:l.value.space_id},parentId:l.value.id})}({pointer:t,recordMap:n,inMemoryRecordCache:d,currentUserId:x,cursors:A,cursor:M,options:w}):(0,c().Yt)(t,y().C0)?k=function(e){const{pointer:t,recordMap:n,inMemoryRecordCache:i,currentUserId:o,cursor:s,options:a}=e,r=i.getRecord({pointer:t,userId:o});if(null==r||!r.value)return a.requireFullSubtree?{type:"error",reason:"missing_record",pointer:s.pointer}:void 0;if(r.value.parent_id!==s.parentId)return;n.setValue(t,r.value)}({pointer:t,recordMap:n,inMemoryRecordCache:d,currentUserId:x,cursor:M,options:w}):(0,c().Yt)(t,v().zx)?k=function(e){const{pointer:t,recordMap:n,inMemoryRecordCache:i,currentUserId:o,cursors:s,options:a}=e,d=i.getRecord({pointer:t,userId:o}),c=null==d?void 0:d.value;if(!c)return a.requireFullSubtree?{type:"error",reason:"missing_record",pointer:t}:void 0;n.setValue(t,c);const u=r().Bj6.fromValue(v().zx,c);for(const r of u.getBlockChildrenPointers())s.push({pointer:r,parentId:t.id});(0,l().E)(c.modules,(e=>{if("formQuestion"===e.type){const n={id:e.formQuestionId,table:h().lo,spaceId:c.space_id};s.push({pointer:n,parentId:t.id})}}))}({pointer:t,recordMap:n,inMemoryRecordCache:d,currentUserId:x,cursors:A,cursor:M,options:w}):(0,c().Yt)(t,h().lo)&&(k=function(e){const{pointer:t,recordMap:n,inMemoryRecordCache:i,currentUserId:o,options:s}=e,a=i.getRecord({pointer:t,userId:o});if(null==a||!a.value)return s.requireFullSubtree?{type:"error",reason:"missing_record",pointer:t}:void 0;n.setValue(t,a.value)}({pointer:t,recordMap:n,inMemoryRecordCache:d,currentUserId:x,cursors:A,cursor:M,options:w})),k}},62088:(e,t,n)=>{n.d(t,{oY:()=>P,uE:()=>_});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(430670);var i=n(296540),o=()=>n(59226),s=()=>n(484714),a=()=>n(56366),r=()=>n(929219),l=()=>n(187174),d=()=>n(68263),c=()=>n(798880),u=()=>n(69708),p=()=>n(496603),g=()=>n(763824),m=()=>n(381678),f=()=>n(47373),h=()=>n(329443),v=()=>n(124749),y=()=>n(645873),b=()=>n(369955),S=()=>n(118789),x=()=>n(106628),A=()=>n(765957),M=()=>n(375447),w=()=>n(870092),j=()=>n(271084),k=()=>n(233692);const I=75,C=75,T=4;function _(e){const{query:t,environment:n,intl:f,useMentionMenuStore:v,open:b}=e,k=(0,a().K8)((()=>v?M().Ay.state.open:b),[b,v]),C=(0,a().K8)((()=>!(!e.disabled&&!v)&&!M().Ay.state.mentionTypes.user),[e.disabled,v]),_=(0,a().K8)((()=>Boolean(A().default.state.sidebarSpaceStore)),[]),P=(0,o().X)("edge_cache_mentions"),[{value:B=[],status:D}]=(0,l().Yb)((async()=>{if(C||P||!k||!_)return[];const e=await async function(e,t,n){if(r().A.state.online){const i=await x().T.searchActions.load();return await i.searchVisibleSpaceUsers({environment:t,query:e,membersOnly:!1,minFuzzyScore:25,placeSelfFirst:i.isPersonalPronoun(e,n)})}return[]}(t,n,f.locale);return e}),[C,P,k,_,t,n,f.locale],{debounce:I}),{results:R,isLoading:E}=function(e){const{query:t,flagEnabled:n,disabled:o,useMentionMenuStore:r,open:f}=e,v=(0,u().tz)(),b=(0,s().v3)(),k=(0,a().K8)((()=>r?M().Ay.state.open:f),[f,r]),C=(0,a().O$)(A().AppStoreSidebarSpaceStore),T=!o&&n&&t.length>0&&C&&k,_=(0,a().K8)((()=>{var e;const t=j().k.getSortedUserIds(),n=null===(e=(0,m()._)(b))||void 0===e?void 0:e.id;return[...(0,p().oE)([n]),...t]}),[b]),P=(0,a().K8)((()=>{const e=A().default.state.mainEditorCurrentBlockStore;return e?(0,h().i0)(e).flatMap((({permissionItem:e})=>(0,d().B2)(e)?[e.user_id]:[])):[]}),[]),B=(0,y().fJ)(x().T.searchActions),[{value:D=[],status:R}]=(0,l().Yb)((async()=>{if(!T||"resolved"!==B.status)return[];const e=(0,p().sb)([..._,...P]),n=B.value;return(await n.searchUsers({environment:b,parentStore:C,query:t,userIds:e,minFuzzyScore:25,placeSelfFirst:n.isPersonalPronoun(t,v.locale)})).slice(0,3)}),[T,B.status,B.value,_,P,b,C,t,v.locale]),E=(0,i.useMemo)((()=>({field:"name_normalized",direction:"asc"})),[]),L=(0,S().n)({query:t,sort:E,filter:void 0,limit:50,disable:!T}),O=(0,a().K8)((()=>(null==L?void 0:L.rowsStore.state.rows)??[]),[L]),[{value:N=[],status:F}]=(0,l().Yb)((async()=>{if(!T)return[];const e=O.sort(((e,t)=>{var n,i;const o=(null===(n=j().k.state)||void 0===n?void 0:n[e.id])??0;return((null===(i=j().k.state)||void 0===i?void 0:i[t.id])??0)-o})),t=await(0,g().lX)(e,Math.max(e.length,1),(async e=>{const t=w().L.createChildStore(C,{table:c().oo,id:e.id});return await t.load(),t.getValue()}));return(0,p().oE)(t)}),[C,T,O],{debounce:I}),U=(0,i.useMemo)((()=>{const e=new Set;return[...D,...N].filter((t=>!e.has(t.id)&&(e.add(t.id),!0)))}),[D,N]),z="pending"===F||"pending"===R;return{results:U,isLoading:z}}({query:t,flagEnabled:P,disabled:C,...v?{useMentionMenuStore:!0}:{useMentionMenuStore:!1,open:!0}}),L=(0,i.useMemo)((()=>P?R:B),[P,B,R]),O=(0,a().K8)((()=>M().Ay.state.emptyQueryUserRequestStore.state.result??[]),[]),N="pending"===(P?E:D);return{results:0===t.length?O.slice(0,T):L.slice(0,20),isLoading:N}}function P(e){const{query:t,environment:n,useMentionMenuStore:i,open:o}=e,s=(0,a().K8)((()=>i?M().Ay.state.open:o),[o,i]),r=(0,f().ke)(),d=(0,b().L)(),c=(0,v().$)(),u=!(0,a().K8)((()=>!(!e.disabled&&!i)&&!M().Ay.state.mentionTypes.bot),[e.disabled,i])&&r&&s&&Boolean(d)&&Boolean(c),[{value:p=[],status:g}]=(0,l().Yb)((async()=>{if(!u)return[];try{if(!d||!c)return[];const e=await x().T.customAgentSearchService.load(),{workflowStores:i}=await e.getCustomAgents({environment:n,spaceStore:d,userStore:c}),o=e.searchWorkflowStores({query:t,workflowStores:i,limit:5}),s=[];for(const t of o){const e=(0,k().m)(t);s.push({workflowStore:t,name:e.name,icon:e.icon})}return s}catch{return[]}}),[u,d,c,t,n],{debounce:C});return{results:p,isLoading:"pending"===g}}},64901:(e,t,n)=>{n.d(t,{A:()=>o});n(296540);var i=n(474848);const o=function(e){const t=(0,n(484714).v3)();return(0,i.jsx)(n(97294).N,{style:{display:"flex",alignSelf:"stretch",width:36},external:!0,href:e.href,onClick:()=>n(148024).FH(t,{from:e.analyticsFrom}),children:(0,i.jsx)(n(718827).Ay,{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:(0,i.jsx)(n(252291).I,{icon:n(406533).questionMarkCircleIcon,colorVariant:"tertiary"})})})}},70463:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});n(898992),n(941795);var i=n(296540),o=()=>n(484714),s=()=>n(56366),a=()=>n(401497),r=()=>n(252291),l=()=>n(160432),d=()=>n(721479),c=()=>n(427704),u=()=>n(69708),p=()=>n(100622),g=()=>n(284371),m=()=>n(559506),f=()=>n(381678),h=()=>n(404141),v=()=>n(446242),y=()=>n(623580),b=()=>n(719147),S=n(474848);const x={padding:"24px 36px 24px",minWidth:300,maxWidth:400},A=n(757695).Store.createClass(void 0,{name:"PromoErrorStore"});const M=function(){const e=(0,s().K8)((()=>v().A.state.open),[]);return(0,S.jsx)(n(676007).a,{open:e,innerStyle:x,preventHideChildrenWhileOpening:!0,render:()=>(0,S.jsx)(T,{}),onDismiss:j})};function w(){const e=(0,a().DP)();return(0,S.jsxs)("div",{style:{display:"flex",alignItems:"center",color:e.text.tertiary,borderTop:`1px solid ${e.regularDividerColor}`,paddingTop:14,gap:6},children:[(0,S.jsx)(r().I,{icon:d().questionMarkCircleSmallIcon,size:"sm",colorVariant:"tertiary"}),(0,S.jsx)("div",{children:(0,S.jsx)(u().sA,{defaultMessage:"Have questions about this? <inlinelink>More info & FAQs</inlinelink>.",id:"studentNotEligibleModal.contactUsSection.message",values:{inlinelink:e=>(0,S.jsx)(b().A,{href:"https://www.notion.so/Notion-for-students-teachers-adc631df15ee4ab9a7a33dd50f4c16fe",external:!0,children:e})}})})]})}function j(){v().A.setState({open:!1})}function k(){j(),h().A.setState({open:!0,openedFrom:"student_not_eligible_modal",currentTab:"profile",defaultSubtab:void 0,highlightedSetting:void 0})}function I(){const e=(0,a().DP)(),t=(0,o().v3)(),n=(0,s().K8)((()=>(0,f()._)(t)),[t]),i=(0,s().K8)((()=>null==n?void 0:n.getEmail()),[n]);return(0,S.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,S.jsx)("div",{style:{width:18,flexShrink:0,color:e.text.secondary},children:(0,S.jsx)(u().sA,{defaultMessage:"1.",id:"studentNotEligibleModal.numberedList.firstItem"})}),(0,S.jsxs)("div",{style:{flexGrow:1},children:[(0,S.jsx)("div",{style:{color:e.text.secondary},children:(0,S.jsx)(u().sA,{defaultMessage:"Your current email is:",id:"studentNotEligibleModal.numberedList.changeEmailItem.message"})}),(0,S.jsx)("div",{style:{fontWeight:g().Wy.medium,marginTop:0},children:i}),(0,S.jsx)("div",{style:{color:e.text.secondary,marginTop:4},children:(0,S.jsx)(u().sA,{defaultMessage:"Thousands of university, college, and post-secondary school domains are already eligible, not just .edu emails!",id:"studentNotEligibleModal.numberedList.changeEmailItem.message2"})}),(0,S.jsx)(l().A,{colorPalette:"blue",style:{marginTop:12},onClick:k,size:"lg",children:(0,S.jsx)(u().sA,{defaultMessage:"Change email",id:"studentNotEligibleModal.numberedList.changeEmailItem.button.label"})})]})]})}function C(){const e=(0,u().tz)(),t=(0,a().DP)(),n=(0,o().v3)(),r=(0,s().uB)(void 0,A),[d,c]=(0,i.useState)(""),g=(0,i.useCallback)((()=>async function(e,t,n,i){if(n){const o=await m().callApi({eventName:"getPromoCode",environment:e,data:{code:n}});"failed"!==o.type&&o.data.promo?v().A.state.open&&(await v().A.state.handlePromoCode(n),j()):i.setState(t.formatMessage({defaultMessage:"Promo code {code} does not exist",id:"studentNotEligibleModal.numberedList.item2.promocode.errorMessage"},{code:n}))}}(n,e,d,r)),[n,e,d,r]),f=(0,i.useCallback)((e=>function(e,t,n){t(e.target.value.toUpperCase()),n.setState(void 0)}(e,c,r)),[c,r]),h=(0,s().O$)(r),b=e.formatMessage({defaultMessage:"Enter codeâ€¦",id:"studentNotEligibleModal.numberedList.item2.promocodePlaceholder"});return(0,S.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,S.jsx)("div",{style:{width:18,flexShrink:0,color:t.text.secondary},children:(0,S.jsx)(u().sA,{defaultMessage:"2.",id:"studentNotEligibleModal.numberedList.secondItem"})}),(0,S.jsxs)("div",{style:{flexGrow:1},children:[(0,S.jsx)("div",{style:{color:t.text.secondary},children:(0,S.jsx)(u().sA,{defaultMessage:"Have a student promo code?",id:"studentNotEligibleModal.numberedList.promoCodeItem.message"})}),(0,S.jsxs)("div",{style:{display:"flex",marginTop:12},children:[(0,S.jsx)(y().A,{style:{marginInlineEnd:8,height:32},value:d,onChange:f,onSubmit:g,placeholder:b}),(0,S.jsx)(l().A,{colorPalette:"blue",onClick:g,disabled:!d,size:"lg",children:(0,S.jsx)(u().sA,{defaultMessage:"Submit",id:"studentNotEligibleModal.numberedList.promoCodeItem.submitButton"})})]}),(0,S.jsx)("div",{style:{color:p().Tj.red,fontSize:12,marginTop:4,marginInlineStart:8,height:20},children:h})]})]})}function T(){return(0,S.jsxs)("div",{style:{fontSize:14},children:[(0,S.jsx)("div",{children:(0,S.jsx)(u().sA,{defaultMessage:"<p>Unfortunately you are not eligible for a free Education plan if you use this email address.</p><p>K-12 students, K-12 educators, and personal email addresses such as Gmail and Outlook are not eligible to receive the <pricinglink>Education Plan</pricinglink> for free, but anyone is welcome to use the <pricinglink>Free Plan</pricinglink> for free with unlimited storage.</p>",id:"studentNotEligibleModal.header",values:{br:(0,S.jsx)("br",{}),p:e=>(0,S.jsx)("p",{style:{marginTop:0,marginBottom:8},children:1===e.length?e[0]:i.Children.toArray(e)}),pricinglink:e=>(0,S.jsx)(b().A,{external:!0,href:c().eR.pricing,children:e})}})}),(0,S.jsx)(I,{}),(0,S.jsx)(C,{}),(0,S.jsx)(w,{})]})}},72897:(e,t,n)=>{n.r(t),n.d(t,{clearCoEditingOverride:()=>c,setCoEditingOverride:()=>d,setCoEditingSetting:()=>l});var i=()=>n(564884),o=()=>n(488923),s=()=>n(231297),a=()=>n(755199),r=()=>n(642046);async function l(e){var t,n;const{environment:r,userSettingsStore:l,spaceId:d,active:c}=e,u=(null===(t=l.getSettings())||void 0===t?void 0:t.beta_ai_co_editing_settings)??{};if(((null===(n=u[d])||void 0===n?void 0:n.autocorrect)??!1)===c)return;s().createAndCommit({userAction:"AiCoEditingSettings.onToggleOption",environment:r,canUndo:!0,perform:e=>{a().mJ({userSettingsStore:l,data:{beta_ai_co_editing_settings:{...u,[d]:{autocorrect:c}}},transaction:e})}});const p=await(0,o().uZ)();c&&p.resetSessionId(),(0,i().u)({environment:r,event:{eventName:"co_editing_toggled",eventProperties:{toggle_status:c?"on":"off",session_id:p.getSessionId()}}}),c||p.resetSessionId()}async function d(e){const{environment:t,pageId:n,active:s}=e;r().t.setOverride(n,{autocorrect:s});const a=await(0,o().uZ)();(0,i().u)({environment:t,event:{eventName:"co_editing_override_updated",eventProperties:{new_state:s?"on":"off",session_id:a.getSessionId(),page_id:n}}})}async function c(e){const{environment:t,pageId:n}=e;r().t.clearOverride(n);const s=await(0,o().uZ)();(0,i().u)({environment:t,event:{eventName:"co_editing_override_updated",eventProperties:{new_state:"cleared",session_id:s.getSessionId(),page_id:n}}})}},73926:(e,t,n)=>{n.d(t,{H:()=>r});n(296540);var i=()=>n(69708),o=()=>n(100622);n(18107),n(967357);var s=n(474848);const a=(0,i().YK)({reportPageName:{id:"action.reportPage.name",defaultMessage:"Report page"}}),r=(0,n(10521).Ls)({key:"action report page",displayName:a.reportPageName,analyticsName:a.reportPageName.defaultMessage,validators:[n(946561).s,n(622311).E,function({blocks:e}){var t;return(null===(t=e.at(0))||void 0===t?void 0:t.getSpaceId())!==n(96689).Zz},(0,n(598101).A)(n(59411).k)],closeParentMenu:!0,render:e=>(0,s.jsx)(n(575143).A,{...e,style:{color:o().Tj.red},svg:n(748054).M,svgStyle:{fill:o().Tj.red},title:(0,s.jsx)(i().sA,{...a.reportPageName})}),action:({blocks:e,environment:t})=>{n(201170).HX()}})},74263:(e,t,n)=>{n.d(t,{PP:()=>s,gY:()=>u,vG:()=>r,wV:()=>d});var i=()=>n(69708);const o=(0,i().YK)({default:{id:"customizePageMenuVisibilitySelect.default.label",defaultMessage:"Default"},minimal:{id:"customizePageMenuVisibilitySelect.minimal.label",defaultMessage:"Minimal"}}),s={inline:o.default,minimal:o.minimal},a=(0,i().YK)({showOnHover:{id:"visibilityLevelMessages.backlinksPageSection.showOnHover",defaultMessage:"Show on hover"},alwaysShow:{id:"visibilityLevelMessages.backlinksPageSection.alwaysShow",defaultMessage:"Always show"},off:{id:"customizePageMenuVisibilitySelect.off.label",defaultMessage:"Off"}}),r={always_show:a.alwaysShow,section_show:a.showOnHover,section_collapsed:a.showOnHover,section_hide:a.off,inline:a.off,minimal:a.off},l=(0,i().YK)({asPageSection:{id:"customizePageMenuVisibilitySelect.section.label",defaultMessage:"As page section"},minimal:{id:"visibilityLevelMessages.propertyPageSection.minimal",defaultMessage:"Minimal"}}),d={inline:l.asPageSection,minimal:l.minimal},c=(0,i().YK)({alwaysShow:{id:"customizePageMenuVisibilitySelect.show.label",defaultMessage:"Always show"},alwaysHide:{id:"customizePageMenuVisibilitySelect.hide.label",defaultMessage:"Always hide"},hideWhenEmpty:{id:"customizePageMenuVisibilitySelect.hideIfEmpty.label",defaultMessage:"Hide when empty"},asPageSection:{id:"customizePageMenuVisibilitySelect.section.label",defaultMessage:"As page section"}}),u={show:c.alwaysShow,hide:c.alwaysHide,hide_if_empty:c.hideWhenEmpty,section:c.asPageSection}},84349:(e,t,n)=>{n.d(t,{A:()=>o});class i extends(()=>n(757695))().Store{getInitialState(){return{open:!1}}}const o=new i},87017:(e,t,n)=>{n.r(t),n.d(t,{duplicateBlocks:()=>w,duplicateBlocksWithMaybeConfirmation:()=>M,insertBlockAbove:()=>k,insertBlockAndEdit:()=>I,insertBlockBelow:()=>j,insertTextAbove:()=>T,insertTextBelow:()=>C});n(18107),n(944114),n(967357);var i=()=>n(908006),o=()=>n(206267),s=()=>n(496603),a=()=>n(855801),r=()=>n(60867),l=()=>n(669548),d=()=>n(620689),c=()=>n(391214),u=()=>n(231297),p=()=>n(838256),g=()=>n(962910),m=()=>n(807700),f=()=>n(799832),h=()=>n(516430),v=()=>n(405417),y=()=>n(495506),b=()=>n(393255),S=()=>n(77246),x=()=>n(502438),A=()=>n(50764);async function M(e){const{environment:t,blocks:n,duplicateOnlyCollectionSchema:o,callback:s,from:l}=e;if(!(0,A().E)(t))return;const c=await a().VI.duplicateActions.load();let p=n;if(1===n.length){const e=await g().rW({environment:t,block:n[0],action:"duplicate"});if("user_canceled"===e)return void(null==s||s());p=e}const m=p.at(0);if(!m)return;const h=(0,f().U)(m);if(h&&(0,v().ls)(m,h))await r().un({blocks:p,environment:t,analyticsFrom:"subitem_duplication",callback:s,collectionContextStore:h});else{const{serverCommitResult:e}=u().createAndCommit({userAction:"actionRegistry.duplicateToSelection",environment:t,canUndo:!0,perform:e=>{w({environment:t,blocks:p,transaction:e,executionTarget:"local",duplicateOnlyCollectionSchema:o,duplicateActions:c,from:l})},transactionTooBigFallback:e=>{w({environment:t,blocks:p,transaction:e,executionTarget:"server",duplicateOnlyCollectionSchema:o,duplicateActions:c,from:l})}});e.then(s)}i().default.afterNextFlush((()=>{d().BM({environment:t})}))}function w(e){const{environment:t,blocks:n,transaction:i,executionTarget:o,lastTopLevelBlockStore:a,preventSetSelection:r,duplicateOnlyCollectionSchema:l,duplicateActions:d,from:u}=e,p=s().$z(n,(e=>e.getFormat().app_id??e.id)),g=[];return s().jJ(p,(e=>{const n=e[0],{blockStores:s}=d.duplicateBlock({environment:t,stores:e,transaction:i,targetSpaceId:n.getSpaceId(),executionTarget:o,from:u,options:{addCopyName:!0,allowRedundancy:!1,deepCopyTransclusionContainers:!n.isTransclusionType(),resolveTemplateVariables:!(0,m().l)(n),duplicateOnlyCollectionSchema:l},skipUserFacingMessages:!1});g.push(...s)})),c().LE({blocksToInsert:g,target:a?[a]:n,environment:t,transaction:i,replaceEmptyTextBlock:!1,preventSetSelection:r}),g}function j(e){const{environment:t,createBlockItem:n,selection:i,transaction:o,analyticsFrom:s,preventSetSelection:a}=e,r=x().default.getCurrentRecordCache(),d=new(p().UF)({environment:t,userFlow:"page"===(null==n?void 0:n.blockType)?"user_flow_create_page":"user_flow_create_block",succeedOnEnqueue:!0});let u;if((0,A().E)(t)&&n&&r){const e=l().w({environment:t,createBlockItem:n,transaction:o,inMemoryRecordCache:r,from:s,selection:i});d.track(e.pointer,o),u=c().LE({environment:t,blocksToInsert:[e],target:i,transaction:o,replaceEmptyTextBlock:!1,preventSetSelection:a})[0]}else d.fail("invalid_state");return u}function k(e){const{environment:t,createBlockItem:n,selection:i,transaction:o,analyticsFrom:s,preventSetSelection:a}=e,r=x().default.getCurrentRecordCache();let d;if((0,A().E)(t)&&n&&r){const e=l().w({environment:t,createBlockItem:n,transaction:o,inMemoryRecordCache:r,from:s,selection:i});d=c().t1({environment:t,blocks:[e],selection:i,transaction:o,preventSetSelection:a})[0]}return d}function I(e){const{environment:t,selection:n,transaction:i}=e,s=j({...e,preventSetSelection:!0});if(s){var a;c().x5({environment:t,insertedStores:[s],isCreated:!0});const e=S().Uv.getMode(s);if("suggest"===e){const e=h().RR(t,i,s);h().tM(i,s,{id:o().JW(),type:"insert",discussionId:e.id}),h().c3({environment:t,transaction:i,discussionStore:e,addModifiedBlockIdsAfter:[s.id]})}"suggest"===e&&null!==(a=s.getNavigableBlockStore({skipCurrent:!0}))&&void 0!==a&&a.isCommentOnly()||c().um({transaction:i,blocks:n})}return s}function C(e){const{blocks:t,transaction:n,environment:o,skipAnalytics:s}=e,a=s?void 0:"text_insert_below",r=j({environment:o,selection:t,createBlockItem:y().ry.text,analyticsFrom:a,transaction:n});return r&&i().default.afterNextFlush((()=>{b().zz({environment:o,blockStore:r,insertedTextBlockLocation:"below"})})),r}function T(e){const{blocks:t,transaction:n,environment:o,skipAnalytics:s}=e,a=s?void 0:"text_insert_below",r=k({environment:o,selection:t,createBlockItem:y().ry.text,analyticsFrom:a,transaction:n});return r&&i().default.afterNextFlush((()=>{b().zz({environment:o,blockStore:r,insertedTextBlockLocation:"above"})})),r}},88975:(e,t,n)=>{n.r(t),n.d(t,{codegenIcon:()=>s,iconDefinition:()=>o});n(296540);var i=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"0 -0.01 20 20.01",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("g",{fill:"#3730A3",clipPath:"url(#clip0_12504_10693)",children:[(0,i.jsx)("path",{d:"M14.181 6.786a.5.5 0 0 0 0 .705l2.137 2.131a.5.5 0 0 1 0 .706l-2.137 2.131a.5.5 0 0 0 0 .706l1.06 1.058a.5.5 0 0 0 .708 0l3.904-3.895a.5.5 0 0 0 0-.706L15.95 5.728a.5.5 0 0 0-.707 0zm-1.768 8.142a.5.5 0 0 0-.707 0l-1.353 1.35a.5.5 0 0 1-.707 0l-5.964-5.95a.5.5 0 0 1 0-.706l5.964-5.95a.5.5 0 0 1 .707 0l1.353 1.35a.5.5 0 0 0 .707 0l1.061-1.058a.5.5 0 0 0 0-.705L10.354.146a.5.5 0 0 0-.708 0l-9.5 9.476a.5.5 0 0 0 0 .706l9.5 9.476a.5.5 0 0 0 .707 0l3.121-3.113a.5.5 0 0 0 0-.705z"}),(0,i.jsx)("path",{d:"M12.5 9.975A2.497 2.497 0 0 1 10 12.47c-1.38 0-2.5-1.117-2.5-2.494A2.497 2.497 0 0 1 10 7.481c1.38 0 2.5 1.117 2.5 2.494"})]}),(0,i.jsx)("defs",{children:(0,i.jsx)("clipPath",{id:"clip0_12504_10693",children:(0,i.jsx)("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]})},s=(0,n(340498).wt)("codegen",o)},91669:(e,t,n)=>{n.d(t,{z:()=>o});class i extends(()=>n(757695))().Store{getInitialState(){return{isOpen:!1}}}const o=new i},95001:(e,t,n)=>{n.d(t,{aR:()=>E,oq:()=>z,zM:()=>O});var i=n(296540),o=()=>n(59226),s=()=>n(726637),a=()=>n(484714),r=()=>n(56366),l=()=>n(401497),d=()=>n(879765),c=()=>n(954845),u=()=>n(66913),p=()=>n(206267),g=()=>n(187859),m=()=>n(350527),f=()=>n(703888),h=()=>n(68263),v=()=>n(179034),y=()=>n(69708),b=()=>n(534177),S=()=>n(284371),x=()=>n(703875),A=()=>n(285790),M=()=>n(460292),w=()=>n(125565),j=()=>n(987017),k=()=>n(38337),I=()=>n(115512),C=()=>n(477293),T=()=>n(676870),_=()=>n(525700),P=()=>n(380682),B=()=>n(437487),D=n(474848);const R=(0,y().YK)({seo:{defaultMessage:"Search engine indexing",id:"publishSiteSettings.SEO.title"},embed:{defaultMessage:"Embed this page",id:"embedSiteSettings.title"},shareOnSocial:{defaultMessage:"Share via social",id:"shareMenu.shareOnSocial"}});function E({store:e,inviteTargetsStore:t,mostPermissivePublicItem:n}){const{display:i,source:o}=(0,r().K8)((()=>{const{display:e}=B().Ay.state;if(e===B().pP.Invite){const{source:t}=B().Ay.state;return{display:e,source:t}}return{display:e,source:void 0}}),[]);switch(i){case B().pP.MainShareMenu:case B().pP.Publish:return e.table!==v().ev?null:(0,D.jsx)(O,{store:e,mostPermissivePublicItem:n});case B().pP.Invite:if("notion"===o)return(0,D.jsx)(N,{inviteTargetsStore:t});if("slack"===o||"google"===o||"microsoft"===o)return(0,D.jsx)(F,{source:o});throw(0,b().HB)(o);default:(0,b().HB)(i)}}const L=[B().QC.Share,B().QC.Publish];function O({store:e,mostPermissivePublicItem:t}){const n=(0,a().v3)(),d=i.useRef(null),u=s().A.isMobile,g=(0,r().K8)((()=>(0,h().W8)(t.permissionItem)),[t.permissionItem]),m=(0,o().X)("polish_publish_menu")&&!s().A.isMobile;(0,i.useEffect)((()=>{const e=B().Ay.state,t=e.tab===B().QC.Share&&e.display===B().pP.MainShareMenu?e.source:void 0;g&&t!==B().mc.InviteBackButton&&(B().Ay.setState({tab:B().QC.Publish,display:B().pP.Publish,sessionId:p().JW(),isInitialized:!0}),(0,T().EN)(n,{source:"share_button"}))}),[n,g]);const f=(0,r().K8)((()=>B().Ay.state.tab),[]),v=(0,l().IS)((e=>({tabStyle:{color:e.text.tertiary,...u&&{width:"50%",textAlign:"center"}},selectedTabStyle:{},tabTitleStyle:{color:"inherit",fontSize:(0,I().ny)(n,"UIRegular"),fontWeight:S().Wy.medium},style:u?{marginBottom:8,justifyContent:"space-between"}:{marginBottom:16,paddingInlineStart:m?12:16},tabBorderStyle:{insetInlineStart:0,insetInlineEnd:0}})),[n,u,m]),b=(0,l().IS)((e=>({tabStyle:{width:"50%",textAlign:"center",borderRadius:10,color:e.text.secondary,fontWeight:S().Wy.regular,paddingTop:2,paddingBottom:2},tabBorderStyle:{borderBottom:"none"},selectedTabStyle:{borderRadius:8,background:"dark"===e.mode?e.background.tertiaryTranslucent:e.background.elevated},tabTitleStyle:{color:"inherit",fontSize:(0,I().ny)(n,"UIRegular"),fontWeight:S().Wy.regular},selectedTabTitleStyle:{fontWeight:S().Wy.medium},style:{justifyContent:"space-between",padding:2,background:e.background.tertiaryTranslucent,borderRadius:10,marginBottom:0,height:34}})),[n]),A=(0,l().IS)((e=>({publishTabContainer:{display:"flex",alignItems:"center"},publishIcon:{height:16,width:16,marginInlineStart:4,opacity:f===B().QC.Publish?1:.5},tabBarContainer:{paddingInlineStart:20,paddingInlineEnd:20,paddingTop:8,paddingBottom:16,backgroundColor:u?e.background.secondary:e.background.primary}})),[f,u]),M=(0,i.useCallback)((e=>{const t=L[e];t!==f&&(x().N(n,{tab:t}),t===B().QC.Share&&B().Ay.setState({...B().Ay.state,display:B().pP.MainShareMenu,tab:B().QC.Share,source:B().mc.ShareTab}),t===B().QC.Publish&&B().Ay.setState({...B().Ay.state,display:B().pP.Publish,tab:B().QC.Publish}))}),[f,n]),w=[(0,D.jsx)(i.Fragment,{children:(0,D.jsx)(y().sA,{defaultMessage:"Share",id:"shareMenu.shareTab.title"},"share")},"title"),(0,D.jsxs)("div",{ref:d,style:A.publishTabContainer,className:k().hKK,children:[(0,D.jsx)(y().sA,{defaultMessage:"Publish",id:"shareMenu.publishTab.title"},"publish"),g?(0,c().J)(A.publishIcon):void 0]},"publishTab")],C=(0,r().K8)((()=>P().A.state.siteSettingContentType),[]);return"seo"===C?(0,D.jsx)(K,{}):"embed"===C?(0,D.jsx)(V,{handleBackButtonClick:()=>{_().Bp("initial")}}):"social"===C?(0,D.jsx)(q,{handleBackButtonClick:()=>{_().Bp("initial")}}):u?(0,D.jsx)("div",{style:A.tabBarContainer,children:(0,D.jsx)(j().Ay,{...b,tabs:w,selectedIndex:L.indexOf(f),onChange:M,hideTabBorder:!0})}):(0,D.jsx)(j().Ay,{...v,tabs:w,selectedIndex:L.indexOf(f),onChange:M})}function N({inviteTargetsStore:e}){const t=(0,l().IS)((e=>({container:{display:"flex",paddingInlineStart:12,paddingInlineEnd:12,marginBottom:16,height:40,boxShadow:`inset 0 -1px 0 ${e.regularDividerColor}`}})),[]),n=(0,i.useCallback)((()=>{e.reset(),B().Ay.setState({...B().Ay.state,display:B().pP.MainShareMenu,tab:B().QC.Share,source:B().mc.InviteBackButton})}),[e]);return(0,D.jsx)("div",{style:t.container,children:(0,D.jsx)(z,{onClick:n,titleMessage:(0,D.jsx)(y().sA,{id:"shareMenu.sendInvite.labelV2",defaultMessage:"Invite"})})})}function F(e){const{source:t}=e,n=(0,y().tz)(),o=(0,l().IS)((()=>({container:{display:"flex",justifyContent:"space-between",margin:"0 12px",height:48,alignItems:"center"},titleLabel:{display:"flex",fontSize:12,alignItems:"center",fontWeight:S().Wy.semibold}})),[]),s=(0,i.useCallback)((()=>{B().Ay.setState({...B().Ay.state,tab:B().QC.Share,display:B().pP.Invite,source:B().NL.Notion,focus:B().yZ.Search,emailMessage:""})}),[]);return(0,D.jsxs)("div",{style:o.container,children:[(0,D.jsx)(w().A,{style:o.titleLabel,children:(0,D.jsx)(y().sA,{id:"shareMenu.addFromSlack.label",defaultMessage:"Add people from {integrationNameWithLogo}",values:{integrationNameWithLogo:(0,D.jsx)(U,{source:t})}})}),(0,D.jsx)(A().A,{ariaLabel:n.formatMessage({id:"shareMenuHeader.goBackToInviteFromNotionMenu.iconButton",defaultMessage:"Close external integration and go back to the main invite flow."}),icon:u().V,style:{borderRadius:"100%"},onClick:s})]})}function U({source:e}){const t=(0,l().IS)((()=>({imageStyle:{marginInlineStart:4,marginInlineEnd:4}})),[]),n="control"!==(0,C().r)("microsoft_contacts_import");return e===B().NL.Slack?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(M().Q,{iconGroup:f().j,variantName:"default",overrideSize:()=>16,style:t.imageStyle}),(0,D.jsx)(y().sA,{defaultMessage:"Slack",id:"shareMenu.slackIntegrationName.label"})]}):e===B().NL.Google?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(M().Q,{iconGroup:g().m,variantName:"default",overrideSize:()=>16,style:t.imageStyle}),(0,D.jsx)(y().sA,{defaultMessage:"Google",id:"shareMenu.googleContactsIntegrationName.label"})]}):e===B().NL.Microsoft?n?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(M().Q,{iconGroup:m().g,variantName:"default",overrideSize:()=>16,style:t.imageStyle}),(0,D.jsx)(y().sA,{defaultMessage:"Microsoft",id:"shareMenu.microsoftContactsIntegrationName.label"})]}):null:void(0,b().HB)(e)}function z(e){const{onClick:t,titleMessage:n}=e,i=(0,a().v3)(),o=(0,y().tz)(),s=(0,l().IS)((()=>({topContainer:{display:"flex",alignItems:"center",width:"max-content"},iconButton:{marginInlineEnd:6,height:24,width:24},arrowIcon:{height:20,width:20,strokeWidth:S().Wy.semibold},sendInviteLabel:{fontWeight:S().Wy.medium,fontSize:(0,I().ny)(i,"UIRegular")}})),[i]);return(0,D.jsxs)("div",{style:s.topContainer,children:[(0,D.jsx)(A().A,{icon:d().$,iconStyle:s.arrowIcon,style:s.iconButton,onClick:t,ariaLabel:o.formatMessage({id:"shareMenu.backButton.iconButton",defaultMessage:"Go back to main share menu."})}),(0,D.jsx)(w().A,{style:s.sendInviteLabel,children:n})]})}function K(){const e=(0,l().IS)((e=>({container:{display:"flex",paddingTop:0,paddingInlineEnd:12,paddingBottom:0,paddingInlineStart:8,height:40,borderBottom:`1px solid ${e.border.secondary}`}})),[]),t=(0,i.useCallback)((()=>{_().Bp("initial")}),[]);return(0,D.jsx)("div",{style:e.container,children:(0,D.jsx)(z,{onClick:t,titleMessage:(0,D.jsx)(y().sA,{...R.seo})})})}function V(e){const t=(0,l().IS)((e=>({container:{display:"flex",paddingTop:0,paddingInlineEnd:12,paddingBottom:0,paddingInlineStart:8,height:40,borderBottom:`1px solid ${e.border.secondary}`}})),[]);return(0,D.jsx)("div",{style:t.container,children:(0,D.jsx)(z,{onClick:e.handleBackButtonClick,titleMessage:(0,D.jsx)(y().sA,{...R.embed})})})}function q(e){const t=(0,l().IS)((e=>({container:{display:"flex",paddingTop:0,paddingInlineEnd:12,paddingBottom:0,paddingInlineStart:8,height:40,borderBottom:`1px solid ${e.border.secondary}`}})),[]);return(0,D.jsx)("div",{style:t.container,children:(0,D.jsx)(z,{onClick:e.handleBackButtonClick,titleMessage:(0,D.jsx)(y().sA,{...R.shareOnSocial})})})}},105062:(e,t,n)=>{n.r(t),n.d(t,{checkmarkShieldSmallIcon:()=>s,iconDefinition:()=>o});n(296540);var i=n(474848);const o={viewBox:"0 0 16 16",fittedViewBox:"2.78 2.12 10.44 11.75",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M10.172 5.564a.625.625 0 0 0-.858.214L7.36 9.035 6.325 7.827a.625.625 0 1 0-.95.813l1.6 1.867a.625.625 0 0 0 1.01-.085l2.4-4a.625.625 0 0 0-.213-.858"}),(0,i.jsx)("path",{d:"M8.28 2.191a.63.63 0 0 0-.56 0l-.962.481a7.25 7.25 0 0 1-3.242.765h-.11a.625.625 0 0 0-.625.626v4.333a5 5 0 0 0 3.03 4.596l1.943.832a.63.63 0 0 0 .492 0l1.942-.832a5 5 0 0 0 3.03-4.596V4.062a.625.625 0 0 0-.624-.625h-.11a7.25 7.25 0 0 1-3.242-.765zm-.963 1.6L8 3.448l.683.341a8.5 8.5 0 0 0 3.286.882v3.724a3.75 3.75 0 0 1-2.273 3.447L8 12.57l-1.696-.727a3.75 3.75 0 0 1-2.273-3.447V4.672a8.5 8.5 0 0 0 3.286-.882"})]})},s=(0,n(340498).wt)("checkmarkShieldSmall",o)},120251:(e,t,n)=>{n.d(t,{k:()=>i});const i=(0,n(340498).xh)("xMark",{default:{loader:()=>n.e(14344).then(n.bind(n,599813))},small:{loader:()=>n.e(14344).then(n.bind(n,995847))},fill:{loader:()=>n.e(14344).then(n.bind(n,297813))},fillSmall:{loader:()=>n.e(14344).then(n.bind(n,563692))}},["close","cross","delete","remove","cancel"])},122555:(e,t,n)=>{n.d(t,{p:()=>o});n(296540);var i=n(474848);const o=(0,n(340498).wt)("arrowUpLeft",{viewBox:"0 0 16 16",directional:!0,svg:(0,i.jsx)("path",{d:"M0.845703 8.58691L0.852539 1.72363C0.852539 1.48665 0.923177 1.29525 1.06445 1.14941C1.21029 0.999023 1.40625 0.923828 1.65234 0.923828H8.51562C8.74349 0.923828 8.93034 0.999023 9.07617 1.14941C9.22201 1.2998 9.29492 1.47526 9.29492 1.67578C9.29492 1.8763 9.21973 2.04948 9.06934 2.19531C8.91895 2.33659 8.74121 2.40723 8.53613 2.40723H6.10254L3.16309 2.30469L4.40723 3.39844L10.915 9.91992C11.0745 10.084 11.1543 10.264 11.1543 10.46C11.1543 10.5921 11.1178 10.7174 11.0449 10.8359C10.972 10.9544 10.8763 11.0479 10.7578 11.1162C10.6439 11.1891 10.5186 11.2256 10.3818 11.2256C10.1813 11.2256 10.0013 11.1481 9.8418 10.9932L3.32715 4.47852L2.21973 3.23438L2.33594 6.05078V8.60742C2.33594 8.8125 2.26302 8.99251 2.11719 9.14746C1.97591 9.29785 1.80273 9.37305 1.59766 9.37305C1.39714 9.37305 1.22168 9.29785 1.07129 9.14746C0.920898 8.99707 0.845703 8.81022 0.845703 8.58691Z"})})},131581:(e,t,n)=>{n.d(t,{Ju:()=>K,en:()=>U,p6:()=>z});n(898992),n(672577),n(814603),n(147566),n(198721);var i=()=>n(242422),o=()=>n(726637),s=()=>n(908006),a=()=>n(700500),r=()=>n(304740),l=()=>n(522419),d=()=>n(651784),c=()=>n(179034),u=()=>n(519831),p=()=>n(869558),g=()=>n(201980),m=()=>n(496603),f=()=>n(559506),h=()=>n(97270),v=()=>n(18387),y=()=>n(943846),b=()=>n(906537),S=()=>n(129522),x=()=>n(110955),A=()=>n(176106),M=()=>n(375447),w=()=>n(261358),j=()=>n(148832),k=()=>n(543665),I=()=>n(913530),C=()=>n(502438),T=()=>n(292167),_=()=>n(437219),P=()=>n(541372),B=()=>n(443120),D=()=>n(896628),R=()=>n(222299),E=()=>n(384944),L=()=>n(391214),O=()=>n(319975),N=()=>n(231297),F=()=>n(62287);function U(e){const t=(0,w().zH)(e);return t instanceof j().B&&void 0!==t.getAssociatedCollectionStore()}function z(e){const{environment:t,textStore:n,url:s,oldTextValue:a,urlSelection:l}=e;if(x().Ay.state.open||h().A.state.open||M().Ay.state.open||A().A.state.open||U(n)&&r().Vp({url:s,baseUrl:o().A.domainBaseUrl,publicDomainName:o().A.publicDomainName}))return;const d=b().get();if(!d)return;const c=b().getRect(d);if(!c)return;const u=()=>{A().A.setState({open:!0,willOpen:!1,loading:!1,textStore:n,url:s,oldTextValue:a,urlSelection:l,selectionRect:c}),_().wQ(t,{url:s})},p=i().default.checkGate({gateName:"mobile_embed_menu_cursor_fix"});!t.device.isTablet&&p?(A().A.setState({open:!1,willOpen:!0,loading:!1}),setTimeout(u,0)):u()}async function K(e){const{environment:t,spaceId:n}=e,i=A().A.state;if(i.open){const{url:h,textStore:b,oldTextValue:x}=i,M=C().default.state.stores,w=M[0];if(!w)return;const U=(0,l().Zv)(h)||(0,l().ku)(h,o().A.secureFileConfig.hostname),z=U?(0,l().xm)(U):h,K=(0,d().parseRoute)({url:z,baseUrl:o().A.domainBaseUrl,publicDomainName:o().A.publicDomainName,isMobile:Boolean(o().A.isMobile),protocol:o().A.protocol,currentUrl:window.location.href});if((0,d().Jx)(K))await N().createAndCommitAsync({environment:t,userAction:"embedMenuActions.embedPageAlias",waitForServerCommit:!1,perform:async n=>{let o;if(O().R9({environment:t,store:b,value:x,transaction:n}),K.peekViewBlockId){const e=j().B.createChildStore(b,{table:c().ev,id:K.peekViewBlockId});await e.load(),e.isPageBlock()&&(o=e)}if(!o&&"page"===K.name&&K.blockId&&(o=j().B.createChildStore(b,{table:c().ev,id:K.blockId})),o){const r="page"===K.name?K.scrollToBlockId:void 0,l="page"===K.name?K.collectionViewId:void 0;if("mention-page"===e.type){const e=o.getRecordModel({id:o.id,table:c().ev});O().Gf({environment:t,editorMode:"default",store:b,selection:{startIndex:i.urlSelection.startIndex,endIndex:i.urlSelection.startIndex},annotation:g().ld4(r??o.id,null==e?void 0:e.space_id),transaction:n,analyticsFrom:"block"})}else if("create-transclusion"===e.type){if(!r)return;P().Ce({environment:t,blocks:C().default.state.stores,copiedBlockIds:[r]})}else if(o.isCollectionView()){var a;const e=l?I().p.createChildStore(o,{table:p().Gy,id:l}):void 0;await Promise.all([o.load(),e?e.load():void 0]);const i=e?e.getCollectionStore():null===(a=o.getCollectionViewStores())||void 0===a||null===(a=a[0])||void 0===a?void 0:a.getCollectionStore();i&&(await i.load(),R().oT({environment:t,store:w,collectionStore:i,collectionViewStore:e,transaction:n}))}else{const i=w.getParentBlockStore();if(i){const s=T().s({environment:t,parentBlockStore:i,targetStore:o,transaction:n});L().LE({environment:t,blocksToInsert:[s],target:M,transaction:n,replaceEmptyTextBlock:!0}),"form"===e.type&&(C().default.reset(),_().ol(t,{url:h,type:e.type,form_id:o.id,block_id:s.id}))}}s().default.afterNextFlush((()=>{N().createAndCommit({userAction:"embedMenuActions.accept",environment:t,canUndo:!0,perform:e=>{L().um({blocks:M,transaction:e})}})}))}}});else if("collection"===K.name){if("mention-page"===e.type)N().createAndCommit({environment:t,canUndo:!0,userAction:"embedMenuActions.embedCollectionMention",perform:e=>{O().R9({environment:t,store:b,value:x,transaction:e});const n=K.space&&"id"in K.space?K.space.id:void 0;O().Gf({environment:t,editorMode:"default",store:b,selection:{startIndex:i.urlSelection.startIndex,endIndex:i.urlSelection.startIndex},annotation:g().ETy({collectionId:K.collectionId,spaceId:n,parentCvbId:K.parentBlockId}),transaction:e,analyticsFrom:"collection"})}});else if(e.type===a().xd.collectionView){const e=K.space&&"id"in K.space?K.space.id:w.getSpaceId(),n=k().m.createChildStore(b,{table:u().Vl,id:K.collectionId,spaceId:e});await n.load(),n.isDefined()&&N().createAndCommit({environment:t,canUndo:!0,userAction:"embedMenuActions.embedCollectionLinkedView",perform:e=>{O().R9({environment:t,store:b,value:x,transaction:e}),R().oT({environment:t,store:w,collectionStore:n,collectionViewStore:void 0,transaction:e})}})}}else if(e.type===a().xd.bookmark||"teamsInvite"===K.name){const{performResult:e}=N().createAndCommit({userAction:"embedMenuActions.insertedBlocks",environment:t,canUndo:!0,perform:e=>{var n;O().R9({environment:t,store:b,value:x,transaction:e});const i=E().Wv({environment:t,type:a().xd.bookmark,inMemoryRecordCache:w.inMemoryRecordCache,transaction:e,spaceId:0!==M.length?M[M.length-1].pointer.spaceId:null===(n=(0,v().Z)())||void 0===n?void 0:n.pointer.spaceId}),o=L().LE({environment:t,blocksToInsert:[i],target:M,transaction:e,replaceEmptyTextBlock:!0});return D().zA({stores:[i],transaction:e,update:{bookmark_loading_ttl:Date.now()}}),o}});s().default.afterNextFlush((()=>{N().createAndCommit({userAction:"embedMenuActions.accept",environment:t,canUndo:!0,perform:e=>{L().um({blocks:M,transaction:e})}})}));const n=e[0];"teamsInvite"===K.name?await B().Ht({environment:t,store:n,url:h,teamId:K.teamId}):await B().Ht({environment:t,store:n,url:h})}else if(e.type===a().xd.drive){const{performResult:e}=N().createAndCommit({userAction:"embedMenuActions.insertedBlocks",environment:t,canUndo:!0,perform:e=>{var n;O().R9({environment:t,store:b,value:x,transaction:e});const i=E().Wv({environment:t,type:a().xd.drive,inMemoryRecordCache:w.inMemoryRecordCache,transaction:e,spaceId:0!==M.length?M[M.length-1].pointer.spaceId:null===(n=(0,v().Z)())||void 0===n?void 0:n.pointer.spaceId});return L().LE({environment:t,blocksToInsert:[i],target:M,transaction:e,replaceEmptyTextBlock:!0})}});s().default.afterNextFlush((()=>{N().createAndCommit({userAction:"embedMenuActions.accept",environment:t,canUndo:!0,perform:e=>{L().um({blocks:M,transaction:e})}})}));const n=e[0];s().default.afterNextFlush((()=>{const e=S().K.find((e=>e.getBlockStore()===n));e&&e.initializeGoogleDriveBlockFromUrl(h)}))}else if("link-mention"===e.type){A().A.setState({open:!1,willOpen:!1,loading:!0});const e=await f().callApi({eventName:"getDataForLinkMention",environment:t,data:{url:z,spaceId:n,source:"link_mention_activate"}});if("success"===e.type){const n=e.data;if("error"in n){const e=g().wmz(g().gru({href:h,title:h.includes("mailto:")?h:new URL(h).hostname}));N().createAndCommit({environment:t,userAction:"embedMenuActions.mention",canUndo:!0,perform:n=>{O().jQ({environment:t,store:b,selection:{startIndex:i.urlSelection.startIndex,endIndex:i.urlSelection.endIndex},transaction:n}),O().yr({environment:t,store:b,tokens:[e],index:i.urlSelection.startIndex,transaction:n})}}),_().vt(t,{domain:h.includes("mailto:")?h:new URL(h).hostname})}else{var r;const{title:e,description:o,author_name:s,provider_name:a,images:l,favicon_url:d,iframe:c,height:u,padding:p,padding_top:m}=n,f=g().wmz(g().gru({href:h,title:e||(a||new URL(h).hostname),description:o,link_author:s,link_provider:a,thumbnail_url:l&&l.length>0?null===(r=l[0])||void 0===r?void 0:r.url:void 0,icon_url:d,iframe_url:h.includes("nytimes.com")?void 0:c,height:u,padding:p,padding_top:m}));N().createAndCommit({environment:t,userAction:"embedMenuActions.mention",canUndo:!0,perform:e=>{O().jQ({environment:t,store:b,selection:{startIndex:i.urlSelection.startIndex,endIndex:i.urlSelection.endIndex},transaction:e}),O().yr({environment:t,store:b,tokens:[f],index:i.urlSelection.startIndex,transaction:e})}})}}else{const e=g().wmz(g().gru({href:h,title:h.includes("mailto:")?h:new URL(h).hostname}));N().createAndCommit({environment:t,userAction:"embedMenuActions.mention",canUndo:!0,perform:n=>{O().jQ({environment:t,store:b,selection:{startIndex:i.urlSelection.startIndex,endIndex:i.urlSelection.endIndex},transaction:n}),O().yr({environment:t,store:b,tokens:[e],index:i.urlSelection.startIndex,transaction:n})}}),_().vt(t,{domain:h.includes("mailto:")?h:new URL(h).hostname})}}else{const{performResult:n}=N().createAndCommit({userAction:"embedMenuActions.insertedBlocks",environment:t,canUndo:!0,perform:e=>{var n;O().R9({environment:t,store:b,value:x,transaction:e});const i=E().Wv({environment:t,type:a().xd.copyIndicator,inMemoryRecordCache:w.inMemoryRecordCache,transaction:e,spaceId:0!==M.length?M[M.length-1].pointer.spaceId:null===(n=(0,v().Z)())||void 0===n?void 0:n.pointer.spaceId});return L().LE({environment:t,blocksToInsert:[i],target:M,transaction:e,replaceEmptyTextBlock:!0})}});s().default.afterNextFlush((()=>{N().createAndCommit({userAction:"embedMenuActions.accept",environment:t,canUndo:!0,perform:e=>{L().um({blocks:M,transaction:e})}})}));const i=n[0],o=n=>{N().createAndCommit({environment:t,userAction:"embedMenuActions.accept.insertExtractedData",canUndo:!0,perform:t=>{let o;e.type&&"mention-page"!==e.type&&"create-transclusion"!==e.type&&"link-mention"!==e.type&&"jira-sync"!==e.type?o=e.type:(o=a().xd.embed,null!=n&&n.media&&("photo"===n.media.type?o=a().xd.image:"video"===n.media.type&&(o=a().xd.video))),F().pd({environment:e.environment,block:i,blockType:o,transaction:t})}}),s().default.afterNextFlush((()=>{const e=S().K.find((e=>e.getBlockStore()===i&&m().Tn(e.embed)));e&&e.embed({originUrl:z,pastedSecureFile:U})}))};y().DB(t,z).then(o)}}(0,A().V)()}},134738:(e,t,n)=>{n.r(t),n.d(t,{ShareMenuContainer:()=>co});var i=n(296540),o=()=>n(726637),s=()=>n(484714),a=()=>n(56366),r=()=>n(401497),l=()=>n(179034),d=()=>n(69708),c=()=>n(778417),u=()=>n(749804),p=()=>n(805751),g=()=>n(404277),m=()=>n(45552),f=()=>n(125565),h=()=>n(64901),v=()=>n(38337),y=()=>n(722872),b=()=>n(232930),S=()=>n(645873),x=()=>n(369955),A=()=>n(646736),M=()=>n(131448),w=()=>n(146842),j=()=>n(284371),k=()=>n(987017),I=()=>n(115512),C=()=>n(117183),T=()=>n(343001),_=()=>n(463830),P=n(474848);function B(e){const{store:t,calculatedPermissions:n,permissionItemArgs:i,onClose:o}=e,l=(0,s().Y0)(),c=(u=l.isMobile,(0,r().IS)((e=>({title:{fontSize:16},topbarStyle:{paddingTop:15,paddingBottom:15,height:"auto",background:u?e.background.primary:void 0}})),[u]));var u;const h=(0,a().uB)(void 0,_().A),b=l.isMobile?{menuType:y().gu.Modal,disableHeaderShadow:!0,title:(0,P.jsx)(f().A,{isMobile:l.isMobile,style:c.title,children:(0,P.jsx)(d().sA,{defaultMessage:"Share",id:"loggedOutShareMenu.title"})}),topbarStyle:c.topbarStyle,right:(0,P.jsx)(m().DoneMenuText,{}),onClickRight:o,whiteBackground:!0}:{menuType:y().gu.Popup,maxHeight:"90vh"};return(0,P.jsx)(g().A,{...b,className:v().NXe,children:(0,P.jsx)(p().A,{debugName:"LoggedOutShareMenuContainer",capture:!0,allowEsc:!0,children:(0,P.jsx)(D,{store:t,isMobile:l.isMobile,calculatedPermissions:n,permissionItemArgs:i,buttonPopupStore:h})})})}function D({store:e,isMobile:t,calculatedPermissions:n,permissionItemArgs:o,buttonPopupStore:a}){const l=(0,s().v3)(),p=function(e){const t=(0,s().v3)();return(0,r().IS)((n=>({tabStyle:{color:n.text.tertiary,...e&&{width:"50%",textAlign:"center"}},selectedTabStyle:{fontWeight:j().Wy.medium},tabTitleStyle:{color:"inherit",fontSize:(0,I().ny)(t,"UIRegular"),fontWeight:j().Wy.medium},style:e?{marginBottom:8,justifyContent:"space-between"}:{marginBottom:16,paddingInlineStart:16},tabBorderStyle:{insetInlineStart:0,insetInlineEnd:0}})),[t,e])}(t),g=[(0,P.jsx)(i.Fragment,{children:(0,P.jsx)(d().sA,{defaultMessage:"Share",id:"shareMenu.shareTab.title"},"share")},"title")];return(0,i.useEffect)((()=>{c().IU({environment:l}),(0,u().I)({environment:l})}),[l]),(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(k().Ay,{...p,tabs:g,selectedIndex:0,onChange:()=>{}}),(0,P.jsx)(T().GeneralAccessPermissionSection,{store:e,calculatedPermissions:n,permissionItemArgs:o}),(0,P.jsx)(C().A,{store:e,buttonPopupStore:a,calculatedPermissions:n,permissionItemArgs:o})]})}var R=()=>n(326589),E=()=>n(315841),L=()=>n(159026),O=()=>n(103674),N=()=>n(726360),F=()=>n(928074),U=()=>n(437487),z=()=>n(134696),K=()=>n(495867),V=()=>n(534177),q=()=>n(475355);async function W(e,t,n,i,o){if(o.state.inviteStage===L().d5.closed||o.state.inviteStage===L().d5.share_page)return;const{selection:s}=o.state;switch(s){case L().NJ.request_workspace_member:z().RH(e,{...K().nE(e,o),from:"share_menu"}),await K().xi({environment:e,spaceStore:t,originId:n.id,originType:"share_menu",reasonMessage:void 0,contextualInviteStore:o,intl:i});break;case L().NJ.workspace_member:z()._u(e,K().nE(e,o));const a=o.state.invitedUsers.length>0;if(!t.isTeamsEnabled()&&a){o.setState({...o.state,inviteStage:L().d5.closed});if(!(await q().oH({environment:e,flowId:o.state.flowId??"",trackCreateTeamComplete:!1})))return}await K().Lg({environment:e,spaceStore:t,contextualInviteStore:o,from:"page_contextual_invite",intl:i});break;case L().NJ.page_guest:case L().NJ.unselected:case L().NJ.closed:z().l8(e,K().nE(e,o)),o.reset();break;default:(0,V().HB)(s)}}n(581454);var G=()=>n(699143),H=()=>n(252291),Y=()=>n(406094),$=()=>n(493552),Q=()=>n(575157),Z=()=>n(90907),J=()=>n(835607),X=()=>n(792071),ee=()=>n(798880),te=()=>n(581495),ne=()=>n(694894),ie=()=>n(340498);const oe={viewBox:"0 0 16 16",fittedViewBox:"3.37 2.12 9.25 11.75",svg:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("path",{d:"M5.75 8.675a.575.575 0 1 0 0 1.15h4.5a.575.575 0 1 0 0-1.15zm0 2a.575.575 0 0 0 0 1.15h4.5a.575.575 0 1 0 0-1.15z"}),(0,P.jsx)("path",{d:"M5.125 2.125a1.75 1.75 0 0 0-1.75 1.75v8.25c0 .966.784 1.75 1.75 1.75h5.75a1.75 1.75 0 0 0 1.75-1.75V6.591c0-.464-.184-.91-.513-1.237L9.396 2.638a1.75 1.75 0 0 0-1.237-.513zm-.5 1.75a.5.5 0 0 1 .5-.5h2.604v1.831c0 .98.794 1.775 1.775 1.775h1.871v5.144a.5.5 0 0 1-.5.5h-5.75a.5.5 0 0 1-.5-.5zm4.254 1.331V3.888l1.944 1.943h-1.32a.625.625 0 0 1-.624-.625"})]})};(0,ie().wt)("pageSmall",oe);var se=()=>n(453697);function ae({users:e}){const t=(0,r().IS)((e=>({avatarsContainer:{marginInlineStart:"16px",display:"flex"},avatarWrapper:{marginInlineStart:"-16px"},upgradeWrapper:{alignSelf:"end",marginInlineStart:"-14px",borderRadius:"50%",background:e.background.secondary}})),[]);return(0,P.jsxs)("div",{style:t.avatarsContainer,children:[e.slice(0,10).map(((e,n)=>(0,P.jsx)("div",{style:t.avatarWrapper,children:(0,P.jsx)(se().A,{userValue:e,size:40})},n))),(0,P.jsx)("div",{style:t.upgradeWrapper,children:(0,P.jsx)(H().I,{icon:ne().arrowInCircleUpFillSmallIcon,size:"sm",colorPalette:"blue",colorVariant:"accentPrimary",fitToViewBox:"all"})})]})}function re(e){const{guestEmails:t,spaceStore:n,contextualInviteStore:i,blockStore:o,paysPerSeat:l}=e,c=(0,s().v3)(),u=(0,d().tz)(),p=(0,a().K8)((()=>i.state.inviteStage===L().d5.request_workspace),[i]),g=(0,a().K8)((()=>t.map((e=>{const t=i.state.invitedEmailToUserIdMap[e];return X().Bj6.fromValue(ee().oo,{id:t,email:e,version:1})}))),[i,t]),m=(0,r().IS)((e=>({cta:{flex:1},facepileContainer:{display:"flex",justifyContent:"center"}})),[]);return(0,P.jsxs)("div",{className:v().NXe,children:[(0,P.jsx)(te().Rz,{onClick:()=>i.reset()}),(0,P.jsxs)(G().Y1,{padding:"24px 22px 18px 22px",gap:24,children:[(0,P.jsxs)(G().Y1,{gap:20,children:[(0,P.jsx)("div",{style:m.facepileContainer,children:(0,P.jsx)(ae,{users:g})}),(0,P.jsxs)(G().Y1,{gap:8,children:[(0,P.jsx)($().D,{styleKey:"Title-sm/Semibold",children:(0,P.jsx)(d().sA,{id:"ContextualInvite.variantD.header",defaultMessage:"{inviteCount, plural, one {Upgrade guest to member?} other {Upgrade {inviteCount} guests to members?}}",values:{inviteCount:t.length}})}),(0,P.jsxs)(G().Y1,{gap:20,children:[(0,P.jsx)($().D,{styleKey:"Body/Regular",colorVariant:"secondary",children:l?p?(0,P.jsx)(d().sA,{id:"ContextualInvite.variantD.description.request",defaultMessage:"{otherInviteCount, plural, =0 {{firstGuest} will have access to these features.} one {{firstGuest} and 1 other will have access to these features.} other {{firstGuest} and {otherInviteCount} others will have access to these features.}} A workspace admin will review your request.",values:{firstGuest:t[0],otherInviteCount:t.length-1}}):(0,P.jsx)(d().sA,{id:"ContextualInvite.variantD.description",defaultMessage:"{otherInviteCount, plural, =0 {{firstGuest} will have access to these features} one {{firstGuest} and 1 other will have access to these features} other {{firstGuest} and {otherInviteCount} others will have access to these features}} and {totalInviteCount, plural, one {this workspace will be billed for 1 member} other {this workspace will be billed for {totalInviteCount} members}}",values:{firstGuest:t[0],totalInviteCount:t.length,otherInviteCount:t.length-1}}):(0,P.jsx)(d().sA,{id:"ContextualInvite.variantD.description.free",defaultMessage:"{otherInviteCount, plural, =0 {{firstGuest} will have access to these features} one {{firstGuest} and 1 other will have access to these features} other {{firstGuest} and {otherInviteCount} others will have access to these features}}",values:{firstGuest:t[0],otherInviteCount:t.length-1}})}),(0,P.jsxs)(G().Y1,{gap:14,children:[(0,P.jsxs)(G().Y1,{gap:8,direction:"horizontal",align:"center-left",children:[(0,P.jsx)(H().I,{icon:Z().h,colorVariant:"secondary"}),(0,P.jsx)($().D,{styleKey:"Body/Regular",children:(0,P.jsx)(d().sA,{id:"ContextualInvite.variantD.memberBenefits.private",defaultMessage:"Create private pages and drafts"})})]}),(0,P.jsxs)(G().Y1,{gap:8,direction:"horizontal",align:"center-left",children:[(0,P.jsx)(H().I,{icon:Q().D,colorVariant:"secondary"}),(0,P.jsx)($().D,{styleKey:"Body/Regular",children:(0,P.jsx)(d().sA,{id:"ContextualInvite.variantD.memberBenefits.public",defaultMessage:"Access all public pages in the workspace"})})]}),(0,P.jsxs)(G().Y1,{gap:8,direction:"horizontal",align:"center-left",children:[(0,P.jsx)(H().I,{icon:J().F,colorVariant:"secondary"}),(0,P.jsx)($().D,{styleKey:"Body/Regular",children:(0,P.jsx)(d().sA,{id:"ContextualInvite.variantD.memberBenefits.collaboration",defaultMessage:"Unlimited collaboration with others"})})]})]})]})]})]}),(0,P.jsxs)(G().Y1,{direction:"horizontal",gap:10,children:[(0,P.jsx)(Y().A,{size:"lg",style:m.cta,onClick:async()=>{!function(e){e.setState({...e.state,selection:L().NJ.page_guest})}(i),await W(c,n,o,u,i)},children:(0,P.jsx)(d().sA,{id:"contextualInvite.skip.button",defaultMessage:"Skip for now"})}),(0,P.jsx)(Y().A,{size:"lg",style:m.cta,onClick:async()=>{i.state.inviteStage===L().d5.share_workspace&&function(e){e.setState({...e.state,selection:L().NJ.workspace_member})}(i),i.state.inviteStage===L().d5.request_workspace&&function(e){e.setState({...e.state,selection:L().NJ.request_workspace_member})}(i),await W(c,n,o,u,i)},children:p?(0,P.jsx)(d().sA,{id:"ContextualInvite.variantD.request",defaultMessage:"Request upgrade"}):(0,P.jsx)(d().sA,{id:"ContextualInvite.variantD.upgrade",defaultMessage:"Upgrade to member"})})]})]})]})}function le(e){const{spaceStore:t,blockStore:i}=e,o=(0,s().v3)(),r=(0,n(324561).lh)({spaceId:t.id}),l=(0,a().K8)((()=>(0,n(37433).L3)(o,r)),[o,r]),d=(0,a().uB)(e.contextualInviteStore,L().Ay),c=n(762433).OK(r),u=(0,a().K8)((()=>d.getGuestEmails()),[d]),p=(0,a().K8)((()=>(0,n(78846).h)(t)),[t]);return(0,n(852507).l)((()=>{!function(e,t){t&&e.setState({...e.state,selection:L().NJ.page_guest})}(d,l),z().bT(o,K().nE(o,d))})),u.length?(0,P.jsx)(re,{contextualInviteStore:d,spaceStore:t,blockStore:i,useZeroTeamsExperience:l,paysPerSeat:c,guestEmails:u,useGuestInviteRequestExperience:p}):null}const de=i.memo(le);const ce={viewBox:"0 0 20 20",fittedViewBox:"1.94 3.32 16.21 13.33",svg:(0,P.jsx)("path",{d:"M10.064 14.15a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5M4.607 3.458a.55.55 0 0 1 .776.06l.23.267.004.007 8.769 10.23a.55.55 0 0 1-.839.712l-2.63-3.067a3.82 3.82 0 0 0-3.561 1.026.626.626 0 0 1-.885-.885 5.07 5.07 0 0 1 3.299-1.48L8.385 8.712a6.9 6.9 0 0 0-3.194 1.816.626.626 0 0 1-.885-.885 8.16 8.16 0 0 1 3.188-1.97L6.237 6.206A10 10 0 0 0 2.987 8.4a.626.626 0 0 1-.888-.879 11.3 11.3 0 0 1 3.29-2.305l-.842-.982a.55.55 0 0 1 .06-.776m5.456 3.797c2.246 0 4.283.915 5.756 2.388a.626.626 0 0 1-.883.885 6.9 6.9 0 0 0-3.748-1.93l-1.152-1.343zm0-3.063c3.09 0 5.894 1.258 7.922 3.286a.626.626 0 0 1-.884.884 9.93 9.93 0 0 0-8.523-2.808l-.94-1.095a11 11 0 0 1 2.425-.267"})},ue=(0,ie().wt)("wifiSlash",ce);var pe=()=>n(529183),ge=()=>n(95001),me=()=>n(962277);function fe(e){const{store:t,mostPermissivePublicItem:n,permissionItemArgs:i}=e,{permissionItem:o}=n;return(0,a().K8)((()=>(0,me().W)(o)),[o])?(0,P.jsx)(E().d,{store:t,mostPermissivePublicItem:n,sudoModeStore:i.sudoModeStore,location:i.location,showManageAllDomains:!0,showAllPublishedSites:!0,shouldAskForConfirmationOnPublish:!1}):(0,P.jsx)(E().Js,{store:t,mostPermissivePublicItem:n,sudoModeStore:i.sudoModeStore,location:i.location})}n(898992),n(354520);var he=()=>n(59226),ve=()=>n(998531),ye=()=>n(842599),be=()=>n(196131),Se=()=>n(84262),xe=()=>n(792223),Ae=()=>n(366858),Me=()=>n(535279),we=()=>n(422366),je=()=>n(765957),ke=()=>n(970585),Ie=()=>n(242422);function Ce(e){const{featureGateId:t,whenEnabled:n,whenDisabled:i,disableExposureLogging:o}=e,s=function(e){const{featureGateId:t,disableExposureLogging:n}=e;return(0,a().K8)((()=>Ie().default.checkGate({gateName:t,disableExposureLogging:n})),[t,n])}({featureGateId:t,disableExposureLogging:o});return s?n:i}var Te=()=>n(329304),_e=()=>n(616092);function Pe(e){const{type:t}=e;switch(t){case"newUser":case"existingUser":return e.value.email;case"invalidUser":case"group":return;default:(0,V().HB)(t)}}var Be=()=>n(623275);var De=()=>n(532940);function Re(){const e=(0,s().v3)(),t=o().A.isMobile,n=(0,r().IS)((n=>({banner:{...(0,Be().kJ)({theme:n,isMobile:t}),display:"flex",flexDirection:"row",alignItems:"flex-start",gap:8,backgroundColor:n.red.background.secondary},content:{display:"flex",alignItems:"flex-start",gap:2,flex:"1 0 0"},label:{fontSize:(0,I().ny)(e,"UIRegular"),lineHeight:"20px",color:n.red.text.secondary,flex:"1 0 0",paddingInlineStart:4},iconContainer:{paddingTop:2,height:20,width:20,display:"flex",alignItems:"center",justifyContent:"center"},icon:{fill:n.red.icon.secondary}})),[e,t]);return(0,P.jsx)("div",{style:n.banner,children:(0,P.jsxs)("div",{style:n.content,children:[(0,P.jsx)("div",{style:n.iconContainer,children:(0,P.jsx)(H().I,{icon:De().exclamationMarkTriangleIcon,style:n.icon})}),(0,P.jsx)(f().A,{style:n.label,isMultiline:!0,children:(0,P.jsx)(d().sA,{id:"agentProfileShareWarning.description",defaultMessage:"When you share access to this page, others can update this profile and influence your Notion AIâ€™s behavior"})})]})})}var Ee=()=>n(124092),Le=()=>n(343247),Oe=()=>n(529601),Ne=()=>n(622963),Fe=()=>n(751735),Ue=()=>n(460292),ze=()=>n(586880),Ke=()=>n(404141),Ve=()=>n(408095),qe=()=>n(749240);function We(e){const{spaceId:t,userId:n,spaceModel:i,spaceUserModel:o,teamModel:s,domains:l,blockStore:c}=e,u=(0,d().tz)(),p=(0,Te()._X)({name:"internal_guests",spaceId:t,userId:n,amount:1}),g=(0,ze().o)({store:c}),m=(0,Te().P9)({name:"non_admin_members",spaceId:t,userId:n}),f=(0,r().IS)((e=>{const t=p&&!(0,Se().e2)(p),n=t?20:5,i=t?e.palette.orange[100]:"transparent",o=t?e.palette.orange[400]:e.blue.background.accentPrimary;return{container:{borderImage:`repeating-linear-gradient(-45deg, ${i}, ${i} ${n}px, ${o} ${n}px, ${o} ${2*n}px) 5 0`,borderWidthTop:4,borderWidthInlineEnd:0,borderWidthBottom:0,borderWidthInlineStart:0,borderStyle:"solid",background:t?(0,Fe().X4)(e.palette.orange[400],.15):(0,Fe().X4)(e.blue.background.accentPrimary,.15),position:"relative",padding:10,zIndex:5},fill:{background:e.background.elevated,border:`1px solid ${e.border.secondary}`},button:{height:"auto",width:"calc(100% + 16px)",padding:8,margin:-8}}}),[p]),h=(0,a().K8)((()=>{var e;const t=(0,Ne()._y)((null===(e=qe().subscriptionDataStoreInstance.state)||void 0===e?void 0:e.subscriptionTier)??"free");return Ve().qY[t].label}),[]),v=(0,a().K8)((()=>null==o?void 0:o.isWorkspaceOwner()),[o]),y=(0,a().K8)((()=>null==o?void 0:o.isMember()),[o]);let b;b=v?"You are a workspace owner":y?"You are a member":"You are a guest";const S=(0,a().K8)((()=>[{label:"Allow members to invite guests to pages",isEnabled:!!i&&i.getDisableGuests()},{label:"Allow members to request adding guests",isEnabled:(null==i?void 0:i.getSettings().enable_guest_invite_requests)??!1},{label:"Allow members to request adding other members",isEnabled:!(null!=i&&i.getSettings().disable_membership_requests)}]),[i]),x=(0,a().K8)((()=>[{label:"Disable guests",isEnabled:(null==s?void 0:s.getSettings().disable_guests)??!1}]),[s]),A=(0,a().K8)((()=>{if(!i||!l||!o)return;const{autojoinDomains:e}=(0,Oe().SJ)({space:i,spaceUser:o,domains:l});return e}),[i,o,l]),M=(0,a().K8)((()=>{if(!i||!o)return;const{type:e}=(0,Oe().yQ)({space:i,spaceUser:o,team:s,publicPageDataGuestSetting:g});switch(e){case"can_add":return"You can add guests.";case"can_request":return"You can request to add guests.";case"cannot_add":return"You can't add or request to add guests.";default:(0,V().HB)(e)}}),[i,o,s,g]),w=(0,a().K8)((()=>{if(!i||!l||!o)return;const{type:e}=(0,Oe().SJ)({space:i,spaceUser:o,domains:l});switch(e){case"can_add":return"You can add members.";case"can_request":return"You can request to add members.";case"cannot_add":return"You can't add or request to add members.";default:(0,V().HB)(e)}}),[i,o,l]),j=(0,a().K8)((()=>{if(!i||!o||!l)return!1;return"can_add"===(0,Oe().SJ)({space:i,spaceUser:o,domains:l}).type}),[i,o,l]),k=(0,a().K8)((()=>{if(!p)return;const e=p.type;switch(e){case"available":return"You can add an internal guest.";case"unavailable":return j?m?"Internal guests will be added to the space with member access.":"Internal guests will be added to the space with workspace owner access.":"You can't add internal guests.";default:(0,V().HB)(e)}}),[p,m,j]),I=(0,a().K8)((()=>{if(!p)return"Guest limit data is unavailable";if("cumulative"===p.limit.type){const{current:e,total:t}=p.limit;return"unlimited"===t?"No guest limit":`Space has ${e} of ${t} guests`}}),[p]),C=e=>{Ke().A.setState({open:!0,openedFrom:"misc",currentTab:e,defaultSubtab:void 0,highlightedSetting:void 0})};return(0,P.jsxs)(G().Y1,{gap:10,style:f.container,children:[(0,P.jsxs)(G().Y1,{gap:12,borderRadius:6,padding:10,style:f.fill,children:[(0,P.jsx)(Ee().p,{onClick:()=>C("security"),style:f.button,children:(0,P.jsxs)(G().Y1,{gap:4,children:[(0,P.jsx)($().D,{styleKey:"Caption/Medium",children:"Space security settings"}),S.map(((e,t)=>(0,P.jsxs)(G().Y1,{direction:"horizontal",gap:4,align:"center-left",children:[(0,P.jsx)(Ge,{isEnabled:e.isEnabled}),(0,P.jsx)($().D,{colorVariant:e.isEnabled?"secondary":"tertiary",styleKey:"Caption/Regular",children:e.label})]},t)))]})}),(0,P.jsxs)(G().Y1,{gap:4,children:[(0,P.jsx)($().D,{styleKey:"Caption/Medium",children:"Team security settings"}),x.map(((e,t)=>(0,P.jsxs)(G().Y1,{direction:"horizontal",gap:4,align:"center-left",children:[(0,P.jsx)(Ge,{isEnabled:e.isEnabled}),(0,P.jsx)($().D,{colorVariant:e.isEnabled?"secondary":"tertiary",styleKey:"Caption/Regular",children:e.label})]},t)))]}),(0,P.jsx)(Ee().p,{onClick:()=>C("billing"),style:f.button,children:(0,P.jsxs)(G().Y1,{gap:4,children:[(0,P.jsx)($().D,{styleKey:"Caption/Medium",children:"Subscription"}),(0,P.jsx)($().D,{styleKey:"Caption/Regular",colorVariant:"secondary",children:`${u.formatMessage(h)} plan`}),(0,P.jsx)($().D,{colorVariant:"secondary",styleKey:"Caption/Regular",children:I})]})}),(0,P.jsx)(Ee().p,{onClick:()=>C("settings"),style:f.button,children:(0,P.jsxs)(G().Y1,{gap:4,children:[(0,P.jsx)($().D,{styleKey:"Caption/Medium",children:"Allowed email domains"}),null==A?void 0:A.map((e=>(0,P.jsx)($().D,{styleKey:"Caption/Regular",colorVariant:"secondary",children:e},e))),0===(null==A?void 0:A.length)?(0,P.jsx)($().D,{styleKey:"Caption/Regular",colorVariant:"secondary",children:"None"}):void 0]})})]}),(0,P.jsxs)(G().Y1,{gap:4,borderRadius:6,padding:10,style:f.fill,children:[(0,P.jsx)($().D,{styleKey:"Caption/Medium",children:b}),(0,P.jsx)($().D,{styleKey:"Caption/Regular",colorVariant:"secondary",children:w}),(0,P.jsx)($().D,{styleKey:"Caption/Regular",colorVariant:"secondary",children:M}),(0,P.jsx)($().D,{styleKey:"Caption/Regular",colorVariant:"secondary",children:k})]})]})}function Ge(e){const{isEnabled:t}=e,n=(0,r().IS)((e=>({circle:{width:10,height:10,borderRadius:"50%",border:`1px solid ${e.icon.quaternary}`}})),[]);return t?(0,P.jsx)(Ue().Q,{iconGroup:Le().d,variantName:"mini",colorVariant:"secondary"}):(0,P.jsx)(G().Y1,{width:14,height:14,align:"center",children:(0,P.jsx)("div",{style:n.circle})})}var He=()=>n(611648),Ye=()=>n(617871),$e=()=>n(2143),Qe=()=>n(549200),Ze=()=>n(53137),Je=()=>n(321172),Xe=()=>n(456328),et=()=>n(623580);function tt(e){const{shouldShowLengthWarning:t,shouldShowLinkWarning:n,value:i,maxLength:o}=e,s=(0,r().IS)((e=>({container:{position:"absolute",top:0,display:"flex",justifyContent:"center",fontSize:12,color:e.text.tertiary,width:"100%"},warning:{display:"flex",justifyContent:"center",width:"calc(100% - 36px)",backgroundColor:e.background.elevated,marginTop:1}})),[]);return(0,P.jsx)("div",{style:s.container,children:(0,P.jsxs)("div",{style:s.warning,children:[t?(0,P.jsx)(d().sA,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:i.length,maxCharacters:o}}):void 0,t&&n?" Â· ":void 0,n?(0,P.jsx)(d().sA,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"}):void 0]})})}const nt=100;function it(e){const{open:t,focus:n,value:i,maxLength:o,onFocus:s,onChange:a,onCancel:l}=e,c=(0,d().tz)(),u=i.length/o>=.8,p=(0,Xe().BS)(i),g=u||p,m=(0,r().IS)((e=>({container:{maxHeight:t?nt:0,position:"absolute",bottom:0,width:"100%",backgroundColor:e.background.elevated,pointerEvents:t?"all":"none",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",overflow:"hidden",zIndex:1},input:{maxHeight:t?100:0,borderTop:1,borderTopStyle:"solid",borderTopColor:e.regularDividerColor,padding:18,fontSize:14,transitionProperty:"max-height",transitionDuration:"0.3s"}})),[t]),f=c.formatMessage({id:"shareMenu.emailMessageInput.placeholder",defaultMessage:"Add a message to your invite..."});return(0,P.jsxs)("div",{style:m.container,children:[g?(0,P.jsx)(tt,{value:i,maxLength:o,shouldShowLengthWarning:u,shouldShowLinkWarning:p}):void 0,(0,P.jsx)(et().A,{textarea:!0,focusInitial:!1,format:et().C.Transparent,placeholder:f,maxlength:o,focus:n,value:i,onFocus:s,onChange:a,inputStyle:m.input,onCancel:l})]})}n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(672577),n(803949),n(737550);var ot=()=>n(373009),st=()=>n(187174);const at={viewBox:"0 0 16 16",fittedViewBox:"3.66 3.66 8.68 8.68",directional:!0,svg:(0,P.jsx)("path",{d:"M4.288 3.663a.625.625 0 0 0-.625.625v6.109a.625.625 0 1 0 1.25 0v-4.6l6.368 6.368c.24.24.63.232.873-.01a.62.62 0 0 0 .01-.874L5.797 4.913h4.601a.625.625 0 1 0 0-1.25z"})},rt=(0,ie().wt)("arrowDiagonalUpLeftSmall",at);var lt=()=>n(97835),dt=()=>n(889154),ct=()=>n(68263),ut=()=>n(778078),pt=()=>n(980427),gt=()=>n(542056),mt=()=>n(760217),ft=()=>n(406699),ht=()=>n(939740),vt=()=>n(64e3),yt=()=>n(417392),bt=()=>n(89924),St=()=>n(859428),xt=()=>n(267155),At=()=>n(748868),Mt=()=>n(42648),wt=()=>n(743260),jt=()=>n(423657),kt=()=>n(477293),It=()=>n(17281),Ct=()=>n(618841),Tt=()=>n(787766),_t=()=>n(423817),Pt=()=>n(10984),Bt=()=>n(386164),Dt=()=>n(559506);var Rt=()=>n(913348),Et=()=>n(30537),Lt=()=>n(631524),Ot=()=>n(264154);function Nt(e){const{emailMessage:t,inviteTargetsStore:n,flowId:i,totalContactsCount:o=0}=e,a=(0,s().v3)(),l=(0,r().IS)((e=>({importContactsButton:{width:"100%",paddingTop:15,paddingBottom:15,paddingInlineStart:9,gap:4,color:e.text.secondary,borderRadius:"6px"},importContactsButtonV2:{width:"100%",paddingTop:15,paddingBottom:15,paddingInlineStart:9,gap:8,fill:e.text.primary},icon:{color:e.icon.tertiary}})),[]),c=(0,Tt().Hc)(),u=(0,Ct().C)({onClickAuthenticated:e=>{U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:e,emailMessage:t}),n.setState({...n.state,tokenQuery:""})},hideChevronIcon:!0,containerStyle:c.importListButtonContainer,buttonStyle:c.importListButton,flowId:i});return(0,P.jsx)(ft().A,{popupType:Et().n.Popup,alignmentToOrigin:"center",placementToOrigin:"bottom",render:()=>(0,P.jsx)(At().A,{importListItems:u}),originGap:12,renderOrigin:e=>(0,P.jsxs)(Lt().p,{style:{...l.importContactsButton},onClick:()=>{e.onClick(),pt().V(a,{source:"share_menu_inline_dropdown"})},children:[o>0?(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.importContactsInlineDropdown.numContacts",defaultMessage:"{numContacts} contacts",values:{numContacts:o}}):(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.importContactsInlineDropdown.noContacts",defaultMessage:"None"}),(0,P.jsx)(Ue().Q,{iconGroup:Ot().l,variantName:"fillSmall",style:l.icon})]})})}var Ft=()=>n(12193);function Ut(e){const{publicPermission:t}=e,n=(0,r().IS)((e=>({banner:{...(0,Be().kJ)({theme:e}),display:"flex",flexDirection:"row",alignItems:"center",gap:8},content:{display:"flex",alignItems:"flex-start",gap:2,flex:"1 0 0"},label:{fontSize:14,lineHeight:"20px",color:e.text.secondary,flex:"1 0 0",paddingInlineStart:4},iconContainer:{height:20,width:20,display:"flex",alignItems:"center",justifyContent:"center"},manageButton:{color:e.blue.text.accentPrimary,fontWeight:j().Wy.medium}})),[]),i=t.permissionItem.role;if(!ct().Tt(i))return null;const o=(0,ct().W8)(t.permissionItem);return(0,P.jsxs)("div",{style:n.banner,children:[(0,P.jsxs)("div",{style:n.content,children:[(0,P.jsx)("div",{style:n.iconContainer,children:(0,P.jsx)(H().I,{icon:Ft().globeIcon,colorVariant:"secondary"})}),(0,P.jsx)(f().A,{style:n.label,isMultiline:!0,children:(0,P.jsx)(zt,{role:i,hasSitePublicPermission:o})})]}),(0,P.jsx)(Lt().p,{size:"sm",style:n.manageButton,onClick:()=>{o?U().Ay.setState({...U().Ay.state,display:U().pP.Publish,tab:U().QC.Publish}):U().Ay.setState({...U().Ay.state,display:U().pP.MainShareMenu,tab:U().QC.Share,source:U().mc.PublicPermissionLevelBanner})},children:(0,P.jsx)(d().sA,{id:"shareMenu.managePublishSettingsButton.label",defaultMessage:"Settings"})})]})}function zt(e){const{role:t,hasSitePublicPermission:n}=e;switch(t){case"read_and_write":return(0,P.jsx)(d().sA,{id:"shareMenu.publicPermissionBanner.canEdit",defaultMessage:"This page allows edits from anyone on the web"});case"comment_only":return(0,P.jsx)(d().sA,{id:"shareMenu.publicPermissionBanner.canComment",defaultMessage:"This page allows comments from anyone on the web"});case"reader":return n?(0,P.jsx)(d().sA,{id:"shareMenu.publicPermissionBanner.canReadSite",defaultMessage:"This site can be viewed by anyone on the web"}):(0,P.jsx)(d().sA,{id:"shareMenu.publicPermissionBanner.canRead",defaultMessage:"This page can be viewed by anyone on the web"});case"editor":case"membership_admin":case"content_only_editor":case"none":return null;default:(0,V().HB)(t)}}var Kt=()=>n(718827),Vt=()=>n(831310),qt=()=>n(187859),Wt=()=>n(350527),Gt=()=>n(703888),Ht=()=>n(231704),Yt=()=>n(231039),$t=()=>n(870092),Qt=()=>n(623742),Zt=()=>n(698449);function Jt({inviteTarget:e,isMobile:t,captionOverride:i}){const o=(0,d().tz)(),s=(0,a().O$)(je().AppStoreSidebarSpaceStore),l=(0,a().K8)((()=>(0,Zt().Pf)({groupName:e.value.name,intl:o})),[e,o]),c=(0,a().K8)((()=>{if(s&&e.value.icon)return{pointer:{table:s.table,id:s.id},icon:e.value.icon}}),[s,e]),u=(0,a().K8)((()=>(0,Zt().xQ)({groupId:e.value.group_id})),[e]),p=(0,r().IS)((()=>({titleContainer:{display:"flex",alignItems:"center",paddingTop:void 0,paddingBottom:void 0,marginInlineStart:void 0,minHeight:36},groupInfoContainer:{display:"flex",flexDirection:"column"},nameAndIconContainer:{display:"flex",alignItems:"center"},groupNameLabel:{marginInlineStart:10,marginInlineEnd:4},groupMembersLabel:{marginInlineStart:10}})),[]);return(0,P.jsxs)("div",{style:p.titleContainer,children:[(0,P.jsx)(n(946928).A,{groupIcon:null==c?void 0:c.icon,spaceId:e.value.space_id}),(0,P.jsxs)("div",{style:p.groupInfoContainer,children:[(0,P.jsx)("div",{style:p.nameAndIconContainer,children:(0,P.jsx)(f().A,{style:p.groupNameLabel,children:l})}),(0,P.jsx)(f().A,{isSmall:!0,style:p.groupMembersLabel,children:i||(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(d().sA,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," Â· ",(0,P.jsx)(d().sA,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:u}})]})})]})]})}const Xt=i.memo(Jt);function en({store:e,isInvited:t,disabled:n,inviteTarget:i,id:o,focused:s,onClick:a,onAuxClick:l,onMouseEnter:d,role:c,disallowTabbing:u,ignoreLocalHoverState:p,isMobile:g},m){const f=(0,r().IS)((()=>({container:(0,Be().sH)()})),[]);return(0,P.jsx)(mt().A,{ref:m,buttonStyle:f.container,title:"group"===i.type?(0,P.jsx)(Xt,{inviteTarget:i,isMobile:g}):(0,P.jsx)(tn,{store:e,inviteTarget:i}),disabled:n,right:!n&&(0,P.jsx)(nn,{onClick:a,checked:t}),id:o,focused:s,onClick:a,onAuxClick:l,onMouseEnter:d,role:c,disallowTabbing:u,ignoreLocalHoverState:p})}function tn({store:e,inviteTarget:t}){const n=(0,a().K8)((()=>{if("existingUser"!==t.type)return;const n=e.getSpaceStore(),i=(0,A().sE)(n,t.value.id);return(0,Ht().p)({spaceUserStore:i,userId:t.value.id,store:e})}),[t,e]),o=(0,i.useMemo)((()=>"existingUser"===t.type?{actorStore:$t().L.createChildStore(e,{table:ee().oo,id:t.value.id}),avatar:void 0}:"newUser"===t.type?{actorStore:void 0,avatar:{email:t.value.email,..."slack"===t.source||"google"===t.source||"microsoft"===t.source?{name:t.value.name,avatarUrl:t.value.avatar_url}:{name:void 0,avatarUrl:void 0}}}:void(0,V().HB)(t)),[t,e]),s=(0,r().IS)((()=>({iconBoxImage:{position:"absolute",bottom:-3,insetInlineEnd:-3,background:"white",padding:2,borderRadius:"100%"}})),[]),l="newUser"===t.type&&("google"===t.source||"slack"===t.source||"microsoft"===t.source)&&t.value.user_id;return(0,P.jsx)(Qt().A,{isLarge:!0,...o,avatarBadge:(()=>{const e=(()=>{if("newUser"!==t.type)return null;switch(t.source){case"slack":return Gt().j;case"google":return qt().m;case"microsoft":return Wt().g;default:return null}})();return e?(0,P.jsx)(Ue().Q,{iconGroup:e,variantName:"default",overrideSize:()=>"newUser"===t.type&&"microsoft"===t.source?18:16,style:s.iconBoxImage}):null})(),spaceRole:n,caption:l&&(0,P.jsx)(Yt().N,{inviteTarget:t})})}function nn(e){const{checked:t}=e,n=(0,r().IS)((e=>{const n=n=>{switch(n){case"default":return{background:t?e.checkboxBackground:"transparent",borderColor:t?e.checkboxBackground:e.icon.tertiary};case"hovered":return{background:t?e.checkboxHoveredBackground:e.uncheckedCheckboxHoveredBackground,borderColor:t?e.checkboxHoveredBackground:e.icon.tertiary};case"pressed":return{background:t?e.checkboxPressedBackground:e.uncheckedCheckboxPressedBackground,borderColor:t?e.checkboxPressedBackground:e.icon.tertiary};default:return{}}};return{circleCheckmark:{display:"flex",justifyContent:"center",alignItems:"center",width:18,height:18,borderRadius:"50%",borderStyle:"solid",borderWidth:1.75,...n("default"),marginInlineEnd:6},hovered:n("hovered"),pressed:n("pressed"),checkIcon:{height:9,width:9,color:"white"}}}),[t]);return(0,P.jsx)(Kt().Ay,{onClick:e.onClick,style:n.circleCheckmark,hoveredStyle:n.hovered,pressedStyle:n.pressed,children:t?(0,Vt().o)(n.checkIcon):void 0})}const on=i.memo(i.forwardRef(en));var sn=()=>n(273900),an=()=>n(433847),rn=()=>n(152197),ln=()=>n(328403),dn=()=>n(678634),cn=()=>n(801191),un=()=>n(810727);function pn({blockStore:e,permissionItem:t,inviteTarget:n,mostPermissivePermissions:i,permissionItemArgs:o,...s}){return"group"===n.type?(0,P.jsx)(mn,{inviteTarget:n,blockStore:e,permissionItem:t,mostPermissivePermissions:i,permissionItemArgs:o,menuListItemProps:s}):"existingUser"===n.type?(0,P.jsx)(gn,{inviteTarget:n,blockStore:e,permissionItem:t,mostPermissivePermissions:i,permissionItemArgs:o,menuListItemProps:s}):null}function gn({inviteTarget:e,blockStore:t,permissionItem:n,mostPermissivePermissions:i,permissionItemArgs:o,menuListItemProps:r}){const c=(0,d().tz)(),u=(0,a().K8)((()=>$t().L.createChildStore(t,{table:ee().oo,id:e.value.id}).getDisplayName(c)||void 0),[t,c,e]),p=(0,un().z)({permissionItem:n,targetType:"user",targetName:u,store:t}),g="user_permission"===(null==i?void 0:i[0].permissionItem.type)?i[0]:{from:{table:l().ev,blockId:t.id},permissionItem:{role:n.role,type:"user_permission",user_id:e.value.id}},m=(0,s().v3)().currentUser.id,f=m&&g.permissionItem.user_id===m;return(0,P.jsx)(ln().A,{store:t,userPermission:g,showInherited:!1,selectFooter:(0,P.jsx)(cn().n,{targetName:u,targetType:"user",mostPermissivePermissions:i,hasInaccessiblePermissions:!1,isCurrentUser:Boolean(f)}),permissionItemArgs:o,tooltip:p,menuListItemProps:r})}function mn({inviteTarget:e,blockStore:t,permissionItem:n,mostPermissivePermissions:i,permissionItemArgs:o,menuListItemProps:s}){const r=(0,rn().r)(),d=e.value.name,c=(0,un().z)({permissionItem:n,targetType:"group",targetName:d,store:t}),u=(0,a().K8)((()=>function({targetType:e,targetName:t,mostPermissivePermissions:n}){var i;const o=null==n||null===(i=n.filter("user"===e?an().bn:hn))||void 0===i?void 0:i[0];if(!o)return[];const s=(0,ct().PW)(o.permissionItem.role)?o.permissionItem.role:"none";if("none"===s)return[];return fn.map((n=>{if((0,sn().sO)(n,s))return;return{role:n,disabledInfo:{isDisabled:!0,disabledMessage:(0,P.jsx)(vn,{targetType:e,permissionItem:o.permissionItem,targetName:t})}}})).filter(V().O9)}({targetType:"group",targetName:d,mostPermissivePermissions:i})),[i,d]),p="group_permission"===(null==i?void 0:i[0].permissionItem.type)?i[0]:{from:{table:l().ev,blockId:t.id},permissionItem:{role:n.role,type:"group_permission",group_id:e.value.group_id}};return r?(0,P.jsx)(Rt().A,{store:t,groupPermission:p,spaceId:r,showInherited:!1,isRemovableOverride:!0,permissionItemArgs:o,tooltip:c,roleItemOverrides:u,menuListItemProps:s}):null}const fn=["none","reader","comment_only","content_only_editor","read_and_write","membership_admin","editor"];function hn(e){switch(e.permissionItem.type){case"space_permission":case"space_owner_permission":case"team_permission":case"team_owner_permission":case"explicit_team_permission":case"explicit_team_owner_permission":case"explicit_team_guest_permission":return!0;case"group_permission":case"bot_permission":case"deleted_permission":case"exclusive_user_permission":case"public_permission":case"restricted_permission":case"trusted_domain_permission":case"user_permission":case"collection_property_permission":return!1;default:return e.permissionItem,!1}}function vn({permissionItem:e,targetType:t,targetName:n}){return n&&"user"===t?(0,P.jsx)(d().sA,{id:"searchTargetPermissionItem.disabledMessage",defaultMessage:"To restrict {targetUserName}â€™s access, modify the â€œ{permissionItemName}â€ setting on this page",values:{targetUserName:n,permissionItemName:(0,P.jsx)(dn()._,{permissionItem:e})}}):n&&"group"===t?(0,P.jsx)(d().sA,{id:"searchTargetPermissionItem.disabledMessageForGroup",defaultMessage:"To restrict the {targetGroupName} groupâ€™s access, modify the â€œ{permissionItemName}â€ setting on this page",values:{targetGroupName:n,permissionItemName:(0,P.jsx)(dn()._,{permissionItem:e})}}):(0,P.jsx)(d().sA,{id:"searchTargetPermissionItem.disabledMessageWithoutName",defaultMessage:"To restrict access, modify the â€œ{permissionItemName}â€ setting on this page",values:{permissionItemName:(0,P.jsx)(dn()._,{permissionItem:e})}})}const yn=i.memo(pn);function bn(e){var t,n;const{store:i,shouldShowSlackOnly:o,shouldShowGoogleOnly:l,shouldShowMicrosoftOnly:c,calculatedPermissions:u,permissionItemArgs:p,tokenQuery:g,showShimmer:m,error:h,ready:v,result:y}=e,b=(0,s().v3)(),S=(0,d().tz)(),x=(0,a().uB)(e.inviteTargetsStore,pe().Ay),M=(0,a().K8)((()=>U().Ay.state.display===U().pP.Invite&&U().Ay.state.focus&&"message"===U().Ay.state.focus),[]),w=(0,a().uB)(e.menuListStore,ke().A),j=(0,r().IS)((e=>({googleSlackIcons:{position:"relative",width:32,height:32},icons:{width:16,height:16,borderRadius:"50%",padding:1,border:`1px solid ${e.border.secondary}`,backgroundColor:e.palette.gray[0],position:"absolute"},microsoftIcon:{width:16,height:16,borderRadius:"50%",padding:2,border:`1px solid ${e.border.secondary}`,backgroundColor:e.palette.gray[0],position:"absolute"},sectionMenuItem:{display:"flex",flexDirection:"column",paddingTop:0,paddingInlineStart:8,paddingInlineEnd:8,paddingBottom:8},keepTypingMessage:{paddingInlineStart:Be().rL,paddingInlineEnd:Be().rL,marginTop:6,marginBottom:8,fontWeight:500},zeroState:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",color:e.text.secondary,fontSize:14,position:"relative",pointerEvents:"auto",paddingTop:10,marginTop:40,marginBottom:40},zeroStateText:{width:"70%",alignSelf:"center"},zeroStateIcon:{height:36,width:36,marginBottom:12,fill:e.icon.secondary},arrowUpLeftIcon:{width:ie().Ev.sm,height:ie().Ev.sm,marginTop:2,color:e.icon.tertiary}})),[]),{spaceId:k}=e,I=function(e,t){const n=(0,s().v3)(),i=(0,a().K8)((()=>{if(0!==t.length)return{spaceId:e,userIds:t}}),[e,t],{useDeepEqual:!0}),[{value:o}]=(0,st().Yb)((async()=>{if(void 0===i)return{};const t=await Dt().callApi({eventName:"getSpacePermissionGroupIdsContainingMembers",environment:n,data:i,headers:(0,Bt().WS)({cellId:void 0,spaceId:e})});return"success"===t.type?t.data.userToGroupMap:{}}),[n,i,e],{debugName:"userToPermissionGroupIds",debounce:300,throttle:1e3});return o}(k,y?y.inviteUsers.map((e=>e.value.id)).filter((e=>void 0!==e)):[]),C=u.pagePermissionUIModel,{inPageTargets:T,notInPageTargets:_,filteredImportedContacts:B,totalContactsCount:D}=(0,a().K8)((()=>{const{inviteUsers:e,inviteGroups:t,importedContacts:n=[],totalContactsCount:o}=y??{inviteUsers:[],inviteGroups:[],importedContacts:[],totalContactsCount:0},{sidebarSpaceStore:s}=je().default.state,a=[...e,...t],r=[],l=[],d=new Set;a.forEach((e=>{"group"!==e.type&&d.add(e.value.email.toLowerCase());const t=Boolean(wt().wF({store:i,target:e}));if("existingUser"===e.type&&!Boolean(e.membershipType)){const t=(0,A().sE)(s,e.value.id),n=(null==t?void 0:t.getMembershipType())??"none";e.membershipType=n}const n=(0,F().NV)({inviteTarget:e,store:i,calculatedPermissions:u,userToGroupMap:I});void 0!==n&&(t||ct().Tt(n.permissionItem.role??"none"))&&"newUser"!==e.type?n&&r.push({inviteTarget:e,...n}):"newUser"!==e.type&&l.push({inviteTarget:e,...n})}));const c=n.filter((e=>!d.has(e.value.email.toLowerCase())));return{inPageTargets:r,notInPageTargets:l,filteredImportedContacts:c,totalContactsCount:o}}),[y,i,u,I]),{isValidEmail:R,isEmailInTargets:E}=(0,a().K8)((()=>{const e=(0,ye().qh)(g);return{isValidEmail:(0,ye().DT)(e),isEmailInTargets:[...T.map((({inviteTarget:e})=>e)),..._.map((({inviteTarget:e})=>e))].some((t=>"group"!==t.type&&t.value.email===e))}}),[g,T,_]),L=(0,a().K8)((()=>x.state.inviteTargets.length>0),[x]),O=!(o||l||c),N=R&&!E,z=u.showRestrictedPermissionBanner,K=!o&&!l&&!c&&_.length>0&&(0===g.length||0===(null==y?void 0:y.tokenQuery.length)),q=!o&&!l&&!c&&g.length>0&&Boolean(null==y||null===(t=y.tokenQuery)||void 0===t?void 0:t.length)&&T.length>0,W=!o&&!l&&_.length>0&&g.length>0&&Boolean(null==y||null===(n=y.tokenQuery)||void 0===n?void 0:n.length),G=B.filter((e=>"slack"===e.source)),H=B.filter((e=>"google"===e.source)),Y=B.filter((e=>"microsoft"===e.source)),$=G.length>0&&!O,Q=H.length>0&&!O,Z=Y.length>0&&!O,J=O&&(G.length>0||H.length>0||Y.length>0),X={key:"imported slack contacts",render:e=>(0,P.jsx)(bt().A,{...e,style:j.sectionMenuItem,title:(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.importedSlackContactsSection.title",defaultMessage:"From Slack"}),loading:!v}),items:Sn({filteredContacts:G,environment:b,inviteTargetsStore:x,blockStore:i,tokenQuery:g,menuListStore:w})},ee={key:"imported google contacts",render:e=>(0,P.jsx)(bt().A,{...e,style:j.sectionMenuItem,title:(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.importedGoogleContactsSection.title",defaultMessage:"From Google"}),loading:!v}),items:Sn({filteredContacts:H,environment:b,inviteTargetsStore:x,blockStore:i,tokenQuery:g,menuListStore:w})},te="control"!==(0,kt().r)("microsoft_contacts_import"),ne={key:"imported microsoft contacts",render:e=>te?(0,P.jsx)(bt().A,{...e,style:j.sectionMenuItem,title:(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.importedMicrosoftContactsSection.title",defaultMessage:"From Microsoft"}),loading:!v}):void 0,items:Sn({filteredContacts:Y,environment:b,inviteTargetsStore:x,blockStore:i,tokenQuery:g,menuListStore:w})},oe={key:"mixed contacts",render:e=>(0,P.jsx)(bt().A,{...e,style:j.sectionMenuItem,loading:!v}),items:Sn({filteredContacts:[...H,...G,...Y].sort(((e,t)=>(e.value.name??"").localeCompare(t.value.name??""))),environment:b,inviteTargetsStore:x,blockStore:i,tokenQuery:g,menuListStore:w})},se=N||!K&&!q&&!W&&!$&&!Q&&!Z&&!o&&!l&&!c&&g.length>0,ae=(0,It().h)(k),re=(0,jt().A)(i);if(h)return(0,P.jsx)(xt().z,{loading:!v,children:(0,P.jsx)(vt().A,{title:(0,P.jsx)(d().sA,{id:"inviteUserModal.searchInput.errorMessage",defaultMessage:"Something went wrong"})})});if(!v&&m)return(0,P.jsx)(_t().J,{areaHeight:window.innerHeight});const le={key:"user results",render:e=>(0,P.jsx)(bt().A,{...e,style:j.sectionMenuItem,loading:!v,title:(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.suggestedEmail.title",defaultMessage:"Keep typing an email to invite"})}),items:_n({tokenQuery:g,possibleDomains:ae??[],shouldShowAutoFillEmail:se,isGuestInviteRequestRequired:re.isGuestRequestRequired,environment:b,inviteTargetsStore:x,menuListStore:w,styles:j})},de={key:"import contacts",render:e=>(0,P.jsx)(bt().A,{...e,style:j.sectionMenuItem,loading:!v}),items:[{key:"import contacts",render:()=>(0,P.jsx)(mt().A,{focused:!1,style:{cursor:"default"},caption:te?(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.importContactsWithMicrosoft.caption",defaultMessage:"Add contacts from Google, Slack, or Microsoft"}):(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.importContacts.caption",defaultMessage:"Add contacts from Google, Slack"}),icon:(0,P.jsxs)("div",{style:j.googleSlackIcons,children:[(0,P.jsx)(Ue().Q,{iconGroup:Mt().mt,variantName:"default",style:{...j.icons,top:2,insetInlineStart:"50%",transform:"translateX(-50%)"}}),(0,P.jsx)(Ue().Q,{iconGroup:Mt().jJ,variantName:"default",style:{...j.icons,bottom:2,insetInlineEnd:2}}),te?(0,P.jsx)(Ue().Q,{iconGroup:Mt().gs,variantName:"default",style:{...j.microsoftIcon,bottom:2,insetInlineStart:2}}):void 0]}),right:(0,P.jsx)(Nt,{emailMessage:e.emailMessage??"",inviteTargetsStore:e.inviteTargetsStore,flowId:e.flowId,totalContactsCount:D??0}),title:(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.importContacts.title",defaultMessage:"Import contacts"})}),action:()=>{}}]},ce={key:"suggested",render:e=>(0,P.jsx)(bt().A,{...e,style:j.sectionMenuItem,title:(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.suggestedSection.title",defaultMessage:"Suggested"}),loading:!v}),items:_.map((({inviteTarget:e,mostPermissivePermissions:t},n)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:n=>{const o=Me().P4({target:e,inviteTargetsStore:x});return(0,P.jsx)(jn,{...n,intl:S,isMobile:b.device.isMobile,disabled:!1,inviteTarget:e,isInvited:o,store:i,mostPermissivePermissions:t})},action:()=>An({inviteTarget:e,inviteTargetsStore:x,menuListStore:w,rank:n,tokenQuery:g,environment:b,type:"suggested"})})))},ue={key:"in page",render:e=>(0,P.jsx)(bt().A,{...e,style:j.sectionMenuItem,title:(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.inPageSection.titleRedesign",defaultMessage:"Already invited"}),loading:!v}),items:T.map(((e,t)=>{const{inviteTarget:n,permissionItem:o,mostPermissivePermissions:s}=e,{type:a}=n;if("existingUser"===a){if(!!s&&s.length>1)return{key:n.value.id,render:e=>(0,P.jsx)(Mn,{...e,blockStore:i,inviteTarget:n,permissionItem:o,mostPermissivePermissions:s,permissionItemArgs:p,rank:t,tokenQuery:g,isRestricted:z}),action:()=>{}};return C.mostPermissiveUserPermissions.find((e=>e.permissionItem.user_id===n.value.id))?{key:n.value.id,render:e=>(0,P.jsx)(Mn,{...e,blockStore:i,inviteTarget:n,permissionItem:o,permissionItemArgs:p,rank:t,tokenQuery:g,isRestricted:z}),action:()=>{}}:{key:n.value.id,render:e=>(0,P.jsx)(Mn,{...e,blockStore:i,inviteTarget:n,permissionItem:o,permissionItemArgs:p,rank:t,tokenQuery:g,isRestricted:z}),action:()=>An({inviteTarget:n,inviteTargetsStore:x,menuListStore:w,rank:t,tokenQuery:g,environment:b,type:"in_page"})}}if("group"===a){if(!!s&&s.length>1)return{key:n.value.id,render:s=>(0,P.jsx)(Mn,{...s,blockStore:i,inviteTarget:n,permissionItem:o,mostPermissivePermissions:e.mostPermissivePermissions,permissionItemArgs:p,rank:t,tokenQuery:g,isRestricted:z}),action:()=>{}};{const e=C.mostPermissiveGroupPermissions.find((e=>e.permissionItem.group_id===n.value.group_id));if(!e)return{key:n.value.id,render:e=>(0,P.jsx)(Mn,{...e,blockStore:i,inviteTarget:n,permissionItem:o,permissionItemArgs:p,rank:t,tokenQuery:g,isRestricted:z}),action:()=>An({inviteTarget:n,inviteTargetsStore:x,menuListStore:w,rank:t,tokenQuery:g,environment:b,type:"in_page"})};const s=i.getSpaceId();return s?{key:n.value.id,render:t=>(0,P.jsx)(mt().A,{...t,itemMarginLeft:0,itemMarginRight:0,title:(0,P.jsx)(Rt().A,{store:i,groupPermission:e,spaceId:s,showInherited:!0,permissionItemArgs:p})}),action:()=>{}}:null}}(0,V().HB)(a)})).filter((e=>null!==e))},ge={key:"not in page",render:e=>(0,P.jsx)(bt().A,{...e,style:j.sectionMenuItem,title:g.length>0&&(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.notInPageSection.titleRedesign",defaultMessage:"Not invited to page"}),loading:!v}),items:_.map((({inviteTarget:e,mostPermissivePermissions:t},n)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:n=>(0,P.jsx)(jn,{...n,disabled:!1,intl:S,isMobile:b.device.isMobile,inviteTarget:e,isInvited:Me().P4({target:e,inviteTargetsStore:x}),store:i,mostPermissivePermissions:t}),action:()=>An({inviteTarget:e,inviteTargetsStore:x,menuListStore:w,rank:n,tokenQuery:g,environment:b,type:"not_in_page"})})))};let me=[];if(N&&me.push(le),K&&me.push(ce),q&&me.push(ue),W&&me.push(ge),$&&me.push(X),Q&&me.push(ee),Z&&me.push(ne),J&&me.push(oe),o&&(me=[X],0===X.items.length))return(0,P.jsx)(kn,{styles:j,importContactType:"slack"});if(l&&(me=[ee],0===ee.items.length))return(0,P.jsx)(kn,{styles:j,importContactType:"google"});if(c&&(me=[ne],0===ne.items.length))return(0,P.jsx)(kn,{styles:j,importContactType:"microsoft"});if(0===me.length){if(me=[le],0===g.length&&!L)return O?(0,P.jsx)(Cn,{emailMessage:e.emailMessage,inviteTargetsStore:e.inviteTargetsStore,flowId:e.flowId}):(0,P.jsx)(In,{styles:j});if(0===g.length&&L)return(0,P.jsx)("div",{style:j.keepTypingMessage,children:(0,P.jsx)(f().A,{isSecondaryColor:!0,isSmall:!0,children:(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.suggestedEmail.title",defaultMessage:"Keep typing an email to invite"})})})}else O&&me.unshift(de);return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Ut,{publicPermission:u.mostPermissivePublicItem}),(0,P.jsx)(ht().Ay,{type:ht().Oh.Vertical,initialFocus:g.length>0?0:void 0,sections:me,store:w,disableKeyboard:M})]})}function Sn(e){const{filteredContacts:t,environment:n,inviteTargetsStore:i,blockStore:o,tokenQuery:s,menuListStore:a}=e;return t.map(((e,t)=>({key:e.value.email,render:t=>(0,P.jsx)(on,{...t,isMobile:n.device.isMobile,disabled:!1,inviteTarget:e,isInvited:Me().P4({target:e,inviteTargetsStore:i}),store:o}),action:()=>{Me().P4({target:e,inviteTargetsStore:i})?i.setState({...i.state,inviteTargets:i.state.inviteTargets.filter((t=>"newUser"!==t.type||e.value.email!==t.value.email))}):(z().kH(n,{invite_token_query:s,selected_user_token:e,selected_user_token_rank:t,from:"share_modal_invite",subscription_tier:(0,Pt().AI)(),type:xn(e)}),i.setState({inviteTargets:[...i.state.inviteTargets,e],tokenQuery:""}),a.unsetFocus())}})))}function xn(e){return"google"===e.source?"google_contacts":"slack"===e.source?"slack":"microsoft"===e.source?"microsoft_contacts":void(0,V().HB)(e.source)}function An(e){const{inviteTarget:t,inviteTargetsStore:n,menuListStore:i,rank:o,tokenQuery:s,environment:a,type:r}=e;Me().lW({inviteTargetsStore:n,inviteTarget:t})&&z().kH(a,{invite_token_query:s,selected_user_token:t,selected_user_token_rank:o,from:"share_modal_invite",subscription_tier:(0,Pt().AI)(),type:r}),i.unsetFocus()}const Mn=i.forwardRef((function(e,t){const{inviteTarget:n}=e,i=n.type;switch(i){case"group":case"existingUser":return(0,P.jsx)(yn,{...e,inviteTarget:n});default:(0,V().HB)(i)}}));function wn(e,t,n){var i,o,s;return"group"===e.type?{targetType:"group",targetName:e.value.name,permissionItem:(null==n||null===(i=n[0])||void 0===i?void 0:i.permissionItem)??{type:"group_permission",role:"none",group_id:e.value.group_id}}:"existingUser"===e.type?{targetType:"user",targetName:X().Bj6.fromValue(ee().oo,e.value).getDisplayName(t),permissionItem:(null==n||null===(o=n[0])||void 0===o?void 0:o.permissionItem)??{type:"user_permission",role:"none",user_id:e.value.id}}:"newUser"===e.type?{targetType:"user",targetName:e.value.email,permissionItem:(null==n||null===(s=n[0])||void 0===s?void 0:s.permissionItem)??{type:"user_permission",role:"none",user_id:e.value.email}}:void(0,V().HB)(e)}function jn(e){const{mostPermissivePermissions:t,inviteTarget:n,store:i,intl:o}=e,s=(0,r().IS)((()=>({tooltip:{maxWidth:240}})),[]),a=(0,un().z)({store:i,...wn(n,o,t)});return(0,P.jsx)(St().A,{delayThreshold:0,placement:"left",textWrap:!0,style:s.tooltip,disableTooltip:!(0,V().O9)(a),renderTooltip:()=>a,render:t=>(0,P.jsx)("div",{...t,children:(0,P.jsx)(on,{...e})})})}function kn(e){const{styles:t,importContactType:n}=e,i="google"===n?"Google account":"slack"===n?"Slack workspace":"microsoft"===n?"Microsoft account":(0,V().HB)(n);return(0,P.jsxs)("div",{style:t.zeroState,children:[(0,dt().G)(t.zeroStateIcon),(0,P.jsxs)("div",{style:t.zeroStateText,children:[(0,P.jsx)("div",{style:{fontWeight:j().Wy.semibold,marginBottom:4},children:(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.noImportedContacts.title",defaultMessage:"No contacts found"})}),(0,P.jsx)("div",{children:(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.noImportedContacts.text",defaultMessage:"Try connecting a different {externalIntegrationCopy} or typing an email address",values:{externalIntegrationCopy:i}})})]})]})}function In(e){const{styles:t}=e;return(0,P.jsxs)("div",{style:t.zeroState,children:[(0,lt().inviteMemberIcon)(t.zeroStateIcon),(0,P.jsxs)("div",{style:t.zeroStateText,children:[(0,P.jsx)("div",{style:{fontWeight:j().Wy.semibold,marginBottom:4},children:(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.noSuggestions.title",defaultMessage:"Members and guests will appear here"})}),(0,P.jsx)("div",{children:(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.noSuggestions.text",defaultMessage:"Try inviting someone with their email address or importing contacts"})})]})]})}function Cn(e){const{inviteTargetsStore:t,flowId:n,emailMessage:i}=e,o=(0,r().IS)((e=>({container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1,textAlign:"center",fontSize:14,position:"relative",pointerEvents:"auto",marginTop:32,marginBottom:24,gap:14},logos:{display:"flex",gap:12,alignItems:"center",justifyContent:"center"},text:{marginTop:6,textAlign:"center"},subtext:{color:e.text.secondary},button:{padding:"8px 12px"}})),[]),a=(0,Tt().Hc)(),l=(0,s().v3)(),c="control"!==(0,kt().r)("microsoft_contacts_import"),u=(0,Ct().C)({onClickAuthenticated:e=>{U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:e,emailMessage:i??""}),t.setState({...t.state,tokenQuery:""})},hideChevronIcon:!0,containerStyle:a.importListButtonContainer,buttonStyle:a.importListButton,flowId:n});return(0,P.jsxs)("div",{style:o.container,children:[(0,P.jsxs)("div",{style:o.logos,children:[(0,P.jsx)(Ue().Q,{iconGroup:Mt().mt,variantName:"default",style:{height:22,width:22}}),(0,P.jsx)(Ue().Q,{iconGroup:Mt().jJ,variantName:"default",style:{height:22,width:22}}),c?(0,P.jsx)(Ue().Q,{iconGroup:Mt().gs,variantName:"default",style:{height:22,width:22}}):void 0]}),(0,P.jsxs)("div",{style:o.text,children:[(0,P.jsx)("div",{style:{fontWeight:j().Wy.semibold,marginBottom:4},children:(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.getStartedImportContacts.title",defaultMessage:"Import contacts"})}),(0,P.jsx)("div",{style:o.subtext,children:c?(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.getStartedImportContactsWithMicrosoft.text",defaultMessage:"Connect with Google, Slack, or Microsoft"}):(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.getStartedImportContacts.text",defaultMessage:"Connect with Google or Slack"})})]}),(0,P.jsx)("div",{children:(0,P.jsx)(ft().A,{popupType:yt().nl.Popup,alignmentToOrigin:"start",placementToOrigin:"left",render:()=>(0,P.jsx)(At().A,{importListItems:u}),originGap:12,renderOrigin:e=>(0,P.jsx)(ot().E,{...e,onClick:()=>{var t;null===(t=e.onClick)||void 0===t||t.call(e),pt().V(l,{source:"share_menu_empty_state"})},style:o.button,children:(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.getStartedImportContacts.button",defaultMessage:"Get started"})})})})]})}function Tn({tokenQuery:e,possibleDomains:t,shouldShowAutoFillEmail:n}){const i=(0,ut().Ay)(e,function(e,t,n){return n?Array.from(new Set([...t,"gmail.com","yahoo.com","outlook.com","hotmail.com"])).map(((t,n)=>({tokenQuery:`${e.split("@")[0]}@${t}`,weight:n}))).slice(0,3):[{tokenQuery:e,weight:0}]}(e,t,n),(e=>e.tokenQuery));return 0===i.length?[{tokenQuery:e,weight:0}]:i}function _n({tokenQuery:e,possibleDomains:t,isGuestInviteRequestRequired:n,shouldShowAutoFillEmail:i,environment:o,inviteTargetsStore:s,menuListStore:a,styles:r}){return Tn({tokenQuery:e,possibleDomains:t,shouldShowAutoFillEmail:i}).map(((t,r)=>({key:t.tokenQuery,render:e=>(0,P.jsx)(mt().A,{icon:(0,lt().inviteMemberIcon)({width:20,height:20}),title:(0,P.jsx)(Pn,{tokenQuery:t.tokenQuery,shouldShowAutofillEmail:i,isGuestInviteRequestRequired:n}),caption:n?(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.requestNewUser.buttonItem.caption",defaultMessage:"Workspace owners are required to view and approve guest invites"}):void 0,right:i&&(0,P.jsx)(H().I,{icon:rt,size:"sm",colorVariant:"tertiary"}),...e}),action:async()=>{const n=(0,ye().qh)(t.tokenQuery);if(!(0,ye().DT)(n)){const e={type:"invalidUser",value:{text:t.tokenQuery}};return void(Me().P4({target:e,inviteTargetsStore:s})||s.setState({inviteTargets:[...s.state.inviteTargets,e],tokenQuery:""}))}const i=await gt().Ah(o,[n]);if(!i.length)return;const l=i[0];Me().P4({target:l,inviteTargetsStore:s})||(z().kH(o,{invite_token_query:e,selected_user_token:l,selected_user_token_rank:r,from:"share_modal_invite",subscription_tier:(0,Pt().AI)(),type:"autofill"}),s.setState({inviteTargets:[...s.state.inviteTargets,l],tokenQuery:""}),a.unsetFocus())}})))}function Pn(e){const{tokenQuery:t,shouldShowAutofillEmail:n,isGuestInviteRequestRequired:i}=e;return i?(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.requestNewUser.buttonItem",defaultMessage:"Request {tokenQuery} as a guest",values:{tokenQuery:t}}):n?(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem.v1",defaultMessage:"â€œ{tokenQuery}â€",values:{tokenQuery:t}}):(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem",defaultMessage:"Invite {tokenQuery}",values:{tokenQuery:t}})}const Bn=function(e){const t=(0,s().v3)(),o=(0,d().tz)(),[r,l]=(0,i.useState)(!0),c=(0,a().K8)((()=>e.inviteTargetsStore.state.tokenQuery),[e.inviteTargetsStore]),u=(0,a().K8)((()=>e.store.getSpaceId()),[e.store]),p=(0,a().K8)((()=>{if(e.shouldShowSlackOnly||e.shouldShowGoogleOnly||e.shouldShowMicrosoftOnly)return{userLimit:0,botLimit:0,groupLimit:0,importContactLimit:e.sectionRenderLimit};const t=Ze().A.completeSlackAuthentications.state.length>0,n=Ze().A.externalAuthentications.state.filter((e=>e.integration_id===Ye().E8)).length>0,i=Ze().A.externalAuthentications.state.filter((e=>e.integration_id===Ye().LF)).length>0;return{userLimit:e.sectionRenderLimit,botLimit:0,groupLimit:e.shouldShowGroups?e.sectionRenderLimit:0,importContactLimit:t||n||i?e.sectionRenderLimit:0}}),[e.sectionRenderLimit,e.shouldShowGroups,e.shouldShowSlackOnly,e.shouldShowGoogleOnly,e.shouldShowMicrosoftOnly]),g=(0,a().K8)((()=>{const e=n(21735).A.state.shouldUseEdgeCache,t=Ie().default.checkGate({gateName:"edge_cache_share_menu"});return e&&t}),[]),[{value:m,status:f}]=(0,st().Yb)((async()=>({...await gt().hQ({query:c,sectionLimit:p,membersOnly:e.membersOnly,environment:t,intl:o,shouldUseEdgeCacheRollout:g}).finally((()=>l(!1))),tokenQuery:c})),[t,o,e.membersOnly,c,p,g],{debounce:40});return u?(0,P.jsx)(bn,{...e,tokenQuery:c,showShimmer:r,ready:"pending"!==f&&"idle"!==f,error:"rejected"===f,result:m,spaceId:u}):null};function Dn(e){const t=(0,s().v3)(),n=(0,a().uB)(e.inviteTargetsStore,pe().Ay),o=(0,a().K8)((()=>n.state.inviteTargets.length>0),[n]),{display:l,source:c,focus:u,emailMessage:p}=(0,a().K8)((()=>{const{display:e}=U().Ay.state;return e===U().pP.Invite?U().Ay.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),g=(0,a().O$)(je().AppStoreSidebarSpaceStore),m=l===U().pP.Invite&&o,h=(0,a().K8)((()=>c===U().NL.Notion&&!o),[o,c]),v=(0,a().O$)(Ze().A.completeSlackAuthentications),y=(0,a().K8)((()=>c===U().NL.Notion&&!o),[o,c]),b=(0,a().K8)((()=>Ze().A.externalAuthentications.state.filter((e=>e.integration_id===Ye().E8))),[]),S=(0,a().K8)((()=>c===U().NL.Notion&&!o),[o,c]),x=(0,a().K8)((()=>Ze().A.externalAuthentications.state.filter((e=>e.integration_id===Ye().LF))),[]),[A,M]=(0,i.useState)(!1),w=m&&!h,j=(0,i.useCallback)((()=>{n.reset()}),[n]);(0,i.useEffect)((()=>{if(!g||A)return;if(!h&&!y&&!S)return;const e=[...v.map((e=>({botId:e.id,importContactType:"slack"}))),...b.map((e=>({botId:e.id,importContactType:"google"}))),...x.map((e=>({botId:e.id,importContactType:"microsoft"})))];e.length>0&&(0,Qe().b)({bots:e,spaceId:g.id,environment:t}),M(!0)}),[h,y,S]);const k=function({scrollerMarginBottom:e}){const t=(0,s().v3)();return(0,r().IS)((n=>({scroller:{flexGrow:1,marginBottom:e},importContactsContainer:{height:36,bottom:0,width:"100%",backgroundColor:n.background.elevated,pointerEvents:"all",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",padding:3},importContactsButton:{width:"100%",paddingTop:15,paddingBottom:15,paddingInlineStart:9,gap:8},importContactsButtonV2:{width:"100%",paddingTop:15,paddingBottom:15,paddingInlineStart:9,gap:8,fill:n.text.primary},warningLabel:{...(0,Be().kJ)({theme:n,isMobile:t.device.isMobile}),display:"flex",alignItems:"center",gap:2,color:n.text.secondary}})),[e,t])}({scrollerMarginBottom:w?nt:0}),I=(0,a().K8)((()=>!(0,F().Aj)({store:e.store})),[e.store]);return l!==U().pP.Invite?null:(0,P.jsxs)(P.Fragment,{children:[I?(0,P.jsx)(f().A,{style:k.warningLabel,isMultiline:!0,children:(0,P.jsx)(d().sA,{id:"shareMenuSearchRequest.suggestedSectionWarning.title",defaultMessage:"Some users may already have access through a parent page or teamspace"})}):void 0,(0,P.jsx)($e().H,{type:He().A.Y,style:k.scroller,children:(0,P.jsx)(Bn,{inviteTargetsStore:n,store:e.store,menuListStore:e.menuListStore,shouldShowGroups:!0,shouldShowSlackOnly:c===U().NL.Slack,shouldShowGoogleOnly:c===U().NL.Google,shouldShowMicrosoftOnly:c===U().NL.Microsoft,membersOnly:!1,sectionRenderLimit:10,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs,emailMessage:p,flowId:e.flowId})}),(0,P.jsx)(it,{open:m&&!h,focus:u===U().yZ.Message,value:p,onFocus:()=>{c&&l===U().pP.Invite&&U().Ay.setState({...U().Ay.state,focus:U().yZ.Message,tab:U().QC.Share,display:l,source:c,emailMessage:p})},onChange:e=>{U().Ay.setState({...U().Ay.state,focus:u,tab:U().QC.Share,display:l,source:c,emailMessage:e.target.value})},onCancel:async()=>{await Je().T({environment:t,inviteTargetsStore:n})&&(Je().XP({environment:t,store:e.store}),j())},maxLength:1e3})]})}var Rn=()=>n(100622),En=()=>n(347160),Ln=()=>n(891078),On=()=>n(300789),Nn=()=>n(107683),Fn=()=>n(49210),Un=()=>n(160432),zn=()=>n(252953),Kn=()=>n(496603),Vn=()=>n(347063),qn=()=>n(592674),Wn=()=>n(868146);function Gn(e){const{email:t}=e;return(0,P.jsx)(se().A,{avatar:{email:t},size:28})}function Hn(e){const{children:t}=e,n=(0,r().IS)((()=>({wrapper:{position:"relative"},shield:{position:"absolute",insetInlineStart:17,top:18}})),[]);return(0,P.jsxs)("div",{style:n.wrapper,children:[t,(0,P.jsx)("div",{style:n.shield,children:(0,P.jsx)(Ue().Q,{iconGroup:Wn().u,colorVariant:"secondary",variantName:"mini"})})]})}function Yn(e){const{rows:t,internalDomains:n}=e,i=(0,r().IS)((e=>({inviteTargetList:{background:e.background.secondary,borderRadius:12,maxHeight:227,overflowY:"auto",padding:"12px 16px",width:"100%"}})),[]);return(0,P.jsx)($e().H,{type:He().A.Y,style:i.inviteTargetList,children:(0,P.jsx)(G().Y1,{gap:16,children:t.map((e=>{const{type:t}=e;switch(t){case"new":return(0,P.jsx)($n,{email:e.email,internalDomains:n},e.email);case"existing":return(0,P.jsx)(Qn,{userStore:e.userStore,internalDomains:n},e.userStore.id);default:(0,V().HB)(t)}}))})})}function $n(e){const{email:t,internalDomains:n}=e,i=(0,be().C7)(t,n);return(0,P.jsx)(Zn,{avatar:i?(0,P.jsx)(Hn,{children:(0,P.jsx)(Gn,{email:t})}):(0,P.jsx)(Gn,{email:t}),name:t,email:t})}function Qn(e){const{userStore:t,internalDomains:n}=e,i=(0,d().tz)(),{name:o,email:s}=(0,a().K8)((()=>({name:t.getDisplayName(i),email:t.getEmail()})),[t,i]);if(!o||!s)return null;const r=(0,be().C7)(s,n);return(0,P.jsx)(Zn,{avatar:r?(0,P.jsx)(Hn,{children:(0,P.jsx)(se().A,{userStore:t,size:28})}):(0,P.jsx)(se().A,{userStore:t,size:28}),name:o,email:s})}function Zn(e){const{avatar:t,name:n,email:i}=e;return(0,P.jsxs)(G().Y1,{direction:"horizontal",gap:10,align:"center-left",children:[t,(0,P.jsxs)(G().Y1,{gap:2,children:[(0,P.jsx)($().D,{styleKey:"Body/Medium",children:n}),(0,P.jsx)($().D,{styleKey:"Caption/Regular",colorVariant:"secondary",children:i})]})]})}function Jn(e){const{type:t}=e;switch(t){case"new":return e.email;case"existing":return e.userStore.getEmail();default:(0,V().HB)(t)}}function Xn(e){var t;const{inviteUserListRows:n,spaceStore:o,spaceUserStore:r,onClickAddMembers:l,onClickManageGuests:c}=e,u=(0,s().v3)(),p=(0,d().tz)(),[g,m]=(0,a().K8)((()=>[o.id,o.getName()]),[o]),f=(0,a().K8)((()=>null==r?void 0:r.getUserId()),[r]),h=(0,a().K8)((()=>{var e;return(null===(e=qn().A.getData(u,{spaceId:g}))||void 0===e?void 0:e.map((e=>e.domain)))??[]}),[u,g]),v=(0,Te()._X)({name:"internal_guests",spaceId:g,userId:f,amount:0}),y=(0,i.useCallback)((()=>{const e=n.map(Jn).filter(V().O9);l(e)}),[n,l]);if(!v||0===h.length)return null;const b=(null===(t=Kn().oE(n.filter((e=>"new"===e.type)).map((e=>(0,be().CH)(e.email,h))))[0])||void 0===t?void 0:t.url)??h[0].url;return(0,P.jsx)(ve().N,{debugName:"AddAsMembersModalContent",capture:!0,onEnter:y,children:(0,P.jsx)(Vn().tf,{header:(0,P.jsx)(Vn().YA,{iconAndTitle:(0,P.jsx)(Vn().ZQ,{iconGroup:zn().A,iconColorVariant:"secondary",title:p.formatMessage(ti.title,{spaceName:m,guestLimit:v.limit.total})}),description:p.formatMessage(ti.description,{domain:b,b:e=>(0,P.jsx)("b",{children:e})})}),footer:(0,P.jsx)(ei,{rowCount:n.length,onClickAddMembers:y,onClickManageGuests:c}),children:(0,P.jsx)(Yn,{rows:n,internalDomains:h})})})}function ei(e){const{rowCount:t,onClickAddMembers:n,onClickManageGuests:i}=e,o=(0,d().tz)(),s=o.formatMessage(ti.addMember,{rowCount:t});return(0,P.jsxs)(G().Y1,{gap:16,children:[(0,P.jsxs)(G().Y1,{gap:8,children:[(0,P.jsx)(Un().A,{colorPalette:"blue","aria-label":s,onClick:n,style:{height:32},children:s}),(0,P.jsx)(Y().A,{size:"lg","aria-label":o.formatMessage(ti.manageGuestsInSettings),onClick:i,children:o.formatMessage(ti.manageGuestsInSettings)})]}),(0,P.jsx)("div",{style:{textAlign:"center"},children:(0,P.jsx)($().D,{styleKey:"Caption/Regular",colorVariant:"secondary",children:o.formatMessage(ti.billingNotice)})})]})}const ti=(0,d().YK)({title:{id:"addAsMembersModal.title",defaultMessage:"{spaceName} is over the guest limit of {guestLimit}"},description:{id:"addAsMembersModal.description",defaultMessage:"Shares to work email domains ending with <b>@{domain}</b> must be added as members with access to your entire workspace."},addMember:{id:"addAsMembersModal.addMember",defaultMessage:"Add {rowCount, plural, one {member} other {{rowCount} members}}"},manageGuestsInSettings:{id:"addAsMembersModal.manageGuestsInSettings",defaultMessage:"Manage guests in settings"},billingNotice:{id:"addAsMembersModal.billingNotice",defaultMessage:"Each new member will be billed as an additional seat"}});n(16280);var ni=()=>n(165358),ii=()=>n(319625),oi=()=>n(229833),si=()=>n(763824),ai=()=>n(901389),ri=()=>n(471995),li=()=>n(402390),di=()=>n(579627),ci=()=>n(972435);async function ui(e){const{environment:t,email:n}=e,i=await Dt().callApi({eventName:"findUser",environment:t,data:{email:n}});if("success"===i.type){const e=i.data;if(e.value)return e.value.value.id}return await async function(e){const{environment:t,email:n}=e,i=await Dt().callApi({eventName:"createEmailUser",environment:t,data:{email:n,preferredLocaleOrigin:"inferred_from_inviter",preferredLocale:(0,li().H)(ci().A.getIntl())}});if("failed"===i.type)throw i.error;return i.data.userId}({environment:t,email:n})}async function pi(e){const{blockPermissionItem:t,blockStore:n,environment:i,metadata:o,sudoModeStore:s}=e;await di().J4({environment:i,store:n,sudoModeStore:s,permissionItems:[t],invite:o,skipGuestLimitValidation:!0})}var gi=()=>n(31082);const mi=(0,d().YK)({nonAdminCannotEditPermissions:{defaultMessage:"You do not have permission to invite guests to this page. Ask an admin to send the invite.",id:"permissions.nonAdminCannotEditPermissions.message"},guestsAreNotAllowed:{defaultMessage:"Members cannot invite guests to pages in this workspace. Ask an admin to send the invite.",id:"shareMenu.guestsAreNotAllowed.message"},unexpectedProcessInviteFailure:{defaultMessage:"Failed to process invite",id:"shareMenu.unexpectedProcessInviteFailure.message"}});async function fi(e){const{environment:t,intl:n,internalDomains:i,destination:o,invites:s,metadata:a,sudoModeStore:r,contextualInviteStore:l}=e,d=await async function(e){const{environment:t,invites:n,destination:i,metadata:o,sudoModeStore:s,contextualInviteStore:a}=e,r=(await(0,si().lX)(n,20,(e=>async function(e){const{invite:t,environment:n,destination:i}=e,{store:o,spaceStore:s}=i,{defaultAddability:a}=t;try{switch(a.type){case"none":throw new Error("Cannot send invite with none addability type");case"member":return await async function(e){const{environment:t,invite:n,destination:i,metadata:o}=e,{invitee:s,defaultAddability:a}=n;if(void 0===s)throw new Error("Expected invite.invitee to be defined");const{email:r}=s,{role:l,store:d,spaceMembershipType:c,spaceStore:u}=i,{inviteOrigin:p}=o,g=await ui({environment:t,email:r});if(!g)throw new Error("Invitee user not found");const m={type:"user",membershipType:c,userId:g,inviteId:void 0},f={type:"user_permission",role:l,user_id:g};await async function(e){const{blockPermissionItem:t,blockStore:n,environment:i,inviteOrigin:o,spaceActor:s,spaceStore:a,sudoModeStore:r}=e;if(t.user_id!==s.userId)throw new Error("User IDs for block and space permission items must match");if(!a.isTeamsEnabled()&&!(await q().oH({environment:i,flowId:"",trackCreateTeamComplete:!1})))throw new Error("Failed to enable teams before creating member.");await di().dz({environment:i,store:a,actors:[s],invite:{inviteOrigin:o}}),await di().J4({environment:i,store:n,sudoModeStore:r,permissionItems:[t],skipGuestLimitValidation:!0,invite:{inviteOrigin:o}})}({blockPermissionItem:f,blockStore:d,environment:t,inviteOrigin:p,spaceActor:m,spaceStore:u});const h="member"===a.type&&"over_internal_guest_limit"===a.reason;return{type:"createdMember",invite:n,inviteeUserId:g,spaceActor:m,blockPermissionItem:f,wasInternalDomainEnforced:h}}(e);case"member_request":return await async function(e){const{environment:t,invite:n,destination:i,metadata:o}=e,{invitee:s,internalDomain:a}=n;if(void 0===s)throw new Error("Expected invite.invitee to be defined");const{email:r}=s,{spaceStore:l}=i,{inviteMessage:d}=o,c=await ui({environment:t,email:r});if(!c)throw new Error("Invitee user not found");await async function(e){const{environment:t,spaceStore:n,inviteeUserId:i,inviteMessage:o}=e;if(n.canAdmin())throw new Error("This operation is not valid for workspace owners, because member requests are immediately approved when created by a workspace owner. Use createMember instead.");const s=await Dt().callApi({eventName:"requestAccess",environment:t,data:{type:"actor-to-space",forActorId:i,spaceId:n.id,message:o}});if("failed"===s.type)throw s.error}({environment:t,inviteeUserId:c,inviteMessage:d,spaceStore:l});const u=void 0!==a;return{type:"createdMemberRequest",invite:n,wasInternalDomainEnforced:u}}(e);case"guest":case"guest_page_add":case"member_page_add":return await async function(e){const{environment:t,invite:n,destination:i,metadata:o,sudoModeStore:s}=e,{invitee:a}=n;if(void 0===a)throw new Error("Expected invite.invitee to be defined");const{email:r}=a,{role:l,store:d}=i,c=await ui({environment:t,email:r});if(!c)throw new Error("Invitee user not found");const u={type:"user_permission",role:l,user_id:c};return await pi({blockPermissionItem:u,blockStore:d,environment:t,metadata:o,sudoModeStore:s}),{type:"addedUserPermission",invite:n,inviteeUserId:c,blockPermissionItem:u}}(e);case"guest_request":return await async function(e){const{environment:t,invite:n,destination:i,metadata:o}=e;if(void 0===n.invitee)throw new Error("Expected invite.invitee to be defined");const{email:s}=n.invitee,{role:a,store:r,spaceStore:l}=i,{inviteMessage:d}=o,c={id:r.id,spaceId:l.id},u=await ui({environment:t,email:s});if(!u)return;return await async function(e){const{block:t,blockRole:n,environment:i,inviteeUserId:o,inviteMessage:s}=e,a=await Dt().callApi({eventName:"requestAccess",environment:i,data:{type:"guest-invite-request",block:t,forActorId:o,message:void 0,attributes:{role:n,inviteMessage:s}}});if("failed"===a.type)throw a.error}({block:c,blockRole:a,environment:t,inviteeUserId:u,inviteMessage:d}),{type:"createdGuestRequest",invite:n}}(e);case"group":return await async function(e){const{environment:t,invite:n,destination:i,metadata:o,sudoModeStore:s}=e,{role:a,store:r}=i;if("group"!==n.inviteTarget.type)throw new Error("Expected invite.inviteTarget to be a group");const l=n.inviteTarget.value,d={type:"group_permission",role:a,group_id:l.group_id};return await pi({blockPermissionItem:d,blockStore:r,environment:t,metadata:o,sudoModeStore:s}),{type:"addedGroupPermission",invite:n,group:l,blockPermissionItem:d}}(e);default:(0,V().HB)(a)}}catch(l){var r;const e=(0,ii().A)(l).message,i={miscDataToConvertToString:{message:e,spaceId:s.id,blockId:o.id,actorUserId:n.currentUser.id,inviteeEmail:null===(r=t.invitee)||void 0===r?void 0:r.email,defaultAddabilityType:a.type}};let d,c;e.toLowerCase().includes("non-admin cannot edit permissions")?(d=!0,c="nonAdminCannotEditPermissions"):e.toLowerCase().includes("guests are not allowed")?(d=!0,c="guestsAreNotAllowed"):(d=!1,c="unexpectedProcessInviteFailure"),ni().log({level:d?"info":"error",error:d?void 0:(0,oi().convertErrorToLog)(l),spaceId:s.id,from:"processInvite",type:c,data:i});const u=ci().A.formatMessage(mi[c]);return void(d?ai().rG({message:u}):ai().f1(u))}}({environment:t,invite:e,destination:i,metadata:o,sudoModeStore:s})))).filter(V().O9);if(a){const e={};for(const t of r)"addedUserPermission"!==t.type&&"createdMember"!==t.type||"group"===t.invite.inviteTarget.type||(e[t.invite.inviteTarget.value.email]=t.inviteeUserId);a.setState({...a.state,invitedEmailToUserIdMap:e})}return r}({destination:o,environment:t,invites:s,metadata:a,sudoModeStore:r,contextualInviteStore:l});return(0,gi().Bw)({destination:o,environment:t,internalDomains:i,inviteResults:d,metadata:a}),0!==d.length&&(ri().D6({label:hi({invites:s,intl:n})}),!0)}function hi(e){var t;const{invites:n,intl:i}=e,o=null===(t=n[0].invitee)||void 0===t?void 0:t.email;o||i.formatMessage({id:"shareMenu.inviteResultsToast.label",defaultMessage:"Successfully sent"});const s=n.length-1;return n.filter((e=>(0,Oe().bb)(e.invitee))).length===n.length?s<=0?i.formatMessage({id:"shareMenu.inviteResultsToast.inviteGuest.label",defaultMessage:"Invite sent to {firstInvitee}"},{firstInvitee:o}):i.formatMessage({id:"shareMenu.inviteResultsToast.inviteGuests.label",defaultMessage:"Invite sent to {firstInvitee} and {numAdditionalInvites, plural, one {{numAdditionalInvites} other person} other {{numAdditionalInvites} others}}"},{firstInvitee:o,numAdditionalInvites:s}):s<=0?i.formatMessage({id:"shareMenu.inviteResultsToast.shareWithMember.label",defaultMessage:"Shared with {firstInvitee}"},{firstInvitee:o}):i.formatMessage({id:"shareMenu.inviteResultsToast.shareWithMultiple.label",defaultMessage:"Shared with {firstInvitee} and {numAdditionalInvites, plural, one {{numAdditionalInvites} other person} other {{numAdditionalInvites} others}}"},{firstInvitee:o,numAdditionalInvites:s})}function vi(e){e.reset(),U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.MainShareMenu,source:U().mc.ShareTopbarButton})}async function yi(e){const{addAsMembersResult:t,destination:n,environment:i,internalDomains:o,intl:s,invites:a,inviteTargetsStore:r,metadata:l}=e;var d;t&&("manageGuests"===t?(d="members",Ke().A.setState({currentTab:d,defaultSubtab:void 0,highlightedSetting:void 0,open:!0,openedFrom:"share_menu"})):"addMembers"===t?(vi(r),await fi({destination:n,environment:i,internalDomains:o,invites:a,intl:s,metadata:l})):(0,V().HB)(t))}async function bi(e){const{destination:t,contextualInviteStore:n,defaultAddabilities:i,metadata:o,invites:s,environment:a,internalDomains:r,intl:l,inviteTargetsStore:d,spaceStore:c,spaceUserStore:u,sudoModeStore:p}=e,g=s.map((e=>e.defaultAddability)).some((e=>"member"===e.type&&"over_internal_guest_limit"===e.reason)),m=s.map((e=>e.defaultAddability)).some((e=>["guest","guest_request","guest_page_add"].includes(e.type)));if(g){const e=s.map((e=>function(e){const{inviteTarget:t,environment:n}=e,{type:i}=t;switch(i){case"existingUser":return{type:"existing",userStore:new($t().L)(n,{table:ee().oo,id:t.value.id})};case"newUser":return{type:"new",email:t.value.email};case"group":return;default:(0,V().HB)(i)}}({environment:a,inviteTarget:e.inviteTarget}))).filter(V().O9),n=await async function(e){const{inviteUserListRows:t,spaceStore:n,spaceUserStore:i}=e;return await Fn().T.showAsyncModal((e=>(0,P.jsx)(Nn().s,{isOpen:e.isOpen,onDismiss:e.onDismiss,onClosed:e.onClosed,areaConstraint:{width:{type:"fixed",length:400}},render:()=>(0,P.jsx)(Xn,{inviteUserListRows:t,spaceStore:n,spaceUserStore:i,onClickAddMembers:()=>{e.resolve("addMembers")},onClickManageGuests:()=>{e.resolve("manageGuests")}})})))}({inviteUserListRows:e,spaceStore:c,spaceUserStore:u});await yi({addAsMembersResult:n,destination:t,environment:a,internalDomains:r,intl:l,invites:s,inviteTargetsStore:d,metadata:o})}else{vi(d);if(!(await fi({destination:t,environment:a,internalDomains:r,intl:l,invites:s,metadata:o,sudoModeStore:p,contextualInviteStore:n})))return;const e=s.map((e=>e.invitee)).filter(V().O9);m&&function(e){const{contextualInviteStore:t,defaultAddabilities:n,environment:i,invitees:o,spaceStore:s}=e,a=o.filter((e=>function(e){const t=e.type;return["guest","guest_request","guest_page_add"].includes(t)}(n[e.email]))).map((e=>({email:e.email,isGuest:(0,Oe().bb)(e)})));t.setState({...t.state,invitedUsers:a}),K().BY({environment:i,spaceStore:s,contextualInviteStore:t})}({contextualInviteStore:n,environment:a,spaceStore:c,defaultAddabilities:i,invitees:e})}}function Si(e){const{tooltip:t,disabled:n,onClick:i}=e;return(0,P.jsx)(St().A,{disableTooltip:!Boolean(t),renderTooltip:()=>t,render:e=>(0,P.jsx)(Un().A,{colorPalette:"blue",size:"lg",style:{marginInlineStart:8,borderRadius:6,paddingInlineStart:12,paddingInlineEnd:12},disabled:n,onClick:i,...e,children:(0,P.jsx)(d().sA,{id:"shareMenu.inviteButton.invite",defaultMessage:"Invite"})})})}var xi=()=>n(401996),Ai=()=>n(856952),Mi=()=>n(381374),wi=()=>n(568999),ji=()=>n(835470),ki=()=>n(822423),Ii=()=>n(888867),Ci=()=>n(120251);const Ti=(0,d().YK)({autojoinMember:{defaultMessage:"{email} will automatically be added to the workspace since @{domain} is an allowed email domain",id:"inviteTargetToken.autojoinMember.tooltip"},guestsDisabledMember:{defaultMessage:"Since guests are disabled, {email} will automatically be added to the workspace as a member",id:"inviteTargetToken.guestsDisabledMember.tooltip"},guestV2:{defaultMessage:"Invite {email} as a guest",id:"inviteTargetToken.guest.tooltipV2"},guestRequest:{id:"inviteTargetToken.guestRequest.tooltip",defaultMessage:"This guest must be approved by a workspace owner first"},invalidUser:{defaultMessage:"{text} is not a valid email",id:"inviteTargetToken.invalidUser.tooltip"},overInternalGuestLimit:{id:"inviteTargetToken.overInternalGuestLimit.tooltip",defaultMessage:"This workspace has reached its internal guest limit"},disabledByAdmins:{id:"inviteTargetToken.disabledByAdmins.tooltip",defaultMessage:"Inviting users has been disabled by admins for this page"},restrictedMembersdisabledByAdmins:{id:"inviteTargetToken.restrictedMembersdisabledByAdmins.tooltip",defaultMessage:"Inviting restricted members has been disabled by admins for this page"},notAuthorizedDomain:{id:"inviteTargetToken.notAuthorizedDomain.tooltip",defaultMessage:"{email} does not belong to an allowed email domain"}});function _i(e){const{inviteTarget:t,defaultAddability:n,onClickRemove:o}=e,s=function(e,t){if("group"===e.type)return"gray";if("invalidUser"===e.type)return"red";if("existingUser"!==e.type&&"newUser"!==e.type)return(0,V().HB)(e);if(void 0===t)return"red";if("member"===t.type)return"autojoin_domain"===t.reason||"guests_disabled"===t.reason?"green":"over_internal_guest_limit"===t.reason?"yellow":(0,V().HB)(t.reason);if("member_request"===t.type)return"red";if("member_page_add"===t.type)return"gray";if("guest"===t.type)return"yellow";if("guest_request"===t.type)return"yellow";if("guest_page_add"===t.type)return"yellow";if("none"===t.type){if("must_upgrade"===t.reason)return"yellow";if("over_internal_guest_limit"===t.reason)return"red";if("over_general_guest_limit"===t.reason)return"red";if("disabled_by_admins"===t.reason)return"red";if("restricted_members_disabled_by_admins"===t.reason)return"red";if("not_authorized_domain"===t.reason)return"red";if("invalid_email"===t.reason)return"red";if("other"===t.reason)return"red";(0,V().HB)(t.reason)}else(0,V().HB)(t)}(t,n),a=(0,d().tz)(),r=Bi(s),l=(0,i.useCallback)((()=>{o(t)}),[t,o]),c=function(e){const{inviteTarget:t,defaultAddability:n,intl:i}=e,o=Pe(t),s=t.type;if("group"===s)return;if("invalidUser"===s)return i.formatMessage(Ti.invalidUser,{text:t.value.text});if(!o)return;if("existingUser"!==s&&"newUser"!==s)return(0,V().HB)(s);if(void 0===n)return;if("none"===n.type){if("must_upgrade"===n.reason)return;if("other"===n.reason)return;if("over_internal_guest_limit"===n.reason)return i.formatMessage(Ti.overInternalGuestLimit);if("over_general_guest_limit"===n.reason)return i.formatMessage(Ti.overInternalGuestLimit);if("disabled_by_admins"===n.reason)return i.formatMessage(Ti.disabledByAdmins);if("restricted_members_disabled_by_admins"===n.reason)return i.formatMessage(Ti.restrictedMembersdisabledByAdmins);if("not_authorized_domain"===n.reason)return i.formatMessage(Ti.notAuthorizedDomain,{email:o});if("invalid_email"===n.reason)return i.formatMessage(Ti.invalidUser,{text:"unknown"});(0,V().HB)(n.reason)}if("member"===n.type)return"autojoin_domain"===n.reason?i.formatMessage(Ti.autojoinMember,{email:o,domain:(0,ye().zN)(o)}):"guests_disabled"===n.reason?i.formatMessage(Ti.guestsDisabledMember,{email:o}):"over_internal_guest_limit"===n.reason?o:(0,V().HB)(n.reason);if("member_request"===n.type)return i.formatMessage(Ti.disabledByAdmins);if("member_page_add"===n.type)return o;if("guest"===n.type)return i.formatMessage(Ti.guestV2,{email:o});if("guest_request"===n.type)return i.formatMessage(Ti.guestRequest);if("guest_page_add"===n.type)return i.formatMessage(Ti.guestV2,{email:o});(0,V().HB)(n)}({inviteTarget:t,defaultAddability:n,intl:a});return(0,P.jsx)(St().A,{placement:"top",renderTooltip:()=>c,disableTooltip:!c,render:e=>(0,P.jsx)("div",{style:{maxWidth:"100%"},...e,children:(0,P.jsxs)(G().Y1,{gap:2,style:r.token,borderRadius:4,padding:"2px 4px",width:"hug",children:[(0,P.jsxs)(G().Y1,{align:"center-left",borderRadius:3,direction:"horizontal",gap:4,width:"hug",children:[(0,P.jsx)(Pi,{inviteTarget:t,tokenColor:s}),(0,P.jsx)($().D,{colorPalette:s,colorVariant:"primary",styleKey:"Body/Regular",style:r.label,children:Li(t,a)}),(0,P.jsx)(Kt().Ay,{hoveredStyle:r.removeButtonHovered,pressedStyle:r.removeButtonPressed,onClick:l,children:(0,P.jsx)(Ue().Q,{iconGroup:Ci().k,colorVariant:"secondary",variantName:"small"})})]}),(0,P.jsx)(Ce,{featureGateId:"guest_limit_debug_ui",whenEnabled:(0,P.jsx)("div",{style:{marginInlineStart:24,paddingBottom:2},children:(0,P.jsx)($().D,{colorVariant:"secondary",styleKey:"Caption/Medium",children:null==n?void 0:n.type})}),whenDisabled:null})]})})})}function Pi(e){const{inviteTarget:t,tokenColor:n}=e,i=Bi(n);switch(n){case"green":return(0,P.jsx)(Ue().Q,{iconGroup:wi().g,colorPalette:"green",colorVariant:"accentPrimary",variantName:"small"});case"yellow":return(0,P.jsx)(Ue().Q,{iconGroup:ki().u,colorPalette:"yellow",colorVariant:"accentPrimary",variantName:"small"});case"red":return(0,P.jsx)(Ue().Q,{iconGroup:ji().F,colorPalette:"red",colorVariant:"accentPrimary",variantName:"small"});case"gray":return"existingUser"===t.type?(0,P.jsx)(G().Y1,{align:"center",width:20,height:20,children:(0,P.jsx)(se().A,{userValue:t.value,size:16})}):(0,P.jsx)("div",{style:i.iconCircle,children:(0,Ii().s)(i.icon)});default:(0,V().HB)(n)}}function Bi(e){return(0,r().IS)((t=>({token:Di(e,t),iconCircle:{alignItems:"center",backgroundColor:t.white,borderRadius:"50%",display:"flex",height:16,justifyContent:"center",width:16},icon:{color:t.icon.secondary,height:12,width:12},label:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},removeButtonHovered:{background:"transparent",opacity:.8},removeButtonPressed:{background:"transparent",opacity:.6}})),[e])}function Di(e,t){return{background:Ri(e,t),border:Ei(e,t)}}function Ri(e,t){switch(e){case"green":return t.green.background.secondary;case"yellow":return t.yellow.background.secondary;case"red":return t.red.background.secondary;case"gray":return t.legacyDefaultSelectColor;default:(0,V().HB)(e)}}function Ei(e,t){switch(e){case"red":return`1px dashed ${t.red.border.strong}`;case"green":case"yellow":case"gray":return;default:(0,V().HB)(e)}}function Li(e,t){const{type:n}=e;switch(n){case"newUser":return e.value.email.trim();case"invalidUser":return e.value.text.trim();case"existingUser":return X().Bj6.fromValue(ee().oo,e.value).getDisplayName(t);case"group":return(0,Zt().Pf)({intl:t,groupName:e.value.name});default:(0,V().HB)(n)}}function Oi(e){const{addabilities:t,disabled:n,metadata:l,focus:d,onFocus:c,onInputChanged:u,onSubmit:p,placeholder:g,right:m,showEmptyError:f,setAutoFocusInput:h}=e,v=(0,s().v3)(),y=(0,a().uB)(e.inviteTargetsStore,pe().Ay),b=(0,a().K8)((()=>y.state.inviteTargets),[y]),S=function(e){const{disabled:t,hasTokens:n}=e;return(0,r().IS)((e=>({tokenSpan:{maxWidth:"100%"},inputRightItemStyle:{alignSelf:"flex-start"},inputOuterStyle:{borderRadius:6,...t&&{background:e.inputBackground,color:e.text.secondary,fill:Rn().Tj.white,opacity:.4},alignItems:"flex-start"},inputAndTokenWrapRight:{gap:2},inputInnerStyle:{...!n&&{padding:2}},warningMessage:{color:"#DE5550"}})),[n,t])}({disabled:n,hasTokens:b.length>0}),x=(0,a().K8)((()=>y.state.tokenQuery),[y]),A=(0,a().K8)((()=>0===y.state.tokenQuery.trim().length),[y]),M=(0,i.useCallback)((e=>{xi().S({inviteTargetsStore:y,targetToRemove:e})}),[y]);return b?(0,P.jsx)(Ai().Ay,{focus:d,focusAfterAnimation:!0,onClick:()=>{o().A.isMobile||null==c||c()},format:Ai().le.Share,value:x,onChange:e=>{if(A){const e=U().Ay.state;U().Ay.setState({...e,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:e.display===U().pP.Invite?e.source:U().NL.Notion,emailMessage:e.display===U().pP.Invite?e.emailMessage:""}),null==h||h(!1)}xi().P({environment:v,event:e,inviteTargetsStore:y,inviteOrigin:l.inviteOrigin,flowId:l.inviteFlowId,onInputChanged:u})},type:"email",tokens:b.map(((e,n)=>(0,P.jsx)(_i,{inviteTarget:e,onClickRemove:M,defaultAddability:Ni(e,t)},n))),disabled:n,autoComplete:"off",placeholder:g,onRemoveLastToken:()=>{y.setState({...y.state,inviteTargets:y.state.inviteTargets.slice(0,-1)})},right:m,rightWrapStyle:S.inputRightItemStyle,showBorder:!0,inputStyle:S.inputInnerStyle,inputAndTokenWrapRightStyle:S.inputAndTokenWrapRight,style:S.inputOuterStyle,onSubmit:p,inputFullWidth:!0,message:(0,P.jsx)(Mi().p,{invalidInvites:(0,Kn().oE)(b.map((e=>"invalidUser"===e.type?e:void 0))),showEmptyError:f,styles:S.warningMessage})}):null}function Ni(e,t){const n=Pe(e);if(n)return null==t?void 0:t[n]}var Fi=()=>n(594607),Ui=()=>n(953006),zi=()=>n(21140),Ki=()=>n(51367);const Vi="sharing_contacts_import_tooltip";function qi(e){const{originRef:t,onPrimaryButtonClick:n}=e,o=(0,s().v3)(),r=(0,a().K8)((()=>Ie().default.getEligibleGroup({experimentId:"microsoft_contacts_import",defaultGroup:"control"})),[]),l=(0,a().K8)((()=>M().default.isVisible(Vi)),[]),c=(0,i.useCallback)((()=>{(0,Ki().Sq)(o,{callout_key:Vi,placement_key:"Tooltip",dismiss_type:"tooltip_dismiss"}),(0,On().a)(o,Vi)}),[o]),u=(0,i.useCallback)((()=>{(0,Ki().Y5)(o,{callout_key:Vi,placement_key:"Tooltip",click_type:"primary_cta"}),n()}),[o,n]);if("control"===r||!l)return null;const p="generic_tooltip"===r?(0,P.jsxs)(zi().wt,{gap:10,children:[(0,P.jsxs)(zi().Ye,{gap:5,children:[(0,P.jsx)(Ue().Q,{iconGroup:Gt().j,variantName:"default",style:{height:20,width:20}}),(0,P.jsx)(Ue().Q,{iconGroup:qt().m,variantName:"default",style:{height:20,width:20}}),(0,P.jsx)(Ue().Q,{iconGroup:Wt().g,variantName:"default",style:{height:20,width:20}})]}),(0,P.jsx)(d().sA,{id:"contacts_import_invite_tooltip.ms.header",defaultMessage:"Import contacts from Google, Slack, or Microsoft"})]}):(0,P.jsxs)(zi().wt,{gap:10,children:[(0,P.jsx)(Ue().Q,{iconGroup:Wt().g,variantName:"default",style:{height:20,width:20}}),(0,P.jsx)(d().sA,{id:"contacts_import_invite_tooltip.generic.header",defaultMessage:"You can now import contacts from Microsoft!"})]}),g="generic_tooltip"===r?(0,P.jsx)(d().sA,{id:"contacts_import_invite_tooltip.generic.content",defaultMessage:"Collaborate faster by importing contacts from your favorite tools."}):(0,P.jsx)(d().sA,{id:"contacts_import_invite_tooltip.ms.content",defaultMessage:"Notion now supports contact import from Outlook, Microsoft contacts, and more."});return(0,P.jsx)(Fi().B,{calloutId:Vi,shouldShow:l,onShow:()=>{(0,Ki().DL)(o,{callout_key:Vi,placement_key:"Tooltip"})},children:(0,P.jsx)(Ui().k,{style:{marginInlineEnd:20},origin:t,placementToOrigin:"left",alignmentToOrigin:"start",numSteps:1,header:p,content:g,showPointer:!1,finalButtonContent:(0,P.jsx)(d().sA,{id:"contacts_import_invite_tooltip.finalButtonContent",defaultMessage:"Get started"}),skipButtonContent:(0,P.jsx)(d().sA,{id:"contacts_import_invite_tooltip.skipButtonContent",defaultMessage:"Not now"}),onSkipButtonClick:c,onPrimaryButtonClick:u,onCloseClick:c,shouldDismissUponOutsideClick:!0})})}var Wi=()=>n(133507);function Gi(e){const{onClick:t,featureAvailability:n}=e;return(0,P.jsx)(St().A,{disableTooltip:!1,renderTooltip:()=>(0,P.jsx)(Wi().j,{featureAvailability:n}),render:e=>(0,P.jsx)(Un().A,{colorPalette:"blue",size:"lg",style:{marginInlineStart:8},onClick:t,...e,children:(0,P.jsx)(d().sA,{id:"shareMenu.inviteButton.upgrade",defaultMessage:"Upgrade"})})})}const Hi=1e3;function Yi(e){const{store:t,contextualInviteStore:n,defaultAddabilities:o,internalDomains:c,inviteTargetsStore:u,invites:p,metadata:g,spaceMembershipType:m,spaceStore:f,spaceUserStore:h,sudoModeStore:v}=e,y=(0,s().v3)(),b=(0,d().tz)(),S=(0,r().IS)((()=>({permissionsRoleSelectButton:{display:"flex",whiteSpace:"nowrap",height:24,borderRadius:4,color:Rn().Tj.uiGray}})),[]),[x,A]=(0,i.useState)("editor"),[M,w]=(0,i.useState)(!1),{source:j,focus:k,emailMessage:I,display:C}=(0,a().K8)((()=>{const{display:e}=U().Ay.state;return e===U().pP.Invite?U().Ay.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),T=(0,a().K8)((()=>{if(t.table===l().ev)return t.getType()}),[t]),{inviteTargets:_,inputFieldText:B}=(0,a().K8)((()=>({inviteTargets:(0,Me().U1)({inviteTargetsStore:u,includeInputFieldText:!0}),inputFieldText:u.state.tokenQuery.trim()})),[u]),D=async()=>{if(!M&&o&&c){if(0===_.length){const e=U().Ay.state;return U().Ay.setState({...e,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:e.display===U().pP.Invite?e.source:U().NL.Notion,emailMessage:e.display===U().pP.Invite?e.emailMessage:""}),void z().UC(y,{source:"invite_button"})}w(!0);try{const e={role:x,store:t,spaceMembershipType:m,spaceStore:f};await bi({contextualInviteStore:n,defaultAddabilities:o,destination:e,environment:y,internalDomains:c,intl:b,invites:p,inviteTargetsStore:u,metadata:g,spaceStore:f,spaceUserStore:h,sudoModeStore:v})}finally{w(!1)}}},R=(0,Oe().sf)(p.map((e=>e.invitee)).filter(V().O9)),E=(0,a().K8)((()=>h.getUserId()),[h]),L=(0,Te()._X)({name:"guests",spaceId:f.id,userId:E,amount:R}),O=(0,a().K8)((()=>t.canEditMembership()),[t]),N=t.table===l().ev,F=(0,Ln().i0)(N?t:void 0),K=(0,Ln().ty)(N?t:void 0),q=Object.values(o??{}).some((e=>"none"===e.type||"member_request"===e.type)),W=I.length>Hi,G=M||!O||F||K,[H,Y]=(0,i.useState)(!G),$=(0,i.useRef)(null),Q=(0,a().K8)((()=>"control"!==Ie().default.getEligibleGroup({experimentId:"microsoft_contacts_import",defaultGroup:"control"})),[]);return(0,i.useEffect)((()=>{Q&&(0,On().HH)(y,Vi)}),[y,Q]),(0,P.jsx)(St().A,{disableTooltip:O&&!F&&!K,placement:"left",renderTooltip:()=>O?F?(0,P.jsx)(d().sA,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.pageInTrash",defaultMessage:"Restore page from trash to add people"}):K?(0,P.jsx)(d().sA,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.hasAIEdits",defaultMessage:"Resolve pending edits to add people"}):void 0:(0,P.jsx)(d().sA,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.needFullAccessRedesign",defaultMessage:"Request full access to share with others"}),render:e=>(0,P.jsxs)("div",{style:{display:"flex"},...e,ref:$,children:[(0,P.jsx)(qi,{originRef:$,onPrimaryButtonClick:()=>{U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:j||U().NL.Notion,emailMessage:I||""}),z().Wd(y,{source:j||U().NL.Notion}),0===_.length&&z().UC(y,{source:"invite_button"}),(0,On().a)(y,Vi)}}),(0,P.jsx)(Oi,{inviteTargetsStore:u,metadata:g,focus:k===U().yZ.Search||C===U().pP.MainShareMenu&&H,setAutoFocusInput:Y,addabilities:o,disabled:G,onFocus:()=>{U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:j||U().NL.Notion,emailMessage:I||""}),z().Wd(y,{source:j||U().NL.Notion}),0===_.length&&z().UC(y,{source:"invite_button"})},onSubmit:()=>{B.length>0||D()},placeholder:b.formatMessage({id:"shareMenu.inviteTargetsInput.placeholder.exp",defaultMessage:"Email or group, separated by commas"}),right:B.length>0&&U().Ay.getState().display===U().pP.Invite||_.length>0?(0,P.jsx)(En().Ay,{disabled:!O||F||K,role:x,table:t.table,type:"user_permission",blockType:T,isInvite:!0,upgradeButtonName:"invite_permission_block",buttonStyle:S.permissionsRoleSelectButton,isMenuItem:!1,onChange:e=>A(e)}):void 0}),L?(0,Te().N9)(L,{available:()=>(0,P.jsx)(Si,{tooltip:I.length>Hi?(0,P.jsx)(d().sA,{id:"shareMenu.inviteButton.emailOverMaxLength.tooltip",defaultMessage:"Message exceeds the limit of 1000 characters."}):void 0,disabled:!O||F||K||q||W,onClick:D}),unavailable:e=>(0,P.jsx)(Gi,{featureAvailability:e,onClick:()=>{U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:void 0,source:j||U().NL.Notion,emailMessage:I||""}),gt().D6({environment:y,upgradeButtonName:"user_permission_item"})}})}):void 0]})})}var $i=()=>n(347930),Qi=()=>n(134217);const Zi=function(e){const t=(0,r().DP)(),{buttonStyle:n}=(0,r().IS)((e=>({buttonStyle:{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,whiteSpace:"nowrap",height:28,borderRadius:6,boxShadow:e.shadow2XS,background:e.inputBackground,color:e.text.secondary,fill:Rn().Tj.white,lineHeight:1.2,paddingInlineStart:12,paddingInlineEnd:12,fontSize:14}})),[]);return(0,P.jsx)(Kt().Ay,{hovered:e.hovered,onClick:e.onClick,disabled:e.disabled,disabledFeedback:!0,style:{...n,...e.isLarge&&{height:32},...e.style},hoveredStyle:{background:t.buttonHoveredBackground},pressedStyle:{background:t.buttonPressedBackground},onFocus:e.onFocus,onBlur:e.onBlur,onMouseDown:e.onMouseDown,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,className:e.className,children:e.children})};const Ji=function(e){const{store:t}=e,{isMobile:i}=(0,s().Y0)(),o=(0,a().K8)((()=>t.canEditMembership()),[t]),c=(0,Ln().i0)(t.table===l().ev?t:void 0),u=(0,Ln().ty)(t.table===l().ev?t:void 0),p=(0,r().IS)((e=>({buttonContainer:{display:"flex",alignItems:"center",gap:Xe().Y3},inputButton:{flex:1,justifyContent:"flex-start",overflow:"hidden",background:e.background.tertiaryTranslucent,borderRadius:10,color:e.text.tertiary,boxShadow:"none",height:i?36:30},inputContent:{display:"flex",alignItems:"center",fontSize:16,fontWeight:400,...j().RC},iconContainer:{fill:e.icon.secondary,marginInlineEnd:8},blueButton:{minWidth:Xe().CO}})),[i]);return(0,P.jsx)(St().A,{renderTooltip:()=>u?(0,P.jsx)(d().sA,{id:"inviteUserButton.tooltip.resolveAIEditsMessage",defaultMessage:"Resolve pending edits to add people"}):(0,P.jsx)(d().sA,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."}),disableTooltip:o&&!c&&!u,render:t=>(0,P.jsxs)("div",{style:p.buttonContainer,...t,children:[(0,P.jsx)(Zi,{onClick:e.onClick,disabled:!o||c||u,style:p.inputButton,children:(0,P.jsx)("div",{style:p.inputContent,children:i?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("div",{style:p.iconContainer,children:(0,n(381138).q)({height:16,width:16})}),(0,P.jsx)(d().sA,{defaultMessage:"Invite people, emails, groups...",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots.mobile"})]}):(0,P.jsx)(d().sA,{defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots"})})}),i?void 0:(0,P.jsx)(Un().A,{colorPalette:"blue",size:"lg",onClick:e.onClick,disabled:!o||c||u,style:p.blueButton,children:(0,P.jsx)(d().sA,{id:"inviteUserButton.invitePersonLabel",defaultMessage:"Invite"})})]})})};function Xi(e){const{store:t}=e,n=(0,s().v3)(),o=(0,s().WS)(),l=(0,x().L)(),c=(0,a().uB)(void 0,O().A),u=(0,a().K8)((()=>c.state.permissionsInviteStore),[c]),p=(0,a().K8)((()=>c.stage),[c]),g=(0,a().K8)((()=>u.state.modalOpen),[u]),m=(0,a().K8)((()=>t.canAdmin()),[t]),f=(0,a().K8)((()=>{const e=qe().subscriptionDataStoreInstance.state;return Boolean(e&&Qi().Fq(e))}),[]),h=(0,a().K8)((()=>(0,F().Xh)({store:t})),[t]),v=(0,r().IS)((e=>({button:{display:"flex",alignItems:"center",minHeight:0,marginBottom:16},buttonInner:{width:"100%"},modalButton:{height:36},requestedUsersToast:{marginBottom:96}})),[]),y=(0,i.useCallback)(((e,t)=>{e&&t>0&&ri().D6({label:(0,P.jsx)(d().sA,{id:"mobileInviteSection.onInviteComplete.toastMessage.requestedUsers",defaultMessage:"Sent request to invite {numRequests, plural, one {a guest} other {{numRequests} guests}}",values:{numRequests:t}}),style:o?v.requestedUsersToast:void 0})}),[o,v.requestedUsersToast]);return p!==L().d5.closed||o&&!m?null:(0,P.jsx)(Kt().Ay,{disabled:!0,style:v.button,children:(0,P.jsxs)("div",{style:v.buttonInner,children:[g&&l?(0,P.jsx)($i().H,{targetStore:t,spaceStore:l,disabled:!m,membersOnly:h,isSubscribed:f,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:v.modalButton,permissionsInviteStore:u,onInviteComplete:y,analyticsFrom:"mobile_invite"}):void 0,(0,P.jsx)(Ji,{store:t,onClick:()=>(0,wt().LH)({environment:n,permissionsInviteStore:u,store:t,isSubscribed:f,renderInShareModal:!1})})]})})}var eo=()=>n(179030);function to(e){const{spaceName:t,domainUrl:n}=e,i=(0,d().tz)();return(0,P.jsx)(eo().l,{tint:"gray",iconGroup:zn().A,label:i.formatMessage(no.label,{spaceName:t}),description:i.formatMessage(no.description,{domain:n}),display:"inline"})}const no=(0,d().YK)({label:{id:"shareMenu.overLimitBanner.label",defaultMessage:"{spaceName} is over the guest limit"},description:{id:"shareMenu.overLimitBanner.description",defaultMessage:"If you share this page to a â€˜@{domain}â€™ email, the invite will be sent to your workspace owners as a request to add them as a member with full access to the workspace."}});function io(e){const{blockStore:t,contextualInviteStore:n,inviteTargetsStore:o,permissionItemArgs:d,spaceStore:c,spaceUserStore:u}=e,p=(0,s().Y0)(),g=p.isMobile,{spaceId:m,spaceName:f,userId:h,spaceModel:v}=(0,a().K8)((()=>({spaceId:c.getSpaceId(),spaceName:c.getName(),userId:u.getUserId(),spaceModel:c.getModel()})),[c,u]),y=(0,a().K8)((()=>(0,we().U)(t)),[t]),[b,S]=(0,a().K8)((()=>[null==u?void 0:u.getModel(),null==y?void 0:y.getModel()]),[u,y]),x=(0,a().K8)((()=>U().Ay.state.display),[]),M=function(e){return(0,r().IS)((()=>({container:{position:"relative",height:"unset",transition:"all",transitionDuration:"0.3s",display:"flex",flexDirection:"column",maxHeight:e?"80vh":530}})),[e])}((0,he().X)("collection_property_permissions")),w=(0,a().uB)(void 0,ke().A),j=(0,a().K8)((()=>n.state.flowId),[n]),k=function(e){const t=(0,s().Y0)();return(0,i.useCallback)((n=>{n.preventDefault(),t.isMobile||e!==U().pP.MainShareMenu||U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:U().NL.Notion,emailMessage:""})}),[t,e])}(x),I=(0,a().K8)((()=>(0,Me().U1)({inviteTargetsStore:o,includeInputFieldText:!0}).map((e=>{const t=function(e){const{inviteTarget:t,spaceStore:n}=e,i=Pe(t);if(!i||"invalidUser"===t.type||"group"===t.type)return;if("newUser"===t.type)return{email:i,currentRole:void 0};const o=(0,A().dp)(n,t.value.id);if(!o.isReady())return;return{email:i,currentRole:o.isPageGuest()?"guest":o.isRestrictedMember()?"restricted_member":o.isMember()?"member":void 0}}({inviteTarget:e,spaceStore:c});return{inviteTarget:e,invitee:t}})).filter(V().O9)),[o,c]),C=(0,_e().m)({space:c,spaceUser:u,team:y,invitees:I.map((e=>e.invitee)).filter(V().O9),store:t}),_=(0,Ae().A)(c),B=I.map((e=>e.invitee)).filter((e=>void 0!==e&&void 0===e.currentRole&&_&&(0,be().C7)(e.email,_))),D=(0,Te()._X)({name:"internal_guests",spaceId:m,userId:h,amount:B.length}),R=(0,Te().P9)({name:"non_admin_members",spaceId:m,userId:h})?"member":"owner",E=(0,xe().r1)({spaceStore:c}),L=(0,a().K8)((()=>{const e=U().Ay.state,t=e.display===U().pP.Invite?e.emailMessage:"";return{inviteFlowId:n.state.flowId,inviteMessage:t,inviteOrigin:"share_menu",shareMenuSessionId:e.sessionId}}),[n]),O=(0,a().K8)((()=>C?I.map((e=>{const{inviteTarget:t,invitee:n}=e,i=null==n?void 0:n.email;let o,s;return"group"===t.type?s={type:"group"}:i?(o=(0,be().CH)(i,_??[]),s=C[i]??{type:"none",reason:"other"}):s={type:"none",reason:"other"},{defaultAddability:s,internalDomain:o,invitee:n,inviteTarget:t}})):[]),[I,C,_]),N=(0,Se().Vi)(D,(()=>{if(!f)return;if(E)return;const e=B[0];if(!e)return;const t=(0,ye().zN)(e.email);return t?(0,P.jsx)(to,{spaceName:f,domainUrl:t}):void 0})),F=(0,he().X)("share_menu_inheritance_banner"),z=(0,a().O$)(je().AppStoreSidebarSpaceViewStore),K=(0,a().K8)((()=>{var e;if(!z)return!1;const n=null===(e=z.getSettings())||void 0===e?void 0:e.agent_personalization_settings;return(null==n?void 0:n.context_page_id)===t.id&&t.table===l().ev}),[z,t]);return(0,P.jsx)(ve().N,{debugName:"ShareMenuShareTab",capture:!0,onTab:k,children:(0,P.jsxs)("div",{style:M.container,children:[(0,P.jsxs)(G().Y1,{direction:"vertical",gap:16,padding:g?`0 ${Be().u6}px 0px ${Be().u6}px`:t.table!==l().ev?`16px ${Be().rL}px 8px ${Be().rL}px`:`0 ${Be().rL}px 8px ${Be().rL}px`,children:[p.isMobile?(0,P.jsx)(Xi,{store:t}):(0,P.jsx)(Yi,{store:t,contextualInviteStore:n,defaultAddabilities:C,internalDomains:_,invites:O,inviteTargetsStore:o,metadata:L,spaceMembershipType:R,spaceStore:c,spaceUserStore:u,sudoModeStore:d.sudoModeStore}),N]}),x===U().pP.MainShareMenu?(0,P.jsxs)(P.Fragment,{children:[K?(0,P.jsx)(Re,{}):void 0,(0,P.jsx)(T().default,{store:t,calculatedPermissions:e.calculatedPermissions,buttonPopupStore:e.buttonPopupStore,permissionItemArgs:d,showPermissionInheritanceBanner:F})]}):void 0,x!==U().pP.Invite||p.isMobile?void 0:(0,P.jsx)(Dn,{store:t,inviteTargetsStore:o,menuListStore:w,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs,flowId:j}),(0,P.jsx)(Ce,{featureGateId:"guest_limit_debug_ui",whenEnabled:(0,P.jsx)(We,{domains:_,spaceId:m,spaceModel:v,userId:h,spaceUserModel:b,teamModel:S,blockStore:t}),whenDisabled:null})]})})}const oo=function(e){const{store:t,sudoModeStore:i}=e,o=(0,a().K8)((()=>i.state.changePermissionsEnabled),[i]),s=(0,a().K8)((()=>{if(!i)return!1;const e=!i.doesUserAlreadyHaveEditorAccess(t.pointer);return"workflow"===t.table?Boolean(i.shouldUserHaveAccessToPrivateWorkflow&&i.shouldUserHaveAccessToPrivateWorkflow())&&e&&Boolean(i.state.privateWorkflowStore):("block"!==t.table||!t.isPeopleCollectionViewPage())&&(Boolean(i.shouldUserHaveAccessToPrivatePageBlock&&i.shouldUserHaveAccessToPrivatePageBlock())&&e&&Boolean(i.state.privatePageStore))}),[i,t]),l=(0,r().IS)((e=>({container:{background:e.cardBackground,padding:"12px 18px",boxShadow:e.shadow2XS,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"baseline"},button:{fontWeight:j().Wy.medium,justifyContent:"center",marginTop:8,opacity:o?.5:1},icon:{transition:"all 200ms ease",transform:o?"rotate(-90deg)":void 0}})),[o]);return s?(0,P.jsxs)("div",{style:l.container,children:[(0,P.jsx)(f().A,{isMultiline:!0,children:(0,P.jsx)(d().sA,{id:"permissionsSettings.workspaceOwner.canChangePermissionsMessage",defaultMessage:"As a <b>workspace owner</b>, you can change the permissions of this {subject} to add yourself or others. Any changes will appear in the audit log.",values:{b:(...e)=>(0,P.jsx)("b",{children:e}),subject:"workflow"===t.table?(0,P.jsx)(d().sA,{id:"permissionsSettings.subject.agent",defaultMessage:"agent"}):(0,P.jsx)(d().sA,{id:"permissionsSettings.subject.page",defaultMessage:"page"})}})}),(0,P.jsx)(Y().A,{size:"lg",disabled:o,style:l.button,onClick:()=>{i.setState({...i.state,changePermissionsEnabled:!0})},iconLeading:{icon:n(570869).keySmallIcon,size:"sm",style:l.icon},children:o?(0,P.jsx)(d().sA,{id:"blockPermissionsSettings.workspaceOwner.isChangingPermissionsMessageButton",defaultMessage:"Changing permissions"}):(0,P.jsx)(d().sA,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessageButton",defaultMessage:"Change permissions"})})]}):null};function so(e){const t=(0,a().K8)((()=>U().Ay.state.tab),[]);switch(t){case U().QC.Share:return(0,P.jsx)(io,{...e,blockStore:e.store});case U().QC.Publish:return e.store.table!==l().ev?null:(0,P.jsx)(fe,{store:e.store,permissionItemArgs:e.permissionItemArgs,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem});default:(0,V().HB)(t)}}function ao(){const e=(0,s().Y0)(),t=(0,r().IS)((e=>({container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",height:276},offlineMessageHeadline:{fontWeight:j().Wy.medium},iconStyle:{width:32,height:32,marginBottom:10,fill:e.icon.tertiary}})),[]);return(0,P.jsxs)("div",{style:t.container,children:[ue(t.iconStyle),(0,P.jsx)("div",{style:t.offlineMessageHeadline,children:(0,P.jsx)(f().A,{isMobile:e.isMobile,isSecondaryColor:!0,isMultiline:!0,children:(0,P.jsx)(d().sA,{defaultMessage:"Youâ€™re offline",id:"blockPermissionsSettings.offline.headline"})})}),(0,P.jsx)(f().A,{isMobile:e.isMobile,isSecondaryColor:!0,isMultiline:!0,children:(0,P.jsx)(d().sA,{defaultMessage:"Go online to share and publish",id:"blockPermissionsSettings.offline.prompt"})})]})}const ro=function(e){const{store:t,permissionItemArgs:i}=e,s=(0,a().uB)(e.inviteTargetsStore,pe().Ay),l=(0,r().IS)((()=>({container:{display:"flex",flexDirection:"column",height:"100%"}})),[]),d=(0,a().O$)(n(929219).e);return(0,P.jsxs)("div",{style:l.container,children:[i.sudoModeStore?(0,P.jsx)(oo,{store:t,sudoModeStore:i.sudoModeStore}):void 0,o().A.isMobile?void 0:(0,P.jsx)(ge().aR,{store:t,inviteTargetsStore:s,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem}),d?(0,P.jsx)(so,{inviteTargetsStore:s,...e}):(0,P.jsx)(ao,{})]})};var lo=()=>n(64744);function co(e){const{store:t,sudoModeStore:n,onUpgradeButtonClick:c,location:u}=e,j=(0,s().v3)(),k=(0,s().Y0)(),I=(0,lo().O)(t);(0,S().fJ)(E().Ns.publishSite),(0,S().fJ)(E().Ns.publishedSiteSettings);const T=(0,a().uB)(e.universalMemberInviteStore,O().A),_=(0,a().K8)((()=>T.state.contextualInviteStore),[T]),D=(0,N().H)(),z=(0,x().L)(),K=(0,A().I_)(),V=(0,a().K8)((()=>F().dR({store:t,environment:j,trustedDomainsStore:D})),[j,t,D]),q=(0,a().K8)((()=>_.state.inviteStage),[_]),W=(0,a().K8)((()=>U().Ay.state.tab),[]),G=(0,r().IS)((e=>({title:{fontSize:16},topbarStyle:{paddingTop:15,paddingBottom:15,height:"auto",background:k.isMobile?e.background.secondary:void 0}})),[k.isMobile]),H=(0,i.useMemo)((()=>({onUpgradeButtonClick:c,sudoModeStore:n,location:u})),[c,n,u]),Y=(0,a().K8)((()=>M().default.isVisible(w().PUBLIC_SHARE_LINK_TOOLTIP_ID)),[]),$=(0,a().K8)((()=>(0,R().g)()),[]);if(!z)return $&&t.table===l().ev?(0,P.jsx)(B,{calculatedPermissions:V,store:t,permissionItemArgs:H,onClose:e.onClose}):null;if(!(o().A.isMobile||q!==L().d5.share_workspace&&q!==L().d5.request_workspace||Y||t.table!==l().ev))return(0,P.jsx)(de,{blockStore:t,spaceStore:z,contextualInviteStore:_});const Q=o().A.isMobile?{menuType:y().gu.Modal,disableHeaderShadow:!0,title:(0,P.jsx)(f().A,{isMobile:o().A.isMobile,style:G.title,children:(0,P.jsx)(d().sA,{defaultMessage:"Share settings",id:"blockPermissionsSettings.mobileShareMenu.titleV2"})}),additionalTopbarContent:t.table===l().ev?(0,P.jsx)(ge().zM,{store:t,mostPermissivePublicItem:V.mostPermissivePublicItem}):void 0,left:(0,P.jsx)(h().A,{href:(0,b().x)("guides.sharing"),analyticsFrom:"sharing"}),footer:W===U().QC.Share&&(0,P.jsx)(C().A,{store:t,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:V,permissionItemArgs:H,hasCollectionPropertyPermissionsSection:I.shouldRender}),topbarStyle:G.topbarStyle,right:(0,P.jsx)(m().DoneMenuText,{}),onClickRight:e.onClose,whiteBackground:!1}:{menuType:y().gu.Popup,maxHeight:"90vh"};return K?(0,P.jsx)(g().A,{...Q,className:v().NXe,children:(0,P.jsx)(p().A,{debugName:"ShareMenuContainer",capture:!0,allowEsc:!0,children:(0,P.jsx)(uo,{store:t,spaceStore:z,spaceUserStore:K,permissionItemArgs:H,calculatedPermissions:V,buttonPopupStore:e.buttonPopupStore,inviteTargetsStore:e.inviteTargetsStore,contextualInviteStore:_})})}):null}function uo({store:e,spaceStore:t,spaceUserStore:n,permissionItemArgs:o,calculatedPermissions:a,buttonPopupStore:r,inviteTargetsStore:l,contextualInviteStore:d}){const p=(0,s().v3)();return(0,i.useEffect)((()=>{c().IU({environment:p}),(0,u().I)({environment:p})}),[p]),(0,P.jsx)(ro,{store:e,spaceStore:t,spaceUserStore:n,permissionItemArgs:o,calculatedPermissions:a,buttonPopupStore:r,inviteTargetsStore:l,contextualInviteStore:d})}},135154:(e,t,n)=>{n.d(t,{E:()=>o});n(898992),n(823215);var i=()=>n(953418);function o(e){const{element:t,extraBottomSpacing:n=0}=e;let o=t.getBoundingClientRect();o=DOMRect.fromRect({x:o.x,y:o.y,width:o.width,height:o.height+n});return(0,i().sl)(t).every((e=>{const t=e.getBoundingClientRect();return o.top>=t.top&&o.bottom<=t.bottom&&o.left>=t.left&&o.right<=t.right}))}},135546:(e,t,n)=>{n.r(t),n.d(t,{CreateTeamFromPageConfirmModal:()=>v});n(296540);var i=()=>n(484714),o=()=>n(56366),s=()=>n(401497),a=()=>n(406094),r=()=>n(160432),l=n(474848);const d=(0,n(340498).wt)("loop",{viewBox:"0 0 16 16",svg:(0,l.jsx)("path",{d:"M5.80371 3.12305C5.81006 3.50391 6.05762 3.74512 6.47656 3.74512H11.3643C11.9546 3.74512 12.2783 4.0498 12.2783 4.66553V11.2925L11.377 10.3149L10.8628 9.80078C10.5962 9.54688 10.2344 9.52783 9.96777 9.78809C9.71387 10.0483 9.72021 10.4229 9.98047 10.6831L12.145 12.8413C12.6211 13.311 13.167 13.311 13.6431 12.8413L15.8076 10.6831C16.0679 10.4229 16.0742 10.0483 15.8203 9.78809C15.5537 9.52783 15.1919 9.54688 14.9253 9.80078L14.4111 10.3149L13.5161 11.2861V4.56396C13.5161 3.20557 12.8052 2.50098 11.4341 2.50098H6.47656C6.05762 2.50098 5.79736 2.74219 5.80371 3.12305ZM0.186035 7.05859C0.446289 7.3252 0.808105 7.30615 1.07471 7.0459L1.59521 6.53809L2.48389 5.56689V12.2891C2.48389 13.6475 3.19482 14.3521 4.56592 14.3521H9.52344C9.94238 14.3521 10.2026 14.1108 10.1963 13.73C10.1899 13.3428 9.94238 13.1079 9.52344 13.1079H4.64209C4.05176 13.1079 3.72803 12.7969 3.72803 12.1812V5.5542L4.62305 6.53809L5.14355 7.0459C5.40381 7.30615 5.77197 7.3252 6.03223 7.05859C6.29248 6.79834 6.28613 6.43018 6.01953 6.16992L3.85498 4.01172C3.37891 3.53564 2.83936 3.53564 2.36328 4.01172L0.19873 6.16992C-0.0678711 6.43018 -0.0742188 6.79834 0.186035 7.05859Z"})});var c=()=>n(69708),u=()=>n(284371),p=()=>n(641514),g=()=>n(21140),m=()=>n(475355),f=()=>n(108414),h=()=>n(812941);function v(){const e=(0,i().v3)(),t=(0,c().tz)(),n=(0,s().IS)((e=>({modal:{maxWidth:350,padding:24},loopIcon:{height:28,width:28,fill:e.darkTextColor},title:{marginTop:16,marginBottom:12,color:e.text.primary,fontWeight:u().Wy.semibold,fontSize:18},description:{color:e.darkTextColor,textAlign:"center",fontSize:14,marginBottom:18},confirmButton:{width:"100%",marginBottom:8},cancelButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:14}})),[]),v=(0,o().K8)((()=>f().A.state.open),[]);return(0,l.jsx)(p().A,{onDismiss:()=>{f().A.setState({open:!1})},render:()=>(0,l.jsx)("div",{style:n.modal,children:(0,l.jsxs)(g().Ye,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[d(n.loopIcon),(0,l.jsx)("div",{style:n.title,children:(0,l.jsx)(c().sA,{id:"createTeamFromPage.confirmModal.title",defaultMessage:"Turn into teamspace?"})}),(0,l.jsx)("div",{style:n.description,children:(0,l.jsx)(c().sA,{id:"createTeamFromPage.confirmModal.description",defaultMessage:"This will move this page into a newly created teamspace along with people who already have access to this page."})}),(0,l.jsx)(r().A,{colorPalette:"blue",size:"lg",style:n.confirmButton,onClick:()=>{if(f().A.state.open){const{pageStore:n,flowId:i}=f().A.state;m().v4({environment:e,intl:t,page:n,flowId:i}),f().A.setState({open:!1})}},children:(0,l.jsx)(c().sA,{id:"createTeamFromPage.confirmModal.confirmButton",defaultMessage:"Create teamspace"})}),(0,l.jsx)(a().A,{size:"lg",style:n.cancelButton,onClick:()=>f().A.setState({open:!1}),children:(0,l.jsx)(c().sA,{id:"createTeamFromPage.confirmModal.cancelButton",defaultMessage:"Cancel"})}),(0,l.jsx)(h().A,{message:(0,l.jsx)(c().sA,{id:"createTeamFromPage.confirmModal.learnMore",defaultMessage:"Learn more about teamspaces"}),analyticsFrom:"teams_learn_more_turn_page_into_team",helpCenterLocation:"bestPractices"})]})}),isOpen:v})}},137840:(e,t,n)=>{n.r(t),n.d(t,{OutlinerDropdownMenuButton:()=>$,useSortActions:()=>J});n(581454);var i=n(296540),o=()=>n(564884),s=()=>n(59226),a=()=>n(484714),r=()=>n(56366),l=()=>n(401497),d=()=>n(718827),c=()=>n(252291),u=()=>n(582684),p=()=>n(29037),g=()=>n(126617),m=()=>n(170350),f=()=>n(813197),h=()=>n(617668),v=()=>n(946065),y=()=>n(116225),b=()=>n(69708),S=()=>n(12956),x=()=>n(10521),A=()=>n(899963),M=()=>n(384944),w=()=>n(231297),j=()=>n(664713),k=()=>n(722872),I=()=>n(396301),C=()=>n(37433),T=()=>n(494526),_=()=>n(154060),P=()=>n(976644),B=()=>n(644914),D=()=>n(655923),R=()=>n(112282),E=()=>n(575143),L=()=>n(47373),O=()=>n(765957),N=()=>n(923455),F=n(474848);const U=(0,b().YK)({move:{id:"useMoveSidebarAction.title.moveSection",defaultMessage:"Move section"},moveUp:{id:"useMoveSidebarAction.option.moveUp",defaultMessage:"Move up"},moveDown:{id:"useMoveSidebarAction.option.moveDown",defaultMessage:"Move down"}});var z=()=>n(852678),K=()=>n(620149),V=()=>n(848237),q=()=>n(452558),W=()=>n(406699),G=()=>n(404277),H=()=>n(89924);const Y=(0,b().YK)({manual:{id:"outlinerDropdownMenuButton.sort.manual",defaultMessage:"Manual"},lastEdited:{id:"outlinerDropdownMenuButton.sort.lastEdited",defaultMessage:"Last edited"}});function $(e){const{type:t,spaceViewStore:n}=e,s=(0,a().v3)(),r=(0,l().IS)((()=>({button:{display:"flex",alignItems:"center",justifyContent:"center",height:20,width:20,borderRadius:4}})),[]),u=(0,i.useCallback)((()=>{z().A.setState({open:!0}),function(e,t){const{outliner_type:n}=t;(0,o().u)({environment:e,event:{eventName:"open_outliner_section_menu",eventProperties:{outliner_type:n,...(0,B().hX)({environment:e})}}})}(s,{outliner_type:I().BP[t]})}),[s,t]),p=(0,i.useCallback)((()=>{z().A.setState({open:!1})}),[]),m=(0,b().tz)().formatMessage({id:"outlinerDropdownMenuButton.ariaLabel",defaultMessage:"Open menu"});return n?(0,F.jsx)(W().A,{popupType:W().z.Popup,alignmentToOrigin:"start",renderOrigin:e=>(0,F.jsx)(d().Ay,{style:r.button,ariaLabel:m,...e,children:(0,F.jsx)(c().I,{icon:g().ellipsisSmallIcon,size:"sm",colorVariant:s.device.isMobile?"tertiary":"secondary"})}),onClick:u,onClose:p,render:e=>(0,F.jsx)(Z,{type:t,spaceViewStore:n,onClose:()=>{e.close()}}),originGap:2}):null}const Q=(0,b().YK)({sort:{id:"outlinerDropdownMenu.sort",defaultMessage:"Sort"},truncationLimit:{id:"outlinerDropdownMenu.truncationLimit",defaultMessage:"Show"},addTeam:{id:"outlinerDropdownMenu.addTeam",defaultMessage:"New teamspace"},workspaceFilter:{id:"outlinerDropdownMenu.workspaceFilter",defaultMessage:"Filter workspace"}});function Z(e){const{type:t,spaceViewStore:n,onClose:i}=e,o=(0,a().v3)(),s=(0,r().O$)(O().AppStoreCurrentUserSettingsStore),d=(0,b().tz)(),c=(0,l().IS)((e=>({rightText:{fontSize:12,color:e.text.secondary}})),[]),g=(0,r().K8)((()=>(0,I().RQ)({spaceViewStore:n,type:t,userSettingsStore:s})),[n,t,s]),j=(0,P().o)(),B=g.sortOption,z=g.truncationLimit,W="shared"===t||"private"===t||"teamspaces"===t||"agents"===t,$="private"===t||"shared"===t,Z=(0,r().K8)((()=>"shared"===t&&(0,_().A)()),[t]),ee=(0,r().K8)((()=>!K().l.state),[]),te=(0,r().K8)((()=>{const{sidebarSpaceStore:e}=O().default.state;return!!e&&(0,C().sx)({environment:o,spaceStore:e})}),[o]),ne=ee&&"teamspaces"===t&&te,ie=J({type:t,onSelect:i,spaceViewStore:n,outlinerLocation:"sidebar"}),oe=function(e){const{type:t,spaceViewStore:n,onSelect:i}=e,o=(0,r().O$)(O().AppStoreCurrentUserSettingsStore),s=(0,a().v3)(),d=(0,l().IS)((()=>({icon:{width:16,height:16},right:{width:16}})),[]),c=(0,r().K8)((()=>(0,I().RQ)({type:t,spaceViewStore:n,userSettingsStore:o}).truncationLimit),[t,n,o]);return v().AQ.map((e=>(0,x().Ls)({key:e.toString(),displayName:void 0,analyticsName:e.toString(),validators:[],closeParentMenu:!0,action:()=>{w().createAndCommit({userAction:"OutlinerDropdownMenuButton.setTruncationLimit",environment:s,canUndo:!0,perform:i=>{const s=(0,T().y)({spaceViewStore:n,userSettingsStore:o,configType:"truncationLimit",sectionType:t});s&&M().KY({transaction:i,store:s,value:e})}}),y().u4({name:"update_sidebar_section_option",args:{option:"show",type:t}}),A().nT(s,{outliner_type:I().BP[t],option:e}),i()},render:t=>(0,F.jsx)(E().A,{...t,title:(0,F.jsx)(X,{limit:e,withItems:!0}),right:c===e&&(0,p().checkmarkIcon)(d.icon),rightStyle:d.right})})))}({type:t,onSelect:i,spaceViewStore:n}),se=function(e){const{type:t,onSelect:n}=e,i=(0,r().O$)(O().AppStoreSidebarSpaceStore),o=(0,r().O$)(O().AppStoreSidebarSpaceViewStore),{currentUserRootStore:s,currentUserStore:a}=(0,r().K8)((()=>({currentUserRootStore:O().default.state.currentUserRootStore,currentUserStore:O().default.state.currentUserStore})),[]),l=(0,b().tz)(),d=(0,N().Rx)(),c=(null==d?void 0:d.sidebarOrder)??[],u=(0,r().K8)((()=>(0,L().i3)({spaceStore:i,spaceViewStore:o,userRootStore:s,currentUserStore:a})),[i,s,a,o]),p=(0,I().KP)({sidebarOrder:c,sidebarState:d,showLockedSidebar:u});if(!o)return[];const g=p.indexOf(t),m=0===g,f=g===p.length-1,h=(null==d?void 0:d.shownSidebarSectionCount)??0;return["moveUp","moveDown"].map((e=>{const i=U[e];return(0,x().Ls)({key:e,displayName:void 0,analyticsName:i.defaultMessage,validators:[()=>h>1],closeParentMenu:!0,action:({environment:i})=>{const s=function({sidebarSection:e,selectedMoveOption:t,sidebarOrder:n,visibleSidebarOrder:i}){const o=[...n],s=n.indexOf(e),a=i.indexOf(e);if("moveUp"===t&&a>0){const t=i[a-1];o[n.indexOf(t)]=e,o[s]=t}if("moveDown"===t&&a<i.length-1){const t=i[a+1];o[n.indexOf(t)]=e,o[s]=t}return o}({sidebarSection:t,selectedMoveOption:e,sidebarOrder:c,visibleSidebarOrder:p});w().createAndCommit({userAction:`useMoveSidebarAction.${e}`,environment:i,canUndo:!0,perform:e=>{M().zv({store:o,data:{sidebar_order:s},transaction:e})}}),A().ub(i,{section:t,previous_order:c,new_order:s,from:"outliner_section_menu"}),n()},render:t=>{const n="moveUp"===e&&m||"moveDown"===e&&f,o="moveUp"===e?R().arrowStraightUpIcon:D().arrowStraightDownIcon;return(0,F.jsx)(E().A,{...t,disabled:n,disabledFeedback:n,title:l.formatMessage(i),svg:o})}})}))}({type:t,onSelect:i}),ae=[(0,S().u)({key:"sort",displayName:Q.sort,analyticsName:Q.sort.defaultMessage,validators:[()=>$],svg:u().arrowUpDownIcon,right:d.formatMessage(Y[B]),rightStyle:c.rightText,subActions:()=>[(0,x().gy)({key:"sort",render:e=>(0,F.jsx)(H().A,{...e}),actions:ie})]}),(0,S().u)({key:"workspaceFilter",displayName:Q.workspaceFilter,analyticsName:Q.workspaceFilter.defaultMessage,validators:[()=>Z],svg:m().filterIcon,subActions:()=>j}),(0,S().u)({key:"truncationLimit",displayName:Q.truncationLimit,analyticsName:Q.truncationLimit.defaultMessage,validators:[()=>W],svg:f().L,right:(0,F.jsx)(X,{limit:z}),rightStyle:c.rightText,subActions:()=>[(0,x().gy)({key:"truncationLimit",render:e=>(0,F.jsx)(H().A,{...e}),actions:oe})]}),...se],re=[(0,x().gy)({key:"all",render:e=>(0,F.jsx)(H().A,{...e}),actions:ae}),(0,x().gy)({key:"addTeam",render:e=>(0,F.jsx)(H().A,{...e}),actions:[(0,x().Ls)({key:"addTeam",displayName:Q.addTeam,analyticsName:Q.addTeam.defaultMessage,validators:[()=>ne],svg:h().plusIcon,closeParentMenu:!0,action:()=>{(0,V().vn)("sidebar_team_section"),i()}})]})];return(0,F.jsx)(G().A,{menuType:k().gu.Popup,minWidth:220,children:(0,F.jsx)(q().A,{context:{blocks:[],environment:o,publicEditMode:void 0},sections:re,initialFocus:void 0})})}function J(e){const{type:t,spaceViewStore:n,onSelect:i,outlinerLocation:o}=e,d=(0,a().v3)(),c=(0,b().tz)(),{sidebarSpaceStore:u,currentUserSettingsStore:g}=(0,r().K8)((()=>({sidebarSpaceStore:O().default.state.sidebarSpaceStore,currentUserSettingsStore:O().default.state.currentUserSettingsStore})),[]),m=d.currentUser.id,f=(0,s().X)("sidebar_add_new_pages_to_bottom"),h=(0,r().K8)((()=>(0,I().RQ)({type:t,spaceViewStore:n,userSettingsStore:g}).sortOption),[t,n,g]),v=(0,l().IS)((()=>({icon:{width:16,height:16},right:{width:16}})),[]);return["manual","lastEdited"].map((e=>{const s=Y[e];return(0,x().Ls)({key:e,displayName:void 0,analyticsName:s.defaultMessage,validators:[],closeParentMenu:!0,action:async()=>{w().createAndCommit({userAction:"OutlinerDropdownMenuButton.setSortOption",environment:d,canUndo:!0,perform:i=>{const o=(0,T().y)({spaceViewStore:n,userSettingsStore:g,configType:"sortOption",sectionType:t});o&&M().KY({transaction:i,store:o,value:e})}}),"manual"===e&&"shared"===t&&!f&&m&&u&&await j().Z({environment:d,spaceId:u.id,userId:m}),y().u4({name:"update_sidebar_section_option",args:{option:"sort",type:t}}),A().Rf(d,{outliner_type:I().BP[t],outliner_location:o,option:e}),i()},render:t=>(0,F.jsx)(E().A,{...t,title:c.formatMessage(s),right:h===e&&(0,p().checkmarkIcon)(v.icon),rightStyle:v.right})})}))}function X(e){const{withItems:t}=e,n=(0,s().X)("enable_max_outliner_size"),i=(0,v().Fl)({setting:e.limit,enableMaxOutlinerSize:n});return i===1/0?(0,F.jsx)(b().sA,{id:"outlinerDropdownMenuButton.truncationLimit.noTruncation",defaultMessage:"All"}):t?(0,F.jsx)(b().sA,{id:"outlinerDropdownMenuButton.truncationLimit",defaultMessage:"{limit} items",values:{limit:i}}):(0,F.jsx)("span",{children:i})}},142015:(e,t,n)=>{n.d(t,{D:()=>o});n(296540);const i={viewBox:"0 0 20 20",fittedViewBox:"4.42 4.41 11.16 11.16",directional:!0,svg:(0,n(474848).jsx)("path",{d:"M15.417 5.467c.23-.23.219-.615-.025-.859s-.629-.255-.86-.025l-8.857 8.858V7.313a.625.625 0 0 0-1.25 0v7.637c0 .345.28.625.625.625h7.637a.625.625 0 1 0 0-1.25H6.559z"})},o=(0,n(340498).wt)("arrowDiagonalDownLeft",i)},152077:(e,t,n)=>{n.d(t,{Vs:()=>d,WA:()=>l,YU:()=>c,bO:()=>a,lU:()=>r});var i=n(296540),o=n(474848);const s=i.createContext(void 0);function a(e){return(0,o.jsx)(s.Provider,{value:e.surface,children:e.children})}function r(){return i.useContext(s)}function l(){const e=r();return"TeamHome"===e||"PersonalHome"===e}function d(){return void 0===r()}function c(){return d()?12:0}s.displayName="PostFeedSurfaceContext"},171510:(e,t,n)=>{n.r(t),n.d(t,{AuthSyncListener:()=>y});n(898992),n(354520);var i=n(296540),o=()=>n(726637),s=()=>n(484714),a=()=>n(56366);const r="initial_handshake";var l=()=>n(798880),d=()=>n(69708),c=()=>n(496603),u=()=>n(763824),p=()=>n(498212),g=()=>n(870092),m=()=>n(179534),f=()=>n(214006),h=n(474848);const v=1;function y(){const e=(0,s().v3)(),t=(0,d().tz)(),n=`${o().A.identity.domainBaseUrl}/authSync`,y=e.currentUser.isLoggedIn(),[b,S]=(0,i.useState)(null),[x,A]=(0,i.useState)({value:!1,count:0}),M=(0,a().K8)((()=>m().A.getTotalUnreadMentionsCount()),[]),w=(0,a().K8)((()=>f().A.getAllSpaceViewStores(e)),[e]);(0,i.useEffect)((()=>{const e=t=>{const n=o().A.identity.domainBaseUrl;t.origin===n&&t.ports&&t.ports[0]&&(S(t.ports[0]),window.removeEventListener("message",e))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[]),(0,i.useEffect)((()=>{y&&(x.value||0===x.count||null==b||b.postMessage({version:v,name:"unreadCount",source:"notion",unreadCount:M}))}),[y,x.count,x.value,b,M]);const j=(0,i.useCallback)((async()=>{const e=c().hS(w,"userId"),n=await(0,u().lX)(e,10,(async e=>{if(!e.userId)return;const n=g().L.createChildStore(e,{table:l().oo,id:e.userId});await n.load();const i=n.getEmail()??"",o=n.getDisplayName(t)??"",s=n.getProfilePhoto()??"";return{id:e.userId,displayName:o,emailAddress:i,profilePicture:s}}));null==b||b.postMessage({version:v,name:"accountSwitcher",source:"notion",accounts:n.filter((e=>void 0!==e)),persistCookie:!0})}),[t,b,w]);(0,i.useEffect)((()=>{y&&b&&(x.value||0===x.count)&&j()}),[y,j,x.count,x.value,b]),(0,i.useEffect)((()=>{e.currentUser.id&&!(0,p().uj)(e.currentUser.id)||null==b||b.postMessage({version:v,name:"setNotionUserID",source:"notion",notionUserID:e.currentUser.id?e.currentUser.id:"",type:"mutation"})}),[e.currentUser.id,b]),(0,i.useEffect)((()=>{y||(null==b||b.postMessage({version:v,name:"setNotionUserID",source:"notion",notionUserID:"",type:"mutation"}),null==b||b.postMessage({version:v,name:"accountSwitcher",source:"notion",accounts:[],persistCookie:!0}))}),[y,b]);const k=(0,i.useCallback)((e=>{if(e.data.version!==v)return;const{source:t}=e.data;if("notion"!==t&&"mailLoaded"===e.data.name)A((e=>({value:!0,count:e.count+1})))}),[]);return(0,i.useEffect)((()=>(S((e=>(e&&(e.onmessage=k),e))),()=>{S((e=>(e&&(e.onmessage=null),e)))})),[k,b]),(0,h.jsx)("iframe",{src:n,style:{display:"none"},onLoad:e=>function(e){const t=e.currentTarget;setTimeout((()=>{var e;null===(e=t.contentWindow)||void 0===e||e.postMessage(r,o().A.identity.domainBaseUrl)}),50)}(e),title:"Notion Identity"})}},172339:(e,t,n)=>{n.d(t,{g:()=>l});var i=()=>n(56366),o=()=>n(762433),s=()=>n(272509),a=()=>n(765957),r=()=>n(324561);function l(){const{sidebarSpaceStore:e,currentUserSettingsStore:t,sidebarSpaceViewStore:n}=(0,i().K8)((()=>({sidebarSpaceStore:a().default.state.sidebarSpaceStore,currentUserSettingsStore:a().default.state.currentUserSettingsStore,sidebarSpaceViewStore:a().default.state.sidebarSpaceViewStore})),[]),l=(0,r().lh)({spaceId:null==e?void 0:e.id}),d=(0,i().K8)((()=>(0,o().N8)(l)),[l]),c=(0,i().K8)((()=>(0,s().I)(e)),[e]);return(0,i().K8)((()=>{var i,o,s;if(c)return null==t||null===(s=t.getSettings())||void 0===s||null===(s=s.external_pages_settings)||void 0===s?void 0:s.last_filter_state;const a=null==n||null===(i=n.getSettings())||void 0===i?void 0:i.external_pages_settings;return!d||null!=a&&a.last_filter_state||null==e||!e.id?null==n||null===(o=n.getSettings())||void 0===o||null===(o=o.external_pages_settings)||void 0===o?void 0:o.last_filter_state:{type:"selection",space_pointers:[null==e?void 0:e.id]}}),[t,n,c,d,null==e?void 0:e.id])}},176235:(e,t,n)=>{n.d(t,{M:()=>s});var i=n(296540),o=n(474848);const s=i.forwardRef((function(e,t){const{name:i,icon:s,...a}=e,r=i;return(0,o.jsx)(n(760217).A,{...a,ref:t,icon:(0,o.jsx)(n(865342).Z,{icon:s}),title:r})}))},188924:(e,t,n)=>{n.d(t,{Tc:()=>x,jK:()=>b,C7:()=>S,Nh:()=>y});var i=()=>n(534177),o=()=>n(638681),s=()=>n(651784),a=()=>n(715256);const r={type:"calendar",config:{},isAvailable:({configStep:e,experimentService:t,userId:n,spaceId:i,isCustomAgentContext:o})=>{if(o||e.isCustomAgent){return t.getConfig({actor:n?{id:n,table:"notion_user"}:a().S3,configName:"custom_agent_sub_features",customIDs:{spaceId:i,workflowId:e.workflowId}}).allowed_module_types.includes("calendar")}return Boolean(t.checkGate({gateName:"workflows_calendar_module_available",actor:n?{table:"notion_user",id:n}:a().S3,customIDs:{spaceId:i}}))},triggers:{},effects:{"calendar.runTool":{versionAvailability:"*"},"calendar.fetchPlaybook":{versionAvailability:"*"}},authentication:void 0,latestVersion:"1.0.0",stateDuplicator:({original:e})=>{},getModuleConfigurationStatus:e=>"ready",getDescription:e=>e.formatMessage({id:"workflows.modules.calendar.description",defaultMessage:"Manage calendar events connected to Notion Calendar."}),getName:e=>e.formatMessage({id:"workflows.modules.calendar.name",defaultMessage:"Notion Calendar"}),getMessageIfNotValid:(e,t)=>e.formatMessage({id:"workflows.modules.calendar.notConnected",defaultMessage:"Calendar is not connected to {workflowName}"},{workflowName:t}),getModuleConfigSection:()=>"connections",getIcon:()=>n(16789).notionCalendarIcon};const l={type:"codegen",config:{},isAvailable:({configStep:e,experimentService:t,userId:n,spaceId:i})=>Boolean(e.enableExperimentalIntegrations&&t.checkGate({gateName:"agent_codegen_integration",actor:n?{table:"notion_user",id:n}:a().S3,customIDs:{spaceId:i}})),authentication:void 0,latestVersion:"1.0.0",triggers:{},effects:{"codegen.run":{versionAvailability:"*"},"codegen.runStatus":{versionAvailability:"*"}},stateDuplicator:()=>{},getModuleConfigurationStatus:e=>{var t;return null!==(t=e.state)&&void 0!==t&&t.connectionPointer?"ready":"invalid"},getDescription:e=>e.formatMessage({id:"workflows.modules.codegen.description",defaultMessage:"Integration with Codegen, a coding agent. Supports accessing and modifying code repositories, such as creating Github PRs or answering questions about the codebase."}),getName:e=>e.formatMessage({id:"workflows.modules.codegen.name",defaultMessage:"Codegen"}),getMessageIfNotValid:(e,t)=>e.formatMessage({id:"workflows.modules.codegen.notConnected",defaultMessage:"Codegen is not configured for {workflowName}"},{workflowName:t}),getModuleConfigSection:()=>"connections",getIcon:()=>n(88975).codegenIcon};const d={type:"files",config:{},authentication:void 0,latestVersion:"1.0.0",triggers:{},effects:{"files.getFileContent":{versionAvailability:"*"},"files.getFileUrl":{versionAvailability:"*"},"files.getFileName":{versionAvailability:"*"}},isAvailable:()=>!1,stateDuplicator:({original:e})=>e,getModuleConfigurationStatus:()=>"ready",getDescription:e=>e.formatMessage({defaultMessage:"This integration allows working with files in your Workflow.",id:"workflow.module.files.description"}),getName:e=>e.formatMessage({defaultMessage:"Files",id:"workflow.module.files.title"}),getModuleConfigSection:()=>"system",getIcon:()=>n(767499).B};const c={type:"github",config:{scopes:[]},isAvailable:({configStep:e,experimentService:t,userId:n,spaceId:i})=>Boolean(e.enableExperimentalIntegrations&&t.checkGate({gateName:"workflows_github_module_available",actor:n?{table:"notion_user",id:n}:a().S3,customIDs:{spaceId:i}})),authentication:{type:"oauth2"},latestVersion:"1.0.0",triggers:{},effects:{"github.getPullRequest":{versionAvailability:"*"},"github.getUser":{versionAvailability:"*"},"github.listPullRequests":{versionAvailability:"*"},"github.listOrganizationRepositories":{versionAvailability:"*"},"github.parseGithubUrlToParts":{versionAvailability:"*"}},stateDuplicator:()=>{},getModuleConfigurationStatus:e=>{var t;return null!==(t=e.state)&&void 0!==t&&t.connectionPointer?"ready":"invalid"},getDescription:e=>e.formatMessage({id:"workflows.modules.github.description",defaultMessage:"Fetch information about pull requests, issues, repositories, and more."}),getName:e=>e.formatMessage({id:"workflows.modules.github.name",defaultMessage:"Github"}),getMessageIfNotValid:e=>e.formatMessage({id:"workflows.modules.github.notConnected",defaultMessage:"Please connect to Github"}),getModuleConfigSection:()=>"connections",getIcon:()=>n(564613).gitHubIcon};const u={type:"mail",config:{},isAvailable:({configStep:e,experimentService:t,userId:n,spaceId:i,isCustomAgentContext:o})=>{if(o||e.isCustomAgent){return t.getConfig({actor:n?{id:n,table:"notion_user"}:a().S3,configName:"custom_agent_sub_features",customIDs:{spaceId:i,workflowId:e.workflowId}}).allowed_module_types.includes("mail")}return Boolean(t.checkGate({gateName:"workflows_mail_module_available",actor:n?{table:"notion_user",id:n}:a().S3,customIDs:{spaceId:i}}))},triggers:{},effects:{"mail.runTool":{versionAvailability:"*"},"mail.getPrompt":{versionAvailability:"*"}},authentication:void 0,latestVersion:"1.0.0",stateDuplicator:({original:e})=>{},getModuleConfigurationStatus:e=>"ready",getDescription:e=>e.formatMessage({id:"workflows.modules.mail.description",defaultMessage:"Manage emails connected to Notion Mail."}),getName:e=>e.formatMessage({id:"workflows.modules.mail.name",defaultMessage:"Notion Mail"}),getMessageIfNotValid:(e,t)=>e.formatMessage({id:"workflows.modules.mail.notConnected",defaultMessage:"Mail is not connected to {workflowName}"},{workflowName:t}),getModuleConfigSection:()=>"connections",getIcon:()=>n(705464).notionMailIcon};const p={type:"mcpServer",config:{},isAvailable:({configStep:e,experimentService:t,userId:n,spaceId:i})=>Boolean(e.enableExperimentalIntegrations&&t.checkGate({gateName:"workflows_mcp_server_module_available",actor:n?{table:"notion_user",id:n}:a().S3,customIDs:{spaceId:i}})),authentication:void 0,latestVersion:"1.0.0",stateDuplicator:()=>{},getModuleConfigurationStatus:e=>{var t;return null!==(t=e.state)&&void 0!==t&&t.serverUrl?"ready":"invalid"},triggers:{},effects:{"mcpServer.runTool":{versionAvailability:"*"},"mcpServer.listResources":{versionAvailability:"*"},"mcpServer.readResource":{versionAvailability:"*"},"mcpServer.listPrompts":{versionAvailability:"*"},"mcpServer.getPrompt":{versionAvailability:"*"}},getDescription:e=>e.formatMessage({id:"workflows.modules.mcpServer.description",defaultMessage:"Integration with MCP server for AI inference with tools"}),getName:e=>e.formatMessage({id:"workflows.modules.mcpServer.name",defaultMessage:"MCP Server"}),getMessageIfNotValid:(e,t)=>e.formatMessage({id:"workflows.modules.mcpServer.notConnected",defaultMessage:"MCP Server is not configured in {workflowName}"},{workflowName:t}),getModuleConfigSection:()=>"connections",getIcon:()=>n(818541).V};const g={type:"pipedream",config:{scopes:["read","write"]},isAvailable:({configStep:e,experimentService:t,userId:n,spaceId:i})=>Boolean(e.enableExperimentalIntegrations&&t.checkGate({gateName:"workflows_pipedream_module_available",actor:n?{table:"notion_user",id:n}:a().S3,customIDs:{spaceId:i}})),authentication:{type:"pipedream"},latestVersion:"1.0.0",triggers:{"pipedream.trigger":{isTriggerConfigured:()=>!0,triggerDuplicator:({original:e})=>e,versionAvailability:"0.0.0",createDefaultState:()=>({type:"pipedream.trigger"})}},effects:{"pipedream.action":{versionAvailability:"*"}},stateDuplicator:({original:e})=>e,getModuleConfigurationStatus:e=>{var t;return null!==(t=e.state)&&void 0!==t&&t.connectionPointer?"ready":"invalid"},getDescription:e=>e.formatMessage({id:"workflows.modules.pipedream.description",defaultMessage:"Integration with external service"}),getName:e=>e.formatMessage({id:"workflows.modules.pipedream.name",defaultMessage:"integration"}),getMessageIfNotValid:(e,t)=>e.formatMessage({id:"workflows.modules.pipedream.notConnected",defaultMessage:"Integration is not connected to {workflowName}"},{workflowName:t}),getModuleConfigSection:()=>"connections",getIcon:()=>n(824375).sparklesIcon};n(898992),n(672577);function m(e){var t;return Boolean(null===(t=e.channelIds)||void 0===t?void 0:t.length)||Boolean(e.allChannels)}const f={type:"slack",config:{scopes:{local:["app_mentions:read","channels:history","channels:read","chat:write.customize","chat:write","emoji:read","files:read","files:write","groups:history","groups:read","im:history","im:read","im:write","mpim:history","mpim:read","reactions:read","reactions:write","users:read.email","users:read"],production:["app_mentions:read","channels:history","channels:read","chat:write.customize","chat:write","emoji:read","reactions:read","reactions:write","users:read.email","users:read"]}},authentication:{type:"oauth2"},isAvailable:({configStep:e,experimentService:t,userId:n,spaceId:i,isCustomAgentContext:o})=>{if(o||e.isCustomAgent){return t.getConfig({actor:n?{id:n,table:"notion_user"}:a().S3,configName:"custom_agent_sub_features",customIDs:{spaceId:i,workflowId:e.workflowId}}).allowed_module_types.includes("slack")}return Boolean(e.enableAgentIntegrations&&t.checkGate({actor:n?{id:n,table:"notion_user"}:a().S3,customIDs:{spaceId:i},gateName:"workflows_slack_module_available"}))},latestVersion:"1.0.0",triggers:{"slack.message":{isTriggerConfigured:m,fields:{channels:{required:()=>!0,isConfigured:m}},triggerDuplicator:({original:e})=>({type:e.type}),versionAvailability:"*",createDefaultState:()=>({type:"slack.message"}),getTriggerDedupKey:({workflowId:e,triggerId:t,triggerVariables:n})=>{var i;const o=null===(i=n.message)||void 0===i?void 0:i.id;if(o)return`${e}-${t}-${o}`}},"slack.thread.created":{isTriggerConfigured:m,fields:{channels:{required:()=>!0,isConfigured:m}},triggerDuplicator:({original:e})=>({type:e.type}),versionAvailability:"*",createDefaultState:()=>({type:"slack.thread.created"}),getTriggerDedupKey:({workflowId:e,triggerId:t,triggerVariables:n})=>{var i;const o=null===(i=n.thread)||void 0===i||null===(i=i[0])||void 0===i?void 0:i.id;if(o)return`${e}-${t}-${o}`}},"slack.reaction.added":{isTriggerConfigured:m,fields:{channels:{required:()=>!0,isConfigured:m},reactions:{required:()=>!1,isConfigured:e=>Boolean(e.reactions&&e.reactions.length>0)},from:{required:()=>!1,isConfigured:e=>Boolean(e.from)}},triggerDuplicator:({original:e})=>({type:e.type,reactions:e.reactions,threadIds:e.threadIds,from:e.from}),versionAvailability:"*",createDefaultState:()=>({type:"slack.reaction.added"}),getTriggerDedupKey:({workflowId:e,triggerId:t,triggerVariables:n})=>{var i,o;const s=n.isFollowUpMessage?null===(i=n.thread[0])||void 0===i?void 0:i.id:null===(o=n.message)||void 0===o?void 0:o.id;if(s)return`${e}-${t}-${s}`}},"slack.app.mention":{isTriggerConfigured:m,fields:{channels:{required:()=>!0,isConfigured:m}},triggerDuplicator:({original:e})=>({type:e.type}),versionAvailability:"*",createDefaultState:()=>({type:"slack.app.mention"}),getTriggerDedupKey:({workflowId:e,triggerId:t,triggerVariables:n})=>{var i;const o=null===(i=n.message)||void 0===i?void 0:i.id;if(o)return`${e}-${t}-${o}`}}},effects:{"slack.createThreadInChannel":{versionAvailability:"*"},"slack.createThreadInDirectMessage":{versionAvailability:"*"},"slack.replyInThread":{versionAvailability:"*"},"slack.updateMessage":{versionAvailability:"*"},"slack.addReactionToMessage":{versionAvailability:"*"},"slack.removeReactionFromMessage":{versionAvailability:"*"},"slack.getThreadsInChannelSince":{versionAvailability:"*"},"slack.queryChannels":{versionAvailability:"*"},"slack.getUser":{versionAvailability:"*"},"slack.findUserByEmail":{versionAvailability:"*"},"slack.parseSlackMessageUrlToId":{versionAvailability:"*"}},stateDuplicator:()=>{},getModuleConfigurationStatus:e=>{var t;return null!==(t=e.state)&&void 0!==t&&t.connectionPointer?"ready":"invalid"},getDescription:e=>e.formatMessage({defaultMessage:"Fetch information about available users, channels, and messages, read messages from a channel, as well as sending messages, editing messages, and receiving message triggers from a connected Slack workspace.",id:"workflow.module.slack.description"}),getName:e=>e.formatMessage({defaultMessage:"Slack",id:"workflow.module.slack.title"}),getMessageIfNotValid:(e,t)=>e.formatMessage({defaultMessage:"Slack is not connected to {workflowName}",id:"workflow.module.slack.notConnected"},{workflowName:t}),getDefaultPermissions:()=>[{moduleType:"slack",type:"slack",identifier:"public:*",actions:["read","replyInThread"]}],getAIConfigurableDefaultPermissions:({type:e})=>"workflow"===e?[{identifier:"public:*",actions:["read","replyInThread"]}]:[{identifier:"*",actions:["read","write"]}],getModuleConfigSection:()=>"connections",getIcon:()=>n(888382).slackIcon,autoGrantPermissions:async({module:e,workflow:t,uriContext:n})=>{var i;let o=e;const s=t.triggers||[];if("slack"!==o.type)return o;const a=null===(i=o.permissions)||void 0===i?void 0:i.find((e=>{var t;return"public:*"===e.identifier&&(null===(t=e.actions)||void 0===t?void 0:t.includes("read"))}));for(const r of s){const e=r.state;if(e&&("slack.message"===e.type||"slack.app.mention"===e.type||"slack.reaction.added"===e.type||"slack.thread.created"===e.type)&&e.channelIds&&!a)for(const t of e.channelIds)o=h({module:o,channelId:t})}return await Promise.resolve(o)}};function h(e){var t;const{module:n,channelId:i}=e;if(null===(t=n.permissions)||void 0===t?void 0:t.find((e=>Array.isArray(e.identifier)?e.identifier.includes(i):e.identifier===i)))return n;const o={moduleType:"slack",type:"slack",identifier:i,actions:["read"]};return{...n,permissions:[...n.permissions||[],o]}}const v={type:"zendesk",config:{scopes:["read","write"]},isAvailable:({configStep:e,experimentService:t,userId:n,spaceId:i})=>Boolean(e.enableExperimentalIntegrations&&t.checkGate({gateName:"workflows_zendesk_module_available",actor:n?{table:"notion_user",id:n}:a().S3,customIDs:{spaceId:i}})),authentication:{type:"oauth2"},latestVersion:"1.0.0",triggers:{"zendesk.ticket":{isTriggerConfigured:()=>!0,triggerDuplicator:({original:e})=>({type:e.type,status:e.status,priority:e.priority,tags:e.tags}),versionAvailability:"*",createDefaultState:()=>({type:"zendesk.ticket"})}},effects:{"zendesk.getTicket":{versionAvailability:"*"},"zendesk.addTicket":{versionAvailability:"*"},"zendesk.addComment":{versionAvailability:"*"},"zendesk.getComments":{versionAvailability:"*"},"zendesk.updateTicket":{versionAvailability:"*"}},stateDuplicator:()=>{},getModuleConfigurationStatus:e=>{var t;return null!==(t=e.state)&&void 0!==t&&t.connectionPointer?"ready":"invalid"},getDescription:e=>e.formatMessage({id:"workflows.modules.zendesk.description",defaultMessage:"Integration with Zendesk Support"}),getName:e=>e.formatMessage({id:"workflows.modules.zendesk.name",defaultMessage:"Zendesk"}),getMessageIfNotValid:(e,t)=>e.formatMessage({id:"workflows.modules.zendesk.notConnected",defaultMessage:"Zendesk is not connected to {workflowName}"},{workflowName:t}),getModuleConfigSection:()=>"connections",getIcon:()=>n(295434).zendeskIcon},y={calendar:r,codegen:l,config:n(788060).$,files:d,github:c,mail:u,mcpServer:p,notion:n(71621).IN,pipedream:g,slack:f,zendesk:v};function b(e){return y[e]}function S(e,t){var n;return null===(n=b(e))||void 0===n?void 0:n.triggers[t]}function x(e){for(const t of Object.values(y))if(t)for(const[n,o]of(0,i().WP)(t.triggers))if(n===e)return o}o().union([o().object({optional:{callbackType:o().literals(...s().Bi),moduleSpecific:o().string(),redirectToAuth:o().literal("true"),transcriptId:o().string(),workflowId:o().string()},required:{moduleId:o().string(),spaceId:o().string(),type:o().literal("workflow"),userId:o().string()}}),o().object({optional:{callbackType:o().literals(...s().Bi),moduleSpecific:o().string(),redirectToAuth:o().literal("true")},required:{integrationId:o().string(),spaceId:o().string(),transcriptId:o().string(),type:o().literal("agent"),userId:o().string()}})])},197632:(e,t,n)=>{n.r(t),n.d(t,{PageLayoutEditor:()=>ni});var i=n(296540),o=()=>n(402014),s=()=>n(484714),a=()=>n(56366),r=()=>n(401497),l=()=>n(611648),d=()=>n(387964),c=()=>n(22634),u=()=>n(69708),p=()=>n(534177),g=()=>n(145214),m=()=>n(285790),f=()=>n(2143),h=()=>n(852302),v=()=>n(859428),y=()=>n(21140),b=()=>n(972435),S=()=>n(479062),x=()=>n(524165),A=()=>n(812412),M=()=>n(542371),w=()=>n(263711),j=()=>n(59226),k=()=>n(148307),I=()=>n(651124),C=()=>n(390066),T=()=>n(738418),_=()=>n(800065),P=()=>n(284371),B=()=>n(334261),D=()=>n(896628),R=()=>n(231297),E=()=>n(115552),L=()=>n(678553),O=()=>n(581369),N=()=>n(757754),F=()=>n(867159),U=()=>n(645873);const z={switchFromSimpleToTabbedLayoutActions:new(U().O2)("switchFromSimpleToTabbedLayoutActions",(async()=>n.e(63990).then(n.bind(n,288143)))),switchFromTabbedToSimpleLayoutActions:new(U().O2)("switchFromTabbedToSimpleLayoutActions",(async()=>n.e(61362).then(n.bind(n,434867)))),createRelationViewsModuleActions:new(U().O2)("createRelationViewsModuleActinos",(async()=>n.e(84455).then(n.bind(n,957568)))),deleteViewsModuleDependenciesActions:new(U().O2)("deleteViewsModuleDependenciesActions",(async()=>Promise.resolve().then(n.bind(n,658616))))};n(944114),n(581454);var K=()=>n(898244),V=()=>n(852424),q=()=>n(381138),W=()=>n(908201),G=()=>n(760217),H=()=>n(419357),Y=()=>n(939740),$=()=>n(89924),Q=()=>n(852353),Z=(n(898992),n(354520),n(672577),n.n(n(844751)));function J({sections:e,filterQuery:t}){return(0,i.useMemo)((()=>e.map((e=>function(e,t){const{items:n,...i}=e;if(!t)return e;const o=n.filter((e=>e.keywords.find((e=>Z().match(t,e)))));return o.length>0?{...i,items:o}:void 0}(e,t))).filter(p().O9)),[t,e])}var X=()=>n(937199),ee=()=>n(369186),te=()=>n(183558),ne=()=>n(978846);function ie(e){const{propertyId:t,propertyType:n,environment:i,transaction:o,layoutStore:s,collectionStore:a,currentModuleSelection:r,sessionId:l,isPropertyCreation:d}=e,c=s.getModel(),u=a.getModel();if(!c||!u||"new_module"!==(null==r?void 0:r.type))return;const p={id:(0,te().Ay)(),type:"property",propertyId:t,style:"expanded"};if("person"===n||"created_by"===n||"last_edited_by"===n?p.config={property_person:{style:"compact"}}:"number"===n&&(p.config={property_number:{style:"large"}}),"form_conditional_modules"===r.area)return;const g=(0,ee().dI)({collectionModel:u,module:p});return(0,ne().UQ)({environment:i,transaction:o,layoutStore:s,position:"views_main_tab_modules"===r.area?{type:"area_relative",area:r.area,viewId:r.viewsMainTabId,location:"end_moveable"}:{type:"area_relative",area:r.area,location:"end_moveable"},module:g,sessionId:l,isPropertyCreation:d}),p}function oe(){const e=(0,s().v3)(),{layoutStore:t,currentModuleSelection:o,setModuleSelection:a,sessionId:r}=(0,X().LH)(),{collectionStore:l}=(0,X().bi)();return(0,i.useCallback)((({propertyType:i,isPropertyCreation:s})=>{const{performResult:d}=R().createAndCommit({userAction:"AddPageLayoutModuleEditorSidebar.handleCreateNewStandardProperty",environment:e,canUndo:!0,perform:a=>{const d=t.getModel(),c=l.getModel();if(!d||!c||"new_module"!==(null==o?void 0:o.type))return;return ie({propertyId:(0,n(581928).createProperty)({environment:e,collectionStore:l,collectionViewArgs:void 0,propertyName:Q().dC[i],propertyType:i,transaction:a}),propertyType:i,environment:e,transaction:a,layoutStore:t,collectionStore:l,currentModuleSelection:o,sessionId:r,isPropertyCreation:s})}});d&&a({type:"existing_module",moduleId:d.id,isDragging:!1})}),[e,a,t,l,o,r])}function se(){const e=(0,s().v3)(),{layoutStore:t,currentModuleSelection:n,setModuleSelection:o,sessionId:a}=(0,X().LH)(),{collectionStore:r}=(0,X().bi)();return(0,i.useCallback)((i=>{const{propertyId:s,propertyType:l}=i,{performResult:d}=R().createAndCommit({userAction:"AddPageLayoutModuleEditorSidebar.AddPropertyAsNewModule",environment:e,canUndo:!0,perform:i=>ie({propertyId:s,propertyType:l,environment:e,transaction:i,layoutStore:t,collectionStore:r,currentModuleSelection:n,sessionId:a,isPropertyCreation:!1})});return d?(o({type:"existing_module",moduleId:d.id,isDragging:!1}),d):null}),[e,o,t,r,n,a])}n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698);var ae=()=>n(713998),re=()=>n(778781),le=n(474848);function de(e){return void 0!==e[1]}function ce({propertySortPriority:e,defaultCount:t,moreButtonStyle:o,moreButtonTitleStyle:s,isSearching:r}){const{layoutStore:l}=(0,X().LH)(),{collectionStore:d}=(0,X().bi)(),c=(0,n(248064).h)(),g=(0,a().K8)((()=>{const e=l.getModules();return new Set((0,n(36682).Q)(e).filter(re().gx).map((e=>e.propertyId)))}),[l]),[m,f]=i.useState(!1);return(0,a().K8)((()=>{const i=d.getSchema();if(!l.getModel())return[];const a=(0,p().WP)(i).filter(de).sort(((t,n)=>{const i=t[1],o=n[1];return(e[i.type]??1/0)-(e[o.type]??1/0)})).map((([e,t])=>{if(e!==K().rn&&!g.has(e))return(0,n(381283).J)(t)?{id:(0,te().Ay)(),type:`property_${t.type}`,propertyId:e,style:"compact"}:(0,n(341136).A)(t)?{id:(0,te().Ay)(),type:`property_${t.type}`,propertyId:e,style:"large"}:"formula"===t.type?{id:(0,te().Ay)(),type:`property_${t.type}`,propertyId:e,style:(0,n(708685).isNumberFormulaPropertySchema)(t)?"large":"small"}:"file"===t.type?{id:(0,te().Ay)(),type:`property_${t.type}`,propertyId:e,style:"landscape"}:"place"===t.type?{id:(0,te().Ay)(),type:`property_${t.type}`,propertyId:e,style:"map"}:{id:(0,te().Ay)(),type:`property_${t.type}`,propertyId:e}})).filter(p().O9).map((e=>{const t=(0,ae()._g)({schema:i,property:e.propertyId});if(t)return{key:e.id,keywords:[t.name,Q().dC[t.type]],render:({ref:t,...i})=>(0,le.jsx)(n(63667).k,{...i,propertyId:e.propertyId}),action:()=>{c({layoutModule:e})}}})).filter(p().O9),h={keywords:[],key:"use-existing-property-show-more",render:e=>(0,le.jsx)(G().A,{...e,buttonStyle:o,desktopTitleStyle:s,title:m?(0,le.jsx)(u().sA,{defaultMessage:"Less",id:"layoutBuilderProperties.less.buttonTitle"}):(0,le.jsx)(u().sA,{defaultMessage:"More",id:"layoutBuilderProperties.more.buttonTitle"})}),action:()=>f((e=>!e))};return a.length>t&&!r?[...m?a:a.slice(0,t),h]:a}),[c,d,l,g,e,t,m,o,s,r])}const ue=(0,u().YK)({addToPage:{id:"AddPageLayoutModuleEditorSidebar.addToPage",defaultMessage:"Add to page"},addToPanel:{id:"AddPageLayoutModuleEditorSidebar.addToPanel",defaultMessage:"Add to panel"},suggestedModulesSectionTitle:{defaultMessage:"Suggested",id:"AddPageLayoutModuleEditorSidebar.suggestedModulesSectionTitle"},existingPropertiesSectionTitle:{defaultMessage:"Use an existing property",id:"AddPageLayoutModuleEditorSidebar.existingPropertiesSectionTitle"},createNewPropertyModuleSectionTitle:{defaultMessage:"Create new property",id:"AddPageLayoutModuleEditorSidebar.createNewPropertyModuleSectionTitle"},closeAddModulesMenu:{defaultMessage:"Close add modules menu",id:"AddPageLayoutModuleEditorSidebar.closeAddModulesMenu"},searchInputPlaceholder:{defaultMessage:"Search...",id:"AddPageLayoutModuleEditorSidebar.searchInputPlaceholder"},searchInputNotFound:{defaultMessage:"Not found",id:"AddPageLayoutModuleEditorSidebar.searchInputNotFound"},propertyFileCaption:{id:"AddPageLayoutModuleButton.tooltip.files.caption",defaultMessage:"Add images, videos, or files"},propertyAiSummaryCaption:{id:"AddPageLayoutModuleButton.tooltip.aiSummary.caption",defaultMessage:"Use AI to summarize the page"},propertyPersonCaption:{id:"AddPageLayoutModuleButton.tooltip.person.caption",defaultMessage:"Add anyone in your workspace"},propertyTextCaption:{id:"AddPageLayoutModuleButton.tooltip.text.caption",defaultMessage:"Just start writing with plain text"},propertyNumberCaption:{id:"AddPageLayoutModuleButton.tooltip.number.caption",defaultMessage:"Display numbers with rings or bars"}}),pe={file:{icon:k().A.images.layouts.configuration.propertyFilesMediaPreviewJpg,tooltip:{image:k().A.images.layouts.configuration.propertyFilesMediaPreviewLargePng,caption:ue.propertyFileCaption}},ai_summary:{icon:k().A.images.layouts.configuration.propertyAiSummaryPreviewPng,tooltip:{image:k().A.images.layouts.configuration.propertyAiSummaryPreviewLargePng,caption:ue.propertyAiSummaryCaption}},person:{icon:k().A.images.layouts.configuration.propertyPersonPreviewPng,tooltip:{image:k().A.images.layouts.configuration.propertyPersonPreviewLargePng,caption:ue.propertyPersonCaption}},text:{icon:n(435644).a,tooltip:{image:k().A.images.tooltips.blocks.textPng,caption:ue.propertyTextCaption}},number:{icon:k().A.images.layouts.configuration.propertyNumberPreviewPng,tooltip:{image:k().A.images.layouts.configuration.propertyNumberPreviewLargePng,caption:ue.propertyNumberCaption}}},ge={file:1,ai_summary:2,number:3,text:4,person:5},me=i.memo((function(){const e=(0,s().v3)(),t=(0,r().DP)(),o=(0,u().tz)(),{currentModuleSelection:l,isPropertyTypeSearchInputDirtyStore:d}=(0,X().LH)(),c=(0,W().ET)(),p="new_module"===(null==l?void 0:l.type)&&"page_details"===l.area,g=(0,a().K8)((()=>[...(0,Q().xm)({collectionContextStore:c,environment:e}),"ai_summary"].sort(((e,t)=>(ge[e]??1/0)-(ge[t]??1/0)))),[c,e]),[m,f]=(0,i.useState)(!1),[h,v]=(0,i.useState)(),b=(0,i.useCallback)((e=>{d.setState(!0),v(e.target.value)}),[d]);i.useEffect((()=>()=>{d.setState(!1)}),[d]);const S=oe(),x=se(),A=(0,i.useMemo)((()=>({actionHandler:e=>S({propertyType:e,isPropertyCreation:!0}),tooltip:e=>{const t=pe[e];return null==t?void 0:t.tooltip},renderIcon:e=>{const n=pe[e],i="dark"===t.mode&&null!=n&&n.darkModeIcon?null==n?void 0:n.darkModeIcon:null==n?void 0:n.icon;return i&&"string"!=typeof i?i({width:20,fill:"light"===t.mode?"rgba(79, 79, 79, 1)":(0,V().P0)({theme:t,willShowOnTooltip:!1})}):(0,le.jsx)(V().zB,{size:i?36:16,theme:t,type:e,icon:i,style:{fill:(0,K().hN)(e)?t.aiPurpleColor:void 0}})},propertySettingsPopupProps:e=>"relation"!==e?null:{settingsViewToOpen:{property:void 0,type:"selectRelationSource",formatKey:"page_view_properties"},isPropertyEditComplete:e=>Boolean((0,K().nC)(e)&&e.collection_id),onPropertyEditComplete:t=>{x({propertyId:t,propertyType:e})},rollbackIfEditIncomplete:!0}})),[S,t,x]),M=(0,n(959733).g)(A),w=(0,r().IS)((e=>({sidebarHeading:{fontSize:16,lineHeight:"24px",fontWeight:P().Wy.medium,marginInlineStart:8,paddingBottom:2},searchInputContainer:{marginTop:8,marginBottom:14,marginInlineStart:6},searchInput:{background:e.background.primary},searchInputIcon:{fill:e.icon.secondary,width:10},searchNotFound:{fontSize:".8rem",color:e.text.tertiary,userSelect:"none",cursor:"default",flexShrink:0,marginInlineEnd:4},moreButton:{marginInlineStart:0},moreButtonTitle:{margin:0,color:e.text.tertiary,fontSize:12,paddingTop:0,paddingInlineEnd:0,paddingBottom:0,paddingInlineStart:6},sectionTitle:{paddingTop:0,paddingInlineEnd:0,paddingBottom:0,paddingInlineStart:6}})),[]),j=(0,a().K8)((()=>{const e=h||m,t={keywords:[],key:"create-new-property-more",render:e=>(0,le.jsx)(G().A,{...e,buttonStyle:w.moreButton,desktopTitleStyle:w.moreButtonTitle,title:m?(0,le.jsx)(u().sA,{defaultMessage:"Less",id:"layoutBuilderProperties.less.buttonTitle"}):(0,le.jsx)(u().sA,{defaultMessage:"More",id:"layoutBuilderProperties.more.buttonTitle"})}),action:()=>f((e=>!e))};return[...g.slice(0,e?void 0:5).map(M),...h?[]:[t]]}),[g,m,M,h,w.moreButton,w.moreButtonTitle]),k=ce({propertySortPriority:ge,defaultCount:4,moreButtonStyle:w.moreButton,moreButtonTitleStyle:w.moreButtonTitle,isSearching:Boolean(h)}),I=(0,i.useMemo)((()=>{const e=[];return k.length>0&&e.push({key:"existing-properties",render:e=>(0,le.jsx)($().A,{title:o.formatMessage(ue.existingPropertiesSectionTitle),desktopTitleStyle:w.sectionTitle,...e}),items:k}),e.push({key:"create-new-properties",render:e=>(0,le.jsx)($().A,{title:o.formatMessage(ue.createNewPropertyModuleSectionTitle),desktopTitleStyle:w.sectionTitle,...e}),items:j}),e}),[j,k,o,w.sectionTitle]),C=J({sections:I,filterQuery:h}),T=i.useMemo((()=>{if(!(""===h||C.length>0))return(0,le.jsx)(y().Ye,{alignItems:"center",gap:8,children:(0,le.jsx)("div",{children:o.formatMessage(ue.searchInputNotFound)})})}),[C,h,o]);return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(y().Ye,{style:w.sidebarHeading,alignItems:"center",children:(0,le.jsx)(u().sA,{...p?ue.addToPanel:ue.addToPage})}),(0,le.jsx)(H().Ay,{focusInitial:!0,onChange:b,placeholder:o.formatMessage(ue.searchInputPlaceholder),showClearButton:!0,value:h||"",style:w.searchInputContainer,inputOuterStyle:w.searchInput,inputLeft:(0,q().q)(w.searchInputIcon),itemMarginLeft:0,inputRight:T,inputRightStyle:w.searchNotFound}),(0,le.jsx)(Y().Ay,{initialFocus:0,type:Y().Oh.Vertical,sections:C})]})}));var fe=()=>n(435930),he=(n(803949),()=>n(124672)),ve=()=>n(623186),ye=()=>n(171018),be=(n(430670),()=>n(757695)),Se=()=>n(591779),xe=()=>n(643707),Ae=()=>n(135154),Me=()=>n(953418);function we(e){const{propertyGroups:t,propertyIdsToExclude:n,mergedPropertiesMap:o}=e,r=i.useMemo((()=>be().Store.createValue("")),[]),[l,d]=i.useState([]),[c,u]=i.useState({}),[p,g]=i.useState(null),m=i.useMemo((()=>{let e=t?t.flatMap((e=>e.propertyIds||[])):Object.keys(o);return n&&(e=e.filter((e=>!n.has(e)))),e}),[o,t,n]),f=(0,a().O$)(r),h=(0,Se().lW)(f,100,((e,t)=>e===t));i.useEffect((()=>{const e=[],t={};if(""!==h)for(const n of m){const i=o[n];i&&null!==Z().match(h,i.name)&&(e.push(n),t[n]=e.length-1)}(l.length!==e.length||e.some(((e,t)=>e!==l[t])))&&(d(e),u(t))}),[m,l,h,o]),i.useEffect((()=>{if(0===l.length)return void g(null);const e=null!==p?l[p]:null;e&&void 0!==c[e]?g(c[e]):g(0)}),[p,l,c]);const v=(0,s().v3)(),y=null!==p?l[p]:null;return i.useEffect((()=>{const e=document.getElementsByClassName(xe().wT).item(0);e&&!(0,Ae().E)({element:e})&&(0,Me().uf)({el:e,environment:v,windowHeight:window.innerHeight,minEdgeDist:16})}),[v,y]),{searchInputValueStore:r,searchMatchesMap:c,searchMatches:l,activeSearchMatchIndex:p,moveToNextSearchMatch:()=>{if(null===p||l.length<=1)return;const e=p+1;g(e<=l.length-1?e:0)},moveToPreviousSearchMatch:()=>{if(null===p||l.length<=1)return;const e=p-1;g(e>=0?e:l.length-1)}}}var je=()=>n(157260);function ke({propertyGroupId:e,pagePropertiesStore:t}){const{collectionStore:n}=(0,X().bi)(),i=(0,r().IS)((e=>({button:{color:e.text.secondary,paddingInlineStart:8,height:34},buttonIcon:{fill:e.icon.secondary,marginInlineEnd:2}})),[]);return(0,le.jsx)(je().Xt,{style:i.button,iconStyle:i.buttonIcon,collectionStore:n,isInPeekRenderer:!1,propertyGroupId:e,pagePropertiesStore:t})}const Ie=i.memo(ke);n(16280);var Ce=()=>n(631524),Te=()=>n(160432),_e=()=>n(158359),Pe=()=>n(498474),Be=()=>n(957963),De=()=>n(236262),Re=()=>n(201980),Ee=()=>n(496603),Le=()=>n(406699),Oe=()=>n(57232),Ne=()=>n(805751),Fe=()=>n(623580),Ue=()=>n(404277),ze=()=>n(417392),Ke=()=>n(722872),Ve=()=>n(463830),qe=()=>n(395963);class We extends be().Store{getInitialState(){return{}}isRenameInputForcedOpenForGroup(e){var t;return(null===(t=this.getState())||void 0===t?void 0:t.forceOpenRenameInputForGroupId)===e}resetForceRenameInputOpen(){const e=this.getState();return this.setState({...e,forceOpenRenameInputForGroupId:void 0})}}const Ge=new We;function He(e){const{title:t,propertyGroupId:n,isFirstPropertyGroup:o,isLastPropertyGroup:l,styles:d}=e,c=(0,a().uB)(void 0,Ve().A),p=(0,a().K8)((()=>Ge.isRenameInputForcedOpenForGroup(n)),[n]),[g,m]=(0,i.useState)(p);(0,i.useEffect)((()=>{c.setState({...c.state,open:p})}),[c,p]);const f=(0,i.useCallback)((()=>{m(!1),Ge.resetForceRenameInputOpen()}),[]),h=function(){const{collectionStore:e}=(0,X().bi)(),t=(0,s().v3)();return(0,i.useCallback)((n=>{R().createAndCommit({environment:t,perform(t){(0,qe().Px)({collectionStore:e,groupId:n,transaction:t})},canUndo:!0,userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"})}),[e,t])}(),v=function(){const{collectionStore:e}=(0,X().bi)(),t=(0,s().v3)();return(0,i.useCallback)((n=>{R().createAndCommit({environment:t,perform(t){(0,qe().Tk)({collectionStore:e,groupId:n,transaction:t})},canUndo:!0,userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"})}),[e,t])}(),y=function(){const{collectionStore:e}=(0,X().bi)(),t=(0,s().v3)();return(0,i.useCallback)((n=>{R().createAndCommit({environment:t,perform(t){(0,qe().QI)({collectionStore:e,groupId:n,transaction:t})},canUndo:!0,userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"})}),[e,t])}(),b=(0,r().IS)((e=>({container:{display:"flex",alignItems:"center",padding:"0 2px",...(null==d?void 0:d.container)||{}},titleContainer:{display:"flex",alignItems:"center",marginInlineEnd:"auto",paddingInlineStart:5,borderRadius:4,height:"auto",width:"100%"},label:{fontSize:"12px",lineHeight:"24px",color:e.text.secondary,fontWeight:500,paddingTop:0,paddingInlineEnd:8,paddingBottom:0,paddingInlineStart:5,display:"block",...P().RC},menuIcon:{width:16,height:16},dragIcon:{fill:e.icon.secondary}})),[d]);return(0,le.jsx)("div",{style:b.container,children:(0,le.jsx)(Le().A,{style:{width:268},onClose:f,popupType:ze().nl.Popup,renderOrigin:e=>(0,le.jsxs)(Ce().p,{...e,style:b.titleContainer,children:[(0,le.jsx)(Oe().A,{iconSize:12,iconStyle:b.dragIcon}),(0,le.jsx)("div",{style:b.label,children:t})]}),buttonPopupStore:c,alignmentToOrigin:"start",render:e=>{return g?(0,le.jsx)(Ye,{propertyGroupId:n,value:t||"",afterSubmit:e.close}):(0,le.jsx)(Ue().A,{menuType:Ke().gu.Popup,children:(0,le.jsx)(Y().Ay,{type:Y().Oh.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,le.jsx)($().A,{...e}),items:(i=e.close,(0,Ee().oE)([{key:"rename",render:e=>(0,le.jsx)(G().A,{...e,icon:(0,Be().j)(b.menuIcon),title:(0,le.jsx)(u().sA,{defaultMessage:"Rename",id:"ConfigurePropertyGroupModuleGroupHeading.rename"})}),action:()=>{m(!0)}},!o&&{key:"move-up",render:e=>(0,le.jsx)(G().A,{...e,icon:(0,Pe().q)(b.menuIcon),title:(0,le.jsx)(u().sA,{defaultMessage:"Move up",id:"ConfigurePropertyGroupModuleGroupHeading.moveUp"})}),action:()=>{v(n),i()}},!l&&{key:"move-down",render:e=>(0,le.jsx)(G().A,{...e,icon:(0,_e().P)(b.menuIcon),title:(0,le.jsx)(u().sA,{defaultMessage:"Move down",id:"ConfigurePropertyGroupModuleGroupHeading.moveDown"})}),action:()=>{y(n),i()}},{key:"delete",render:e=>(0,le.jsx)(G().A,{...e,icon:(0,De().trashIcon)({width:16,height:16}),title:(0,le.jsx)(u().sA,{defaultMessage:"Delete",id:"ConfigurePropertyGroupModuleGroupHeading.delete"}),caption:(0,le.jsx)(u().sA,{defaultMessage:"No properties will be deleted",id:"ConfigurePropertyGroupModuleGroupHeading.deleteCaption"})}),action:()=>{h(n),i()}}]))}]})});var i}})})}function Ye({propertyGroupId:e,afterSubmit:t,value:n}){const[o,a]=(0,i.useState)(n),l=(0,r().IS)((()=>({container:{display:"flex",padding:"6px"},input:{marginInlineEnd:4,flexGrow:1},button:{}})),[]),d=function(){const{collectionStore:e}=(0,X().bi)(),t=(0,s().v3)();return(0,i.useCallback)(((n,i)=>{const o=e.getNormalizedPropertyGroups();if(void 0===o)throw new Error("Error renaming property group. Collection Does not have property groups.");const s=o.map((e=>e.id===n?{...e,title:i}:e));R().createAndCommit({environment:t,perform(t){D().zA({stores:[e],update:{property_groups:s},transaction:t})},canUndo:!0,userAction:"ConfigurePropertyExplorerModule.renameCollectionPropertyGroup"})}),[e,t])}(),c=(0,i.useCallback)((()=>{const n=(0,Re().xV3)(o).trim();0!==n.length&&(d(e,n),t())}),[t,d,o,e]),p=(0,i.useCallback)((e=>{a(e.target.value)}),[]);return(0,le.jsx)(Ne().A,{debugName:"ConfigurePropertyGroupHeader",capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!0,children:(0,le.jsxs)("div",{style:l.container,children:[(0,le.jsx)(Fe().A,{style:l.input,onSubmit:c,selectAll:!0,value:o,onChange:p,focusInitial:!0}),(0,le.jsx)(Te().A,{colorPalette:"blue",style:l.button,onClick:c,children:(0,le.jsx)(u().sA,{id:"ConfigurePropertyGroupModuleGroupHeading.updatePropertyGroupTitle",defaultMessage:"Done"})})]})})}var $e=()=>n(387358),Qe=()=>n(439264);n(18107);function Ze({sections:e,onDrop:t,renderKey:n,getInvalidDropIndices:o,direction:s}){const[a,l]=i.useState({type:"notDragging"}),d=(0,i.useMemo)((()=>{const t={};for(const n of e)t[et(n.key)]=n;return t}),[e]),c=(0,i.useCallback)((e=>(0,p().O9)(d[et(e)])),[d]),u=(0,i.useMemo)((()=>e.flatMap((e=>[e.key,...e.items]))),[e]),g=(0,i.useMemo)((()=>u.map(et)),[u]),m=(0,i.useMemo)((()=>{const e={};for(const t of u)e[et(t)]=t;return e}),[u]),f=i.useCallback(((n,{key:i})=>{c(i)?t({newSections:Xe({orderedSectionKeys:n.filter(c),originalSections:e}),droppedKey:i,isSection:!0}):t({newSections:Je({flattenedKeys:n.map((e=>m[e])),getIsSection:c}),droppedKey:i,isSection:!1})}),[c,t,e,m]),h=i.useCallback((e=>{c(e)?l({type:"draggingSection",key:e}):l({type:"draggingItem",key:e})}),[c]),v=i.useCallback((()=>l({type:"notDragging"})),[]),y=(0,i.useCallback)((e=>{let t;t=c(e)?new Set(u.flatMap(((e,t)=>c(e)?[]:[t]))):new Set([0]);const n=null==o?void 0:o({flattenedKeys:g,...c(e)?{isSection:!0,key:e}:{isSection:!1,key:e}});return n?new Set([...t,...n]):t}),[o,c,u,g]),b=(0,r().IS)((e=>{const t={opacity:1,transition:"opacity 0.2s ease"},n={...t,opacity:.7};return{container:{},undraggedSection:t,draggedSection:n,undraggedItem:{...t,width:"100%"},draggedItem:{...n,width:"100%"},itemInDraggedSection:{...t,opacity:0,width:"100%"}}}),[]),S=(0,i.useMemo)((()=>{const t="draggingSection"===a.type?a.key:void 0,i="draggingItem"===a.type?a.key:void 0,o={};return e.forEach(((e,i)=>{const s=et(e.key),a=t===s;o[s]=(0,le.jsx)("div",{style:a?b.draggedSection:b.undraggedSection,children:n({key:s,isDraggable:tt(e.key),isSection:!0,sectionIndex:i,sectionLength:e.items.length})})})),e.forEach(((e,s)=>{const a=t===et(e.key);return e.items.forEach(((t,r)=>{const l=i===et(t),d=e.items.length,c=et(t);o[c]=(0,le.jsx)("div",{style:l?b.draggedItem:a?b.itemInDraggedSection:b.undraggedItem,children:n({key:et(t),isDraggable:tt(t),isSection:!1,sectionIndex:s,itemIndex:r,sectionLength:d})})}))})),o}),[a,n,e,b.draggedItem,b.draggedSection,b.itemInDraggedSection,b.undraggedItem,b.undraggedSection]);return(0,le.jsx)(Qe().Ay,{style:b.container,direction:s,keys:u,renderKey:e=>S[e],onDraggingKeyChanged:h,onDragEnd:v,onDrop:f,getInvalidDropIndices:y})}function Je({flattenedKeys:e,getIsSection:t}){const n=function({orderedList:e,getIsSection:t}){const n=e.findIndex((e=>t(e)));if(-1===n||0===n)return e;return[e[n],...e.slice(0,n),...e.slice(n+1)]}({orderedList:e,getIsSection:t}),i=[];for(const o of n)if(t(o))i.push({key:o,items:[]});else{const e=o,t=i.at(-1);t&&t.items.push(e)}return i}function Xe({orderedSectionKeys:e,originalSections:t}){const n={};for(const i of t)n[et(i.key)]={key:i.key,items:i.items};return e.flatMap((e=>n[e]?[n[e]]:[]))}function et(e){return"string"==typeof e?e:e.key}function tt(e){return"string"==typeof e||(e.draggable??!0)}const nt=i.memo(Ze);function it(e){const{collectionFormat:t,mergedProperties:n,renderPropertyRow:o}=e,{collectionStore:s}=(0,X().bi)(),r=(0,a().K8)((()=>null==n?void 0:n.map((e=>e.property))),[n]),l=(0,i.useCallback)(((e,t)=>o({propertyId:e,rowIndex:t})),[o]),d=(0,ve().Od)({collectionStore:s,format:t});return r?(0,le.jsx)(Qe().Ay,{keys:r,onDrop:d,direction:"vertical",renderKey:l}):null}function ot(e){const{renderPropertyRow:t,renderPropertyGroupRow:n,renderAddPropertyButton:o}=e,r=(0,s().v3)(),{collectionStore:l}=(0,X().bi)(),d=(0,a().K8)((()=>l.getNormalizedPropertyGroups()??[]),[l]),c=(0,i.useMemo)((()=>Object.fromEntries(d.map((e=>[e.id,e])))),[d]),u=(0,a().K8)((()=>d.map((e=>{var t;return{key:{key:e.id,draggable:!0},items:[...(null===(t=e.propertyIds)||void 0===t?void 0:t.map((e=>({key:e,draggable:!0}))))??[],(0,$e().Op)(e.id)]}}))),[d]),g=(0,i.useCallback)((({flattenedKeys:e,isSection:t})=>t?new Set(e.flatMap(((e,t)=>(0,p().O9)(c[e])?[]:[t]))):new Set(e.flatMap(((e,t)=>(0,$e().k9)(e)?[t+1]:[])))),[c]),m=(0,i.useCallback)((e=>{var i;return e.isSection?n({groupId:e.key,groupTitle:null===(i=c[e.key])||void 0===i?void 0:i.title,rowIndex:e.sectionIndex}):(0,$e().k9)(e.key)?o((0,$e().qB)(e.key)):t({propertyId:e.key,rowIndex:e.sectionIndex})}),[c,o,n,t]),f=(0,i.useCallback)((e=>{const t=e.newSections.map((e=>{var t;const n=e.items.map((e=>"string"==typeof e?e:e.key)).filter((e=>!(0,$e().k9)(e))),i="string"==typeof e.key?e.key:e.key.key;return{id:i,title:null===(t=c[i])||void 0===t?void 0:t.title,propertyIds:n}}));R().createAndCommit({environment:r,perform(e){(0,qe().Yf)({collectionStore:l,newGroups:t,transaction:e})},canUndo:!0,userAction:"ConfigurePropertyExplorerModule.onDrop"})}),[l,r,c]);return(0,le.jsx)(nt,{direction:"vertical",sections:u,renderKey:m,onDrop:f,getInvalidDropIndices:g})}var st=()=>n(252291),at=()=>n(187881),rt=()=>n(514608),lt=()=>n(340498);const dt=(0,lt().wt)("eyelash",{viewBox:"0 0 16 16",svg:(0,le.jsx)("path",{fillRule:"evenodd",d:"M2.1488 5.12366C1.94088 4.76541 1.48191 4.64354 1.12366 4.85145C0.76541 5.05937 0.643537 5.51833 0.851451 5.87659C1.05856 6.23345 1.30425 6.56012 1.58188 6.85746L0.46967 7.96967C0.176777 8.26256 0.176777 8.73744 0.46967 9.03033C0.762563 9.32322 1.23744 9.32322 1.53033 9.03033L2.73804 7.82262C3.18107 8.11266 3.66308 8.35645 4.17017 8.55584L3.30384 10.7217C3.15001 11.1062 3.33707 11.5427 3.72166 11.6966C4.10624 11.8504 4.54272 11.6633 4.69656 11.2787L5.61111 8.99235C6.14972 9.11164 6.70058 9.18864 7.25 9.22519V11.5C7.25 11.9142 7.58579 12.25 8 12.25C8.41421 12.25 8.75 11.9142 8.75 11.5V9.2252C9.29955 9.18866 9.85054 9.11164 10.3893 8.99232L11.3038 11.2787C11.4577 11.6633 11.8942 11.8504 12.2787 11.6966C12.6633 11.5427 12.8504 11.1062 12.6966 10.7217L11.8302 8.55579C12.3372 8.35643 12.8191 8.11269 13.2621 7.82272L14.4697 9.03033C14.7626 9.32322 15.2374 9.32322 15.5303 9.03033C15.8232 8.73744 15.8232 8.26256 15.5303 7.96967L14.4182 6.85759C14.6959 6.56021 14.9417 6.2335 15.1488 5.87659C15.3567 5.51833 15.2348 5.05937 14.8766 4.85145C14.5183 4.64354 14.0594 4.76541 13.8515 5.12366C12.883 6.79244 10.5428 7.75012 8.00012 7.75012C5.45748 7.75012 3.11728 6.79244 2.1488 5.12366Z"})});var ct=()=>n(566910),ut=()=>n(725900),pt=()=>n(68350);function gt({collectionStore:e,pageStore:t,layoutModule:n,pagePropertiesStore:o,propertyId:s,draggable:l,rightButton:d,searchHighlighted:c}){const u=(0,a().K8)((()=>t.isNonEditableState()),[t]),{collectionSchema:p,collectionFormat:g,canEditCollection:m}=(0,a().K8)((()=>({collectionSchema:e.getSchema(),collectionFormat:e.getFormat(),canEditCollection:e.canEdit()})),[e]),f=(0,r().IS)((()=>({propertyRowContainer:{width:"100%",minWidth:"100%",display:"grid",alignItems:"center",gridTemplateColumns:"1fr auto",gap:2,paddingInlineStart:2}})),[]),h=(0,i.useMemo)((()=>({color:"primary",size:"medium",fontWeight:"regular",width:{variant:"fixed",widthDesktop:"100%",widthMobile:"100%"}})),[]),v=Boolean(c),y=Boolean(c&&c.active);return(0,le.jsxs)("div",{style:f.propertyRowContainer,children:[(0,le.jsx)(pt().I,{schema:p,styleVariants:h,format:g,property:s,collectionStore:e,disabled:!1,locked:u,canConfigureCollection:m,isInPeekRenderer:!1,hideDragHandle:!l,showDragHandleAsIcon:!0,dragHandleStyle:{width:16,marginInlineEnd:2},blockStore:t,pagePropertiesStore:o,layoutModule:n,forceHighlight:v,forceFocusedHighlight:y}),d?d():null]})}function mt(e){const{propertyId:t,propertyFormat:n,pagePropertiesStore:o,collectionStore:r,pageStore:l,searchHighlighted:d}=e,c=(0,u().tz)(),p=(0,s().v3)(),g=(0,a().K8)((()=>r.getSchema()),[r]),f=(0,a().K8)((()=>(0,C().L)(r.getFormat(),g,void 0,I().jf.Collection)),[r,g]),h=g[t],v=(0,i.useCallback)((e=>{R().createAndCommit({environment:p,userAction:"LayoutBuilder.propertiesConfiguration.toggleVisibility",canUndo:!0,perform:n=>{B().D7({property:t,visibility:e,store:r,format:f,transaction:n})}})}),[f,r,p,t]),y="show"===(null==n?void 0:n.visibility)?rt().eyeFillSmallIcon:"hide_if_empty"===(null==n?void 0:n.visibility)?ut().V:dt,b="show"===(null==n?void 0:n.visibility)||"hide_if_empty"===(null==n?void 0:n.visibility);if(!h)return null;return(0,le.jsx)(gt,{pageStore:l,collectionStore:r,propertyId:t,pagePropertiesStore:o,draggable:!0,rightButton:()=>(0,le.jsx)(Le().A,{popupType:ze().nl.Popup,renderOrigin:e=>(0,le.jsx)(m().A,{ariaLabel:c.formatMessage(ht.visibilityToggleIconAriaLabel,{propertyName:h.name}),icon:y,iconStyle:{width:lt().Ev.sm,height:lt().Ev.sm},colorVariant:b?"primary":"secondary",...e}),alignmentToOrigin:"start",render:e=>(0,le.jsx)(ft,{parentClose:e.close,setVisibilityOfProperty:v})}),searchHighlighted:d,layoutModule:e.layoutModule})}function ft(e){const{setVisibilityOfProperty:t,parentClose:n}=e,o=(0,i.useMemo)((()=>[{key:0,render:e=>(0,le.jsx)($().A,{...e}),items:[{key:"always_show",render:e=>(0,le.jsx)(G().A,{...e,icon:(0,le.jsx)(st().I,{icon:at().eyeFillIcon}),title:(0,le.jsx)(u().sA,{defaultMessage:"Always show",id:"ConfigurePropertiesPropertyRow.visibility.alwaysShow"})}),action:()=>{t("show"),n()}},{key:"hide_if_empty",render:e=>(0,le.jsx)(G().A,{...e,icon:(0,le.jsx)(st().I,{icon:ct().e}),title:(0,le.jsx)(u().sA,{defaultMessage:"Hide when empty",id:"ConfigurePropertiesPropertyRow.visibility.hide_when_empty"})}),action:()=>{t("hide_if_empty"),n()}},{key:"hide",render:e=>(0,le.jsx)(G().A,{...e,icon:dt({width:16,height:16}),title:(0,le.jsx)(u().sA,{defaultMessage:"Always hide",id:"ConfigurePropertiesPropertyRow.visibility.alwaysHide"})}),action:()=>{t("hide"),n()}}]}]),[n,t]);return(0,le.jsx)(Ue().A,{menuType:Ke().gu.Popup,children:(0,le.jsx)(Y().Ay,{type:Y().Oh.Vertical,initialFocus:0,sections:o})})}const ht=(0,u().YK)({visibilityToggleIconAriaLabel:{id:"pageLayout.configureProperties.visibilityToggleIconAriaLabel",defaultMessage:"Toggle the visibility {propertyName}"}}),vt=(0,u().YK)({filterPropertiesInputPlaceholder:{id:"layouts.configurePropertiesModule.filterProperties.input.placeholder",defaultMessage:"Search..."},notFound:{id:"layouts.configurePropertiesModule.filterProperties.input.notFound",defaultMessage:"Not found"},arrowButtonDownAriaLabel:{id:"layouts.configurePropertiesModule.filterProperties.input.arrowButtonDown.ariaLabel",defaultMessage:"Button to navigate to the next result"},arrowButtonUpAriaLabel:{id:"layouts.configurePropertiesModule.filterProperties.input.arrowButtonUp.ariaLabel",defaultMessage:"Button to navigate to the previous result"}});function yt(e){const{searchInputValueStore:t,activeSearchMatchIndex:n,searchMatches:o,moveToNextSearchMatch:s,moveToPreviousSearchMatch:l}=e,d=(0,a().O$)(t),c=(0,u().tz)(),p=i.useCallback((e=>{"Enter"===e.key?(e.preventDefault(),s()):"ArrowUp"===e.key?l():"ArrowDown"===e.key&&s()}),[s,l]),g=(0,r().IS)((e=>({searchMatchCount:{fontSize:".8rem",color:e.text.tertiary,userSelect:"none",cursor:"default",flexShrink:0,marginInlineEnd:4},searchMatchArrowButton:{padding:3,width:void 0,height:void 0,cursor:"pointer"},searchMatchArrowIcon:{width:12,height:12,color:e.icon.secondary,strokeWidth:.4,stroke:"currentcolor"},searchInputIcon:{fill:e.icon.secondary,width:10},searchInputOuter:{background:e.white}})),[]),f=i.useMemo((()=>{if(""!==d)return(0,le.jsxs)(y().Ye,{alignItems:"center",gap:8,children:[(0,le.jsx)("div",{children:null!==n?`${n+1} of ${o.length}`:c.formatMessage(vt.notFound)}),null!==n?(0,le.jsxs)(y().Ye,{gap:0,alignItems:"center",children:[(0,le.jsx)(m().A,{icon:_e().P,iconStyle:g.searchMatchArrowIcon,style:g.searchMatchArrowButton,ariaLabel:c.formatMessage(vt.arrowButtonDownAriaLabel),onClick:s}),(0,le.jsx)(m().A,{icon:Pe().q,iconStyle:g.searchMatchArrowIcon,style:g.searchMatchArrowButton,ariaLabel:c.formatMessage(vt.arrowButtonUpAriaLabel),onClick:l})]}):void 0]})}),[d,n,o.length,c,g,s,l]);return(0,le.jsx)(H().Ay,{focusInitial:!0,itemMarginLeft:0,itemMarginRight:0,onChange:e=>{t.setState(e.target.value.trim())},onKeyDown:p,placeholder:c.formatMessage(vt.filterPropertiesInputPlaceholder),showClearButton:!0,value:d,inputLeft:(0,q().q)(g.searchInputIcon),inputOuterStyle:g.searchInputOuter,inputRightStyle:g.searchMatchCount,inputRight:f})}function bt(e){const{module:t}=e,{layoutStore:n}=(0,X().LH)(),{collectionStore:o,pageStore:s}=(0,X().bi)(),d=(0,a().K8)((()=>n.getModules()),[n]),c=(0,a().K8)((()=>o.getSchema()),[o]),u=(0,a().K8)((()=>(0,C().L)(o.getFormat(),c,void 0,I().jf.Collection)),[o,c]),g=(0,i.useMemo)((()=>new Set((0,he().q)({modulesByArea:d,collectionSchema:c,collectionFormat:u}))),[u,d,c]),m=(0,i.useMemo)((()=>new(ye().YB)),[]),h=(0,a().K8)((()=>o.getNormalizedPropertyGroups()),[o]),v=(0,a().K8)((()=>{const e={};return null==h||h.forEach(((t,n)=>{e[t.id]=n})),e}),[h]),b=(0,ve().z7)({store:s,format:u,schema:c,collectionStore:o}),S=(0,i.useMemo)((()=>{const e={};return b.forEach((t=>e[t.property]=t)),e}),[b]),{searchInputValueStore:x,searchMatches:A,searchMatchesMap:M,activeSearchMatchIndex:w,moveToNextSearchMatch:j,moveToPreviousSearchMatch:k}=we({mergedPropertiesMap:S,propertyGroups:h,propertyIdsToExclude:g}),T=(0,i.useCallback)((({propertyId:e})=>{if(g.has(e))return null;const n=void 0!==M[e]&&null!==w?{active:e===A[w]}:void 0;return(0,le.jsx)(mt,{propertyId:e,propertyFormat:S[e],collectionStore:o,pagePropertiesStore:m,pageStore:s,searchHighlighted:n,layoutModule:t})}),[w,o,S,t,m,s,g,A,M]),_=(0,i.useCallback)((({groupId:e,groupTitle:t})=>{const n=v[e],i=0===n,o=(0,p().O9)(h)&&n===h.length-1,s={container:i?void 0:{marginTop:20}};return(0,le.jsx)(He,{title:t,propertyGroupId:e,isFirstPropertyGroup:i,isLastPropertyGroup:o,styles:s})}),[v,h]),P=(0,i.useCallback)((e=>(0,le.jsx)(Ie,{propertyGroupId:e,pagePropertiesStore:m})),[m]),B=Boolean(b.length&&b.length>g.size),D=(0,r().IS)((e=>({addPropertyButtonContainer:{marginInlineStart:2,paddingBottom:8},container:{marginTop:B?4:8,height:"100%",overflow:"visible hidden",marginInlineStart:-tn,width:`calc(100% + ${2*tn}px)`},searchInputContainer:{marginInlineEnd:tn,marginInlineStart:tn,flexShrink:0,paddingTop:2,overflow:"visible",marginBottom:14,paddingInlineStart:6,paddingInlineEnd:6},listContainer:{padding:`0 ${tn}px 56px`}})),[B]);return(0,le.jsxs)(y().wt,{style:D.container,children:[B?(0,le.jsx)("div",{style:D.searchInputContainer,children:(0,le.jsx)(yt,{searchInputValueStore:x,activeSearchMatchIndex:w,searchMatches:A,moveToNextSearchMatch:j,moveToPreviousSearchMatch:k})}):void 0,(0,le.jsx)(f().H,{type:l().A.Y,style:D.listContainer,children:Boolean(h)?(0,le.jsx)(ot,{renderPropertyRow:T,renderPropertyGroupRow:_,renderAddPropertyButton:P}):(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(it,{collectionFormat:u,mergedProperties:b,renderPropertyRow:T}),(0,le.jsx)("div",{style:D.addPropertyButtonContainer,children:(0,le.jsx)(Ie,{pagePropertiesStore:m})})]})})]})}var St=()=>n(621837),xt=()=>n(115512);const At=(0,u().YK)({addSection:{id:"NewCollectionPropertyGroupButton.label",defaultMessage:"Add section"},newSection:{id:"NewCollectionPropertyGroupButton.newItemName",defaultMessage:"New section"}});function Mt(){const{collectionStore:e}=(0,X().bi)(),t=(0,s().v3)(),n=(0,u().tz)(),o=(0,r().IS)((()=>({button:{fontSize:(0,xt().ny)(t,"UISmall"),padding:8,fontWeight:P().Wy.medium}})),[t]),a=(0,i.useCallback)((()=>{const i=n.formatMessage(At.newSection),{performResult:o}=R().createAndCommit({environment:t,perform:t=>(0,qe().PA)({collectionStore:e,newGroupTitle:i,transaction:t}),canUndo:!0,userAction:"ConfigurePropertyExplorerModule.onDrop"});o&&Ge.setState({forceOpenRenameInputForGroupId:o})}),[e,t,n]);return(0,le.jsx)(Ce().p,{colorPalette:"gray",iconLeading:{icon:St().plusFillSmallIcon,size:"xs"},onClick:a,style:o.button,children:(0,le.jsx)(u().sA,{...At.addSection})})}function wt(e){const{title:t}=e;return(0,le.jsxs)(y().Ye,{justifyContent:"space-between",children:[t,(0,le.jsx)(Mt,{})]})}var jt=()=>n(59400),kt=()=>n(147503),It=()=>n(447453),Ct=()=>n(527438);function Tt(e){return(0,le.jsx)("div",{style:{marginInlineStart:-8,marginInlineEnd:-8},children:e.children})}function _t({module:e}){const{collectionStore:t}=(0,X().bi)(),n=(0,W().ET)(),o=(0,a().K8)((()=>t.getSchema()),[t]),s=(0,a().K8)((()=>{if((0,re().gx)(e))return e}),[e]),r=(0,a().K8)((()=>s&&o[s.propertyId]),[s,o]);if((0,i.useEffect)((()=>{if(s)return(0,It().O)({collectionContextStore:n,collectionSettingsStore:n.settingsStore,closeOnEscape:!1}),kt().dP({collectionSettingsStore:n.settingsStore,item:{type:"property",property:s.propertyId,formatKey:void 0}}),()=>{kt().os({collectionSettingsStore:n.settingsStore})}}),[n,s]),!r||!s)return null;const l=(0,le.jsx)("span",{style:{fontSize:16,lineHeight:"24px",fontWeight:P().Wy.medium},children:Q().dC[r.type]});return(0,le.jsx)(Tt,{children:(0,le.jsx)(jt().m$,{collectionContextStore:n,collectionSettingsStore:n.settingsStore,context:Ct().Bd.ViewSettings,collectionSettingsPropertyTitleOverride:l,fullHeight:!0})})}var Pt=()=>n(487929);function Bt({module:e}){const{collectionStore:t,pageStore:n}=(0,X().bi)(),i=(0,r().IS)((e=>({configureContainer:{display:"flex",flexDirection:"column",justifyContent:"flex-start",gap:12,marginTop:16},configureDescription:{fontSize:P().J.UISmall.desktop,fontWeight:P().Wy.regular,color:e.text.secondary,marginInlineStart:8}})),[]);return(0,le.jsxs)("div",{style:i.configureContainer,children:[(0,le.jsx)("div",{style:i.configureDescription,children:(0,le.jsx)(u().sA,{defaultMessage:"Relations can be shown as either minimal or responsive page sections",id:"pageLayout.ConfigureRelationsGroupModule.moduleDescription"})}),(0,le.jsx)(Dt,{layoutModule:e,pageStore:n,collectionStore:t})]})}function Dt({collectionStore:e,pageStore:t,layoutModule:n}){const o=(0,s().v3)(),r=(0,i.useMemo)((()=>new(ye().YB)),[]),l=(0,a().K8)((()=>{const t=e.getSchema(),n=e.getFormat();return(0,Pt().T)({format:n,schema:t,visibilityLevels:["inline","minimal"]})}),[e]),d=l.map((e=>e.section)),c=(0,i.useCallback)((t=>{if(!l)return;const n=t.map((e=>{const t=l.find((t=>t.section===e));if(!t)throw Error("collection does not have a section corresponding to one of the dropped keys");return t}));R().createAndCommit({userAction:"ConfigureRelationsGroupModule.onDraggablePageSectionsDrop",environment:o,canUndo:!0,perform:t=>{B().LK({environment:o,pageSectionFormats:n,store:e,transaction:t})}})}),[l,e,o]);return l.length?(0,le.jsx)(Qe().Ay,{direction:"vertical",keys:d,renderKey:i=>(0,le.jsx)(gt,{pageStore:t,collectionStore:e,propertyId:i,pagePropertiesStore:r,layoutModule:n,draggable:!0}),onDrop:e=>c(e)}):null}var Rt=()=>n(230979),Et=()=>n(68207),Lt=()=>n(410730),Ot=()=>n(447934),Nt=()=>n(33218);function Ft(e){const{environment:t,layoutModule:n,collectionStore:i,layoutStore:o,propertyId:s}=e,a=i.getSchema(),r=o.getModel(),l=null==r?void 0:r.getPageModuleAreaById(n.id);if(!l||!r||"normalizedTitleWithIcon"!==n.type)return;const{pinnedPropertyIds:d}=function(e,t,n){let i,o=[...t??[]];return o.includes(e)?(o=o.filter((t=>t!==e)),i=!1):(o.push(e),o.length>Lt().U&&(o=(0,ae().Vl)(o,n)),i=!0),{isNowPinned:i,pinnedPropertyIds:o}}(s,n.propertyIds,a),c={...n,propertyIds:d};R().createAndCommit({environment:t,perform(e){(0,Ot().HD)({environment:t,transaction:e,property:s,layoutStore:o}),(0,Nt().UQ)({environment:t,transaction:e,layoutStore:o,position:{area:l,moduleId:n.id},updatedModule:c})},canUndo:!0,userAction:"titleWithIconActions.togglePinnedProperty"})}var Ut=()=>n(557198);function zt({module:e}){const{collectionStore:t,pageStore:n}=(0,X().bi)(),o=(0,s().v3)(),{layoutStore:l}=(0,X().LH)(),d=(0,a().K8)((()=>t.getSchema()),[t]),c=(0,a().K8)((()=>(0,C().L)(t.getFormat(),d,void 0,I().jf.Collection)),[t,d]),g=(0,i.useMemo)((()=>new(ye().YB)),[]),m=(0,i.useMemo)((()=>"normalizedTitleWithIcon"!==e.type?[]:(0,ae().Vl)(e.propertyIds,d)),[e,d]),f=(0,i.useMemo)((()=>new Set(m)),[m]),h=(0,a().K8)((()=>{var e;return null===(e=c.property_visibility||[])||void 0===e?void 0:e.map((e=>e.property)).filter((e=>!(0,K().NM)(e)&&!f.has(e)))}),[c.property_visibility,f]),b=(0,a().K8)((()=>(0,p().uv)(d)),[d]),S=(0,ve().z7)({store:n,format:c,schema:d,collectionStore:t,propertyIds:b}),x=(0,i.useMemo)((()=>{const e={};for(const t of S)e[t.property]=t;return e}),[S]),{searchInputValueStore:A,searchMatches:M,activeSearchMatchIndex:w,moveToNextSearchMatch:j,moveToPreviousSearchMatch:k,searchMatchesMap:T}=we({mergedPropertiesMap:x,propertyGroups:void 0,propertyIdsToExclude:void 0}),_=function(e){const t=(0,s().v3)(),{layoutStore:n}=(0,X().LH)();return(0,i.useCallback)((i=>{const o=n.getModel(),s=null==o?void 0:o.getPageModuleAreaById(e.id);if(!s||!o)return;const a={...e,propertyIds:i};R().createAndCommit({environment:t,perform(i){(0,Nt().UQ)({environment:t,transaction:i,layoutStore:n,position:{area:s,moduleId:e.id},updatedModule:a})},canUndo:!0,userAction:"ConfigureTitleAndIconModule.handlePinnedPropertyReorderDrop"})}),[t,e,n])}(e),B=(0,r().IS)((e=>{const t={fontSize:P().J.UISmall.desktop,lineHeight:"24px",color:e.text.secondary,fontWeight:500};return{container:{height:"100%",overflow:"visible hidden",gap:14,marginInlineStart:-tn,width:`calc(100% + ${2*tn}px)`},propertySearchInputContainer:{flexShrink:0,margin:`10px ${tn+6}px 0`},scrollableContainer:{padding:`0 ${tn}px 56px`,flexGrow:1,overflow:"hidden auto"},pinnedPropertiesLabel:{...t,marginInlineStart:8},optionsContainer:{marginTop:24},optionsLabel:{...t,marginInlineStart:6,marginBottom:6},switcherButton:{marginInlineEnd:0},addPropertyButton:{color:e.text.secondary,height:34},addPropertyButtonIcon:{color:e.text.secondary}}}),[]),D=m.length?(0,le.jsx)(Qe().Ay,{keys:m,onDrop:_,direction:"vertical",renderKey:t=>(0,le.jsx)(Vt,{layoutModule:e,propertyId:t,isPinned:!0,draggable:!0,pinButtonDisabled:!1,pagePropertiesStore:g,searchHighlighted:null!==w&&void 0!==T[t]?{active:t===M[w]}:void 0})}):null,E=m.length>=Lt().U,N=h.map((t=>(0,le.jsx)(Vt,{layoutModule:e,propertyId:t,isPinned:!1,draggable:!1,pinButtonDisabled:E,pagePropertiesStore:g,searchHighlighted:null!==w&&void 0!==T[t]?{active:t===M[w]}:void 0},t))),U=Kt(e),z=(e={})=>(0,le.jsx)(je().Xt,{...e,style:B.addPropertyButton,iconStyle:B.addPropertyButtonIcon,collectionStore:t,isInPeekRenderer:!1,pagePropertiesStore:g,onPropertyAdded:U,disabled:E}),{backlinksVisibility:V,updateBacklinksVisibility:q}=(0,Ut().Ap)({store:t,format:c}),W=(0,u().tz)(),G=(0,i.useCallback)((()=>{const t="show"===e.propertyLabels||!e.propertyLabels;R().createAndCommit({environment:o,perform(n){var i;const s=null===(i=l.getModel())||void 0===i?void 0:i.getPageModuleAreaById(e.id);s&&(0,Nt().UQ)({environment:o,transaction:n,layoutStore:l,position:{area:s,moduleId:e.id},updatedModule:{...e,propertyLabels:t?"hide":"show"}})},canUndo:!0,userAction:"ConfigureTitleAndIconModule.handleShowPropertyLabels"})}),[e,o,l]),H=(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)("div",{style:{...B.pinnedPropertiesLabel},children:(0,le.jsx)(u().sA,{...qt.pinnedPropertiesLabel})}),D,(0,le.jsx)("div",{style:{marginInlineStart:2},children:E?(0,le.jsx)(v().A,{placement:"left",render:e=>z(e),renderTooltip:()=>W.formatMessage(qt.maxPinnedPropertiesAddPropertyTooltip,{br:(0,le.jsx)("br",{})})}):z()}),N.length>0?(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)("div",{style:{...B.pinnedPropertiesLabel,marginTop:24},children:(0,le.jsx)(u().sA,{...qt.unpinnedPropertiesLabel})}),N]}):void 0]});return(0,le.jsxs)(y().wt,{style:B.container,children:[(0,le.jsx)("div",{style:B.propertySearchInputContainer,children:(0,le.jsx)(yt,{activeSearchMatchIndex:w,searchMatches:M,moveToNextSearchMatch:j,moveToPreviousSearchMatch:k,searchInputValueStore:A})}),(0,le.jsxs)("div",{style:B.scrollableContainer,children:[H,(0,le.jsxs)("div",{style:B.optionsContainer,children:[(0,le.jsx)("div",{style:B.optionsLabel,children:(0,le.jsx)(u().sA,{...qt.optionsLabel})}),(0,le.jsx)(L().Ay,{title:(0,le.jsx)(u().sA,{id:"PageLayoutConfigurationSidebar.showPropertyLabels",defaultMessage:"Property labels"}),onClick:G,right:(0,le.jsx)(O().A,{on:"show"===e.propertyLabels||void 0===e.propertyLabels}),rightStyle:B.switcherButton}),(0,le.jsx)(L().Ay,{right:(0,le.jsx)(F().p7,{currentVisibility:V,onSelect:q}),rightStyle:B.switcherButton,title:(0,le.jsx)(u().sA,{...qt.showBacklinksOption})})]})]})]})}function Kt(e){const{layoutStore:t}=(0,X().LH)(),{collectionStore:n}=(0,X().bi)(),o=(0,s().v3)();return(0,i.useCallback)((i=>{Ft({environment:o,layoutModule:e,collectionStore:n,layoutStore:t,propertyId:i})}),[o,e,n,t])}function Vt({layoutModule:e,propertyId:t,isPinned:n,pinButtonDisabled:i,...o}){const s=(0,u().tz)(),l=(0,r().DP)(),{collectionStore:d,pageStore:c}=(0,X().bi)(),p=(0,a().K8)((()=>d.getSchema()),[d])[t],g=Kt(e);if(!p)return null;const f=(e={})=>(0,le.jsx)(m().A,{...e,disabled:i,ariaLabel:n?s.formatMessage(qt.toggleUnpinnedAriaLabel,{propertyName:p.name}):s.formatMessage(qt.togglePinnedAriaLabel,{propertyName:p.name}),icon:n?Et().S:Rt().N,iconStyle:{fill:l.icon.primary},onClick:()=>g(t)});return(0,le.jsx)(gt,{pageStore:c,collectionStore:d,propertyId:t,layoutModule:e,rightButton:()=>i?(0,le.jsx)(v().A,{placement:"left",render:e=>f(e),renderTooltip:()=>s.formatMessage(qt.maxPinnedPropertiesTooltip,{br:(0,le.jsx)("br",{})})}):f(),...o})}const qt=(0,u().YK)({togglePinnedAriaLabel:{id:"pageLayout.configurePinnedProperties.togglePinnedAriaLabel",defaultMessage:"Show {propertyName} as pinned"},toggleUnpinnedAriaLabel:{id:"pageLayout.configurePinnedProperties.toggleUnpinnedAriaLabel",defaultMessage:"Do not show {propertyName} as pinned"},pinnedPropertiesLabel:{id:"pageLayout.configurePinnedProperties.pinnedPropertiesLabel",defaultMessage:"Pinned properties"},unpinnedPropertiesLabel:{id:"pageLayout.configurePinnedProperties.unpinnedPropertiesLabel",defaultMessage:"Unpinned properties"},maxPinnedPropertiesTooltip:{id:"pageLayout.configurePinnedProperties.maxPinnedPropertiesTooltip",defaultMessage:"Maximum number of pinned properties reached. {br} Unpin a property to pin another."},maxPinnedPropertiesAddPropertyTooltip:{id:"pageLayout.configurePinnedProperties.maxPinnedPropertiesAddPropertyTooltip",defaultMessage:"Maximum number of pinned properties reached. {br} Unpin a property to create a new pinned property."},optionsLabel:{id:"pageLayout.configurePinnedProperties.optionsLabel",defaultMessage:"Options"},showBacklinksOption:{id:"pageLayout.configurePinnedProperties.showBacklinksOption",defaultMessage:"Backlinks"}});var Wt=()=>n(180762);const Gt=i.memo((function({module:e}){const{moduleStateByIdStore:t}=(0,X().bi)(),i=(0,a().K8)((()=>{var n;return null===(n=t.get(e.id))||void 0===n?void 0:n.collectionContextStore}),[t,e.id]),o=(0,a().K8)((()=>{var e;return null==i||null===(e=i.collectionViewStore())||void 0===e?void 0:e.id}),[i]),s=(0,a().K8)((()=>null==i?void 0:i.settingsStore),[i]),l=(0,r().IS)((()=>({titleWrapper:{...Zt,marginBottom:6,display:"flex"},viewsContainer:{marginTop:8,width:"100%",display:"flex",flexDirection:"column"}})),[]),d=(0,a().K8)((()=>{var e;return null==i||null===(e=i.settingsStore)||void 0===e?void 0:e.getState().open}),[i]);return"viewsMain"===e.type&&i&&s&&d?(0,le.jsx)(Tt,{children:(0,le.jsx)(W().p2.Provider,{value:i,children:(0,le.jsx)(jt().m$,{collectionContextStore:i,collectionSettingsStore:s,context:Ct().Bd.ViewSettings})})}):(0,le.jsxs)("div",{children:[(0,le.jsx)("div",{style:l.titleWrapper,children:(0,le.jsx)(u().sA,{...fe().s.viewsMain})}),(0,le.jsxs)("div",{style:l.viewsContainer,children:[(0,le.jsx)(Ht,{collectionContextStore:i,currentViewId:o,module:e}),"viewsMain"===e.type?(0,le.jsx)(n(965731).ConfigureViewsMainModuleAddViewButton,{renderOrigin:e=>(0,le.jsx)(Ce().p,{iconLeading:n(689094).W,colorPalette:"gray",...e,children:(0,le.jsx)(u().sA,{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView"})})}):void 0]})]})}));function Ht({collectionContextStore:e,currentViewId:t,module:i}){const o=(0,s().v3)(),r=(0,a().K8)((()=>{if(!e)return[];const t=e.collectionViewBlockStore(),n=null==t?void 0:t.getCollectionViewStores();return null==n?void 0:n.map((e=>{var t;return{id:e.id,icon:null===(t=e.getFormat())||void 0===t?void 0:t.collection_view_icon,type:e.getType(),name:e.getName(),pointer:e.pointer}}))}),[e]);return"editor"===i.type?(0,le.jsx)(Ce().p,{children:(0,le.jsx)("div",{style:{fontWeight:600},children:(0,le.jsx)(u().sA,{...fe().s.editor})})},"editor"):r&&e?(0,le.jsx)(le.Fragment,{children:r.map((i=>(0,le.jsxs)(Ce().p,{onClick:()=>{(0,Wt().t)({environment:o,collectionContextStore:e,collectionViewId:i.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1}),(0,It().O)({collectionContextStore:e,collectionSettingsStore:e.settingsStore})},children:[(0,le.jsx)(n(745266).h,{viewIcon:i.icon,viewType:i.type,color:"regular",style:{width:14,height:14,marginInlineEnd:6}}),(0,le.jsx)("div",{style:{fontWeight:i.id===t?600:void 0},children:void 0!==i.type?(0,n(177618).OO)({collectionViewName:i.name,collectionViewType:i.type}):(0,le.jsx)(u().sA,{...Yt.newView})})]},i.id)))}):null}const Yt=(0,u().YK)({newView:{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView"}});function $t({module:e}){const{moduleStateByIdStore:t}=(0,X().bi)(),n=(0,a().K8)((()=>{var n;return null===(n=t.get(e.id))||void 0===n?void 0:n.collectionContextStore}),[t,e.id]),i=(0,a().K8)((()=>null==n?void 0:n.settingsStore),[n]);return e&&n&&i?(0,le.jsx)(Tt,{children:(0,le.jsx)(W().p2.Provider,{value:n,children:(0,le.jsx)(jt().m$,{collectionContextStore:n,collectionSettingsStore:i,context:Ct().Bd.ViewSettings})})}):null}function Qt({moduleId:e}){const{layoutStore:t}=(0,X().LH)(),n=(0,a().K8)((()=>t.getModuleById(e)),[t,e]),i=(0,r().IS)((()=>({container:{display:"flex",flexDirection:"column",..."properties"!==(null==n?void 0:n.type)&&"normalizedTitleWithIcon"!==(null==n?void 0:n.type)?{paddingBottom:80}:{height:"100%"}}})),[null==n?void 0:n.type]);return n?(0,le.jsxs)("div",{style:i.container,children:[(o=n,"viewsMain"===o.type||"editor"===o.type||(0,re().gx)(o)?void 0:(0,le.jsx)(Jt,{module:n})),(0,le.jsx)(Xt,{module:n})]}):null;var o}const Zt={fontWeight:P().Wy.medium,marginBottom:0,marginInlineStart:6,fontSize:16,lineHeight:"24px"};function Jt(e){const{module:t}=e,n=(0,le.jsx)("div",{style:Zt,children:(0,le.jsx)(u().sA,{...fe().s[t.type]})});return"properties"===t.type?(0,le.jsx)(wt,{title:n}):n}function Xt(e){const{module:t}=e;if((0,re().gx)(t))return(0,le.jsx)(_t,{module:t});const{type:n}=t;switch(n){case"properties":return(0,le.jsx)(bt,{module:t});case"normalizedTitleWithIcon":return(0,le.jsx)(zt,{module:t});case"relationsGroup":return(0,le.jsx)(Bt,{module:t});case"views":return(0,le.jsx)($t,{module:t});case"viewsMain":case"editor":return(0,le.jsx)(Gt,{module:t});case"deleted_property":case"cover":case"inlinePageSections":case"expandedBacklinks":case"discussions":case"bottomControls":case"transcript":case"formQuestion":case"formTitle":case"formSubmit":case"placeholder":case"recentActivity":case"collaborators":case"teamspaces":case"row":case"view":return null;default:(0,p().HB)(n)}return null}const en=290,tn=16;function nn(){const{currentModuleSelection:e,layoutStore:t,sessionId:n}=(0,X().LH)(),{collectionStore:i,pageStore:o}=(0,X().bi)(),s=(0,a().K8)((()=>{const e=i.getFormat(),t=i.getSchema();return(0,C().L)(e,t,void 0,I().jf.Collection)}),[i]),d=(0,r().IS)((t=>({container:{padding:`8px ${tn}px ${"existing_module"===(null==e?void 0:e.type)?"0":"24px"}`,minWidth:en,width:en,maxWidth:en},title:{fontSize:16,lineHeight:"24px",fontWeight:P().Wy.medium,marginTop:0,marginInlineEnd:8,marginBottom:0,marginInlineStart:8},label:{fontSize:P().J.UISmall.desktop,fontWeight:P().Wy.medium,marginTop:24,marginInlineEnd:8,marginBottom:6,marginInlineStart:8,color:t.text.secondary},switcherButton:{marginInlineEnd:0}})),[e]),c=(0,a().K8)((()=>Boolean(i.getFormat().external_object_id)),[i]),p=(0,j().X)("bottom_page_discussions_enabled"),g=e&&"existing_module"===e.type&&_().PF.includes(e.moduleId);return!e||p&&g?(0,le.jsxs)("div",{style:d.container,children:[(0,le.jsx)("div",{style:d.title,children:(0,le.jsx)(u().sA,{id:"PageLayoutConfigurationSidebar.title",defaultMessage:"Page settings"})}),(0,le.jsx)(on,{collectionStore:i,layoutStore:t,sessionId:n,styles:d}),(0,le.jsx)("div",{style:d.label,children:(0,le.jsx)(u().sA,{id:"PageLayoutConfigurationSidebar.options",defaultMessage:"Options"})}),(0,le.jsx)(sn,{disabled:c,collectionStore:i,normalizedCollectionFormat:s,styles:d}),(0,le.jsx)(N().q8,{locked:c,store:i,format:s,shouldShowIconAndMargin:!1}),(0,le.jsx)(an,{layoutStore:t,styles:d}),(0,le.jsx)(rn,{pageStore:o,layoutStore:t,styles:d})]}):(0,le.jsxs)(f().H,{type:l().A.Y,style:d.container,children:["existing_module"===e.type?(0,le.jsx)(Qt,{moduleId:e.moduleId}):void 0,"new_module"===e.type?(0,le.jsx)(me,{}):void 0]})}function on(e){const{collectionStore:t,layoutStore:n,sessionId:o,styles:r}=e,l=(0,s().v3)(),d=(0,a().K8)((()=>n.isTabbedPageLayout()),[n]),{value:c}=(0,U().fJ)(z.switchFromSimpleToTabbedLayoutActions),{value:g}=(0,U().fJ)(z.switchFromTabbedToSimpleLayoutActions),m=!c||!g,f=d?"tabbed":"simple",h=(0,i.useMemo)((()=>({available:["simple","tabbed"],appearance:{simple:{label:(0,le.jsx)(u().sA,{id:"PageLayoutConfigurationSidebar.structure.simple",defaultMessage:"Simple"}),image:{src:k().A.images.layouts.configuration.simplePageLayoutStructurePng,width:112,height:80}},tabbed:{label:(0,le.jsx)(u().sA,{id:"PageLayoutConfigurationSidebar.structure.tabbed",defaultMessage:"Tabbed"}),image:{src:k().A.images.layouts.configuration.tabbedPageLayoutStructurePng,width:112,height:80}}}})),[]),v=(0,i.useCallback)((async e=>{c&&g&&("simple"===e?g.switchFromTabbedToSimpleLayout({environment:l,layoutStore:n}):"tabbed"===e?await c.switchFromSimpleToTabbedLayout({environment:l,layoutStore:n}):(0,p().HB)(e),(0,S().GF)({environment:l,layoutId:n.id,collectionId:t.id,sessionId:o,structure:e}))}),[c,g,l,n,t.id,o]);return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)("div",{style:r.label,children:(0,le.jsx)(u().sA,{id:"PageLayoutConfigurationSidebar.structure",defaultMessage:"Structure"})}),(0,le.jsx)(E().A,{disabled:m,options:h,selectedOption:f,onOptionSelected:v,height:"tall"})]})}function sn(e){var t;const n=(0,s().v3)(),{disabled:o,collectionStore:a,normalizedCollectionFormat:r,styles:l}=e,d="minimal"===(null===(t=r.page_section_visibility)||void 0===t?void 0:t.margin_comments)?"minimal":"inline",c=(0,i.useCallback)((e=>{const t=a.getFormat(),i=a.getSchema(),o=(0,C().L)(t,i,void 0,I().jf.Collection);B().OD({environment:n,pageSection:"margin_comments",visibility:e,store:a,format:o})}),[a,n]);return(0,le.jsx)(L().Ay,{title:(0,le.jsx)(u().sA,{id:"PageLayoutConfigurationSidebar.inlineComments",defaultMessage:"Inline comments"}),right:(0,le.jsx)(F().J8,{disabled:o,currentVisibility:d,onSelect:c}),rightStyle:l.switcherButton})}function an(e){const{layoutStore:t,styles:n}=e,o=(0,s().v3)(),r=(0,a().K8)((()=>{var e;return"show"===((null===(e=t.getFormat())||void 0===e?void 0:e.property_icons_visibility)??"show")}),[t]),l=(0,i.useCallback)((()=>{R().createAndCommit({environment:o,userAction:"pageLayoutActions.handleShowPropertyIcons",canUndo:!0,perform:e=>{var n;D().zA({stores:[t],update:{property_icons_visibility:"hide"===(null===(n=t.getFormat())||void 0===n?void 0:n.property_icons_visibility)?"show":"hide"},transaction:e})}})}),[t,o]);return(0,le.jsx)(L().Ay,{title:(0,le.jsx)("label",{htmlFor:"show-property-icons-toggle",style:{cursor:"pointer"},children:(0,le.jsx)(u().sA,{id:"PageLayoutConfigurationSidebar.showPropertyIcons",defaultMessage:"Property icons"})}),right:(0,le.jsx)(O().A,{on:r,onClick:l,inputId:"show-property-icons-toggle"}),rightStyle:n.switcherButton})}function rn(e){const{pageStore:t,layoutStore:n,styles:o}=e,l=(0,s().v3)(),d=(0,a().K8)((()=>{var e;return null===(e=n.getFormat())||void 0===e?void 0:e.page_full_width}),[n]),c=(0,i.useCallback)((()=>{R().createAndCommit({environment:l,userAction:"pageLayoutActions.handleShowFullWidth",canUndo:!0,perform:e=>{var i;const o=!(null!==(i=n.getFormat())&&void 0!==i&&i.page_full_width);D().zA({stores:[n],update:{page_full_width:o},transaction:e}),void 0!==t.getFormatStore().getKeyValue("page_full_width")&&D().zA({stores:[t],update:{page_full_width:void 0},transaction:e})}})}),[n,l,t]),p=(0,r().IS)((e=>({icon:{height:14,width:14,color:e.icon.secondary},title:{display:"flex",alignItems:"center",gap:"4px",cursor:"pointer"},tooltip:{maxWidth:240,width:"max-content",overflowWrap:"break-word",textWrap:"wrap"}})),[]);return(0,le.jsx)(L().Ay,{title:(0,le.jsxs)("label",{style:p.title,htmlFor:"page-full-width-toggle",children:[(0,le.jsx)(u().sA,{id:"PageLayoutConfigurationSidebar.showFullWidth",defaultMessage:"Full width"}),(0,le.jsx)(v().A,{placement:"bottom",renderTooltip:()=>(0,le.jsx)(u().sA,{id:"PageLayoutConfigurationSidebar.showFullWidth.tooltip",defaultMessage:"Page width can be overwritten on individual pages."}),render:e=>(0,le.jsx)("div",{...e,children:(0,T().G)(p.icon)}),style:p.tooltip})]}),right:(0,le.jsx)(O().A,{on:Boolean(d),onClick:c,inputId:"page-full-width-toggle"}),rightStyle:o.switcherButton})}var ln=()=>n(761660),dn=()=>n(607810),cn=()=>n(817942),un=()=>n(852832),pn=()=>n(475140),gn=()=>n(179034),mn=()=>n(507807),fn=()=>n(148832);var hn=()=>n(792071),vn=()=>n(763824),yn=()=>n(414360);async function bn(e){const{environment:t,layoutStore:n,blockPointer:i}=e,o=fn().B.createChildStore(n,i);if(await o.load(),!o.isCollectionView())return;const s=o.getCollectionViewStores();await(0,vn().lX)(s,25,(e=>e.load()));const a=s.filter((e=>"page"===e.getType()));if(a.length<=1)return;const r=n.getModules(),l=(0,pn().JO)(r,re().gp);if(!l||"views_main_tab_modules"!==l.area)return;const d=l.viewId,c=a.find((e=>{var t;const n=null===(t=e.getFormat())||void 0===t?void 0:t.page_layout_pointer;return!!n&&n.views_main_tab_id===d}));if(!c)return;const u=a.filter((e=>e!==c));0!==u.length&&R().createAndCommit({environment:t,userAction:"cleanupDuplicateContentTabsInTabbedCollectionViewBlock",canUndo:!1,perform:e=>{for(const s of u){var t,i;const a=null===(t=s.getFormat())||void 0===t||null===(t=t.page_layout_pointer)||void 0===t?void 0:t.views_main_tab_id;if((0,yn().T)({collectionViewBlockStore:o,collectionViewStore:s,transaction:e}),!a)continue;const r=(null===(i=n.getRawModules())||void 0===i||null===(i=i.views_main_tab_modules)||void 0===i?void 0:i[a])||[];for(const t of r.reverse())R().applyOperation({store:n,transaction:e,operation:hn().N4X.putModuleBeforeOrAfter({pointer:n.pointer,area:"views_main_tab_modules",viewId:d,module:t,direction:"before",beforeOrAfterId:void 0})});R().applyOperation({store:n,transaction:e,operation:hn().N4X.deleteViewTabModulesTab({pointer:n.pointer,viewId:a})})}}})}async function Sn(e){const{environment:t,layoutStore:i}=e;await async function(e){const{environment:t,layoutStore:n}=e;if(!n.isTabbedPageLayout())return;const i=n.getBlockChildrenPointers();for(const s of i){var o;null!==(o=n.getModel())&&void 0!==o&&o.isTabbedLayoutCollectionViewBlockPointer(s)&&await bn({environment:t,layoutStore:n,blockPointer:s})}}({environment:t,layoutStore:i}),(0,n(210748).O)({environment:t,layoutStore:i})}const xn=i.memo((function({children:e,collectionStore:t,pageStore:o,sessionId:r,layoutBuilderModuleSelectionStore:l}){const d=(0,s().v3)(),c=(0,a().K8)((()=>{var e;return null===(e=n(765957).default.state.currentUserStore)||void 0===e?void 0:e.userId}),[]),u=(0,a().K8)((()=>t.getSpaceId()),[t]),g=(0,i.useMemo)((()=>(null==o?void 0:o.id)??(0,n(594794).Z1)({environment:d,table:gn().ev,spaceId:u})),[d,null==o?void 0:o.id,u]),m=(0,i.useCallback)((e=>{var t;if(e.operation.pointer.id===g)return!1;if((null===(t=e.operation)||void 0===t||null===(t=t.args)||void 0===t?void 0:t.parent_id)===g)throw new Error("Unexpected operation on temporary page.");return!0}),[g]),f=(0,mn().S)(n(342).oB,{canUndo:!1,shouldPersistOperation:o?void 0:m}),h=(0,a().K8)((()=>{if(o)return o.clone(f.cache);return R().createAndCommit({environment:d,perform(e){const i=n(384944).Wv({environment:d,type:"page",id:g,inMemoryRecordCache:f.cache,transaction:e});return R().applyOperation({store:i,operation:n(134025).op.update({pointer:{id:i.pointer.id,table:gn().ev,spaceId:i.pointer.spaceId},path:[],args:{parent_id:t.id,parent_table:t.table,alive:!0}}),transaction:e}),i},userAction:"PageLayoutEditorContext.createEmptyPageStore",canUndo:!1}).performResult}),[t,f.cache,d,o,g]),v=function(e,t){const o=(0,s().v3)(),r=(0,i.useMemo)((()=>new(n(688742).B)(o)),[o]),l=(0,mn().f)(e,t),d=(0,a().K8)((()=>null==t?void 0:t.getParentBlockStore()),[t]);return(0,i.useEffect)((()=>{r.setContext({type:"collectionPage",collectionViewBlockStore:d,collectionStore:l})}),[r,l,d]),r}(f,t),{unpersistedCollectionStore:y,unpersistedLayoutStore:b,modulesByArea:S}=(0,a().K8)((()=>{const e=v.collectionStore(),t=null==e?void 0:e.getLayoutStore();return{unpersistedCollectionStore:e,unpersistedLayoutStore:t,modulesByArea:null==t?void 0:t.getModules()}}),[v]),[x,A]=(0,i.useState)(void 0);(0,n(543906).A)((()=>{A((0,Ee().mg)(S))}),Boolean(S));const M=(0,a().uB)(void 0,n(731120).A),w=i.useRef(!1);(0,a().K8)((()=>!(!c||!y||b&&(!b.isReady()||b.isDefined()))&&(R().createAndCommit({environment:d,perform:e=>Ot().$L({environment:d,transaction:e,collectionStore:y,userId:c}),userAction:"PageLayoutEditorContext.initCollectionLayout",canUndo:!1}),w.current=!0,!0)),[d,y,b,c]);const j=(0,i.useCallback)((async()=>{if(c&&b)return await Sn({environment:d,layoutStore:b}),f.persist("PageLayoutEditorContext.updateLayout")}),[f,d,b,c]),k=(0,i.useCallback)((()=>{f.reset();const e=t.getLayoutStore();return!!e&&(R().createAndCommit({environment:d,perform(n){Nt().gL({environment:d,transaction:n,layoutStore:e,collectionStore:t})},userAction:"PageLayoutEditorContext.resetLayoutToDefault",canUndo:!1}),!0)}),[t,f,d]),I=(0,a().K8)((()=>l.getState()),[l]),C=(0,a().K8)((()=>h.isReady()&&(null==b?void 0:b.isReady())),[b,h]),[T,_]=(0,i.useState)([]),P=(0,i.useMemo)((()=>new(n(265515).G)),[]),B=(0,i.useCallback)((e=>{if(l.setState(e),b&&e&&"existing_module"===e.type&&e.moduleId){const t=null==b?void 0:b.getModules();if(!t)return;const n=(0,pn().EX)(t,(t=>t.id===e.moduleId));n&&"views_main_tab_modules"===n.position.area&&function(e){var t;const{layoutStore:n,tabToFocus:i,moduleStateByIdStore:o,environment:s}=e,a=n.pointer,r=n.getModules(),l=(0,pn().EX)(r,(e=>"viewsMain"===e.type));if(!l||!(0,re().y6)(l.module))return;const{module:d}=l,c=null==o||null===(t=o.get(d.id))||void 0===t?void 0:t.collectionContextStore;if(!c)return;const u=fn().B.createChildStore(n,d.collection_view_block_pointer).getCollectionViewStores();let g;"viewId"===(null==i?void 0:i.type)?g=null==u?void 0:u.find((e=>{var t;return(null===(t=e.getFormat().page_layout_pointer)||void 0===t?void 0:t.views_main_tab_id)===i.viewId})):"contentTab"===(null==i?void 0:i.type)?g=null==u?void 0:u.find((e=>{var t;return"page"===e.getType()&&(null===(t=e.getFormat().page_layout_pointer)||void 0===t?void 0:t.id)===a.id})):(0,p().HB)(i),g&&(0,Wt().t)({environment:s,collectionContextStore:c,collectionViewId:g.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1})}({tabToFocus:{type:"contentTab"},layoutStore:b,moduleStateByIdStore:P,environment:d})}}),[d,l,P,b]),D=be().Store.createValue(!1),E=(0,i.useMemo)((()=>b&&{layoutStore:b,collectionStore:y,currentModuleSelection:I,setModuleSelection:B,sessionId:r,addModuleHoverMenuStore:M,canEditLayout:!0,isPropertyTypeSearchInputDirtyStore:D,layoutBuilderModuleSelectionStore:l}),[b,y,I,B,r,M,D,l]),L=(0,i.useMemo)((()=>y&&{pageStore:h,hasUnsavedChanges:f.hasChanges,saveChanges:j,moduleIdsMovedFromSidebar:T,setModuleIdsMovedFromSidebar:_,isNewLayout:w.current,initialLayoutModulesByArea:x,resetLayoutToDefault:k,moduleStateByIdStore:P,collectionContextStore:v,collectionStore:y}),[y,h,f.hasChanges,j,T,x,k,P,v]);return C&&b&&E&&L?(0,le.jsx)(W().RI,{value:v,children:(0,le.jsx)(X().Op.Provider,{value:E,children:(0,le.jsxs)(X().sf.Provider,{value:L,children:[(0,un().isConsoleEnabled)()?(0,le.jsx)(An,{}):void 0,e]})})}):null}));function An(){return(0,i.useEffect)((()=>()=>{(0,un().exposeDebugValue)("baseLayoutEditorContext",void 0),(0,un().exposeDebugValue)("pageLayoutEditorContext",void 0)}),[]),(0,un().exposeDebugValue)("baseLayoutEditorContext",(0,X().LH)()),(0,un().exposeDebugValue)("pageLayoutEditorContext",(0,X().bi)()),null}var Mn=n.n(n(32485)),wn=()=>n(75435),jn=()=>n(995847),kn=()=>n(175947),In=()=>n(187820),Cn=()=>n(16006),Tn=()=>n(38337),_n=()=>n(615244),Pn=()=>n(98126),Bn=()=>n(668725),Dn=()=>n(245241),Rn=()=>n(64e3),En=()=>n(305390),Ln=()=>n(553965),On=()=>n(135599);function Nn({collectionStore:e}){const t=(0,i.useRef)(null),[n,o]=i.useState(""),{pageStore:s}=(0,X().bi)(),{results:r,isResultsLoading:l}=(0,On().W)({query:n,type:Dn().Vz.BlocksInCollection,source:"layout_builder_page_selector",limit:10,collectionId:e.id,options:{disable:!1},peopleBlocksToInclude:"none"}),d=(0,a().K8)((()=>l?[{key:"loading",action:()=>{},render:e=>(0,le.jsx)(Rn().A,{...e,title:(0,le.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,le.jsx)(Pn().k,{})})})}]:0===r.length?[{key:"no_results",action:()=>{},render:e=>(0,le.jsx)(Rn().A,{...e,title:(0,le.jsx)(u().sA,{id:"pageLayoutEditor.pagePicker.noResults",defaultMessage:"No results."})})}]:r.map((e=>{const t=(null==s?void 0:s.id)===e.id;return{key:e.id,render:n=>(0,le.jsx)(En().A,{...n,store:e.store,hidePath:!0,isChecked:t}),action:()=>{if(t)return;if(!w().g.state.isOpen||"layout-editor"!==w().g.state.mode)throw new Error("Expected page layout editor to be open.");const n={isOpen:w().g.state.isOpen,mode:"layout-editor",pageStore:e.store,sessionId:w().g.state.sessionId,collectionStore:w().g.state.collectionStore};w().g.setState(n)}}}))),[null==s?void 0:s.id,l,r]),c=(0,le.jsx)($().A,{isInput:!0,style:{paddingBottom:0},desktopTitleStyle:{paddingBottom:0,marginBottom:0},children:(0,le.jsx)(H().Ay,{ref:t,value:n,placeholder:b().A.formatMessage(Un.searchPlaceholder),focusAfterAnimation:!0,showClearButton:!0,style:{marginBottom:10},onChange:e=>{o(e.target.value)},focusInitial:r.length>0||void 0})}),p=(0,le.jsx)(Ue().A,{menuType:Ke().gu.Popup,header:c,width:300,children:(0,le.jsx)(Y().Ay,{type:Y().Oh.Vertical,style:{marginBottom:0},sections:[{key:"results",items:d,render:e=>(0,le.jsx)($().A,{...e})}],initialFocus:r.length>0?0:void 0})});return(0,le.jsx)(Le().A,{popupType:Le().z.Popup,renderOrigin:e=>(0,le.jsx)(Fn,{...e,pageStore:s}),originGap:2,render:()=>p,onClose:()=>o("")})}function Fn(e){const{pageStore:t,...n}=e,i=(0,r().IS)((e=>({previewButton:{color:e.text.secondary,fontWeight:P().Wy.medium,display:"flex",gap:6,alignItems:"center",justifyContent:"center",padding:"3px 6px",height:void 0,fontSize:12,overflow:"hidden",maxWidth:"100%"},recordTitle:{...P().RC,flexGrow:1},previewLabelContainer:{display:"flex",gap:3,minWidth:0},previewLabel:{flexShrink:0},chevronDownIcon:{flexShrink:0,width:10}})),[]);return(0,le.jsx)(v().A,{placement:"right",renderTooltip:()=>(0,le.jsx)(u().sA,{defaultMessage:"Choose page to preview",id:"PageLayoutEditorHeader.pagePicker.title"}),render:e=>(0,le.jsxs)(Ce().p,{...(0,Ln().A)(e,n),style:i.previewButton,children:[(0,le.jsxs)("div",{style:i.previewLabelContainer,children:[(0,le.jsx)("div",{style:i.previewLabel,children:(0,le.jsx)(u().sA,{defaultMessage:"Preview:",id:"PageLayoutEditorHeader.pagePicker.titlePrefix"})}),(0,le.jsx)(Cn().A,{store:t,style:i.recordTitle})]}),(0,Bn().b)(i.chevronDownIcon)]})})}const Un=(0,u().YK)({searchPlaceholder:{id:"pageLayoutEditor.pagePicker.searchPlaceholder",defaultMessage:"Search pages..."}});const zn=function(){const e=(0,u().tz)(),t=(0,s().v3)(),{setModuleSelection:o,currentModuleSelection:a,layoutStore:l,sessionId:d}=(0,X().LH)(),c=void 0===a,p=(0,i.useCallback)((()=>{var e;null==o||o(void 0),(0,S().L3)({environment:t,layoutId:l.id,collectionId:null===(e=l.getCollectionModel())||void 0===e?void 0:e.id,sessionId:d,from:"page_settings_button_click"})}),[o,t,l,d]),g=(0,r().IS)((e=>({button:{...c&&{background:e.state.hover}}})),[c]);return o?(0,le.jsx)(Ce().p,{"aria-label":e.formatMessage({id:"pageLayoutEditorPageSettingsButton.ariaLabel",defaultMessage:"Page settings"}),iconLeading:n(735790).M,onClick:p,style:g.button,size:"lg",children:(0,le.jsx)(u().sA,{id:"pageLayoutEditorPageSettingsButton.label",defaultMessage:"Page settings"})}):null};var Kn=()=>n(30537);const Vn=(0,lt().xh)("arrowUTurnUpLeft",{default:{loader:()=>n.e(75152).then(n.bind(n,454503))},small:{loader:()=>n.e(75152).then(n.bind(n,613601))},fill:{loader:()=>n.e(75152).then(n.bind(n,357715))},fillSmall:{loader:()=>n.e(75152).then(n.bind(n,139274))}},["uturn","left","reverse","direction","turn","undo","back"]);var qn=()=>n(701545),Wn=()=>n(112452),Gn=()=>n(901389),Hn=()=>n(347063),Yn=()=>n(107683),$n=()=>n(430102),Qn=()=>n(507202);const Zn=(0,u().YK)({mainPage:{id:"pageLayoutAreas.page_main",defaultMessage:"main page"},sidebar:{id:"pageLayoutAreas.page_details",defaultMessage:"sidebar"},viewsMainTabModules:{id:"pageLayoutAreas.views_main_tab_modules",defaultMessage:"views main tab"},form:{id:"pageLayoutAreas.form_layout_schema",defaultMessage:"form"},personProfilePageMain:{id:"pageLayoutAreas.person_profile_page_main",defaultMessage:"person profile main column"},personProfilePageDetails:{id:"pageLayoutAreas.person_profile_page_details",defaultMessage:"person profile details column"},dashboardLayout:{id:"pageLayoutAreas.dashboard_layout_schema",defaultMessage:"dashboard"},generic:{id:"pageLayoutEditor.generic",defaultMessage:"area"}}),Jn=(0,u().YK)({page_main:Zn.mainPage,page_layout_schema:Zn.mainPage,page_details:Zn.sidebar,page_info_layout_schema:Zn.sidebar,form_layout_schema:Zn.form,form_conditional_modules:Zn.form,views_main_tab_modules:Zn.viewsMainTabModules,person_profile_page_main:Zn.personProfilePageMain,person_profile_page_details:Zn.personProfilePageDetails,dashboard_layout_schema:Zn.dashboardLayout,generic:Zn.generic});function Xn(){const{collectionStore:e,hasUnsavedChanges:t,saveChanges:n,isNewLayout:o,initialLayoutModulesByArea:l,resetLayoutToDefault:d}=(0,X().bi)(),{sessionId:c,layoutStore:p}=(0,X().LH)(),g=(0,s().v3)(),m=(0,u().tz)(),[f,h]=(0,i.useState)(!1),v=(0,a().K8)((()=>p.getModules()),[p]),b=(0,r().IS)((e=>({saveButton:{height:32},saveButtonCheckMarkIcon:{width:14,height:14},saveButtonInner:{lineHeight:1.2,fontSize:14,fontWeight:P().Wy.medium},saveButtonRevertItemTitle:{fontSize:P().J.UIRegular.desktop,lineHeight:"20px",color:e.text.primary},saveButtonRevertItemIcon:{width:16,height:16,marginTop:2,fill:e.primaryBlack},saveButtonRevertItem:{margin:"4px",padding:"0 4px 4px"},saveButtonSectionMenuItem:{minWidth:254,padding:0}})),[]),x=(0,i.useCallback)((t=>{Ot().Fv({environment:g}),S().do({environment:g,sessionId:c,collectionId:e.id,existingLayoutId:o?void 0:p.id,layoutSaved:t,context:"layout",initialLayoutModulesByArea:l,finalModulesByArea:v,layoutStore:p})}),[e.id,g,l,o,p,c,v]),A=(0,i.useCallback)((async()=>{if(t){h(!0);try{await n(),x(!0)}catch(e){if(h(!1),!(e instanceof Qn().rS))throw e;{const t=e.clientData;if("cannot_move_unmoveable_module"===(null==t?void 0:t.type))Gn().f1(m.formatMessage({id:"layoutBuilder.saveButton.error.moduleCannotBeMoved",defaultMessage:"The {moduleType} module cannot be moved."},{moduleType:m.formatMessage(fe().s[t.moduleType]).toLowerCase()}));else if("cannot_remove_undeletable_module"===(null==t?void 0:t.type))Gn().f1(m.formatMessage({id:"layoutBuilder.saveButton.error.moduleCannotBeDeleted",defaultMessage:"The {moduleType} module cannot be removed."},{moduleType:m.formatMessage(fe().s[t.moduleType]).toLowerCase()}));else if("unallowed_module_in_area"===(null==t?void 0:t.type)){const e={moduleType:m.formatMessage(fe().s[t.moduleType]).toLowerCase(),area:"page_layout_schema"===t.area?m.formatMessage(Jn.page_main):"page_info_layout_schema"===t.area?m.formatMessage(Jn.page_details):m.formatMessage(Jn.generic)};Gn().f1(m.formatMessage({id:"layoutBuilder.saveButton.error.unallowedModuleInArea",defaultMessage:"The {moduleType} module is not allowed in {area}."},e))}else if("multiple_views_main_content_tabs"===(null==t?void 0:t.type))Gn().f1(m.formatMessage({id:"layoutBuilder.saveButton.error.multipleViewsMainContentTabs",defaultMessage:"Tabbed layouts may not have multiple content tabs. Please reset your layout to remove the duplicate tab."}));else{const e=m.formatMessage({id:"layoutBuilder.saveButton.error.fallback",defaultMessage:"Something went wrong while saving layout."});Gn().f1(e)}}}}else x(!1)}),[x,t,m,n]),M=(0,i.useCallback)((()=>{d(),S().kA({environment:g,context:"layout",sessionId:c,collectionId:e.id,layoutId:o?void 0:p.id}),j(!1),x(!0)}),[x,e.id,g,o,p.id,d,c]),[w,j]=i.useState(!1);return(0,le.jsxs)(le.Fragment,{children:[(0,le.jsx)(Le().A,{popupType:Kn().n.Popup,alignmentToOrigin:"end",originGap:4,render:e=>(0,le.jsx)($().A,{style:b.saveButtonSectionMenuItem,children:(0,le.jsx)(G().A,{onClick:()=>{j(!0),e.close()},focused:!1,itemMarginLeft:0,itemMarginRight:0,style:b.saveButtonRevertItem,body:(0,le.jsxs)(y().Ye,{gap:10,children:[(0,Wn()._)(b.saveButtonRevertItemIcon),(0,le.jsxs)(y().wt,{children:[(0,le.jsx)("div",{style:b.saveButtonRevertItemTitle,children:(0,le.jsx)(u().sA,{id:"pageLayoutEditor.revertToOriginalLayout",defaultMessage:"Reset to original page layout"})}),(0,le.jsx)("div",{children:(0,le.jsx)(u().sA,{id:"pageLayoutEditor.revertToOriginalLayoutSubtitle",defaultMessage:"No properties will be deleted"})})]})]})})}),renderOrigin:e=>(0,le.jsx)($n().I,{style:b.saveButton,mainButtonStyle:b.saveButtonInner,title:(0,le.jsx)(u().sA,{id:"pageLayoutEditor.saveAndClose",defaultMessage:"Apply to all pages"}),color:"blue",onClick:A,disableDropdown:!1,iconLeading:qn().p,iconStyle:b.saveButtonCheckMarkIcon,onDropdownClick:e.onClick,isLoading:f})}),w?(0,le.jsx)(Yn().s,{isOpen:!0,showCloseIcon:!0,allowDismissByEscape:!0,onDismiss:()=>j(!1),areaConstraint:{width:{type:"min",length:300}},render:({sizeRange:e})=>(0,le.jsx)(Hn().tf,{header:(0,le.jsx)(Hn().YA,{iconAndTitle:(0,le.jsx)(Hn().ZQ,{iconGroup:Vn,title:(0,le.jsx)(u().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.title",defaultMessage:"Reset to original page layout?"})}),description:(0,le.jsx)(u().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.subtitle",defaultMessage:"No properties will be deleted."})}),footer:(0,le.jsx)(Hn().aO,{layout:"vertical",primaryButtons:[{buttonType:"destructive",label:(0,le.jsx)(u().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.revertButton",defaultMessage:"Reset"}),onClick:M}],secondaryButtons:[{buttonType:"dismiss",label:(0,le.jsx)(u().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.cancelButton",defaultMessage:"Cancel"})}]}),sizeRange:e})}):void 0]})}function ei(){const e=(0,s().v3)(),{device:t}=e,{isElectron:n,isElectronMac:o}=t,{sessionId:l,layoutStore:d}=(0,X().LH)(),{collectionStore:c,hasUnsavedChanges:p,isNewLayout:g,initialLayoutModulesByArea:m}=(0,X().bi)(),f=(0,a().K8)((()=>d.getModules()),[d]),h=(0,a().O$)(wn().b),v=n&&!h,b=(0,a().K8)((()=>(0,kn().ek)(o)),[o]),x=(0,i.useCallback)((async()=>{S().do({environment:e,sessionId:l,collectionId:c.id,existingLayoutId:g?void 0:d.id,layoutSaved:!1,context:"layout",initialLayoutModulesByArea:m,finalModulesByArea:f,layoutStore:d});const t=()=>Ot().Fv({environment:e});if(!p)return void t();await(0,_n().$)()&&t()}),[e,l,c.id,g,d,m,f,p]),A=(0,r().IS)((e=>{const t={pointerEvents:"auto"};return{header:{zIndex:1},headerContent:{display:"flex",position:"relative",marginTop:8,marginInlineEnd:16,marginBottom:8,marginInlineStart:16},topbarPlaceholder:{minHeight:b,background:e.onboardingPreviewBackground,borderBottom:`1px solid ${e.border.primary}`},sideButtonsContainer:{display:"flex",justifyContent:"space-between",width:"100%",height:"100%",gap:"6px",position:"absolute",insetInlineStart:0,top:0,pointerEvents:"none"},rightButtons:{...t},pageSettingsButtonContainer:{display:"flex",...t},titlePreviewContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",flexGrow:1,position:"relative",...P().RC},titlePreviewElementContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",maxWidth:400,overflow:"hidden"}}}),[b]);return(0,le.jsxs)("header",{style:A.header,children:[v?(0,le.jsx)("div",{style:A.topbarPlaceholder,className:Mn()({[Tn().N_7]:!0,[Tn().sbV]:!0})}):null,(0,le.jsxs)("div",{style:A.headerContent,children:[(0,le.jsx)("div",{style:A.titlePreviewContainer,children:(0,le.jsxs)("div",{style:A.titlePreviewElementContainer,children:[(0,le.jsx)(ti,{collectionStore:c}),(0,le.jsx)(Nn,{collectionStore:c})]})}),(0,le.jsxs)(y().Ye,{style:A.sideButtonsContainer,alignItems:"center",justifyContent:"space-between",children:[(0,le.jsx)("div",{style:A.pageSettingsButtonContainer,children:(0,le.jsx)(zn,{})}),(0,le.jsxs)(y().Ye,{gap:8,alignItems:"center",style:A.rightButtons,children:[(0,le.jsx)(Ce().p,{onClick:x,iconLeading:{icon:jn().xMarkSmallIcon,size:"sm"},size:"lg",children:(0,le.jsx)(u().sA,{id:"pageLayoutEditor.close",defaultMessage:"Cancel"})}),(0,le.jsx)(Xn,{})]})]})]})]})}function ti({collectionStore:e}){const t=(0,r().IS)((e=>({container:{display:"flex",alignItems:"center",justifyContent:"center",gap:4,color:e.text.primary,fontWeight:P().Wy.medium,width:"100%",...P().RC}})),[]),n=(0,a().K8)((()=>e.getIcon()),[e]);return(0,le.jsxs)("div",{style:t.container,children:[(0,le.jsx)(In().B6,{icon:n,size:20,iconRecordCategory:"collection",isEmptyPage:!1,disabled:!0}),(0,le.jsx)(Cn().A,{store:e})]})}function ni(e){const t=(0,r().IS)((e=>({container:{width:"100%",backgroundColor:e.background.secondary,cursor:"default"},innerContainer:{overflowY:"auto",paddingTop:20,paddingInlineEnd:0,paddingBottom:0,paddingInlineStart:24,height:"100%",marginTop:-20,minWidth:A().ok,zIndex:0,position:"relative"}})),[]),n=(0,a().K8)((()=>w().g.getState()),[]),o=n.isOpen&&"layout-editor"===n.mode?n.initialSelectedModuleId:void 0,s=(0,a().uB)(e.layoutBuilderModuleSelectionStore,M().A),l=n.isOpen&&"layout-editor"===n.mode;return(0,i.useEffect)((()=>{l&&s.setState(o?{type:"existing_module",moduleId:o,isDragging:!1}:void 0)}),[o,l,s]),n.isOpen&&"layout-editor"===n.mode?(0,le.jsxs)(xn,{...n,layoutBuilderModuleSelectionStore:s,children:[e.debugChildForTestsOnly,(0,le.jsxs)(g().A,{tag:y().wt,initial:{translateY:5,opacity:0},animate:{translateY:0,opacity:1},config:{duration:650,timingFunction:"ease-in-out"},style:t.container,children:[(0,le.jsx)(ei,{}),(0,le.jsxs)(y().Ye,{style:t.innerContainer,children:[(0,le.jsx)(ii,{}),(0,le.jsx)(nn,{})]})]})]}):null}function ii(){const{pageStore:e}=(0,X().bi)(),{setModuleSelection:t,layoutBuilderModuleSelectionStore:n,layoutStore:d,sessionId:c}=(0,X().LH)(),u=(0,s().v3)(),m=(0,a().K8)((()=>{var e;return Boolean(null===(e=n.state)||void 0===e?void 0:e.isDragging)}),[n]),v=(0,a().K8)((()=>(0,A().dV)(u)),[u]),y=(0,a().K8)((()=>{switch(v){case"xxSmall":case"xSmall":case"small":return"layout-editor-narrow";case"medium":case"large":case"xLarge":return e.isFullWidth()?"layout-editor-wide":"layout-editor";default:(0,p().HB)(v)}}),[v,e]),b=(0,a().K8)((()=>{switch(v){case"xxSmall":case"xSmall":return!0;case"small":case"medium":case"large":case"xLarge":return!1;default:return(0,p().HB)(v)}}),[v]),M=(0,a().K8)((()=>(0,x().oQ)(u).totalWidth),[u]),w=(0,a().K8)((()=>Boolean(e.getCover())),[e]);(0,i.useEffect)((()=>I(!b)),[b]);const j=(0,r().IS)((e=>({container:{height:"100%",background:e.background.primary,flexGrow:3,borderStartStartRadius:12,borderStartEndRadius:12,borderEndEndRadius:0,borderEndStartRadius:0,boxShadow:"0px 9px 12px 0px rgba(15, 15, 15, 0.1)",borderColor:e.palette.gray[75],borderWidth:1,overflowY:"auto",display:"flex",...m?{cursor:"grabbing"}:{},...b?{position:"relative"}:{}},mainPage:{flex:3,paddingTop:w?void 0:28},sidebarContainer:{background:e.background.primary,height:"100%",...b?{position:"absolute",insetInlineEnd:0,height:"100%",boxShadow:e.shadow.base.diffuse}:void 0},sidebarScroller:{borderInlineStart:`solid 1px ${e.outlineBlueButtonPressedBackground}`,height:"100%"},mainPageContainer:{flex:1,height:"100%"},mainPageScrollContainer:{height:"100%"},sidebar:{padding:`${x().MH}px ${x().uZ}px`,marginBottom:100,flex:1,minWidth:M,maxWidth:M,width:M,transition:"width 0.1s, min-width 0.1s, max-width 0.1s"},dismissSidebarOverlay:{position:"absolute",top:0,bottom:0,insetInlineStart:0,insetInlineEnd:0}})),[m,w,b,M]),[k,I]=(0,i.useState)(!b);return(0,le.jsxs)("div",{role:"presentation",style:j.container,onClick:e=>{(0,o().SQ)({event:e,context:o().y$.Click,callback:()=>{var e;t(void 0),(0,S().L3)({environment:u,layoutId:d.id,collectionId:null===(e=d.getCollectionModel())||void 0===e?void 0:e.id,sessionId:c,from:"background_click"})}})},children:[(0,le.jsx)(dn().s,{area:"page_main",style:j.mainPageContainer,children:(0,le.jsx)(h().l,{children:(0,le.jsx)(f().H,{type:l().A.Y,style:j.mainPageScrollContainer,children:(0,le.jsx)("div",{style:j.mainPage,children:(0,le.jsx)(cn().Mx,{type:y,children:(0,le.jsx)(ln().J,{area:"page_main"})})})})})}),b&&k?(0,le.jsx)("div",{role:"none",style:j.dismissSidebarOverlay,onClick:e=>(0,o().SQ)({event:e,context:o().y$.Click,callback:()=>I(!1)})}):void 0,(0,le.jsx)(g().A,{visible:k,initial:{translateX:M},animate:{translateX:0},exit:{translateX:M},config:{duration:250,timingFunction:"ease-in-out"},children:(0,le.jsx)(dn().s,{area:"page_details",style:j.sidebarContainer,children:(0,le.jsxs)(f().H,{type:l().A.Y,style:j.sidebarScroller,children:[(0,le.jsx)(oi,{isSidebarOpen:!0,setIsSidebarOpen:I}),(0,le.jsx)("div",{style:j.sidebar,children:(0,le.jsx)(ln().J,{area:"page_details"})})]})})}),k?void 0:(0,le.jsx)(oi,{isSidebarOpen:!1,setIsSidebarOpen:I})]})}function oi({isSidebarOpen:e,setIsSidebarOpen:t}){const n=(0,r().IS)((()=>({container:{position:"relative",height:0,zIndex:1},button:{position:"absolute",insetInlineEnd:e?void 0:4,insetInlineStart:e?4:void 0,top:4}})),[e]),o=(0,i.useCallback)((()=>{t((e=>!e))}),[t]);return(0,le.jsx)("div",{style:n.container,children:(0,le.jsx)(v().A,{renderTooltip:()=>e?(0,le.jsx)(u().sA,{...si.hideSidebar}):(0,le.jsx)(u().sA,{...si.showSidebar}),placement:"top",render:t=>(0,le.jsx)(m().A,{icon:e?c().O:d().S,...t,onClick:o,style:n.button,ariaLabel:e?b().A.formatMessage(si.hideSidebar):b().A.formatMessage(si.showSidebar)})})})}const si=(0,u().YK)({hideSidebar:{defaultMessage:"Hide sidebar",id:"pageLayout.builder.hideSidebar"},showSidebar:{defaultMessage:"Show sidebar",id:"pageLayout.builder.showSidebar"}})},201170:(e,t,n)=>{n.d(t,{HX:()=>s,Hi:()=>o().Hi,lR:()=>a});var i=()=>n(736026),o=()=>n(248284);function s(){i().A.setState({open:!0,submitted:!1,error:void 0})}function a(){i().A.setState({open:!1})}},210748:(e,t,n)=>{n.d(t,{O:()=>r});var i=()=>n(165358),o=()=>n(134025),s=()=>n(534177),a=()=>n(231297);function r(e){var t;const{environment:n,layoutStore:r}=e,d=r.getPreviousViewsMainCollectionViewBlockPointer(),c=null===(t=r.getModuleByType("viewsMain"))||void 0===t?void 0:t.collection_view_block_pointer;if(!r.getModel()||!r.canEdit())return;const u=r.getBlockChildren(),{blocksToRemoveFromChildArray:p,clearPreviousPointer:g}=function({previousViewsMainBlockId:e,currentViewsMainBlockId:t,currentBlocksArray:n}){if(n.length>1)return l;const i=1===n.length?n[0]:void 0;if((0,s().O9)(t))return(0,s().O9)(e)?{clearPreviousPointer:!0,blocksToRemoveFromChildArray:i===e&&t!==i?[e]:[]}:l;if((0,s().O9)(e)){return i===e?l:{clearPreviousPointer:!0,blocksToRemoveFromChildArray:i?[i]:[]}}return{clearPreviousPointer:!1,blocksToRemoveFromChildArray:[]}}({previousViewsMainBlockId:null==d?void 0:d.id,currentViewsMainBlockId:null==c?void 0:c.id,currentBlocksArray:u});if(!g&&0===p.length)return;const m=g?null:d;(0,i().log)({level:"info",from:"cleanupInvalidCollectionViewBlocks",type:"resetInvalidBlockChildrenArray",data:{layoutPointer:r.pointer,expectedPreviousPointer:m,actualPreviousPointer:c??null,actualChildIds:u}}),a().createAndCommit({environment:n,userAction:"cleanupInvalidCollectionViewBlocks.fixEmptyBlockChildren",canUndo:!1,perform:e=>{if(g&&a().applyOperation({store:r,transaction:e,operation:o().op.update({pointer:r.pointer,path:["format"],args:{previousViewsMainCollectionViewBlockPointer:null}})}),p.length>0)for(const t of p)a().applyOperation({store:r,transaction:e,operation:o().op.removeChild({pointer:r.pointer,path:["blocks"],args:{id:t}})})}})}const l={clearPreviousPointer:!1,blocksToRemoveFromChildArray:[]}},218429:(e,t,n)=>{n.d(t,{l:()=>b});var i=n(296540),o=()=>n(484714),s=()=>n(56366),a=()=>n(401497),r=()=>n(543906),l=()=>n(110750),d=()=>n(778417),c=()=>n(112204),u=()=>n(297872),p=()=>n(676007),g=()=>n(754002),m=()=>n(993130),f=()=>n(404141),h=()=>n(51367),v=()=>n(131448),y=n(474848);function b(e){const{messageKey:t,desktopRenderInner:n,desktopInnerStyle:i,desktopOnDismiss:d,phoneRenderInner:c,phoneInnerStyle:g,phoneOnly:b,calloutMetadata:x}=e,A=(0,o().v3)(),M=(0,o().Y0)(),w=(0,a().IS)((e=>({modalStyle:{background:e.background.secondary,borderRadius:12,...i}})),[i]),j=(0,s().K8)((()=>{var e;const t=(0,l().Xz)(A.TabbedRouterStore.state);return"web"===t.type&&((null===(e=t.redirectedTo)||void 0===e?void 0:e.route)||t.route)}),[A.TabbedRouterStore]),k=(0,s().K8)((()=>!(M.isPhone&&(0,m().A)(A)&&(!j||"page"!==j.name))&&!f().A.state.open),[M.isPhone,A,j]),I=(0,s().K8)((()=>v().default.isVisible(t)),[t])&&k;return(0,r().A)((()=>{h().DL(A,{callout_key:t,is_forced:v().default.isForced(t),placement_key:"Modal",callout_metadata:x})}),I),I?M.isPhone?(0,y.jsx)(S,{messageKey:t,renderInner:c,innerStyle:g}):b&&!M.isPhone?null:(0,y.jsx)(p().a,{open:!0,preventHideChildrenWhileOpening:!0,onDismiss:d,innerStyle:w.modalStyle,render:()=>(0,y.jsx)(u().A,{capture:!0,allowEsc:!0,render:n})}):null}function S(e){const{renderInner:t,innerStyle:n,messageKey:s}=e,a=(0,o().v3)(),r=(0,i.useCallback)((()=>{h().Sq(a,{callout_key:s,dismiss_type:"modal_background_clicked",placement_key:"Modal"})}),[a,s]),l=(0,i.useCallback)((()=>{h().Sq(a,{callout_key:s,dismiss_type:"modal_dismiss_clicked",placement_key:"Modal"})}),[a,s]);return(0,i.useEffect)((()=>{d().IU({environment:a}),(0,c().k)()}),[a]),(0,y.jsx)(g()._,{renderInner:t,innerStyle:n,onDismiss:r,onClosed:l})}},220172:(e,t,n)=>{n.r(t),n.d(t,{MobilePageBacklinksMenuRenderer:()=>p});n(296540);var i=()=>n(56366),o=()=>n(69708),s=()=>n(722872),a=()=>n(352759),r=()=>n(765957),l=()=>n(592968),d=()=>n(404277),c=()=>n(417392),u=n(474848);function p(e){const t=(0,i().O$)(l().F);return(0,u.jsx)(c().Ay,{popupType:c().nl.BottomSheet,bottomSheetInitialState:"half",trapFocus:!0,open:t.isOpen,render:()=>(0,u.jsx)(g,{menuState:t}),onDismiss:()=>{l().F.setState({isOpen:!1})}})}function g(e){const t=(0,i().O$)(r().AppStoreMainEditorCurrentBlockStore);if(!e.menuState.isOpen)return null;if(t){const e={menuType:s().gu.Modal,title:(0,u.jsx)(o().sA,{defaultMessage:"Linked to this page",id:"page.expandedBacklinks.label"})};return(0,u.jsx)(d().A,{...e,children:(0,u.jsx)(a().t,{store:t})})}return null}},226916:(e,t,n)=>{n.d(t,{c:()=>b,t:()=>S});n(16280);var i=()=>n(242422),o=()=>n(908006),s=()=>n(165358),a=()=>n(388821),r=()=>n(201980),l=()=>n(970330),d=()=>n(319975),c=()=>n(231297),u=()=>n(62287),p=()=>n(824438),g=()=>n(389658),m=()=>n(972435),f=()=>n(129522),h=()=>n(765957),v=()=>n(75368);const y=(0,n(69708).YK)({formDatabaseTitle:{id:"newBlock.databaseInline.formDatabaseTitle",defaultMessage:"New form"}});function b(e){var t,n;const{environment:r,store:c,viewType:m,transaction:y}=e,b=null===(t=c.getBlockTitleStore())||void 0===t?void 0:t.getValue();i().default.checkGate({gateName:"mobile_keep_template_gallery_open"})&&v().A.state.open&&v().A.setState({open:!1});const S=c.getSpaceId()??(null===(n=h().default.state.mainEditorCurrentBlockStore)||void 0===n?void 0:n.getSpaceId()),x=S?r.idCreator.getSpaceIdCreatorSync(S):void 0;(0,p().j)({environment:r,sourceBlockId:"root",targetBlockPointer:c.pointer,sourceBlockSubtree:(0,a().partialRecordMapToRecordMap)((0,g().qP)({isInline:!1,viewType:m})),targetRecordCache:c.inMemoryRecordCache,transaction:y,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,spaceIdCreator:x}),u().pd({environment:r,block:c,blockType:"collection_view_page",transaction:y}),b&&d().R9({environment:r,store:c.getBlockTitleStore(),value:b,transaction:y}),o().default.afterNextFlush((()=>{const e=f().K.findCollectionViewBlockFromStore(c);var t;e&&"handleCreated"in e&&(null===(t=e.handleCreated)||void 0===t||t.call(e))}));const A=c.getCollectionStoreIfSingleSource();A?l().vH(r,{from:"template_picker",type:"collection_view_page",creating_block_id:c.id,is_full_screen:!0,view_type:m,collection_id:A.id}):(s().log({level:"info",from:"initializeViewActions",type:"track_create_block_missing_collection_id",data:{miscDataToConvertToString:{creating_block_id:c.id,is_full_screen:!0,view_type:m}}}),l().vH(r,{from:"template_picker",type:"collection_view_page",creating_block_id:c.id,is_full_screen:!0,view_type:m,collection_id:""}))}async function S(e){var t,i,o;const{environment:s,store:d}=e,f=null===(t=d.getBlockTitleStore())||void 0===t?void 0:t.getValue(),{formsEditorDependency:v}=await Promise.resolve().then(n.bind(n,339034)),{formEditorActions:b}=await v.load(),S=d.getSpaceId()??(null===(i=h().default.state.sidebarSpaceStore)||void 0===i?void 0:i.id)??(null===(o=h().default.state.mainEditorCurrentBlockStore)||void 0===o?void 0:o.getSpaceId()),x=S?s.idCreator.getSpaceIdCreatorSync(S):void 0;c().createAndCommit({userAction:"HorizontalTemplatePicker.createForm",environment:s,canUndo:!0,perform:e=>{var t;(0,p().j)({environment:s,sourceBlockId:"root",targetBlockPointer:d.pointer,sourceBlockSubtree:(0,a().partialRecordMapToRecordMap)((0,g().mT)({isInline:!1,name:(0,r().w9s)(f)?(0,r().x9d)(m().A.formatMessage(y.formDatabaseTitle)):f})),targetRecordCache:d.inMemoryRecordCache,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,spaceIdCreator:x}),u().pd({environment:s,block:d,blockType:"collection_view_page",transaction:e});const n=d.getCollectionStoreIfSingleSource();if(!n)throw new Error("Collection store not found");const i=null==n||null===(t=n.getModel())||void 0===t?void 0:t.getNormalizedSchema();if(!i)throw new Error("Schema not found");const o=d,c=b.createCollectionFormEditorView({environment:s,transaction:e,collectionViewBlockStore:o,collectionId:n.id,schema:i,initializeWithAllDefaultQuestions:!0});b.createResponsesCollectionView({environment:s,transaction:e,collectionViewBlockStore:o,collectionStore:n,schema:i}),l().vH(s,{from:"template_picker",type:"form",creating_block_id:d.pointer.id,form_id:null==c?void 0:c.formId,view_id:o.id})}})}},231039:(e,t,n)=>{n.d(t,{N:()=>l});n(296540);var i=()=>n(401497),o=()=>n(568999),s=()=>n(69708),a=()=>n(460292),r=n(474848);function l({inviteTarget:e}){const t=(0,i().IS)((e=>({notionMemberLine:{display:"flex",alignItems:"center",gap:2},notionMemberIcon:{display:"flex",alignItems:"center",justifyContent:"center",color:e.blue.icon.accentPrimary}})),[]);return(0,r.jsxs)("div",{style:t.notionMemberLine,children:[(0,r.jsxs)("div",{style:t.notionMemberIcon,children:[(0,r.jsx)(a().Q,{variantName:"fillSmall",iconGroup:o().g}),(0,r.jsx)(s().sA,{id:"invite.google_imports.notion_member.title",defaultMessage:"Notion Member"})]}),(0,r.jsx)("span",{children:"â€¢"}),(0,r.jsx)("div",{children:e.value.email})]})}},232461:(e,t,n)=>{n.d(t,{J:()=>l});var i=()=>n(484714),o=()=>n(56366),s=()=>n(765957),a=()=>n(329304),r=()=>n(787766);function l(){var e;const t=(0,o().O$)(s().AppStoreSidebarSpaceStore),n=(0,i().v3)(),l=null===(e=n.currentUser)||void 0===e?void 0:e.id,d=n.device.isMobile,c=(0,a().P9)({name:"contacts_imports_invite",spaceId:null==t?void 0:t.id,userId:l}),u=(0,o().K8)((()=>(null==t?void 0:t.canEditMembership())??!1),[t]);return(0,r().vC)({canEditPermission:u,isMobile:d,isEnterprise:c??!1})}},233692:(e,t,n)=>{function i(e,t="Untitled Agent"){return{name:e.getName()||t,icon:e.getIcon()||""}}n.d(t,{m:()=>i})},236190:(e,t,n)=>{n.d(t,{c:()=>o});n(296540);var i=n(474848);const o=(0,n(340498).wt)("minus",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M3.037 8.844h9.92a.705.705 0 00.368-.103.825.825 0 00.28-.28.73.73 0 000-.773.752.752 0 00-.28-.28.705.705 0 00-.369-.102H3.037a.705.705 0 00-.369.102.824.824 0 00-.28.28.73.73 0 000 .772.914.914 0 00.28.281.705.705 0 00.37.103z"})})},236357:(e,t,n)=>{n.d(t,{a:()=>o});var i=()=>n(44551);async function o(){return i().electronApi&&i().electronApi.isMainTab?i().electronApi.isMainTab():!i().electronApi||!i().electronApi.isMainWindow||i().electronApi.isMainWindow()}},238453:(e,t,n)=>{n.d(t,{U4:()=>k,Wz:()=>I,e6:()=>M,fC:()=>w,zA:()=>j});n(898992),n(354520),n(581454),n(737550);var i=n(296540),o=()=>n(242422),s=()=>n(484714),a=()=>n(56366),r=()=>n(313491),l=()=>n(187174),d=()=>n(798880),c=()=>n(196131),u=()=>n(496603),p=()=>n(720665),g=()=>n(746970),m=()=>n(559506),f=()=>n(231297),h=()=>n(47373),v=()=>n(773442),y=()=>n(765957),b=()=>n(21735),S=()=>n(870092),x=()=>n(134217),A=()=>n(749240);function M({spaceStore:e,requestType:t}){const n=w({spaceStore:e}),i=(0,s().v3)(),[{value:o=[]}]=(0,l().Yb)((async()=>{if(!n)return;const t=await m().callApi({eventName:"getAccessRequests",environment:i,data:{parentTable:"space",parentId:e.id,size:100,status:"pending"}});if("failed"===t.type)throw t.error;const o=t.data.accessRequestIds;return g().si(i,e,o)}),[e,i,n]),r=(0,a().K8)((()=>o.filter((e=>"pending"===e.accessRequest.status))),[o]),d=(0,v().T)({spaceStore:e,requests:r}),c=(0,a().K8)((()=>(0,u().yU)(r,d??[]).filter((e=>{const[n,i]=e;return"member"===t&&"space_membership_request"===i||("guest"===t&&"guest_invite_request"===i||"member_or_guest"===t&&("guest_invite_request"===i||"space_membership_request"===i))})).map((([e])=>e))),[t,d,r]);return(0,u().oE)(c)}function w({spaceStore:e}){return(0,a().K8)((()=>e.canEditMembership()&&(0,h().x3)()),[e])}function j({spaceStore:e,internalDomains:t}){const n=(0,s().v3)(),[{value:i}]=(0,l().Yb)((async()=>{if(0===t.length)return!1;let i;if(b().A.state.shouldUseEdgeCache&&o().default.checkGate({gateName:"edge_cache_plus_settings"})){const s=o().default.getConfigKey("email_alias_migration","mode"),a=await m().callApi({eventName:"listUsers",environment:n,data:{cursor:void 0,membershipFilter:"guests",limit:1,spaceId:e.id,includeDomains:t.map((e=>e.url)),includeAliasSearch:(0,r().K)(s)}});if("success"!==a.type)return!1;i=a.data.users.length>0}else{const n=A().subscriptionDataStoreInstance.state;if(!n)return!1;i=(0,x().oe)(n).map((t=>S().L.createChildStore(e,{table:d().oo,id:t.userId}).getModel())).some((e=>(0,c().JD)(e,t)))}return e.canEditMembership()&&i&&"enterprise"!==e.getSubscriptionTier()}),[n,t,e]);return i??!1}function k({requestType:e,spaceStore:t}){const n=M({spaceStore:t,requestType:e});return(0,a().K8)((()=>{const{sidebarSpaceViewStore:t}=y().default.state;if(t)return n.filter((n=>{const i=function({requestType:e,currentSpaceViewStore:t}){var n,i;const o=Date.now()-10*p().Gq,s="member"===e?null===(n=t.getSettings())||void 0===n?void 0:n.last_opened_member_request_tab:null===(i=t.getSettings())||void 0===i?void 0:i.last_opened_guest_request_tab;return s??o}({requestType:e,currentSpaceViewStore:t});return i<n.accessRequest.created_time})).length}),[e,n])}function I({requestType:e,spaceStore:t}){const n=(0,s().v3)(),o=w({spaceStore:t});(0,i.useEffect)((()=>{const{sidebarSpaceViewStore:t}=y().default.state;t&&o&&"member"!==e&&f().createAndCommit({userAction:"SpaceSettingsRequests.updateLastOpened",environment:n,canUndo:!0,perform:e=>{f().applyOperation({store:t,operation:{pointer:t.pointer,path:["settings","last_opened_guest_request_tab"],command:"set",args:Date.now()},transaction:e})}})}),[e,n,o]),(0,i.useEffect)((()=>()=>{const{sidebarSpaceViewStore:t}=y().default.state;t&&o&&"guest"!==e&&f().createAndCommit({userAction:"SpaceSettingsRequests.updateLastOpened",environment:n,canUndo:!0,perform:e=>{f().applyOperation({store:t,operation:{pointer:t.pointer,path:["settings","last_opened_member_request_tab"],command:"set",args:Date.now()},transaction:e})}})}),[e,n,o])}},241498:(e,t,n)=>{n.d(t,{d:()=>a,w:()=>r});var i=()=>n(370657),o=()=>n(166442),s=()=>n(820423);function a(e){const{onClose:t,eventId:n}=e;s().N.setState({open:!0,onClose:t,eventId:n});const a=(0,i().bz)("researcher");o().defaultClientAIChatStore.setState({...o().defaultClientAIChatStore.state,configForNewTranscripts:a})}function r(e){const{dismissType:t}=e;s().N.state.open&&s().N.state.onClose(t),s().N.reset(),o().defaultClientAIChatStore.reset()}},248284:(e,t,n)=>{n.d(t,{aL:()=>x,T7:()=>S,Hi:()=>A,$4:()=>b});n(296540);var i=()=>n(564884),o=()=>n(584262),s=()=>n(427704),a=()=>n(69708),r=()=>n(486674),l=()=>n(492414),d=()=>n(411671),c=()=>n(329458),u=()=>n(314529),p=()=>n(242422);var g=()=>n(687633),m=()=>n(901389),f=()=>n(898714),h=()=>n(729283),v=()=>n(564746),y=n(474848);async function b(e){(0,c().L)(e,{variant:"open_notion"}),(0,g().u)(e,{target:"open_notion"}),await h().VE(e,{utmContent:"topbar_cta",nextRoute:s().JZ.root})}function S(e,t){const{RouterStore:n}=e,i=n.state.route,c=(0,r().a)();if(function(e){(0,u().DO_NOT_USE_trackLegacy)(e,"public_page_topbar_edit_click",{},{dontWait:!0}),p().default.logEvent("public_page_topbar_edit_click")}(e),"page"===i.name&&i.requestedOnPublicDomain&&c){const t=(0,l().Ay)({store:c,preferPublicLink:!1,pageVisitSource:o().y8.EditPublicPage,disableSlug:!0,embedded:!1});(0,v().navigateOnBaseUrl)({environment:e,url:t,openInNewTab:i.embedded})}else e.currentUser.isLoggedIn()?m().ui({showCancel:!0,keepFocus:!1,message:(0,y.jsx)(a().sA,{defaultMessage:"When you start editing, your name, email and photo may become visible to anyone who can view the page.",id:"action.startPublicEditDialog.message"}),items:[{label:(0,y.jsx)(a().sA,{defaultMessage:"Continue",id:"action.startPublicEditDialog.continueLabel"}),color:"blue",onAccept(){d().A.setState({editing:!0,commenting:!0})}}]}):(f().iZ({currentUserId:e.currentUser.id,blockId:t}),(0,v().navigateOnBaseUrl)({environment:e,url:s().JZ.login}))}function x(e,t){const{RouterStore:n}=e,i=n.state.route,a=(0,r().a)();if(function(e){(0,u().DO_NOT_USE_trackLegacy)(e,"public_page_topbar_comment_click",{},{dontWait:!0}),p().default.logEvent("public_page_topbar_comment_click")}(e),"page"===i.name&&i.requestedOnPublicDomain&&a){const t=(0,l().Ay)({store:a,preferPublicLink:!1,pageVisitSource:o().y8.CommentPublicPage,disableSlug:!0,embedded:!1});(0,v().navigateOnBaseUrl)({environment:e,url:t,openInNewTab:i.embedded})}else f().iZ({currentUserId:e.currentUser.id,blockId:t}),(0,v().navigateOnBaseUrl)({environment:e,url:s().JZ.login})}function A(e,t){(0,i().u)({environment:e,event:{eventName:"report_form_clicked",eventProperties:{form_id:t}}}),(0,v().navigateOnBaseUrl)({environment:e,url:s().JZ.reportInappropriateForm})}},264699:(e,t,n)=>{n.d(t,{_:()=>a});var i=()=>n(972435);const o=(0,n(69708).YK)({table:{defaultMessage:"Table",id:"templatePickerHelpers.databaseTemplateNames.table"},board:{defaultMessage:"Board",id:"templatePickerHelpers.databaseTemplateNames.board"},list:{defaultMessage:"List",id:"templatePickerHelpers.databaseTemplateNames.list"},calendar:{defaultMessage:"Calendar",id:"templatePickerHelpers.databaseTemplateNames.calendar"},gallery:{defaultMessage:"Gallery",id:"templatePickerHelpers.databaseTemplateNames.gallery"},timeline:{defaultMessage:"Timeline",id:"templatePickerHelpers.databaseTemplateNames.timeline"}});function s(e){const{environment:t,store:i,viewType:o}=e;n(231297).createAndCommit({userAction:"templatePickerHelpers.handleClickForViewType",environment:t,canUndo:!0,perform:e=>{(0,n(226916).c)({environment:t,store:i,viewType:o,transaction:e}),n(857783).uK({environment:t,store:i,pageVisitSource:n(584262).y8.LinkInPage});const s=i.getCollectionViewStores()[0];s&&(0,n(493260).F)(s.id,{viewType:o})}})}const a=[{name:i().A.formatMessage(o.table),type:"table",iconFn:n(421559).T,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>s({environment:e,store:t,viewType:"table"})},{name:i().A.formatMessage(o.board),type:"board",iconFn:n(969523).q,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>s({environment:e,store:t,viewType:"board"})},{name:i().A.formatMessage(o.list),type:"list",iconFn:n(202017).n,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>s({environment:e,store:t,viewType:"list"})},{name:i().A.formatMessage(o.timeline),type:"timeline",iconFn:n(397414).u,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>s({environment:e,store:t,viewType:"timeline"})},{name:i().A.formatMessage(o.calendar),type:"calendar",iconFn:n(42583).D,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>s({environment:e,store:t,viewType:"calendar"})},{name:i().A.formatMessage(o.gallery),type:"gallery",iconFn:n(858141).squareGrid2X2Icon,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>s({environment:e,store:t,viewType:"gallery"})}]},271459:(e,t,n)=>{n.r(t),n.d(t,{TopbarStopSuggestModeButton:()=>w});var i=n(296540),o=()=>n(484714),s=()=>n(56366),a=()=>n(401497),r=()=>n(75435),l=()=>n(718827),d=()=>n(252291),c=()=>n(209416),u=()=>n(995847),p=()=>n(69708),g=()=>n(473227),m=()=>n(755199),f=()=>n(614415),h=()=>n(745766),v=()=>n(645873),y=()=>n(737230),b=()=>n(765957),S=()=>n(953006),x=n(474848);const A=(0,p().YK)({stopSuggestRole:{defaultMessage:"Turn off suggesting",id:"topbar.stopsuggestmodel."},tooltip:{defaultMessage:"Youâ€™re suggesting",id:"topbarStopSuggestModeButton.tooltip"},tooltipCommentOnlyContent:{defaultMessage:"Suggest edits or add comments",id:"topbarStopSuggestModeButton.tooltipCommentOnlyContent"}});function M({store:e,isVisible:t,compact:n,framerMotion:m}){const f=(0,o().v3)(),v=(0,p().tz)(),b=(0,s().O$)(r().b),S=(0,s().K8)((()=>y().Ay.state.expanded),[]),M=(0,a().IS)((e=>({button:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:256,color:e.blue.text.accentPrimary,gap:6,padding:"0 10px",height:28,background:e.palette.uiBlue[100],...(0,h().g)({noDrag:f.device.isElectron&&!b})},hoveredButton:{background:e.palette.uiBlue[200]},pressedButton:{background:e.palette.uiBlue[300]},text:{fontSize:14,lineHeight:1.428}})),[f.device.isElectron,b]),w=(0,i.useCallback)((()=>{g().PD({environment:f,navigableBlockStore:e,mode:"default",location:"stop_suggest_pill"})}),[f,e]),k=(0,i.useRef)(null),{AnimatePresence:I,motion:C}=m;return(0,x.jsx)(I,{children:t?(0,x.jsxs)(C.div,{ref:k,initial:{opacity:0,x:30},animate:{opacity:1,x:0},transition:{duration:.1},children:[(0,x.jsxs)(l().Ay,{style:M.button,hoveredStyle:M.hoveredButton,pressedStyle:M.pressedButton,onClick:w,ariaLabel:v.formatMessage(A.stopSuggestRole),children:[(0,x.jsx)(d().I,{icon:c().a}),(0,x.jsx)(I,{initial:S,children:n||S?void 0:(0,x.jsx)(C.div,{initial:{width:0},exit:{width:0},animate:{width:"auto"},transition:{duration:.1},style:M.text,children:(0,x.jsx)(p().sA,{id:"topbar.stopsuggestmodel.label",defaultMessage:"Suggesting"})})}),(0,x.jsx)(d().I,{icon:u().xMarkSmallIcon,size:"sm",colorPalette:"blue",colorVariant:"tertiary"})]},"button"),n||S?void 0:(0,x.jsx)(j,{store:e,origin:k})]}):void 0})}function w(e){const{value:t}=(0,v().fJ)(f().fM);return t?(0,x.jsx)(M,{...e,framerMotion:t}):null}function j(e){const{store:t,origin:n}=e,a=(0,p().tz)(),r=(0,o().v3)(),l=(0,s().K8)((()=>t.isCommentOnly()),[t]),d=(0,s().K8)((()=>{var e;return null===(e=b().default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.dismissed_suggest_mode_tooltip}),[]),c=l||!d,[u,g]=(0,i.useState)(c);return u?(0,x.jsx)(S().k,{origin:n,alignmentToOrigin:"center",placementToOrigin:"bottom",header:(0,x.jsx)(x.Fragment,{children:a.formatMessage(A.tooltip)}),content:l?a.formatMessage(A.tooltipCommentOnlyContent):null,headerStyle:{marginBottom:-2,width:"max-content",maxWidth:240},contentStyle:{width:"max-content",maxWidth:240},hideCloseButton:!0,shouldDismissUponOutsideClick:!0,onCloseClick:()=>{g(!1),m().eO({environment:r,dismissed:!0})},pointerPosition:"50%",pointerLength:24}):null}},273321:(e,t,n)=>{n.d(t,{A:()=>B});var i=n(296540),o=()=>n(726637),s=()=>n(790748),a=()=>n(56366),r=()=>n(401497),l=()=>n(713998),d=()=>n(797809),c=()=>n(69708),u=()=>n(284371),p=()=>n(471995),g=()=>n(710648),m=()=>n(678553),f=()=>n(125565),h=()=>n(862292),v=()=>n(381678),y=()=>n(972435),b=()=>n(480289),S=()=>n(737230),x=()=>n(765957),A=()=>n(441467),M=()=>n(848565),w=()=>n(473975),j=()=>n(555776),k=()=>n(116008),I=()=>n(811879),C=()=>n(846583),T=()=>n(640753),_=()=>n(105157),P=n(474848);function B(e){const{environment:t,menuListItemProps:n,shouldShowTopDividerLine:B,shouldShowBottomDividerLine:D,shouldExpandDiscussionWidth:R,noBackgroundColors:E,onMouseEnter:L,onMouseLeave:O,onFocus:N,onBlur:F,onMobileClose:U}=e,z=(0,a().O$)(x().AppStoreMainEditorCurrentBlockStore),K=(0,a().K8)((()=>(0,v()._)(t)),[t]),V=M().eQ,q=(0,a().K8)((()=>j().A.state.isActivelyComposing),[]),W=(0,a().K8)((()=>j().A.state.isHovered),[]),G=(0,i.useCallback)((()=>{null==L||L()}),[L]),H=(0,i.useCallback)((()=>{null==O||O()}),[O]),Y=(0,i.useCallback)((()=>{null==N||N()}),[N]),$=(0,i.useCallback)((()=>{k().A.hasContent()?j().A.resetAllActiveSources():(k().A.reset(),j().A.reset()),null==F||F()}),[F]),Q=(0,c().tz)(),Z=(0,i.useRef)(null),J=o().A.isMobile;(0,s().b)(b().A,(()=>({getNode:()=>Z.current})),[]);const X=(0,r().IS)((e=>({menuDiscussionItem:{marginInlineStart:-14,marginInlineEnd:-14,width:"calc(100% + 28px)"},discussionContainer:{paddingTop:J?4:6,borderTop:!J&&B?`1px solid ${e.regularDividerColor}`:void 0,borderBottom:!J&&D?`1px solid ${e.regularDividerColor}`:void 0,transition:"background 300ms ease",background:E?void 0:q?e.focusDiscussionBackground:W?e.hoveredDiscussionBackground:void 0},comment:{position:"relative",fontSize:J?16:14},commentElementsBelowUserRow:{paddingInlineStart:M().FB},avatar:{marginTop:0,marginInlineEnd:J?4:8,userSelect:"none",WebkitUserSelect:"none"},userRow:{display:"flex",flexDirection:"row",alignItems:"center",userSelect:"none",WebkitUserSelect:"none"},placeholder:{height:8,width:81,borderRadius:6,background:e.lightDividerColor},draftLabel:{margin:"0 6px",flexBasis:140,whiteSpace:"normal",flexGrow:void 0,display:"inline",color:e.text.tertiary},container:{paddingTop:M().e4,paddingInlineEnd:16,paddingBottom:M().Wv,paddingInlineStart:16},noOverflow:{overflow:"hidden"},commentContext:{display:"flex",width:"100%",marginTop:6,marginBottom:22,fontSize:13,color:e.text.secondary},displayName:{fontWeight:u().Wy.medium,whiteSpace:"normal"},fullWidthFlex:{display:"flex",width:"100%"},smallTopPadding:{marginTop:1}})),[W,J,q,E,D,B]),ee=(0,i.useCallback)((async()=>{const e=await h().T.formulas.load();A().i5({environment:t,allowActionsWhileCommenting:!0,formulasModule:e});const n=S().Ay.state.hasActiveDraftComment;o().A.isMobile&&n&&(p().D6({label:Q.formatMessage({id:"draftComment.submitted.snackbar",defaultMessage:"Comment added"}),position:"bottom",style:{justifyContent:"center",textAlign:"center"}}),null==U||U())}),[t,Q,U]),te=(0,a().K8)((()=>!k().A.state.open||"reaction"===k().A.state.content),[]),ne=(0,a().K8)((()=>{var e;return k().A.getBlockStore()??(null===(e=k().A.getClosestBlockStore())||void 0===e?void 0:e.parentBlockStore)}),[]),ie=(0,a().K8)((()=>k().A.getPropertyId()),[]),oe=(0,a().K8)((()=>{if(ie){var e;const t=null===(e=k().A.getBlockStore())||void 0===e?void 0:e.getAssociatedCollectionStore();if(!t||"collection"!==t.table)return;const n=t.getSchema();return(0,l()._g)({schema:n,property:ie})}}),[ie]),se=(0,a().K8)((()=>(0,d().RX)(y().A.getIntl()).title),[]),ae=(0,a().O$)(k().f),re=(0,a().K8)((()=>null==K?void 0:K.getDisplayName(Q)),[K,Q]),le=(0,a().K8)((()=>null==ne?void 0:ne.getSpaceId()),[ne]),de=(0,a().K8)((()=>A().Ek({environment:t})),[t]),ce=(0,a().K8)((()=>k().A.getType()),[]),ue=(0,a().K8)((()=>null==ne?void 0:ne.getValue()),[ne]);if(te||!se||!K||!ne||!z||!ae||!le||!ue&&"block"===ce||!de&&"inline"===ce)return null;const pe="inline"===ce||ie,ge="block"===ce&&!ie?(0,P.jsx)(g().Ay,{blockValue:ue,rootStore:ne,blockPreviewLocation:"comments_sidebar"}):pe?(0,P.jsx)(g().vY,{value:{value:(null==de?void 0:de.context)??[],spaceId:le},propertySchema:se,labeled:!1,rootStore:ne,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!0}):null;return(0,P.jsx)("div",{style:X.discussionContainer,ref:Z,onClick:null==n?void 0:n.onClick,onMouseEnter:G,onMouseLeave:H,children:(0,P.jsx)(m().Ay,{allowTextSelection:!0,style:X.menuDiscussionItem,title:(0,P.jsx)("div",{style:X.container,children:(0,P.jsxs)("div",{style:X.comment,children:[(0,P.jsxs)("div",{style:X.userRow,children:[(0,P.jsx)(I().E,{authorStore:K,avatarSize:V,avatarStyle:X.avatar}),(0,P.jsxs)("div",{style:X.noOverflow,children:[(0,P.jsx)("span",{style:X.displayName,children:re||(0,P.jsx)("span",{style:X.placeholder})}),(0,P.jsx)(f().A,{isSmall:!J,isSecondaryColor:!0,isMultiline:!0,style:X.draftLabel,children:(0,P.jsx)(c().sA,{defaultMessage:"Draft",id:"DraftCommentInputWithContext.draftLabel"})})]})]}),(0,P.jsxs)("div",{style:X.commentElementsBelowUserRow,children:[(0,P.jsx)("div",{style:X.commentContext,children:(0,P.jsxs)("div",{style:X.fullWidthFlex,children:[(0,P.jsx)(C().T,{}),oe?(0,P.jsx)(_().A,{propertySchema:oe}):void 0,(0,P.jsx)("div",{style:X.smallTopPadding,children:ge})]})}),(0,P.jsx)(T().A,{showAvatar:!1,parentStore:z,blockStore:ne,onSubmit:ee,discussionInputStore:ae,isNewComment:!0,isEditingExistingComment:!1,isMobileSlideUpMenu:!0,shouldSaveUnsentComments:!1,discussionFormat:w().DiscussionFormat.Sidebar,canDrop:!0,disableFocusRing:!0,adjustWidthForDraftDiscussions:R,dontMoveCursorToInputEndOnFocus:!0,onBlur:$,onFocus:Y},"draft-comment-sidebar")]})]})})})},"draft-comment-discussion-updates")}},274041:(e,t,n)=>{n.d(t,{$O:()=>a,cN:()=>r,fh:()=>s,h5:()=>l});var i=()=>n(645873);const o={PublicPagesSection:new(i().O2)("PublicPagesSection",(()=>Promise.all([n.e(25700),n.e(91325)]).then(n.bind(n,692536)))),DomainsSection:new(i().O2)("DomainsSection",(()=>Promise.all([n.e(92865),n.e(25891),n.e(27882),n.e(27229),n.e(56859)]).then(n.bind(n,501578)))),GeneralAccessPermissionSection:new(i().O2)("PublishedSiteSettings",(()=>Promise.all([n.e(80668),n.e(34399),n.e(77651)]).then(n.bind(n,343001)))),FormShareMenu:new(i().O2)("FormShareMenu",(()=>Promise.all([n.e(25700),n.e(77729),n.e(51859)]).then(n.bind(n,734207))))},s=(0,i()._h)(o.PublicPagesSection,(e=>e.PublicPagesSection)),a=(0,i()._h)(o.DomainsSection,(e=>e.DomainsSection)),r=(0,i()._h)(o.GeneralAccessPermissionSection,(e=>e.GeneralAccessPermissionSection)),l=(0,i()._h)(o.FormShareMenu,(e=>e.FormShareMenu))},274072:(e,t,n)=>{n.r(t),n.d(t,{MobilePageUpdatesMenuRenderer:()=>S});var i=n(296540),o=()=>n(484714),s=()=>n(56366),a=()=>n(69708),r=()=>n(722872),l=()=>n(446027),d=()=>n(404277),c=()=>n(45552),u=()=>n(417392),p=(n(581454),()=>n(401497)),g=()=>n(753397),m=()=>n(765957),f=()=>n(187959),h=()=>n(586538),v=()=>n(569866),y=n(474848);function b(){const e=(0,i.useCallback)((()=>(0,y.jsx)(v().A,{message:(0,y.jsx)(a().sA,{defaultMessage:"Any changes to this page will show up here.",id:"updatesModal.currentPageTab.emptyPrompt"}),title:(0,y.jsx)(a().sA,{defaultMessage:"No page updates",id:"updatesModal.currentPageTab.emptyPromptTitle"})})),[]),t=(0,s().O$)(m().AppStoreSidebarSpaceStore),n=(0,s().O$)(m().AppStoreMainEditorCurrentBlockStore),o=(0,s().K8)((()=>{var e;const t=null==n||null===(e=n.getCollectionPointers())||void 0===e?void 0:e.map((e=>e.id)),i=null==n?void 0:n.isCollectionView();return null!=n&&n.isDefined()?{id:n.id,isCollection:i,collectionIds:t}:void 0}),[n]),r=(0,p().IS)((e=>({getNotifiedFor:{padding:18,backgroundColor:e.background.secondary}})),[]);return t&&o&&n?(0,y.jsxs)("div",{children:[(0,y.jsx)(g().QB,{navigableBlockStore:n,from:"page_updates",buttonPopupStore:f().A,style:r.getNotifiedFor}),(0,y.jsx)(h().A,{navigableBlockStore:n,collectionIds:o.collectionIds,spaceId:t.id,empty:e,source:"updates_sidebar"},"current-page")]}):null}function S(e){const t=(0,o().Y0)(),n=(0,s().K8)((()=>l().A.state.open),[]),a=(0,i.useCallback)((()=>{l().A.setState({open:!1})}),[]);return t.isMobile?(0,y.jsx)(u().Ay,{popupType:u().nl.BottomSheet,bottomSheetInitialState:"full",trapFocus:!0,open:n,render:()=>(0,y.jsx)(x,{onClose:a}),onDismiss:a}):null}function x(e){const{onClose:t}=e,n={menuType:r().gu.Modal,title:(0,y.jsx)(a().sA,{defaultMessage:"Page Updates",id:"pageUpdatesModal.mobileMenu.title"}),right:(0,y.jsx)(c().DoneMenuText,{}),onClickRight:t};return(0,y.jsx)(d().A,{...n,children:(0,y.jsx)(b,{})})}},288420:(e,t,n)=>{n.d(t,{W:()=>s});n(296540);var i=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"2.62 2.06 14.57 16.51",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"m16.949 3.47-.618.619-1.164-1.165.625-.624a.823.823 0 0 1 1.157 0 .823.823 0 0 1 0 1.157zm-8.526 8.527 7.153-7.153-1.165-1.165-7.16 7.147a1.1 1.1 0 0 0-.247.414l-.303.978c-.055.206.137.4.33.33l.978-.303a.9.9 0 0 0 .414-.248"}),(0,i.jsx)("path",{d:"M9.578 5.438q.617 0 1.197.126l1.051-1.004a6.9 6.9 0 0 0-2.248-.372h-.35a6.603 6.603 0 0 0-6.603 6.602v.257c0 1.254.371 2.48 1.067 3.524a9.25 9.25 0 0 0 5.455 3.844l.514.129a.625.625 0 1 0 .303-1.213l-.513-.128a8 8 0 0 1-4.719-3.325 5.1 5.1 0 0 1-.857-2.831v-.257a5.353 5.353 0 0 1 5.353-5.352z"}),(0,i.jsx)("path",{d:"M12.444 15.748a6.47 6.47 0 0 1-5.471-1.878l1.387-.433a5.22 5.22 0 0 0 3.92 1.072l.08-.01a3.37 3.37 0 0 0 2.921-3.345 5.7 5.7 0 0 0-1.011-3.248l.904-.885a6.94 6.94 0 0 1 1.357 4.133 4.624 4.624 0 0 1-4.006 4.584z"})]})},s=(0,n(340498).wt)("pencilAndOutline",o)},308228:(e,t,n)=>{n.d(t,{W:()=>r,m:()=>a});n(296540);var i=()=>n(69708),o=n(474848);const s=(0,i().YK)({addingGuestsToDefaultTeam:{id:"getTeamRoleDisabled.addingGuestsToDefaultTeam",defaultMessage:"Default teams canâ€™t contain teamspace guests"},addingGuestsAsNonOwner:{id:"getTeamRoleDisabled.addingGuestsAsNonOwner",defaultMessage:"You must be a workspace owner and a teamspace owner to add teamspace guests"},makingAGroupATeamGuest:{id:"getTeamRoleDisabled.makingAGroupATeamGuest",defaultMessage:"Groups canâ€™t be teamspace guests"},upgradingAnOwnerAsNonOwner:{id:"getTeamRoleDisabled.upgradingAnOwnerAsNonOwner",defaultMessage:"You must be a teamspace owner to add another owner"},downgradeLastUserOwner:{id:"getTeamRoleDisabled.downgradeLastUserOwner",defaultMessage:"Add another teamspace owner to downgrade yourself to member"},downgradeToOwnerAsNonOwner:{id:"getTeamRoleDisabled.downgradeToOwnerAsNonOwner",defaultMessage:"You must be a teamspace owner to downgrade other teamspace owners"},removeLastUserOwner:{id:"getTeamRoleDisabled.removeLastUserOwner",defaultMessage:"Add another teamspace owner to leave the team"},removeLastGroupOwner:{id:"getTeamRoleDisabled.removeLastGroupOwner",defaultMessage:"Add another teamspace owner to remove this group"},downgradeLastMakingAGroupAnOwner:{id:"getTeamRoleDisabled.downgradeLastMakingAGroupAnOwner",defaultMessage:"Add another teamspace owner to make this group a member"},downgradingAMemberToAGuest:{id:"getTeamRoleDisabled.downgradingAMemberToAGuest",defaultMessage:"To change this user to a teamspace guest, first remove them from the workspace."},removingMemberFromDefaultTeam:{id:"getTeamRoleDisabled.removingMemberFromDefaultTeam",defaultMessage:"Members cannot be removed from a default teamspace."},removingMemberAsMember:{id:"getTeamRoleDisabled.removingMemberTeam.noPermission",defaultMessage:"You must be a team owner to remove other team members in this teamspace."},changingTeamRoleAsNonTeamOwner:{id:"getTeamRoleDisabled.changingTeamRoleAsNonMember",defaultMessage:"You must be a teamspace owner to adjust teamspace membership."},addingRestrictedMemberAsOwner:{id:"getTeamRoleDisabled.addingRestrictedMemberAsOwner",defaultMessage:"Restricted members cannot be added as teamspace owners."}});function a({isCurrentUserTeamOwner:e,role:t,isDefaultTeam:n,userIsSpaceAdmin:i,isRoleForRestrictedMember:o}){return e||"owner"!==t?n&&"team_level_guest"===t?l(s.addingGuestsToDefaultTeam):o&&"owner"===t?l(s.addingRestrictedMemberAsOwner):!i&&"team_level_guest"===t||!e&&"team_level_guest"===t?l(s.addingGuestsAsNonOwner):{isDisabled:!1,disabledReason:void 0}:l(s.upgradingAnOwnerAsNonOwner)}function r({isCurrentUserTeamOwner:e,role:t,isDefaultTeam:n,userIsSpaceAdmin:i,userIsEnterpriseWorkspaceOwner:o,originalTeamMemberInfo:r,onlyHasOneOwner:d,isUnowned:c,isMemberCurrentUser:u,canCurrentUserAddTeamMembers:p,isRoleForRestrictedMember:g}){if("team_level_guest"===t&&"team_level_guest"!==r.type)return l(s.downgradingAMemberToAGuest);const m="owner"!==t&&"owner"===r.type;if(m&&!e)return l(s.downgradeToOwnerAsNonOwner);if(m&&d)return l("none"===t?"group"===r.entity_type?s.removeLastGroupOwner:s.removeLastUserOwner:"group"===r.entity_type?s.downgradeLastMakingAGroupAnOwner:s.downgradeLastUserOwner);if("none"===t&&n&&"user"===r.entity_type)return l(s.removingMemberFromDefaultTeam);return"group"===r.entity_type&&"team_level_guest"===t?l(s.makingAGroupATeamGuest):"owner"===t&&i&&"user"===r.entity_type&&c&&u||"owner"===t&&o&&u?{isDisabled:!1,disabledReason:void 0}:"none"===t?e||p&&"member"===r.type?{isDisabled:!1,disabledReason:void 0}:l(s.removingMemberAsMember):e?a({isCurrentUserTeamOwner:e,role:t,isDefaultTeam:n,userIsSpaceAdmin:i,isRoleForRestrictedMember:g}):l(s.changingTeamRoleAsNonTeamOwner)}function l(e){return{isDisabled:!0,disabledReason:(0,o.jsx)(i().sA,{...e})}}},313633:(e,t,n)=>{n.d(t,{A:()=>r});n(296540);var i=()=>n(401497),o=()=>n(718827),s=()=>n(66913),a=n(474848);function r(e){const{top:t,right:n,onClick:r}=e,l=(0,i().IS)((e=>({buttonBackground:{position:"absolute",top:t??12,insetInlineEnd:n??12,width:22,height:22,borderRadius:"100%",background:e.background.elevated},button:{width:"100%",height:"100%",borderRadius:"100%",display:"flex",justifyContent:"center",alignItems:"center",background:"transparent"},buttonHovered:{background:e.buttonHoveredBackground},icon:{width:14,fill:e.icon.secondary}})),[t,n]);return(0,a.jsx)("div",{style:l.buttonBackground,children:(0,a.jsx)(o().Ay,{style:l.button,hoveredStyle:l.buttonHovered,onClick:r,children:(0,s().V)(l.icon)})})}},315841:(e,t,n)=>{n.d(t,{Js:()=>a,Ns:()=>o,d:()=>s});var i=()=>n(645873);const o={publishSite:new(i().O2)("PublishSite",(async()=>await Promise.all([n.e(25700),n.e(35658),n.e(16345)]).then(n.bind(n,691385)))),publishedSiteSettings:new(i().O2)("PublishedSiteSettings",(async()=>await Promise.all([n.e(25700),n.e(77729),n.e(39301)]).then(n.bind(n,936897))))},s=(0,i()._h)(o.publishedSiteSettings,(e=>e.default)),a=(0,i()._h)(o.publishSite,(e=>e.default))},317655:(e,t,n)=>{n.r(t),n.d(t,{PermissionsInviteWithModal:()=>Se});var i=n(296540),o=()=>n(484714),s=()=>n(56366),a=()=>n(401497),r=()=>n(160432),l=()=>n(148307),d=()=>n(84262),c=()=>n(69708),u=()=>n(980427),p=()=>n(134696),g=()=>n(701763),m=()=>n(542056),f=()=>n(743260),h=()=>n(299545),v=()=>n(152197),y=()=>n(852507),b=()=>n(347063),S=()=>n(38337),x=()=>n(224701),A=()=>n(106196),M=()=>n(21140),w=n(474848);function j(e){const{permissionsInviteStore:t,onInviteSubmit:n,onClose:o}=e,[a,l]=(0,i.useState)(!1),d=(0,s().K8)((()=>t.state.inviteTargets.length>0),[t]),u=(0,i.useCallback)((async()=>{l(!0);try{await n()}catch(e){}finally{l(!1)}}),[n]),p=(0,i.useCallback)((()=>{null==o||o(),t.reset()}),[t,o]);return(0,w.jsxs)(M().wt,{gap:8,children:[(0,w.jsx)(r().A,{colorPalette:"blue",onClick:u,disabled:!d||a,children:(0,w.jsx)(c().sA,{id:"spacePermissionsInviteFooter.submit.label",defaultMessage:"Send invite"})}),(0,w.jsx)(A().N,{buttonInfo:{buttonType:"secondary",label:(0,w.jsx)(c().sA,{id:"spacePermissionsInviteFooter.cancel.label",defaultMessage:"Cancel"}),onClick:p}})]})}const k=(0,n(340498).xh)("inviteMember",{default:{loader:()=>n.e(82292).then(n.bind(n,97835))},small:{loader:()=>n.e(82292).then(n.bind(n,779181))},fill:{loader:()=>n.e(82292).then(n.bind(n,489255))},fillSmall:{loader:()=>n.e(82292).then(n.bind(n,736414))}},["person","plus","add","include","join"]);function I({isBillable:e}){return(0,w.jsx)(b().YA,{iconAndTitle:(0,w.jsx)(b().ZQ,{iconGroup:k,title:(0,w.jsx)(c().sA,{id:"spacePermissionsInviteHeader.title",defaultMessage:"Add members"})}),description:e?(0,w.jsx)(c().sA,{id:"spacePermissionsInviteHeader.billedDescription",defaultMessage:"Type or paste in emails below, separated by commas. Your workspace will be billed by members."}):(0,w.jsx)(c().sA,{id:"spacePermissionsInviteHeader.freeDescription",defaultMessage:"Type or paste in emails below, separated by commas"})})}var C=()=>n(493552),T=()=>n(456328),_=()=>n(623580);function P(e){const t=(0,a().IS)((()=>({container:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:6,alignSelf:"stretch"}})),[]);return(0,w.jsxs)("div",{style:t.container,children:[(0,w.jsx)(C().D,{styleKey:"Caption/Medium",colorVariant:"secondary",children:(0,w.jsx)(c().sA,{id:"spacePermissionsInviteMessageSection.label",defaultMessage:"Message"})}),(0,w.jsx)(B,{...e})]})}function B(e){const{permissionsInviteStore:t}=e,n=(0,s().K8)((()=>t.state.emailMessage),[t]),o=(0,c().tz)().formatMessage({id:"shareMenu.spacePermissionsInviteMessageInput.placeholder",defaultMessage:"Add a note to your invite..."}),a=1e3,r=n.length/a>=.8,l=(0,T().BS)(n),d=r||l,u=(0,i.useCallback)((e=>{t.setState({...t.state,emailMessage:e.target.value})}),[t]);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(_().A,{textarea:!0,focusInitial:!1,placeholder:o,maxlength:a,value:n,onChange:u}),d?(0,w.jsx)(D,{messageLength:n.length,maxLength:a,shouldShowLengthWarning:r,shouldShowLinkWarning:l}):void 0]})}function D(e){const{shouldShowLengthWarning:t,shouldShowLinkWarning:n,messageLength:i,maxLength:o}=e;return(0,w.jsxs)(C().D,{styleKey:"Caption/Medium",colorVariant:"tertiary",children:[t?(0,w.jsx)(c().sA,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:i,maxCharacters:o}}):void 0,t&&n?" Â· ":void 0,n?(0,w.jsx)(c().sA,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"}):void 0]})}var R=()=>n(803960),E=()=>n(760217),L=()=>n(406699),O=()=>n(460292),N=()=>n(417392),F=()=>n(201651),U=()=>n(646736),z=()=>n(134217),K=()=>n(10984);function V(e){const{permissionsInviteStore:t}=e,n=(0,o().v3)(),r=(0,s().K8)((()=>{const e=(0,K().AI)();return(0,z().fk)(e)}),[]);(0,y().l)((()=>{r||t.setState({...t.state,inviteTargets:[],inviteRole:"member"})}));const l=(0,s().K8)((()=>t.state.inviteRole),[t]),d=(0,U().I_)(),u=(0,s().K8)((()=>null==d?void 0:d.getModel()),[d]),p=(0,i.useCallback)((e=>{m().lf({environment:n,newRole:e,permissionsInviteStore:t})}),[n,t]),g=(0,a().IS)((e=>({button:{width:"100%",margin:0,paddingTop:4,paddingBottom:4,border:`1px solid ${e.outlineButtonBorder}`},chevron:{width:12,marginInlineStart:3,marginInlineEnd:3,fill:e.icon.tertiary},icon:{alignSelf:"start",marginTop:0,fill:e.icon.secondary,height:18,width:18}})),[]);if(!u)return null;const f=(0,F().BL)({membershipType:l,isRemovable:!1,isCurrentUser:!1});return(0,w.jsx)(L().A,{popupType:N().nl.Popup,sameWidthAsOrigin:!0,originGap:8,render:e=>(0,w.jsx)(F().kW,{currentSpaceUser:u,targetUserId:void 0,isInvite:!0,currentType:l,parent:e,onChange:p,upgradeFrom:"sidebar_invite_people_button",from:"inviteMembersModal"}),renderOrigin:e=>(0,w.jsx)(E().A,{...e,right:(0,R().arrowChevronSingleDownIcon)(g.chevron),title:(0,w.jsx)(c().sA,{...f.label}),caption:(0,w.jsx)(c().sA,{...f.caption}),icon:(0,w.jsx)(O().Q,{colorPalette:"gray",colorVariant:"secondary",iconGroup:f.icon,variantName:"default"}),shouldWrapCaption:!0,buttonStyle:g.button,desktopIconStyle:g.icon,focused:!1})})}const q=function(e){const t=(0,a().IS)((e=>({container:{display:"flex",flexDirection:"column",width:"100%",gap:8}})),[]);return(0,w.jsxs)("div",{style:t.container,children:[(0,w.jsx)(C().D,{styleKey:"Caption/Medium",colorVariant:"secondary",children:(0,w.jsx)(c().sA,{id:"spacePermissionsInviteRoleSection.label",defaultMessage:"Select role"})}),(0,w.jsx)(V,{...e})]})};const W=function(e){const{onInviteClick:t,onClose:s,permissionsInviteStore:r,billingData:l}=e,d=(0,o().v3)();(0,y().l)((async()=>{await x().x(d)}));const c=(0,n(762433).Fq)(l),u=(0,i.useCallback)((()=>{r.setState({...r.state,inputFocus:"none"})}),[r]),p=(0,a().IS)((()=>({container:{width:460},body:{display:"flex",flexDirection:"column",gap:20,width:"100%"}})),[]);return(0,w.jsx)("div",{style:p.container,onClick:u,className:S().bFE,children:(0,w.jsx)(b().tf,{header:(0,w.jsx)(I,{isBillable:c}),footer:(0,w.jsx)(j,{onInviteSubmit:t,onClose:s,permissionsInviteStore:r}),children:(0,w.jsxs)("div",{style:p.body,children:[(0,w.jsx)(n(334013).A,{permissionsInviteStore:r}),(0,w.jsx)(q,{permissionsInviteStore:r}),(0,w.jsx)(P,{permissionsInviteStore:r})]})})})};var G=()=>n(618841),H=()=>n(406792),Y=()=>n(957599),$=()=>n(991249),Q=()=>n(324561),Z=()=>n(433876),J=()=>n(96689),X=()=>n(100622),ee=()=>n(496603),te=()=>n(232930),ne=()=>n(78846),ie=()=>n(148832),oe=()=>n(89924),se=()=>n(962036),ae=()=>n(347160),re=()=>n(654856),le=()=>n(897537);function de(e){const{store:t,permissionsInviteStore:r,membersOnly:l,upgradeButtonName:d,inviteOrigin:u,onInviteClick:p}=e,g=(0,o().v3)();(0,y().l)((async()=>{await x().x(g)}));const f=(0,s().K8)((()=>(0,h().Yu)(t)),[t]),v=(0,i.useCallback)((async()=>{await m().iS({environment:g,permissionsInviteStore:r,from:"share_menu"})}),[g,r]),b=(0,a().IS)((()=>({right:{color:X().Tj.blue}})),[]);return(0,w.jsxs)(n(404277).A,{menuType:n(722872).gu.Modal,title:f?(0,w.jsx)(c().sA,{id:"inviteUserModal.addMemberMenu.title",defaultMessage:"Add members"}):(0,w.jsx)(c().sA,{id:"inviteUserModal.invitePersonMenu.title",defaultMessage:"Invite a person"}),right:(0,w.jsx)("div",{style:b.right,children:(0,w.jsx)(c().sA,{id:"inviteUserModal.mobile.inviteButton.label",defaultMessage:"Invite"})}),left:(0,w.jsx)(n(45552).CancelMenuText,{}),onClickLeft:v,onClickRight:p,header:(0,w.jsx)(ce,{...e,inviteOrigin:u,onInviteClick:p}),className:S().bFE,children:[(0,w.jsx)(oe().A,{title:(0,w.jsx)(c().sA,{id:"inviteUserModal.permissionLevel.title",defaultMessage:"Permission level"}),children:(0,w.jsx)(ge,{store:t,upgradeButtonName:d,permissionsInviteStore:r})}),(0,w.jsx)("div",{children:(0,w.jsx)(ue,{store:t,permissionsInviteStore:r,membersOnly:l})}),(0,w.jsx)(pe,{})]})}function ce(e){const{store:t,onInviteClick:n,permissionsInviteStore:a,inviteOrigin:r}=e,l=(0,o().v3)(),d=(0,s().K8)((()=>{const e=a.state.inputFocus;return"invitee"===e||"invitee-popup-closed"===e}),[a]),c=(0,v().r)(),u=(0,Q().lh)({spaceId:c}),g=(0,i.useMemo)((()=>ee().sg((()=>{p().D2(l,{invite_flow_id:a.state.flowId,billingData:u,invite_origin:r})}),1e3)),[l,a,r,u]),f=(0,i.useCallback)((async e=>{g(),await m().Pp({environment:l,event:e,permissionsInviteStore:a})}),[g,l,a]),h=(0,i.useCallback)((e=>{m().St({targetToRemove:e,permissionsInviteStore:a})}),[a]);return(0,w.jsx)(re().A,{permissionsInviteStore:a,store:t,handleClickRemoveToken:h,handleInputChange:f,handleInputSubmit:n,origin:"share_modal",focus:d,handleFocus:()=>{}})}function ue(e){const{store:t,permissionsInviteStore:n,membersOnly:i}=e,o=(0,s().K8)((()=>(0,h()._p)(t)),[t]),a=(0,s().K8)((()=>t instanceof ie().B&&(0,ne().h)(t.getSpaceStore())),[t]);return(0,w.jsx)(le().A,{permissionsInviteStore:n,store:t,shouldShowGroups:o,sectionRenderLimit:10,membersOnly:i,guestsMustBeRequested:a})}function pe(){return(0,w.jsx)(oe().A,{topBorder:!0,disableDesktopPadding:!0,children:(0,w.jsx)(se().g,{title:(0,w.jsx)(c().sA,{id:"inviteUserModal.helpButton.caption",defaultMessage:"Learn how to invite people and set permissions"}),href:(0,te().x)("guides.invitePerson"),analyticsFrom:"invite_person"})})}function ge(e){const t=(0,o().v3)(),{store:n,upgradeButtonName:r,permissionsInviteStore:l}=e,{inviteRole:d,table:c}=(0,s().O$)(l),u=(0,s().K8)((()=>(0,h()._p)(n)?n.getType():void 0),[n]),p=(0,s().K8)((()=>(0,h().Yu)(n)&&!n.canAdmin()),[n]),g=(0,i.useCallback)((e=>{m().lf({environment:t,newRole:e,permissionsInviteStore:l})}),[t,l]),f=(0,a().IS)((()=>({button:{display:"flex",whiteSpace:"nowrap",height:26,color:X().Tj.uiGray}})),[]),v=(0,U().I_)(),y=(0,s().K8)((()=>null==v?void 0:v.getModel()),[v]);return d&&y?c===J().NX?(0,w.jsx)(F().VI,{currentSpaceUser:y,targetUserId:void 0,currentType:d,isInvite:!0,isMenuItem:!0,buttonStyle:f.button,from:"spaceSettings",upgradeFrom:r,onChange:g}):(0,w.jsx)(ae().Ay,{disabled:p,role:d,table:c,type:"user_permission",blockType:u,isInvite:!0,upgradeButtonName:r,buttonStyle:f.button,isMenuItem:!0,onChange:g}):null}const me=i.memo(de);var fe=()=>n(430102),he=()=>n(748868),ve=()=>n(103448);function ye(e){const{targetStore:t,spaceStore:r,origin:u,sudoModeStore:p,onInviteComplete:g,onInviteClick:y,onClose:b,permissionsInviteStore:S}=e,A=(0,o().v3)(),{isMobile:M}=A.device,j=(0,c().tz)(),k=(0,v().r)(),I=(0,Q().lh)({spaceId:k}),C=(0,s().K8)((()=>S.state.modalOpen),[S]),T=(0,n(249847).T)(),_=(0,n(329304)._X)({name:"members",spaceId:k,userId:T,amount:1}),P=e.analyticsFrom,B=(0,s().uB)(void 0,n(159026).Ay),D=(0,i.useCallback)(((e,t)=>{g?g(e,t):e||n(471995).D6({label:(0,w.jsx)(c().sA,{id:"SpacePermissionsInviteButton.handleOnInviteComplete.genericError",defaultMessage:"Invite failed to send"})})}),[g]),R=(0,i.useCallback)((async()=>{const e=H().default.DO_NOT_USE_markLegacy("share_menu.invite_user_lag");await m().kW({environment:A,targetStore:t,spaceStore:r,sudoModeStore:p,permissionsInviteStore:S,contextualInviteStore:B,onInviteClick:y,onInviteComplete:D,inviteOrigin:P,intl:j}),H().default.DO_NOT_USE_measureLegacy(e,{environment:A})}),[A,t,r,p,S,B,y,D,P,j]);(0,i.useEffect)((()=>{C&&!(0,n(534177).O9)(n(749240).subscriptionDataStoreInstance.state)&&x().x(A)}),[A,C]);const E=(0,s().K8)((()=>Boolean(t.canEditMembership())),[t]),L=(0,s().K8)((()=>E&&(0,h().Yu)(t)&&(0,d().nM)(_)),[E,t,_]),O=(0,s().K8)((()=>function({store:e,canEditMembership:t,showUpgrade:n,membersAvailability:i}){if(!t&&(0,h().Yu)(e))return(0,w.jsx)(c().sA,{id:"inviteUserButton.tooltip.adminsOnlyMessage",defaultMessage:"Only admins can add members."});if(!t)return(0,w.jsx)(c().sA,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."});if(n)return(0,w.jsx)(ve().A,{imageURL:l().A.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:(0,w.jsx)(c().sA,{defaultMessage:"Members are teammates you invite to your workspace. They can access and add pages for all members to see, or be added to pages with permissions for private collaboration.",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.caption"}),title:(0,w.jsx)(c().sA,{defaultMessage:"Upgrade to add members",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.title"})});if(t&&!(0,d().nM)(i))return(0,w.jsx)(c().sA,{id:"inviteUserButton.tooltip.noUpsellAvailable",defaultMessage:"Adding members is not available."});return null}({store:t,canEditMembership:E,showUpgrade:L,membersAvailability:_})),[E,L,t,_]),N=(0,i.useCallback)((()=>async function(e,t,n,i,o){const s=await(0,f().iQ)({environment:e,permissionsInviteStoreState:n.state,from:i??((0,h().Yu)(t)?"space_share_modal":"page_share_modal")});s||(null==o||o(),n.reset())}(A,t,S,e.analyticsFrom,b)),[A,t,S,e.analyticsFrom,b]),F=(0,i.useCallback)((()=>I?M?(0,w.jsx)(me,{store:t,upgradeButtonName:e.upgradeButtonName,membersOnly:e.membersOnly,onInviteClick:R,inviteOrigin:P,permissionsInviteStore:S,billingData:I}):(0,n(406999).N2)(S)?(0,w.jsx)(W,{inviteOrigin:P,onInviteClick:R,billingData:I,permissionsInviteStore:S,onClose:b}):null:null),[M,t,e,R,b,P,S,I]),U=(0,a().IS)((()=>({modal:{display:"flex",alignSelf:"center",top:0}})),[]);return(0,h().Yu)(t)?(0,w.jsx)(Z().A,{open:C,onDismiss:N,renderContent:F,modalStyle:U.modal,origin:(0,w.jsx)(n(859428).A,{renderTooltip:()=>O,disableTooltip:E,render:n=>(0,w.jsx)(be,{tooltipEvents:n,actionEnabled:E,showUpgrade:L,buttonInner:u,membersAvailability:_,store:t,permissionsInviteStore:S,isSubscribed:e.isSubscribed,upgradeButtonName:e.upgradeButtonName,shouldGrow:e.shouldGrow,onInviteClick:e.onInviteClick,onInviteComplete:e.onInviteComplete,buttonStyle:e.buttonStyle,enableInviteDropdown:e.enableInviteDropdown,...n})})}):(0,w.jsx)(Z().A,{open:C,onDismiss:N,renderContent:F,origin:null})}function be({tooltipEvents:e,showUpgrade:t,actionEnabled:n,store:l,isSubscribed:m,enableInviteDropdown:h,onInviteClick:v,onInviteComplete:y,upgradeButtonName:b,onUpgradeButtonClick:S,shouldGrow:x,buttonStyle:A,permissionsInviteStore:M,buttonInner:j,membersAvailability:k}){const I=(0,o().v3)(),{forceImportDropdownOpen:C,shouldAddMembers:T}=(0,s().K8)((()=>Y().F.getState()),[]),_=(0,a().IS)((()=>({dropdownButton:{flex:x?1:0,...A},importListButton:{height:28,borderRadius:4,border:void 0,width:"100%"},importListButtonContainer:{padding:"0 6px",alignItems:"center"}})),[A,x]),P=(0,i.useCallback)((()=>function(e,t,n,i){(0,f().LH)({environment:e,permissionsInviteStore:i,store:t,renderInShareModal:!1,isSubscribed:n}),g().CW(e,{type:"invite"}),p().vX(e,{type:"invite",from:"settings_modal"})}(I,l,m,M)),[I,l,m,M]),B=(0,i.useCallback)((()=>(0,d().Pd)(k)&&t?function(e,t,n,i){$().K(t,{from:e,upsell:n}),i&&i(),g().CW(t,{type:"upgrade"})}(b,I,k.upsell,S):P()),[I,P,S,t,b,k]);if(j)return(0,w.jsx)("div",{onClick:P,children:j});const D=(0,G().A)({onInviteClick:v,onInviteComplete:y,buttonStyle:_.importListButton,buttonContainerStyle:_.importListButtonContainer,shouldAddMembers:T}),R=!n||(0,d().Pd)(k)&&!(0,d().nM)(k);return h?(0,w.jsx)(L().A,{open:!!C||void 0,popupType:N().nl.Popup,alignmentToOrigin:"end",placementToOrigin:"bottom",render:()=>(0,w.jsx)(he().A,{importListItems:D}),originGap:12,onClose:()=>{C&&Y().F.closeImportDropdown()},renderOrigin:e=>(0,w.jsx)(fe().I,{disabled:R,style:_.dropdownButton,title:(0,w.jsx)(c().sA,{id:"inviteUserButton.addMemberLabel.dropdown",defaultMessage:"Add members"}),onClick:B,onDropdownClick:()=>{e.onClick(),u().V(I,{source:"add_members_button"})},color:"blue"})}):(0,w.jsx)(r().A,{colorPalette:"blue",size:"lg",onClick:B,disabled:R,style:_.dropdownButton,...e,children:(0,w.jsx)(c().sA,{id:"inviteUserButton.addMemberLabel",defaultMessage:"Add members"})})}const Se=i.memo(ye)},327994:(e,t,n)=>{n.d(t,{j:()=>s,u:()=>o});var i=()=>n(59364);const o=i().Z,s=i().S},340708:(e,t,n)=>{n.r(t),n.d(t,{SidebarTeamModal:()=>Dn});n(581454);var i=n(296540),o=()=>n(484714),s=()=>n(56366),a=()=>n(401497),r=()=>n(611648),l=()=>n(699143),d=()=>n(998531),c=()=>n(970236),u=()=>n(493552),p=()=>n(69708),g=()=>n(496603),m=()=>n(534177),f=()=>n(284371),h=()=>n(946141),v=()=>n(231297),y=()=>n(38337),b=()=>n(37433),S=()=>n(900681),x=()=>n(249847),A=()=>n(632709),M=()=>n(765957),w=()=>n(848237),j=()=>n(341974),k=()=>n(345578),I=(n(944114),()=>n(406094)),C=()=>n(505412),T=()=>n(297872),_=()=>n(623580),P=()=>n(972435),B=()=>n(605685),D=()=>n(43450);function R(e){return!(0,D().R)(e)}var E=()=>n(976519),L=()=>n(211825),O=()=>n(418426),N=()=>n(655784),F=()=>n(235741),U=()=>n(802790),z=()=>n(144707),K=()=>n(47373),V=(n(898992),n(354520),()=>n(278238)),q=()=>n(273900),W=()=>n(68263),G=()=>n(854150),H=()=>n(347160),Y=()=>n(213525),$=()=>n(898808),Q=()=>n(859428),Z=()=>n(125565),J=()=>n(265665),X=n(474848);function ee(e){const{icon:t,label:n,name:i,tag:o,style:s}=e,r=(0,a().IS)((e=>({container:{display:"flex",flexDirection:"row",alignItems:"center",gap:10,...s},labelContainer:{display:"flex",flexDirection:"column",...f().RC,marginInlineStart:5},name:{minWidth:30},nameContainer:{display:"flex",flexDirection:"row",alignItems:"center"}})),[s]);return(0,X.jsxs)("div",{style:r.container,children:[t,(0,X.jsxs)("div",{style:r.labelContainer,children:[(0,X.jsxs)("div",{style:r.nameContainer,children:[(0,X.jsx)(J().j,{style:r.name,children:i}),o]}),n?(0,X.jsx)(Z().A,{isSmall:!0,isSecondaryColor:!1,isMultiline:!0,children:(0,X.jsx)(J().j,{children:n})}):void 0]})]})}function te(e){const{iconComponent:t,label:n,name:i,permissionRoleSelectComponent:o,tag:s,tooltip:r,style:l}=e,d=(0,a().IS)((e=>({permissionRow:{display:"flex",flexDirection:"row",fontSize:14,width:"100%",minHeight:36,justifyContent:"space-between",alignItems:"center",...l}})),[l]);return(0,X.jsxs)("div",{style:d.permissionRow,children:[(0,X.jsx)(ee,{icon:t,name:i,tag:s,label:n,style:{minWidth:200,marginInlineEnd:6}}),(0,X.jsx)(Q().A,{textWrap:!0,style:{width:210},disableTooltip:!r,placement:"left",renderTooltip:()=>r,render:e=>(0,X.jsx)("span",{...e,children:o})})]})}const ne=12,ie=20;function oe(e){return(0,X.jsxs)(l().Y1,{gap:10,children:[(0,X.jsx)(u().D,{styleKey:"Body/Semibold",colorVariant:"primary",children:e.title}),(0,X.jsx)(se,{...e})]})}function se({rows:e,hideDividers:t=!1}){const n=(0,a().IS)((e=>({list:{listStyle:"none",padding:0,margin:0},listItem:{paddingTop:ne,paddingBottom:ne}})),[]);return(0,X.jsx)("ul",{style:n.list,children:e.map(((e,o)=>(0,X.jsxs)(i.Fragment,{children:[!t&&o>0?(0,X.jsx)(U().A,{size:1}):void 0,(0,X.jsx)("li",{style:n.listItem,children:e},o)]},o)))})}function ae(e){const{teamStore:t}=e,n=(0,o().v3)(),i=(0,p().tz)(),{teamGuestPermissionItem:r,teamPermissions:l}=(0,s().K8)((()=>({teamGuestPermissionItem:t.getTeamGuestsPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),d=R(t),c=(0,s().K8)((()=>[{role:"editor",disabledInfo:{isDisabled:!0,disabledMessage:i.formatMessage({id:"teamPermissionsSettings.teamspace.guest.disabledPermissionitem.description",defaultMessage:"Teamspace guests can't have full access."})}},{role:"read_and_write",disabledInfo:void 0},{role:"comment_only",disabledInfo:void 0},{role:"reader",disabledInfo:void 0}]),[i]),u=(0,a().IS)((e=>({button:{fontSize:12.5,marginInlineEnd:0,color:e.text.secondary}})),[]),g=r&&(0,X.jsx)(H().Ay,{role:r.role,table:G().yK,type:"explicit_team_guest_permission",upgradeButtonName:"team_permission_item",disabled:d,buttonStyle:u.button,availableRoleItems:c,onChange:async e=>{if(l.filter((t=>((0,W().B2)(t)||(0,W().Ds)(t))&&(0,q().dI)(e,t.role))).length>0){if(!(await(0,Y().fT)()))return}v().createAndCommit({userAction:"TeamGuestsPermissionRow.permissionComponent",environment:n,canUndo:!0,perform:i=>{w().HU({environment:n,teamStore:t,newRole:e,transaction:i,permissionsToClear:[]})}})}}),m=(0,s().K8)((()=>t.getName()),[t]),f=(0,s().K8)((()=>t.getIcon()),[t]),h=f&&V().T8(f.icon)?V().VA(f.icon):"gray",y=f?{...f,icon:`/icons/user-circle_${h}.svg`}:void 0,b=(0,X.jsx)($().x,{disabled:!0,store:t,size:ie,icon:y});return g?(0,X.jsx)(te,{permissionRoleSelectComponent:g,iconComponent:b,name:re(m)}):null}function re(e){return e?(0,X.jsx)(p().sA,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,X.jsx)(p().sA,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessWithoutTeamspaceName"})}n(672577);function le(e){const{teamStore:t}=e,n=(0,o().v3)(),i=(0,a().DP)(),r=(0,p().tz)(),{teamPermissionItem:l,teamPermissions:d}=(0,s().K8)((()=>({teamPermissionItem:t.getTeamPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),c=R(t),u=(0,s().K8)((()=>{var e;const n=null===(e=t.getPermissionItems())||void 0===e?void 0:e.find((e=>"space_permission"===e.type)),i=r.formatMessage({id:"teamPermissionsSettings.teamspace.disabledPermissionitem.description",defaultMessage:"Teamspace members can't have lower permissions than workspace members"});function o(e){return n&&e!==n.role&&(0,q().$q)(e,n.role)===n.role&&!t.isDefault()?{role:e,disabledInfo:{isDisabled:!0,disabledMessage:i}}:{role:e,disabledInfo:void 0}}return[o("editor"),o("read_and_write"),o("comment_only"),o("reader")]}),[r,t]),g=l&&(0,X.jsx)(H().Ay,{role:l.role,table:G().yK,type:(0,W().gl)(l)?"explicit_team_permission":"team_permission",upgradeButtonName:"team_permission_item",disabled:c,buttonStyle:{fontSize:12.5,marginInlineEnd:0,color:i.text.secondary},availableRoleItems:u,onChange:async e=>{const i=d.filter((t=>((0,W().B2)(t)||(0,W().Ds)(t))&&(0,q().dI)(e,t.role)));if(i.length>0){if(!(await(0,Y().fT)()))return}v().createAndCommit({userAction:"TeamMembersPermissionRow.permissionComponent",environment:n,canUndo:!0,perform:o=>{w().xp({environment:n,teamStore:t,newRole:e,transaction:o,permissionsToClear:i})}})}}),m=(0,s().K8)((()=>t.getName()),[t]),f=(0,X.jsx)($().x,{disabled:!0,store:t,size:ie});return(0,X.jsx)(te,{permissionRoleSelectComponent:g,iconComponent:f,name:de(m)})}function de(e){return e?(0,X.jsx)(p().sA,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,X.jsx)(p().sA,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutTeamspaceName"})}var ce=()=>n(798880),ue=()=>n(124749),pe=()=>n(870092),ge=()=>n(187820),me=()=>n(453697),fe=()=>n(87043);const he=ie,ve=16;function ye({ownerStores:e,teamStore:t,isSmall:n=!1}){const i=n?he:fe().Ev,o=n?10:ve,r=(0,a().IS)((e=>({container:{position:"relative",width:i,height:i},teamBadge:{position:"absolute",bottom:-5,insetInlineEnd:-3,background:e.background.elevated,padding:.75,borderRadius:"0.25em"}})),[i]),{teamName:l,teamIcon:d}=(0,s().K8)((()=>({teamName:t.getName(),teamIcon:t.getIcon()})),[t]),c=e=>(0,X.jsx)(ge().B6,{disabled:!0,title:l,icon:d,isEmptyPage:!1,size:e,iconRecordCategory:"teamspace"});return 0===e.length?c(i):(0,X.jsxs)("div",{style:r.container,children:[(0,X.jsx)(be,{isSmall:n,store:e[0]}),(0,X.jsx)("div",{style:r.teamBadge,children:c(o)})]})}function be({store:e,isSmall:t=!1,style:n={}}){const i=t?he:fe().Ev,o=(0,a().IS)((e=>({icon:{width:i,height:i,borderRadius:i,boxShadow:e.avatarBoxShadow,...n}})),[i,n]);return(0,X.jsx)("div",{style:o.icon,children:(0,X.jsx)(me().A,{avatarShouldShowShadow:!0,userStore:e,size:i})})}function Se(e){const{teamStore:t,teamOwnerIds:n}=e,i=(0,a().DP)(),o=(0,s().K8)((()=>t.getName()),[t]),r=(0,s().K8)((()=>t.getTeamOwnerPermission()),[t]),l=(0,ue().$)(),d=(0,s().K8)((()=>l?n.map((e=>pe().L.createChildStore(l,{table:ce().oo,id:e}))):[]),[l,n]);return(0,X.jsx)(te,{tooltip:(0,X.jsx)(p().sA,{id:"TeamOwnersPermissionRow.teamspaceOwnersRowTooltip",defaultMessage:"Teamspace owners have full access to teamspace pages by default"}),permissionRoleSelectComponent:(0,X.jsx)(H().Ay,{role:"editor",table:G().yK,type:r&&(0,W().nl)(r)?"explicit_team_owner_permission":"team_owner_permission",upgradeButtonName:"team_owner_permission_item",disabled:!0,buttonStyle:{fontSize:12.5,color:i.text.secondary,marginInlineEnd:0},availableRoleItems:[]}),iconComponent:(0,X.jsx)(ye,{teamStore:t,ownerStores:d,isSmall:!0}),name:xe(o)})}function xe(e){return e?(0,X.jsx)(p().sA,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleName",values:{teamName:e}}):(0,X.jsx)(p().sA,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleNameWithoutTeamName"})}var Ae=()=>n(449552);const Me=["none","reader","comment_only","read_and_write","editor"],we=["reader","comment_only","read_and_write"],je=["reader","comment_only","read_and_write","editor"],ke=["editor"];function Ie(e){const t=function({teamId:e,permissions:t}){var n,i;const o=(null===(n=t.find((e=>(0,W().Lg)(e))))||void 0===n?void 0:n.role)??"none",s=(null===(i=t.find((t=>(0,W().gl)(t)&&t.team_id===e)))||void 0===i?void 0:i.role)??o,a=t.find((e=>(0,W().un)(e)));return{spacePermission:{type:"space_permission",role:o},teamMemberPermission:{type:"explicit_team_permission",team_id:e,role:s},teamOwnerPermission:{type:"explicit_team_owner_permission",team_id:e,role:"editor"},...a&&{teamGuestPermission:{type:"explicit_team_guest_permission",team_id:e,role:a.role}}}}({teamId:e.id,permissions:e.permissions??[]}),{spacePermission:n,teamMemberPermission:i}=t,o={visibility:["team_members","space_members"],space_member_join_access:["invite_only","self_join"],invite_access:["team_members","team_owners"]},s={spacePermission:Te({roles:Me,currentRole:i.role}),teamGuestPermission:we,teamMemberPermission:Ce({roles:je,currentRole:n.role}),teamOwnerPermission:ke},{visibility:a,space_member_join_access:r}=e.settings;return"team_members"===a&&(o.space_member_join_access=["invite_only"],s.spacePermission=["none"]),"self_join"===r&&(o.visibility=["space_members"],o.invite_access=["team_members"],s.spacePermission=s.spacePermission.filter((e=>"none"!==e))),e.is_default&&(s.teamMemberPermission=[i.role],s.spacePermission=[i.role]),{settingsOptions:o,permissionItemRoleOptions:s,currentTeamPermissionItems:t}}function Ce({roles:e,currentRole:t}){return e.filter((e=>(0,q().Pr)(e,t)))}function Te({roles:e,currentRole:t}){return e.filter((e=>(0,q().Y1)(e,t)))}var _e=()=>n(579627),Pe=()=>n(665381);function Be(e){const{teamStore:t}=e,n=(0,o().v3)(),i=(0,s().O$)(M().AppStoreSidebarSpaceStore),{iconComponent:a,spaceName:r}=(0,s().K8)((()=>{if(!i)return{iconComponent:void 0,spaceName:void 0};const e=(0,Pe().G)(n,i);return{iconComponent:(0,X.jsx)($().x,{disabled:!0,store:i,size:ie}),spaceName:e}}),[i,n]);return(0,X.jsx)(te,{permissionRoleSelectComponent:(0,X.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:(0,X.jsx)(Re,{teamStore:t})}),iconComponent:a,name:De(r)})}function De(e){return e?(0,X.jsx)(p().sA,{defaultMessage:"Everyone else in {spaceName}",id:"TeamMembersTopSection.permissionItem.defaultAccessSpaceName",values:{spaceName:e}}):(0,X.jsx)(p().sA,{defaultMessage:"Everyone else in the workspace",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutSpaceName"})}function Re(e){const{teamStore:t}=e,n=(0,o().v3)(),i=(0,a().DP)(),r=(0,s().K8)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),l=R(t),d=(0,s().K8)((()=>{const e=t.getSettingsStore().getValue();if(e)return Ie({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t],{useDeepEqual:!0});if(!d)return null;const c=d.permissionItemRoleOptions.spacePermission;if(1===c.length&&"none"===c[0])return(0,X.jsx)(Q().A,{renderTooltip:()=>(0,X.jsx)(p().sA,{id:"teamPermissionsSettings.privateTeam.noAccessTooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,X.jsxs)("div",{style:{display:"flex",alignItems:"center",maxWidth:170},...e,children:[(0,Ae().g)({width:14,height:14,fill:i.timelineRed,marginInlineEnd:4}),(0,X.jsx)("div",{style:{fontSize:12.5,color:i.timelineRed,marginInlineEnd:8},children:(0,X.jsx)(p().sA,{id:"teamPermissionsSettings.privateTeam.noAccessLabel",defaultMessage:"No access â€¢ Invite only"})})]})});{const e=g().Ul(c,(e=>-W().TE[e])).map((e=>({role:e})));return(0,X.jsx)(H().Ay,{role:r.role,table:G().yK,type:"space_permission",upgradeButtonName:"space_permission_item",disabled:l||1===c.length,buttonStyle:{fontSize:12.5,marginInlineEnd:0,color:i.text.secondary},availableRoleItems:e,onChange:e=>{const i={...r,role:e};v().createAndCommit({userAction:"TeamSpacePermissionRow.permissionComponent",environment:n,canUndo:!0,perform:e=>{_e().bo({environment:n,store:t,permissionItems:[i],transaction:e})}})}})}}function Ee({teamStore:e}){const t=(0,s().K8)((()=>e.isDefault()),[e]),n=(0,s().K8)((()=>e.getOwnerUserIds()),[e]),i=(0,s().K8)((()=>{const e=M().default.state.sidebarSpaceStore;if(!e)return!1;return!(null==e?void 0:e.getDisableTeamGuests())&&(!t&&(0,K().Qd)())}),[t]),o=(0,a().IS)((()=>({container:{marginInlineStart:15,marginInlineEnd:7,paddingBottom:4,paddingTop:4}})),[]);return(0,X.jsxs)("div",{style:o.container,children:[(0,X.jsx)(Se,{teamStore:e,teamOwnerIds:n},"0"),(0,X.jsx)(le,{teamStore:e},"1"),i?(0,X.jsx)(ae,{teamStore:e},"2"):void 0,t?void 0:(0,X.jsx)(Be,{teamStore:e},"3")]})}function Le({teamStore:e}){const t=(0,o().v3)(),n=(0,s().K8)((()=>e.getName()),[e]),r=(0,a().IS)((e=>({accessButton:{border:"none"},permissions:{border:`1px solid ${e.regularDividerColor}`,borderRadius:4},divider:{marginInlineStart:15,marginInlineEnd:15,width:"auto",borderColor:`${e.regularDividerColor}`}})),[]),l=(0,i.useCallback)(((i,o)=>{w().qH({environment:t,accessLevel:i,isDefault:o,store:e,teamName:n,from:"sidebar_team_modal"})}),[t,e,n]),d=(0,s().K8)((()=>e.getTeamAccessLevel()),[e]);return(0,X.jsxs)("div",{style:r.permissions,children:[(0,X.jsx)(z().u,{teamStore:e,currentAccessLevel:d,onChange:l,style:r.accessButton},"visibility"),(0,X.jsx)(U().A,{size:1,style:r.divider}),(0,X.jsx)(Ee,{teamStore:e},"permissions")]})}function Oe(e){const{title:t,caption:n,right:i,rightTooltip:o}=e,s=(0,a().IS)((e=>({root:{display:"flex",alignItems:"center",width:"100%"},title:{fontSize:14,marginInlineEnd:8,flexGrow:1},caption:{marginTop:1,width:"95%",marginBottom:5}})),[]);return(0,X.jsxs)("div",{style:s.root,children:[(0,X.jsxs)("div",{style:s.title,children:[t,n?(0,X.jsx)(u().D,{styleKey:"Caption/Regular",colorVariant:"secondary",style:s.caption,children:n}):void 0]}),(0,X.jsx)(Q().A,{placement:"top",alignment:"start",disableTooltip:!o,renderTooltip:()=>o,render:e=>(0,X.jsx)("span",{...e,children:i})})]})}const Ne=(0,p().YK)({noDescription:{id:"TeamSettingsGeneral.generalSettings.noDescription",defaultMessage:"No description"}});function Fe({teamStore:e}){const t=(0,a().IS)((()=>({container:{maxWidth:"none",marginInlineStart:4}})),[]);return(0,X.jsxs)(l().Y1,{gap:30,style:t.container,children:[(0,X.jsx)(Ue,{teamStore:e}),(0,X.jsx)(Le,{teamStore:e}),(0,X.jsx)(Ke,{teamStore:e})]})}function Ue({teamStore:e}){const t=(0,o().v3)(),n=R(e),[r,d]=(0,i.useState)(void 0),[c]=(0,s().K8)((()=>[e.getDescription()??""]),[e]),g=(0,a().IS)((()=>({input:{width:"100%"}})),[]);return(0,X.jsxs)(l().Y1,{gap:10,children:[(0,X.jsx)(u().D,{styleKey:"Caption/Regular",colorVariant:"secondary",children:(0,X.jsx)(p().sA,{id:"TeamSettingsGeneral.generalSettings.description.title",defaultMessage:"Description"})}),(0,X.jsx)(ze,{value:void 0===r?c:r,onBlurValue:n=>{(n=>{const i=null==n?void 0:n.trim();e&&c.trim()!==i&&v().createAndCommit({userAction:"TeamSettingsGeneral.updateDescription",environment:t,canUndo:!0,perform:t=>{w().n7({store:e,update:{description:i},transaction:t})}})})(n)},onChangeValue:e=>{d(e)},disabled:n,placeholder:P().A.formatMessage(Ne.noDescription),textarea:!0,autosize:!0,inputStyle:g.input,maxlength:C().z})]})}function ze(e){const{onBlurValue:t,onChangeValue:n,...o}=e,[s,a]=(0,i.useState)(!1);return(0,X.jsx)(T().A,{capture:s,render:e=>(0,X.jsx)(_().A,{...o,onFocus:e=>{a(!0)},onBlur:e=>{a(!1),t(e.target.value)},onChange:e=>{null==n||n(e.target.value)},overrideDefaultWidth:!0,...e})})}function Ke({teamStore:e}){const[t,n]=(0,s().K8)((()=>[e.getName(),e.isArchived()]),[e]),i=(0,D().R)(e),o=(0,L().G)(e);if(void 0===t||!o)return null;const a=[(0,X.jsx)(Ve,{teamStore:e},"leave")];return i&&(n?a.push((0,X.jsx)(qe,{teamStore:e,teamName:t},"restore")):a.push((0,X.jsx)(We,{teamStore:e},"archive"))),(0,X.jsx)(oe,{title:(0,X.jsx)(p().sA,{id:"sidebarTeamModalSettingsScreen.manageTeamspace.title",defaultMessage:"Manage teamspace"}),rows:a,hideDividers:!0})}function Ve({teamStore:e}){const t=(0,D().R)(e),n=(0,o().v3)(),s=(0,O().$)(e),a=(0,i.useCallback)((async()=>{await w().JC({environment:n,teamStore:e,from:"sidebar_team_modal",userGroupsInTeam:s})}),[n,e,s]),r=(0,X.jsx)(p().sA,{id:"teamJoinLeaveButton.leaveTeam.enabledTooltip",defaultMessage:"Click to leave teamspace"}),l=(0,N().v)({teamStore:e}),d=Boolean(l),c=d?l:r;return(0,X.jsx)(Oe,{title:(0,X.jsx)(p().sA,{id:"teamBrowser.teamCard.button.leaveTeam",defaultMessage:"Leave teamspace"}),caption:(0,X.jsx)(p().sA,{id:"teamBrowser.teamCard.button.leaveTeamDescription",defaultMessage:"Removes teamspace from your sidebar"}),rightTooltip:c,right:(0,X.jsx)(I().A,{onClick:a,disabled:d,disabledFeedback:d,colorPalette:t?void 0:"red",children:(0,X.jsx)(u().D,{colorPalette:t?void 0:"red",children:(0,X.jsx)(p().sA,{id:"teamBrowser.teamCard.button.leaveTeam",defaultMessage:"Leave teamspace"})})})})}function qe(e){const t=(0,o().v3)(),n=(0,s().K8)((()=>(0,b().mN)(e.teamStore)),[e.teamStore]);return(0,X.jsx)(Oe,{title:(0,X.jsx)(p().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamButton",defaultMessage:"Restore teamspace"}),caption:(0,X.jsx)(p().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamCaption",defaultMessage:"Restoring this teamspace will add it to the sidebar for all teamspace members that were previously added."}),right:(0,X.jsx)(I().A,{onClick:async()=>await(async({teamStore:e,teamName:n})=>{await w().Q8({environment:t,teamStore:e,teamName:n,from:"sidebar_team_modal"})})({teamName:e.teamName,teamStore:e.teamStore}),disabled:!n,children:(0,X.jsx)(p().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamButton",defaultMessage:"Restore teamspace"})})})}function We(e){const{teamStore:t}=e,n=(0,o().v3)(),i=(0,E().q)(t.id),s=(0,B().c)(),a=i&&!s.canArchive;return(0,X.jsx)(Oe,{title:(0,X.jsx)(p().sA,{id:"teamSettingsSecurity.dangerZone.archiveTeamButton",defaultMessage:"Archive teamspace"}),caption:(0,X.jsx)(p().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.archiveTeamDescription",defaultMessage:"Removes teamspace from the sidebar for all members"}),rightTooltip:a?(0,F().P)(s):void 0,right:(0,X.jsx)(I().A,{colorPalette:"red",disabled:a,disabledFeedback:a,onClick:async()=>{a||await w().mm({environment:n,teamStore:t,from:"sidebar_team_modal"})},children:(0,X.jsx)(u().D,{colorPalette:"red",children:(0,X.jsx)(p().sA,{id:"teamSettingsSecurity.dangerZone.archiveTeamButton",defaultMessage:"Archive teamspace"})})})})}var Ge=()=>n(252291),He=()=>n(160432),Ye=()=>n(344417),$e=()=>n(986863),Qe=()=>n(205618),Ze=()=>n(931956);function Je({teamStore:e}){const t=(0,p().tz)(),n=(0,s().K8)((()=>A().A.state.memberFilterQuery),[]),i=(0,s().uB)(void 0,Qe().A),o=(0,Ze().X)(e);return(0,X.jsxs)(l().Y1,{gap:6,direction:"horizontal",children:[(0,X.jsx)(_().A,{placeholder:t.formatMessage({id:"teamPermissionsInviteWithModal.filterMembersInput.placeholder",defaultMessage:"Search members"}),value:n,onChange:e=>{A().A.setState({...A().A.state,memberFilterQuery:e.target.value,limitMembers:!0})},left:(0,X.jsx)(Ge().I,{icon:Ye().u,colorVariant:"secondary",size:"sm",weight:"bold"}),showClearButton:!0}),(0,X.jsx)($e().u,{store:e,permissionsInviteStore:i,origin:(0,X.jsx)(Q().A,{placement:"top",alignment:"end",textWrap:!0,renderTooltip:()=>o?(0,X.jsx)(p().sA,{id:"teamPermissionsInviteWithModal.addMembers.tooltip",defaultMessage:"Add members and groups"}):(0,X.jsx)(p().sA,{id:"teamPermissionsInviteWithModal.addMembersNoPermissions.tooltip",defaultMessage:"You do not have permissions to add members to this teamspace"}),render:e=>(0,X.jsx)(He().A,{colorPalette:"blue",disabled:!o,size:"lg",onClick:()=>{i.setState({...i.state,modalOpen:!0})},...e,children:(0,X.jsx)(p().sA,{id:"teamPermissionsInviteWithModal.openModal",defaultMessage:"Add members"})})})})]})}var Xe=()=>n(98126),et=()=>n(442672),tt=()=>n(646736),nt=()=>n(21735),it=()=>n(134217),ot=()=>n(749240),st=(n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),()=>n(848538)),at=()=>n(468006),rt=()=>n(763824),lt=()=>n(88061),dt=()=>n(605402),ct=()=>n(576737);const ut=["owner","member","team_level_guest"],pt=["group","user"];class gt extends(()=>n(461924))().o{constructor({teamStore:e,currentUserStore:t,environment:i,members:o,initialQuery:s,initialSort:a,intl:r,canAddMembers:l,shouldUseEdgeCache:d,limit:c}){super(void 0),this.teamStore=void 0,this.environment=void 0,this.query=void 0,this.intl=void 0,this.canAddMembers=void 0,this.limit=void 0,this.currentPage=0,this.filteredAndSortedMembers=[],this.membersToAdd=[],this.innerListSource=void 0,this.currentUserStore=void 0,this.isLoadingMore=!1,this.isRefreshing=!1,this.teamStore=e,this.environment=i,this.query=s,this.sort=a,this.intl=r,this.canAddMembers=l,this.limit=c??20,this.currentUserStore=t;const u=st().v1.filter((e=>"restricted_member"!==e));e.isDefault()&&(this.innerListSource=d?new(n(585428).e)({users:[],environment:this.environment,spaceId:this.teamStore.getSpaceId()??"",initialMembershipFilter:u,initialQuery:this.query,initialSort:{field:"name_normalized",direction:"asc"},limit:this.limit}):new(ct().z)({users:o,initialMembershipFilter:u,initialSort:{field:"name_normalized",direction:"asc"},initialQuery:this.query,limit:this.limit})),this.refresh()}async applySearch(e){return this.query&&0!==this.query.length?(await(0,rt().lX)(e,25,(async e=>{if("user"===e.entity_type){const t=this.currentUserStore?pe().L.createChildStore(this.currentUserStore,{table:ce().oo,id:e.user_id}):void 0;await(null==t?void 0:t.load())}})),(0,n(778078).Ay)(this.query,e,(e=>{if("user"===e.entity_type){const t=this.currentUserStore?pe().L.createChildStore(this.currentUserStore,{table:ce().oo,id:e.user_id}):void 0;return[(null==t?void 0:t.getName())??"",(null==t?void 0:t.getEmail())??""].filter(Boolean).join(" ")}{var t;const n=null===(t=dt().A.state.permissionGroupsAndMemberCounts.find((t=>t.group.group_id===e.group_id)))||void 0===t?void 0:t.group;return(null==n?void 0:n.getName())??""}}),{minThreshold:1e3})):e}async applySort(e){return this.sort?"name"===this.sort.column?(await(0,rt().lX)(e,25,(async e=>{if("user"===e.entity_type){const t=this.currentUserStore?pe().L.createChildStore(this.currentUserStore,{table:ce().oo,id:e.user_id}):void 0;await(null==t?void 0:t.load())}})),e.sort(((e,t)=>{var n;const i=mt({member:e,parentStore:this.currentUserStore})??"",o=mt({member:t,parentStore:this.currentUserStore})??"";if(i===o)return 0;const s=i<o?-1:1;return null!==(n=this.sort)&&void 0!==n&&n.sortedAscending?s:-s}))):"role"===this.sort.column?e.sort(((e,t)=>{const n=e.type,i=t.type,o=ut.indexOf(n)-ut.indexOf(i);var s;if(0!==o)return null!==(s=this.sort)&&void 0!==s&&s.sortedAscending?-o:o;const a=e.entity_type,r=t.entity_type,l=pt.indexOf(a)-pt.indexOf(r);return 0!==l?l:0})):void(0,m().HB)(this.sort.column):e}async getMembersToAdd(){if(0===this.query.length||!this.canAddMembers)return[];let e=[];this.teamStore.isDefault()||(e=await lt().searchSpaceUsers({environment:this.environment,query:this.query,membersOnly:!0,limit:5,shouldUseEdgeCacheRollout:!0}));const t=lt().searchSpaceGroups({query:this.query,intl:this.intl}),n=[...e,...t],i=new Set(this.filteredAndSortedMembers.map(ft));return n.filter((e=>!i.has("group_id"in e?e.group_id:e.id))).slice(0,5)}async setSort(e){var t,n;if((null===(t=this.sort)||void 0===t?void 0:t.column)!==(null==e?void 0:e.column)||(null===(n=this.sort)||void 0===n?void 0:n.sortedAscending)!==(null==e?void 0:e.sortedAscending)){var i,o;if(this.currentPage=0,this.sort=e,"name"!==e.column||e.sortedAscending)await(null===(i=this.innerListSource)||void 0===i?void 0:i.setSort({field:"name_normalized",direction:"asc"}));else await(null===(o=this.innerListSource)||void 0===o?void 0:o.setSort({field:"name_normalized",direction:"desc"}));await this.refresh()}}async setQuery(e){var t;this.query!==e&&(this.currentPage=0,this.query=e,await(null===(t=this.innerListSource)||void 0===t?void 0:t.setQuery(e)),await this.refresh())}async fetch(){var e;const t=this.currentPage*this.limit,n=t+this.limit,i=[...this.filteredAndSortedMembers.map((e=>({type:"joined",value:e}))),...this.membersToAdd.map((e=>({type:"to_add",value:e})))],o=i.slice(t,n),s=Boolean(n<i.length||(null===(e=this.innerListSource)||void 0===e?void 0:e.rowsStore.state.hasMore));return Promise.resolve({rows:o,hasMore:s})}async loadMore(){if(!this.isLoadingMore){if(this.isLoadingMore=!0,this.currentPage++,this.teamStore.isDefault()){var e;await(null===(e=this.innerListSource)||void 0===e?void 0:e.loadMore());const t=this.getTeamMembershipForDefaultTeam(),n=await this.applySearch(t);this.filteredAndSortedMembers=await this.applySort(n),this.membersToAdd=await this.getMembersToAdd()}await super.loadMore(),this.isLoadingMore=!1}}async refresh(){if(this.isRefreshing)return;this.isRefreshing=!0,this.currentPage=0;let e=[];var t;this.teamStore.isDefault()?(await(null===(t=this.innerListSource)||void 0===t?void 0:t.refresh()),e=this.getTeamMembershipForDefaultTeam()):e=this.teamStore.getRawMembership();const n=await this.applySearch(e);this.filteredAndSortedMembers=await this.applySort(n),this.membersToAdd=await this.getMembersToAdd(),await super.refresh(),this.isRefreshing=!1}async setVisibleMembers(e){this.teamStore.isDefault()&&this.innerListSource instanceof ct().z&&await this.innerListSource.setUsers(e),await this.refresh()}getTeamMembershipForDefaultTeam(){var e;const t=(null===(e=this.innerListSource)||void 0===e||null===(e=e.rowsStore.state.rows)||void 0===e?void 0:e.map((e=>e.id)))??[],n=this.teamStore.getModel();if(!n)return[];const i=[],o=new Set;for(const a of(0,at().a1)(n))"team_level_guest"!==a.type&&i.push(a),"user"!==a.entity_type||"member"!==a.type&&"owner"!==a.type||o.add(a.user_id);const s=new Set(t);for(const a of s)o.has(a)||i.push({type:"member",entity_type:"user",user_id:a});return i}}function mt({member:e,parentStore:t}){let n;if("user"===e.entity_type){const i=t?pe().L.createChildStore(t,{table:ce().oo,id:e.user_id}):void 0;n=(null==i?void 0:i.getName())??(null==i?void 0:i.getEmail())}else{var i;n=null===(i=dt().A.state.permissionGroupsAndMemberCounts.find((t=>t.group.group_id===e.group_id)))||void 0===i||null===(i=i.group)||void 0===i?void 0:i.getName()}return function(e){return null==e?void 0:e.normalize("NFKD").toLowerCase().replace(/\p{Diacritic}/gu,"")}(n)}function ft(e){switch(e.entity_type){case"user":return e.user_id;case"group":return e.group_id;default:(0,m().HB)(e)}}var ht=()=>n(96689),vt=()=>n(695608),yt=()=>n(901791),bt=()=>n(173783),St=()=>n(313171),xt=()=>n(820635),At=(n(16280),()=>n(631524)),Mt=()=>n(668725),wt=()=>n(901389),jt=()=>n(760217),kt=()=>n(406699),It=()=>n(404277),Ct=()=>n(939740),Tt=()=>n(89924),_t=()=>n(722872),Pt=()=>n(176983),Bt=()=>n(463830),Dt=()=>n(329304),Rt=()=>n(10984),Et=()=>n(51781),Lt=()=>n(308228),Ot=(n(737550),()=>n(985529)),Nt=()=>n(329443),Ft=()=>n(152197),Ut=()=>n(112698);function zt(e){var t;const{teamStore:n,memberInfo:r,permissionItem:l,memberName:d,onMenuItemClicked:c,isPermissionOverridden:u}=e,g=(0,o().v3)(),m=(0,p().tz)(),f=(0,i.useMemo)((()=>new(Bt().A)),[]),h=(0,s().K8)((()=>n.getTeamPermission()),[n]),y=(0,Ft().r)(),b=(0,Dt()._X)({name:"custom_teamspace_permissions",spaceId:y,userId:null==g||null===(t=g.currentUser)||void 0===t?void 0:t.id}),S=(0,D().R)(n),x=!(0,Ot().e2)(b)&&!u||!S,A=(0,s().K8)((()=>{if(null==n||!n.isDefined())return;const e=m.formatMessage({id:"teamMemberPermissionRoleSelect.member.permissionitem.description",defaultMessage:"You can't give less access than the teamspace default. Lower teamspace membersâ€™ access to enable this option."}),t=(0,X.jsx)(p().sA,{id:"teamMemberPermissionRoleSelect.permissionItem.defaultTag",defaultMessage:"default"});return["editor","read_and_write","comment_only","reader"].map((function(i){const o=(null==h?void 0:h.role)===i?t:void 0;return(0,q().or)({teamValue:{id:n.id,permissions:n.getPermissionItems()},permissionRole:i})?{role:i,disabledInfo:{isDisabled:!0,disabledMessage:e},tag:o}:{role:i,tag:o}}))}),[h,m,n]);const M=(0,a().IS)((e=>({overrideTitle:{display:"flex",alignItems:"center",justifyContent:"space-between",height:28},roleSelectButton:{marginInlineEnd:0,fontSize:12,color:e.text.secondary,visibility:u?void 0:"hidden"},disabledItem:{color:e.text.tertiary}})),[u]),j=(0,X.jsxs)("div",{style:M.overrideTitle,children:[(0,X.jsx)(p().sA,{id:"TeamMemberOwnerSelect.permissionsOverride",defaultMessage:"Custom permissions"}),null!=b&&b.upsell&&!u?(0,X.jsx)(Ut().B,{upsell:null==b?void 0:b.upsell,analyticsName:"team_member_permission_override",desktopStyle:{marginInlineStart:8,marginInlineEnd:12}}):(0,X.jsx)(H().Ay,{role:"owner"===r.type?"none":l.role,table:G().yK,type:"user"===r.entity_type?"user_permission":"group_permission",upgradeButtonName:"user"===r.entity_type?"user_permission_item":"group_permission_item",disabled:x,buttonStyle:M.roleSelectButton,availableRoleItems:A,header:(0,X.jsx)(Z().A,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:600,marginInlineStart:16,marginTop:8},children:(0,X.jsx)(p().sA,{id:"teamMemberPermissionRoleSelect.permissionOverride.menuHeader",defaultMessage:"Select custom role"})}),onChange:e=>{"none"!==e&&(!function(e){wt().ui({message:(0,X.jsx)(p().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.message",defaultMessage:"Are you sure you want to change {name}â€™s role to {role}?",values:{name:d,role:(0,Nt().qZ)(e).toLowerCase()}}),description:(0,X.jsx)(p().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.description",defaultMessage:"This change wonâ€™t apply to any restricted pages in the teamspace."}),showCancel:!0,keepFocus:!1,handleCancel:wt().zw,items:[{label:(0,X.jsx)(p().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:async()=>{const{serverCommitResult:t}=v().createAndCommit({userAction:"TeamMemberPermissionRoleSelect.handleRoleSelect",environment:g,canUndo:!0,perform:t=>{w().b4({memberInfo:r,teamStore:n,transaction:t,environment:g,permissionRole:e})}});await t,n.isDefault()&&(n.getMembershipDefinedOnTeam().some((e=>(0,at().Q6)(e,r)))||await w().Zd({environment:g,teamStore:n,teamMemberInfos:[r],isSettingDefaultTeam:!0,createNewTeamFlowId:void 0}))}}]})}(e),c&&c())},buttonPopupStore:f,placementToOrigin:"right",alignmentToOrigin:"end"})]});return(0,X.jsx)(Q().A,{placement:x?"right":"left",textWrap:!0,renderTooltip:()=>x&&!S?(0,X.jsx)(p().sA,{id:"teamMemberPermissionRoleSelect.permissionOverride.buttonTooltip.disabled",defaultMessage:"You must be a teamspace owner to set custom permission level"}):(0,X.jsx)(p().sA,{id:"teamMemberPermissionRoleSelect.permissionOverride.buttonTooltip",defaultMessage:"Set a custom permission level for all pages in this teamspace"}),render:e=>(0,X.jsx)(jt().A,{...e,focused:!1,disabled:x,style:x?M.disabledItem:{},onClick:()=>f.setState({open:!0}),title:j,isChecked:u})})}function Kt({teamStore:e,memberInfo:t,permissionItem:n,memberName:i,isPermissionOverridden:a,spaceRole:r,disabled:l}){const d=(0,s().uB)(void 0,Bt().A),c=(0,o().v3)(),u=(0,s().O$)(M().AppStoreSidebarSpaceStore),g=(0,ue().$)(),f=(0,s().K8)((()=>{const e=null==g?void 0:g.userId;return"user"===t.entity_type&&t.user_id===e}),[null==g?void 0:g.userId,t]),h=()=>d.setState({...d.state,open:!1}),y=(0,D().R)(e),S=(0,Dt().P9)({name:"team_self_promotion",spaceId:null==u?void 0:u.id,userId:null==g?void 0:g.userId}),x=(0,s().K8)((()=>{const{sidebarSpaceStore:e}=M().default.state;return Boolean(null==e?void 0:e.canAdmin())}),[]),A=(0,s().K8)((()=>{const{ownerUserIds:t,ownerGroupIds:n}=e.getAllOwnerIds();return t.length+n.length}),[e]),j=(0,O().$)(e),k=0===A,I=async n=>{h();const i="owner"===n?(0,X.jsx)(p().sA,{defaultMessage:"owner",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelOwner"}):(0,X.jsx)(p().sA,{defaultMessage:"member",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelMember"});if("team_level_guest"!==t.type||"owner"!==n&&"member"!==n)if("owner"===n){if("user"===t.entity_type||"group"===t.entity_type){const n=async()=>{const{serverCommitResult:n}=v().createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:c,canUndo:!0,perform:n=>{w().D6({environment:c,memberInfo:t,teamStore:e,transaction:n})}});await n},i=async()=>{await w().z9({environment:c,teamStore:e,currentSpaceStore:u,from:"team_settings_members",action:"upgradeToOwner"})};k&&f?wt().ui({message:(0,X.jsx)(p().sA,{id:"teamMemberPermissionSettings.upgradeOwnerForUnownedTeamConfirmation.message",defaultMessage:"Are you sure you want to become a teamspace owner? You can become the teamspace owner since there are no other owners and you are a workspace admin."}),showCancel:!0,keepFocus:!1,handleCancel:wt().zw,items:[{label:(0,X.jsx)(p().sA,{id:"teamMemberPermissionSettings.upgradeOwnerForUnownedTeamConfirmation.accept",defaultMessage:"Become teamspace owner"}),color:"blue",onAccept:async()=>{await n()}}]}):f&&S&&x?await i():await n()}}else f&&y?wt().ui({message:(0,X.jsx)(p().sA,{id:"teamMemberPermissionSettings.removeSelfTeamOwner.confirmation.message",defaultMessage:"Are you sure you want to remove yourself as a teamspace owner? Youâ€™ll no longer be able to edit teamspace settings and permissions."}),showCancel:!0,keepFocus:!1,handleCancel:wt().zw,items:[{label:(0,X.jsx)(p().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:C}]}):await C();else{let o=0;if(null!=g&&g.userId&&u){const e=await(0,Et().wq)({userId:g.userId,spaceStore:u,environment:c}),n=(0,b().dT)({spaceStore:u,teams:e}).map((e=>e.store));o=(0,b().p2)({lookupUserId:t.user_id,teamStores:n}).length}wt().ui({message:(0,X.jsx)(X.Fragment,{children:o>1?(0,X.jsx)(p().sA,{id:"teamMemberPermissionSettings.upgradeGuestConfirmationWithOtherTeamspaces.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member, and they will become a member in {numberOfOtherTeams, plural, one {{numberOfOtherTeams} other teamspace} other {{numberOfOtherTeams} other teamspaces}}.",values:{memberOrOwner:i,numberOfOtherTeams:o-1}}):(0,X.jsx)(p().sA,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member.",values:{memberOrOwner:i}})}),showCancel:!0,keepFocus:!1,handleCancel:wt().zw,items:[{label:(0,X.jsx)(p().sA,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.accept",defaultMessage:"Add to workspace"}),color:"blue",onAccept:async()=>{if(u){const{serverCommitResult:i}=v().createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:c,canUndo:!0,perform:i=>{w().Nd({environment:c,userId:t.user_id,teamStore:e,transaction:i,spaceStore:u,newTeamRole:n})}});await i}}}]})}},C=async()=>{if("owner"!==t.type||"user"!==t.entity_type&&"group"!==t.entity_type){if("member"===t.type){const{serverCommitResult:n}=v().createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:c,canUndo:!0,perform:n=>{w().P8({environment:c,memberInfo:t,teamStore:e,transaction:n})}});await n}}else{const{serverCommitResult:n}=v().createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:c,canUndo:!0,perform:n=>{w().qS({memberInfo:t,teamStore:e,transaction:n,environment:c})}});await n}},T=async()=>{var n;const{entity_type:i}=t;switch(h(),i){case"group":const o=null===(n=dt().A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===t.group_id)))||void 0===n?void 0:n.group;if(!o)throw new Error("Permission group not found in space.");w().BQ({environment:c,teamStore:e,group:o});break;case"user":await w().fy({environment:c,teamStore:e,userId:t.user_id,from:"team_settings_member_table",userGroupsInTeam:j});break;default:(0,m().HB)(i)}};return(0,X.jsx)(kt().A,{buttonPopupStore:d,placementToOrigin:"bottom",renderOrigin:e=>(0,X.jsx)(qt,{buttonPopupEvents:e,isPermissionOverridden:a,permissionItem:n,memberInfo:t,disabled:l}),render:()=>(0,X.jsx)(Vt,{teamStore:e,isPermissionOverridden:a,memberInfo:t,permissionItem:n,memberName:i,numberOfOwners:A,isMemberCurrentUser:f,onMenuItemClicked:I,onRemoveClicked:T,onSubMenuItemClicked:h,spaceRole:r}),popupType:kt().z.Popup})}function Vt({teamStore:e,isPermissionOverridden:t,memberInfo:n,permissionItem:i,memberName:o,numberOfOwners:r,isMemberCurrentUser:l,onRemoveClicked:d,onMenuItemClicked:c,onSubMenuItemClicked:u,spaceRole:p}){const m=(0,s().K8)((()=>{const{sidebarSpaceStore:e}=M().default.state;return!Boolean(null==e?void 0:e.getSettingsStore().getKeyStore("disable_team_guests").getValue())&&(0,K().Qd)()}),[]),h=(0,s().K8)((()=>e.isDefault()),[e]),v=(0,Pt().J)(),b=(0,s().K8)((()=>{const{sidebarSpaceStore:e}=M().default.state;return Boolean((null==e?void 0:e.canAdmin())&&(0,Rt().OX)())}),[]),S=(0,D().R)(e),x=(0,Ze().X)(e),A=1===r,w=0===r,j=(0,a().IS)((e=>({actionMenu:{marginTop:-4},removeButton:{color:e.errorText},overrideLabel:{paddingInlineStart:10,color:e.text.secondary,fontSize:12,fontWeight:f().Wy.regular}})),[]),k=(e,t,n)=>(0,Lt().W)({isCurrentUserTeamOwner:S,role:e,isDefaultTeam:h,userIsSpaceAdmin:Boolean(v),userIsEnterpriseWorkspaceOwner:b,originalTeamMemberInfo:t,onlyHasOneOwner:A,isUnowned:w,isMemberCurrentUser:l,canCurrentUserAddTeamMembers:n,isRoleForRestrictedMember:"restricted_member"===p}),I=(e,n)=>{const{isDisabled:i,disabledReason:o}=k(e,n,x);return{key:e,action:()=>c(e),render:s=>{const a=!t&&n.type===e;return(0,X.jsx)(Q().A,{disableTooltip:!i,placement:"right",textWrap:!0,renderTooltip:()=>o,render:t=>(0,X.jsx)("span",{...t,children:(0,X.jsx)(jt().A,{...s,disabled:i,disabledFeedback:i,title:(0,X.jsx)(Wt,{type:e}),caption:Ht(e),shouldWrapCaption:!0,isChecked:a})})})}}},C=h&&"user"===n.entity_type,T="group"!==n.entity_type&&m,_=[{key:"teamRoles",items:g().oE([I("owner",n),I("member",n),T?I("team_level_guest",n):void 0,Yt({onRemoveClicked:d,styles:j,...k("none",n,x),isMemberInDefaultTeam:C}),..."owner"===n.type||w?[]:[{key:"divider",action:()=>{},render:()=>(0,X.jsx)(U().A,{size:10})},{key:"permissions_override",action:()=>{},render:s=>(0,X.jsx)("span",{...s,children:(0,X.jsx)(zt,{teamStore:e,memberInfo:n,permissionItem:i,memberName:o,onMenuItemClicked:u,isPermissionOverridden:t})})}]]),render:e=>(0,X.jsx)(Tt().A,{...e,topBorder:0!==e.index})}];return(0,X.jsx)(It().A,{className:y().yw8,menuType:_t().gu.Popup,width:280,children:(0,X.jsx)(Ct().Ay,{type:Ct().Oh.Vertical,initialFocus:void 0,sections:_})})}function qt({buttonPopupEvents:e,disabled:t,isPermissionOverridden:n,permissionItem:i,memberInfo:o}){const s=(0,a().IS)((e=>({label:{color:e.text.primary,fontSize:12.5,fontWeight:f().Wy.regular},overrideLabel:{color:e.text.secondary,fontSize:12,fontWeight:f().Wy.regular},chevron:{width:10,marginInlineStart:4,fill:e.icon.tertiary}})),[]),r=function(e,t,n){if(t&&n)return function(e){switch(e){case"none":return(0,X.jsx)(p().sA,{id:"TeamMemberOwnerSelect.roleName.none",defaultMessage:"No access"});case"reader":return(0,X.jsx)(p().sA,{id:"TeamMemberOwnerSelect.roleName.reader",defaultMessage:"Can view"});case"comment_only":return(0,X.jsx)(p().sA,{id:"TeamMemberOwnerSelect.roleName.comment_only",defaultMessage:"Can comment"});case"content_only_editor":return(0,X.jsx)(p().sA,{id:"TeamMemberOwnerSelect.roleName.content_only_editor",defaultMessage:"Can edit content"});case"membership_admin":case"read_and_write":return(0,X.jsx)(p().sA,{id:"TeamMemberOwnerSelect.roleName.read_and_write",defaultMessage:"Can edit"});case"editor":return(0,X.jsx)(p().sA,{id:"TeamMemberOwnerSelect.roleName.editor",defaultMessage:"Full access"});default:(0,m().HB)(e)}}(n);return Gt(e)}(o.type,n,i.role);return(0,X.jsxs)(At().p,{disabled:t,...e,children:[n?(0,X.jsxs)("span",{style:s.overrideLabel,children:[(0,X.jsx)(p().sA,{id:"TeamMemberOwnerSelect.roleName.custom",defaultMessage:"Custom"}),(0,X.jsx)("span",{style:{marginInlineStart:5,marginInlineEnd:5},children:"â€¢"})]}):void 0,(0,X.jsx)("span",{style:s.label,children:r}),t?void 0:(0,Mt().b)(s.chevron)]})}function Wt({type:e}){const t=Gt(e);return(0,X.jsx)("div",{children:(0,X.jsx)("span",{children:t})})}function Gt(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,X.jsx)(p().sA,{...b().Y7[e].label});case"none":return;default:(0,m().HB)(e)}}function Ht(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,X.jsx)(p().sA,{...b().Y7[e].caption});case"none":return;default:(0,m().HB)(e)}}function Yt({styles:e,isDisabled:t,disabledReason:n,onRemoveClicked:i}){return{key:"remove",action:i,render:i=>(0,X.jsx)(Q().A,{disableTooltip:!t,placement:"right",textWrap:!1,renderTooltip:()=>n,render:n=>(0,X.jsx)("span",{...n,children:(0,X.jsx)(jt().A,{...i,style:e.removeButton,disabled:t,disabledFeedback:!0,title:(0,X.jsx)(p().sA,{id:"TeamMemberOwnerSelect.remove",defaultMessage:"Remove"})})})})}}function $t(e){const{type:t,store:n,permissionItem:i,memberInfo:r}=e,l=(0,o().v3)(),d=(0,p().tz)(),c="group"===t?e.permissionGroup:void 0,u="user"===t?e.userStore:void 0,g=(0,s().O$)(M().AppStoreSidebarSpaceStore),f=(0,s().K8)((()=>{var e;switch(t){case"group":return;case"user":const n=r.user_id;return(null===(e=(0,tt().sE)(g,n))||void 0===e?void 0:e.getMembershipType())??"none";default:(0,m().HB)(t)}}),[t,r,g]),h=(0,D().R)(n),v=(0,Ze().X)(n),y=(0,s().K8)((()=>{const{sidebarSpaceStore:e}=M().default.state;return null==e?void 0:e.canEditMembership()}),[]),S=(0,s().K8)((()=>{const e=l.currentUser.id,t=n.getSettingsStore().getValue();return!!(null!=g&&g.isDefined()&&n.isDefined()&&t&&e)&&(0,b().zC)({environment:l,teamStore:n,spaceStore:g})}),[l,g,n]),x=(0,s().K8)((()=>{const e=n.getPermissionItems()||[];switch(r.entity_type){case"group":return Boolean(e.find((e=>(0,W().Ds)(e)&&e.group_id===r.group_id)));case"user":return Boolean(e.find((e=>(0,W().B2)(e)&&e.user_id===r.user_id)));default:return!1}}),[r,n]),{name:A,label:w,icon:j,isSelfUserPermission:k}=(0,s().K8)((()=>{const e=l.currentUser.id;switch(t){case"group":return Qt({permissionGroup:c,spaceId:null==g?void 0:g.id});case"user":return function({intl:e,userStore:t,currentUserId:n}){var i;const o=void 0!==n&&(null==t||null===(i=t.getModel())||void 0===i?void 0:i.id)===n;return{name:(0,vt().c6)(e,null==t?void 0:t.getModel()),label:null==t?void 0:t.getEmail(),icon:(0,X.jsx)(me().A,{avatarShouldShowShadow:!0,userStore:t,size:32}),isSelfUserPermission:o}}({intl:d,userStore:u,currentUserId:e});default:(0,m().HB)(t)}}),[l.currentUser.id,t,c,null==g?void 0:g.id,d,u]),I=(0,X.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,X.jsx)(Kt,{teamStore:n,memberInfo:r,memberName:A,permissionItem:i,isPermissionOverridden:x,disabled:v&&"member"===r.type?!h&&x:!h&&!S||"team_level_guest"===r.type&&!y,spaceRole:f})}),C=(0,a().IS)((e=>({row:{minHeight:52},pill:{marginInlineStart:6,height:17},titleYouIndicator:{color:e.text.secondary}})),[]),T=(0,X.jsxs)("div",{style:{display:"flex",gap:4},children:[A,k?(0,X.jsx)("span",{style:C.titleYouIndicator,children:(0,X.jsx)(p().sA,{id:"specificTeamMemberPermissionRow.displayName.youIndicator",defaultMessage:"(You)"})}):void 0]});return(0,X.jsx)(te,{style:C.row,tag:(0,st().LF)(f)?(0,X.jsx)(yt().l,{role:f}):(0,st().GN)(f)?(0,X.jsx)(St().L,{}):"group"===t?(0,X.jsx)("div",{style:C.pill,children:j}):void 0,permissionRoleSelectComponent:I,iconComponent:"group"===t?(0,X.jsx)(bt().A,{size:32}):j,name:T,label:w})}function Qt({spaceId:e,permissionGroup:t}){var n;const{name:i,icon:o}=t,s=(null===(n=dt().A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===t.group_id)))||void 0===n?void 0:n.memberCount)??0;return{name:i||(0,X.jsx)(p().sA,{id:"teamPermissionSettings.untitled",defaultMessage:"Untitled"}),label:(0,X.jsx)(Q().A,{placement:"bottom",alignment:"start",disableTooltip:0===s,renderTooltip:()=>(0,X.jsx)(xt().Q,{group:t,limit:10,noMembersMessage:void 0}),render:e=>(0,X.jsxs)("div",{...e,children:[(0,X.jsx)(p().sA,{id:"teamPermissionSettings.group",defaultMessage:"Group"})," â€¢ ",(0,X.jsx)(p().sA,{id:"teamPermissionSettings.numberOfMembers",defaultMessage:"{groupSize, plural, one {{groupSize} member} other {{groupSize} members}}",values:{groupSize:s}})]})}),icon:o&&(0,X.jsx)(ge().B6,{bucket:"public",disabled:!0,onChange:()=>{},isEmptyPage:!1,title:i,size:18,icon:o&&e?{icon:o,pointer:{table:ht().NX,id:e}}:void 0}),isSelfUserPermission:!1}}var Zt=()=>n(689094),Jt=()=>n(471995),Xt=()=>n(224701);function en({teamStore:e,...t}){const n=(0,o().v3)(),r=(0,Ft().r)(),l=(0,p().tz)(),d=(0,a().IS)((()=>({container:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:52,justifyContent:"space-between",alignItems:"center"},pill:{marginInlineStart:6,height:17}})),[]),c=(0,i.useCallback)((e=>{Jt().D6({label:(0,X.jsx)(p().sA,{id:"SpecificTeamMemberToAddRow.team_invite_failure",defaultMessage:"Failed to add {userOrGroupName}",values:{userOrGroupName:e}})})}),[]),u=(0,i.useCallback)((async(t,i)=>{await w().Zd({environment:n,teamMemberInfos:[t],teamStore:e,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})?await Xt().x(n):c(i)}),[n,c,e]),g=(0,i.useCallback)(((e,t)=>u({type:"member",entity_type:"user",user_id:e.id},t)),[u]),m=(0,i.useCallback)(((e,t)=>u({type:"member",entity_type:"group",group_id:e.group_id},t)),[u]),f=(0,s().K8)((()=>{if("groupToAdd"in t)return Qt({spaceId:r,permissionGroup:t.groupToAdd})}),[r,t]);if("memberToAdd"in t){const{memberToAdd:e}=t,n=(0,vt().c6)(l,e);return(0,X.jsxs)("div",{style:d.container,children:[(0,X.jsx)(ee,{icon:(0,X.jsx)(me().A,{userValue:e,size:32}),name:n,label:e.email}),tn((()=>{g(e,n)}))]})}{if(!r||!f)return(0,X.jsx)(X.Fragment,{});const{groupToAdd:e}=t;return(0,X.jsxs)("div",{style:d.container,children:[(0,X.jsx)(ee,{icon:(0,X.jsx)(bt().A,{size:32}),name:f.name,label:f.label,tag:(0,X.jsx)("div",{style:d.pill,children:f.icon})}),tn((()=>{m(e,f.name)}))]})}}function tn(e){return(0,X.jsx)(At().p,{colorPalette:"blue",onClick:e,iconLeading:Zt().W,children:(0,X.jsx)(p().sA,{id:"SpecificTeamMemberToAddRow.addMemberButton.text",defaultMessage:"Add"})})}var nn=()=>n(158359),on=()=>n(498474);function sn({sortType:e,onChangeSortType:t}){const n=(0,a().IS)((e=>({container:{display:"flex",justifyContent:"space-between"}})),[]),i=t=>t===e.column?e.sortedAscending?"ascending":"descending":"none",o=n=>{const i=n===e.column&&!e.sortedAscending;t({column:n,sortedAscending:i})};return(0,X.jsxs)(X.Fragment,{children:[(0,X.jsxs)("div",{style:n.container,children:[(0,X.jsx)(an,{title:(0,X.jsx)(p().sA,{id:"TeamPermissionsListHeader.nameColumn",defaultMessage:"Name"}),sortedType:i("name"),onClick:()=>o("name")}),(0,X.jsx)(an,{title:(0,X.jsx)(p().sA,{id:"TeamPermissionsListHeader.roleColumn",defaultMessage:"Role"}),sortedType:i("role"),onClick:()=>o("role")})]}),(0,X.jsx)(U().A,{size:1})]})}function an({sortedType:e,title:t,onClick:n}){const i=(0,a().IS)((e=>({button:{color:e.text.secondary,fontSize:12,padding:0},buttonHover:{background:"unset"},sortIcon:{width:14,height:14,marginInlineEnd:5,fill:e.icon.secondary}})),[]);return(0,X.jsxs)(At().p,{style:i.button,hoveredStyle:i.buttonHover,onClick:n,children:["ascending"===e?(0,on().q)(i.sortIcon):void 0,"descending"===e?(0,nn().P)(i.sortIcon):void 0,t]})}function rn({store:e}){const t=(0,a().IS)((e=>({container:{display:"block",overflow:"hidden"},noResult:{fontSize:f().J.UIRegular.desktop,color:e.text.secondary,marginTop:8}})),[]),[n,r]=(0,i.useState)({column:"role",sortedAscending:!1}),l=(0,s().K8)((()=>A().A.state.memberFilterQuery),[]),d=function(e){const{teamStore:t,query:n,sort:a,limit:r}=e,l=(0,o().v3)(),d=(0,s().O$)(ot().subscriptionDataStoreInstance),c=(0,p().tz)(),u=(0,Ze().X)(t),g=(0,s().K8)((()=>{const e=t.getSpaceStore(),n=M().default.state.currentUserStore;return!nt().A.state.shouldUseEdgeCache&&d&&e&&n?(0,it().Ye)(d).map((i=>{var o,s;const a=pe().L.createChildStore(n,{table:ce().oo,id:i.userId}),r=(0,tt().dp)(e,i.userId);return{id:i.userId,email:(null==a?void 0:a.getEmail())??"",space_id:t.getSpaceId()??"",name:(null==a?void 0:a.getName())??"",profile_photo:null==a||null===(o=a.getModel())||void 0===o?void 0:o.profile_photo,membership_type:null==r?void 0:r.getMembershipType(),onboarding_completed:null==a||null===(s=a.getModel())||void 0===s?void 0:s.onboarding_completed,first_joined_space_time:i.firstJoinedSpaceTime??Date.now()}})):[]}),[t,d]),m=(0,s().K8)((()=>nt().A.state.shouldUseEdgeCache),[]),f=(0,ue().$)(),h=(0,s().K8)((()=>{if(d&&f)return new gt({members:g,teamStore:t,currentUserStore:f,environment:l,initialQuery:n,initialSort:a,limit:r,intl:c,shouldUseEdgeCache:m,canAddMembers:u})}),[l,m,c,f]),v=g;return(0,i.useEffect)((()=>{null==h||h.setVisibleMembers(v)}),[h,v]),(0,i.useEffect)((()=>{null==h||h.setSort(a)}),[h,a]),(0,i.useEffect)((()=>{null==h||h.setQuery(n)}),[h,n]),h}({teamStore:e,query:l,sort:n,limit:30}),c=(0,s().K8)((()=>null==d?void 0:d.rowsStore.state.rows),[d]),u=(0,ue().$)(),g=(0,i.useMemo)((()=>null==c?void 0:c.findIndex((e=>"to_add"===e.type))),[c]),m=(0,i.useCallback)(((e,t)=>t===g||0===t&&"joined"===e.type?82:52),[g]),h=Boolean(null==l?void 0:l.trim().length),v=c&&c.length>0;return!d||void 0===c?(0,X.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,X.jsx)(Xe().k,{})}):(0,X.jsxs)("div",{style:t.container,children:[(0,X.jsx)(U().A,{size:1}),v?void 0:(0,X.jsx)("div",{style:t.noResult,children:(0,X.jsx)(p().sA,{id:"TeamPermissionsList.search.zeroState",defaultMessage:"No members or groups found"})}),v?(0,X.jsx)(et().u,{listSource:d,style:{overflow:"hidden"},renderRow:(t,i)=>(0,X.jsxs)(X.Fragment,{children:[0===i&&"joined"===t.type?(0,X.jsx)(Z().A,{isSmall:!0,style:{height:30,alignContent:"end"},children:h?(0,X.jsx)(p().sA,{id:"TeamPermissionsList.search.inThisTeam",defaultMessage:"In this teamspace"}):(0,X.jsx)(sn,{sortType:n,onChangeSortType:r})}):void 0,i===g?(0,X.jsx)(Z().A,{isSmall:!0,style:{height:30,alignContent:"end"},children:(0,X.jsx)(p().sA,{id:"TeamPermissionsList.search.notInTeam",defaultMessage:"Not in teamspace"})}):void 0,"joined"===t.type?(0,X.jsx)(ln,{teamStore:e,currentUserStore:u,memberInfo:t.value}):(0,X.jsx)(dn,{teamStore:e,memberToAdd:t.value}),(0,X.jsx)(U().A,{size:1})]}),estimateSize:m}):void 0]})}function ln({teamStore:e,currentUserStore:t,memberInfo:n}){const i=(0,s().K8)((()=>(0,b().mo)({currentUserStore:t,teamStore:e,member:n})),[t,e,n]);return i?(0,X.jsx)($t,{store:e,...i}):null}function dn({teamStore:e,memberToAdd:t}){return"group_id"in t?(0,X.jsx)(en,{teamStore:e,groupToAdd:t}):(0,X.jsx)(en,{teamStore:e,memberToAdd:t})}function cn({teamStore:e}){return(0,X.jsxs)(l().Y1,{gap:20,children:[(0,X.jsx)(Je,{teamStore:e}),(0,X.jsx)(rn,{store:e})]})}var un=()=>n(59226),pn=()=>n(581369),gn=()=>n(638743),mn=()=>n(709062),fn=()=>n(991249),hn=()=>n(118849),vn=()=>n(233510),yn=()=>n(812941);function bn({teamStore:e}){const t=(0,s().K8)((()=>e.getSettingsStore().getValue()),[e]),n=(0,s().K8)((()=>{const t=e.getSettingsStore().getValue();if(t)return Ie({id:e.id,permissions:e.getPermissionItems(),settings:t,is_default:e.isDefault()})}),[e]);if(!t||!n)return null;const i=[(0,X.jsx)(xn,{teamStore:e,hasMultiInviteAccessOptions:1===n.settingsOptions.invite_access.length,inviteAccess:t.invite_access},"invite"),(0,X.jsx)(Sn,{teamStore:e,disablePageEdits:t.disable_team_page_edits},"editSidebar"),(0,X.jsx)(An,{teamStore:e},"toggleInviteLink")];return(0,X.jsx)(oe,{title:(0,X.jsx)(p().sA,{id:"TeamSettingsSecurity.teamspaceSettingsTitle",defaultMessage:"Teamspace Security"}),rows:i})}function Sn(e){const{teamStore:t,disablePageEdits:n}=e,a=(0,o().v3)(),r=R(t),l=(0,s().K8)((()=>{var e;return(null===(e=t.getTeamPermission())||void 0===e?void 0:e.role)??"none"}),[t]),d=(0,i.useCallback)((e=>{v().createAndCommit({userAction:"teamsHelpers.changeTeamSetting",environment:a,canUndo:!0,perform:n=>{w().WC({environment:a,store:t,update:{disable_team_page_edits:e},transaction:n})}})}),[a,t]),c=(0,W().p2)(l),u=[{option:!0,label:(0,X.jsx)(p().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>d(!0)}];return c&&u.push({option:!1,label:(0,X.jsx)(p().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>d(!1)}),(0,X.jsx)(Oe,{title:(0,X.jsx)(p().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.title",defaultMessage:"Who can edit teamspace sidebar"}),caption:(0,X.jsx)(p().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.caption",defaultMessage:"Adding, removing, or re-ordering sidebar pages"}),rightTooltip:c?void 0:(0,X.jsx)(p().sA,{id:"TeamSettingsPermissions.settingSelect.whoCanEditTeamPages.teamMemberPermissionTooltip",defaultMessage:"Change member permissions to Can edit or Full access to allow teamspace members to edit the sidebar"}),right:(0,X.jsx)(Mn,{disabled:r||!c,currentOption:!c||Boolean(n),allOptions:u})})}function xn(e){const{teamStore:t,hasMultiInviteAccessOptions:n,inviteAccess:s}=e,a=(0,D().R)(t),r=(0,o().v3)(),l=(0,i.useCallback)((e=>{v().createAndCommit({userAction:"team.setInviteAccess",environment:r,canUndo:!0,perform:n=>{w().WC({environment:r,store:t,update:{invite_access:e},transaction:n})}})}),[r,t]),d=!a||n;return(0,X.jsx)(Oe,{title:(0,X.jsx)(p().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.title",defaultMessage:"Who can invite or remove teamspace members"}),rightTooltip:d&&a&&(0,X.jsx)(p().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamMembersDisabled.caption",defaultMessage:"Change access level to Closed or Private to restrict who can invite teamspace members"}),right:(0,X.jsx)(Mn,{disabled:d,currentOption:s,allOptions:[{option:"team_members",label:(0,X.jsx)(p().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamspaceMembers.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>l("team_members")},{option:"team_owners",label:(0,X.jsx)(p().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>l("team_owners")}]})})}function An(e){const{teamStore:t}=e,n=(0,o().v3)(),i=(0,s().K8)((()=>(0,b().FQ)(t)),[t]),r=R(t),l=(0,a().IS)((()=>({container:{display:"flex",justifyContent:"space-between"},subtitle:{marginBottom:5},switcher:{marginTop:5}})),[]);return(0,X.jsxs)("div",{style:l.container,children:[(0,X.jsxs)("div",{children:[(0,X.jsx)(Z().A,{children:(0,X.jsx)(p().sA,{id:"TeamsecuritySection.inviteLink.label",defaultMessage:"Invite Link"})}),(0,X.jsx)(Z().A,{isSmall:!0,style:l.subtitle,children:(0,X.jsx)(p().sA,{id:"TeamsecuritySection.inviteLink.description",defaultMessage:"Only users who can invite members can see the invite link"})})]}),(0,X.jsx)("div",{style:l.switcher,children:(0,X.jsx)(pn().A,{disabled:r,on:!i,onClick:()=>{v().createAndCommit({userAction:"team.setInviteAccess",environment:n,canUndo:!0,perform:e=>{w().WC({environment:n,store:t,update:{disable_invite_link:!i},transaction:e})}})}})})]})}function Mn(e){const{currentOption:t,allOptions:n,disabled:i}=e,o=(0,a().IS)((e=>({chevron:{width:10,marginInlineStart:4,fill:e.icon.tertiary},buttonStyle:{fontSize:12.5,color:e.text.secondary}})),[]),s=n.find((e=>e.option===t));return s?(0,X.jsx)(kt().A,{disablePopup:i,popupType:kt().z.Popup,alignmentToOrigin:"end",renderOrigin:e=>(0,X.jsxs)(At().p,{style:o.buttonStyle,disabled:i,...e,children:[s.label,i?void 0:(0,Mt().b)(o.chevron)]}),render:e=>{const i=[{key:"options",render:e=>(0,X.jsx)(Tt().A,{...e}),items:n.map((n=>{const i={key:n.option.toString(),render:e=>(0,X.jsx)(jt().A,{...e,title:n.label,caption:n.caption,isChecked:t===n.option}),action:()=>{n.action(),e.close()}};return i}))}];return(0,X.jsx)(It().A,{menuType:_t().gu.Popup,minWidth:150,children:(0,X.jsx)(Ct().Ay,{type:Ct().Oh.Vertical,initialFocus:void 0,sections:i})})}}):null}function wn({teamStore:e}){return(0,X.jsxs)(l().Y1,{gap:30,children:[(0,X.jsx)(bn,{teamStore:e}),(0,X.jsx)(jn,{teamStore:e}),(0,X.jsx)(yn().A,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_security",message:(0,X.jsx)(p().sA,{id:"teamSettingsSecurity.learnMore",defaultMessage:"Learn about teamspace security"})})]})}function jn({teamStore:e}){const t=(0,s().K8)((()=>e.getSpaceStore()),[e]),n=(0,o().v3)(),i=(0,vn().Z)(),a=(0,un().X)("restricted_members_enabled"),{organizationOverrides:r}=(0,gn().n)({spaceId:null==t?void 0:t.id}),l=n.currentUser.id,d=(0,s().K8)((()=>({disable_public_access:{spaceIsDisabled:(null==t?void 0:t.getDisablePublicAccess())??!1,teamIsDisabled:e.getDisablePublicAccess(),isControlledByOrganization:Boolean(r.disable_public_access),forceDisabled:!1},disable_export:{spaceIsDisabled:(null==t?void 0:t.getDisableExport())??!1,teamIsDisabled:e.getDisableExport(),isControlledByOrganization:Boolean(r.disable_export),forceDisabled:!1},disable_guests:{spaceIsDisabled:(null==t?void 0:t.getDisableGuests())??!1,teamIsDisabled:e.getDisableGuests(),isControlledByOrganization:Boolean(r.disable_guests),forceDisabled:e.getDisableRestrictedMembers()},disable_restricted_members:{spaceIsDisabled:void 0,teamIsDisabled:e.getDisableRestrictedMembers(),isControlledByOrganization:!1,forceDisabled:!1}})),[t,e,r]),c=(0,D().R)(e),u=(0,s().K8)((()=>(null==t?void 0:t.canAdmin())??!1),[t]);if(!t)return null;if(!l)return null;const g=(0,X.jsx)(In,{teamStore:e,settingName:"disable_public_access",title:(0,X.jsx)(p().sA,{id:"teamSettingsSecurity.setting.shareTitleAWTLUpdate",defaultMessage:"Disable publishing sites, forms, and public links"}),spaceAndTeamSettings:d.disable_public_access,isSpaceAdmin:u,isTeamOwner:c,hasAdvancedSecurityFeature:i}),m=(0,X.jsx)(In,{teamStore:e,settingName:"disable_guests",title:(0,X.jsx)(p().sA,{id:"teamSettingsSecurity.setting.guestTitle",defaultMessage:"Disable guests"}),spaceAndTeamSettings:d.disable_guests,isSpaceAdmin:u,isTeamOwner:c,hasAdvancedSecurityFeature:i}),f=(0,X.jsx)(In,{teamStore:e,settingName:"disable_export",title:(0,X.jsx)(p().sA,{id:"teamSettingsSecurity.setting.exportTitle",defaultMessage:"Disable export"}),spaceAndTeamSettings:d.disable_export,isSpaceAdmin:u,isTeamOwner:c,hasAdvancedSecurityFeature:i}),h=(0,X.jsx)(In,{teamStore:e,settingName:"disable_restricted_members",title:(0,X.jsx)(p().sA,{id:"teamSettingsSecurity.setting.restrictedMembersTitle",defaultMessage:"Disable restricted members"}),spaceAndTeamSettings:d.disable_restricted_members,isSpaceAdmin:u,isTeamOwner:c,hasAdvancedSecurityFeature:i}),v=a?[g,m,h,f]:[g,m,f],y=(0,X.jsx)(p().sA,{id:"TeamSettingsSecurity.pageSettingsTitle",defaultMessage:"Page Security"});return(0,X.jsx)(oe,{title:y,rows:v})}function kn(e){return e?"disable":"allow"}function In(e){const{teamStore:t,settingName:n,title:i,spaceAndTeamSettings:s,isSpaceAdmin:r,isTeamOwner:l,hasAdvancedSecurityFeature:d}=e,c=(0,o().v3)(),u="enterprise",g=()=>d||s.teamIsDisabled,m=!g()&&r,f=(0,a().IS)((()=>({upsellWrap:{cursor:m?"pointer":void 0}})),[m]),h=(0,X.jsx)(hn().A,{subscriptionTier:u,analyticsName:"team_security_settings",desktopStyle:{display:"inline-block",marginInlineStart:8,marginTop:-3}}),v=(0,X.jsx)(p().sA,{id:"teamSettingsSecurity.setting.enterpriseGateToggleTooltip",defaultMessage:"Upgrade to Enterprise Plan to change security settings"}),y=s.isControlledByOrganization||s.forceDisabled,b=s.isControlledByOrganization?(0,mn().C_)():(0,X.jsx)(p().sA,{id:"teamSettingsSecurity.setting.disableGuestsLockedTooltip",defaultMessage:"Must enable restricted members to enable guests."});return(0,X.jsx)("div",{style:f.upsellWrap,onClick:()=>{if(m)return fn().K(c,{from:"team_security_settings",upsell:{type:"product",product:u,limit:{type:"none"},trialability:"none"},dontOpenPlansOnCancel:!0})},role:"button",tabIndex:0,children:(0,X.jsx)(Oe,{title:(0,X.jsxs)(X.Fragment,{children:[i,g()?void 0:h]}),caption:(()=>{const e=s.spaceIsDisabled,t=s.teamIsDisabled;if(e)return t?(0,X.jsx)(p().sA,{id:"teamSettingsSecurity.basedOnWorkspaceSettings",defaultMessage:"Based on <underline>workspace settings</underline>",values:{underline:e=>(0,X.jsx)("span",{style:{textDecoration:"underline"},children:e})}}):(0,X.jsx)(p().sA,{id:"teamSettingsSecurity.overridesWorkspaceSettings",defaultMessage:"Overriding <underline>workspace setting</underline>",values:{underline:e=>(0,X.jsx)("span",{style:{textDecoration:"underline"},children:e})}})})(),rightTooltip:!g()&&v,right:(0,X.jsx)(pn().A,{on:s.teamIsDisabled,disabled:!(()=>{if(!g())return!1;if(!l)return!1;if(s.isControlledByOrganization)return!1;if(s.forceDisabled)return!1;return!(s.spaceIsDisabled&&s.teamIsDisabled)||r})(),onClick:()=>(e=>{const{teamIsDisabled:n,spaceIsDisabled:i}=s,o=!n;w().$L({environment:c,store:t,settingName:e,newTeamSettingValue:kn(o),spaceSettingValue:void 0===i?void 0:kn(i)})})(n),isLocked:y,lockedTooltip:b})})})}var Cn=()=>n(192940),Tn=()=>n(676007),_n=()=>n(2143),Pn=()=>n(987017);function Bn({teamStore:e}){const t=(0,s().K8)((()=>A().A.state.tab),[]);if(void 0===t)return null;switch(t){case A().p.General:return(0,X.jsx)(Fe,{teamStore:e});case A().p.Members:return(0,X.jsx)(cn,{teamStore:e});case A().p.Security:return(0,X.jsx)(wn,{teamStore:e});default:(0,m().HB)(t)}}function Dn(){const e=(0,o().v3)(),t=(0,s().O$)(M().AppStoreSidebarSpaceStore),n=(0,s().O$)(M().AppStoreSidebarSpaceViewStore),i=(0,o().Y0)(),l=(0,a().IS)((e=>({modal:{width:i.isMobile?"auto":630,height:i.isMobile?"auto":640,maxWidth:"calc(100vw - 100px)",maxHeight:"calc(100vh - 100px)",borderRadius:5,overflow:"auto"},modalWrap:{userSelect:"none",WebkitUserSelect:"none",height:"100%"},innerWrap:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},tabBar:{display:"flex",width:void 0,flexGrow:0,flexShrink:0,paddingInline:36,background:e.gray.background.primary},scroller:{flexGrow:1,paddingTop:20},contentWrap:{margin:"0px 36px 20px"}})),[i.isMobile]),{open:c,tab:u,teamId:f}=(0,s().K8)((()=>{const{open:e,tab:t}=A().A.state,n=A().A.getTeamStore();return{open:e,tab:t,teamId:null==n?void 0:n.id}}),[]),v=(0,x().T)(),b=(0,S().C)({userId:v,spaceStore:t,teamId:f??""});if(!t||!n||!b)return null;const w=[A().p.General,A().p.Members,A().p.Security];return(0,X.jsx)(Tn().a,{open:c,innerStyle:l.modal,onDismiss:()=>{A().A.reset()},render:()=>c?(0,X.jsx)("div",{className:y().kYU,style:{height:"100%"},children:(0,X.jsx)("div",{style:l.modalWrap,children:(0,X.jsx)(d().N,{debugName:"SidebarTeamModal",capture:!0,onBackspace:g().D_,onLeft:g().D_,onRight:g().D_,onSelectAll:g().D_,onRedo:g().D_,onUndo:g().D_,onCut:g().D_,onCopy:g().D_,onPaste:g().D_,onKeypress:g().D_,onDelete:g().D_,onTab:g().D_,children:(0,X.jsxs)("div",{style:l.innerWrap,children:[(0,X.jsx)(Rn,{teamStore:b}),(0,X.jsx)(Pn().Ay,{tabs:w.map((e=>function(e,t){switch(e){case A().p.General:return(0,X.jsx)(p().sA,{id:"sidebarTeamModalTab.option.general",defaultMessage:"General"});case A().p.Members:return(0,X.jsx)(p().sA,{id:"sidebarTeamModalTab.option.members",defaultMessage:"Members"});case A().p.Security:return(0,X.jsx)(p().sA,{id:"sidebarTeamModalTab.option.security",defaultMessage:"Security"});default:(0,m().HB)(e)}}(e))),selectedIndex:(0,m().O9)(u)?w.indexOf(u):1,onChange:t=>{c&&(h().Vg(e,{store:b,tab_old_value:u??A().p.General,tab_new_value:w[t]}),A().A.update((e=>e.open?{...e,tab:w[t]}:e)))},tabStyle:{marginInlineStart:-8},style:l.tabBar,tabTitleStyle:{marginInlineStart:8,marginInlineEnd:8}}),(0,X.jsx)(_n().H,{type:r().A.Y,style:l.scroller,children:(0,X.jsx)("div",{style:l.contentWrap,children:(0,X.jsx)(Bn,{teamStore:b})})})]})})})}):null})}function Rn({teamStore:e}){const t=(0,o().v3)(),n=(0,Cn().h)(e),r=R(e),[d,g]=(0,i.useState)(void 0),m=(0,s().K8)((()=>(null==e?void 0:e.getName())||""),[e]),h=(0,s().K8)((()=>e.getRawMembership()),[e]),y=(0,s().K8)((()=>null==e?void 0:e.getSettings()),[e]),S=(0,a().IS)((e=>({header:{padding:"34px 36px 20px",background:e.gray.background.primary},titleWithMetadata:{minWidth:0},icon:{marginInlineEnd:12},input:{fontSize:22,fontWeight:f().Wy.semibold,background:"inherit",boxShadow:"none",paddingInline:"5px",marginInlineStart:"-5px",minWidth:0,width:void 0},innerInput:{textOverflow:"ellipsis"}})),[]),x=(0,i.useCallback)((n=>{e&&(0,w().qq)({store:e,environment:t,icon:n,source:"TeamSettings"})}),[e,t]);return(0,X.jsxs)(l().Y1,{direction:"horizontal",style:S.header,children:[(0,X.jsx)($().x,{disabled:r,store:e,size:48,style:S.icon,onChange:x}),(0,X.jsxs)(l().Y1,{direction:"vertical",style:S.titleWithMetadata,children:[(0,X.jsxs)(l().Y1,{direction:"horizontal",width:"fill",children:[(0,X.jsx)(ze,{value:d?d.trim():m,style:S.input,inputStyle:S.innerInput,onBlurValue:e=>{g(e)},onChangeValue:n=>{g(n),(n=>{const i=null==n?void 0:n.trim();""!==i&&e&&i!==m&&v().createAndCommit({userAction:"TeamSettings.updateName",environment:t,canUndo:!0,perform:t=>{(0,w().n7)({store:e,update:{name:i},transaction:t})}})})(n)},disabled:r,placeholder:"Acme Labs",autosize:!0}),(0,X.jsxs)(l().Y1,{direction:"horizontal",width:"fill",children:[(0,b().tM)(y)?(0,X.jsx)(k().A,{}):void 0,(0,b().A2)({membership:h})?(0,X.jsx)(c().E,{content:(0,X.jsx)(p().sA,{id:"sidebarTeamModalTab.unownedBadge",defaultMessage:"Unowned"})}):void 0,(0,X.jsx)("div",{style:{flexGrow:1}}),(0,X.jsx)(j().TeamJoinLeaveButton,{teamStore:e,onLeavingTeam:()=>A().A.reset(),from:"sidebar_team_modal",navigateToTeamHomeOnJoin:!1})]})]}),(0,X.jsx)(u().D,{styleKey:"Caption/Regular",colorVariant:"secondary",children:(0,X.jsx)(p().sA,{id:"sidebarTeamModal.teamCaption.members",defaultMessage:"{numberOfMembers} {numberOfMembers, plural, one {member} other {members}}",values:{numberOfMembers:n}})})]})]})}},341694:(e,t,n)=>{n.d(t,{H:()=>d});var i=()=>n(56366),o=()=>n(21510),s=()=>n(696746),a=()=>n(765957),r=()=>n(375447);const l=["reply_menu_all_updates","reply_menu_archive","reply_menu_mentions_comments"];function d(){const e=(0,i().K8)((()=>o().A.state.open&&l.includes(o().A.state.discussionLocation)),[]),t=(0,i().K8)((()=>r().Ay.getIsMockText()),[]),n=(0,i().K8)((()=>(0,s().lU)(a().default.state.mainEditorCurrentBlockStore)),[]);return!t&&!e&&!n}},342967:(e,t,n)=>{n.d(t,{v:()=>o});n(898992),n(354520);var i=()=>n(534177);function o(e,t){return Object.fromEntries((0,i().WP)({}).filter((([e,n])=>n.moduleId===t)))}},345578:(e,t,n)=>{n.d(t,{A:()=>l});n(296540);var i=()=>n(252291),o=()=>n(449552),s=()=>n(69708),a=()=>n(859428),r=n(474848);function l(){return(0,r.jsx)(a().A,{textWrap:!0,style:{width:210},placement:"bottom",renderTooltip:()=>(0,r.jsx)(s().sA,{id:"teamLockIcon.tooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,r.jsx)("div",{...e,style:{alignContent:"center"},children:(0,r.jsx)(i().I,{icon:o().g,size:"sm",colorVariant:"secondary"})})})}},349990:(e,t,n)=>{n.d(t,{l:()=>s});var i=()=>n(56366),o=()=>n(154060);function s(){return(0,i().K8)((()=>(0,o().A)()),[])}},375078:(e,t,n)=>{n.r(t),n.d(t,{maybeTurnCollectionViewIntoCollectionViewPage:()=>w,transformBlocks:()=>M,transformIntoColumnList:()=>j});n(581454);var i=()=>n(242422),o=()=>n(908006),s=()=>n(700500),a=()=>n(179034),r=()=>n(496603),l=()=>n(722101),d=()=>n(44729),c=()=>n(863168),u=()=>n(384944),p=()=>n(391214),g=()=>n(778417),m=()=>n(749804),f=()=>n(903864),h=()=>n(231297),v=()=>n(62287),y=()=>n(87017),b=()=>n(594794),S=()=>n(299545),x=()=>n(148832),A=()=>n(65269);function M(e){const{environment:t,blocks:n,blockType:A,transaction:M}=e;if(A!==s().xd.transclusionContainer)if(A===s().xd.callout&&i().default.checkGate({gateName:"create_v2_callouts"}))!function(e){const{environment:t,blocks:n,transaction:i}=e,o=n[0];if(!o)return;const r=o.getRecordStoreUIParent();if(!r||!(0,S().iU)(r))return;const l=r.getRecordStoreUIParent();if(!(l&&l instanceof x().B))return;const p=(0,b().Z1)({environment:t,table:a().ev,spaceId:l.getSpaceId()}),f=u().Wv({environment:t,id:p,type:s().xd.callout,inMemoryRecordCache:r.inMemoryRecordCache,transaction:i,spaceId:l.getSpaceId(),format:{callout_version:2}});d().NI({parentStore:r,childStore:f,after:o.id,transaction:i});k({newParentStore:f.getContentStore(),blocks:n,transaction:i}),c().s4({store:f,transaction:i}),(0,m().I)({environment:t}),g().IU({environment:t}),g().td({environment:t,stores:[f]})}({environment:t,blocks:n,transaction:M});else if(A!==s().xd.columnList)if(A!==s().xd.slide)if((0,s().ZK)(A)){const e=parseInt(A.replace("column","").replace("block","")),i=r().oE(r().Hn(e-1,(()=>y().insertTextBelow({environment:t,blocks:n,transaction:M})))),s=[...n,...i],a=j({environment:t,blocks:s,transaction:M});o().default.afterNextFlush((()=>{(0,f().e)({store:a[0].getBlockTitleStore()})}))}else for(const i of n)if(i.isCalloutV2()){const e=i.getParentBlockStore();if(e){const s=i.getContentStores();h().applyOperation({store:e,operation:{pointer:e.pointer,path:["content"],command:"insertChildrenAfter",args:{ids:s.map((e=>e.id)),after:i.id}},transaction:M}),d().zz({parentStore:e.getContentStore(),childStore:i,transaction:M});for(const e of s)v().pd({environment:t,block:e,blockType:A,transaction:M,isMultiBlockTransformation:n.length>1});o().default.afterNextFlush((()=>{p().dL(t,s.map((e=>e.id)))}))}}else v().pd({environment:t,block:i,blockType:A,transaction:M,isMultiBlockTransformation:n.length>1});else!function(e){const{environment:t,blocks:n,transaction:i}=e,o=n[0];if(!o)return;const r=o.getRecordStoreUIParent();if(!r||!(0,S().iU)(r))return;const l=r.getRecordStoreUIParent();if(!(l&&l instanceof x().B))return;const c=(0,b().Z1)({environment:t,table:a().ev,spaceId:l.getSpaceId()}),p=u().Wv({environment:t,id:c,type:s().xd.slide,inMemoryRecordCache:r.inMemoryRecordCache,transaction:i,spaceId:l.getSpaceId()});d().NI({parentStore:r,childStore:p,after:o.id,transaction:i});k({newParentStore:p.getContentStore(),blocks:n,transaction:i}),(0,m().I)({environment:t}),g().IU({environment:t}),g().td({environment:t,stores:[p]})}({environment:t,blocks:n,transaction:M});else j({environment:t,blocks:n,transaction:M});else!function(e){const{environment:t,blocks:n,transaction:i}=e,o=n[0];if(!o)return;const r=o.getRecordStoreUIParent();if(!r||!(0,S().iU)(r))return;const d=r.getRecordStoreUIParent();if(!d||!(0,S()._p)(d))return;if(!d.isDefined())return;const c=(0,b().Z1)({environment:t,table:a().ev,spaceId:d.getSpaceId()}),p=u().Wv({environment:t,id:c,type:s().xd.transclusionContainer,inMemoryRecordCache:r.inMemoryRecordCache,transaction:i,spaceId:d.getSpaceId()});l().WH({parentStore:r,insertStore:p,afterStore:o,transaction:i});k({newParentStore:p.getContentStore(),blocks:n,transaction:i}),(0,m().I)({environment:t}),g().IU({environment:t}),g().td({environment:t,stores:[p]})}({environment:t,blocks:n,transaction:M})}function w({environment:e,blocks:t,transaction:n}){(function(e){return 1===e.length&&"collection_view"===e[0].getType()})(t)&&M({environment:e,blocks:t,blockType:"collection_view_page",transaction:n})}function j(e){const{environment:t,blocks:n,transaction:i}=e,o=n[0];if(!o)return[];const r=o.recordStoreUIParentStore;if(null==r||!r.valueIs(A()._))return[];const d=(0,b().Z1)({environment:t,table:a().ev,spaceId:o.getSpaceId()}),c=u().Wv({environment:t,id:d,type:s().xd.columnList,inMemoryRecordCache:o.inMemoryRecordCache,transaction:i,spaceId:o.getSpaceId()}),{childStore:p}=l().nc({parentStore:r,insertStore:c,beforeStore:o,transaction:i});return n.map((e=>{const n=(0,b().Z1)({environment:t,table:a().ev,spaceId:o.getSpaceId()}),d=u().Wv({environment:t,id:n,type:s().xd.column,inMemoryRecordCache:o.inMemoryRecordCache,transaction:i,spaceId:o.getSpaceId()}),{childStore:c}=l().TF({parentStore:r,childToRemoveStore:e,transaction:i}),{childStore:g}=l().WH({parentStore:p.getContentStore(),insertStore:d,transaction:i}),{childStore:m}=l().WH({parentStore:g.getContentStore(),insertStore:c,transaction:i});return m}))}function k(e){const{newParentStore:t,blocks:n,transaction:i}=e;for(const o of n){const e=o.getRecordStoreUIParent();null!=e&&e.valueIs(A()._)&&(l().TF({parentStore:e,childToRemoveStore:o,transaction:i}),l().BC({parentStore:t,appendStore:o,transaction:i}))}}},378003:(e,t,n)=>{n.r(t),n.d(t,{CollectionMentionContextMenu:()=>_});n(296540);var i=()=>n(484714),o=()=>n(56366),s=()=>n(30537),a=()=>n(584262),r=()=>n(955363),l=()=>n(808764),d=()=>n(742852),c=()=>n(419942),u=()=>n(177256),p=()=>n(868840),g=()=>n(69708),m=()=>n(884107),f=()=>n(23111),h=()=>n(600449),v=()=>n(211716),y=()=>n(722872),b=()=>n(232930),S=()=>n(620558),x=()=>n(712505),A=()=>n(575143),M=()=>n(404277),w=()=>n(939740),j=()=>n(417392),k=()=>n(89924),I=()=>n(962036),C=n(474848);const T=(0,g().YK)({title:{id:"collectionMentionContextMenu.title",defaultMessage:"Data source"},openInNewTab:{id:"collectionMentionContextMenu.openInNewTab",defaultMessage:"Open in new tab"},openInNewWindow:{id:"collectionMentionContextMenu.openInNewWindow",defaultMessage:"Open in new window"},openInFullPage:{id:"collectionMentionContextMenu.openInFullPage",defaultMessage:"Open in full page"},openInSidePeek:{id:"collectionMentionContextMenu.openInSidePeek",defaultMessage:"Open in side peek"},copyLink:{id:"collectionMentionContextMenu.copyLink",defaultMessage:"Copy link"},learnMore:{defaultMessage:"Learn about data sources",id:"collectionMentionContextMenu.learnAboutDataSources"}});function _(){const e=(0,i().v3)(),t=(0,g().tz)(),{isActive:n,collectionStore:_}=(0,o().O$)(S().s),P=(0,o().K8)((()=>{const e=S().s.state;if(e.isActive)return new DOMRect(e.left,e.top,1,1)}),[]),B=(0,o().K8)((()=>x().default.isSidePeekOpen()),[]),D=()=>{f().V()};if(!n||!_)return null;const R={key:"open_in_new_window",render:(e,n)=>(0,C.jsx)(A().A,{...e,title:t.formatMessage(T.openInNewWindow),svg:l().U,onFocus:n.onFocus}),action:()=>{_&&((0,h().Zj)({environment:e,store:_,visitType:v().ig.Link,pageVisitSource:a().y8.LinkInPage,openInNew:"window"}),f().V())}},E={key:"open_in_full_page",render:(e,n)=>(0,C.jsx)(A().A,{...e,title:t.formatMessage(T.openInFullPage),svg:c().o,onFocus:n.onFocus}),action:()=>{_&&x().default.isSidePeekOpen()&&((0,h().Zj)({environment:e,store:_,visitType:v().ig.Link,pageVisitSource:a().y8.LinkInPage}),f().V())}},L={key:"open_in_side_peek",render:(e,n)=>(0,C.jsx)(A().A,{...e,title:t.formatMessage(T.openInSidePeek),svg:u().A,onFocus:n.onFocus}),action:()=>{_&&((0,h().Zj)({environment:e,store:_,visitType:v().ig.Link,pageVisitSource:a().y8.LinkInPage,peekMode:p().A}),f().V())}},O={key:"copy_link",render:(e,n)=>(0,C.jsx)(A().A,{...e,title:t.formatMessage(T.copyLink),svg:d().linkIcon,onFocus:n.onFocus}),action:async()=>{if(!_)return;(await m().R.clipboardActions.load()).copyLinkToCollection({environment:e,collectionStore:_}),f().V()}},N=[{key:"open_in_new_tab",render:(e,n)=>(0,C.jsx)(A().A,{...e,title:t.formatMessage(T.openInNewTab),svg:r().arrowDiagonalUpRightIcon,shortcut:"commandShiftEnter",onFocus:n.onFocus}),action:()=>{_&&((0,h().Zj)({environment:e,store:_,visitType:v().ig.Link,pageVisitSource:a().y8.LinkInPage,openInNew:"tab"}),f().V())}},...e.device.isNative?[R]:[],...B?[E]:[],L,O];return(0,C.jsx)(j().Ay,{open:n,popupType:s().n.Popup,originRect:P,placementToOrigin:"bottom",alignmentToOrigin:"start",originGap:4,preventScaleTransition:!0,render:()=>(0,C.jsxs)(M().A,{menuType:y().gu.Popup,width:265,children:[(0,C.jsx)(w().Ay,{type:w().Oh.Vertical,initialFocus:void 0,sections:[{key:"collection_mention_menu",render:e=>(0,C.jsx)(k().A,{...e,title:t.formatMessage(T.title)}),items:N}],onAccept:D}),(0,C.jsx)(k().A,{topBorder:!0,children:(0,C.jsx)(I().g,{title:t.formatMessage(T.learnMore),href:(0,b().x)("guides.dataSources"),analyticsFrom:"collection_mention_context_menu"})})]}),onDismiss:D,trapFocus:!1})}},391435:(e,t,n)=>{n.d(t,{Z:()=>w});n(944114),n(898992),n(354520),n(581454);var i=n(296540),o=()=>n(564884),s=()=>n(484714),a=()=>n(401497),r=()=>n(529324),l=()=>n(644161),d=()=>n(185078),c=()=>n(69708),u=()=>n(778078),p=()=>n(722872),g=()=>n(760217),m=()=>n(419357),f=()=>n(404277),h=()=>n(939740),v=()=>n(64e3),y=()=>n(460292),b=()=>n(89924),S=()=>n(662971),x=n(474848);const A=1,M=(0,c().YK)({sourceLanguage:{id:"translation.languageMenuList.sourceLanguage",defaultMessage:"From"},selectLanguage:{id:"translation.languageMenuList.selectLanguage",defaultMessage:"To"},detectedLanguage:{id:"translation.languageMenuList.detectedLanguage",defaultMessage:"Detected language"},preferredLanguage:{id:"translation.languageMenuList.preferredLanguage",defaultMessage:"Preferred language"},languageSearchPlaceholder:{id:"translation.languageMenuList.languageSearchPlaceholder",defaultMessage:"Search languagesâ€¦"}});function w(e){const{onSelectTargetLanguage:t,onSelectSourceLanguage:n,editorModeConfigTranslateState:r,sourceLanguage:d,detectedPageLanguage:u,preferredLanguage:p,subMenuPlacement:m,subMenuAlignment:f,pageId:v}=e,y=(0,s().v3)(),w=(0,c().tz)(),C="loading"===r.status,T=j(C),_=(0,a().IS)((e=>({menuItemSectionBottomBorder:{boxShadow:`${e.regularDividerColor} 0px 1px 0px`},...T})),[T]);(0,i.useEffect)((()=>{if("pre_activation"===r.status){const e=setTimeout((()=>{(0,o().u)({environment:y,event:{eventName:"translate_page_interaction",eventProperties:{type:"action_menu_rendered",page_id:v}}})}),750);return()=>clearTimeout(e)}}),[r.status,v,y]);const P=r.targetLanguage,B=I({disabled:C,filter:e=>d!==e,currentSelectedLanguage:r.targetLanguage,onSelectLanguage:e=>{t({targetLanguage:e})}});return(0,x.jsx)(h().Ay,{initialFocus:A,type:h().Oh.Vertical,disableInitialScroll:!0,sections:[{key:"sourceLanguage",render:e=>(0,x.jsx)(b().A,{...e,title:w.formatMessage(M.sourceLanguage),desktopTitleStyle:{marginInlineStart:2,marginInlineEnd:2},style:_.menuItemSectionBottomBorder}),items:[{key:d,render:(e,{onFocus:t})=>(0,x.jsx)(S().A,{...e,onFocus:t,disableDefaultClick:!0,placementToOrigin:m,alignmentToOrigin:f,renderOrigin:(e,t)=>(0,x.jsx)(g().A,{...e,disabled:C,buttonStyle:_.button,ref:t,title:w.formatMessage((0,l().Bj)(d)),caption:d===u?w.formatMessage(M.detectedLanguage):d===p?w.formatMessage(M.preferredLanguage):void 0}),renderExtension:e=>(0,x.jsx)(k,{disabled:C,extensionPopupButtonEvents:e,currentTargetLanguage:P,sourceLanguage:d,onSelectSourceLanguage:n})}),action:()=>{}}]},{key:"selectLanguage",render:e=>(0,x.jsx)(b().A,{...e,title:w.formatMessage(M.selectLanguage),desktopTitleStyle:{marginInlineStart:2,marginInlineEnd:2}}),items:B}]})}function j(e){return(0,a().IS)((t=>({button:{color:e?t.text.tertiary:t.text.primary}})),[e])}function k(e){const{extensionPopupButtonEvents:t,currentTargetLanguage:n,disabled:i,sourceLanguage:o,onSelectSourceLanguage:a}=e,{isMobile:r}=(0,s().Y0)(),l=I({disabled:i,filter:e=>e!==n,currentSelectedLanguage:o,onSelectLanguage:e=>{a({sourceLanguage:e})}}),d=r?{menuType:p().gu.ActionSheet,...t}:{menuType:p().gu.Popup,width:200,height:380,...t};return(0,x.jsx)(f().A,{...d,onClick:e=>{e.preventDefault()},children:(0,x.jsx)(h().Ay,{initialFocus:void 0,type:h().Oh.Vertical,sections:[{key:"originalLanguage",render:e=>(0,x.jsx)(b().A,{...e}),items:l}]})})}function I(e){const{disabled:t,filter:n,currentSelectedLanguage:o,onSelectLanguage:s}=e,a=(0,c().tz)(),[p,f]=(0,i.useState)(""),h=j(t),b=(0,i.useMemo)((()=>({key:"language-search-input",render:e=>(0,x.jsx)(m().Ay,{...e,disabled:t,placeholder:a.formatMessage(M.languageSearchPlaceholder),value:p,onChange:e=>f(e.target.value),focus:!0,inputLeft:(0,x.jsx)(y().Q,{iconGroup:r().C,colorPalette:"gray",colorVariant:"accentPrimary",variantName:"default"})}),action:()=>{}})),[p,t,a]),S=(0,i.useMemo)((()=>({key:"no-results",render:()=>(0,x.jsx)(v().A,{title:(0,x.jsx)(c().sA,{defaultMessage:"No results found",id:"TranslationLanguageMenuList.noResults"})}),action:()=>{}})),[]),A=(0,i.useMemo)((()=>{const e=[];for(const t of d().hr)if(n(t)){const n=a.formatMessage((0,l().Bj)(t));e.push({languageCode:t,languageName:n})}return e.sort(((e,t)=>e.languageName.localeCompare(t.languageName)))}),[n,a]),w=(0,i.useMemo)((()=>(0,u().Ay)(p,A,(({languageName:e})=>e.toLowerCase()))),[p,A]),k=(0,i.useMemo)((()=>w.map((({languageCode:e,languageName:n})=>({key:e,render:i=>(0,x.jsx)(g().A,{...i,buttonStyle:h.button,disabled:t,title:n,isChecked:o===e}),action:()=>{t||s(e)}})))),[w,t,o,s,h.button]);return 0===k.length?[b,S]:[b,...k]}},392331:(e,t,n)=>{n.r(t),n.d(t,{NotionCalendarLaunchModal:()=>L});var i=n(296540),o=()=>n(726637),s=()=>n(662303),a=()=>n(484714),r=()=>n(56366),l=()=>n(401497),d=()=>n(252291),c=()=>n(631524),u=()=>n(160432),p=()=>n(218275),g=()=>n(671089),m=()=>n(16789),f=()=>n(69708),h=()=>n(284371),v=()=>n(40970),y=()=>n(27579),b=()=>n(949237),S=()=>n(802790),x=()=>n(125565),A=()=>n(687039),M=()=>n(581495),w=()=>n(232930),j=()=>n(300789),k=()=>n(51367),I=()=>n(218429),C=()=>n(765957),T=()=>n(865241),_=()=>n(645200),P=()=>n(694498),B=()=>n(20022),D=n(474848);const R=(0,f().YK)({getNotionCalendar:{id:"notionCalendarLaunchButton.getNotionCalendar",defaultMessage:"Get Notion Calendar"},downloadApp:{id:"notionCalendarLaunchButton.downloadApp",defaultMessage:"Download app"},openCalendar:{id:"notionCalendarLaunchButton.openCalendar",defaultMessage:"Open Calendar"}});const E=function({style:e,openCalendarFrom:t,getNotionCalendarFrom:s,onOpenCalendarClick:d,onGetNotionCalendarClick:c,onDownloadClick:p}){const g=(0,a().v3)(),m=(0,l().IS)((t=>({button:{marginInlineStart:8,whiteSpace:"nowrap",...e}})),[e]),h=(0,r().K8)((()=>(0,n(583238).mX)()),[]),v=(0,r().K8)((()=>C().default.state.sidebarSpaceStore&&(0,n(686070).d)({spaceStore:C().default.state.sidebarSpaceStore})),[]),[{value:b}]=(0,n(187174).Yb)((async()=>!(null===B().Ht||void 0===B().Ht||!B().Ht.isProtocolRegistered)&&B().Ht.isProtocolRegistered(o().A.calendar.desktopProtocol)),[]),S=(0,i.useCallback)((()=>{_().Op({environment:g,spaceStore:void 0,collectionViewStore:void 0,from:t}),null==d||d()}),[g,t,d]),x=(0,i.useCallback)((()=>{const{currentUserSettingsStore:e,sidebarSpaceStore:t}=C().default.state;e&&t&&(_().Op({environment:g,spaceStore:t,collectionViewStore:void 0,from:s}),null==c||c())}),[g,s,c]),A=(0,i.useCallback)((()=>{(0,y().L)({environment:g,url:o().A.calendar.downloadUrl}),null==p||p()}),[g,p]);return g.device.isElectron?b?(0,D.jsx)(u().A,{colorPalette:"blue",style:m.button,size:"lg",onClick:S,children:(0,D.jsx)(f().sA,{...R.openCalendar})}):(0,D.jsx)(u().A,{colorPalette:"blue",style:m.button,size:"lg",onClick:A,children:(0,D.jsx)(f().sA,{...R.downloadApp})}):h||v?(0,D.jsx)(u().A,{colorPalette:"blue",style:m.button,size:"lg",onClick:S,children:(0,D.jsx)(f().sA,{...R.openCalendar})}):(0,D.jsx)(u().A,{style:m.button,size:"lg",onClick:x,children:(0,D.jsx)(f().sA,{...R.getNotionCalendar})})};function L(){const e=(0,a().v3)(),t=(0,l().IS)((e=>({container:{maxWidth:442},closeButton:{position:"absolute",top:12,insetInlineEnd:12,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.outlineButtonPressedBackground,width:18,height:18},closeButtonHovered:{background:e.outlineButtonPressedBackground},content:{padding:24,display:"flex",flexDirection:"column"},title:{fontWeight:h().Wy.bold,fontSize:25,display:"flex",marginBottom:6},divider:{backgroundColor:e.tableLightDividerColor,opacity:.5},footer:{padding:"20px 24px",display:"flex",alignItems:"center",justifyContent:"space-between"},successTitle:{fontSize:25,fontWeight:h().Wy.bold,margin:"8px 0"},downloadContainer:{display:"flex",padding:"16px 20px",marginTop:28,borderRadius:12,background:e.cardBackground},downloadContent:{display:"flex",flexDirection:"column",paddingInlineEnd:8},downloadTitle:{fontSize:16,fontWeight:h().Wy.semibold,marginBottom:4},downloadButtonContainer:{display:"flex"},downloadButton:{height:32,marginTop:12},notionCalendarLogo:{display:"flex",alignSelf:"end"}})),[]);(0,i.useEffect)((()=>{const t=()=>{T().A.state.isVisible&&P().A.state.isConnectingCalendar&&(P().A.setState({isConnectingCalendar:!1}),b().oX({environment:e}))};return T().A.addListener(t),()=>{T().A.removeListener(t)}}),[e]);const n=(0,r().K8)((()=>P().A.state.signupCtaAttribution||"onboardingModalSignIn"),[]),B=(0,i.useCallback)((()=>{const{currentUserSettingsStore:t}=C().default.state;t&&(k().Sq(e,{callout_key:"notion_calendar_launch_promo",dismiss_type:"modal_dismiss_clicked",placement_key:"Modal"}),j().a(e,"notion_calendar_launch_promo"),_().MR({environment:e,userSettingsStore:t}),P().A.setState({signupCtaAttribution:void 0}))}),[e]),L=(0,i.useCallback)((()=>{const{currentUserSettingsStore:t,sidebarSpaceStore:n}=C().default.state;t&&n&&(k().Y5(e,{callout_key:"notion_calendar_launch_promo",click_type:"primary_cta",placement_key:"Modal"}),j().a(e,"notion_calendar_launch_promo"),_().rI(e,{phase:"dismissed_completely",transactionUserAction:"NotionCalendarLaunchModal.openCalendar",userSettingsStore:t}))}),[e]),N=(0,i.useCallback)((()=>{const{currentUserSettingsStore:t,sidebarSpaceStore:n}=C().default.state;t&&n&&(k().Y5(e,{callout_key:"notion_calendar_launch_promo",click_type:"primary_cta",placement_key:"Modal"}),e.device.isElectron&&j().a(e,"notion_calendar_launch_promo"),_().rI(e,{phase:"connected_notion_calendar",transactionUserAction:"NotionCalendarLaunchModal.getNotionCalendar",userSettingsStore:t}))}),[e]),F=(0,i.useCallback)((()=>{const{currentUserSettingsStore:t}=C().default.state;t&&(k().Y5(e,{callout_key:"notion_calendar_launch_promo",click_type:"primary_cta",placement_key:"Modal"}),j().a(e,"notion_calendar_launch_promo"),_().rI(e,{phase:"dismissed_completely",transactionUserAction:"NotionCalendarLaunchModal.clickDownload",userSettingsStore:t}))}),[e]),U=(0,r().K8)((()=>{var e;const t=null===(e=C().default.state.currentUserSettingsStore)||void 0===e?void 0:e.getSettings();return null==t?void 0:t.notion_calendar_launch_modal_phase}),[]),z=()=>(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(M().Rz,{onClick:B}),(0,D.jsxs)("div",{style:t.content,children:[(0,D.jsx)(d().I,{icon:g().checkmarkCircleIcon,size:"xl",colorVariant:"secondary"}),(0,D.jsx)("div",{style:t.successTitle,children:(0,D.jsx)(f().sA,{defaultMessage:"Success!",id:"notionCalendarLaunchModal.successTitle"})}),(0,D.jsx)(x().A,{isSecondaryColor:!0,isMultiline:!0,children:(0,D.jsx)(f().sA,{defaultMessage:"You can now view Notion docs, projects, tasks, and timelines alongside calendar events on Notion Calendar",id:"notionCalendarLaunchModal.successCaption"})}),(0,D.jsxs)("div",{style:t.downloadContainer,children:[(0,D.jsxs)("div",{style:t.downloadContent,children:[(0,D.jsx)("div",{style:t.downloadTitle,children:(0,D.jsx)(f().sA,{defaultMessage:"Get the desktop app",id:"notionCalendarLaunchModal.downloadTitle"})}),(0,D.jsx)(x().A,{isSecondaryColor:!0,isMultiline:!0,children:(0,D.jsx)(f().sA,{defaultMessage:"See notifications, view your schedule, and join meetings from anywhere",id:"notionCalendarLaunchModal.downloadCaption"})}),(0,D.jsx)("div",{style:t.downloadButtonContainer,children:(0,D.jsx)(u().A,{colorPalette:"blue",style:t.downloadButton,onClick:()=>{v().Lt(e,{cta:"download"}),(0,y().L)({environment:e,url:o().A.calendar.downloadUrl}),F()},children:(0,D.jsx)(f().sA,{...R.downloadApp})})})]}),(0,D.jsx)("div",{style:t.notionCalendarLogo,children:(0,D.jsx)(d().I,{icon:m().notionCalendarIcon,size:56})})]})]})]}),K=()=>(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(A().Ay,{src:"https://player.vimeo.com/video/900939588?h=187435ef3c",defaultTextTrack:A().VH[s().locale]||"en",options:{muted:!0,autoplay:!0,loop:!0,background:!0,playsinline:!0}}),(0,D.jsx)(M().Rz,{style:t.closeButton,hoveredStyle:t.closeButtonHovered,onClick:B}),(0,D.jsxs)("div",{style:t.content,children:[(0,D.jsx)("div",{style:t.title,children:(0,D.jsx)(f().sA,{defaultMessage:"Meet Notion Calendar",id:"notionCalendarLaunchModal.title"})}),(0,D.jsxs)(x().A,{isSecondaryColor:!0,isMultiline:!0,children:[(0,D.jsx)(f().sA,{defaultMessage:"The beautifully designed calendar for your life and work. Integrated and synced with all your calendar events.",id:"notionCalendarLaunchModal.caption"})," "]})]}),(0,D.jsx)(S().A,{size:1,style:t.divider}),(0,D.jsxs)("div",{style:t.footer,children:[(0,D.jsx)(c().p,{colorPalette:"gray",href:(0,w().x)("blog.notionCalendarLaunch"),external:!0,iconTrailing:{icon:p().arrowUpRightSquareSmallIcon,size:"sm"},children:(0,D.jsx)(f().sA,{defaultMessage:"Learn more",id:"notionCalendarLaunchModal.learnMore"})}),(0,D.jsx)(E,{openCalendarFrom:"onboardingModalOpenCalendar",getNotionCalendarFrom:n,onOpenCalendarClick:()=>{v().be(e,{cta:"open_calendar"}),L()},onGetNotionCalendarClick:()=>{v().be(e,{cta:"get_calendar"}),N()},onDownloadClick:()=>{v().be(e,{cta:"download"}),F()}})]})]});return(0,D.jsx)(I().l,{messageKey:"notion_calendar_launch_promo",desktopRenderInner:()=>(0,D.jsx)(O,{launchModalPhase:U,renderChild:()=>"connected_notion_calendar"===U?z():K()}),desktopInnerStyle:t.container,desktopOnDismiss:B,phoneRenderInner:()=>null})}function O({launchModalPhase:e,renderChild:t}){const n=(0,a().v3)();return(0,i.useEffect)((()=>{"connected_notion_calendar"===e?v().Y8(n):v().aq(n)}),[n,e]),t()}},396831:(e,t,n)=>{n.d(t,{A:()=>i});const i=new(n(150669).A)},403733:(e,t,n)=>{n.r(t),n.d(t,{arrowStraightDownSmallIcon:()=>o,iconDefinition:()=>i});n(296540);const i={viewBox:"0 0 16 16",fittedViewBox:"3.05 2.12 9.9 11.76",svg:(0,n(474848).jsx)("path",{d:"M8 2.125a.61.61 0 0 0-.625.599v9.017L4.122 8.488a.625.625 0 1 0-.884.884l4.32 4.32c.244.244.64.244.884 0l4.32-4.32a.625.625 0 0 0-.884-.884l-3.253 3.253V2.724A.61.61 0 0 0 8 2.125"})},o=(0,n(340498).wt)("arrowStraightDownSmall",i)},417242:(e,t,n)=>{n.r(t),n.d(t,{MobileShareMenuRenderer:()=>g});var i=n(296540),o=()=>n(484714),s=()=>n(56366),a=()=>n(482707),r=()=>n(321172),l=()=>n(765957),d=()=>n(529183),c=()=>n(538233),u=()=>n(417392),p=n(474848);function g(e){const t=(0,o().Y0)(),n=(0,s().O$)(c().A),a=(0,o().v3)(),d=(0,s().O$)(l().AppStoreMainEditorCurrentBlockStore),g=(0,i.useCallback)((()=>{(0,r().XP)({environment:a,store:d})}),[a,d]);return t.isMobile?(0,p.jsx)(u().Ay,{popupType:u().nl.BottomSheet,bottomSheetInitialState:"full",trapFocus:!0,open:n.open,render:()=>(0,p.jsx)(m,{menuState:n,onClose:g}),onDismiss:g}):null}function m(e){const t=(0,s().uB)(void 0,d().Ay),n=(0,s().O$)(l().AppStoreMainEditorCurrentBlockStore);return e.menuState.open&&n?(0,p.jsx)(a().k,{store:n,buttonPopupStore:c().A,location:"topbar_mobile",onClose:e.onClose,inviteTargetsStore:t}):null}},421861:(e,t,n)=>{n.d(t,{i:()=>b});var i=n(296540),o=()=>n(726637),s=()=>n(56366),a=()=>n(764880),r=n(474848);const l={viewBox:"0 0 16 16",fittedViewBox:"2.49 2.19 11.01 11.97",svg:(0,r.jsx)("path",{d:"m4.145 2.922-.228-.265a.55.55 0 1 0-.835.716l1.49 1.739a3.9 3.9 0 0 0-.46 1.836v.895a2.78 2.78 0 0 1-.686 1.83l-.617.703c-.708.81-.133 2.078.943 2.078h2.2a2.081 2.081 0 0 0 4.095 0h.819l1.216 1.419a.55.55 0 0 0 .843-.707L4.152 2.931zm1.068 4.026q.002-.482.152-.912l4.558 5.318h-6.17a.153.153 0 0 1-.116-.253l.616-.705c.619-.706.96-1.614.96-2.553zm1.773 5.506h2.028a1.081 1.081 0 0 1-2.028 0m6.302-.554a1.244 1.244 0 0 0-.098-1.524l-.616-.704a2.78 2.78 0 0 1-.687-1.829v-.895a3.89 3.89 0 0 0-2.124-3.465 1.85 1.85 0 0 0-3.526 0l-.112.06.737.86.062-.027.29-.121.043-.312A.75.75 0 0 1 8 3.29c.378 0 .692.281.743.653l.042.312.29.121a2.79 2.79 0 0 1 1.712 2.572v.895c0 .513.101 1.016.294 1.482z"})},d=(0,n(340498).wt)("bellSlashSmall",l);var c=()=>n(69708),u=()=>n(534177),p=()=>n(284371),g=()=>n(486674),m=()=>n(646736),f=()=>n(765957),h=()=>n(231704),v=()=>n(313171);function y(e,t){const{user:i,focused:l}=e,u=(0,n(484714).v3)(),m=(0,c().tz)(),h=(0,n(401497).IS)((e=>({icon:{width:17,height:17,fill:e.icon.secondary},tooltip:{color:e.text.inverseSecondary,fontWeight:p().Wy.regular,maxWidth:240},tooltipHeader:{color:e.text.inversePrimary,fontWeight:p().Wy.medium}})),[]),v=(0,a().A7)(i),y=(0,a().lR)(m,v),b=(0,s().K8)((()=>{const e=(0,g().a)();return!(e&&(0,n(928074).Aj)({store:e}))||"none"!==(0,n(329443).om)(i.id)}),[i.id]),A=(0,s().K8)((()=>{var e;return i.id===(null===(e=f().default.state.currentUserStore)||void 0===e?void 0:e.id)}),[i.id]),M=(0,n(341694).H)(),w=(0,s().K8)((()=>{if(!M)return;if(!l)return;if(b)return;const e=(0,g().a)(),t=e&&Boolean(n(763884).K.get({userId:u.currentUser.id,key:(0,n(773706).T)(e.id)})),i=null==e?void 0:e.canAdmin();return!t&&i?(0,n(97835).inviteMemberIcon)(h.icon):d(h.icon)}),[M,u.currentUser.id,b,l,h.icon]),j=(0,s().K8)((()=>{if(!M)return null;const e=i.email;return(0,r.jsxs)("div",{style:h.tooltip,children:[(0,r.jsx)("header",{style:h.tooltipHeader,children:(0,r.jsx)(x,{userName:y,userHasAccessToPage:b,userIsSelf:A})}),e]})}),[M,b,A,y,i.email,h.tooltip,h.tooltipHeader]);return(0,r.jsx)(n(457688).A,{...e,ref:t,actor:v,right:w,tooltip:j,badge:(0,r.jsx)(S,{user:i}),tooltipPlacement:M?"right":void 0,useEmailAsTooltip:!M,customUserTitleStyles:o().A.isMobile?{fontSize:14}:void 0,iconSizeOverride:o().A.isMobile?24:void 0})}const b=i.forwardRef(y);function S({user:e}){const t=(0,s().O$)(f().AppStoreSidebarSpaceStore),n=(0,s().K8)((()=>{var n;if(t)return null===(n=(0,m().dp)(t,e.id))||void 0===n?void 0:n.getMembershipType()}),[t,e.id]);if(!n)return null;switch(n){case"none":case"member":case"membership_admin":case"owner":return null;case"page_guest":return(0,r.jsx)(h().w,{labelType:"guest"});case"restricted_member":return(0,r.jsx)(v().L,{});default:(0,u().HB)(n)}}function x({userName:e,userHasAccessToPage:t,userIsSelf:n}){return n?(0,r.jsx)(c().sA,{defaultMessage:"You",id:"activitySection.authorPhrase.forOneAuthorCurrentUser.label"}):t?null:(0,r.jsx)(c().sA,{id:"mentionMenu.UserMentionMenuItem.noAccessTooltip",defaultMessage:"{userName} wonâ€™t be notified because they donâ€™t have page access",values:{userName:e}})}},423817:(e,t,n)=>{n.d(t,{J:()=>a});n(581454),n(296540);var i=()=>n(401497),o=()=>n(710149),s=n(474848);function a(e){let t=Math.floor(e.areaHeight/124);0===t&&(t=1);const n=(0,i().IS)((e=>({skeletonRect:{height:8,borderRadius:4,margin:10,backgroundColor:e.lightDividerColor},skeletonCircle:{display:"flex",width:28,height:28,marginInlineEnd:8,backgroundColor:e.lightDividerColor,borderRadius:20},skeletonSection:{display:"flex",width:"100%",margin:20,flexDirection:"row"}})),[8,10,20]),a=[...Array(t)].map(((e,t)=>(0,s.jsxs)("div",{style:n.skeletonSection,children:[(0,s.jsx)(o().A,{style:n.skeletonCircle}),(0,s.jsxs)("div",{style:{width:"80%"},children:[(0,s.jsx)(o().A,{style:{width:"80%",...n.skeletonRect,marginTop:0}}),(0,s.jsx)(o().A,{style:{width:"50%",...n.skeletonRect}}),(0,s.jsx)(o().A,{style:{width:"60%",...n.skeletonRect}}),(0,s.jsx)(o().A,{style:{width:"50%",...n.skeletonRect}})]})]},t)));return(0,s.jsx)("div",{children:a})}},429816:(e,t,n)=>{n.d(t,{A:()=>S});n(898992),n(672577),n(737550);var i=n(296540),o=()=>n(242422),s=()=>n(417553),a=()=>n(484714),r=()=>n(921912),l=()=>n(953448),d=()=>n(741496),c=()=>n(845955),u=()=>n(544198),p=()=>n(494043),g=()=>n(753721),m=()=>n(695625),f=()=>n(407054),h=()=>n(732770),v=()=>n(871399),y=()=>n(502438),b=n(474848);function S(e){const t=(0,a().v3)(),o=(0,l().J)(),[d,c]=(0,i.useState)([]),u=(0,g().X)();(0,i.useEffect)((()=>{(async()=>{if(u){const e=await n.e(15498).then(n.bind(n,556982));c(e.lowPriActionsWithKeyboardShortcuts)}})()}),[u]);const p=(0,i.useRef)(),m=(0,i.useRef)();(0,i.useEffect)((()=>{function e(e){e.clientX===p.current&&e.clientY===m.current||(p.current=e.clientX,m.current=e.clientY,h().A.setKeyboardMode(!1))}return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}}),[]);const f=(0,i.useMemo)((()=>[...r().D0,...d]),[d]),v=(0,i.useMemo)((()=>function(e,t,n){const i={};for(const o of t)for(const s of o.shortcuts)i[s]=i=>A(s,i,e,t,n);return i}(t,f,o)),[t,f,o]);return(0,b.jsx)(s().k,{debugName:e.debugName,priority:e.priority,enable:e.capture,shortcuts:v})}function x(){return!function(){const e=document.querySelector("#intercom-container");return!(!e||!e.contains(document.activeElement))}()&&!(f().A.state.isActive&&!o().default.checkGate({gateName:"block_menu_shortcut_fix"}))}function A(e,t,n,i,s){if(!x())return;const a=y().default.state.stores,r=y().default.state.pivot||a[0],l=r&&m().T.getRectFromStore(r),g=i.find((t=>!!t.shortcuts.some((t=>t===e))&&c().F6(t,{environment:n,blocks:a,originRect:l,publicEditMode:void 0})));if(g){"keydown"===t.type&&t.preventDefault&&t.preventDefault();const e=f().A.state.isActive;g.action({environment:n,blocks:a,originRect:l,publicEditMode:void 0,analyticsFrom:"keyboard_shortcut",lazyDependencies:s},t);const i=a[0];let r,c,m;i&&(r=i.getType(),c=r?(0,p().Yt)(r,i.getFormat()):void 0,m=i.getParentCollectionIdUpToTwoLevels());const{collectionId:y,ownedCollectionCount:S,linkedCollectionCount:x}=(0,u().P)(i,{skipPages:!0});(0,d().N)(n,{analyticsName:g.analyticsName,action_type:g.analyticsActionType,from:"keyboard_shortcut",block_id:null==i?void 0:i.id,block_type:r,is_toggleable:c,collection_id:y,owned_collection_count:S,linked_collection_count:x,parent_collection_id:m}),b={resetBlockMenuStore:e},h().A.setKeyboardMode(!0),v().default.reset(),o().default.checkGate({gateName:"block_menu_shortcut_fix"})&&b.resetBlockMenuStore&&f().A.reset()}var b}},430923:(e,t,n)=>{n.d(t,{DV:()=>l,W5:()=>a,l7:()=>r,zS:()=>s});var i=()=>n(645873);const o={CollectionNewViewPopupComponent:new(i().O2)("CollectionNewViewPopupComponent",(async()=>await n.e(49875).then(n.bind(n,368275)))),CollectionViewSelect:new(i().O2)("CollectionViewSelect",(async()=>await n.e(35756).then(n.bind(n,445689)))),CollectionLinkExistingModal:new(i().O2)("CollectionLinkExistingModal",(async()=>await Promise.all([n.e(9773),n.e(36556),n.e(40537),n.e(55373),n.e(36192),n.e(96346),n.e(44711),n.e(53321),n.e(90825),n.e(33253),n.e(87249),n.e(71621),n.e(88924),n.e(92845),n.e(56369),n.e(5834),n.e(48486),n.e(2411),n.e(89296),n.e(46414),n.e(9294),n.e(11676),n.e(91256),n.e(40563),n.e(67494),n.e(44584),n.e(53141),n.e(4422),n.e(4330),n.e(55162),n.e(22001),n.e(71386),n.e(4351),n.e(6331),n.e(69144),n.e(12341),n.e(96402),n.e(5287)]).then(n.bind(n,901226)))),ModalOverlayCollectionView:new(i().O2)("ModalOverlayCollectionView",(async()=>await Promise.all([n.e(9773),n.e(36556),n.e(40537),n.e(87249),n.e(71621),n.e(88924),n.e(92845),n.e(56369),n.e(5834),n.e(48486),n.e(2411),n.e(95541),n.e(1397),n.e(32413)]).then(n.bind(n,700868))))},s=(0,i()._h)(o.CollectionNewViewPopupComponent,(e=>e.CollectionNewViewPopupComponent)),a=(0,i()._h)(o.CollectionViewSelect,(e=>e.CollectionViewSelect)),r=(0,i()._h)(o.CollectionLinkExistingModal,(e=>e.CollectionLinkExistingModal)),l=(0,i()._h)(o.ModalOverlayCollectionView,(e=>e.ModalOverlayCollectionView))},444393:(e,t,n)=>{n.r(t),n.d(t,{TopbarMoreMenu:()=>kn});var i=n(296540),o=()=>n(242422),s=()=>n(484714),a=()=>n(56366),r=()=>n(401497),l=()=>n(381138),d=()=>n(69708),c=()=>n(284371),u=(n(16280),n(18107),n(967357),n(898992),n(672577),n(581454),n(737550),()=>n(314529)),p=()=>n(662303),g=()=>n(929219),m=()=>n(584262),f=()=>n(700500),h=()=>n(112665),v=()=>n(104077),y=()=>n(274570),b=()=>n(340498),S=n(474848);const x={viewBox:"0 0 20 20",fittedViewBox:"1.85 4.78 15.81 13.4",svg:(0,S.jsx)("path",{d:"M14.029 7.244q.814 0 1.419.362.502.306.845.856V7.418h1.36v7.336c0 1.053-.297 1.893-.9 2.506s-1.438.914-2.492.914c-1.143 0-2.066-.35-2.755-1.06l-.063-.065.06-.07.681-.797.071-.083.076.079q.751.78 1.945.781c.688 0 1.187-.182 1.515-.527.328-.347.502-.876.502-1.606v-.974a2.56 2.56 0 0 1-.845.857q-.605.363-1.42.362c-.937 0-1.682-.351-2.224-1.054-.54-.71-.805-1.666-.805-2.86s.265-2.145.804-2.844c.542-.713 1.288-1.069 2.226-1.069m.449 1.23c-.645 0-1.138.195-1.492.577-.356.383-.54.903-.54 1.57v1.073c0 .668.184 1.187.54 1.57.354.382.847.578 1.492.578q.785-.002 1.304-.387c.34-.25.51-.597.51-1.05V9.91c0-.453-.17-.8-.51-1.05q-.52-.384-1.304-.386M9.896 14.97l.04.13h-1.5l-.021-.072-.834-2.813H4.176l-.834 2.813-.02.072H1.85l.04-.13L5.013 4.78h1.758zm-5.371-4.014h2.707L5.877 6.303z"})},A=(0,b().wt)("fontStyleMono",x),M={viewBox:"0 0 20 20",fittedViewBox:"1.56 4.81 16.88 13.21",svg:(0,S.jsx)("path",{d:"M14.735 7.265q.716 0 1.154.238.443.239.686.552t.373.542h.114V7.363h1.373v7.82q0 .98-.453 1.607-.452.63-1.228.93a4.7 4.7 0 0 1-1.725.303q-.894 0-1.542-.234a3.1 3.1 0 0 1-1.053-.616 2.7 2.7 0 0 1-.621-.83l1.193-.558q.14.215.367.468.234.253.632.433.398.178 1.034.178.865 0 1.427-.418.566-.417.566-1.332v-1.512h-.093q-.135.235-.383.538a2.1 2.1 0 0 1-.687.522q-.437.225-1.148.224a3.16 3.16 0 0 1-1.636-.428q-.726-.433-1.149-1.263-.422-.835-.422-2.047 0-1.204.413-2.074.418-.875 1.143-1.343a3 3 0 0 1 1.665-.466m.274 1.213q-.69 0-1.154.352a2.16 2.16 0 0 0-.69.955q-.229.601-.23 1.347.001.76.235 1.338.234.576.695.904.462.323 1.144.323.656 0 1.11-.307.456-.31.69-.881.239-.577.239-1.377 0-.786-.234-1.382-.229-.601-.686-.935-.453-.337-1.12-.337M10.58 15H9.032l-.956-2.744h-4.01L3.111 15H1.565l3.68-10.182h1.65zm-6.083-3.982h3.15L6.11 6.608h-.08z"})},w=(0,b().wt)("fontStyleSans",M),j={viewBox:"0 0 20 20",fittedViewBox:"1.28 4.68 17.44 14.08",svg:(0,S.jsx)("path",{d:"M14.83 7.666c.688 0 1.17.164 1.75.367l2.029-.219.111-.011v1.116l-.105-.006-1.474-.077c.332.338.635.862.635 1.57 0 1.68-1.523 2.74-3.035 2.74q-.54 0-1.04-.166a1.7 1.7 0 0 0-.325.332.53.53 0 0 0-.114.295c0 .153.164.39.45.402h.002l2.787.162c.742.045 1.295.234 1.662.54.37.309.543.729.543 1.212 0 .654-.42 1.364-1.174 1.905-.757.543-1.859.924-3.248.924-.713 0-1.4-.15-1.91-.443-.513-.294-.86-.74-.86-1.324 0-.59.396-1.24 1.13-1.636l.251-.138-.967-.927-.049-.046.025-.062c.283-.723.597-1.104 1.092-1.531-.647-.441-1.099-1.17-1.099-2.18 0-1.67 1.306-2.799 2.933-2.799m-1.212 7.726a2.8 2.8 0 0 0-.356.492c-.127.225-.22.476-.22.718 0 .243.108.543.4.784.292.24.777.428 1.535.428 1.79 0 2.466-.852 2.466-1.449 0-.233-.075-.412-.237-.543-.168-.134-.439-.228-.85-.257zm1.123-6.95c-.408 0-.725.15-.942.426-.219.28-.344.697-.344 1.243 0 .71.148 1.265.404 1.637.253.368.614.564 1.059.565.708 0 1.316-.629 1.316-1.714 0-.776-.174-1.316-.444-1.66a1.28 1.28 0 0 0-1.05-.498m-4.433 5.558 1.025.332v.66h-3.99v-.664l.074-.02 1.149-.312-.84-2.412H4.268l-.8 2.244 1.324.483.066.024v.656H1.28v-.64l.063-.025.815-.323 3.568-9.016.022-.053.057-.01.488-.071.517-.147.089-.025zm-5.643-3.501h2.681L6.017 6.703z"})},k=(0,b().wt)("fontStyleSerif",j);var I=()=>n(735790),C=()=>n(11356),T=()=>n(435644);const _={viewBox:"0 0 20 20",fittedViewBox:"1.89 4.31 16.61 11.72",svg:(0,S.jsx)("path",{d:"m8.965 12.538 1.125 3.077a.625.625 0 1 0 1.174-.43L7.526 4.961a.987.987 0 0 0-1.854 0L1.934 15.185a.625.625 0 1 0 1.174.43l1.125-3.078zm-.457-1.25H4.69l1.909-5.223zm7.334 4.554a.625.625 0 0 1-.884 0l-2.475-2.475a.625.625 0 0 1 .884-.884l1.408 1.408V4.994a.625.625 0 1 1 1.25 0v8.897l1.408-1.408a.625.625 0 1 1 .884.884z"})},P=(0,b().wt)("textSmall",_);var B=()=>n(470020),D=()=>n(100622),R=()=>n(496603),E=()=>n(896628),L=()=>n(696384),O=()=>n(384944),N=()=>n(231297),F=()=>n(799832),U=()=>n(930545),z=()=>n(575143),K=()=>n(89924),V=()=>n(718827),q=()=>n(553965),W=()=>n(939740),G=()=>n(859428),H=()=>n(125565);function Y(e,t){return e.isFiltering?function(e){return(0,S.jsx)(z().A,{...e,title:e.caption,caption:void 0})}(e):function({id:e,caption:t,focused:n,isActive:o,onClick:a,onMouseDown:l,onMouseEnter:d,onMouseLeave:c,role:u,style:p,tooltip:g,ignoreLocalHoverState:m,disallowTabbing:f},h){const v=(0,s().Y0)(),{isMenuListFocusVisible:y}=(0,i.useContext)(W().VU),b=(0,r().IS)((e=>({optionItem:{display:"flex",flexDirection:"column",alignItems:"center",minWidth:34,justifyContent:"flex-end"},button:{width:"100%",...v.isMobile?{padding:16,paddingTop:20,transition:"color 300ms, border 300ms",lineHeight:1}:{padding:6,paddingTop:10,borderRadius:4,transition:"color 300ms, border 300ms",lineHeight:1},justifyContent:"center",color:o?D().Tj.blue:"inherit",...n&&y&&{boxShadow:e.buttonBlueFocusRing}}})),[o,v,y,n]);return(0,S.jsx)(G().A,{renderTooltip:()=>g,placement:"bottom",delayThreshold:80,render:i=>{const o=(0,q().A)(i,{onMouseEnter:d,onMouseLeave:c}),{onMouseDown:s,...r}=o;return(0,S.jsx)(V().Ay,{...r,id:e,role:u,ref:h,onClick:a,onMouseDown:o.onMouseDown||l,hovered:n,style:b.button,ignoreLocalHoverState:m,disallowTabbing:f,className:"notranslate",children:(0,S.jsxs)("div",{style:b.optionItem,children:[(0,S.jsx)("div",{style:{...p,height:25},children:"Ag"}),(0,S.jsx)(H().A,{isSmall:!0,style:{marginTop:4},children:t})]})})}})}(e,t)}const $=i.forwardRef(Y);const Q=function(e){const{children:t}=e,n=(0,s().v3)(),{mobileStyle:i,desktopStyle:o}=(0,r().IS)((e=>({mobileStyle:{display:"flex",justifyContent:"space-around",boxShadow:`0 1px 0 ${e.regularDividerColor}`,background:e.popoverBackground},desktopStyle:{display:"flex",justifyContent:"space-between",padding:"0px 8px"}})),[]);return(0,S.jsx)(K().A,{...e,children:(0,S.jsx)("div",{style:n.device.isMobile?i:o,children:t})})};var Z=()=>n(53528),J=()=>n(534177),X=()=>n(470928);function ee(e){const{intl:t,blockStore:n}=e,i=(0,X().i1)(n);if("none"!==i.type){if("expired"===i.type)return t.formatMessage(te.expiredVerification);if("verified"===i.type){if(i.isIndefinite)return t.formatMessage(te.indefiniteVerification);{const e=i.dateTimeRange.end,n=(0,Z().OH)({dateTime:e,intl:t,shortenDateAndRange:!0});return t.formatMessage(te.verificationWithEndDate,{date:n})}}(0,J().HB)(i)}}const te=(0,d().YK)({expiredVerification:{defaultMessage:"Expired",id:"verificationHelpers.mobileAction.subtitle.expiredVerification"},indefiniteVerification:{defaultMessage:"No expiration",id:"verificationHelpers.mobileAction.subtitle.indefiniteVerification"},verificationWithEndDate:{defaultMessage:"Until {date}",id:"verificationHelpers.mobileAction.subtitle.datedVerification"}});var ne=()=>n(873306),ie=()=>n(558687),oe=()=>n(10521),se=()=>n(767877);var ae=()=>n(775584),re=()=>n(733637),le=()=>n(440902),de=()=>n(411960),ce=()=>n(598101),ue=()=>n(597755),pe=()=>n(492414);const ge=(0,d().YK)({openInMacAppName:{id:"action.openInMacApp.name",defaultMessage:"Open in Mac app"},openInWindowsAppName:{id:"action.openInWindowsApp.name",defaultMessage:"Open in Windows app"},openIniOSAppName:{id:"action.openIniOSApp.name",defaultMessage:"Open in iOS app"},openInAndroidAppName:{id:"action.openInAndroidApp.name",defaultMessage:"Open in Android app"}}),me=(0,oe().Ls)({key:"open in mac app",displayName:ge.openInMacAppName,analyticsName:ge.openInMacAppName.defaultMessage,svg:ie().notionIcon,validators:[le().v,(0,ce().A)(re().i),(0,ce().A)(ae().F),function({environment:{device:e}}){return e.isMac},(0,ce().A)(de().P)],closeParentMenu:!0,action:({blocks:e,environment:t})=>{const n=(0,pe().Ay)({store:e[0],fullyQualified:!1,pageVisitSource:m().y8.AppRedirect,embedded:!1});(0,se().e)({url:(0,ue().P)(n),environment:t})}}),fe=(0,oe().Ls)({key:"open in windows app",displayName:ge.openInWindowsAppName,analyticsName:ge.openInWindowsAppName.defaultMessage,svg:ie().notionIcon,validators:[le().v,(0,ce().A)(re().i),(0,ce().A)(ae().F),n(791117).u,(0,ce().A)(de().P)],closeParentMenu:!0,action:({blocks:e,environment:t})=>{const n=(0,pe().Ay)({store:e[0],fullyQualified:!1,pageVisitSource:m().y8.AppRedirect,embedded:!1});(0,se().e)({url:(0,ue().P)(n),environment:t})}}),he=(0,oe().Ls)({key:"open in ios app",displayName:ge.openIniOSAppName,analyticsName:ge.openIniOSAppName.defaultMessage,svg:ie().notionIcon,validators:[le().v,(0,ce().A)(re().i),n(808565).u,(0,ce().A)(de().P)],closeParentMenu:!0,action:({blocks:e,environment:t})=>{const n=(0,pe().Ay)({store:e[0],fullyQualified:!1,pageVisitSource:m().y8.AppRedirect,embedded:!1});(0,se().e)({url:n,environment:t})}}),ve=(0,oe().Ls)({key:"open in android app",displayName:ge.openInAndroidAppName,analyticsName:ge.openInAndroidAppName.defaultMessage,svg:ie().notionIcon,validators:[le().v,(0,ce().A)(re().i),n(875855).m,(0,ce().A)(de().P)],closeParentMenu:!0,action:({blocks:e,environment:t})=>{const n=(0,pe().Ay)({store:e[0],fullyQualified:!1,pageVisitSource:m().y8.AppRedirect,embedded:!1});(0,se().e)({url:n,environment:t})}});function ye(){return[me,fe,he,ve]}var be=()=>n(877235);const Se=(0,b().wt)("stopThinOutlineIcon",{viewBox:"0 0 16 16",svg:(0,S.jsx)("g",{children:(0,S.jsx)("path",{d:"M7.998 14.97c-3.808 0-6.973-3.165-6.973-6.972 0-3.815 3.159-6.973 6.966-6.973 3.815 0 6.98 3.158 6.98 6.973 0 3.807-3.159 6.972-6.973 6.972m0-1.162a5.79 5.79 0 0 0 5.81-5.81c0-3.227-2.59-5.81-5.817-5.81a5.777 5.777 0 0 0-5.797 5.81 5.783 5.783 0 0 0 5.804 5.81m-1.811-3.322c-.424 0-.684-.253-.684-.67V6.179c0-.424.26-.67.684-.67h3.609c.43 0 .684.246.684.67v3.637c0 .417-.253.67-.684.67h-3.61Z"})})});function xe({shouldDisplay:e}){const t=(0,r().IS)((e=>({container:{color:e.text.tertiary,fontSize:14,display:"flex",flexDirection:"row",alignItems:"center",gap:2}})),[]);return e?(0,S.jsxs)("div",{style:t.container,children:[Se({width:14,height:14}),"Stop"]}):null}var Ae=()=>n(910302),Me=()=>n(722872),we=()=>n(430483),je=()=>n(77246),ke=()=>n(404277),Ie=()=>n(45552),Ce=()=>n(147294);function Te(e){const{blockStore:t,menuListItemProps:o,title:r,onFocus:l,closeParentMenu:c}=e,u=(0,s().v3)(),p=(0,Me().Tf)(),m=(0,a().K8)((()=>we().zD.isFullPageTranslateEnabled()),[]),{detectedLanguage:f}=(0,n(514799).H)({pageStore:t,enabled:m}),h=(0,n(5580).n)(),[v,y]=(0,i.useState)(void 0),b=v??f??h,{isTranslating:x,editorModeConfigTranslateState:A}=(0,a().K8)((()=>{const e=je().Uv.getTranslateModeForBlock(t.id);return e?{isTranslating:!0,editorModeConfigTranslateState:e}:{isTranslating:!1,editorModeConfigTranslateState:{mode:"translate_unlocked",status:"pre_activation",sourceLanguage:b}}}),[t,b]),M=!(0,a().O$)(g().e),w=(0,i.useCallback)((e=>{const{sourceLanguage:t}=e;y(t)}),[]),j=(0,i.useCallback)((e=>{const{targetLanguage:n}=e;Ae().Z9({pageStore:t,environment:u}),Ae().Ww({pageStore:t,targetLanguage:n,sourceLanguage:b,environment:u,triggeredFrom:"action_menu"}),c()}),[t,b,u,c]),k=(0,i.useMemo)((()=>(0,S.jsx)(xe,{shouldDisplay:x})),[x]);return"pre_activation"!==A.status||M?(0,S.jsx)(z().A,{...o,title:r,badge:(0,S.jsx)(Ce().Ee,{newBadgeKey:"ai_page_translation_topbar_more_action",didUserEngage:!1,keyType:"date"}),svg:be().textTranslateIcon,right:k,onClick:()=>{Ae().DL({pageStore:t,environment:u,triggeredFrom:"action_menu"}),c()},disabled:M,disabledFeedback:M,tooltipText:M?(0,S.jsx)(d().sA,{...oe().AY.unavailableOfflineTooltip}):void 0}):(0,S.jsx)(n(662971).A,{...o,disableDefaultClick:!0,onFocus:l,focused:o.focused,disableCloseOnEnter:!0,renderExtension:(e,i)=>{const o=u.device.isMobile?{menuType:Me().gu.Modal,right:p?void 0:(0,S.jsx)(Ie().DoneMenuText,{}),left:p?(0,S.jsx)(Ie().MobileModalBackButton,{}):void 0,onClickRight:p?void 0:i.close,onClickLeft:p?i.close:void 0,shouldRenderMobileRefresh:p,paddingTop:p?10:void 0,title:r,...e}:{menuType:Me().gu.Popup,height:480,...e};return(0,S.jsx)(ke().A,{...o,onClick:e=>{e.stopPropagation()},children:(0,S.jsx)(n(391435).Z,{onSelectTargetLanguage:j,onSelectSourceLanguage:w,editorModeConfigTranslateState:A,sourceLanguage:b,detectedPageLanguage:f,preferredLanguage:h,subMenuPlacement:"left",pageId:t.id})})},renderOrigin:(e,t)=>(0,S.jsx)(z().A,{...e,ref:t,title:r,badge:(0,S.jsx)(Ce().Ee,{newBadgeKey:"ai_page_translation_topbar_more_action",didUserEngage:!1,keyType:"date"}),svg:be().textTranslateIcon,right:k})})}var _e=()=>n(158658);function Pe(e){const{environment:t}=e;return e.blocks.some((e=>(0,n(400851).Y)({environment:t,blockStore:e,from:"pageActionsMenu",allowTabletsToUseLayoutBuilder:o().default.checkGate({gateName:"layouts_tablet_builder"})})))}var Be=()=>n(486674);function De(){const e=(0,Be().a)();return Boolean(null==e?void 0:e.getAssociatedCollectionStore())}n(823215);var Re=()=>n(726637),Ee=()=>n(765957),Le=()=>n(151059),Oe=()=>n(534740);function Ne(e){if(Re().A.isAdminMode)return!0;if(e.blocks.some((e=>{const t=(0,n(247450).h)({blockId:e.id,setting:"disableExport"});return Boolean(null==t?void 0:t.disabled)})))return!1;if((0,n(333344).P)(e)&&!(0,n(77295).K)(e))return!1;const t=function({environment:e}){const{sidebarSpaceStore:t}=Ee().default.state;if(!t)return!1;const n=Le().A.getData(e,{spaceId:t.id,userId:e.currentUser.id});return t.isDefined()?!t.getDisableExport():n?!n.disableExport:(0,Oe().h)()}(e),{environment:i,blocks:o}=e;return o.every((e=>{const o=(0,n(422366).U)(e),s=null==o?void 0:o.getModel();return o&&s?(!i.currentUser.id||!(0,n(468006).CG)({team:s,userId:i.currentUser.id}))&&!o.getDisableExport():t}))}var Fe=()=>n(155963),Ue=()=>n(460995);var ze=()=>n(339425),Ke=()=>n(963335);var Ve=()=>n(787281),qe=()=>n(606376),We=()=>n(514779),Ge=()=>n(49533),He=()=>n(201004),Ye=()=>n(467294);var $e=()=>n(419286),Qe=()=>n(422155);var Ze=()=>n(972435),Je=()=>n(600871),Xe=()=>n(41223),et=()=>n(538075),tt=()=>n(737350),nt=()=>n(981342),it=()=>n(404141),ot=()=>n(795179),st=()=>n(488923),at=()=>n(102172);const rt=(0,d().YK)({aiCoEditingName:{id:"action.aiCoEditing.name",defaultMessage:"AI co-editing"}}),lt=(0,oe().fi)({key:"ai_co_editing",displayName:rt.aiCoEditingName,label:Ze().A.formatMessage(rt.aiCoEditingName),getSvgIcon:()=>n(824375).sparklesIcon,isChecked:e=>e.isNavigableBlock()&&(0,at().Wv)(e,e.environment),validators:[(0,ce().A)(Fe().K),_e().p,(0,ce().A)(ze().o),(0,ce().A)(qe().l),()=>we().zD.isAiEnabled(),(0,Ke().S)("ai_co_editing")],action:async(e,t,n)=>{if(!t.isNavigableBlock())return;const i=(0,at().Wv)(t,e);if(await(0,st().ne)({environment:e,pageId:t.id,active:!i}),i){(await(0,st().gY)()).clearStore()}}});var dt=()=>n(21727),ct=()=>n(12956),ut=()=>n(774411),pt=()=>n(142015),gt=()=>n(168345);const mt={viewBox:"0 0 20 20",fittedViewBox:"2.37 3.13 15.26 14.86",svg:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("path",{d:"M10 5.88c.345 0 .625.28.625.625V8.38H12.5a.625.625 0 1 1 0 1.25h-1.875v1.875a.625.625 0 1 1-1.25 0V9.63H7.5a.625.625 0 1 1 0-1.25h1.875V6.505c0-.345.28-.625.625-.625"}),(0,S.jsx)("path",{d:"M15.5 3.13c1.174 0 2.125.951 2.125 2.125v7.5A2.125 2.125 0 0 1 15.5 14.88h-4.935l-3.871 2.978a.625.625 0 0 1-1.006-.496V14.88H4.5a2.125 2.125 0 0 1-2.125-2.125v-7.5c0-1.174.951-2.125 2.125-2.125zm.875 2.125a.875.875 0 0 0-.875-.875h-11a.875.875 0 0 0-.875.875v7.5c0 .483.392.875.875.875h1.813c.345 0 .625.28.625.625v1.838l3.033-2.334a.63.63 0 0 1 .381-.13H15.5a.875.875 0 0 0 .875-.874z"})]})},ft=(0,b().wt)("commentAdd",mt);var ht=()=>n(33376),vt=()=>n(525884),yt=()=>n(848392),bt=()=>n(158574),St=()=>n(189158),xt=()=>n(182034);function At(e){return e.blocks.every((e=>{const t=null==e?void 0:e.getModel();return Boolean(null==t?void 0:t.isType(f().Gz))}))}var Mt=()=>n(462580),wt=()=>n(900967),jt=()=>n(449195),kt=()=>n(21178),It=()=>n(393686),Ct=()=>n(489348),Tt=()=>n(883497),_t=()=>n(592968);const Pt=(0,d().YK)({addCover:{id:"mobile_page_actions.add_cover",defaultMessage:"Add cover"},changeCover:{id:"mobile_page_actions.change_cover",defaultMessage:"Change cover"},addComment:{id:"mobile_page_actions.add_comment",defaultMessage:"Add comment"},viewComments:{id:"mobile_page_actions.view_comments",defaultMessage:"View comments"},backlinks:{id:"mobile_page_actions.backlinks",defaultMessage:"Backlinks"},addDescription:{id:"mobile_page_actions.add_description",defaultMessage:"Add description"},showDescription:{id:"mobile_page_actions.show_description",defaultMessage:"Show description"},hideDescription:{id:"mobile_page_actions.hide_description",defaultMessage:"Hide description"},viewBreadcrumb:{id:"mobile_page_actions.view_breadcrumb",defaultMessage:"View breadcrumb"}});function Bt(e){const{blockStore:t,environment:n}=e;return(0,oe().Ls)({key:"add comment",displayName:Pt.addComment,svg:ft,analyticsName:Pt.addComment.defaultMessage,validators:[He().p,(0,ce().A)(De),U().tm,(0,ce().A)(U().tC)],closeParentMenu:!0,action:async()=>{await(0,xt().O)({blockStore:t,environment:n})}})}function Dt(e){const{environment:t,intl:n,blockStore:i}=e,o=Boolean(i.getCover());return(0,oe().Ls)({key:"add page cover",displayName:o?Pt.changeCover:Pt.addCover,svg:yt().M,analyticsName:o?Pt.changeCover.defaultMessage:Pt.addCover.defaultMessage,validators:[_e().p,Ge()._,(0,ce().A)(ze().o),(0,Qe().or)([At,Fe().K]),(0,ce().A)(Mt().J)],closeParentMenu:!0,action:(e,o)=>{It().W({environment:t,intl:n,store:i,rect:e.originRect,from:"topbar_more_menu"})}})}function Rt(e){const{environment:t,blockStore:n}=e,i=(0,wt().J)(n,t).backlinksCount;if(i<=0)return;return"section_hide"!==(0,jt().nl)(n.getFormat().page_section_visibility)?(0,oe().Ls)({key:"view backlinks",displayName:Pt.backlinks,analyticsName:"view_backlinks",validators:[He().p],closeParentMenu:!0,render:e=>(0,S.jsx)(z().A,{...e,title:(0,S.jsx)(d().sA,{id:"topbarMoreMenuActions.viewBacklinks",defaultMessage:"{numberOfBacklinks, plural, =0 {No backlinks} one {{numberOfBacklinks} backlink} other {{numberOfBacklinks} backlinks}}",values:{numberOfBacklinks:i}}),svg:pt().D}),action:()=>{_t().F.setState({isOpen:!0})}}):void 0}function Et(e){const{blockStore:t}=e;if(!t.isCollectionView())return;const n=Ct().A.getPageViewBlockStore(t);if(!n)return;const{currentUserSettingsStore:i}=Ee().default.state,o=t.getCollectionViewSourceDescriptionStore(),s=kt().cf(o),a=n.state.isPageDescriptionExpanded;return s&&a?Lt({shouldShow:!1,blockStore:t,descriptionStore:o,pageViewBlockStore:n,userSettingsStore:i}):s&&!a?Lt({shouldShow:!0,blockStore:t,descriptionStore:o,pageViewBlockStore:n,userSettingsStore:i}):function(e){const{blockStore:t,descriptionStore:n,pageViewBlockStore:i,userSettingsStore:o}=e;return(0,oe().Ls)({key:"add collection description",displayName:Pt.addDescription,analyticsName:"add_collection_description",validators:[Fe().K,_e().p],closeParentMenu:!0,svg:vt().infoCircleIcon,action:(e,s)=>{bt().KM({environment:e.environment,pageId:t.id,store:i,userSettingsStore:o,descriptionStore:n})}})}({blockStore:t,descriptionStore:o,pageViewBlockStore:n,userSettingsStore:i})}function Lt(e){const{shouldShow:t,blockStore:n,descriptionStore:i,pageViewBlockStore:o,userSettingsStore:s}=e;return(0,oe().Ls)({key:t?"show collection description":"hide collection description",displayName:t?Pt.showDescription:Pt.hideDescription,analyticsName:t?"show_collection_description":"hide_collection_description",validators:[Fe().K,_e().p],closeParentMenu:!0,svg:vt().infoCircleIcon,action:(e,t)=>{bt().JO({store:o,pageId:n.id,descriptionStore:i,environment:e.environment,userSettingsStore:s})}})}function Ot(e){return(0,oe().Ls)({key:"view breadcrumb",displayName:Pt.viewBreadcrumb,analyticsName:"view_breadcrumb",validators:[(0,Qe().or)([He().p,Fe().K])],closeParentMenu:!0,svg:ht().E,action:t=>{(0,St().f)(t.environment,e.blockStore)}})}var Nt=()=>n(354406),Ft=()=>n(37689),Ut=()=>n(804643),zt=()=>n(709906),Kt=()=>n(73926),Vt=()=>n(498002),qt=()=>n(921912);const Wt=(0,d().YK)({customizePageLabel:{id:"action.customizePage.label",defaultMessage:"Customize page"},exportName:{id:"action.export.name",defaultMessage:"Export"},exportCaption:{id:"action.export.caption",defaultMessage:"PDF, HTML, Markdown & CSV"},exportDisabledTooltip:{id:"action.export.disabledTooltip",defaultMessage:"Export is disabled for this page"},fontDefaultName:{id:"action.setPageFont.default.fuzzySearchKeywords",defaultMessage:"Font Default"},fontDefaultCaption:{id:"action.setPageFont.default.caption",defaultMessage:"Default"},fontDefaultTooltip:{id:"action.setPageFont.default.tooltip",defaultMessage:"The default sans-serif workhorse"},fontSerifName:{id:"action.setPageFont.serif.fuzzySearchKeywords",defaultMessage:"Font Serif"},fontSerifCaption:{id:"action.setPageFont.serif.caption",defaultMessage:"Serif"},fontSerifTooltip:{id:"action.setPageFont.serif.tooltip",defaultMessage:"Good for publishing"},fontMonoName:{id:"action.setPageFont.mono.fuzzySearchKeywords",defaultMessage:"Font Mono"},fontMonoCaption:{id:"action.setPageFont.mono.caption",defaultMessage:"Mono"},fontMonoTooltip:{id:"action.setPageFont.mono.tooltip",defaultMessage:"Good for drafting and notes"},fontComicName:{id:"action.setPageFont.comic.fuzzySearchKeywords",defaultMessage:"Font Comic"},fontComicCaption:{id:"action.setPageFont.comic.caption",defaultMessage:"Comic"},fontComicTooltip:{id:"action.setPageFont.comic.tooltip",defaultMessage:"Playful but cringe"},fontSmallTextKeywords:{id:"action.fontSmallText.fuzzySearchKeywords",defaultMessage:"Font Small Text"},fontSmallTextLabel:{id:"action.fontSmallText.label",defaultMessage:"Small text"},fullWidthLabel:{id:"action.fullWidth.label",defaultMessage:"Full width"},importName:{id:"action.import.name",defaultMessage:"Import"},lockPageName:{id:"action.lockPage.name",defaultMessage:"Lock page"},floatingTableOfContents:{id:"action.floatingTableOfContents.name",defaultMessage:"Table of contents"},notifyMe:{id:"action.notifyMe.name",defaultMessage:"Notify me"},pageVerification:{id:"action.pageVerification.name",defaultMessage:"Verify page"},pageHistoryName:{id:"action.pageHistory.name",defaultMessage:"View edit history"},pageHistoryNewName:{id:"action.pageHistoryNew.name",defaultMessage:"Version history"},pageHistoryFuzzySearchKeywords:{id:"action.pageHistory.fuzzySearchKeywords",defaultMessage:"Version history edits updates"},pageUpdates:{id:"action.pageUpdates.title",defaultMessage:"Page updates"},textFontStyle:{id:"action.textFontStyle.name",defaultMessage:"Text style"},suggestEditsName:{id:"action.suggestEdits.name",defaultMessage:"Suggest edits"},viewUpdatesAndAnalyticsName:{id:"action.updatesAndAnalytics.name",defaultMessage:"Updates & analytics"},viewUpdatesAndAnalyticsFuzzySearchKeywords:{id:"action.viewUpdatesAndAnalytics.fuzzySearchKeywords",defaultMessage:"Updates & analytics edits"},openPageLayoutEditor:{id:"action.layoutEditor.open",defaultMessage:"Customize layout"},translate:{id:"action.translate",defaultMessage:"Translate"}});function Gt(e){const{environment:t,intl:n,context:i,isFiltering:o}=e,s=i.blocks[0],a=s.getFollowSettingsKey(),r=(0,nt().jj)(Ee().default.state.sidebarSpaceStore),l=et().H8({followSettingsKey:a,environment:t,blockStore:s,from:"more_menu"});if(s.isSystemBlock())return[(0,oe().gy)({key:"system block all actions",render:e=>(0,S.jsx)(K().A,{...e}),actions:[...r?[vn,an]:[],dt().qQ,dt().Zk,qt().p6,rn,...ye()]})];const d=(0,Je().aD)(t.device);return[o?Zt(t,s.getFormat().page_font||"default"):$t,(0,oe().gy)({key:"topbar primary actions",render:e=>(0,S.jsx)(K().A,{...e,topBorder:!1}),actions:[dt().qQ,dt().Zk,qt().p6,rn,ln,ut().TR,ut().kl,ut().J8,ut().lb,Ft().tw,Ut().dl]}),(0,oe().gy)({key:"available offline",render:e=>(0,S.jsx)(K().A,{...e}),actions:[tt().Z]}),(0,oe().gy)({key:"page style and layout",render:e=>(0,S.jsx)(K().A,{...e}),actions:[...d?(0,R().oE)([dt().Xv,Dt({environment:t,intl:n,blockStore:s}),Bt({blockStore:s,environment:t}),(0,oe().Ls)({key:"view comments",displayName:Pt.viewComments,svg:gt().L,analyticsName:Pt.viewComments.defaultMessage,validators:[He().p,(0,ce().A)(De),U().tm,U().XX],closeParentMenu:!0,action:()=>{Tt().A.setState({open:!0})}}),Rt({environment:t,blockStore:s}),Et({blockStore:s}),Ot({blockStore:s})]):[],dn({environment:t,intl:n,blockStore:s}),...(0,R().oE)([Jt,Xt,nn,vn,an])]}),Nt().LQ,(0,oe().gy)({key:"viewing of page content",render:e=>(0,S.jsx)(K().A,{...e}),actions:[en,lt,dt().fg,dt().Fh,dt().cy]}),(0,oe().gy)({key:"editing of page content",render:e=>(0,S.jsx)(K().A,{...e}),actions:[on,sn]}),(0,oe().gy)({key:"undo",render:e=>(0,S.jsx)(K().A,{...e}),actions:[qt().tN]}),(0,oe().gy)({key:"topbar import actions",render:e=>(0,S.jsx)(K().A,{...e}),actions:[fn,dt().TD,hn]}),(0,oe().gy)({key:"topbar wiki actions",render:e=>(0,S.jsx)(K().A,{...e}),actions:(0,R().oE)([Vt().H0,Vt().hk])}),(0,oe().gy)({key:"editorActions",render:e=>(0,S.jsx)(K().A,{...e}),actions:(0,R().oE)([cn,pn,un])}),mn(t,l),(0,ne().A)(i),(0,oe().gy)({key:"report page actions",render:e=>(0,S.jsx)(K().A,{...e}),actions:[Kt().H,zt().X,zt().aj]}),(0,oe().gy)({key:"topbar view options",render:e=>(0,S.jsx)(K().A,{...e}),actions:ye()})]}function Ht(e){return(0,oe().Ls)({key:`font ${e.font||"default"}`,displayName:e.displayName,analyticsName:e.displayName.defaultMessage,validators:[(0,Qe().or)([(0,ce().A)(Fe().K),Ue().A]),_e().p,(0,ce().A)(ze().o),...e.extraValidators],render:(t,n)=>{const i=n.blocks[0].getFormat().page_font,o=e.font===i||!e.font&&!i;return(0,S.jsx)($,{...t,isActive:o,font:e.font,tooltip:e.tooltip,style:e.style,caption:e.caption,isFiltering:e.isFiltering,isChecked:e.checkStatus,svg:e.svg})},closeParentMenu:!!e.isFiltering,track:{actionName:"set_font"},action:(t,{blocks:n,environment:i},o)=>{const{serverCommitResult:s}=N().createAndCommit({userAction:"actionRegistry.createFontAction",environment:i,canUndo:!0,perform:t=>{E().zA({stores:n,update:{page_font:e.font},transaction:t}),function(e,t){(0,u().DO_NOT_USE_trackLegacy)(e,"change_font_type",t)}(i,{type:e.font||"default"})}});s.then(t)}})}const Yt=[{font:"default",action:function(e){const{isFiltering:t,pageFont:n}=e;return Ht({displayName:Wt.fontDefaultName,caption:(0,S.jsx)(d().sA,{...Wt.fontDefaultCaption}),font:void 0,tooltip:(0,S.jsx)(d().sA,{...Wt.fontDefaultTooltip}),style:t?{}:{fontSize:24,fontFamily:c().vc(p().locale).sans,position:"relative",top:-2},extraValidators:[],isFiltering:t,checkStatus:"default"===n,svg:w})}},{font:"serif",action:function(e){const{isFiltering:t,pageFont:n}=e;return Ht({displayName:Wt.fontSerifName,caption:(0,S.jsx)(d().sA,{...Wt.fontSerifCaption}),font:"serif",tooltip:(0,S.jsx)(d().sA,{...Wt.fontSerifTooltip}),style:t?{}:{fontSize:25,fontFamily:c().vc(p().locale).serif,lineHeight:"21px"},extraValidators:[],isFiltering:t,checkStatus:"serif"===n,svg:k})}},{font:"mono",action:function(e){const{isFiltering:t,pageFont:n}=e;return Ht({displayName:Wt.fontMonoName,caption:(0,S.jsx)(d().sA,{...Wt.fontMonoCaption}),font:"mono",tooltip:(0,S.jsx)(d().sA,{...Wt.fontMonoTooltip}),style:t?{}:{fontSize:26,fontFamily:c().vc(p().locale).mono,position:"relative",top:-3,letterSpacing:-1},extraValidators:[],isFiltering:t,checkStatus:"mono"===n,svg:A})}},{font:"comic",action:function(e){const{isFiltering:t,pageFont:n}=e;return Ht({displayName:Wt.fontComicName,caption:(0,S.jsx)(d().sA,{...Wt.fontComicCaption}),font:"comic",tooltip:(0,S.jsx)(d().sA,{...Wt.fontComicTooltip}),style:{fontSize:t?14:26,fontFamily:c().vc(p().locale).comic,position:"relative",top:-3,letterSpacing:-1},extraValidators:[(0,Qe().or)([(0,Ke().S)("comic_sans"),e=>e.blocks.some((e=>"comic"===e.getFormatStore().getKeyStore("page_font").getValue()))])],isFiltering:t,checkStatus:"comic"===n})}}],$t=(0,oe().gy)({key:"font section",title:void 0,render:e=>(0,S.jsx)(Q,{...e}),actions:Yt.map((e=>e.action({isFiltering:!1})))});function Qt(e){return(0,oe().gy)({key:"font extension menu",render:e=>(0,S.jsx)(K().A,{...e}),actions:Yt.map((t=>t.action({isFiltering:!0,pageFont:e})))})}function Zt(e,t){const n=(0,D().O4)({theme:e.ThemeModeStore.state}),i=Yt.map((e=>e.font)).findIndex((e=>e===t))??0;return(0,oe().gy)({key:"textStyleAction",render:e=>(0,S.jsx)(K().A,{...e}),actions:[(0,ct().u)({key:"font style section",displayName:Wt.textFontStyle,analyticsName:Wt.textFontStyle.defaultMessage,svg:T().a,right:(0,S.jsx)(S.Fragment,{children:t.charAt(0).toUpperCase()+t.slice(1)}),rightStyle:{color:n.text.tertiary,marginInlineEnd:5},width:300,validators:[(0,Qe().or)([(0,ce().A)(Fe().K),Ue().A]),_e().p,(0,ce().A)(ze().o)],subActions:()=>[Qt(t)],initialFocus:i,hideSubActions:!0,fuzzySearchKeywordsArray:[Wt.fontDefaultName,Wt.fontSerifName,Wt.fontMonoName]})]})}const Jt=(0,oe().fi)({key:"small text",displayName:Wt.fontSmallTextKeywords,label:Ze().A.formatMessage(Wt.fontSmallTextLabel),getSvgIcon:()=>P,isChecked:e=>Boolean(e.getFormat().page_small_text),validators:[(0,ce().A)(ae().F),(0,Qe().or)([(0,ce().A)(Fe().K),Ue().A]),_e().p,(0,ce().A)(ze().o)],track:{actionName:"set_text_size"},action:(e,t,n)=>E().zA({stores:[t],update:{page_small_text:!t.getFormat().page_small_text},transaction:n}),afterAction:(e,t)=>{(0,u().DO_NOT_USE_trackLegacy)(t,"change_font_size",{type:e?"small":"large"})}}),Xt=(0,oe().fi)({key:"full width",displayName:Wt.fullWidthLabel,getSvgIcon:()=>n(665589).l,label:Ze().A.formatMessage(Wt.fullWidthLabel),isChecked:e=>e.isFullWidth(),validators:[(0,ce().A)((function({environment:{device:e}}){return e.isPhone})),(0,ce().A)(Fe().K),_e().p,(0,ce().A)(ze().o)],track:{actionName:"set_width"},action:(e,t,n)=>{E().zA({stores:[t],update:{page_full_width:!t.isFullWidth()},transaction:n})},afterAction:(e,t)=>{(0,u().DO_NOT_USE_trackLegacy)(t,"change_page_width",{type:e?"full_width":"default_width"})}}),en=(0,oe().fi)({key:"page lock",displayName:Wt.lockPageName,label:Ze().A.formatMessage(Wt.lockPageName),getSvgIcon:({isChecked:e})=>t=>(0,S.jsx)(n(124524).I,{isLocked:e,style:t}),isChecked:e=>e.isLockedForAllUsers(),validators:[(0,ce().A)(Fe().K),_e().p,(0,ce().A)(ze().o)],action:(e,t,n)=>O().zv({store:t.getFormatStore(),data:{block_locked:!t.isLockedForAllUsers(),block_locked_by:e.currentUser.id},transaction:n}),afterAction:()=>null}),tn=[(0,ce().A)(Fe().K),_e().p,(0,ce().A)(ze().o),(0,ce().A)(ae().F),(0,Qe().or)([Pe])],nn=(0,oe().fi)({key:"floating table of contents",displayName:Wt.floatingTableOfContents,getSvgIcon:()=>n(358359).L,label:Ze().A.formatMessage(Wt.floatingTableOfContents),isChecked:e=>{var t;return"off"!==(null===(t=e.getModel())||void 0===t?void 0:t.getFloatingTableOfContentsState())},validators:tn,action:(e,t,n)=>{var i;const o="off"!==(null===(i=t.getModel())||void 0===i?void 0:i.getFloatingTableOfContentsState());O().zv({store:t.getFormatStore(),data:{page_floating_table_of_contents:{state:o?"off":"minimal"}},transaction:n})},afterAction:(e,t)=>{(0,n(564884).u)({environment:t,event:{eventName:"edit_page_table_of_contents_toggle",eventProperties:{is_table_of_contents_on:e}}})}}),on=(0,oe().Ls)({key:"suggest edits",displayName:Wt.suggestEditsName,analyticsName:Wt.suggestEditsName.defaultMessage,validators:[(0,ce().A)(qe().l),(0,ce().A)(ae().F),(0,Qe().or)([(0,ce().A)(Fe().K),Ue().A]),n(859398).$,(0,ce().A)(ze().o)],render:(e,t)=>{const i="suggest"===je().Uv.getMode(t.blocks[0]);return(0,S.jsx)(z().A,{...e,title:(0,S.jsx)(d().sA,{...Wt.suggestEditsName}),svg:n(209416).a,right:(0,S.jsx)(xe,{shouldDisplay:i})})},action:e=>{const t="suggest"===je().Uv.getMode(e.blocks[0])?"default":"suggest";"suggest"===t&&ot().A.reset(),n(473227).PD({environment:e.environment,navigableBlockStore:e.blocks[0],mode:t,location:"page_more_actions"})},closeParentMenu:!0}),sn=(0,oe().Ls)({key:"translate",displayName:Wt.translate,analyticsName:"open_translate_bar_from_topbar",validators:[function(){return Boolean(we().zD.isFullPageTranslateEnabled())},He().p],closeParentMenu:!0,render:(e,t,{onFocus:n})=>{const i=t.blocks.at(0);if(i)return(0,S.jsx)(Te,{onFocus:n,closeParentMenu:()=>{ot().A.reset()},blockStore:i,menuListItemProps:e,title:(0,S.jsx)(d().sA,{...Wt.translate})})},action:()=>{}}),an=(0,oe().Ls)({key:"customize page",displayName:Wt.customizePageLabel,analyticsName:Wt.customizePageLabel.defaultMessage,svg:I().M,validators:[(0,ce().A)(Pe),n(730580).V,(0,ce().A)(ze().o),(0,Qe().or)([(0,ce().A)(Fe().K),Ue().A]),(0,Qe().or)([ae().F,(0,ce().A)(De),Ve().U]),(0,ce().A)(de().P)],closeParentMenu:!0,render:e=>(0,S.jsx)(z().A,{...e,title:(0,S.jsx)(d().sA,{...Wt.customizePageLabel}),svg:I().M}),action:e=>{n(334261).ho({originRect:e.originRect})}}),rn=(0,oe().Fw)({key:"copy link to block non-desktop",displayName:oe().AY.copyLinkNavigableTypeName,analyticsName:oe().AY.copyLinkNavigableTypeName.defaultMessage,svg:n(742852).linkIcon,shortcuts:["copyCurrentPageLinkifiedBlockTitle"],validators:[We().M,le().v,(0,ce().A)(n(929084).b),(0,ce().A)(ze().o),(0,ce().A)(de().P)],closeParentMenu:!0,track:{actionName:"copy_block_link"},action:(e,{lazyDependencies:t,environment:i,blocks:o},s)=>{const{clipboardActions:a}=t;a?a.copyLinkToBlock({environment:i,blockStore:o[0],callback:e}):n(165358).log({data:{miscDataToConvertToString:{actionKey:"copy link to block non-desktop"}},from:"topbarMoreActionRegistry",level:"info",type:"lazyDependencies:missingClipboardActions"})}}),ln=(0,oe().Fw)({key:"duplicate",displayName:oe().AY.duplicateName,analyticsName:oe().AY.duplicateName.defaultMessage,svg:n(764781).V,validators:[Ge()._,_e().p,n(116057).M,n(30549).G,(0,ce().A)((0,$e().X)(f().xd.externalObjectInstancePage)),(0,ce().A)(Ve().U),(0,ce().A)(Ye().P),(0,ce().A)(ze().o)],shortcuts:["duplicate"],closeParentMenu:!0,track:{actionName:"duplicate"},action:async(e,{environment:t},i)=>{const o=(0,n(747135).F)();if(!o)return;const s=o.getAssociatedCollectionStore();if(!s)return;if(!(0,n(50764).E)(t))return;const a=new(n(688742).B)(t);if(a.setContext({type:"collectionPage",collectionViewBlockStore:void 0,collectionStore:s}),(0,n(405417).ls)(o,a))return void(await n(60867).HF({environment:t,blocks:[o],collectionContextStore:a,callback:e}));const r={type:"collection",parent:s.getSpaceShardedPointer(),addToTemplates:o.isTemplate()},l=await(0,n(213477).hh)({environment:t,sourceBlocks:[o],destination:r,from:"duplicate_to_collection",options:{addCopyName:!0,allowRedundancy:!1,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!o.isInsideTemplate()},skipUserFacingMessages:!1,listener:e=>{"page_navigable"===e.type&&n(857783).uK({environment:t,store:e.navigableBlockStore,pageVisitSource:m().y8.Duplicate})}});if(!n(973647).Q.isSuccess(l))throw l.error;e()},disabled:()=>!g().A.state.online,renderTooltip:()=>Ze().A.formatMessage(oe().AY.unavailableOfflineTooltip),disableTooltip:()=>g().A.state.online});function dn(e){const{environment:t,intl:n,blockStore:i}=e,o=(0,D().O4)({theme:t.ThemeModeStore.state});return(0,oe().Ls)({key:"open page verification menu",analyticsName:"Open page verification",displayName:Wt.pageVerification,render:e=>(0,S.jsx)(z().A,{...e,svg:h().badgeCheckIcon,title:(0,S.jsx)(d().sA,{...Wt.pageVerification}),right:(0,S.jsx)("div",{style:{color:o.text.tertiary,marginInlineEnd:0},children:ee({intl:n,blockStore:i})}),rightStyle:{marginInlineEnd:5},showExtensionArrow:!0}),validators:[ae().F,e=>(0,_e().p)(e),()=>(0,Xe().I)(),()=>{var e;const t=null===(e=Ee().default.state.sidebarSpaceStore)||void 0===e?void 0:e.getModel();return Boolean(t&&(0,B().X)(t))}],closeParentMenu:!1,action:()=>{L().h()}})}const cn=(0,oe().Ls)({key:"open page updates",analyticsName:"Open page updates",displayName:Wt.pageUpdates,svg:y().clockIcon,validators:[U().tm,ae().F],closeParentMenu:!0,action:()=>{n(446027).A.setState({open:!0})},disabled:()=>!g().A.state.online}),un=(0,oe().Ls)({key:"action page history",displayName:Wt.pageHistoryNewName,analyticsName:Wt.pageHistoryName.defaultMessage,fuzzySearchKeywords:Wt.pageHistoryFuzzySearchKeywords,svg:C().G,validators:[(0,Qe().or)([Oe().h,n(788436).X]),Ge()._,We().M,(0,ce().A)((function(e){return e.blocks.some((e=>{e.useCrdt()}))})),(0,ce().A)(Ye().P),(0,ce().A)(n(333799).Q),(0,ce().A)(de().P)],closeParentMenu:!0,action:({environment:e,blocks:t})=>n(82926).WE({environment:e,blockStore:t[0],from:"topbar"}),render:({onClick:e,key:t,...i},{environment:o})=>(0,S.jsx)(n(643908).A,{requireUpgradeToTier:!1,analyticsName:"history_modal",onClick:e,alwaysAllowClick:!0,render:(e,t)=>{const n=!g().A.state.online;return(0,S.jsx)(z().A,{...(0,q().A)(i,e),title:Ze().A.formatMessage(Wt.pageHistoryNewName),svg:C().G,dontShrinkRight:!0,right:t,tooltipText:n?Ze().A.formatMessage(oe().AY.unavailableOfflineTooltip):void 0,disabled:n,disabledFeedback:n})},renderUpgradeTooltip:()=>{}},t)}),pn=(0,oe().Ls)({key:"view updates and analytics",displayName:Wt.viewUpdatesAndAnalyticsName,analyticsName:Wt.viewUpdatesAndAnalyticsName.defaultMessage,fuzzySearchKeywords:Wt.viewUpdatesAndAnalyticsFuzzySearchKeywords,validators:[function(e){if(Re().A.isMobile)return!1;const t=e.blocks.at(0);return!!t&&(!!Re().A.isAdminMode||!!t.canEdit())},(0,ce().A)(de().P)],svg:y().clockIcon,closeParentMenu:!0,action:e=>{const{currentUserSettingsStore:t}=Ee().default.state;t&&N().createAndCommit({environment:e.environment,userAction:"topbarMoreActonRegistry.openUpdatesAndAnalytics",canUndo:!0,perform:e=>{n(755199).mJ({userSettingsStore:t,transaction:e,data:{opened_new_top_bar_updates_entrypoint:!0}})}}),n(869562).handleSidebarButtonClick(e.environment,e.blocks[0],n(737230).tF.Updates,"more_menu")},disabled:()=>!g().A.state.online,renderTooltip:()=>Ze().A.formatMessage(oe().AY.unavailableOfflineTooltip),disableTooltip:()=>g().A.state.online});function gn(e,t){var n;const i=(0,D().O4)({theme:e.ThemeModeStore.state});return(0,ct().u)({key:"notifications",displayName:Wt.notifyMe,analyticsName:Wt.notifyMe.defaultMessage,svg:v().r,right:null===(n=t.find((e=>e.isSelectedOption)))||void 0===n?void 0:n.action.displayName,rightStyle:{color:i.text.tertiary,marginInlineEnd:5},width:300,initialFocus:t.findIndex((e=>e.isSelectedOption))??0,validators:[(0,ce().A)(ze().o),(0,ce().A)(de().P)],subActions:()=>[(0,oe().gy)({key:"notifications",render:e=>(0,S.jsx)(K().A,{...e}),actions:t.map((({action:e})=>e))})],hideSubActions:!0,fuzzySearchKeywordsArray:(0,R().oE)(t.map((({action:e})=>e.displayName?et().aE(e.displayName):void 0)))})}function mn(e,t){return(0,oe().gy)({key:"notifyMe",render:e=>(0,S.jsx)(K().A,{...e}),actions:[gn(e,t)]})}const fn=(0,oe().Ls)({key:"open import modal",displayName:Wt.importName,analyticsName:Wt.importName.defaultMessage,svg:n(820579).arrowLineDownIcon,validators:[n(730107).I,_e().p,(0,ce().A)((0,$e().X)(f().xd.externalObjectInstancePage)),(0,ce().A)(Ye().P),(0,ce().A)(ze().o)],closeParentMenu:!0,action:({blocks:e,environment:t})=>{let i=!1;if(1===e.length){const[t]=e;i=t.isCollectionView()}i?n(41432).A.setState({open:!0}):(n(559926).kY(t,{from:"topbar",flowId:n(522094).A.createFlowId()}),it().A.setState({...it().A.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0,openedFrom:"topbar"}))},disabled:()=>!g().A.state.online,renderTooltip:()=>Ze().A.formatMessage(oe().AY.unavailableOfflineTooltip),disableTooltip:()=>g().A.state.online}),hn=(0,oe().Ls)({key:"export block",displayName:Wt.exportName,analyticsName:Wt.exportName.defaultMessage,validators:[],closeParentMenu:!0,render:(e,t)=>{const{environment:i,blocks:o}=t,s=!g().A.state.online,a=i.currentUser.isLoggedIn(),r=o.length>0&&Ne(t),l=(0,de().P)(t),c=s||!a||!r||l;return(0,S.jsx)(z().A,{...e,svg:n(419178).Q,title:(0,S.jsx)(d().sA,{...Wt.exportName}),tooltipText:s?(0,S.jsx)(d().sA,{...oe().AY.unavailableOfflineTooltip}):c?(0,S.jsx)(d().sA,{...Wt.exportDisabledTooltip}):(0,S.jsx)(d().sA,{...Wt.exportCaption}),disabled:c,disabledFeedback:c})},action:({blocks:e,environment:t})=>{const i=e[0];if(!i.isDefined())return;let o=!0;const s=(0,F().U)(e[0]);if(s){const e=null==s?void 0:s.collectionStore();null!=e&&e.isPageTreeCollection()&&(o=!1)}n(370872).Ss({environment:t,root:{id:i.id,table:"block",spaceId:i.getSpaceId()},isCollectionViewExportTypeSupported:o})}}),vn=(0,oe().Ls)({key:"open page layout editor",displayName:Wt.openPageLayoutEditor,analyticsName:Wt.openPageLayoutEditor.defaultMessage,validators:[Pe],closeParentMenu:!0,render:function(e){const t=!g().A.state.online;return(0,S.jsx)(z().A,{...e,disabled:t,disabledFeedback:t,svg:n(167170)._,title:(0,S.jsx)(n(21140).Ye,{children:(0,S.jsx)(d().sA,{...Wt.openPageLayoutEditor})}),tooltipText:t?(0,S.jsx)(d().sA,{...oe().AY.unavailableOfflineTooltip}):void 0})},action:function({environment:e,blocks:t}){let i,o,s,a;for(const n of t)if(n.isCollectionView()){const e=n.getCollectionStoreIfSingleSource();if(e){i=n,o=e;const t=(0,F().U)(n);s=null==t?void 0:t.collectionViewStore(),a="customize_database_button_in_three_dot_menu";break}}else{const e=n.getAssociatedCollectionStore();if(e&&!e.isPageTreeCollection()){i=n,o=e,a="customize_page_button_in_three_dot_menu";break}}if(!o||!i||!a)throw new Error("Could not edit page layout: Could not find collection");n(447934).nh({environment:e,blockStore:i,collectionStore:o,collectionViewStore:s,from:a})},disabled:()=>!g().A.state.online,renderTooltip:()=>Ze().A.formatMessage(oe().AY.unavailableOfflineTooltip),disableTooltip:()=>g().A.state.online});var yn=()=>n(232930),bn=()=>n(857437),Sn=()=>n(819493),xn=()=>n(452558),An=()=>n(419357),Mn=()=>n(678553),wn=()=>n(962036),jn=()=>n(715011);function kn(e){const{blockStore:t,onClickOriginRect:n,handleAccept:u,handleDismiss:p}=e,g=(0,s().v3)(),m=(0,s().Y0)(),f=(0,d().tz)(),[h,v]=(0,i.useState)(""),[y,b]=(0,bn().$)(),x=(0,a().K8)((()=>({environment:g,blocks:[t],originRect:n,publicEditMode:void 0,analyticsFrom:"topbar_more_menu"})),[g,t,n]),{initialSections:A,filterSections:M}=(0,a().K8)((()=>({initialSections:Gt({environment:g,intl:f,context:x,isFiltering:!1}),filterSections:Gt({environment:g,intl:f,context:x,isFiltering:!0})})),[g,f,x]),w=(0,a().K8)((()=>0===h.length&&!t.isCollectionView()&&t.canEdit()&&t.hasContent()&&!t.isPersonProfile()),[t,h]),j=(0,a().K8)((()=>0===h.length&&t.canEdit()&&!t.isPersonProfile()),[t,h.length]),k=(0,a().K8)((()=>t.canEdit()&&t.isCollectionView()),[t]),I=(0,r().IS)((e=>({caption:{color:e.text.tertiary},icon:{color:e.icon.secondary,width:16,height:16},menuPropIcon:{color:e.palette.gray[500]}})),[]),C=(0,a().K8)((()=>m.isMobile&&!o().default.checkGate({gateName:"mobile_topbar_more_menu_search"})||t.isPersonProfile()),[m,t]),T=(0,S.jsxs)(S.Fragment,{children:[w&&!j?(0,S.jsx)(Mn().Ay,{caption:(0,S.jsx)("span",{style:I.caption,children:(0,S.jsx)(d().sA,{id:"pageMoreButton.wordCount.caption",defaultMessage:"Word count: {count}",values:{count:(0,S.jsx)(jn().A,{store:t})}})})}):void 0,j?(0,S.jsx)("div",{style:{marginBottom:1},children:(0,S.jsx)(Sn().$,{store:t,isPageMoreButton:!0,showWordCount:w})}):void 0]}),_=m.isMobile?{menuType:Me().gu.Modal,title:(0,S.jsx)(d().sA,{defaultMessage:"Actions",id:"topbarMoreButton.mobileActionsMenu.title"}),leftRightButtonStyle:I.menuPropIcon,onClickRight:p,titleOuterStyle:{fontSize:17,fontWeight:c().Wy.bold},paddingTop:10,enableMobileRefresh:!0}:{menuType:Me().gu.Popup,maxHeight:"80vh"};return(0,S.jsxs)(ke().A,{..._,children:[C?(0,S.jsx)(xn().A,{sections:A,onAccept:u,context:x}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(K().A,{isInput:!0,children:(0,S.jsx)(An().Ay,{value:h,onChange:e=>v(e.target.value),focus:!0,focusAfterAnimation:!0,placeholder:f.formatMessage({defaultMessage:"Search actionsâ€¦",id:"topbarMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0,preventCaptureSpacebarWhenEmpty:!0,inputLeft:(0,l().q)({...I.icon}),showClearButton:!0,...y})}),(0,S.jsx)(xn().A,{sections:A,filterSections:M,onAccept:u,context:x,filter:h,showNoResultsMessage:!0,initialFocus:h.length>0?0:void 0,comboboxProps:b})]}),w||j?m.isMobile?(0,S.jsx)(S.Fragment,{children:T}):(0,S.jsx)(K().A,{topBorder:!0,children:T}):void 0,k?(0,S.jsx)(In,{}):void 0]})}function In(){return(0,S.jsx)(K().A,{topBorder:!0,children:(0,S.jsx)(wn().g,{title:(0,S.jsx)(d().sA,{defaultMessage:"Learn about databases",id:"topbar.moreButton.collectionHelpButton"}),href:(0,yn().x)("guides.database"),analyticsFrom:"topbar_more_button"})})}},444570:(e,t,n)=>{n.d(t,{KG:()=>u,TH:()=>c,mC:()=>p,zb:()=>g});var i=()=>n(700500),o=()=>n(534177),s=()=>n(120672),a=()=>n(695625),r=()=>n(148832),l=()=>n(666710),d=()=>n(327994);function c(e){var t,n,o;const{environment:d,store:c,selectableBoundingRect:u}=e,p=c.getType();if(!p||!(0,i().UL)(p))return(null==u?void 0:u.width)??0;const g=null===(t=c.getParentBlockStore())||void 0===t?void 0:t.getType();if("page"===g)return(0,s().y)(d);const m=null===(n=c.getRecordStoreUIParent())||void 0===n||null===(n=n.findRecordStoreUIAncestor((e=>Boolean(e instanceof r().B&&e.isPath([])&&a().T.findSelectableFromStore(e)))))||void 0===n?void 0:n.ancestor,f=m&&m instanceof r().B?a().T.findSelectableFromStore(m):void 0,h=f?null===(o=l().default.state.selectableRectMap.get(f))||void 0===o?void 0:o.width:(null==u?void 0:u.width)??0,v=g?function(e){switch(e){case"bulleted_list":case"toggle":case"to_do":case"numbered_list":return 26;case"callout":return 60;default:return 0}}(g):0;return(h??0)-v}function u(e){const{store:t,selectableBoundingRect:n,containerWidth:s}=e,a=t.getType();if(!(n&&s&&a&&(0,i().UL)(a)))return 0;const r=(e=>{const n=null===(e=t.getFormat())||void 0===e?void 0:e.block_alignment;if(!n){return t.isRootOrDirectChild()?"center":"left"}return n})();switch(r){case"right":const e=s/2;return n.width-e-e;case"center":return(n.width-s)/2;case"left":return 0;default:(0,o().HB)(r)}}function p(e){const t=e.getNode();return t?parseInt(getComputedStyle(t).marginTop):0}function g(){return d().u}},449789:(e,t,n)=>{function i(e){const{store:t,toggleSource:n}=e;t.update((e=>{const t=!e.isKeyboardShortcutsOpen;return{...e,isKeyboardShortcutsOpen:t,toggleSource:t?n:e.toggleSource,openCount:t?e.openCount+1:e.openCount}}))}function o(e){const{store:t}=e;return t.state.isKeyboardShortcutsOpen}n.d(t,{W:()=>o,j:()=>i})},450327:(e,t,n)=>{n.d(t,{lR:()=>R,P6:()=>_,pG:()=>D,ug:()=>P,j$:()=>B,DZ:()=>T});n(296540);var i=()=>n(340498),o=n(474848);const s={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.26 15.25",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M6.575 10A3.425 3.425 0 0 1 10 6.575v-.64c0-.445.533-.664.847-.35l1.328 1.329a.49.49 0 0 1 0 .7l-1.328 1.329a.495.495 0 0 1-.847-.35v-.918A2.325 2.325 0 1 0 12.325 10a.55.55 0 1 1 1.1 0 3.425 3.425 0 0 1-6.85 0"}),(0,o.jsx)("path",{d:"M2.375 10a7.625 7.625 0 1 1 15.25 0 7.625 7.625 0 0 1-15.25 0M10 3.625a6.375 6.375 0 1 0 0 12.75 6.375 6.375 0 0 0 0-12.75"})]})},a=(0,i().wt)("arrowInCircleClockwiseInCircle",s);var r=()=>n(973238);const l={viewBox:"0 0 20 20",fittedViewBox:"2.37 4.12 16.53 14.66",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M2.375 6.25c0-1.174.951-2.125 2.125-2.125h11c1.174 0 2.125.951 2.125 2.125v6.04l-1.25-.632V7.5H3.625v6.25c0 .483.392.875.875.875h7.213l.454 1.25H4.5a2.125 2.125 0 0 1-2.125-2.125zm2.258.184a.625.625 0 1 0 0-1.25.625.625 0 0 0 0 1.25m2.625-.625a.625.625 0 1 0-1.25 0 .625.625 0 0 0 1.25 0m1.375.625a.625.625 0 1 0 0-1.25.625.625 0 0 0 0 1.25"}),(0,o.jsx)("path",{d:"m17.426 14.65.474-.17a.433.433 0 0 0 .047-.796l-5.644-2.85a.433.433 0 0 0-.604.533l2.268 6.239a.435.435 0 0 0 .815.007l.574-1.509 2.225 2.433a.758.758 0 1 0 1.122-1.022l-2.287-2.501z"})]})},d=(0,i().wt)("browserClick",l);var c=()=>n(12193),u=()=>n(835607),p=()=>n(735790),g=()=>n(158469),m=()=>n(69708),f=()=>n(381678),h=()=>n(47373),v=()=>n(972435),y=()=>n(134217),b=()=>n(749240),S=()=>n(56366),x=()=>n(401497),A=()=>n(171347),M=()=>n(238453);function w(){const e=(0,S().O$)(n(765957).AppStoreSidebarSpaceStore);return e?(0,o.jsx)(j,{spaceStore:e}):null}function j({spaceStore:e}){const t=((0,M().U4)({spaceStore:e,requestType:"guest"})??0)+((0,M().U4)({spaceStore:e,requestType:"member"})??0),n=(0,x().IS)((e=>({container:{position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",insetInlineEnd:6,top:6},badge:{top:-3,insetInlineEnd:-5}})),[]);return 0===t?null:(0,o.jsx)("div",{style:n.container,children:(0,o.jsx)(A().$,{count:t,style:n.badge})})}var k=()=>n(284371),I=()=>n(125565);function C({userStore:e}){const t=(0,m().tz)(),n=(0,S().K8)((()=>e.getFullName(t)),[t,e]);return n?(0,o.jsx)(I().A,{style:{fontWeight:k().Wy.medium},children:n}):null}const T=(0,m().YK)({offlineModeDebugTab:{id:"spaceSettingsSidebar.offlineModeDebugTab.title",defaultMessage:"Offline Mode"},offlineTab:{id:"spaceSettingsSidebar.offlineTab.title",defaultMessage:"Offline"},accountTab:{id:"spaceSettingsSidebar.accountTab.title",defaultMessage:"My account"},generalTab:{id:"spaceSettingsSidebar.generalTab.title",defaultMessage:"General"},settingsTab:{id:"spaceSettingsSidebar.settingsTab.title",defaultMessage:"Settings"},teamsTab:{id:"spaceSettingsSidebar.teamsTab.title",defaultMessage:"Teamspaces"},peopleTab:{id:"spaceSettingsSidebar.peopleTab.title",defaultMessage:"People"},membersTab:{id:"spaceSettingsSidebar.membersTab.title",defaultMessage:"Members"},explorePlansTab:{id:"spaceSettingsSidebar.explorePlansTab.title",defaultMessage:"Explore plans"},upgradePlanTab:{id:"spaceSettingsSidebar.upgradePlanTab.title",defaultMessage:"Upgrade plan"},billingTab:{id:"spaceSettingsSidebar.billingTab.title",defaultMessage:"Billing"},subscriptionTab:{id:"spaceSettingsSidebar.subscriptionTab.title",defaultMessage:"Subscription"},connectedAppsTab:{id:"spaceSettingsSidebar.connectedAppsTab.title",defaultMessage:"My connected apps"},connectionsTab:{id:"spaceSettingsSidebar.connectionsTab.title",defaultMessage:"Connections"},userConnectionsTab:{id:"spaceSettingsSidebar.userConnectionsTab.title",defaultMessage:"My connections"},securityTab:{id:"spaceSettingsSidebar.securityTab.title",defaultMessage:"Security"},securityAndDataTab:{id:"spaceSettingsSidebar.securityAndDataTab.title",defaultMessage:"Security & data"},identityTab:{id:"spaceSettingsSidebar.identityTab.title",defaultMessage:"Identity"},identityProvisioningTab:{id:"spaceSettingsSidebar.identity&ProvisioningTab.title",defaultMessage:"Identity & provisioning"},publicPagesTab:{id:"spaceSettingsSidebar.publicPages.title",defaultMessage:"Public pages"},sitesTab:{id:"spaceSettingsSidebar.sites.title",defaultMessage:"Sites"},customEmojiTab:{id:"spaceSettingsSidebar.emoji.title",defaultMessage:"Emoji"},adminContentSearchTab:{id:"spaceSettingsSidebar.adminContentSearch.title",defaultMessage:"Content search"},languageAndRegionTab:{id:"spaceSettingsSidebar.languageAndRegionTab.title",defaultMessage:"Language & region"},integrationsTab:{id:"spaceSettingsSidebar.integrationsTab.title",defaultMessage:"Integrations"},spaceConnectionsTab:{id:"spaceSettingsSidebar.spaceConnectionsTab.title",defaultMessage:"Connections"},auditLogTab:{id:"spaceSettingsSidebar.auditLogTab.title",defaultMessage:"Audit log"},notificationsAndSettings:{id:"spaceSettingsSidebar.notificationsAndSettings.title",defaultMessage:"My notifications & settings"},preferences:{id:"spaceSettingsSidebar.preferences.title",defaultMessage:"Preferences"},mySettings:{id:"spaceSettingsSidebar.mySettings.title",defaultMessage:"My settings"},notifications:{id:"spaceSettingsSidebar.notifications.title",defaultMessage:"Notifications"},myNotifications:{id:"spaceSettingsSidebar.myNotifications.title",defaultMessage:"My notifications"},analyticsTab:{id:"spaceSettingsSidebar.analyticsTab.title",defaultMessage:"Analytics"},importTab:{id:"spaceSettingsSidebar.importsTab.title",defaultMessage:"Import"},verifiedPagesTab:{id:"spaceSettingsSidebar.verifiedPagesTab.title",defaultMessage:"Verified pages"},requestsTab:{id:"spaceSettingsSidebar.requestsTab.title",defaultMessage:"Requests"},experimentsTab:{id:"spaceSettingsSidebar.experimentsTab.title",defaultMessage:"Experiments"},performanceToolbarTab:{id:"spaceSettingsSidebar.performanceToolbarTab.title",defaultMessage:"Performance Toolbar"},userSimilarityScoresTab:{id:"spaceSettingsSidebar.userSimilarityScoresTab.title",defaultMessage:"User Similarity Scores"},collectionsDebugTab:{id:"spaceSettingsSidebar.collectionsDebug.title",defaultMessage:"Collections"},aiTab:{id:"spaceSettingsSidebar.aiTab.title",defaultMessage:"Notion AI"},designPreviewsTab:{id:"spaceSettingsSidebar.designPreviewsTab.title",defaultMessage:"Design Previews"},mobileNativeTab:{id:"spaceSettingsSidebar.mobileNativeTab.title",defaultMessage:"Mobile Native"}});function _(e,t){return{width:20,height:20,marginInlineEnd:8,color:t?e.blue.text.accentPrimary:e.icon.primary,fill:t?e.blue.text.accentPrimary:e.icon.primary,flexShrink:0}}const P={profile:(e,t)=>{const i=(0,f()._)(e);return(0,o.jsx)("div",{style:_(t),children:(0,o.jsx)(n(453697).A,{size:20,hasTooltip:!0,avatarShouldShowShadow:!0,userStore:i})})},notifications_and_settings:()=>(0,p().M)(),user_settings:()=>(0,p().M)(),notifications:()=>(0,n(104077).r)(),connected_apps:()=>(0,n(212473).arrowUpRightSquareIcon)(),language_and_region:()=>(0,c().globeIcon)(),offline:()=>(0,r().arrowInCircleDownIcon)(),settings:()=>(0,n(212727).gearIcon)(),teams:()=>(0,n(737693).V)(),members:()=>(0,u().F)(),plans:e=>{const t=b().subscriptionDataStoreInstance.state;return t&&y().Fq(t)?(0,n(889074).O)():(0,n(132855).arrowInCircleUpFillIcon)()},billing:()=>(0,n(302995).creditCardIcon)(),subscription:()=>a(),requests:()=>(0,n(898615).F)(),security:()=>(0,n(753363).keyIcon)(),identity_provisioning:()=>(0,n(15936).checkmarkShieldIcon)(),admin_content_search:()=>(0,n(207207).J)(),integrations:()=>(0,n(858141).squareGrid2X2Icon)(),audit_log:()=>(0,n(517397).F)(),analytics:()=>(0,g().f)(),imports:()=>(0,n(820579).arrowLineDownIcon)(),sites:()=>d(),public_pages:()=>(0,c().globeIcon)(),custom_emoji:()=>(0,n(424139).emojiFaceIcon)(),experiments:()=>(0,n(824375).sparklesIcon)(),performance_toolbar:()=>(0,n(200582).m)(),user_similarity_scores:()=>(0,u().F)(),collection_debug:()=>(0,n(62616).c)(),offline_mode_debug:()=>(0,r().arrowInCircleDownIcon)(),verified_pages:()=>(0,n(112665).badgeCheckIcon)(),ai:()=>(0,n(529099).aiFaceIcon)(),design_previews:()=>(0,g().f)(),mobile_native:()=>(0,n(530093).Z)()};const B={profile:e=>function(e){const t=(0,f()._)(e);return t?(0,o.jsx)(C,{userStore:t}):(0,o.jsx)(m().sA,{id:"spaceSettings.sidebar.personalSettingsSection.userDetails.title",defaultMessage:"Me"})}(e),notifications_and_settings:()=>v().A.formatMessage(T.notificationsAndSettings),user_settings:()=>v().A.formatMessage(T.preferences),notifications:()=>v().A.formatMessage(T.notifications),connected_apps:()=>v().A.formatMessage(T.connectionsTab),language_and_region:()=>v().A.formatMessage(T.languageAndRegionTab),offline:()=>v().A.formatMessage(T.offlineTab),settings:()=>v().A.formatMessage(T.generalTab),teams:()=>v().A.formatMessage(T.teamsTab),members:e=>(0,h().Qd)()||(0,h().bW)(e)?v().A.formatMessage(T.peopleTab):v().A.formatMessage(T.membersTab),plans:()=>function(){const e=b().subscriptionDataStoreInstance.state;if(y().Fq(e))return v().A.formatMessage(T.explorePlansTab);return v().A.formatMessage(T.upgradePlanTab)}(),billing:()=>v().A.formatMessage(T.billingTab),subscription:()=>v().A.formatMessage(T.subscriptionTab),requests:()=>v().A.formatMessage(T.requestsTab),security:()=>v().A.formatMessage(T.securityTab),identity_provisioning:e=>v().A.formatMessage(T.identityTab),admin_content_search:()=>v().A.formatMessage(T.adminContentSearchTab),integrations:()=>v().A.formatMessage(T.spaceConnectionsTab),audit_log:()=>v().A.formatMessage(T.auditLogTab),analytics:()=>v().A.formatMessage(T.analyticsTab),imports:()=>v().A.formatMessage(T.importTab),sites:()=>v().A.formatMessage(T.sitesTab),public_pages:()=>v().A.formatMessage(T.publicPagesTab),custom_emoji:()=>v().A.formatMessage(T.customEmojiTab),verified_pages:()=>v().A.formatMessage(T.verifiedPagesTab),experiments:()=>v().A.formatMessage(T.experimentsTab),performance_toolbar:()=>v().A.formatMessage(T.performanceToolbarTab),user_similarity_scores:()=>v().A.formatMessage(T.userSimilarityScoresTab),collection_debug:()=>v().A.formatMessage(T.collectionsDebugTab),offline_mode_debug:()=>v().A.formatMessage(T.offlineModeDebugTab),ai:()=>v().A.formatMessage(T.aiTab),design_previews:()=>v().A.formatMessage(T.designPreviewsTab),mobile_native:()=>v().A.formatMessage(T.mobileNativeTab)},D={profile:()=>null,notifications_and_settings:()=>null,user_settings:()=>null,notifications:()=>null,connected_apps:()=>null,language_and_region:()=>null,offline:()=>null,settings:()=>null,teams:()=>null,members:e=>(0,h().bW)(e)&&(0,o.jsx)(w,{}),plans:()=>null,billing:()=>null,subscription:()=>null,requests:()=>null,security:()=>null,identity_provisioning:()=>null,sites:()=>null,public_pages:()=>null,custom_emoji:()=>null,admin_content_search:()=>null,integrations:()=>null,audit_log:()=>null,analytics:()=>null,imports:()=>null,verified_pages:()=>null,experiments:()=>null,performance_toolbar:()=>null,user_similarity_scores:()=>null,collection_debug:()=>null,offline_mode_debug:()=>null,ai:()=>(0,o.jsx)(n(147294).Ee,{newBadgeKey:"notion_ai_workspace_settings",didUserEngage:!1,keyType:"date"}),design_previews:()=>null,mobile_native:()=>null};function R(e){switch(e){case"profile":case"notifications_and_settings":case"user_settings":case"notifications":case"connected_apps":case"language_and_region":case"offline":case"settings":case"members":case"plans":case"billing":case"subscription":case"security":case"identity_provisioning":case"admin_content_search":case"integrations":case"imports":case"teams":case"audit_log":case"analytics":case"sites":case"public_pages":case"custom_emoji":case"verified_pages":case"requests":case"experiments":case"performance_toolbar":case"user_similarity_scores":case"collection_debug":case"offline_mode_debug":case"ai":case"design_previews":case"mobile_native":return e;default:return}}},466529:(e,t,n)=>{n.r(t),n.d(t,{HorizontalTemplatePicker:()=>le});n(898992),n(823215),n(354520),n(581454);var i=n(296540),o=()=>n(59226),s=()=>n(242422),a=()=>n(993905),r=()=>n(726637),l=()=>n(484714),d=()=>n(792485),c=()=>n(56366),u=()=>n(401497),p=()=>n(929219),g=()=>n(252291),m=()=>n(30537),f=()=>n(396896),h=()=>n(575157),v=()=>n(589407),y=()=>n(38679),b=()=>n(120282),S=()=>n(421559),x=()=>n(340498),A=()=>n(206267),M=()=>n(826693),w=()=>n(179034),j=()=>n(69708),k=()=>n(534177),I=()=>n(160568),C=()=>n(384944),T=()=>n(33301),_=()=>n(231297),P=()=>n(926010),B=()=>n(277942),D=()=>n(600434),R=()=>n(166442),E=()=>n(732067),L=()=>n(118078),O=()=>n(590027),N=()=>n(226916),F=()=>n(264699),U=()=>n(631611),z=()=>n(828634),K=()=>n(549500),V=()=>n(249696),q=()=>n(68465),W=()=>n(972435),G=()=>n(478726),H=()=>n(806638),Y=()=>n(241498),$=()=>n(978510),Q=()=>n(321843),Z=()=>n(970585),J=()=>n(50764),X=()=>n(922952),ee=()=>n(317053),te=()=>n(939740),ne=()=>n(417392),ie=()=>n(125565),oe=()=>n(532731),se=()=>n(286611),ae=n(474848);const re=8;function le(e){const{store:t,context:n,menuListStore:o,editorWidth:B}=e,[D]=(0,i.useState)((()=>(0,A().JW)())),R=pe(),L=(0,G().L5)(n),U=(0,c().K8)((()=>!r().A.isMobile&&"on"===s().default.getEligibleGroup({experimentId:"horizontal_template_picker_quick_agent_access",defaultGroup:"control"})),[]),Z=(0,c().K8)((()=>{const e=O().MU.state.chatSidebarVisibility;return"open"===e||"opening"===e}),[]),le=U&&!Z,fe=(0,u().IS)((e=>({root:{background:L?e.background.elevated:e.background.primary,paddingBottom:"min(48px, 5vh)",pointerEvents:"all"},pillContainer:{cursor:"pointer",display:"flex",justifyContent:U?"center":"flex-start"},quickAccess:{marginTop:le?16:0,display:"flex",width:"100%",justifyContent:"center",maxHeight:le?200:0,opacity:le?1:0,transform:`translateY(${le?0:24}px)`,pointerEvents:le?"auto":"none",transition:"all 250ms ease"},menu:{maxWidth:B}})),[L,U,le,B]),[he,ve]=function(e){const{store:t,eventId:n,hideAskAiItem:i}=e,o=(0,l().v3)(),a=(0,c().K8)((()=>"editor"===t.getRole()),[t]),p={name:(0,j().tz)().formatMessage(ue.tableTemplateTitle),type:"database",iconFn:S().T,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>{const n=t.getParentStore();n&&(0,X().u)(n)&&(0,ee().openTemplateOnboardingModal)({parentStore:n,template:void 0,version:(0,ee().getTemplateOnboardingVersion)({template:void 0}),origin:"new_page_pills",navigateToOnFinish:"created_collection",onClose:i=>{"accepted_template"!==i.type&&"accepted_empty_collection"!==i.type||_().createAndCommit({environment:e,canUndo:!1,perform:e=>{if(C().zv({store:t,transaction:e,data:{alive:!1}}),n.table===w().ev){const i=n.getContentIds();C().zv({store:n,transaction:e,data:{content:i.filter((e=>e!==t.id))}})}},userAction:"clean_up_empty_new_page"})}})}},m=function(e){const{environment:t,store:n}=e,i=(0,j().tz)(),o=(0,d().S)(),a=(0,c().K8)((()=>null==o?void 0:o.publicEditModeStore.state),[null==o?void 0:o.publicEditModeStore]),r=(0,c().K8)((()=>(0,q().ZE)(a)),[a]);return{name:(0,c().K8)((()=>"on"===s().default.getEligibleGroup({experimentId:"research_mode_empty_page_entrypoint",defaultGroup:"control"})),[])?i.formatMessage(ue.writeWithAi):i.formatMessage(ue.askAi),type:"ai",iconFn:e=>(0,ae.jsx)(E().UY,{}),shouldShow:()=>r,onClick:()=>{_().createAndCommit({userAction:"HorizontalTemplatePicker.genericHelpMeWriteNewPageWithAI",environment:t,canUndo:!0,perform:e=>{T().n({environment:t,store:n,transaction:e,preventTextSelection:!1,onTextSelection(){(0,P().openHelpMeWriteGenericPopup)({environment:t,title:""})}})}})}}}({environment:o,store:t}),f=function(e){const{eventId:t}=e,n=(0,j().tz)(),i=(0,d().S)(),o=(0,c().K8)((()=>null==i?void 0:i.publicEditModeStore.state),[null==i?void 0:i.publicEditModeStore]),a=(0,c().K8)((()=>!r().A.isMobile&&"on"===s().default.getEligibleGroup({experimentId:"research_mode_empty_page_entrypoint",defaultGroup:"control"})&&!Q().R.isResearchModeDown()&&(0,q().ZE)(o)),[o]);return{name:n.formatMessage(ue.researchWithAi),type:"ai-research",iconFn:e=>(0,ae.jsx)(g().I,{icon:y().P,colorPalette:"red",colorVariant:"accentPrimary",size:"sm"}),shouldShow:()=>a,onClick:()=>{(0,Y().d)({eventId:t,onClose:e=>{}})}}}({store:t,eventId:n}),v=function(){const e=(0,j().tz)(),t=(0,u().DP)(),n=(0,V().W)();return{name:e.formatMessage(ue.transcription),type:"transcription",iconFn:e=>(0,b().a)({...e,fill:t.icon.primary}),shouldShow:()=>n,onClick:async e=>{const{transcriptionCreateActions:t}=await K().$O.load();t.appendTranscriptionBlockToPage({environment:e})}}}(),x=function(e){const t=(0,l().v3)();return{name:(0,j().tz)().formatMessage(ue.formTemplateTitle),type:"quick-form",iconFn:h().D,shouldShow:()=>!0,onClick:async()=>{await(0,N().t)({environment:t,store:e})}}}(t),A=function(e){const{isTablet:t}=(0,l().Y0)(),{isOnGettingStartedPage:n}=(0,$().R)();return{name:W().A.formatMessage(oe().KQ.templates),type:"templates",iconFn:e=>(0,M().notionTemplateIcon)(e),shouldShow:()=>!t&&!n,onClick:e=>{(0,H().P)({environment:e})}}}(),k=[m,f,v,p,...a?[x]:[],A].filter((e=>(!i||"ai"!==e.type)&&e.shouldShow(o))),I=[...F()._,ge,oe().zD];return[k,I]}({store:t,eventId:D,hideAskAiItem:U}),[ye,be]=function(e){const{store:t,editorWidth:n,initialVisible:o,initialOverflow:s,eventId:a}=e,r=(0,l().v3)(),d=(0,j().tz)(),c=pe(),p=(0,u().IS)((e=>({icon:{width:x().Ev.default,height:x().Ev.default,fill:e.icon.primary}})),[]),[f,h]=i.useState(void 0),[y,b]=i.useState([]),[S,A]=i.useState(void 0),[M,w]=i.useState(o.length);(0,i.useEffect)((()=>{if(!(n&&y.every(k().O9)&&S))return;let e=0,t=0;for(;t<o.length&&(e+=y[t]+re,!(e+S>n+24));)t++;w(t)}),[y,n,o.length,S]);const C=o.slice(0,M).map(((e,n)=>{const i={key:"ai-skill"===e.type?`${e.type}-${n}`:e.type,render:({ref:i,...o})=>{var s;const a=i=>{var s;o.onMouseEnter(i),null===(s=e.onMouseEnter)||void 0===s||s.call(e,r,t),h(n)},l=n=>{var i;null===(i=e.onMouseLeave)||void 0===i||i.call(e,r,t),h(void 0)};return(0,ae.jsx)(z().EE,{onSizeChange:e=>{if(y[n]===e.width)return;const t=[...y];t[n]=e.width,b(t)},children:(0,ae.jsx)("div",{children:(0,ae.jsx)(se().J,{...o,focused:f===n,format:"horizontal-new-page",title:(0,ae.jsx)(ie().A,{children:e.name}),type:e.type,icon:null===(s=e.iconFn)||void 0===s?void 0:s.call(e,p.icon),onMouseEnter:a,onMouseLeave:l,locked:!1})})})},action:n=>{(0,J().E)(r)&&(I().ki(r,{is_keyboard:"keydown"===n.event.type,from:"horizontal_template_picker",template_type:e.type,event_id:a}),e.onClick(r,t))}};return i})),[T,_]=i.useState(!1),P=M,B={key:"more",render:({ref:e,...n})=>(0,ae.jsx)(ne().Ay,{origin:(0,ae.jsx)(z().EE,{onSizeChange:e=>A(e.width),children:(0,ae.jsx)("div",{children:(0,ae.jsx)(se().J,{...n,focused:f===P,onMouseEnter:e=>{h(P)},onMouseLeave:e=>{h(void 0)},format:"horizontal-new-page",title:c?null:(0,ae.jsx)(ie().A,{children:d.formatMessage(ue.more)}),type:"more",icon:(0,ae.jsx)(g().I,{icon:v().ellipsisIcon,colorVariant:"secondary"}),locked:!1})})}),alignmentToOrigin:"start",placementToOrigin:"top",originGap:4,open:T,popupType:m().n.Popup,onDismiss:()=>_(!1),render:()=>(0,ae.jsx)(me,{store:t,items:[...o.slice(M),...s],eventId:a})}),action:e=>{I().ki(r,{is_keyboard:"keydown"===e.event.type,from:"horizontal_template_picker",template_type:"more",event_id:a}),_(!0)}};return[C,B]}({store:t,editorWidth:B,initialVisible:he,initialOverflow:ve,eventId:D});return!(0,c().O$)(p().e)?null:(0,ae.jsx)(a().s,{allowSelectionWithin:!1,children:(0,ae.jsx)(te().Ay,{type:te().Oh.Horizontal,store:o,initialFocus:void 0,style:fe.menu,disableInitialScroll:!0,disableCommandEnter:!0,isEnterOnHoverEmpty:!0,disableKeyboard:!0,sections:[{key:"Get started",render:e=>(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(de,{isInPeekView:L}),(0,ae.jsx)("div",{style:fe.root,children:(0,ae.jsxs)(f().VP,{gap:12,children:[U?null:(0,ae.jsx)(ie().A,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:500},children:R?(0,ae.jsx)(j().sA,{defaultMessage:"Get started with",id:"PageEditor.horizontalTemplatePicker.getStarted.label.new"}):(0,ae.jsx)(j().sA,{defaultMessage:"Get started",id:"PageEditor.horizontalTemplatePicker.getStarted.label"})}),(0,ae.jsx)("div",{style:fe.pillContainer,children:(0,ae.jsx)(f().fI,{gap:re,children:e.children})}),U?(0,ae.jsx)("div",{style:fe.quickAccess,children:(0,ae.jsx)(ce,{blockStore:t})}):null]},e.key)})]}),items:[...ye,be]}]})})}function de(e){const t=(0,u().IS)((t=>({fade:{background:`linear-gradient(0deg, ${e.isInPeekView?t.background.elevated:t.background.primary} 0%, ${t.contentBackgroundTransparent} 100%)`,height:140,width:"100%"}})),[e.isInPeekView]);return(0,ae.jsx)("div",{style:t.fade})}function ce(e){const{blockStore:t}=e,n=(0,l().v3)(),o=(0,j().tz)(),[s,a]=(0,i.useState)(0),r=(0,D().K7)("agent_quick_access"),d=(0,u().IS)((e=>({container:{width:"100%",maxWidth:560},loading:{width:"100%",height:44,borderRadius:16,background:"dark"===e.mode?e.gray.background.secondary:e.background.secondary}})),[]),c=(0,i.useCallback)((e=>{e&&((0,L().showChatSidebar)({environment:n,store:t,source:"new_page_quick_access",chatSidebarRouteData:{isOpen:!0,threadId:e.id}}),a((e=>e+1)))}),[t,n]);return(0,ae.jsx)("div",{style:d.container,children:(0,ae.jsx)(U().hP,{surface:U().wy.inferenceTranscriptChatView,children:(0,ae.jsx)(B().n_,{renderLoading:e=>e?(0,ae.jsx)("div",{style:d.loading}):null,aiChatFeatureController:r,clientStore:R().defaultClientAIChatStore,onThreadChange:c,threadStore:void 0,placeholder:o.formatMessage(ue.askAiPlaceholder)},s)})})}const ue=(0,j().YK)({askAi:{defaultMessage:"Ask AI",id:"newpage.templates.writeWithAiCondensed"},askAiPlaceholder:{defaultMessage:"Ask, search, or make anythingâ€¦",id:"newpage.templates.askAiPlaceholder"},writeWithAi:{defaultMessage:"Write",id:"newpage.templates.writeWithAi"},researchWithAi:{defaultMessage:"Research",id:"newpage.templates.researchWithAi"},transcription:{defaultMessage:"AI Meeting Notes",id:"newpage.templates.transcription"},more:{defaultMessage:"More",id:"newpage.templates.more"},tableTemplateTitle:{defaultMessage:"Database",id:"newpage.templates.table"},formTemplateTitle:{defaultMessage:"Form",id:"newpage.templates.form"}});function pe(){const{isTablet:e}=(0,l().Y0)(),t=(0,o().X)("tablet_refresh_template_pills_gate");return!(!e||!t)||!r().A.isMobile}const ge={name:"",type:"divider",iconFn:e=>null,shouldShow:()=>!0,onClick:()=>{}};function me(e){const{store:t,items:n,eventId:o}=e,s=(0,l().v3)(),a=(0,i.useMemo)((()=>new(Z().A)),[]),r=(0,u().IS)((e=>({menu:{width:200,cursor:"pointer",padding:"6px 4px"},icon:{width:x().Ev.default,fill:e.icon.primary},divider:{height:1,background:e.border.primary,margin:"6px -6px"}})),[]),d=n.filter((e=>e.shouldShow(s))).map((e=>{const n={key:e.name,render:({ref:t,...n})=>{var i;return"divider"===e.type?(0,ae.jsx)("div",{style:r.divider}):(0,ae.jsx)(se().J,{...n,format:"horizontal-new-page-submenu",title:(0,ae.jsx)(ie().A,{children:e.name}),type:e.type,icon:null===(i=e.iconFn)||void 0===i?void 0:i.call(e,r.icon),locked:!1})},action:n=>{(0,J().E)(s)&&(I().ki(s,{is_keyboard:"keydown"===n.event.type,from:"horizontal_template_picker",template_type:e.type,event_id:o}),e.onClick(s,t))}};return n}));return(0,ae.jsx)(te().Ay,{type:te().Oh.Vertical,store:a,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,isEnterOnHoverEmpty:!0,disableKeyboard:!0,sections:[{key:"Items",render:e=>(0,ae.jsx)("div",{style:r.menu,children:(0,ae.jsx)(f().VP,{children:e.children},e.key)}),items:d}]})}},467935:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A});var i=n(296540),o=()=>n(484714),s=()=>n(56366),a=()=>n(97294),r=()=>n(631524),l=()=>n(584262),d=()=>n(721479),c=()=>n(69708),u=()=>n(148024),p=()=>n(857783),g=()=>n(232930),m=()=>n(765957);class f extends(()=>n(757695))().Store{getInitialState(){return{open:!1}}}const h=new f;var v=()=>n(633783),y=n(474848);const b={fontSize:24,lineHeight:1.2,marginBottom:6,fontWeight:n(284371).Wy.bold,marginInlineEnd:"auto"},S={display:"flex",alignItems:"center",marginTop:8,marginBottom:18},x={padding:"24px 36px 24px",minWidth:300};const A=function(){const e=(0,s().O$)(h);return(0,y.jsx)(n(676007).a,{open:e.open,innerStyle:x,preventHideChildrenWhileOpening:!0,render:()=>(0,y.jsxs)(i.Fragment,{children:[(0,y.jsxs)("div",{style:S,children:[(0,y.jsx)("div",{style:b,children:(0,y.jsx)(c().sA,{id:"importModal.importButton.label",defaultMessage:"Import"})}),(0,y.jsx)(M,{})]}),(0,y.jsx)("div",{children:(0,y.jsx)(j,{modalState:e})})]}),onDismiss:w})};function M(){const e=(0,o().v3)();return(0,y.jsx)(a().N,{href:(0,g().x)("guides.import"),onClick:()=>u().FH(e,{from:"import"}),external:!0,children:(0,y.jsx)(r().p,{size:"sm",iconLeading:d().questionMarkCircleSmallIcon,colorPalette:"gray",children:(0,y.jsx)(c().sA,{id:"importModal.helpButton.label",defaultMessage:"Learn about importing"})})})}function w(){h.setState({open:!1})}function j({modalState:e}){const t=(0,o().v3)(),{mainEditorCurrentBlockStore:n,currentSpaceStore:i,currentSpaceViewStore:a,currentUserSettingsStore:r}=(0,s().K8)((()=>{const{mainEditorCurrentBlockStore:e,sidebarSpaceStore:t,sidebarSpaceViewStore:n,currentUserSettingsStore:i}=m().default.state;return{mainEditorCurrentBlockStore:e,currentSpaceStore:t,currentSpaceViewStore:n,currentUserSettingsStore:i}}),[]);return n&&i&&a&&r?(0,y.jsx)(v().A,{pageStore:e.open&&e.pageStore?e.pageStore:n,spaceStore:i,spaceViewStore:a,userSettingsStore:r,analyticsFrom:"modal",onComplete:e=>function(e,t){h.setState({open:!1}),p().uK({environment:t,store:e,pageVisitSource:l().y8.Import})}(e,t),readOnlyCreditButton:!1}):null}},487443:(e,t,n)=>{n.r(t),n.d(t,{TeamPermissionsInviteWithModal:()=>l});n(296540);var i=()=>n(56366),o=()=>n(401497),s=()=>n(433876),a=()=>n(284331),r=n(474848);function l({store:e,permissionsInviteStore:t,origin:n}){const l=(0,i().K8)((()=>t.state.modalOpen),[t]),d=()=>{t.reset()},c=(0,o().IS)((()=>({modal:{alignSelf:"center",overflow:"visible",top:0,width:500},overlay:{display:"flex",flexDirection:"column",alignItems:"end",padding:22}})),[]);return(0,r.jsx)(s().A,{modalStyle:c.modal,open:l,onDismiss:d,renderContent:()=>(0,r.jsx)("div",{style:c.overlay,children:(0,r.jsx)(a().A,{store:e,permissionsInviteStore:t,isNewlyCreatedTeam:!1,onSubmitSuccessful:d,onDismiss:d})}),origin:n})}},498002:(e,t,n)=>{n.d(t,{zk:()=>L,wm:()=>R,Js:()=>N,H0:()=>U,hk:()=>z});n(296540);var i=()=>n(3284),o=()=>n(201980),s=()=>n(69708),a=()=>n(231297),r=()=>n(67103),l=()=>n(401497),d=()=>n(553965),c=()=>n(575143),u=()=>n(515918),p=()=>n(859428),g=n(474848);function m({menuListItemProps:e,title:t,caption:n,icon:i,disabled:o,tooltipText:s,showNewBadge:a}){const r=(0,l().IS)((()=>({menuItem:{WebkitBackfaceVisibility:"hidden"},caption:{whiteSpace:"pre-wrap"}})),[]);return(0,g.jsx)(p().A,{placement:"right",disableTooltip:!s,renderTooltip:()=>s,render:s=>(0,g.jsx)(c().A,{...(0,d().A)(e,s),style:r.menuItem,title:t,caption:n,captionStyle:n?r.caption:void 0,svg:i,disabled:o,disabledFeedback:o,right:a&&(0,g.jsx)(u().A,{})})})}var f=()=>n(574357),h=()=>n(339425),v=()=>n(440902),y=()=>n(598101),b=()=>n(500758),S=()=>n(37433),x=()=>n(182106),A=()=>n(765957),M=()=>n(854150),w=()=>n(95758);function j(e){if(!e)return;const t=e.getParentPointer(),n=e.getRecordStoreUIParent();return(null==t?void 0:t.table)===M().yK&&n?w().h.createChildStore(n,t):j(e.getParentBlockStore())}var k=()=>n(370907);function I(e){return function({environment:e,blocks:t}){if(!(0,k().y)())return!1;if(!b().w8({environment:e,blocks:t}))return!1;const n=e.currentUser.id,{sidebarSpaceStore:i}=A().default.state;if(!n||null==i||!i.isDefined())return!1;if(!(0,S().sx)({environment:e,spaceStore:i}))return!1;for(const s of t){var o;if(!s.isPageBlock())return!1;if("team"!==(null===(o=x().A.findOutlinerItemFromStore(s))||void 0===o?void 0:o.type))return!1;const e=j(s);if(null==e||!e.isOwner(n))return!1}return!0}(e)&&(0,n(730107).I)()}n(18107),n(967357);function C(e){if(!(0,v().v)(e))return!1;const t=e.blocks.at(0);return!!t&&(0,n(483461).S)(t)}var T=()=>n(10984),_=()=>n(10521),P=()=>n(843005);const B=(0,s().YK)({createTeamFromPageFullName:{id:"action.createTeamFromPage.fullName",defaultMessage:"Turn into teamspace"},createTeamFromPageCaption:{id:"action.createTeamFromPage.caption",defaultMessage:"Space for your team to customize permissions and collaborate"},createTeamFromPageName:{id:"action.createTeamFromPage.name",defaultMessage:"Teamspace"},turnPageIntoWikiCaption:{id:"action.turnPageIntoWiki.caption",defaultMessage:"Organize by owner, tags, verification, and more"},turnPageIntoWikiName:{id:"action.turnPageIntoWiki.name",defaultMessage:"Wiki"},undoTurnPageIntoWikiName:{id:"action.undoTurnPageIntoWiki.name",defaultMessage:"Undo wiki"},turnPageIntoWikiFullName:{id:"action.turnPageIntoWiki.fullName",defaultMessage:"Turn into wiki"}});function D(e,t){return(0,_().Ls)({key:"turn page into team",displayName:t,analyticsName:B.createTeamFromPageFullName.defaultMessage,svg:i().arrowSquarePathUpDownIcon,validators:e,closeParentMenu:!0,render:(e,i)=>{const a=function(e){const{blockStore:t,environment:n}=e;if(!n.currentUser.id)return null;if(0===o().q4_(t.getTitleValue()).length)return(0,g.jsx)(s().sA,{defaultMessage:"Cannot turn page without a title into a Teamspace",id:"sidebar.turnPageIntoTeamButton.missingTitleDisabledTooltip"});if("private"===(0,S().UY)(t).accessLevel&&!(0,T().HO)())return(0,g.jsx)(s().sA,{defaultMessage:"Only Business Plans and above can turn a private page into a Teamspace",id:"sidebar.turnPageIntoTeamButton.privateTeamsOnlyOnBusinessPlansAndAboveDisabledTooltip"});return null}({environment:i.environment,blockStore:i.blocks[0]});return(0,g.jsx)(m,{menuListItemProps:e,title:(0,g.jsx)(s().sA,{...t}),caption:(0,g.jsx)(s().sA,{...B.createTeamFromPageCaption}),disabled:Boolean(a),tooltipText:a,icon:n(737693).V})},action:({blocks:e,environment:t})=>{const i=e[0];n(475355).Vs({environment:t,page:i})}})}const R=D([(0,f().U)([I,(0,y().A)(C)])],B.createTeamFromPageFullName),E=D([I],B.createTeamFromPageName),L=(0,n(12956).u)({key:"turn into teamspace or wiki",displayName:P().DZ.turnIntoSection,analyticsName:P().DZ.turnIntoSection.defaultMessage,svg:i().arrowSquarePathUpDownIcon,validators:[I,C],subActions:()=>[(0,_().gy)({key:"turn into teamspace or wiki",render:e=>(0,g.jsx)(n(89924).A,{...e}),actions:[E,F]})],width:300});function O(e,t){return(0,_().Ls)({key:"turn page into wiki",displayName:t,analyticsName:B.turnPageIntoWikiFullName.defaultMessage,svg:i().arrowSquarePathUpDownIcon,validators:e,closeParentMenu:!0,action:({environment:e,blocks:t})=>{"bottom_right"===n(242422).default.getEligibleGroup({experimentId:"wiki_education_convert_modal",defaultGroup:"control"})?n(816013).r.setState({showConvertTooltip:!1,forceShow:!0,pendingWikiBlockStore:t[0]}):a().createAndCommit({userAction:"actionRegistry.turnIntoAction.wiki",environment:e,canUndo:!0,perform:n=>{r().hJ({environment:e,blocks:t,transaction:n,source:"page_menu"})}})},render:e=>{const o=!n(929219).A.state.online;return(0,g.jsx)(m,{menuListItemProps:e,title:(0,g.jsx)(s().sA,{...t}),disabled:o,icon:i().arrowSquarePathUpDownIcon,tooltipText:o?(0,g.jsx)(s().sA,{..._().AY.unavailableOfflineTooltip}):(0,g.jsx)(s().sA,{...B.turnPageIntoWikiCaption})})}})}const N=O([(0,f().U)([C,(0,y().A)(I)]),(0,y().A)(h().o)],B.turnPageIntoWikiFullName),F=O([C],B.turnPageIntoWikiName);const U=O([C,(0,y().A)(h().o)],B.turnPageIntoWikiFullName),z=(0,_().Ls)({key:"undo turn page into wiki",displayName:B.undoTurnPageIntoWikiName,analyticsName:B.undoTurnPageIntoWikiName.defaultMessage,svg:n(454503).arrowUTurnUpLeftIcon,validators:[v().v,n(730580).V,(0,y().A)(n(606376).l),n(460995).A,n(77295).K,(0,y().A)(h().o)],closeParentMenu:!0,action:async({environment:e,blocks:t})=>{const{accept:i}=await n(901389).Gh({message:(0,g.jsx)("div",{style:{textAlign:"center"},children:(0,g.jsx)(s().sA,{defaultMessage:"Turn â€œ{pageName}â€ back into a normal page?",id:"action.undoTurnIntoWiki.message",values:{pageName:o().q4_(t[0].getTitleValue())}})}),description:(0,g.jsx)("div",{style:{textAlign:"center"},children:(0,g.jsx)(s().sA,{defaultMessage:"This will remove properties like owners and verification from your pages",id:"action.undoTurnIntoWiki.description"})})});i&&a().createAndCommit({userAction:"actionRegistry.undoTurnIntoAction.wiki",environment:e,canUndo:!0,isUndoTransaction:!0,perform:n=>{r().nQ({environment:e,blocks:t,transaction:n,source:"page_menu"})}})}})},500844:(e,t,n)=>{n.r(t),n.d(t,{TeamPermissionsInvite:()=>R});n(898992),n(354520),n(581454),n(737550);var i=n(296540),o=()=>n(484714),s=()=>n(56366),a=()=>n(401497),r=()=>n(842599),l=()=>n(187174),d=()=>n(69708),c=()=>n(542056),u=()=>n(404277),p=()=>n(897537),g=()=>n(417555),m=()=>n(856952),f=()=>n(47373),h=()=>n(722872),v=()=>n(743260),y=()=>n(37433),b=()=>n(765957),S=()=>n(205618),x=()=>n(224701),A=()=>n(631524),M=()=>n(668725),w=()=>n(496603),j=()=>n(760217),k=()=>n(406699),I=()=>n(939740),C=()=>n(89924),T=()=>n(859428),_=()=>n(308228),P=()=>n(43450),B=n(474848);function D(e){const{selectedRole:t,allRoles:n,onChange:i,store:r,labelStyle:l,isRoleForRestrictedMember:c}=e,{device:p}=(0,o().v3)(),g=(0,a().DP)(),m=(0,P().R)(r),f=(0,s().K8)((()=>{const{sidebarSpaceStore:e}=b().default.state;return null==e?void 0:e.canEditMembership()}),[]),v=(0,s().K8)((()=>r.isDefault()),[r]);return(0,B.jsx)(k().A,{popupType:p.isMobile?k().z.SlideUp:k().z.Popup,renderOrigin:e=>(0,B.jsxs)(A().p,{style:l,...e,children:[(0,B.jsx)(d().sA,{...y().Y7[t].label}),(0,M().b)({width:10,marginInlineStart:4,fill:g.icon.tertiary})]}),placementToOrigin:"bottom",render:e=>{const o=[{key:"roles",render:e=>(0,B.jsx)(C().A,{...e,topBorder:0!==e.index}),items:n.map((n=>{const{isDisabled:o,disabledReason:s}=(0,_().m)({role:n,isCurrentUserTeamOwner:Boolean(m),userIsSpaceAdmin:Boolean(f),isDefaultTeam:v,isRoleForRestrictedMember:c}),a={key:n,render:e=>(0,B.jsx)(T().A,{disableTooltip:!o,placement:"right",textWrap:!0,renderTooltip:()=>s,render:i=>(0,B.jsx)("span",{...i,children:(0,B.jsx)(j().A,{...e,isChecked:w().n4(n,t),disabled:o,disabledFeedback:o,title:(0,B.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,B.jsx)(d().sA,{...y().Y7[n].label})}),caption:(0,B.jsx)("span",{style:{color:g.text.secondary},children:(0,B.jsx)(d().sA,{...y().Y7[n].caption})}),shouldWrapCaption:!0})})}),action:()=>{i(n),e.close()}};return a}))}];let s;return s=p.isMobile?{menuType:h().gu.Modal,title:(0,B.jsx)(d().sA,{id:"teamPermissionsMenu.mobile.title",defaultMessage:"Select teamspace role"}),right:(0,B.jsx)(d().sA,{id:"teamPermissionsMenu.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:e.close}:{menuType:h().gu.Popup,width:264},(0,B.jsx)(u().A,{...s,children:(0,B.jsx)(I().Ay,{type:I().Oh.Vertical,initialFocus:void 0,sections:o})})}})}function R(e){const{store:t,onEmptySubmit:n}=e,i=(0,o().v3)();(0,l().Yb)((async()=>{await x().x(i)}),[]);const r=(0,s().uB)(e.permissionsInviteStore,S().A),d=(0,s().K8)((()=>Boolean(r.state.isFocused)),[r]),c=(0,s().K8)((()=>r.state.tokenQuery),[r]),g=d&&c.length>0,m=(0,a().IS)((e=>({permissionsInviteSearchRequest:{position:"absolute",width:"100%",borderRadius:4,backgroundColor:e.background.primary,boxShadow:e.shadowLG,marginTop:4},scroller:{zIndex:1}})),[]);function f(e){r.setState({...r.state,isFocused:e})}return(0,B.jsx)("div",{onFocus:()=>f(!0),onBlur:()=>f(!1),children:(0,B.jsx)(u().A,{menuType:h().gu.Popup,header:(0,B.jsx)(E,{store:t,permissionsInviteStore:r,setFocus:f,onEmptySubmit:n}),scrollerStyle:m.scroller,width:"100%",tokenInputHeader:!1,disableScroller:!0,children:g?(0,B.jsx)("div",{style:m.permissionsInviteSearchRequest,children:(0,B.jsx)(p().A,{permissionsInviteStore:r,store:t,shouldShowGroups:!0,sectionRenderLimit:10,membersOnly:!1,disableInvitedUsers:!0})}):void 0})})}function E(e){const{store:t,permissionsInviteStore:n,onEmptySubmit:l,setFocus:u}=e,p=(0,d().tz)(),f=(0,o().v3)(),h=(0,i.useRef)(null),y=(0,s().K8)((()=>Boolean(n.state.isFocused)),[n]),b=(0,s().K8)((()=>n.state.tokenQuery),[n]),S=(0,s().K8)((()=>n.state.inviteTargets),[n]),x=(0,s().K8)((()=>t.getDisableRestrictedMembers()),[t]),A=(0,a().IS)((e=>({inputTokenVerticalMargin:{marginTop:3,marginBottom:3},tokenMenuItem:{alignItems:"unset",borderRadius:4,paddingTop:5,paddingBottom:5,paddingInlineStart:8,paddingInlineEnd:5,boxShadow:y?e.buttonBlueFocusRing:e.inputBoxShadow,maxHeight:"40vh"},inputDiv:{marginBottom:0},guestToken:{backgroundColor:e.statusTokenBackground.yellow},restrictedMemberToken:{backgroundColor:x?e.statusTokenBackground.red:void 0}})),[y,x]);function M(e){const t=n.state.inviteTargets.filter((t=>t!==e));n.setState({...n.state,inviteTargets:t})}const w=S.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`,n=(0,v().yi)(e)?A.guestToken.backgroundColor:(0,v().dV)(e)?A.restrictedMemberToken.backgroundColor:void 0;return(0,B.jsx)(g().A,{target:e,onClickRemove:M,shouldWrap:!0,style:A.inputTokenVerticalMargin,backgroundColor:n},t)}));return(0,B.jsx)(m().Ay,{ref:h,focus:y,onClick:()=>u(!0),format:m().le.Share,value:b,onChange:async e=>{await async function(e){const{environment:t,permissionsInviteStore:n,event:i,setFocus:o,inputRef:s}=e,a=i.target.value,{extractedEmails:l,newInputValue:d}=(0,r().Ct)(a),u=await c().Ah(t,l),p=u.filter((e=>!(0,v().mQ)({target:e,permissionsInviteStore:n}))),g=[...n.state.inviteTargets,...p];if(n.setState({...n.state,inviteTargets:g,tokenQuery:d}),g.length>0){if(!d){const e=s.current;e&&(e.value="")}o(!(p.length>0))}}({environment:f,event:e,permissionsInviteStore:n,setFocus:u,inputRef:h})},onEmptySubmit:l,type:"email",placeholder:p.formatMessage({id:"teamPermissionsInvite.searchInput.placeholder",defaultMessage:"Search people or groups"}),tokens:w,tokenWrapStyle:{gap:4},onRemoveLastToken:function(){const e=n.state;n.setState({...e,inviteTargets:e.inviteTargets.slice(0,-1)})},focusAfterAnimation:!0,right:(0,B.jsx)(L,{store:t,permissionsInviteStore:n}),style:A.tokenMenuItem,inputStyle:A.inputTokenVerticalMargin,inputDivStyle:A.inputDiv,inputFullWidth:!0})}function L(e){const{store:t,permissionsInviteStore:n}=e,i=(0,s().K8)((()=>{const e=b().default.state.sidebarSpaceStore;return!(null!=e&&e.getDisableTeamGuests())&&(0,f().Qd)()}),[]),o=(0,s().K8)((()=>n.state.inviteRole),[n]),r=(0,s().K8)((()=>n.state.inviteTargets.some((e=>(0,v().dV)(e)))),[n]),l=(0,a().IS)((()=>({teamRoleLabel:{marginTop:3,marginBottom:3,marginInlineStart:5}})),[]);function d(e){n.setState({...n.state,inviteRole:e})}return i?(0,B.jsx)(D,{store:t,selectedRole:o,allRoles:y().vm,onChange:d,labelStyle:l.teamRoleLabel,isRoleForRestrictedMember:r}):(0,B.jsx)(D,{store:t,selectedRole:o,allRoles:y().H1,onChange:d,labelStyle:l.teamRoleLabel,isRoleForRestrictedMember:r})}},511718:(e,t,n)=>{n.r(t),n.d(t,{CollectionTypedDatabaseMigrationModal:()=>de});var i=n(296540),o=()=>n(484714),s=()=>n(56366),a=()=>n(401497),r=()=>n(66689),l=()=>n(69708),d=()=>n(346705),c=(n(581454),()=>n(148307)),u=()=>n(288420),p=()=>n(822295),g=()=>n(340498),m=()=>n(284371),f=()=>n(96409),h=()=>n(972435),v=()=>n(755170),y=()=>n(854672),b=()=>n(132389),S=()=>n(125565),x=n(474848);const A=(0,l().YK)({dummyTask1:{id:"MyTasksWidgetPreview.dummyTask1",defaultMessage:"Set up sync with Lisa"},dummyTask2:{id:"MyTasksWidgetPreview.dummyTask2",defaultMessage:"Review design docs"},dummyTask3:{id:"MyTasksWidgetPreview.dummyTask3",defaultMessage:"Create color palette"},dummyTask4:{id:"MyTasksWidgetPreview.dummyTask4",defaultMessage:"Book flight to New York"},dummyTask5:{id:"MyTasksWidgetPreview.dummyTask5",defaultMessage:"Fix broken links"},dummyTask6:{id:"MyTasksWidgetPreview.dummyTask6",defaultMessage:"Upgrade database"},Blocked:{id:"MyTasksWidgetPreview.blockedStatus",defaultMessage:"Blocked"},"In Progress":{id:"MyTasksWidgetPreview.inProgressStatus",defaultMessage:"In Progress"},"Not Started":{id:"MyTasksWidgetPreview.notStartedStatus",defaultMessage:"Not Started"},locationIndicator:{id:"MyTasksWidgetPreview.locationIndicator",defaultMessage:"In"}}),M=[{icon:"ðŸ“…",taskName:h().A.formatMessage(A.dummyTask1),status:"Blocked",teamspace:"Eng",location:(0,p().presentIcon)({width:g().Ev.sm,fill:"#448361"})},{icon:"ðŸ“š",taskName:h().A.formatMessage(A.dummyTask2),status:"In Progress",teamspace:"Design",location:(0,u().W)({width:g().Ev.sm,fill:"#CB912F"})},{icon:"ðŸŽ¨",taskName:h().A.formatMessage(A.dummyTask3),status:"In Progress",teamspace:"Design",location:(0,u().W)({width:g().Ev.sm,fill:"#CB912F"})},{icon:"ðŸ›«",taskName:h().A.formatMessage(A.dummyTask4),status:"Not Started",teamspace:"Eng",location:(0,p().presentIcon)({width:g().Ev.sm,fill:"#448361"})},{icon:"ðŸš§",taskName:h().A.formatMessage(A.dummyTask5),status:"Not Started",teamspace:"Design",location:(0,u().W)({width:g().Ev.sm,fill:"#CB912F"})},{icon:"ðŸ‘©â€ðŸ’»",taskName:h().A.formatMessage(A.dummyTask6),status:"Not Started",teamspace:"Eng",location:(0,p().presentIcon)({width:g().Ev.sm,fill:"#448361"})}],w={Blocked:"red","In Progress":"blue","Not Started":"gray"};function j(){const e=C();return(0,x.jsx)(v().A,{title:(0,x.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.AssignedToMePreview.Title",defaultMessage:"My tasks"}),tooltip:void 0,icon:(0,x.jsx)("div",{style:{paddingInlineStart:4},children:(0,x.jsx)(y().A,{type:"app_package_asset",size:18,icon:c().A.images.appPackages.taskDbIconSvg})}),children:(0,x.jsx)("div",{style:e.dummyAssignedToMe,children:(0,x.jsx)(k,{})})})}function k(){const e=M.map(((e,t)=>(0,x.jsx)(I,{row:e},t)));return(0,x.jsx)("div",{style:{display:"flex",marginTop:4,paddingInlineEnd:16,flexDirection:"column"},children:e})}function I({row:e}){const t=C();return(0,x.jsxs)("div",{style:t.eachTask,children:[(0,x.jsxs)("div",{style:t.taskName,children:[(0,x.jsx)("span",{style:t.taskIcon,children:e.icon}),(0,x.jsx)(S().A,{style:t.taskTitle,children:e.taskName})]}),(0,x.jsx)("div",{style:t.taskStatus,children:(0,x.jsx)(f().X,{type:"status",value:h().A.formatMessage(A[e.status]),color:w[e.status],groupColor:void 0})}),(0,x.jsx)(b().A,{size:8}),(0,x.jsxs)("div",{style:t.location,children:[(0,x.jsx)("span",{style:t.locationIndicator,children:h().A.formatMessage(A.locationIndicator)}),(0,x.jsx)("div",{style:{...t.locationIcon,..."Design"===e.teamspace?{...t.designTeamspace}:{...t.engTeamspace}},children:e.location})]})]})}function C(){return(0,a().IS)((e=>({dummyAssignedToMe:{width:"60%",maxHeight:270,minHeight:90,paddingBottom:10},eachTask:{display:"flex",alignItems:"center",padding:4},taskName:{width:220,display:"flex",...m().RC},taskIcon:{fontSize:14,marginInlineEnd:8},taskTitle:{color:e.text.primary,fontSize:14,fontWeight:500},taskStatus:{display:"flex",width:130},location:{display:"flex",alignItems:"center"},locationIndicator:{color:e.text.secondary,marginInlineEnd:4,maxWidth:48,...m().RC},locationIcon:{display:"flex",justifyContent:"center",fontSize:14,height:18,width:18,borderRadius:4},designTeamspace:{backgroundColor:"light"===e.mode?"#FBF3DB":"#5c3b23"},engTeamspace:{backgroundColor:"light"===e.mode?"#E5F2E2":"#243d30"}})),[])}n(898992),n(354520),n(803949),n(737550);var T=()=>n(124092),_=()=>n(160432),P=()=>n(584262),B=()=>n(489242),D=()=>n(488715),R=()=>n(852424),E=()=>n(668725),L=()=>n(689094),O=()=>n(100622),N=()=>n(128427),F=()=>n(223393),U=()=>n(231297),z=()=>n(962910),K=()=>n(413955),V=()=>n(462106);const q={[r().yx.Status]:["status","checkbox","select"]};function W(e,t,n){const i=t.type,o=e in q?q[e]:[i];return Object.entries(n).filter((([e,t])=>{if(t)return o.includes(t.type)}))}var G=()=>n(895876),H=()=>n(39758),Y=()=>n(722872),$=()=>n(696746),Q=()=>n(666429),Z=()=>n(760217),J=()=>n(406699),X=()=>n(404277),ee=()=>n(939740),te=()=>n(89924),ne=()=>n(690197);function ie(e){const{collectionContextStore:t,databaseType:n,containerStyle:c}=e,u=(0,o().v3)(),p=(0,l().tz)(),{isPhone:m,isMobileNative:f}=(0,o().Y0)(),h=m&&f,v=function(e){return(0,a().IS)((t=>({formTitle:{display:"inline-flex"},emojiTitle:{fontSize:36,marginInlineEnd:8},perPropertyInstruction:{color:t.text.secondary,fontSize:e?14:12,marginBottom:8},requiredPropertyError:{color:O().Tj.red,fontSize:e?14:12,marginInlineEnd:e?8:6},propertyMappingInstructions:{marginTop:6,marginBottom:24,fontSize:e?16:14,fontWeight:e?500:400},propertyMappingDropdown:{display:"flex",alignItems:"center"},chevronDownIconEnabled:{width:e?14:10,fill:t.icon.tertiary},propertyMappingTitle:{fontSize:e?16:14,color:t.text.tertiary},propertyMappingMenu:{borderRadius:6,border:`1px solid ${t.tableDividerColor}`,boxShadow:"none"},propertyConversionCallout:{display:"flex",alignItems:"center",marginInlineStart:4,marginTop:3,color:t.text.tertiary},a:{color:"white",cursor:"pointer"},propertyIcon:{fill:t.darkTextColor},buttons:{marginBlockStart:e?"auto":void 0},submitMigrationButton:{display:"flex",height:e?36:32,fontSize:e?16:14},learnMore:{display:"flex",justifyContent:"center",marginTop:8,marginInlineStart:0,width:"100%"},learnMoreButton:{display:"inline-flex",justifyContent:"center",width:"100%",height:26},closeButton:{width:"100%",height:36,marginTop:8,display:"inline-flex",justifyContent:"center",fontSize:16,color:t.text.tertiary}})),[e])}(m),y=(0,a().DP)(),[A,M]=(0,i.useState)(!1),w=(0,s().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),j=(0,s().K8)((()=>(0,V().Y)((0,K().appConfigs)(),n)),[n]),k=(0,s().K8)((()=>{if(w&&j)return function(e,t){const n={};for(const[i,o]of Object.entries(e))if(i.startsWith("notion://")&&(null==o?void 0:o.type)){const e=W(i,o,t);1===e.length&&(n[i]=e[0][0])}return n}(j,w)}),[j,w]),I=(0,i.useCallback)(((e,t)=>{const n=t.type;return W(e,t,w??{}).map((([e,t])=>({key:e,title:null==t?void 0:t.name,icon:(0,x.jsx)(R().zB,{size:g().Ev.sm,style:v.propertyIcon,theme:y,icon:null==t?void 0:t.icon,type:(null==t?void 0:t.type)||n})})))}),[y,v.propertyIcon,w]),C=(0,s().K8)((()=>{const e=Object.keys(j||{}).filter((e=>void 0!==(null==j?void 0:j[e])&&e.startsWith("notion://"))),t=Object.fromEntries(e.map((e=>[e,void 0])));return Object.entries(j||{}).forEach((([e,n])=>{if(!n)return;const i=null==k?void 0:k[e];if(i)return void(t[e]=i);0===I(e,n).length&&(t[e]=B().Ul)})),t}),[j,k,I]),[q,ie]=(0,i.useState)(C),ae=(0,i.useMemo)((()=>Object.entries(q).some((([e,t])=>{if(e===r().yx.Status){const e=null==w?void 0:w[t||""];if("checkbox"===(null==e?void 0:e.type)||"select"===(null==e?void 0:e.type))return!0}}))),[w,q]),re=(0,i.useCallback)((e=>{const t=null==j?void 0:j[e],n={width:16,height:16,marginInlineEnd:10};if(!t)return null;const i=[...I(e,t),{key:B().Ul,title:p.formatMessage(oe.createNew),icon:(0,L().W)({width:n.width,fill:v.propertyIcon.fill}),type:void 0}],o=q[e],s=null==w?void 0:w[o||""],a=!o&&A,d=e===r().yx.Status;let c=null;return o===B().Ul?c=(0,L().W)(n):s&&(c=R().LE[null==s?void 0:s.type](n)),(0,x.jsx)(J().A,{popupType:m?J().z.SlideUp:J().z.Popup,renderOrigin:t=>(0,x.jsxs)("div",{style:{marginBottom:24},children:[(0,x.jsx)(S().A,{isMultiline:!0,style:v.perPropertyInstruction,children:(0,x.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.PerPropertyInstructions",defaultMessage:"Pick the property that represents {propertyDescription}",values:{propertyDescription:p.formatMessage(se[e])}})}),(0,x.jsx)(Z().A,{disabled:1===i.length,disabledFeedback:!0,focused:!1,right:(0,x.jsxs)("div",{style:v.propertyMappingDropdown,children:[a?(0,x.jsx)("span",{style:v.requiredPropertyError,children:(0,x.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.RequiredPropertyError",defaultMessage:"Required"})}):void 0,(0,E().b)({...v.chevronDownIconEnabled,...a?{fill:O().Tj.red}:{}})]}),rightStyle:{marginInlineEnd:m?14:8},title:(0,x.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[c,o===B().Ul?p.formatMessage(oe.createNew):s?s.name:p.formatMessage(oe.select)]}),titleStyle:o?{display:"flex",alignItems:"center"}:v.propertyMappingTitle,itemMarginLeft:8,style:{...v.propertyMappingMenu,...a?{borderColor:O().Tj.red}:{}},buttonStyle:{margin:0,width:"100%"},...t}),d&&ae?(0,x.jsx)(S().A,{isSmall:!0,isMultiline:!0,children:(0,x.jsx)("div",{style:v.propertyConversionCallout,children:(0,x.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CheckboxSelectMappingInfo",defaultMessage:"This property will be converted to a Status property type."})})}):void 0]}),placementToOrigin:"bottom",alignmentToOrigin:"start",render:t=>{const n=[{key:"propertyOptions",render:e=>(0,x.jsx)(te().A,{...e,topBorder:0!==e.index}),items:i.map((n=>{const i={key:n.key,render:t=>(0,x.jsx)(Z().A,{...t,icon:n.icon,title:n.title,isChecked:q[e]===n.key}),action:()=>{ie({...q,[e]:n.key}),M(!1),t.close()}};return i}))}],o=m?{menuType:Y().gu.ActionSheet}:{menuType:Y().gu.Popup,width:250};return(0,x.jsx)(X().A,{...o,children:(0,x.jsx)(ee().Ay,{type:ee().Oh.Vertical,initialFocus:void 0,sections:n})})}},e)}),[j,I,p,v,q,w,A,ae,m]),le=(0,i.useCallback)((()=>{const e=t.collectionStore(),i=t.collectionViewBlockStore();if(!e||!i)return;const o=(0,$().XH)("main"),s=null==o?void 0:o.getModel(),a=s&&o&&(0,D().Q)({model:s,getRecordModel:o.getRecordModel,pageVisitSource:P().y8.TypedDBConversionToast}),c=(0,$().XH)("myTasks"),g=null==c?void 0:c.getModel(),m=g&&c&&(0,D().Q)({model:g,getRecordModel:c.getRecordModel,pageVisitSource:P().y8.TypedDBConversionToast});!function(e){return!Object.values(e).includes(void 0)}(q)?M(!0):U().createAndCommit({userAction:"CollectionTypedDatabaseMigrationModal.migrateDatabase",environment:u,canUndo:!0,perform:o=>{z().bC({environment:u,collectionViewBlockStore:i,collectionStore:e,databaseType:n,propertyMapping:{...q},typedPropertySchemas:{...j},transaction:o}),d().A.setState({isModalOpen:!1,collectionContextStore:void 0}),n===r().dC&&(H().e.locallyMutatedTasksDatabase=!0),(0,N().Y)({environment:u,database_type:n,property_mapping:q,collectionContextStore:t});const s=h?(0,x.jsx)(l().sA,{defaultMessage:"<span>{databaseName} has been turned into a {singularType} database. You will now be able to see your assigned tasks in <a>My tasks</a>.</span>",id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SuccessfulTypingToastMessage.nativePhone",values:{singularType:(0,G().$O)(n),databaseName:e.getName()||p.formatMessage(oe.defaultCollectionName),span:e=>(0,x.jsx)("span",{children:e}),a:e=>(0,x.jsx)("a",{style:v.a,href:m,children:e})}}):(0,x.jsx)(l().sA,{defaultMessage:"<span>{databaseName} has been turned into a {singularType} database. You will now be able to see your assigned tasks in <a>Home</a>.</span>",id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SuccessfulTypingToastMessage",values:{singularType:(0,G().$O)(n),databaseName:e.getName()||p.formatMessage(oe.defaultCollectionName),span:e=>(0,x.jsx)("span",{children:e}),a:e=>(0,x.jsx)("a",{style:v.a,href:a,children:e})}});(0,F().r)({item:{label:s,durationMs:Q().LX},undoFunc:()=>{U().createAndCommit({environment:u,userAction:"CollectionTypedDatabaseMigrationModal.TypedDBConversionToast.Undo",canUndo:!0,perform:e=>{z().Fr({environment:u,collectionContextStore:t,transaction:e})}})}})}})}),[t,q,u,n,j,h,p,v.a]);return(0,x.jsxs)("div",{style:c,children:[(0,x.jsxs)("div",{style:v.formTitle,children:[m?(0,x.jsx)("span",{style:v.emojiTitle,children:"ðŸ“‹"}):null,(0,x.jsx)(S().A,{style:v.propertyMappingInstructions,isMultiline:!0,children:(0,x.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.Title",defaultMessage:"Task databases require status, assignee, and due date properties."})})]}),m?(0,x.jsx)(b().A,{size:16}):null,Object.entries(C).map((([e,t])=>re(e))),(0,x.jsxs)("div",{style:v.buttons,children:[(0,x.jsx)(_().A,{colorPalette:"blue",style:v.submitMigrationButton,onClick:le,children:(0,x.jsx)(l().sA,{defaultMessage:"Turn into {type} database",id:"CollectionTypedDatabaseMigrationModal.ConfirmMigration.Title",values:{type:(0,G().$O)(n)}})}),m?(0,x.jsx)(T().p,{style:v.closeButton,onClick:()=>d().A.reset(),children:(0,x.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.Close",defaultMessage:"Close"})}):(0,x.jsx)(ne().A,{title:(0,x.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.Info",defaultMessage:"Learn about {type} databases",values:{type:(0,G().$O)(n)}}),analyticsFrom:"set_database_type",href:$().hI,style:v.learnMore,buttonStyle:v.learnMoreButton})]})]})}const oe=(0,l().YK)({createNew:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CreateNew",defaultMessage:"Create new"},select:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SelectFieldPlaceholder",defaultMessage:"Select..."},defaultCollectionName:{id:"CollectionTypedDatabaseMigrationModal.PropertyMappingToastSuccess.DefaultCollectionName",defaultMessage:"This database"},taskStatus:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskStatus",defaultMessage:"status"},taskAssignee:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskAssignee",defaultMessage:"assignee"},taskDueDate:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskDueDate",defaultMessage:"due date"}}),se={[r().yx.Status]:oe.taskStatus,[r().yx.Assign]:oe.taskAssignee,[r().yx.DueDate]:oe.taskDueDate};var ae=()=>n(676007),re=()=>n(754002);const le=32;function de(){const e=ge(),t=(0,o().Y0)(),n=(0,s().O$)(d().A);return n.isModalOpen?t.isPhone?(0,x.jsx)(re()._,{fullscreen:!0,innerStyle:e.phoneInner,renderInner:()=>(0,x.jsx)(pe,{collectionContextStore:n.collectionContextStore})}):(0,x.jsx)(ae().a,{open:!0,onDismiss:()=>d().A.reset(),innerStyle:e.desktopInner,render:()=>(0,x.jsx)(ue,{collectionContextStore:n.collectionContextStore})}):null}const ce=450;function ue(e){const t=ge();return(0,x.jsxs)("div",{style:{display:"flex",flexDirection:"column",position:"relative"},children:[(0,x.jsxs)("div",{style:t.title,children:[(0,x.jsx)("span",{style:t.emojiTitle,children:"ðŸ“‹"}),(0,x.jsx)(S().A,{isMultiline:!0,style:t.previewTitle,children:(0,x.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.AssignedToMePreview.Description",defaultMessage:"See all your tasks across multiple databases in your personal Home."})})]}),(0,x.jsx)(b().A,{size:36}),(0,x.jsx)(j,{}),(0,x.jsx)(ie,{collectionContextStore:e.collectionContextStore,databaseType:r().dC,containerStyle:t.form})]})}function pe(e){const t=ge();return(0,x.jsx)(ie,{collectionContextStore:e.collectionContextStore,databaseType:r().dC,containerStyle:t.phoneForm})}function ge(){return(0,a().IS)((e=>({desktopInner:{width:768,height:ce,padding:le},phoneInner:{width:"100%",height:"100%"},title:{display:"flex",maxWidth:"60%",alignItems:"center"},emojiTitle:{fontSize:36,marginInlineEnd:16},previewTitle:{color:e.text.primary,width:350,fontSize:17,fontWeight:500},form:{width:"45%",height:ce,background:e.background.secondary,position:"absolute",top:-le,insetInlineEnd:-le,padding:le,zIndex:1,borderInlineStart:`1px solid ${e.tableDividerColor}`,overflowY:"auto"},phoneForm:{display:"flex",flexDirection:"column",width:"100%",height:"100%",padding:le}})),[])}},514799:(e,t,n)=>{n.d(t,{H:()=>r});var i=()=>n(484714),o=()=>n(56366),s=()=>n(185078),a=()=>n(910302);function r(e){const{detectedLanguage:t,canSuggestInConfidence:n}=function(e){const{pageStore:t,enabled:n,forceUpdate:s=!1}=e,r=(0,i().v3)();return(0,o().K8)((()=>n&&t?a().bY({pageStore:t,environment:r,enabled:n,forceUpdate:s}):{detectedLanguage:void 0,canSuggestInConfidence:!1}),[t,r,n,s])}(e);return t&&!(0,s().cE)(t)?{detectedLanguage:void 0,canSuggestInConfidence:!1}:{detectedLanguage:t,canSuggestInConfidence:n}}},517397:(e,t,n)=>{n.d(t,{F:()=>s});n(296540);var i=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"2.4 2.88 15.21 14.27",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M7.975 5.175a.55.55 0 1 0 0 1.1h4.05a.55.55 0 1 0 0-1.1zm-.55 2.692a.55.55 0 0 1 .55-.55h4.05a.55.55 0 1 1 0 1.1h-4.05a.55.55 0 0 1-.55-.55"}),(0,i.jsx)("path",{d:"M2.4 4.861c0-1.092.883-1.975 1.975-1.975h8.55c1.092 0 1.975.883 1.975 1.975v7.889h2.075c.345 0 .625.28.625.625v1.8a1.973 1.973 0 0 1-1.975 1.975h-8.55A1.973 1.973 0 0 1 5.1 15.175V7.25H3.025a.625.625 0 0 1-.625-.625zM9.554 15.9h6.07a.723.723 0 0 0 .726-.725V14H9.5v1.175c0 .256-.049.5-.137.725zm-2.025 0c.4-.002.72-.325.72-.725v-1.8c0-.345.28-.625.626-.625h4.775V4.861a.723.723 0 0 0-.725-.725H6.213c.088.224.137.469.137.725v10.314c0 .402.323.725.725.725zM5.1 4.861a.723.723 0 0 0-.724-.725.723.723 0 0 0-.725.725V6H5.1z"})]})},s=(0,n(340498).wt)("scroll",o)},523713:(e,t,n)=>{n.d(t,{x:()=>s});var i=()=>n(534177),o=()=>n(686070);function s({isPhone:e,spaceStore:t}){return!e&&(0,i().O9)(t)&&!(0,o().d)({spaceStore:t})}},524663:(e,t,n)=>{n.r(t),n.d(t,{LazyExperimentSettings:()=>Ug,SpaceSettings:()=>dm});n(16280),n(898992),n(737550);var i=n(296540),o=()=>n(59226),s=()=>n(242422),a=()=>n(804773),r=()=>n(484714),l=()=>n(852507),d=()=>n(56366),c=()=>n(401497),u=()=>n(929219),p=()=>n(718827),g=()=>n(252291),m=()=>n(553034),f=()=>n(90907),h=()=>n(207207),v=()=>n(340498),y=()=>n(206267),b=()=>n(848538),S=()=>n(762433),x=()=>n(979340),A=()=>n(69708),M=()=>n(496603),w=()=>n(284371),j=()=>n(746970),k=()=>n(881738),I=()=>n(559926),C=()=>n(278768),T=()=>n(901389),_=()=>n(209660),P=()=>n(27579),B=()=>n(804411),D=()=>n(601866),R=()=>n(72234),E=()=>n(231297),L=()=>n(755199),O=()=>n(21735),N=(n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(803949),()=>n(604995)),F=()=>n(416845),U=()=>n(386164),z=()=>n(348564),K=()=>n(824862),V=()=>n(798880),q=()=>n(559506),W=()=>n(661461),G=()=>n(972435),H=()=>n(106628),Y=()=>n(230357),$=()=>n(757695);class Q extends $().Store{getInitialState(){return{spaceId:void 0,allUserIds:new Set,allBotIds:new Set,removedUserIds:new Set,removedBotIds:new Set}}isUserOrBotRemoved(e){return Boolean(e&&(this.state.removedUserIds.has(e)||this.state.removedBotIds.has(e)))}}const Z=new Q;class J extends $().Store{getInitialState(){return{cachedResponses:{}}}getCursor(e,t,n){if(n<=1||this.state.spaceId!==e)return;const i=(0,Y()._)(t);if(this.state.filterStr!==i)return;const o=this.state.cachedResponses[n-1];return"success"===o.status?null==o?void 0:o.nextCursor:void 0}startLoading(e,t){this.updateResultHelper(e,t,{status:"loading"})}updateLoadedResult(e,t,n){this.updateResultHelper(e,t,{...n,status:"success",loadedAt:Date.now()})}updateError(e,t){this.updateResultHelper(e,t,{status:"error"})}updateResultHelper(e,t,n){const i=(0,Y()._)(t);1!==t.pageNum&&this.state.spaceId===e&&this.state.filterStr===i?this.setState({spaceId:e,filterStr:i,cachedResponses:{...this.state.cachedResponses,[t.pageNum]:{...n}}}):this.setState({spaceId:e,filterStr:i,cachedResponses:{[t.pageNum||1]:{...n}}})}}const X=new J,ee=(0,A().YK)({loadCurrentAuditLogError:{id:"auditlog.error.loadCurrentAuditLogError",defaultMessage:"Failed to load audit logs"}});async function te(e){const{environment:t,spaceId:n,excludeCurrentUsers:i}=e,o=await q().callApi({eventName:"getHistoricalAuditLogUsers",environment:t,data:{spaceId:n,excludeCurrentUsers:i}});return"success"!==o.type?[]:o.data.results}async function ne(e){const{environment:t,spaceId:n,shouldUseEdgeCache:i}=e;if(Z.getState().spaceId!==n&&Z.reset(),!n)return;const o=await H().T.searchActions.load(),[s,a]=await Promise.all([i?{userIds:[],botIds:await o.getSpaceBotIds({environment:t})}:o.searchSpaceActorIds({environment:t,membersOnly:!1}),te({environment:t,spaceId:n,excludeCurrentUsers:i})]),r={spaceId:n,allUserIds:new Set,allBotIds:new Set,removedUserIds:new Set,removedBotIds:new Set};s.userIds.forEach((e=>{r.allUserIds.add(e)})),s.botIds.forEach((e=>{r.allBotIds.add(e)})),a.forEach((e=>{var t;(t=e.actorId)!==K().eR.id&&t!==V().BF.id&&t!==V().mc.id||r.allUserIds.has(e.actorId)?e.actorType!==V().oo||r.allUserIds.has(e.actorId)?e.actorType!==K().GP||r.allBotIds.has(e.actorId)||(r.allBotIds.add(e.actorId),r.removedBotIds.add(e.actorId)):(r.allUserIds.add(e.actorId),r.removedUserIds.add(e.actorId)):r.allUserIds.add(e.actorId)})),Z.setState(r)}var ie=()=>n(652399),oe=()=>n(416504),se=()=>n(42583),ae=()=>n(873066),re=()=>n(821879),le=()=>n(609989),de=()=>n(46413),ce=(n(354520),n(581454),()=>n(764880)),ue=()=>n(313491),pe=()=>n(253673),ge=()=>n(448693),me=()=>n(848401),fe=()=>n(457688),he=()=>n(258836),ve=()=>n(870092),ye=()=>n(30731),be=n(474848);function Se(e){const{parentStore:t,auditLogHistoricalUserStore:n,selectedActors:o,onChange:a}=e,l=(0,A().tz)(),d=(0,r().v3)(),[c,u]=(0,i.useState)(new Set(o.map(ye().Ht))),p=(0,be.jsx)(A().sA,{id:"auditlogActorFilter.title",defaultMessage:"User"}),g=(0,i.useCallback)((()=>{const e=Array.from(c).map(ye().Hl).filter((e=>void 0!==e));a(e)}),[c,a]),m=(0,i.useCallback)((()=>{const e=o.map(ye().Ht);u(new Set(e))}),[o]),f=(0,i.useCallback)((e=>{"applyButton"!==e?m():g()}),[g,m]);return(0,be.jsx)(re().A,{mode:re().C.Pill,title:p,icon:pe().personIcon,items:Array.from(c),hasItemsSelected:(null==o?void 0:o.length)>0,onChange:e=>{u(new Set(e))},renderFooter:!0,allowApplyBatchSelection:!0,keepInputOnItemConfirm:!0,onMenuDismiss:f,labelText:{title:p,tokenInputPlaceholder:l.formatMessage({defaultMessage:"Search user...",id:"auditlogActorFilter.searchActor.placeholder"}),resultSectionTitle:l.formatMessage({defaultMessage:"Select users",id:"auditlogActorFilter.searchActor.resultsTitle"}),componentDebugName:"SearchActorFilter"},performRequest:e=>async function({args:e,auditLogHistoricalUserStore:t,selectedActors:n,environment:i}){const{query:o}=e,{allUserIds:a,allBotIds:r,spaceId:l}=t.getState(),d=100,c=await H().T.searchActions.load();let u;if(O().A.state.shouldUseEdgeCache&&s().default.checkGate({gateName:"edge_cache_audit_log"})&&l){const e=s().default.getConfigKey("email_alias_migration","mode"),t=await q().callApi({eventName:"listUsers",environment:i,data:{cursor:void 0,membershipFilter:void 0,limit:d,sort:"name_normalized",sortDirection:"asc",query:o,spaceId:l,includeAliasSearch:(0,ue().K)(e)}});let n=[];"success"===t.type&&(n=t.data.users.map((e=>e.id))),u=await c.searchActorsById({environment:i,query:o,userIds:[...n,...a],botIds:[...r]})}else u=await c.searchActorsById({environment:i,query:o,userIds:[...a],botIds:[...r]});const p=[...u.users.map((e=>`notion_user:${e.id}`)),...u.bots.map((e=>`bot:${e.id}`))];if(o.length>0)return p.slice(0,d);const g=n.map(ye().Ht),m=new Set(g),f=p.filter((e=>!m.has(e)));return[...g,...f].slice(0,Math.max(g.length,d))}({args:e,auditLogHistoricalUserStore:n,selectedActors:o,environment:d}),renderResultMenuItem:(e,i)=>{var o;const s=Me(e,t);return(0,be.jsx)(xe,{...i,item:e,tempActorSelections:c,showRemovedBadge:n.isUserOrBotRemoved(null===(o=s.asActor)||void 0===o?void 0:o.id),actor:s,intl:l})},renderToken:(e,n)=>(0,be.jsx)(Ae,{item:e,handlers:n,tempActorSelections:c,parentStore:t}),renderFilter:()=>null,renderItemForSummary:()=>null,addItemLabel:null,focused:!1})}const xe=(0,i.forwardRef)(((e,t)=>{const{item:i,tempActorSelections:o,showRemovedBadge:s,actor:a}=e;return(0,be.jsx)(fe().A,{...e,ref:t,actor:a,useEmailAsTooltip:!0,isChecked:o.has(i),badge:s?(0,be.jsx)(n(970236).E,{content:(0,be.jsx)(A().sA,{id:"auditlogActorFilter.removed_user",defaultMessage:"Removed"})}):null})}));function Ae({item:e,handlers:t,tempActorSelections:n,parentStore:i}){const o=1===n.size,s=(0,d().K8)((()=>Me(e,i)),[i,e]);return s?(0,be.jsx)(ge().Ay,{format:me().mI.Small,showRemoveButton:!0,isSingle:o,onClickRemove:t.onRemove,actor:s,shouldShrink:!0,hasPersonHoverCard:!1},e):null}function Me(e,t){const n=(0,ye().Hl)(e);return n?"notion_user"===n.actorType?(0,ce().MR)(function(e,t){return ve().L.createChildStore(t,{table:V().oo,id:e}).getModel()}(n.actorId,t)):(0,ce().oC)(function(e,t){return he().v.createChildStore(t,{table:K().GP,id:e}).getModel()}(n.actorId,t)):(0,ce().MR)(void 0)}xe.displayName="ResultMenuItem";var we=()=>n(312607);const je=(0,A().YK)({auditLogNotSupportedDateRangeError:{id:"auditLog.dateTimeRangeMenu.notSupportedDateRange",defaultMessage:"Audit Log retains events from the past year."}});function ke(e){const{spaceStore:t}=e,n=(0,A().tz)(),[i,o]=(0,d().$y)(Y().A),[s,a,r]=(0,d().$y)(Z),l=(0,d().uB)(void 0,de().D),c=(0,d().uB)(void 0,de().D),u=(0,N().ah)((0,oe().P)());return(0,be.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:4},children:[(0,be.jsx)(ae().A,{mode:re().C.Pill,focused:!1,title:(0,be.jsx)(A().sA,{id:"auditlogDateFilter.title",defaultMessage:"Date"}),icon:se().D,value:i.timeRange,showButtons:"footer",onChange:e=>{o({...i,timeRange:e,pageNum:1})},minDate:u.minus({years:1}),maxDate:u.endOf("day"),customErrorMessage:e=>{if(e===le().$.NOT_SUPPORTED)return n.formatMessage(je.auditLogNotSupportedDateRangeError)}}),(0,be.jsx)(Se,{parentStore:t,auditLogHistoricalUserStore:r,selectedActors:i.actors,onChange:e=>{o({...i,actors:e,pageNum:1})}}),(0,be.jsx)(we().A,{lastSelectionStore:l,componentStore:c,onChange:e=>{o({...i,actions:e,pageNum:1})}})]})}var Ie=()=>n(8178);function Ce(){return(0,be.jsx)(Ie().A,{large:!0,style:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:w().Wy.medium,display:"flex",justifyContent:"space-between"},children:(0,be.jsx)("div",{style:{gap:8,display:"flex"},children:(0,be.jsx)(A().sA,{id:"auditlog.title",defaultMessage:"Audit log"})})})}var Te=()=>n(366951),_e=()=>n(726637),Pe=()=>n(326346),Be=()=>n(884107),De=()=>n(641300),Re=()=>n(859428),Ee=()=>n(125565),Le=()=>n(47373),Oe=()=>n(623742);function Ne(e){const{auditLogEntry:t,spaceStore:n,id:s}=e,a=(0,A().tz)(),r=(0,o().X)("automations_attribution_ui"),l=(0,d().K8)((()=>(0,ye().OR)(t,n,a,r)),[n,t,a,r]),u=(0,d().K8)((()=>{var e,t;if(l)return(null===(e=l.actorStore)||void 0===e?void 0:e.getDisplayName(a))??(null===(t=l.avatar)||void 0===t?void 0:t.name)}),[l,a]),p=(0,d().K8)((()=>{var e,t;if(l)return(null===(e=l.actorStore)||void 0===e?void 0:e.getDetail())??(null===(t=l.avatar)||void 0===t?void 0:t.email)}),[l]),g=(0,i.useMemo)((()=>{if(t.actor.actorType===V().oo){var e;const n=null===(e=t.actor.meta)||void 0===e?void 0:e.spaceRole;if(n)return(0,z().jH)(n)}}),[t]),m=(0,c().IS)((()=>({container:{display:"block",width:"100%",paddingBlock:6}})),[]),f=(0,i.createRef)();return(0,be.jsx)(Re().A,{disableTooltip:Fe(f.current),renderTooltip:()=>(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)("div",{children:u}),(0,be.jsx)("div",{children:p})]}),placement:"bottom",render:e=>(0,be.jsx)("div",{...e,style:m.container,children:(0,be.jsx)(Oe().A,{id:s,...l,spaceRole:g})})})}function Fe(e){return!!e&&(e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)}var Ue=()=>n(617842);const ze={id:"actor",headerTitle:(0,be.jsx)(A().sA,{id:"auditlog.logTable.userColumn.header",defaultMessage:"User"}),renderCell:e=>{const t=`actor-${e.auditLogEntry.actionName}-${e.id}`;return(0,be.jsx)(Ne,{spaceStore:e.spaceStore,auditLogEntry:e.auditLogEntry,id:t})},widthData:{width:30},sortable:!1},Ke={id:"event",headerTitle:(0,be.jsx)(A().sA,{id:"auditlog.logTable.eventColumn.header",defaultMessage:"Event"}),renderCell:e=>{const t=`event-${e.auditLogEntry.actionName}-${e.id}`;return(0,be.jsx)(n(17297).m,{auditLogEntry:e.auditLogEntry,id:t})},widthData:{width:40},sortable:!1},Ve={id:"dateTimeAndMenu",headerTitle:(0,be.jsx)(A().sA,{id:"auditlog.logTable.dateColumn.header",defaultMessage:"Date"}),renderCell:e=>{const t=`actor-${e.auditLogEntry.actionName}-${e.id}`,i=`event-${e.auditLogEntry.actionName}-${e.id}`,o=`datetime-${e.auditLogEntry.actionName}-${e.id}`;return(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(n(829351).V,{auditLogEntry:e.auditLogEntry,id:o}),(0,be.jsx)(He,{auditLogEntry:e.auditLogEntry,ids:{actorColumnId:t,eventColumnId:i,dateTimeColumnId:o}})]})},widthData:{width:25},sortable:!0},qe=[ze,Ke,Ve];function We(e){const{searchResponse:t,spaceStore:n}=e,[o,s]=(0,d().$y)(Y().A),a=t.results||[],r=t.hasMoreResults,l=Boolean(a.length),u=e=>{const t={...o,pageNum:e};s(t)},p=(0,c().IS)((e=>(0,De().rC)({columnRenderInfo:qe,theme:e,containerMarginTop:0})),[]),g=a.map(((e,t)=>({id:t.toString(),auditLogEntry:e,spaceStore:n,isClickable:!1}))),m=(0,i.useCallback)((()=>{const e=o.sortOrder===z().K7.CreatedOldest?z().K7.CreatedNewest:z().K7.CreatedOldest;s({...o,sortOrder:e,pageNum:1})}),[o,s]),f=(0,i.useMemo)((()=>({column:Ve,sortAscending:o.sortOrder===z().K7.CreatedOldest})),[o]);return(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(De().WE,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:qe,rows:g,sortState:f,onSortStateChanged:m,renderNoRowsComponent:Ge,styles:p}),l?(0,be.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:10},children:[(0,be.jsx)(Ue().M,{onClick:()=>{u(o.pageNum-1)},disabled:1===o.pageNum,children:(0,be.jsx)(A().sA,{id:"auditlog.logTable.previousPage",defaultMessage:"Previous"})}),(0,be.jsx)(Ue().M,{disabled:!r,onClick:()=>{u(o.pageNum+1)},children:(0,be.jsx)(A().sA,{id:"auditlog.logTable.nextPage",defaultMessage:"Next"})})]}):null]})}function Ge(){return(0,be.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"40vh",flexDirection:"column"},children:[(0,be.jsx)("div",{children:(0,be.jsx)(Ee().A,{isSecondaryColor:!0,style:{fontWeight:500},children:(0,be.jsx)(A().sA,{id:"auditlog.logTable.noResults",defaultMessage:"No results"})})}),(0,be.jsx)(Ee().A,{isSecondaryColor:!0,children:(0,be.jsx)(A().sA,{id:"auditlog.logTable.noResultsHelpText",defaultMessage:"Try different filters. Logs may take some time to show up."})})]})}function He(e){const{auditLogEntry:t,ids:i}=e,o=(0,d().K8)((()=>(0,Le().Qd)()),[]),s=Pe().Gb,a=(0,A().tz)(),l=(0,r().v3)(),u=(0,c().DP)(),g=(0,c().IS)((e=>({container:{display:"flex",alignItems:"center",justifyContent:"flex-end",width:"100%"},button:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:6}})),[]);return(0,be.jsx)(Re().A,{delayThreshold:80,placement:"bottom",render:e=>(0,be.jsx)("div",{style:g.container,...e,children:(0,be.jsx)(p().Ay,{style:g.button,onClick:async e=>{const n=await Be().R.clipboardActions.load();let r=(0,Pe().ZM)({auditLogEntry:t,intl:a,getAuditLogEventText:(d=i.eventColumnId,e=>{var t;return null===(t=document.getElementById(d))||void 0===t?void 0:t.textContent}),isTeamGuestsEnabled:o,csvColumnNames:s});var d;n.copyString({environment:l,stringValue:r,copiedMessage:n.clipboardMessages.copiedToClipboard})},children:(0,n(536583).d)({width:16,height:16,fill:u.icon.secondary})})}),renderTooltip:()=>(0,be.jsx)(A().sA,{id:"AuditLogSettings.copyAuditLogEvent",defaultMessage:"Copy row"})})}function Ye(e){const{spaceStore:t}=e,n=(0,r().v3)(),o=null==t?void 0:t.id,[a]=(0,d().$y)(X),[l]=(0,d().$y)(Y().A),c=(0,Y()._)(l)!==a.filterStr?void 0:a.cachedResponses[l.pageNum];(0,i.useEffect)((()=>{o&&async function(e){var t,n;const{environment:i,spaceId:o}=e,s=Y().A.getState();X.startLoading(o,s);const{sortOrder:a,pageSize:r,pageNum:l}=s,d={spaceId:o,limit:r,cursor:X.getCursor(o,s,l),filters:{timeRange:{starting:s.timeRange.starting?N().C6.toUnixMs(s.timeRange.starting):void 0,ending:s.timeRange.ending?N().C6.toUnixMs(s.timeRange.ending):void 0},...(null===(t=s.actors)||void 0===t?void 0:t.length)>0?{actors:s.actors}:void 0,...(null===(n=s.actions)||void 0===n?void 0:n.length)>0?{actions:s.actions}:void 0},sort:a||z().K7.CreatedNewest},c=await q().callApi({eventName:"searchAuditLog",environment:i,data:d,headers:(0,U().WS)({spaceId:d.spaceId})});if("success"!==c.type)if(X.updateError(o,s),(0,F().op)(c.body)){const e=(0,W().H)(G().A.getIntl(),c);T().f1(e)}else T().f1(G().A.formatMessage(ee.loadCurrentAuditLogError));else X.updateLoadedResult(o,s,c.data)}({environment:n,spaceId:o})}),[n,o,l]);const u=(0,d().K8)((()=>O().A.state.shouldUseEdgeCache&&s().default.checkGate({gateName:"edge_cache_audit_log"})),[]);return(0,i.useEffect)((()=>{ne({environment:n,spaceId:o,shouldUseEdgeCache:u})}),[n,o,u]),(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(Ce,{}),(0,be.jsxs)("div",{style:{justifyContent:"space-between",display:"flex",paddingTop:12,paddingBottom:12},children:[(0,be.jsx)(ke,{spaceStore:t}),(0,be.jsx)(ie().A,{parentStore:t})]}),"loading"===(null==c?void 0:c.status)?(0,be.jsx)(Te().A,{}):void 0,"success"===(null==c?void 0:c.status)?(0,be.jsx)(We,{searchResponse:c,spaceStore:t}):void 0]})}var $e=()=>n(645873);const Qe=new($e().O2)("collectionDebugSettings",(()=>n.e(26403).then(n.bind(n,917682)))),Ze=(0,$e()._h)(Qe,(e=>e.CollectionDebugSettings)),Je={settingsTab:new($e().O2)("customEmojiSettings",(()=>n.e(10408).then(n.bind(n,656301))))},Xe=(0,$e()._h)(Je.settingsTab,(e=>e.CustomEmojiSettings)),et=new($e().O2)("SitesSettingsTab",(async()=>await Promise.all([n.e(25700),n.e(78171)]).then(n.bind(n,238544)))),tt=(0,$e()._h)(et,(e=>e.SitesSettingsTab)),nt=new($e().O2)("designPreviews",(()=>n.e(23754).then(n.bind(n,159003)))),it=(0,$e()._h)(nt,(e=>e.DesignPreviews));var ot=()=>n(38337),st=()=>n(87878),at=()=>n(310795),rt=()=>n(232930),lt=()=>n(141966),dt=()=>n(470928),ct=()=>n(176983),ut=()=>n(691298),pt=()=>n(646736),gt=()=>n(827289),mt=()=>n(135055),ft=()=>n(448835),ht=()=>n(346),vt=()=>n(274041),yt=()=>n(699143),bt=()=>n(534177),St=()=>n(843878),xt=()=>n(987017),At=()=>n(404141),Mt=()=>n(406094),wt=()=>n(160432);const jt={viewBox:"0 0 20 20",fittedViewBox:"3.12 3.12 16.38 16.38",svg:(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)("path",{d:"M3.125 5.25c0-1.174.951-2.125 2.125-2.125h9.5c1.174 0 2.125.951 2.125 2.125v.7H3.125zm0 1.8h13.75v4.433a4.6 4.6 0 0 0-5.392 5.392H5.25a2.125 2.125 0 0 1-2.125-2.125zm5.717 2.487a.694.694 0 1 0 0-1.389.694.694 0 0 0 0 1.389m.695 1.62a.694.694 0 1 0-1.39 0 .694.694 0 0 0 1.39 0m-.695 3.01a.695.695 0 1 0 0-1.39.695.695 0 0 0 0 1.39m3.01-5.324a.694.694 0 1 0-1.39 0 .694.694 0 0 0 1.39 0m-.695 3.009a.694.694 0 1 0 0-1.389.694.694 0 0 0 0 1.389m.695 1.62a.694.694 0 1 0-1.39 0 .694.694 0 0 0 1.39 0m1.62-3.935a.694.694 0 1 0 0-1.389.694.694 0 0 0 0 1.389m-6.25 1.62a.694.694 0 1 0-1.389 0 .694.694 0 0 0 1.39 0m-.694 3.01a.695.695 0 1 0 0-1.39.695.695 0 0 0 0 1.39m7.639-3.01a.694.694 0 1 0-1.39 0 .694.694 0 0 0 1.39 0"}),(0,be.jsx)("path",{d:"M16 19.5a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7m-.656-4.094H14a.625.625 0 0 0 0 1.25h1.969c.345 0 .625-.28.625-.625v-2a.625.625 0 0 0-1.25 0z"})]})},kt=(0,v().wt)("calendarBadgeClockFill",jt);var It=()=>n(781016),Ct=()=>n(449552);const Tt={viewBox:"0 0 20 20",fittedViewBox:"2.37 4.12 15.25 11.75",svg:(0,be.jsx)("path",{d:"M2.375 6.25c0-1.174.951-2.125 2.125-2.125h11c1.174 0 2.125.951 2.125 2.125v1.5H2.375zM15 6.55a.55.55 0 1 0 0-1.1h-1.437a.55.55 0 0 0 0 1.1zM2.375 8.75h15.25v2.5H2.375zM15.55 10a.55.55 0 0 0-.55-.55h-1.437a.55.55 0 0 0 0 1.1H15a.55.55 0 0 0 .55-.55M2.375 12.25v1.5c0 1.174.951 2.125 2.125 2.125h11a2.125 2.125 0 0 0 2.125-2.125v-1.5zM15 14.55h-1.437a.55.55 0 0 1 0-1.1H15a.55.55 0 1 1 0 1.1"})},_t=(0,v().wt)("serverRackFill",Tt);var Pt=()=>n(942292),Bt=()=>n(287882),Dt=()=>n(985529),Rt=()=>n(690197);function Et({title:e,byline:t,settingItem:n,style:i}){const o=(0,c().IS)((e=>({settingContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",...i||{}},settingLeft:{width:"60%"},settingTitle:{fontWeight:w().Wy.regular},settingByline:{marginBottom:4}})),[i]);return(0,be.jsxs)("div",{style:o.settingContainer,children:[(0,be.jsxs)("div",{style:o.settingLeft,children:[(0,be.jsx)(Ie().A,{smallMarginBottom:!0,style:o.settingTitle,children:e}),(0,be.jsx)(Ee().A,{isSmall:!0,isMultiline:!0,style:o.settingByline,children:t})]}),n]})}var Lt=()=>n(702723),Ot=()=>n(991249),Nt=()=>n(148307),Ft=()=>n(559273);function Ut(e){const{product:t}=e,n=function(e){switch(e){case"free":case"student":case"personal":case"sites_custom_hostnames":return Nt().A.images.pricing.original.freePng;case"plus":return Nt().A.images.pricing.original.plusPng;case"business":return Nt().A.images.pricing.original.businessPng;case"enterprise":return Nt().A.images.pricing.original.enterprisePng;case"ai":case"ai_credits_pack":return Nt().A.images.pricing.aiLogoPng;default:return}}(t);return n?(0,be.jsx)(Ft().A,{src:n,style:{width:49,height:52,objectFit:"contain"}}):null}var zt=()=>n(329304),Kt=()=>n(303470),Vt=()=>n(265665),qt=()=>n(631524),Wt=()=>n(624090),Gt=()=>n(236262),Ht=()=>n(623580),Yt=()=>n(107683),$t=()=>n(484595),Qt=()=>n(106261);const Zt=(0,A().YK)({deleteFromTrashLayoutTitle:{defaultMessage:"Auto-delete from Trash",id:"updateRetentionWindowModal.layoutTitle.deleteFromTrash."},deleteFromTrashTitle:{defaultMessage:"Auto-delete from Trash",id:"updateRetentionWindowModal.title.deleteFromTrash"},deleteFromTrashDescription:{defaultMessage:"Customize how long pages stay in Trash before being automatically deleted",id:"updateRetentionWindowModal.description.deleteFromTrash"},deleteFromTrashDefaultOptionTitle:{defaultMessage:"30 days, then delete from Trash",id:"updateRetentionWindowModal.defaultOption.title.deleteFromTrash"},deleteFromTrashDefaultOptionDescription:{defaultMessage:"Pages deleted from Trash are retained for an additional period of time. Retained pages can be restored by workspace owners",id:"updateRetentionWindowModal.defaultOption.description.deleteFromTrash"},deleteFromTrashImmediateEffect:{defaultMessage:"Reducing this retention setting may lead to pages being deleted from Trash immediately. Please type your workspace name to continue",id:"updateRetentionWindowModal.immediateEffect.deleteFromTrash"},purgeLayoutTitle:{defaultMessage:"Retaining deleted pages",id:"updateRetentionWindowModal.layoutTitle.purge"},purgeTitle:{defaultMessage:"Retaining deleted pages",id:"updateRetentionWindowModal.title.purge"},purgeDescription:{defaultMessage:"Pages deleted from Trash are retained for a period of time. Only workspace owners can view and restore retained pages.",id:"updateRetentionWindowModal.description.purge"},purgeDefaultOptionTitle:{defaultMessage:"30 days, then permanently delete",id:"updateRetentionWindowModal.defaultOption.title.purge"},purgeDefaultOptionDescription:{defaultMessage:"Pages are removed from Notionâ€™s servers and cannot be restored",id:"updateRetentionWindowModal.defaultOption.description.purge"},purgeImmediateEffect:{defaultMessage:"Reducing the retain period could lead to pages being deleted from Notion server. Please type your workspace name to continue ",id:"updateRetentionWindowModal.immediateEffect.purge"}});const Jt=(0,A().YK)({days:{defaultMessage:"days",id:"customRetentionWindow.relativeDates.days"},years:{defaultMessage:"years",id:"customRetentionWindow.relativeDates.years"}}),Xt=(0,A().YK)({inputPlaceholder:{defaultMessage:"...",id:"customRetentionWindow.timeNum.inputPlaceholder"}}),en=(0,bt().uv)(Bt().Vl).map((e=>({key:e,label:(0,be.jsx)(Ee().A,{children:G().A.formatMessage(Jt[e])})})));function tn(e){const{isDropdownEnabled:t,timeNumString:n,timeUnit:i,setTimeNumString:o,setTimeUnit:s}=e,a=(0,A().tz)(),r=(0,c().IS)((e=>({dropdownRow:{display:"flex"},input:{width:70,marginInlineEnd:4,marginInlineStart:6},dropdown:{marginTop:0,marginBottom:0,marginInlineEnd:4,borderRadius:4,border:`1px solid ${e.lightDividerColor}`}})),[]);return(0,be.jsxs)("span",{style:r.dropdownRow,children:[(0,be.jsx)(Ht().A,{style:r.input,value:n,onChange:e=>o(e.target.value),placeholder:a.formatMessage(Xt.inputPlaceholder),disabled:!t}),(0,be.jsx)(Lt().m,{buttonStyle:r.dropdown,disabled:!t,type:"dropdown",currentOption:i,options:en,onSelectOption:e=>t&&s(e),isMobile:!1})]})}const nn=(0,A().YK)({invalidNumber:{defaultMessage:"Please enter a valid number",id:"updateRetentionWindow.error.invalidNumber"},outOfRangeTrash:{defaultMessage:"Pages canâ€™t be in Trash for longer than 10 years",id:"updateRetentionWindow.error.outOfRangeTrash"},outOfRangeRetained:{defaultMessage:"Pages canâ€™t be retained for longer than 10 years",id:"updateRetentionWindow.error.outOfRangeRetained"},lowerBoundTrash:{defaultMessage:"Pages canâ€™t be in Trash for less than 1 day",id:"updateRetentionWindow.error.lowerBoundTrash"},lowerBoundRetained:{defaultMessage:"Pages canâ€™t be retained for less than 1 day",id:"updateRetentionWindow.error.lowerBoundRetained"}});function on({isSelected:e,retentionType:t,hasChosenRetentionWindow:n,currentRetentionWindowInSeconds:o,errorMessage:s,onNextRetentionWindowInSecondsChange:a,onClick:r,setErrorMessage:l,style:d}){const u=(0,A().tz)(),p=(0,c().IS)((t=>({rowStyles:{display:"flex",fontSize:14,background:e?t.lightBlueBannerBackground:"inherit",...d,alignItems:"flex-start",flexFlow:"column"},centeredRow:{display:"flex",flexFlow:"row",alignItems:"center"},errorMessageStyle:{marginTop:8,width:"100%",display:"flex",paddingInlineStart:28,color:t.errorText,fontWeight:w().Wy.regular}})),[d,e]),[g,m]=(0,i.useState)((0,Bt().sV)(o)),[f,h]=(0,i.useState)(`${(0,Bt().Uw)(o,g)}`),v=Number(f)*Bt().Vl[g],y=!n&&e;return(0,i.useEffect)((()=>{a(v)}),[a,v]),(0,i.useEffect)((()=>{if(e){if(void 0===f)return void l(u.formatMessage(nn.invalidNumber));const e=parseInt(f);if(isNaN(e)||e.toString()!==f)return void l(u.formatMessage(nn.invalidNumber));const n=Bt().Vl[g]*e;if(n>Bt().J1){const e="delete_from_trash"===t?nn.outOfRangeTrash:nn.outOfRangeRetained;return void l(u.formatMessage(e))}if(n<Bt().PL){const e="delete_from_trash"===t?nn.lowerBoundTrash:nn.lowerBoundRetained;return void l(u.formatMessage(e))}l(void 0)}}),[f,g,e,l,u,t]),(0,be.jsxs)(qt().p,{style:p.rowStyles,onClick:r,children:[(0,be.jsxs)("div",{style:p.centeredRow,children:[(0,be.jsx)($t().A,{isSelected:e}),(0,be.jsx)(Ee().A,{style:p.centeredRow,children:"delete_from_trash"===t?(0,be.jsx)(A().sA,{defaultMessage:"<dropdownpicker></dropdownpicker>, then delete from trash",id:"updateRetentionWindowModal.custom.deleteFromTrash",values:{dropdownpicker:e=>(0,be.jsx)(tn,{isDropdownEnabled:y,timeNumString:f,timeUnit:g,setTimeNumString:h,setTimeUnit:m})}}):(0,be.jsx)(A().sA,{defaultMessage:"<dropdownpicker></dropdownpicker>, then permanently delete",id:"updateRetentionWindowModal.custom.permanentlyDelete",values:{dropdownpicker:e=>(0,be.jsx)(tn,{isDropdownEnabled:y,timeNumString:f,timeUnit:g,setTimeNumString:h,setTimeUnit:m})}})})]}),s?(0,be.jsx)(Ee().A,{style:p.errorMessageStyle,children:s}):null]})}const sn=(0,A().YK)({invalidWorkspaceName:{id:"updateRetentionWindow.error.invalidWorkspaceName",defaultMessage:"Must type in workspace name correctly"}});function an({isOpen:e,closeModal:t,currentRetentionWindowInSeconds:n,spaceStore:o,retentionType:s,onSaveRetentionWindow:a}){const l=(0,r().v3)(),u=(0,c().IS)((e=>({contentStyle:{display:"flex",flexFlow:"column",alignItems:"center",paddingTop:24,paddingInlineStart:15,paddingInlineEnd:15},headerStyle:{display:"flex",flexFlow:"column",alignItems:"center",marginBottom:16},headerTitleStyle:{fontWeight:w().Wy.semibold,fontSize:17,marginBottom:8},headerDescriptionStyle:{width:"100%",textAlign:"center",fontSize:14},defaultOptionStyle:{display:"flex",flexFlow:"column",paddingInlineStart:8},defaultOptionTitleStyle:{fontSize:13,fontWeight:w().Wy.medium},defaultOptionDescriptionStyle:{width:350,fontSize:12,whiteSpace:"normal",lineHeight:"16px",fontWeight:w().Wy.regular},iconStyle:{color:e.icon.tertiary,width:36,marginBottom:12},saveButtonStyles:{width:"100%",marginBottom:4,marginTop:16},errorMessageStyle:{marginTop:4,color:e.errorText},cancelButtonStyles:{width:"100%",paddingTop:5,paddingBottom:5,display:"flex",justifyContent:"center",marginBottom:16,borderRadius:4},optionStyle:{width:"100%",height:void 0,marginBottom:4,paddingTop:8,paddingBottom:8,fontWeight:w().Wy.medium,display:"flex",flexFlow:"row"},confirmationContainerStyle:{marginTop:16,width:"100%",paddingTop:14,paddingBottom:14,padingLeft:14,paddingInlineEnd:14,backgroundColor:e.palette.red[100],display:"flex",flexFlow:"column",alignItems:"center",borderRadius:4},confirmationDescription:{color:e.palette.red[800],fontSize:14,paddingBottom:6},confirmationContentStyle:{width:"90%"}})),[]),g=(0,d().K8)((()=>o.getName()),[o]),[m,f]=(0,i.useState)(void 0),[h,v]=(0,i.useState)(void 0===n),[y,b]=(0,i.useState)(n),S=h?void 0:y,[x,M]=(0,i.useState)(!1),[j,k]=(0,i.useState)(""),I=S===n||(0,bt().O9)(m),T=j!==g,_=(0,i.useCallback)((()=>{m||(C().kF(l,{type:s,value:S}),a(S),k(""),M(!1),t())}),[l,s,a,S,m,t]),P=(0,i.useCallback)((()=>{x?j===g?_():f(G().A.formatMessage(sn.invalidWorkspaceName)):!function({nextRetentionWindowValue:e,currentRetentionWindowValue:t,retentionType:n}){const i=rn(t,n),o=rn(e,n);if(o<i)return!0;return!1}({nextRetentionWindowValue:S,retentionType:s,currentRetentionWindowValue:n})?_():M(!0)}),[x,j,g,S,s,n,_]),B=(0,i.useCallback)((()=>{x||h||(M(!1),v(!0),f(void 0))}),[x,h,M,v,f]),D=(0,i.useCallback)((()=>{x||h&&(M(!1),v(!1))}),[x,h,M,v]),R=function(e){return(0,i.useMemo)((()=>"delete_from_trash"===e?{layoutTitle:Zt.deleteFromTrashLayoutTitle,title:Zt.deleteFromTrashTitle,description:Zt.deleteFromTrashDescription,defaultOptionTitle:Zt.deleteFromTrashDefaultOptionTitle,defaultOptionDescription:Zt.deleteFromTrashDefaultOptionDescription,immediateEffect:Zt.deleteFromTrashImmediateEffect}:"purge"===e?{layoutTitle:Zt.purgeLayoutTitle,title:Zt.purgeTitle,description:Zt.purgeDescription,defaultOptionTitle:Zt.purgeDefaultOptionTitle,defaultOptionDescription:Zt.purgeDefaultOptionDescription,immediateEffect:Zt.purgeImmediateEffect}:void(0,bt().HB)(e)),[e])}(s);return(0,be.jsx)(Yt().s,{isOpen:e,onDismiss:t,areaConstraint:{width:{type:"max",length:460}},render:({displayMode:e})=>(0,be.jsx)(Qt().B,{displayMode:e,title:(0,be.jsx)(A().sA,{...R.layoutTitle}),children:(0,be.jsxs)("div",{style:u.contentStyle,children:[(0,be.jsxs)("div",{style:u.headerStyle,children:[(0,be.jsx)("div",{children:(0,Gt().trashIcon)(u.iconStyle)}),(0,be.jsx)(Ee().A,{style:u.headerTitleStyle,children:(0,be.jsx)(A().sA,{...R.title})}),(0,be.jsx)(Ee().A,{style:u.headerDescriptionStyle,isSecondaryColor:!0,isMultiline:!0,children:(0,be.jsx)(A().sA,{...R.description})})]}),(0,be.jsxs)(qt().p,{style:u.optionStyle,onClick:B,children:[(0,be.jsx)($t().A,{isSelected:h}),(0,be.jsxs)("div",{style:u.defaultOptionStyle,children:[(0,be.jsx)(Ee().A,{style:u.defaultOptionTitleStyle,children:(0,be.jsx)(A().sA,{...R.defaultOptionTitle})}),(0,be.jsx)(Ee().A,{isSecondaryColor:!0,isMultiline:!0,style:u.defaultOptionDescriptionStyle,children:(0,be.jsx)(A().sA,{...R.defaultOptionDescription})})]})]}),(0,be.jsx)(on,{style:u.optionStyle,isSelected:!h,retentionType:s,hasChosenRetentionWindow:x,currentRetentionWindowInSeconds:n,errorMessage:m,onClick:D,onNextRetentionWindowInSecondsChange:b,setErrorMessage:f}),x?(0,be.jsxs)("div",{style:u.confirmationContainerStyle,children:[(0,be.jsx)(Ee().A,{isMultiline:!0,style:{...u.confirmationContentStyle,...u.confirmationDescription},children:(0,be.jsx)(A().sA,{...R.immediateEffect})}),(0,be.jsx)(Ht().A,{style:u.confirmationContentStyle,value:j,placeholder:g,onChange:e=>k(e.target.value)})]}):null,(0,be.jsx)(wt().A,{colorPalette:"blue",onClick:P,disabled:x?T:I,style:u.saveButtonStyles,size:"lg",children:(0,be.jsx)(A().sA,{id:"updateRetentionWindowModal.save",defaultMessage:"Save"})}),(0,be.jsx)(p().Ay,{onClick:t,style:u.cancelButtonStyles,children:(0,be.jsx)(Ee().A,{isSecondaryColor:!0,children:(0,be.jsx)(A().sA,{id:"updateRetentionWindowModal.cancel",defaultMessage:"Cancel"})})})]})})})}function rn(e,t){return e||("delete_from_trash"===t?Wt().I4:Wt().qI)}function ln(e){const{spaceStore:t}=e,n=(0,r().v3)(),s=(0,A().tz)(),a=(0,c().IS)((e=>({genericSetting:{width:"100%",paddingTop:24},settingItem:{display:"flex",alignItems:"center"},currentSettingLabel:{fontWeight:w().Wy.medium},changeButtonStyle:{fontSize:12,marginInlineStart:8},lockIconStyle:{color:e.text.tertiary,width:20,marginInlineStart:4}})),[]),l=(0,zt()._X)({name:"configurable_retention",spaceId:t.id,userId:n.currentUser.id}),[u,p]=i.useState({isOpen:!1,retentionType:"delete_from_trash"}),{saveDeleteFromTrashDelay:g,savePurgeDelay:m}=function({environment:e,spaceStore:t}){return{saveDeleteFromTrashDelay:(0,i.useCallback)((n=>{E().createAndCommit({userAction:"securitySettingsActions.saveDataRetentionSettings",environment:e,canUndo:!0,perform:e=>{E().applyOperation({store:t,operation:{pointer:t.pointer,path:["settings"],command:"update",args:{delete_from_trash_delay_seconds:n??null}},transaction:e})}})}),[t,e]),savePurgeDelay:(0,i.useCallback)((n=>{E().createAndCommit({userAction:"securitySettingsActions.saveDataRetentionSettings",environment:e,canUndo:!0,perform:e=>{E().applyOperation({store:t,operation:{pointer:t.pointer,path:["settings"],command:"update",args:{purge_delay_seconds:n??null}},transaction:e})}})}),[t,e])}}({environment:n,spaceStore:t}),{currentDeleteFromTrashDelayInSeconds:f,currentPurgeDelayInSeconds:h}=(0,d().K8)((()=>({currentDeleteFromTrashDelayInSeconds:(0,Dt().e2)(l)?t.getSettings().delete_from_trash_delay_seconds:void 0,currentPurgeDelayInSeconds:(0,Dt().e2)(l)?t.getSettings().purge_delay_seconds:void 0})),[t,l]);return(0,o().X)("upgrade_system_settings")?(0,be.jsx)(gn,{updateModalState:u,setUpdateModalState:p,spaceStore:t,saveDeleteFromTrashDelay:g,savePurgeDelay:m,dataRetentionAvailability:l,currentDeleteFromTrashDelayInSeconds:f,currentPurgeDelayInSeconds:h}):(0,be.jsxs)("div",{children:[u.isOpen?(0,be.jsx)(an,{isOpen:u.isOpen,closeModal:()=>p({...u,isOpen:!1}),spaceStore:t,currentRetentionWindowInSeconds:u.currentRetentionWindowInSeconds,retentionType:u.retentionType,onSaveRetentionWindow:"delete_from_trash"===u.retentionType?g:m}):void 0,(0,be.jsx)(dn,{dataRetentionAvailability:l}),(0,be.jsx)(Et,{style:a.genericSetting,title:(0,be.jsx)(A().sA,{id:"securitySettings.dataRetention.deleteFromTrash.title",defaultMessage:"Once pages are moved to Trash, delete them after"}),byline:(0,be.jsx)(A().sA,{id:"securitySettings.dataRetention.deletedFromTrash.byline",defaultMessage:"Anyone with edit or full access will be able to restore or manually delete pages in Trash"}),settingItem:(0,be.jsxs)("div",{style:a.settingItem,children:[(0,be.jsx)(Ee().A,{style:a.currentSettingLabel,children:(0,be.jsx)(A().sA,{id:"securitySettings.dataRetention.deleteFromTrash.currentSetting",defaultMessage:"{duration}",values:{duration:(0,Bt().rN)(f,s)}})}),(0,Dt().e2)(l)?(0,be.jsx)(Mt().A,{size:"lg",disabled:!1,style:a.changeButtonStyle,onClick:()=>p({isOpen:!0,retentionType:"delete_from_trash",currentRetentionWindowInSeconds:f}),children:(0,be.jsx)(A().sA,{defaultMessage:"Change",id:"securitySettings.dataRetention.deleteFromTrash.button"})}):(0,be.jsx)("div",{children:(0,Ct().g)(a.lockIconStyle)})]})}),(0,be.jsx)(Et,{style:a.genericSetting,title:(0,be.jsx)(A().sA,{id:"securitySettings.dataRetention.purge.title",defaultMessage:"After pages are deleted from Trash, retain them for"}),byline:(0,be.jsx)(A().sA,{id:"securitySettings.dataRetention.purge.byline",defaultMessage:"During the retention period, only workspace owners can view or restore the page from Content search. After the retention period, the page will be permanently deleted from Notionâ€™s servers"}),settingItem:(0,be.jsxs)("div",{style:a.settingItem,children:[(0,be.jsx)(Ee().A,{style:a.currentSettingLabel,children:(0,be.jsx)(A().sA,{id:"securitySettings.dataRetention.purge.currentSetting",defaultMessage:"{duration}",values:{duration:(0,Bt().rN)(h,s)}})}),(0,Dt().e2)(l)?(0,be.jsx)(Mt().A,{size:"lg",disabled:!1,style:a.changeButtonStyle,onClick:()=>p({isOpen:!0,retentionType:"purge",currentRetentionWindowInSeconds:h}),children:(0,be.jsx)(A().sA,{defaultMessage:"Change",id:"securitySettings.dataRetention.purge.button"})}):(0,be.jsx)("div",{children:(0,Ct().g)(a.lockIconStyle)})]})})]})}function dn(e){const{dataRetentionAvailability:t}=e,n=(0,c().IS)((e=>({bannerStyle:{borderRadius:4,padding:15,width:"100%",backgroundColor:e.lightBlueBannerBackground,flexFlow:(0,Dt().e2)(t)?"column":"row",display:"flex",overflow:"hidden"},bannerLabelStyle:{marginBottom:8}})),[t]);return!(0,Dt().e2)(t)&&null!=t&&t.upsell?(0,be.jsx)(cn,{upsell:t.upsell}):(0,be.jsxs)("div",{style:n.bannerStyle,children:[(0,be.jsx)(Ee().A,{style:n.bannerLabelStyle,children:(0,be.jsx)(A().sA,{id:"securitySettings.dataRetention.disclaimer.title",defaultMessage:"How page deletion and retention works in Notion"})}),(0,be.jsx)(Ee().A,{style:n.bannerLabelStyle,isMultiline:!0,isSmall:!0,children:(0,be.jsx)(A().sA,{id:"securitySettings.dataRetention.disclaimer.description",defaultMessage:"A page can be moved to Trash by anyone with edit or full access. The page can then be restored or deleted. Workspace owners can customize whether pages in Trash are automatically deleted after a period of time, and how long deleted pages are retained on Notionâ€™s servers."})}),(0,be.jsx)(Rt().A,{title:(0,be.jsx)(Vt().j,{children:(0,be.jsx)(A().sA,{defaultMessage:"Learn more about data retention in Notion",id:"securitySettings.dataRetention.learnMore"})}),buttonStyle:{maxWidth:"100%",overflow:"hidden"},href:(0,rt().x)("guides.customDataRetentionRules"),analyticsFrom:"security_settings"})]})}function cn({upsell:e}){const t=(0,r().v3)(),n=(0,A().tz)(),i=(0,c().IS)((e=>({bannerStyle:{borderRadius:4,padding:15,width:"100%",backgroundColor:e.lightBlueBannerBackground,flexFlow:"row",display:"flex",overflow:"hidden"},bannerLabelStyle:{marginBottom:8},bannerImage:{width:75,display:"flex",alignItems:"center",paddingInlineEnd:15},bannerTitleBold:{fontWeight:w().Wy.bold}})),[]),s=(0,o().X)("upgrade_system_settings");return"none"===e.type?null:s?(0,be.jsx)(Kt().w,{upsell:e,source:"space_settings_cdrr_settings",title:(0,be.jsx)(A().sA,{id:"securitySettings.dataRetention.upsellBanner.title",defaultMessage:"Customize your workspaceâ€™s data retention policy"}),description:(0,be.jsx)(A().sA,{id:"securitySettings.dataRetention.upsellBanner.description",defaultMessage:"Get the {planName} plan to unlock all settings",values:{planName:(0,x().u2)({product:e.product,intl:n})}}),icons:[{icon:kt},{icon:Pt().trashFillIcon},{icon:_t},{icon:It().clockFillIcon}]}):(0,be.jsxs)("div",{style:i.bannerStyle,children:[(0,be.jsx)("div",{style:i.bannerImage,children:(0,be.jsx)(Ut,{product:"enterprise"})}),(0,be.jsxs)("div",{children:[(0,be.jsx)(Ee().A,{style:{...i.bannerLabelStyle,...i.bannerTitleBold},children:(0,be.jsx)(A().sA,{id:"securitySettings.dataRetention.upsell.title",defaultMessage:"Upgrade to the Enterprise plan to customize your workspaceâ€™s data retention policy"})}),(0,be.jsx)(Ee().A,{style:i.bannerLabelStyle,isMultiline:!0,isSecondaryColor:!0,children:(0,be.jsx)(A().sA,{id:"securitySettings.dataRetention.upsell.description",defaultMessage:"Workspaces on the Enterprise plan also get SAML SSO, custom guest limits, audit logging, and other advanced security controls"})}),(0,be.jsx)(wt().A,{colorPalette:"blue",onClick:()=>{(0,Ot().K)(t,{from:"space_settings_cdrr_settings",upsell:e})},size:"lg",children:(0,be.jsx)(A().sA,{defaultMessage:"Upgrade to Enterprise",id:"securitySettings.upgradeButton.text"})})]})]})}const un=(0,A().YK)({eligible_for_upgrade:{id:"securitySettings.dataRetention.deleteFromTrashUpgradeMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to set Trash auto-deletion timing"},eligible_for_trial:{id:"securitySettings.dataRetention.deleteFromTrashUpgradeMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to set Trash auto-deletion timing"},sales_eligible:{id:"securitySettings.dataRetention.deleteFromTrashUpgradeMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to set Trash auto-deletion timing"},sales_assisted:{id:"securitySettings.dataRetention.deleteFromTrashUpgradeMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to set Trash auto-deletion timing"},eligible_to_request:{id:"securitySettings.dataRetention.deleteFromTrashUpgradeMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to set Trash auto-deletion timing"},not_eligible:{id:"securitySettings.dataRetention.deleteFromTrashUpgradeMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to set Trash auto-deletion timing"},request_pending:{id:"securitySettings.dataRetention.deleteFromTrashUpgradeMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to set Trash auto-deletion timing"}}),pn=(0,A().YK)({eligible_for_upgrade:{id:"securitySettings.dataRetention.purgeUpgradeMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to control Trash recovery period"},eligible_for_trial:{id:"securitySettings.dataRetention.purgeUpgradeMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to control Trash recovery period"},sales_eligible:{id:"securitySettings.dataRetention.purgeUpgradeMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to control Trash recovery period"},sales_assisted:{id:"securitySettings.dataRetention.purgeUpgradeMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to control Trash recovery period"},eligible_to_request:{id:"securitySettings.dataRetention.purgeUpgradeMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to control Trash recovery period"},not_eligible:{id:"securitySettings.dataRetention.purgeUpgradeMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to control Trash recovery period"},request_pending:{id:"securitySettings.dataRetention.purgeUpgradeMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to control Trash recovery period"}});function gn({updateModalState:e,setUpdateModalState:t,spaceStore:n,saveDeleteFromTrashDelay:i,savePurgeDelay:o,dataRetentionAvailability:s,currentDeleteFromTrashDelayInSeconds:a,currentPurgeDelayInSeconds:r}){const l=(0,A().tz)();return(0,be.jsxs)(be.Fragment,{children:[e.isOpen?(0,be.jsx)(an,{isOpen:e.isOpen,closeModal:()=>t({...e,isOpen:!1}),spaceStore:n,currentRetentionWindowInSeconds:e.currentRetentionWindowInSeconds,retentionType:e.retentionType,onSaveRetentionWindow:"delete_from_trash"===e.retentionType?i:o}):void 0,(0,be.jsxs)(yt().Y1,{gap:48,children:[(0,be.jsxs)(yt().Y1,{gap:32,children:[(0,be.jsx)(Lt().A,{type:"custom",isMobile:Boolean(_e().A.isMobile),upsellOptions:null!=s&&s.upsell?{upsell:s.upsell,analyticsName:"space_settings_cdrr_settings",customMessages:un}:void 0,title:(0,be.jsx)(A().sA,{id:"securitySettings.dataRetention.deleteFromTrash.title",defaultMessage:"Once pages are moved to Trash, delete them after"}),caption:(0,be.jsx)(A().sA,{id:"securitySettings.dataRetention.deletedFromTrash.byline",defaultMessage:"Anyone with edit or full access will be able to restore or manually delete pages in Trash"}),customButton:(0,be.jsx)(Mt().A,{size:"lg",disabled:!(0,Dt().e2)(s),onClick:()=>t({isOpen:!0,retentionType:"delete_from_trash",currentRetentionWindowInSeconds:a}),children:(0,be.jsx)(A().sA,{id:"securitySettings.dataRetention.deleteFromTrash.currentSetting",defaultMessage:"{duration}",values:{duration:(0,Bt().rN)(a,l)}})})}),(0,be.jsx)(Lt().A,{type:"custom",isMobile:Boolean(_e().A.isMobile),upsellOptions:null!=s&&s.upsell?{upsell:s.upsell,analyticsName:"space_settings_cdrr_settings",customMessages:pn}:void 0,title:(0,be.jsx)(A().sA,{id:"securitySettings.dataRetention.purge.title",defaultMessage:"After pages are deleted from Trash, retain them for"}),caption:(0,be.jsx)(A().sA,{id:"securitySettings.dataRetention.purge.byline",defaultMessage:"During the retention period, only workspace owners can view or restore the page from Content search. After the retention period, the page will be permanently deleted from Notionâ€™s servers"}),customButton:(0,be.jsx)(Mt().A,{size:"lg",disabled:!(0,Dt().e2)(s),onClick:()=>t({isOpen:!0,retentionType:"purge",currentRetentionWindowInSeconds:r}),children:(0,be.jsx)(A().sA,{id:"securitySettings.dataRetention.deleteFromTrash.currentSetting",defaultMessage:"{duration}",values:{duration:(0,Bt().rN)(r,l)}})})})]}),(0,be.jsx)(dn,{dataRetentionAvailability:s})]})]})}var mn=()=>n(681242),fn=()=>n(682563);const hn={viewBox:"0 0 20 20",fittedViewBox:"4.12 2.37 11.75 15.25",svg:(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)("path",{d:"M10.6 11.334V10.6a.6.6 0 0 0-1.2 0v.734zm-.05 1.796a.55.55 0 1 1-1.1 0 .55.55 0 0 1 1.1 0"}),(0,be.jsx)("path",{d:"M6.25 2.375h3.7V6.25A2.05 2.05 0 0 0 12 8.3h3.875v7.2a2.125 2.125 0 0 1-2.125 2.125h-7.5A2.125 2.125 0 0 1 4.125 15.5v-11c0-1.174.951-2.125 2.125-2.125M10 9a1.6 1.6 0 0 0-1.6 1.6v.817a1 1 0 0 0-.6.917V14a1 1 0 0 0 1 1h2.4a1 1 0 0 0 1-1v-1.666a1 1 0 0 0-.6-.917V10.6A1.6 1.6 0 0 0 10 9"}),(0,be.jsx)("path",{d:"M15.253 6.619c.17.17.31.367.412.581H12a.95.95 0 0 1-.95-.95V2.585q.323.156.581.412z"})]})},vn=(0,v().wt)("lockDocFill",hn),yn={viewBox:"0 0 20 20",fittedViewBox:"2.37 4.25 15.25 11.5",svg:(0,be.jsx)("path",{d:"M3 7.375h6.829a2.501 2.501 0 0 0 4.842 0H17a.625.625 0 1 0 0-1.25h-2.329a2.501 2.501 0 0 0-4.842 0H3a.625.625 0 1 0 0 1.25m14 6.5a.625.625 0 1 0 0-1.25h-6.829a2.5 2.5 0 0 0-4.842 0H3a.625.625 0 1 0 0 1.25h2.329a2.501 2.501 0 0 0 4.842 0z"})},bn=(0,v().wt)("slidersFill",yn);var Sn=()=>n(709062),xn=()=>n(809730),An=()=>n(37433),Mn=()=>n(324561),wn=()=>n(783192);function jn({securitySettingsStore:e,spaceStore:t,organizationOverrides:n}){const i=(0,A().tz)(),s=(0,Mn().lh)({spaceId:t.id}),a=(0,d().K8)((()=>(0,xn().e)({billingData:s})),[s]),r=(0,o().X)("upgrade_system_settings"),l=(0,d().O$)(e),c=e=>{if(!a&&!e)return{type:"product",product:"enterprise",limit:{type:"none"},trialability:"none"}},u=c(!1);return(0,be.jsxs)(yt().Y1,{gap:32,children:[(0,be.jsx)(kn,{upsell:c(l.disablePublicAccess),spaceStore:t,securitySettingsStore:e,isControlledByOrganization:Boolean(n.disable_public_access)}),(0,be.jsx)(In,{upsell:c(l.disableSpacePageEdits),spaceStore:t,securitySettingsStore:e}),(0,be.jsx)(Cn,{upsell:c(l.disableMoveToSpace),spaceStore:t,securitySettingsStore:e,isControlledByOrganization:Boolean(n.disable_move_to_space)}),(0,be.jsx)(Tn,{upsell:c(l.disableExport),spaceStore:t,securitySettingsStore:e,isControlledByOrganization:Boolean(n.disable_export)}),r&&u?(0,be.jsx)(Kt().w,{upsell:u,source:"general_security_settings",title:(0,be.jsx)(A().sA,{id:"securitySettings.general.upsellBanner.title",defaultMessage:"Advanced controls for your workspace"}),description:(0,be.jsx)(A().sA,{id:"securitySettings.general.upsellBanner.description",defaultMessage:"Get the {planName} plan to unlock all settings",values:{planName:(0,x().u2)({product:u.product,intl:i})}}),icons:[{icon:vn},{icon:mn().checkmarkShieldFillIcon},{icon:fn().gearFillIcon},{icon:bn}]}):void 0]})}function kn({securitySettingsStore:e,spaceStore:t,isControlledByOrganization:n,upsell:i}){const o=(0,r().v3)(),s=(0,d().K8)((()=>e.state.disablePublicAccess),[e]);return(0,be.jsx)(Lt().A,{type:"toggle",isMobile:Boolean(_e().A.isMobile),isOn:s,isLocked:n,lockedTooltip:(0,Sn().C_)(),onToggle:()=>{n||async function(e,t,n){const i=e.state.disablePublicAccess;if(!i){const{accept:e}=await T().Gh({message:(0,be.jsx)(A().sA,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.messageAWTLUpdate",defaultMessage:"Are you sure you want to disable publishing sites, forms, and public links?"}),description:(0,be.jsx)(A().sA,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.description",defaultMessage:"This will remove access for anyone who is not a member or guest of the workspace from all pages in this workspace."}),acceptLabel:(0,be.jsx)(A().sA,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.confirmButton.label",defaultMessage:"Yes"})});if(!e)return}(0,wn().g)({disablePublicAccess:!i},e,t,n)}(e,t,o)},upsellOptions:i?{upsell:i,analyticsName:"disable_public_access",customMessages:_n}:void 0,title:(0,be.jsx)(A().sA,{id:"securitySAMLSettings.securitySection.preventPublicSharing.labelAWTLUpdate",defaultMessage:"Disable publishing sites, forms, and public links"}),caption:(0,be.jsx)(A().sA,{id:"securitySAMLSettings.securitySection.preventPublicSharing.captionUpdatedAWTL",defaultMessage:"Disable the â€œPublish siteâ€ and â€œAnyone on the web with linkâ€ options in the Share menu on every page and form in this workspace"})})}function In({securitySettingsStore:e,spaceStore:t,upsell:n}){const i=(0,r().v3)(),o=(0,d().K8)((()=>e.state.disableSpacePageEdits),[e]);return(0,d().K8)((()=>(0,An().zI)()>0),[])?null:(0,be.jsx)(Lt().A,{type:"toggle",isMobile:Boolean(_e().A.isMobile),isOn:o,onToggle:()=>(0,wn().v)({name:"disableSpacePageEdits",securitySettingsStore:e,spaceStore:t,environment:i}),upsellOptions:n?{upsell:n,analyticsName:"disable_space_page_edits",customMessages:Pn}:void 0,title:(0,be.jsx)(A().sA,{id:"securitySAMLSettings.securitySection.disableSpacePageEdits.label",defaultMessage:"Prevent members from editing the Workspace section"}),caption:(0,be.jsx)(A().sA,{id:"securitySAMLSettings.securitySection.disableSpacePageEdits.caption",defaultMessage:"Disable the ability for members to create, move, reorder, and delete top-level Workspace pages."})})}function Cn({upsell:e,spaceStore:t,securitySettingsStore:n,isControlledByOrganization:i}){const o=(0,r().v3)(),s=(0,d().K8)((()=>n.state.disableMoveToSpace),[n]);return(0,be.jsx)(Lt().A,{type:"toggle",isMobile:Boolean(_e().A.isMobile),isOn:s,isLocked:i,lockedTooltip:(0,Sn().C_)(),onToggle:()=>{i||(0,wn().v)({name:"disableMoveToSpace",securitySettingsStore:n,spaceStore:t,environment:o})},upsellOptions:e?{upsell:e,analyticsName:"disable_move_to_space",customMessages:Bn}:void 0,title:(0,be.jsx)(A().sA,{id:"securitySAMLSettings.securitySection.disableMovingPages.label",defaultMessage:"Disable duplicating pages to other workspaces"}),caption:(0,be.jsx)(A().sA,{id:"securitySAMLSettings.securitySection.disableMovingPages.caption",defaultMessage:"Prevent anyone from duplicating pages to other workspaces via the Move To or Duplicate To actions."})})}function Tn({upsell:e,securitySettingsStore:t,spaceStore:n,isControlledByOrganization:i}){const o=(0,r().v3)(),s=(0,d().K8)((()=>t.state.disableExport),[t]);return(0,be.jsx)(Lt().A,{type:"toggle",isMobile:Boolean(_e().A.isMobile),isOn:s,isLocked:i,lockedTooltip:(0,Sn().C_)(),onToggle:()=>{i||(0,wn().v)({name:"disableExport",securitySettingsStore:t,spaceStore:n,environment:o})},upsellOptions:e?{upsell:e,analyticsName:"disable_export",customMessages:Dn}:void 0,title:(0,be.jsx)(A().sA,{id:"securitySAMLSettings.securitySection.disableExport.label",defaultMessage:"Disable export"}),caption:(0,be.jsx)(A().sA,{id:"securitySAMLSettings.securitySection.disableExport.caption",defaultMessage:"Prevent anyone from exporting as Markdown, CSV, or PDF."})})}const _n=(0,A().YK)({eligible_for_upgrade:{id:"securitySettings.disablePublicAccess.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to disable publishing sites, forms, and public links"},eligible_for_trial:{id:"securitySettings.disablePublicAccess.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to disable publishing sites, forms, and public links"},sales_eligible:{id:"securitySettings.disablePublicAccess.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to disable publishing sites, forms, and public links"},sales_assisted:{id:"securitySettings.disablePublicAccess.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to disable publishing sites, forms, and public links"},eligible_to_request:{id:"securitySettings.disablePublicAccess.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to disable publishing sites, forms, and public links"},not_eligible:{id:"securitySettings.disablePublicAccess.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to disable publishing sites, forms, and public links"},request_pending:{id:"securitySettings.disablePublicAccess.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to disable publishing sites, forms, and public links"}}),Pn=(0,A().YK)({eligible_for_upgrade:{id:"securitySettings.disableSpacePageEdits.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to disable the ability for members to create, move, reorder, and delete top-level Workspace pages"},eligible_for_trial:{id:"securitySettings.disableSpacePageEdits.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to disable the ability for members to create, move, reorder, and delete top-level Workspace pages"},sales_eligible:{id:"securitySettings.disableSpacePageEdits.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to disable the ability for members to create, move, reorder, and delete top-level Workspace pages"},sales_assisted:{id:"securitySettings.disableSpacePageEdits.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to disable the ability for members to create, move, reorder, and delete top-level Workspace pages"},eligible_to_request:{id:"securitySettings.disableSpacePageEdits.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to disable the ability for members to create, move, reorder, and delete top-level Workspace pages"},not_eligible:{id:"securitySettings.disableSpacePageEdits.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to disable the ability for members to create, move, reorder, and delete top-level Workspace pages"},request_pending:{id:"securitySettings.disableSpacePageEdits.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to disable the ability for members to create, move, reorder, and delete top-level Workspace pages"}}),Bn=(0,A().YK)({eligible_for_upgrade:{id:"securitySettings.disableMoveToSpace.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to prevent users from duplicating pages to other workspaces via Move To or Duplicate To"},eligible_for_trial:{id:"securitySettings.disableMoveToSpace.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to prevent users from duplicating pages to other workspaces via Move To or Duplicate To"},sales_eligible:{id:"securitySettings.disableMoveToSpace.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to prevent users from duplicating pages to other workspaces via Move To or Duplicate To"},sales_assisted:{id:"securitySettings.disableMoveToSpace.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to prevent users from duplicating pages to other workspaces via Move To or Duplicate To"},eligible_to_request:{id:"securitySettings.disableMoveToSpace.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to prevent users from duplicating pages to other workspaces via Move To or Duplicate To"},not_eligible:{id:"securitySettings.disableMoveToSpace.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to prevent users from duplicating pages to other workspaces via Move To or Duplicate To"},request_pending:{id:"securitySettings.disableMoveToSpace.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to prevent users from duplicating pages to other workspaces via Move To or Duplicate To"}}),Dn=(0,A().YK)({eligible_for_upgrade:{id:"securitySettings.disableExport.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to prevent users from exporting as Markdown, CSV, or PDF"},eligible_for_trial:{id:"securitySettings.disableExport.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to prevent users from exporting as Markdown, CSV, or PDF"},sales_eligible:{id:"securitySettings.disableExport.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to prevent users from exporting as Markdown, CSV, or PDF"},sales_assisted:{id:"securitySettings.disableExport.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to prevent users from exporting as Markdown, CSV, or PDF"},eligible_to_request:{id:"securitySettings.disableExport.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to prevent users from exporting as Markdown, CSV, or PDF"},not_eligible:{id:"securitySettings.disableExport.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to prevent users from exporting as Markdown, CSV, or PDF"},request_pending:{id:"securitySettings.disableExport.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to prevent users from exporting as Markdown, CSV, or PDF"}});var Rn=()=>n(564884),En=()=>n(966505),Ln=()=>n(662303),On=()=>n(676007),Nn=function(e){return e[e.Keep=0]="Keep",e[e.Remove=1]="Remove",e}(Nn||{});function Fn(e){return(0,be.jsx)(On().a,{open:e.isOpen,onDismiss:e.onDismiss,render:()=>(0,be.jsx)(Un,{...e})})}function Un(e){const{onDismiss:t,onSave:n,guestCount:o}=e,[s,a]=(0,i.useState)(Nn.Keep),r=(0,c().IS)((e=>({container:{width:350,padding:30,borderRadius:5,height:400,alignItems:"center"},title:{fontFamily:w().vc(Ln().locale).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center"},subtitle:{fontFamily:w().vc(Ln().locale).sans,fontSize:14,fontWeight:300,lineHeight:"19px",margin:10,textAlign:"center"},radioContainer:{display:"flex",flexDirection:"column"},button:{justifyContent:"space-between",marginTop:10,height:70,borderRadius:5},buttonText:{display:"flex",flexDirection:"column"},optionSubtitle:{whiteSpace:"break-spaces"},actionButtonsContainer:{display:"flex",flexDirection:"column",marginTop:20},cancelButton:{justifyContent:"center",margin:"8px auto 0"}})),[]),l=(0,i.useCallback)((()=>{const e=s===Nn.Keep;n(e)}),[n,s]);return(0,be.jsxs)("div",{style:r.container,children:[(0,be.jsx)(Ee().A,{style:r.title,children:(0,be.jsx)(A().sA,{id:"disableGuestsConfig.title",defaultMessage:"Disable inviting guests?"})}),(0,be.jsx)(Ee().A,{isSmall:!0,style:r.subtitle,isMultiline:!0,children:(0,bt().O9)(o)?(0,be.jsx)(A().sA,{id:"disableGuestsConfig.description",defaultMessage:"Your workspace currently has {guestCount, plural, one {1 guest} other {{guestCount} guests}}. You can choose to:",values:{guestCount:o}}):(0,be.jsx)(A().sA,{id:"disableGuestsConfig.description.noGuestCount",defaultMessage:"You are turning off guests in this workspace. You can choose to:"})}),(0,be.jsxs)("div",{style:r.radioContainer,children:[(0,be.jsxs)(Mt().A,{size:"lg",onClick:()=>a(Nn.Keep),style:r.button,children:[(0,be.jsx)($t().A,{isSelected:s===Nn.Keep}),(0,be.jsxs)("div",{style:r.buttonText,children:[(0,be.jsx)(Ee().A,{children:(0,be.jsx)(A().sA,{id:"disableGuestsConfig.keepExistingGuests.title",defaultMessage:"Keep existing guests"})}),(0,be.jsx)(Ee().A,{isSmall:!0,isMultiline:!0,style:r.optionSubtitle,children:(0,be.jsx)(A().sA,{id:"disableGuestsConfig.keepExistingGuests.description",defaultMessage:"Guests will still be able to access the pages theyâ€™ve been invited to"})})]})]}),(0,be.jsxs)(Mt().A,{size:"lg",onClick:()=>a(Nn.Remove),style:r.button,children:[(0,be.jsx)($t().A,{isSelected:s===Nn.Remove}),(0,be.jsxs)("div",{style:r.buttonText,children:[(0,be.jsx)(Ee().A,{children:(0,be.jsx)(A().sA,{id:"disableGuestsConfig.removeExistingGuests.title",defaultMessage:"Remove existing guests"})}),(0,be.jsx)(Ee().A,{isSmall:!0,isMultiline:!0,style:r.optionSubtitle,children:(0,be.jsx)(A().sA,{id:"disableGuestsConfig.removeExistingGuests.description",defaultMessage:"All guests will be removed from your workspace"})})]})]})]}),(0,be.jsxs)("div",{style:r.actionButtonsContainer,children:[(0,be.jsx)(wt().A,{colorPalette:"blue",size:"lg",onClick:l,children:(0,be.jsx)(A().sA,{id:"disableGuestsModal.saveChanges",defaultMessage:"Disable inviting guests"})}),(0,be.jsx)(qt().p,{onClick:t,style:r.cancelButton,children:(0,be.jsx)(A().sA,{id:"disableGuestsModal.cancel",defaultMessage:"Cancel"})})]})]})}var zn=()=>n(719147),Kn=()=>n(637573),Vn=()=>n(687111),qn=()=>n(973189),Wn=()=>n(134217),Gn=()=>n(718191);function Hn({securitySettingsStore:e,spaceStore:t,organizationOverrides:n}){const i=(0,Mn().lh)({spaceId:t.id}),o=(0,d().K8)((()=>(0,xn().e)({billingData:i})),[i]),a=(0,S().AI)(i),r=(0,x().jR)(a),l=(0,d().O$)(e),c=l.disablePublicAccessRequests||r?void 0:{type:"product",product:"plus",limit:{type:"none"},trialability:"none"},u=e=>{if(!o&&!e)return{type:"product",product:"enterprise",limit:{type:"none"},trialability:"none"}},p=(0,d().K8)((()=>s().default.checkGate({gateName:"allow_public_page_access_request",disableExposureLogging:!0})),[]);return(0,be.jsxs)(yt().Y1,{gap:32,children:[(0,be.jsx)(Zn,{upsell:c,spaceStore:t,securitySettingsStore:e,publicAccessRequestsExpEnabled:p}),(0,be.jsx)(Yn,{securitySettingsStore:e,spaceStore:t,upsell:u(l.disableGuests),publicAccessRequestsExpEnabled:p,isControlledByOrganization:Boolean(n.disable_guests)}),(0,be.jsx)($n,{securitySettingsStore:e,spaceStore:t,upsell:u(l.enableGuestInviteRequests),publicAccessRequestsExpEnabled:p,isControlledByOrganization:Boolean(n.enable_guest_invite_requests)}),(0,be.jsx)(Gn().B,{spaceStore:t,securitySettingsStore:e,organizationOverrides:n}),(0,be.jsx)(Qn,{securitySettingsStore:e,spaceStore:t,upsell:u(l.disableGuestPrivatePages),isControlledByOrganization:Boolean(n.disable_guest_can_create_private_pages),billingData:i})]})}function Yn({securitySettingsStore:e,spaceStore:t,publicAccessRequestsExpEnabled:n,isControlledByOrganization:o,upsell:s}){const a=(0,r().v3)(),l=(0,d().O$)(e),c=(0,Kn().r)(),u=(0,d().K8)((()=>{const t=e.state.disableGuests,i=e.state.disablePublicAccessRequests;return!(t&&!i)&&(n&&!i)}),[n,e]),p=(0,i.useCallback)((()=>{o||function(e,t,n){const i=e.state.disableGuests,o=e.state.enableGuestInviteRequests;if(i)return void(0,wn().g)({disableGuests:!i,...o&&{enableGuestInviteRequests:!o}},e,t,n);e.setState({...e.state,disableGuestsModalOpen:!0})}(e,t,a)}),[a,e,t,o]);return void 0===c?null:(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(Lt().A,{type:"toggle",isMobile:Boolean(_e().A.isMobile),disabled:u,isOn:!l.disableGuests,isLocked:o,lockedTooltip:(0,Sn().C_)(),onToggle:p,upsellOptions:s?{upsell:s,analyticsName:"disable_guests",customMessages:Xn}:void 0,tooltipLabel:u?(0,be.jsx)(A().sA,{id:"securitySAMLSettings.guestsSection.disableGuests.disabled.label",defaultMessage:"Disable page access requests from non-members to disable this feature"}):void 0,title:(0,be.jsx)(A().sA,{id:"securitySAMLSettings.guestsSection.allowGuests.label",defaultMessage:"Allow members to invite guests to pages"}),caption:(0,be.jsx)(A().sA,{id:"securitySAMLSettings.guestsSection.disableGuests.caption",defaultMessage:"Your workspace currently has <gueststablink> {guestCount, plural, one {1 guest} other {{guestCount} guests}}</gueststablink>",values:{gueststablink:e=>(0,be.jsx)(zn().A,{onClick:e=>{e.stopPropagation(),En().Gq(a,{source_tab:At().A.state.currentTab,destination_tab:"members",destination_subtab:qn().d.Guests}),At().A.setState({...At().A.state,currentTab:"members",defaultSubtab:qn().d.Guests})},children:e}),guestCount:c}})}),(0,be.jsx)(Fn,{isOpen:Boolean(l.disableGuestsModalOpen),onDismiss:()=>{e.setState({...e.state,disableGuestsModalOpen:!1})},onSave:n=>{(0,wn().g)({disableGuests:!0,keepExistingGuests:n},e,t,a),e.setState({...e.state,disableGuestsModalOpen:!1})},guestCount:c})]})}function $n({securitySettingsStore:e,spaceStore:t,publicAccessRequestsExpEnabled:n,isControlledByOrganization:o,upsell:s}){const a=(0,r().v3)(),l=(0,d().K8)((()=>e.state.enableGuestInviteRequests),[e]),c=(0,d().K8)((()=>!e.state.disableGuests||n&&!e.state.disablePublicAccessRequests),[e,n]),u=(0,i.useCallback)((()=>{o||(0,wn().v)({name:"enableGuestInviteRequests",securitySettingsStore:e,spaceStore:t,environment:a})}),[a,e,t,o]),p=(0,d().K8)((()=>(0,Wn().dW)()),[]),g=(0,d().K8)((()=>!Boolean(s)&&!e.state.disableGuests),[e,s]);return(0,be.jsx)(Lt().A,{type:"toggle",isMobile:Boolean(_e().A.isMobile),disabled:c,isOn:l,isLocked:o,lockedTooltip:(0,Sn().C_)(),onToggle:u,upsellOptions:s?{upsell:s,analyticsName:"enable_guest_invite_requests",customMessages:ti}:void 0,tooltipLabel:g?(0,be.jsx)(A().sA,{id:"securitySAMLSettings.guestsSection.enableGuestInviteRequests.disabled.label",defaultMessage:"Disable inviting guests to use this feature"}):void 0,title:(0,be.jsx)(A().sA,{id:"securitySAMLSettings.guestsSection.enableGuestInviteRequests.label",defaultMessage:"Allow members to request adding guests"}),caption:(0,be.jsx)(A().sA,{id:"securitySAMLSettings.guestsSection.enableGuestInviteRequests.caption",defaultMessage:"{hasRequestTab, select, true {Requests must be approved by a workspace owner. You can view all requests <requeststablink>here</requeststablink>} other {Requests must be approved by a workspace owner}}",values:{hasRequestTab:p,requeststablink:e=>(0,be.jsx)(zn().A,{onClick:e=>{e.stopPropagation(),En().Gq(a,{source_tab:At().A.state.currentTab,destination_tab:"members",destination_subtab:qn().d.Requests}),At().A.setState({...At().A.state,currentTab:"members",defaultSubtab:qn().d.Requests})},children:e})}})})}function Qn(e){const{securitySettingsStore:t,spaceStore:n,upsell:o,isControlledByOrganization:s,billingData:a}=e,l=(0,r().v3)(),c=(0,d().K8)((()=>t.state.disableGuestPrivatePages),[t]),u=(0,d().K8)((()=>(0,Vn().H)()&&!(0,S().N8)(a)),[a]),p=(0,i.useCallback)((()=>{s||((0,Rn().u)({environment:l,event:{eventName:"guest_with_private_pages_admin_settings_updated",eventProperties:{space_id:n.id,final_setting_value:c?"enabled":"disabled"}}}),(0,wn().v)({name:"disableGuestPrivatePages",securitySettingsStore:t,spaceStore:n,environment:l}))}),[l,t,n,s,c]);return u?(0,be.jsx)(Lt().A,{type:"toggle",isMobile:Boolean(_e().A.isMobile),disabled:!1,isOn:!c,isLocked:s,lockedTooltip:(0,Sn().C_)(),onToggle:p,upsellOptions:o?{upsell:o,analyticsName:"disable_guest_private_pages",customMessages:ei}:void 0,title:(0,be.jsx)(A().sA,{id:"securitySAMLSettings.guestsSection.disableGuestPrivatePages.label",defaultMessage:"Allow guests to create private pages while their membership is pending"}),caption:(0,be.jsx)(A().sA,{id:"securitySAMLSettings.guestsSection.disableGuestPrivatePages.caption",defaultMessage:"If enabled, guests can create private pages after requesting membership to this workspace"})}):null}function Zn({securitySettingsStore:e,spaceStore:t,publicAccessRequestsExpEnabled:n,upsell:i}){const o=(0,r().v3)(),s=(0,d().K8)((()=>e.state.disablePublicAccessRequests),[e]),a=(0,d().K8)((()=>{const n=!e.state.disablePublicAccessRequests,i=!n;return()=>{(0,wn().g)({disablePublicAccessRequests:n,...i&&{disableGuests:!1,enableGuestInviteRequests:!1}},e,t,o)}}),[o,t,e]);return n?(0,be.jsx)(Lt().A,{type:"toggle",isMobile:Boolean(_e().A.isMobile),isOn:!s,onToggle:a,upsellOptions:i?{upsell:i,analyticsName:"disable_public_access_requests",customMessages:Jn}:void 0,title:(0,be.jsx)(A().sA,{id:"securitySAMLSettings.securitySection.disablePublicAccessRequests.label",defaultMessage:"Allow page access requests from non-members"}),caption:(0,be.jsx)(A().sA,{id:"securitySAMLSettings.securitySection.disablePublicAccessRequests.caption",defaultMessage:"This allows anyone with the link to a page to request access. Workspace members can always request access."})}):null}const Jn=(0,A().YK)({eligible_for_upgrade:{id:"securitySettings.disablePublicAccessRequests.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to disable the ability for anyone with the link to a page to request access"},eligible_for_trial:{id:"securitySettings.disablePublicAccessRequests.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to disable the ability for anyone with the link to a page to request access"},sales_eligible:{id:"securitySettings.disablePublicAccessRequests.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to disable the ability for anyone with the link to a page to request access"},sales_assisted:{id:"securitySettings.disablePublicAccessRequests.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to disable the ability for anyone with the link to a page to request access"},eligible_to_request:{id:"securitySettings.disablePublicAccessRequests.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to disable the ability for anyone with the link to a page to request access"},not_eligible:{id:"securitySettings.disablePublicAccessRequests.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to disable the ability for anyone with the link to a page to request access"},request_pending:{id:"securitySettings.disablePublicAccessRequests.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to disable the ability for anyone with the link to a page to request access"}}),Xn=(0,A().YK)({eligible_for_upgrade:{id:"securitySettings.disableGuests.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to disable the ability for members to invite guests to pages"},eligible_for_trial:{id:"securitySettings.disableGuests.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to disable the ability for members to invite guests to pages"},sales_eligible:{id:"securitySettings.disableGuests.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to disable the ability for members to invite guests to pages"},sales_assisted:{id:"securitySettings.disableGuests.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to disable the ability for members to invite guests to pages"},eligible_to_request:{id:"securitySettings.disableGuests.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to disable the ability for members to invite guests to pages"},not_eligible:{id:"securitySettings.disableGuests.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to disable the ability for members to invite guests to pages"},request_pending:{id:"securitySettings.disableGuests.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to disable the ability for members to invite guests to pages"}}),ei=(0,A().YK)({eligible_for_upgrade:{id:"securitySettings.disableGuestPrivatePages.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to prevent guests from creating private pages"},eligible_for_trial:{id:"securitySettings.disableGuestPrivatePages.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to prevent guests from creating private pages"},sales_eligible:{id:"securitySettings.disableGuestPrivatePages.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to prevent guests from creating private pages"},sales_assisted:{id:"securitySettings.disableGuestPrivatePages.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to prevent guests from creating private pages"},eligible_to_request:{id:"securitySettings.disableGuestPrivatePages.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to prevent guests from creating private pages"},not_eligible:{id:"securitySettings.disableGuestPrivatePages.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to prevent guests from creating private pages"},request_pending:{id:"securitySettings.disableGuestPrivatePages.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to prevent guests from creating private pages"}}),ti=(0,A().YK)({eligible_for_upgrade:{id:"securitySettings.enableGuestInviteRequests.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to let workspace members send guest requests to admins"},eligible_for_trial:{id:"securitySettings.enableGuestInviteRequests.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to let workspace members send guest requests to admins"},sales_eligible:{id:"securitySettings.enableGuestInviteRequests.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to let workspace members send guest requests to admins"},sales_assisted:{id:"securitySettings.enableGuestInviteRequests.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to let workspace members send guest requests to admins"},eligible_to_request:{id:"securitySettings.enableGuestInviteRequests.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to let workspace members send guest requests to admins"},not_eligible:{id:"securitySettings.enableGuestInviteRequests.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to let workspace members send guest requests to admins"},request_pending:{id:"securitySettings.enableGuestInviteRequests.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to let workspace members send guest requests to admins"}}),ni=["security","members_and_guests","data_retention"],ii={security:(0,be.jsx)(A().sA,{id:"securityTabs.general.title",defaultMessage:"General"}),members_and_guests:(0,be.jsx)(A().sA,{id:"securityTabs.membersAndGuests.title",defaultMessage:"Members & guests"}),data_retention:(0,be.jsx)(A().sA,{id:"securityTabs.dataRetention.title",defaultMessage:"Data retention"})};function oi({securitySettingsStore:e,spaceStore:t,organizationOverrides:n}){const o=(0,r().v3)(),s=(0,d().K8)((()=>At().A.getState().defaultSubtab),[]),[a,l]=(0,i.useState)((()=>s&&(0,bt().Xk)(ni,s)?ni.indexOf(s):0)),c=(0,i.useCallback)((e=>{C()._J(o,{tab:ni[e]}),l(e)}),[l,o]),u=i.useMemo((()=>{switch(ni[a]){case"security":return(0,be.jsx)(jn,{securitySettingsStore:e,spaceStore:t,organizationOverrides:n});case"members_and_guests":return(0,be.jsx)(Hn,{securitySettingsStore:e,spaceStore:t,organizationOverrides:n});case"data_retention":return(0,be.jsx)(ln,{spaceStore:t})}}),[a,e,t,n]);return(0,be.jsxs)(St().Ay,{children:[(0,be.jsx)(Ie().A,{large:!0,divider:"full",children:(0,be.jsx)(A().sA,{id:"securitySettings.securityAndData.title",defaultMessage:"Security & data"})}),(0,be.jsxs)(yt().Y1,{gap:28,children:[(0,be.jsx)(xt().Ay,{tabs:ni.map((e=>ii[e])),selectedIndex:a,onChange:c}),u]})]})}var si=()=>n(671885),ai=()=>n(109113),ri=()=>n(311337),li=()=>n(155959),di=()=>n(765957),ci=()=>n(814431),ui=()=>n(423219),pi=()=>n(522094);class gi extends $().Store{getInitialState(){return{status:"unconfigured",emailDomains:[],domainVerifications:[],spaces:[],createAccount:!1,useMetadataUrl:!0}}}const mi=gi;var fi=()=>n(132813),hi=()=>n(311670);class vi extends $().Store{getInitialState(){return{emailDomains:[],spaceCreation:"admins_only",settings:{}}}async updateValueForSpace(e){const{environment:t,spaceId:n,store:i}=e,o=await q().callApi({eventName:"getEmailDomainsForSpace",environment:t,data:{spaceId:n}});if("failed"===o.type)return void T().Qg(o);const{data:s}=o,a=Object.keys(s);return 0!==a.length?i.setState({emailDomains:a,spaceCreation:s[a[0]].spaceCreationEnum,settings:s[a[0]].settings}):i.setState(this.getInitialState()),i.state}}const yi=vi;var bi=()=>n(678894),Si=()=>n(309049),xi=()=>n(762299),Ai=()=>n(204486),Mi=()=>n(912396),wi=()=>n(450327);const ji=(0,A().YK)({apply_credit:{id:"spaceSubscriptionBilling.applyCreditButton.label",defaultMessage:"Apply credit"},update:{id:"spaceSubscriptionBilling.updateButton.label",defaultMessage:"Update"},add:{id:"spaceSubscriptionBilling.addButton.label",defaultMessage:"Add"},apply:{id:"spaceSubscriptionBilling.apply.label",defaultMessage:"Apply"}});function ki(e){const t=(0,c().DP)(),n={marginInlineStart:18,marginInlineEnd:-4,fontWeight:w().Wy.medium},{title:i,caption:o,buttonArgs:s}=e,a=(0,be.jsx)(A().sA,{...ji[s.buttonPurpose]});return(0,be.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:14},children:[(0,be.jsx)("div",{style:{marginInlineEnd:"auto"},children:i}),(0,be.jsx)("div",{style:{color:t.text.secondary},children:o}),(0,be.jsx)("div",{style:{minWidth:110,display:"flex",justifyContent:"flex-end"},children:s.showButton?(0,be.jsx)(qt().p,{colorPalette:"blue",onClick:s.onClick,style:n,children:a}):void 0})]})}const Ii={workspaceBalance:(0,be.jsx)(A().sA,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.workspaceSubscriptionBalance.title",defaultMessage:"Workspace balance"}),applyCoupon:(0,be.jsx)(A().sA,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.applyCoupon.title",defaultMessage:"Apply coupon"}),discount:(0,be.jsx)(A().sA,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.discount.title",defaultMessage:"Discount"})};var Ci=()=>n(517492);const Ti={height:"100%",padding:"36px 60px"},_i={display:"flex",flexDirection:"column",height:"100%"};const Pi=function({spaceStore:e,billingData:t,billingEvents:i}){const o=(0,A().tz)();return(0,d().O$)(u().e)?(0,be.jsx)("div",{style:_i,children:(0,be.jsxs)(n(2143).H,{style:Ti,type:n(611648).A.Y,children:[(0,be.jsx)(Ie().A,{large:!0,divider:"full",children:(0,be.jsx)(A().sA,{...wi().DZ.billingTab})}),(0,be.jsx)(Bi,{billingData:t}),(0,be.jsx)(Di,{}),(0,be.jsx)(n(278597).g,{spaceStore:e,events:i,upcomingInvoiceData:void 0})]})}):(0,be.jsx)(St().Ay,{children:(0,be.jsx)(Ee().A,{isSmall:!0,style:{textAlign:"center"},children:o.formatMessage(Mi().DZ.offline)})})};function Bi({billingData:e}){const t=e.lockedCurrencyCode;if(!t)return null;const n=(0,S().o2)(e,t),i=-Math.min(0,n.amount);return(0,be.jsx)(ki,{title:Ii.workspaceBalance,caption:(0,be.jsx)("div",{children:(0,be.jsx)(Ci().v,{cost:{amount:i,currencyCode:t},trailingZeroDisplay:"stripIfInteger"})}),buttonArgs:{showButton:!1,buttonPurpose:"apply_credit",onClick:M().lQ}})}function Di(){return(0,be.jsx)("div",{style:{flex:"none",marginTop:30}})}var Ri=()=>n(102247),Ei=()=>n(369955);var Li=()=>n(209426),Oi=()=>n(479314),Ni=()=>n(543786),Fi=()=>n(493552),Ui=()=>n(158115),zi=()=>n(706024),Ki=()=>n(581369),Vi=()=>n(21140),qi=()=>n(459401),Wi=()=>n(721672),Gi=()=>n(573660),Hi=()=>n(477657),Yi=()=>n(238453),$i=()=>n(118849),Qi=()=>n(568688);var Zi=()=>n(204330),Ji=()=>n(383716);const Xi=4;function eo({securitySettingsStore:e,spaceStore:t}){const n=(0,A().tz)(),i=(0,c().IS)((()=>({horizontalScrollWrapper:{minWidth:750}})),[]);return(0,be.jsxs)(yt().Y1,{direction:"vertical",padding:"36px 60px",style:i.horizontalScrollWrapper,children:[(0,be.jsxs)(yt().Y1,{direction:"vertical",gap:16,children:[(0,be.jsx)(Ji().n,{title:n.formatMessage(lo.title)}),(0,be.jsxs)(yt().Y1,{direction:"horizontal",gap:14,children:[t?(0,be.jsx)(no,{spaceStore:t}):void 0,t?(0,be.jsx)(io,{spaceStore:t}):void 0]})]}),(0,be.jsx)(to,{securitySettingsStore:e,spaceStore:t})]})}function to({securitySettingsStore:e,spaceStore:t}){const n=(0,A().tz)(),{setPage:o}=(0,i.useContext)(Oi().K),s=(0,c().IS)((e=>({button:{paddingTop:3,paddingInlineEnd:0,paddingBottom:0,paddingInlineStart:0,height:"100%"},headerContainer:{marginTop:32}})),[]);return(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)("div",{style:s.headerContainer,children:(0,be.jsx)("span",{style:{fontSize:16,fontWeight:500},children:n.formatMessage(lo.permissionsTitle)})}),(0,be.jsxs)(qi().L,{children:[(0,be.jsx)(qt().p,{style:s.button,onClick:()=>o("people_invitation_settings"),ignoreLocalHoverState:!0,children:(0,be.jsx)(Gi().y,{title:n.formatMessage(lo.membersAndGuestsSettingTitle),byline:n.formatMessage(lo.memberAndGuestsSettingByline),onClick:()=>o("people_invitation_settings"),item:(0,be.jsx)(g().I,{icon:Ui().arrowChevronSingleRightFillSmallIcon,size:"xs",colorVariant:"tertiary"})})}),(0,be.jsx)(oo,{securitySettingsStore:e,spaceStore:t})]})]})}function no({spaceStore:e}){const t=(0,A().tz)(),{setPage:n}=(0,i.useContext)(Oi().K),{requestsSize:o,requestedUserStores:s,totalRequestedUsersSize:a}=function({spaceStore:e,userStoreLimit:t}){const{requests:n,isLoading:i}=(0,Qi().I)({spaceId:e.id});return(0,d().K8)((()=>{let o=0;if(!n)return{requestsSize:o,requestedUserStores:[],totalRequestedUsersSize:0,isLoading:i};const s=new Set;for(const e of Object.values(n)){for(const t of e)s.add(t.created_by_id);o+=e.length}return{requestsSize:o,requestedUserStores:Array.from(s).slice(0,t).map((t=>ve().L.createChildStore(e,{table:V().oo,id:t}))),totalRequestedUsersSize:s.size,isLoading:i}}),[e,n,i,t])}({spaceStore:e,userStoreLimit:Xi}),l=(0,r().v3)();return(0,be.jsx)(Wi().A,{headerText:t.formatMessage(lo.upgradesTitle),mainText:(0,be.jsx)(A().sA,{id:"requestsHomePage.upgradeRequests.pending",defaultMessage:"{requestsSize} pending",values:{requestsSize:o}}),bottom:(0,be.jsx)(ro,{avatarProps:{users:s,totalMemberCount:a},requestsLength:o,pendingText:lo.noPendingRequests}),onClick:()=>{n("upgrades"),(0,Rn().u)({environment:l,event:{eventName:"request_tab_upgrades_clicked",eventProperties:{number_of_requests:o}}})}})}function io({spaceStore:e}){const t=(0,A().tz)(),n=(0,Yi().e6)({spaceStore:e,requestType:"member_or_guest"}),i=new Set;for(const s of n)for(const{actor:e}of s.createdByActorsWithReason)i.add(e.id);const o=[...i].slice(0,Xi).map((t=>ve().L.createChildStore(e,{table:V().oo,id:t})));return(0,be.jsx)(Wi().A,{headerText:t.formatMessage(lo.peoplesTitle),mainText:(0,be.jsx)(A().sA,{id:"requestsHomePage.peopleRequests.pending",defaultMessage:"{requestsSize} pending",values:{requestsSize:n.length}}),bottom:(0,be.jsx)(ro,{avatarProps:n.length?{users:o,totalMemberCount:i.size}:void 0,requestsLength:n.length,pendingText:lo.noGuestOrMemberRequests}),onClick:()=>{_().Ow({currentTab:"members",subtab:"requests"})}})}function oo({securitySettingsStore:e,spaceStore:t}){const n=(0,r().v3)(),i=(0,d().K8)((()=>e.state.disableMemberUpgradeRequests),[e]),o=(0,Mn().lh)({spaceId:t.id}),s=(0,S().eh)(o,"enterprise"),a=s?void 0:{type:"product",product:"enterprise",limit:{type:"none"},trialability:"none"};return(0,be.jsx)(Gi().y,{title:(0,be.jsx)(ao,{upsell:a}),byline:(0,be.jsx)(so,{upsell:a}),item:(0,be.jsx)(Ki().A,{disabled:!s,on:!i,onClick:()=>{zi().X(n,{spaceStore:t,securitySettingsStore:e,fields:{disableMemberUpgradeRequests:!i}})}})})}function so({upsell:e}){const t=(0,A().tz)();return(0,o().X)("upgrade_system_settings")&&e?(0,be.jsx)("div",{style:{marginInlineStart:-4},children:(0,be.jsx)(Zi().R,{display:"text",upsell:e,source:"upgrade_requests_page",size:"small",customMessages:co})}):(0,be.jsx)(be.Fragment,{children:t.formatMessage(lo.purchaseRequestsMemberSettingsByline)})}function ao({upsell:e}){const t=(0,A().tz)(),n=(0,r().v3)(),i=(0,o().X)("upgrade_system_settings");return(0,be.jsxs)(yt().Y1,{direction:"horizontal",gap:4,children:[t.formatMessage(lo.purchaseRequestsMemberSettingsTitle),e&&!i?(0,be.jsx)($i().A,{subscriptionTier:"enterprise",analyticsName:"upgrade_requests_page",onClick:async()=>{await Ot().K(n,{from:"upgrade_requests_page",upsell:e})}}):void 0]})}function ro({avatarProps:e,requestsLength:t,pendingText:n}){const i=(0,A().tz)();return(0,be.jsxs)(Vi().wt,{justifyContent:"end",style:{minHeight:24},children:[e?(0,be.jsx)(Hi().t,{users:e.users,totalMemberCount:e.totalMemberCount,isLoading:!1}):void 0,t?void 0:(0,be.jsx)(Fi().D,{styleKey:"Caption/Regular",colorVariant:"tertiary",children:i.formatMessage(n)})]})}const lo=(0,A().YK)({title:{id:"RequestsSettingsPage.title",defaultMessage:"Requests"},upgradesTitle:{id:"RequestsSettingsPage.UpgradesTileTitle",defaultMessage:"Upgrades"},peoplesTitle:{id:"RequestsSettingsPage.PeopleTileTitle",defaultMessage:"People"},permissionsTitle:{id:"RequestsSettingsPage.permissionsTitle",defaultMessage:"Permissions"},membersAndGuestsSettingTitle:{id:"RequestsSettingsPage.membersAndGuestsSettingTitle",defaultMessage:"Inviting guests and members"},memberAndGuestsSettingByline:{id:"RequestsSettingsPage.memberAndGuestsSettingByline",defaultMessage:"Configure who can send and approve member additions"},purchaseRequestsMemberSettingsTitle:{id:"RequestsSettingsPage.purchaseRequestsMemberSettingsTitle",defaultMessage:"Allow members to request upgrades"},purchaseRequestsMemberSettingsByline:{id:"RequestsSettingsPage.purchaseRequestsMemberSettingsByline",defaultMessage:"Users in your workspace can send purchase requests to the workspace owner"},noPendingRequests:{id:"RequestsSettingsPage.upgradeRequests.noPendingRequests",defaultMessage:"No upgrade requests"},noGuestOrMemberRequests:{id:"RequestsSettingsPage.peopleRequests.noGuestOrMemberRequests",defaultMessage:"No guest or member requests"}}),co=(0,A().YK)({eligible_for_upgrade:{id:"RequestHomePage.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to control whether users can send purchase requests to the workspace owner"},eligible_for_trial:{id:"RequestHomePage.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to control member upgrade requests"},sales_eligible:{id:"RequestHomePage.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to control member upgrade requests"},sales_assisted:{id:"RequestHomePage.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to control member upgrade requests"},eligible_to_request:{id:"RequestHomePage.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to control member upgrade requests"},request_pending:{id:"RequestHomePage.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to control member upgrade requests"}});var uo=()=>n(638743);function po({spaceStore:e}){const t=(0,A().tz)(),{setPage:n}=(0,i.useContext)(Oi().K);return(0,be.jsxs)(yt().Y1,{height:"fill",direction:"vertical",gap:16,padding:"36px 60px",children:[(0,be.jsx)(Ji().n,{title:t.formatMessage(mo.title),goBack:()=>n("home")}),(0,be.jsx)(go,{spaceStore:e})]})}function go({spaceStore:e}){const t=(0,d().uB)(void 0,fi().A);(0,l().w)((()=>{const n=t.getValueForSpace(e);n&&t.setState(n)}));const{organizationOverrides:n}=(0,uo().n)({spaceId:e.id});return(0,be.jsx)(Hn,{securitySettingsStore:t,spaceStore:e,organizationOverrides:n})}const mo=(0,A().YK)({title:{id:"RequestsSettingPage.PeopleInvitationSettings.title",defaultMessage:"Inviting guests and members"}});var fo=()=>n(210198);function ho({spaceStore:e,securitySettingsStore:t}){const n=(0,d().K8)((()=>"requests"===At().A.state.currentTab&&At().A.state.defaultSubtab||"home"),[]),[o,s]=(0,i.useState)(n),a=(0,Ni().t)();return(0,be.jsx)(Oi().K.Provider,{value:{currentPage:o,setPage:s,isSalesEligible:a},children:(0,be.jsx)(vo,{securitySettingsStore:t,spaceStore:e})})}function vo({spaceStore:e,securitySettingsStore:t}){const{currentPage:n}=(0,i.useContext)(Oi().K);switch(n){case"home":return(0,be.jsx)(eo,{securitySettingsStore:t,spaceStore:e});case"people_invitation_settings":return(0,be.jsx)(po,{spaceStore:e});case"upgrades":return(0,be.jsx)(fo().Z,{spaceStore:e});default:return null}}var yo=()=>n(749240),bo=()=>n(208603);const So={VerifiedPagesSettings:new($e().O2)("VerifiedPagesSettings",(()=>Promise.all([n.e(79421),n.e(16006)]).then(n.bind(n,541616))))},xo=(0,$e()._h)(So.VerifiedPagesSettings,(e=>e.VerifiedPagesSettings));var Ao=()=>n(710967),Mo=()=>n(404302),wo=()=>n(495427),jo=()=>n(249847);var ko=()=>n(701144),Io=()=>n(837503),Co=()=>n(518658),To=()=>n(459173),_o=()=>n(497799),Po=()=>n(223544);function Bo({spaceStore:e,sharedWithFilterItems:t,setSharedWithFilter:n,runNewSearch:o,includeGroups:s,includeGuests:a}){const r=(0,_o().H)({spaceStore:e}),l=(0,i.useMemo)((()=>r.loading?[]:a?[...r.members,...r.guests]:r.members),[r,a]),d=(0,i.useMemo)((()=>r.loading?new Set:new Set(r.guests.map((e=>e.id)))),[r]);return(0,be.jsx)(Po().Jo,{isMultiSelect:!0,includePermissionGroups:s,userStores:l,title:(0,be.jsx)(A().sA,{id:"adminContentSearchTab.pagesTable.filters.sharedWith.title",defaultMessage:"Shared with"}),selectedItems:t??[],setSelectedItems:function(e){const t=e.map((({id:e,type:t})=>({type:t,id:e})));n(t.length>0?t:void 0)},onMenuClose:o,guestUserIdSet:d,includeGuests:a})}var Do=()=>n(333046);function Ro({spaceStore:e,filters:t,runNewSearch:n,setFilters:o,hasUserConfirmedAcknowledgement:s}){const a=function(e){const[t,n]=(0,i.useState)([]),o=(0,r().v3)(),s=(0,d().K8)((()=>(null==e?void 0:e.spaceStore)??di().default.state.sidebarSpaceStore),[null==e?void 0:e.spaceStore]),a=(0,jo().T)();return(0,i.useEffect)((()=>{!async function(){const e=await(0,An().S)({spaceStore:s,currentUserId:a,includeArchived:!1,minRoleOnTeamStores:"editor",environment:o});n(e)}()}),[s,a,o]),t}(),l=(0,c().IS)((e=>({container:{margin:"0 auto 14px"},filterPillsContainer:{width:"100%",display:"flex",flexWrap:"wrap",rowGap:4,flexDirectionRow:"row",alignItemsCenter:"center"}})),[]);return(0,be.jsxs)("div",{style:l.container,children:[(0,be.jsx)(wo().nv,{mode:wo().Ke.Button,query:t.query,setQueryFilter:function(e){o({query:e},{runSearchAfter:!0})},disabled:!s}),s?(0,be.jsxs)("div",{style:l.filterPillsContainer,children:[(0,be.jsx)(To().MC,{spaceStore:e,selectedPageStatus:t.pageStatus,setSelectedPageStatus:function(e){o({pageStatus:e})},onMenuClose:n}),(0,be.jsx)(Co().Z,{lastEditedTime:t.lastEditedTime,createdTime:t.createdTime,setLastEditedTime:function(e){o({lastEditedTime:e,createdTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})},setCreatedOnTime:function(e){o({createdTime:e,lastEditedTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})}}),(0,be.jsx)(Do().j,{selectedTeamIds:t.teamIds,setSelectedTeamIds:function(e){o({teamIds:e})},onMenuClose:n,teamStores:a}),(0,be.jsx)(Bo,{spaceStore:e,sharedWithFilterItems:t.sharedWith,setSharedWithFilter:function(e){o({sharedWith:e})},runNewSearch:n,includeGroups:!0,includeGuests:!0}),(0,be.jsx)(ko().tE,{selectedAudience:t.audience,setSelectedAudience:function(e){o({audience:e})},onMenuClose:n,audienceValues:Mo().p}),(0,be.jsx)(Io().Q,{spaceStore:e,createdByFilterIds:t.createdBy,setCreatedByFilter:function(e){o({createdBy:e})},runNewSearch:n,includeGuests:!0})]}):null]})}var Eo=()=>n(274570),Lo=()=>n(474747);function Oo(e){const{query:t,setQuery:n,queryPlaceholder:o,spaceStore:s,createdByIds:a,setCreatedByIds:r,createdTime:l,setCreatedOnTime:d,lastEditedTime:u,setLastEditedTime:p,sharedWith:g,setSharedWith:m,lastActivityTime:f,setLastActivityTime:h,status:v=[],setStatus:y}=e,b=(0,c().IS)((()=>({container:{display:"flex",flexDirection:"column",gap:10},filterPillsContainer:{display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"}})),[]),S=(0,i.useMemo)((()=>new Set(["active","disabled","deleted"])),[]);return(0,be.jsxs)("div",{style:b.container,children:[(0,be.jsx)(wo().nv,{mode:wo().Ke.Button,query:t,setQueryFilter:n,placeholderText:o}),(0,be.jsxs)("div",{style:b.filterPillsContainer,children:[(0,be.jsx)(Bo,{spaceStore:s,sharedWithFilterItems:g,setSharedWithFilter:e=>m(e),runNewSearch:()=>{},includeGroups:!0,includeGuests:!0}),(0,be.jsx)(Io().Q,{spaceStore:s,createdByFilterIds:a,setCreatedByFilter:r,includeGuests:!0}),(0,be.jsx)(Co().Z,{lastEditedTime:u,createdTime:l,setLastEditedTime:p,setCreatedOnTime:d}),(0,be.jsx)(ae().A,{mode:re().C.Pill,focused:!1,hideTime:!0,pillTitle:"Last activity",title:"Last activity",icon:Eo().clockIcon,value:f,showButtons:"footer",onChange:e=>{h(e)}}),(0,be.jsx)(Lo().A,{allOptions:S,selectedOptions:v,setSelectedOption:y,getFormattedStringTitle:e=>e,getFormattedStringCaption:()=>"",getPillTitle:e=>e.length?e.join(", "):"Status",pillIcon:Eo().clockIcon})]})]})}var No=()=>n(396896),Fo=()=>n(98126),Uo=()=>n(907514),zo=()=>n(388821);const Ko=new(n(391685).n)(((e,{spaceId:t,query:n="",createdByIds:i=[],createdTimeFrom:o,createdTimeTo:s,lastEditedTimeFrom:a,lastEditedTimeTo:r,sharedWithUserIds:l=[],sharedWithGroupIds:d=[],lastActivityFrom:c,lastActivityTo:u,status:p=[]})=>[t,n,i.join(","),`${o??""}-${s??""}`,`${a??""}-${r??""}`,l.join(","),d.join(","),`${c??""}-${u??""}`,p.join(",")].join("::")),(async(e,t)=>{const{spaceId:i,query:o,createdByIds:s=[],createdTimeFrom:a,createdTimeTo:r,lastEditedTimeFrom:l,lastEditedTimeTo:d,sharedWithUserIds:c=[],sharedWithGroupIds:u=[],lastActivityFrom:p,lastActivityTo:g,status:m=[]}=t,f=(o??"").trim(),h=await Promise.resolve().then(n.bind(n,559506)),v=await h.callApi({eventName:"workspaceOwnerSearchAgents",environment:e,data:{spaceId:i,query:f,createdByIds:s,createdTimeFrom:a,createdTimeTo:r,lastEditedTimeFrom:l,lastEditedTimeTo:d,sharedWithUserIds:c,sharedWithGroupIds:u,lastActivityFrom:p,lastActivityTo:g,status:m}});if("success"!==v.type)return;const y=zo().RecordMapWithRole.create(v.data.recordMap),b=zo().RecordMapWithRole.create();for(const{pointer:n,model:j}of y)j&&b.setModelAndRole(n,j,"editor");const S=new(n(221844).A)({name:n(223116).a9,data:new(n(445120).b)});S.data.getUserRecordMap(e.currentUser.id).assign(b),S.addCacheFallback(e.defaultRecordCache.inMemoryRecordCache);const x=v.data.agentIds.map((t=>n(842677).RecordStores.createUniqueRootStore(e,{table:n(743246).C0,id:t,spaceId:i},{inMemoryRecordCache:S}))),A={};for(const n of v.data.mostRecentTranscripts)A[n.parent_id]=Number(n.created_time);const M={},w=new Map((v.data.meta??[]).map((e=>[e.id,e])));for(const n of x){const e=w.get(n.id);M[n.id]={createdTime:(null==e?void 0:e.created_time)??n.getCreatedTime(),lastEditedTime:(null==e?void 0:e.last_edited_time)??n.getLastEditedTime(),createdById:(null==e?void 0:e.created_by_id)??n.getCreatedById(),lastEditedById:(null==e?void 0:e.last_edited_by_id)??n.getLastEditedById(),name:(null==e?void 0:e.name)??n.getName(),icon:(null==e?void 0:e.icon)??n.getIcon()}}return{value:{agents:x,lastActivityByWorkflowId:A,metaByWorkflowId:M},dependencies:v.data.dependencies}}));var Vo=()=>n(625383),qo=(n(814603),n(147566),n(198721),()=>n(742852));const Wo={viewBox:"0 0 20 20",fittedViewBox:"3.12 3.12 13.75 13.75",svg:(0,be.jsx)("path",{d:"M3.125 5.25c0-1.174.951-2.125 2.125-2.125h9.5c1.174 0 2.125.951 2.125 2.125v9.5a2.125 2.125 0 0 1-2.125 2.125h-9.5a2.125 2.125 0 0 1-2.125-2.125zm2.125-.875a.875.875 0 0 0-.875.875v9.5c0 .483.392.875.875.875h9.5a.875.875 0 0 0 .875-.875v-9.5a.875.875 0 0 0-.875-.875z"})},Go=(0,v().wt)("mediaStop",Wo);var Ho=()=>n(735790),Yo=()=>n(496703),$o=()=>n(904671),Qo=()=>n(482707),Zo=()=>n(722872),Jo=()=>n(437487),Xo=()=>n(463830),es=()=>n(529183),ts=()=>n(454354),ns=()=>n(177097),is=()=>n(760217),os=()=>n(404277),ss=()=>n(939740),as=()=>n(621841);function rs(e){var t,n;const i=(null===(t=e.getDraftData())||void 0===t?void 0:t.triggers)||[],o=(null===(n=e.getData())||void 0===n?void 0:n.triggers)||[];return i.length>0?i:o}function ls({workflowStore:e,spaceId:t,query:n}){const o=(0,r().v3)(),s=(0,A().tz)(),a=(0,d().uB)(void 0,Xo().A),[l,c]=(0,i.useState)(!1),u=(0,d().uB)(void 0,es().Ay),p=(0,d().uB)(void 0,ts().A),m=(0,d().O$)(di().AppStoreSidebarSpaceStore),f=(0,d().K8)((()=>{const t=p.state.privateWorkflowStore;return t&&t.id===e.id?t:e}),[p,e]),h=(0,d().K8)((()=>function(e){return rs(e).some((e=>e.enabled))}(e)),[e]),v=(0,i.useCallback)((async()=>{const i=t||e.getSpaceId();i&&(await q().callApi({eventName:"disableWorkflow",environment:o,data:{workflowId:e.id,spaceId:i}}),await Ko.resetData(o,{spaceId:i,query:n}))}),[o,e,t,n]),y=(0,i.useCallback)((async()=>{const t=new URL((0,Yo().L)({workflowId:e.id,params:{}}),window.location.origin).href,n=await Be().R.clipboardActions.load();await n.copyString({environment:o,stringValue:t,copiedMessage:n.clipboardMessages.copiedLinkToClipboard})}),[o,e.id]),b=(0,i.useCallback)((async()=>{const{accept:t}=await T().Gh({message:s.formatMessage({id:"adminContentSearchTab.agentsTable.delete.confirm",defaultMessage:"Delete this agent?"}),acceptLabel:s.formatMessage({id:"workflows.agentTopbar.deleteAcceptLabel",defaultMessage:"Delete"})});t&&await ns().softDeleteWorkflow({environment:o,workflowStore:e})}),[o,e,s]),S=(0,be.jsx)(os().A,{menuType:Zo().gu.Popup,width:256,children:(0,be.jsx)(ss().Ay,{type:ss().Oh.Vertical,initialFocus:void 0,sections:[{key:0,render:({children:e})=>e,items:[{key:"change-permissions",render:e=>(0,be.jsx)(is().A,{icon:(0,be.jsx)(g().I,{icon:Ho().M}),title:(0,be.jsx)(A().sA,{id:"adminContentSearchTab.agentsTable.actions.changePermissions",defaultMessage:"Change permissions"}),...e}),action:async()=>{p.setState({...p.state,changePermissionsEnabled:!0}),!m||p.state.privateWorkflowStore&&p.state.privateWorkflowStore.id===e.id||await $o().YL({environment:o,sudoModeStore:p,workflowId:e.id,sidebarSpaceStore:m}),c(!0)}},...h?[{key:"disable-workflow",render:e=>(0,be.jsx)(is().A,{icon:(0,be.jsx)(g().I,{icon:Go}),title:(0,be.jsx)(A().sA,{id:"adminContentSearchTab.agentsTable.actions.disableTriggers",defaultMessage:"Disable triggers"}),...e}),action:v}]:[],{key:"copy-link",render:e=>(0,be.jsx)(is().A,{icon:(0,be.jsx)(g().I,{icon:qo().linkIcon}),title:(0,be.jsx)(A().sA,{id:"workflows.agentTopbar.copyLink",defaultMessage:"Copy link"}),...e}),action:y},{key:"delete",render:e=>(0,be.jsx)(is().A,{isRedOnHover:!0,icon:(0,be.jsx)(g().I,{icon:Gt().trashIcon}),title:(0,be.jsx)(A().sA,{id:"workflows.agentTopbar.deleteAgent",defaultMessage:"Delete agent"}),...e}),action:b}]}]})});return(0,be.jsx)(as().j,{onClose:()=>{c(!1),Jo().Ay.reset()},originAriaLabel:s.formatMessage({id:"adminContentSearchTab.agentsTable.actions.more",defaultMessage:"More actions for agent"}),popupStore:a,render:()=>l?(0,be.jsx)(Qo().k,{store:f,inviteTargetsStore:u,sudoModeStore:p,location:"admin_content_search"}):S,useShareMenuStyles:l})}n(944114),n(672577),n(908872);var ds=()=>n(68263),cs=()=>n(605402),us=()=>n(737309);const ps=(0,A().YK)({sharedWithMembers:{id:"adminContentSearchTab.agentsTable.sharedWith.members",defaultMessage:"{numMembers, plural, one {# member} other {# members}}"},sharedWithGroups:{id:"adminContentSearchTab.agentsTable.sharedWith.groups",defaultMessage:"{numGroups, plural, one {# group} other {# groups}}"},sharedWithGuests:{id:"adminContentSearchTab.agentsTable.sharedWith.guests",defaultMessage:"{numGuests, plural, one {# guest} other {# guests}}"},separator:{id:"adminContentSearchTab.agentsTable.sharedWith.separator",defaultMessage:", "}});function gs({workflowStore:e,ownerUserId:t}){const i=(0,A().tz)(),{summary:o,items:s}=(0,d().K8)((()=>{const o=e.getPermissionItems()||[],s=o.find((e=>"space_permission"===e.type)),a=cs().A.state.permissionGroupsAndMemberCounts.map((e=>e.group)),r=[];for(const e of o)if((0,ds().Ds)(e)){const t=a.find((t=>t.group_id===e.group_id));t&&e.role&&r.push({group:t,role:e.role})}const[l,d]=o.filter(ds().B2).reduce(((t,n)=>{const i=(0,pt().sE)(e.getSpaceStore(),n.user_id);return Boolean(i&&!i.isMember())?[[...t[0],n],t[1]]:[t[0],[...t[1],n]]}),[[],[]]),c=[];if(d.length>0&&c.push(i.formatMessage(ps.sharedWithMembers,{numMembers:d.length})),r.length>0&&c.push(i.formatMessage(ps.sharedWithGroups,{numGroups:r.length})),l.length>0&&c.push(i.formatMessage(ps.sharedWithGuests,{numGuests:l.length})),0===c.length){const n=e.getCreatedById()??t;if(n){const t=(0,pt().sE)(e.getSpaceStore(),n),o=Boolean(t&&!t.isMember());c.push(o?i.formatMessage(ps.sharedWithGuests,{numGuests:1}):i.formatMessage(ps.sharedWithMembers,{numMembers:1}))}}const u=c.length>0?c.join(i.formatMessage(ps.separator)):i.formatMessage({id:"adminContentSearchTab.agentsTable.sharedWith.nobody",defaultMessage:"Nobody"});let p=[...s?[{key:"space-permission",render:e=>(0,be.jsx)(n(210216).N,{...e,permissionItem:s}),action:()=>{}}]:[],...r.map((({group:e,role:t})=>({key:e.group_id,render:i=>(0,be.jsx)(n(864223)._,{...i,name:e.name,icon:e.icon,role:t}),action:()=>{}}))),...d.map((e=>({key:e.user_id,render:t=>(0,be.jsx)(us().m,{...t,userId:e.user_id,role:e.role}),action:()=>{}}))),...l.map((e=>({key:e.user_id,render:t=>(0,be.jsx)(us().m,{...t,userId:e.user_id,role:e.role,isGuest:!0}),action:()=>{}})))];if(0===p.length){const n=e.getCreatedById()??t;if(n){const t=(0,pt().sE)(e.getSpaceStore(),n),i=Boolean(t&&!t.isMember()),o="editor";p=[{key:`owner-${n}`,render:e=>(0,be.jsx)(us().m,{...e,userId:n,role:o,isGuest:i}),action:()=>{}}]}}return{summary:u,items:p}}),[e,i,t]);return(0,be.jsx)(n(75491).ED,{title:o,items:s,disabled:0===s.length})}function ms({workflowStore:e}){const t=(0,d().K8)((()=>function(e){return rs(e).filter((e=>e.enabled)).length}(e)),[e])>0;return(0,be.jsx)(Ee().A,{isSecondaryColor:!0,children:t?(0,be.jsx)(A().sA,{id:"adminContentSearchTab.agentsTable.status.active",defaultMessage:"Active"}):(0,be.jsx)(A().sA,{id:"adminContentSearchTab.agentsTable.status.disabled",defaultMessage:"Triggers disabled"})})}var fs=()=>n(317131);function hs({store:e,userIds:t,isClickable:n}){const i=(0,d().K8)((()=>t.map((t=>ve().L.createChildStore(e,{table:V().oo,id:t})))),[e,t]);return(0,be.jsx)(fs().l,{userStores:i,isClickable:n})}var vs=()=>n(622936),ys=()=>n(233692),bs=()=>n(860864);function Ss({store:e,rightIcon:t,serverName:n,serverIcon:i}){const o=(0,A().tz)(),{name:s,icon:a}=(0,d().K8)((()=>{const t=(0,ys().m)(e,n||o.formatMessage({id:"workflow.emptyWorkflowTitle",defaultMessage:"Untitled agent"}));return{name:t.name,icon:i||t.icon}}),[e,o,n,i]);return(0,be.jsx)(bs().dX,{mainIcon:(0,be.jsx)(vs().AgentIcon,{agentIcon:a,workflowStore:e,size:20}),title:s,rightIcon:t,useThinTitle:!1})}const xs={id:"agent",headerTitle:(0,be.jsx)(A().sA,{id:"adminContentSearchTab.agentsTable.agent.name",defaultMessage:"Agent"}),renderCell:e=>(0,be.jsx)(Ss,{store:e.workflowStore,serverName:e.name,serverIcon:e.icon}),widthData:{width:320,maxWidth:320},sortable:!1},As={id:"lastActivity",headerTitle:(0,be.jsx)(A().sA,{id:"adminContentSearchTab.agentsTable.lastActivity.name",defaultMessage:"Last activity"}),renderCell:e=>(0,be.jsx)(Ee().A,{isSecondaryColor:!0,children:e.lastActivity??"â€”"}),widthData:{width:120},sortable:!1},Ms={id:"createdBy",headerTitle:(0,be.jsx)(A().sA,{id:"adminContentSearchTab.agentsTable.createdBy.name",defaultMessage:"Created by"}),renderCell:e=>e.createdById?(0,be.jsx)(hs,{store:e.workflowStore,userIds:[e.createdById]}):null,widthData:{width:140},sortable:!1},ws={id:"createdTime",headerTitle:(0,be.jsx)(A().sA,{id:"adminContentSearchTab.agentsTable.createdTime.name",defaultMessage:"Created on"}),renderCell:e=>(0,be.jsx)(Vo().d,{dateTs:e.createdTime}),widthData:{width:140},sortable:!1},js={id:"lastEditedBy",headerTitle:(0,be.jsx)(A().sA,{id:"adminContentSearchTab.agentsTable.lastEditedBy.name",defaultMessage:"Last edited by"}),renderCell:e=>e.lastEditedById?(0,be.jsx)(hs,{store:e.workflowStore,userIds:[e.lastEditedById]}):null,widthData:{width:140},sortable:!1},ks={id:"lastEditedTime",headerTitle:(0,be.jsx)(A().sA,{id:"adminContentSearchTab.agentsTable.lastEditedTime.name",defaultMessage:"Last edited on"}),renderCell:e=>(0,be.jsx)(Vo().d,{dateTs:e.lastEditedTime}),widthData:{width:140},sortable:!1},Is={id:"status",headerTitle:(0,be.jsx)(A().sA,{id:"adminContentSearchTab.agentsTable.status.name",defaultMessage:"Status"}),renderCell:e=>(0,be.jsx)(ms,{workflowStore:e.workflowStore}),widthData:{width:140},sortable:!1},Cs={id:"sharedWith",headerTitle:(0,be.jsx)(A().sA,{id:"adminContentSearchTab.agentsTable.sharedWith.name",defaultMessage:"Shared with"}),renderCell:e=>(0,be.jsx)(gs,{workflowStore:e.workflowStore,ownerUserId:e.createdById}),widthData:{width:180},sortable:!1};function Ts(e){const{spaceStore:t,searchQuery:n,createdByIds:o=[],createdTime:s,lastEditedTime:a,sharedWith:l,lastActivityTime:u,status:p=[]}=e,g=(0,r().v3)(),m=(0,d().K8)((()=>{if(!t.id)return;const e=e=>{if(null==e||!e.start_date)return;return N().C6.notionDateTimeToLuxon(e,"en").toMillis()},i=e(null==s?void 0:s.starting),r=e(null==s?void 0:s.ending),d=e(null==a?void 0:a.starting),c=e(null==a?void 0:a.ending),m=e(null==u?void 0:u.starting),f=e(null==u?void 0:u.ending);return Ko.getData(g,{spaceId:t.id,query:n,createdByIds:o,createdTimeFrom:i,createdTimeTo:r,lastEditedTimeFrom:d,lastEditedTimeTo:c,sharedWithUserIds:(null==l?void 0:l.filter((e=>"user"===e.type)).map((e=>e.id)))??[],sharedWithGroupIds:(null==l?void 0:l.filter((e=>"permission_group"===e.type)).map((e=>e.id)))??[],lastActivityFrom:m,lastActivityTo:f,status:p})}),[g,t,n,o,s,a,l,u,p]),f=void 0===m,h=(0,d().K8)((()=>{const e=null==m?void 0:m.agents,t=(null==m?void 0:m.lastActivityByWorkflowId)||{},n=(null==m?void 0:m.metaByWorkflowId)||{};if(!e)return[];const i=e=>{const t=Number(e);return!Number.isFinite(t)||t<=0?0:t<1e12?1e3*t:t};return e.map((e=>{const o=i(t[e.id]),s=o?(0,Uo().nl)(o,{useUltraCompactFormat:!0}):void 0,a=n[e.id];return{id:e.id,isClickable:!1,workflowStore:e,createdTime:i((null==a?void 0:a.createdTime)??e.getCreatedTime()),lastEditedTime:i((null==a?void 0:a.lastEditedTime)??e.getLastEditedTime()),createdById:(null==a?void 0:a.createdById)??e.getCreatedById(),lastEditedById:(null==a?void 0:a.lastEditedById)??e.getLastEditedById(),lastActivity:s,name:null==a?void 0:a.name,icon:null==a?void 0:a.icon}}))}),[m]),v=(0,i.useMemo)((()=>({...xs,renderCell:e=>(0,be.jsx)(Ss,{store:e.workflowStore,rightIcon:(0,be.jsx)(ls,{workflowStore:e.workflowStore,spaceId:e.workflowStore.getSpaceId(),query:n}),serverName:e.name,serverIcon:e.icon})})),[n]),y=(0,i.useMemo)((()=>[v,As,Ms,ws,js,ks,Is,Cs]),[v]),b=(0,c().IS)((e=>(0,De().rC)({columnRenderInfo:y,theme:e,containerMarginTop:0})),[y]);return(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(De().WE,{hideHeaderRowPadding:!0,allowHorizontalScroll:!0,setStickyHeaderRow:!0,columnRenderInfo:y,rows:h,renderNoRowsComponent:()=>(0,be.jsx)(Ee().A,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:(0,be.jsx)(A().sA,{id:"adminContentSearchTab.agentsTable.empty",defaultMessage:"No agents found."})}),styles:b}),f?(0,be.jsx)(No().fI,{justifyContent:"center",children:(0,be.jsx)(Fo().A,{style:{margin:"24px auto 24px"}})}):null]})}function _s({spaceStore:e,filters:t,numRecordStores:n,hasUserConfirmedAcknowledgement:i,isCustomAgentsEnabled:o}){const s=(0,d().K8)((()=>e.getName()),[e]);return(0,be.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:24},children:[(0,be.jsx)(Ee().A,{isMultiline:!0,style:{marginBottom:20},isSecondaryColor:!0,children:(0,be.jsx)(A().sA,{...o?Bs.descriptionDataRetentionPolicyAgents:Bs.descriptionDataRetentionPolicy,values:{workspaceName:s,b:e=>(0,be.jsx)("b",{children:e}),link:e=>(0,be.jsx)(zn().A,{onClick:()=>At().A.setState({openedFrom:"content_search",open:!0,currentTab:"security",highlightedSetting:void 0,defaultSubtab:"data_retention"}),children:e})}})}),(0,be.jsx)(Ao().t,{spaceId:e.id,disabled:0===n||!i,filters:t})]})}const Ps=function({spaceStore:e,userStore:t}){const s=(0,r().v3)(),[a,l]=(0,i.useState)("pages"),[c,u]=(0,i.useState)(""),p=(0,Le().ke)(),g=(0,o().X)("admin_agents_content_search_tab"),m=p&&g,f=(0,A().tz)().formatMessage(Bs.agentsSearchPlaceholder);(0,i.useEffect)((()=>{m||"agents"!==a||l("pages")}),[m,a]);const h=(0,d().K8)((()=>{const e=di().default.state.sidebarSpaceViewStore,t=null==e?void 0:e.getSettings();return(null==t?void 0:t.admin_content_search_acknowledgement)??!1}),[]),{showSuggestions:v,loadNextPage:y,recordStores:b,loading:S,error:x,runNewSearch:M,filters:w,setFilters:j,refreshSearchResult:k}=(0,n(583521).p)({spaceStore:e,userStore:t,hasUserConfirmedAcknowledgement:h}),I=(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(Ro,{spaceStore:e,runNewSearch:M,setFilters:j,filters:w,hasUserConfirmedAcknowledgement:h}),(0,be.jsx)(n(641447).r,{loading:S,error:x,recordStores:b,loadNextPage:y,filters:w,setFilters:j,showSuggestions:v,runNewSearch:M,hasUserConfirmedAcknowledgement:h,refreshSearchResult:k})]}),[C,T]=(0,i.useState)([]),[_,P]=(0,i.useState)({starting:void 0,ending:void 0}),[B,D]=(0,i.useState)({starting:void 0,ending:void 0}),[R,E]=(0,i.useState)(),[L,O]=(0,i.useState)({starting:void 0,ending:void 0}),[N,F]=(0,i.useState)(["active","disabled"]),U=(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(Oo,{query:c,setQuery:u,queryPlaceholder:f,spaceStore:e,createdByIds:C,setCreatedByIds:T,createdTime:_,setCreatedOnTime:P,lastEditedTime:B,setLastEditedTime:D,sharedWith:R,setSharedWith:E,lastActivityTime:L,setLastActivityTime:O,status:N,setStatus:F}),(0,be.jsx)(Ts,{spaceStore:e,searchQuery:c,createdByIds:C,createdTime:_,lastEditedTime:B,sharedWith:R,lastActivityTime:L,status:N})]}),z=m?[(0,be.jsx)(A().sA,{id:"adminContentSearchTab.subtab.pages",defaultMessage:"Pages"},"pages"),(0,be.jsx)(A().sA,{id:"adminContentSearchTab.subtab.agents",defaultMessage:"Agents"},"agents")]:[(0,be.jsx)(A().sA,{id:"adminContentSearchTab.subtab.pages",defaultMessage:"Pages"},"pages")],K="pages"===a?0:1;return(0,be.jsxs)(St().Ay,{children:[(0,be.jsx)(Ie().A,{large:!s.device.isMobile||void 0,divider:s.device.isMobile?void 0:"full",children:(0,be.jsx)(A().sA,{id:"adminContentSearchTab.title",defaultMessage:"Content search"})}),(0,be.jsx)(_s,{spaceStore:e,numRecordStores:b.length,filters:w,hasUserConfirmedAcknowledgement:h,isCustomAgentsEnabled:m}),m?(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)("div",{style:{marginTop:8,marginBottom:14},children:(0,be.jsx)(xt().Ay,{tabs:z,selectedIndex:K,onChange:e=>l(0===e?"pages":"agents")})}),"pages"===a?I:U]}):I]})},Bs=(0,A().YK)({descriptionDataRetentionPolicy:{id:"adminContentSearchTab.description.dataRetentionPolicy",defaultMessage:"Workspace owners can search for any page in <b>{workspaceName}</b>. This includes private pages and deleted pages retained per the <link>data retention policy</link>"},descriptionDataRetentionPolicyAgents:{id:"adminContentSearchTab.description.dataRetentionPolicy.agents",defaultMessage:"Workspace owners can search for any page or agent in <b>{workspaceName}</b>. This includes private pages and agents, and deleted pages retained per the <link>data retention policy</link>"},agentsSearchPlaceholder:{id:"adminContentSearchTab.agentsTable.filters.query.placeholder",defaultMessage:"Search by agent name"}});var Ds=()=>n(866893),Rs=()=>n(96689),Es=()=>n(908928),Ls=()=>n(515402),Os=()=>n(949237),Ns=()=>n(40851),Fs=()=>n(870897),Us=()=>n(251126),zs=()=>n(378765);const Ks=function({spaceStore:e,userStore:t,organizationOverrides:o}){const s=(0,r().v3)(),a=(0,d().uB)(void 0,Ns().A),{device:l}=s,c=(0,d().K8)((()=>(0,n(511393).h)(s)),[s]);return(0,i.useEffect)((()=>{c||_().Ow({currentTab:"members"})}),[c]),c?(0,be.jsxs)(St().Ay,{children:[(0,be.jsx)(Ie().A,{large:!l.isMobile||void 0,fontSize:l.isMobile?void 0:16,fontWeight:w().Wy.medium,divider:"none",style:{paddingBottom:8,marginBottom:16},children:(0,be.jsx)(A().sA,{id:"spaceConnectionsSettings.title",defaultMessage:"Connections"})}),(0,be.jsx)(qs,{spaceStore:e,userStore:t,requestStore:a,organizationOverrides:o})]}):null};function Vs({error:e,result:t,ready:n,organizationOverrides:i}){return(0,d().O$)(di().AppStoreSidebarSpaceStore)?(0,be.jsxs)(zs().A,{loaded:n,spinnerSize:"sm",showSpinnerTimeout:600,children:[e?(0,be.jsx)("div",{children:(0,be.jsx)(A().sA,{id:"spaceIntegrationSettings.error",defaultMessage:"Something went wrongâ€¦"})}):void 0,t?(0,be.jsx)(Fs().Ay,{...t,organizationOverrides:i}):void 0]}):null}function qs({spaceStore:e,userStore:t,requestStore:n,organizationOverrides:i}){const o=(0,r().v3)(),s=(0,d().uB)(n,Ns().A);return(0,be.jsx)(Us().A,{requestStore:s,request:{spaceId:e.id,userId:t.id},performRequest:async e=>async function({spaceId:e},t){return{guestBotIds:(await Promise.all([Es().Ju({environment:t,table:Rs().NX,id:e,type:"guest"}),Es().Ju({environment:t,table:Rs().NX,id:e,type:"external"}),Os().oX({environment:t}),Ls().g({environment:t})]))[0].botIds}}(e,o),render:(e,t,n)=>(0,be.jsx)(Vs,{error:e,result:t,ready:n,organizationOverrides:i})})}var Ws=()=>n(313633),Gs=()=>n(802790),Hs=()=>n(297872),Ys=()=>n(187174);async function $s(e){var t;const{environment:n,spaceId:i,store:o}=e;if(!(await(0,zt().Se)(n,{name:"saml",spaceId:i,userId:null===(t=di().default.state.currentUserStore)||void 0===t?void 0:t.id})))return o.reset(),{};const s=await q().callApi({eventName:"getSamlConfigForSpace",environment:n,data:{spaceId:i}});if("failed"===s.type)T().Qg(s);else if(s.data&&s.data.samlConfig){const e={...s.data.samlConfig,useMetadataUrl:!Boolean(s.data.samlConfig.idpMetadata)};return o.setState(e),s.data}return o.reset(),{}}const Qs=(0,i.createContext)(null);function Zs({spaceStore:e,samlConfigStore:t,domainSettingsStore:n,children:i}){const{loading:o,error:s,loaded:a}=function({spaceStore:e,samlConfigStore:t,domainSettingsStore:n}){const i=(0,r().v3)(),[{status:o,error:s}]=(0,Ys().Yb)((async()=>{const o=await $s({environment:i,spaceId:e.id,store:t});return(0,F().US)(o)?o:o.samlConfig?{samlResponse:o,domainResponse:await n.updateValueForSpace({environment:i,spaceId:e.id,store:n})}:{samlResponse:o,domainResponse:void 0}}),[i,t,e,n]);return{loading:"pending"===o,loaded:"resolved"===o,error:s}}({spaceStore:e,samlConfigStore:t,domainSettingsStore:n}),l={loadingSaml:o,errorSaml:s,loadedSaml:a};return(0,be.jsx)(Qs.Provider,{value:l,children:i})}var Js=()=>n(177167),Xs=()=>n(10984),ea=()=>n(179030),ta=()=>n(526669),na=()=>n(511303);function ia({title:e,byline:t,targetTier:n,customMessages:s}){const a=(0,r().v3)(),l=(0,o().X)("upgrade_system_settings"),d=i.useMemo((()=>({type:"product",product:n,limit:{type:"none"},trialability:"none"})),[n]),c=(0,i.useCallback)((()=>Ot().K(a,{from:"space_saml",upsell:d})),[a,d]);return(0,be.jsxs)(be.Fragment,{children:[(0,be.jsxs)(Ie().A,{style:{fontWeight:w().Wy.regular,display:"flex",alignItems:"center",marginBottom:0},children:[(0,be.jsx)("span",{style:{marginInlineEnd:8},children:e}),l?void 0:(0,be.jsx)($i().A,{subscriptionTier:n,analyticsName:"space_saml",onClick:c})]}),l?(0,be.jsx)("div",{style:{marginInlineStart:-4},children:(0,be.jsx)(Zi().R,{source:"space_saml",upsell:d,display:"text",width:"hug",size:"small",customMessages:s})}):(0,be.jsx)(Ee().A,{isSmall:!0,isMultiline:!0,children:t})]})}const oa=(0,A().YK)({eligible_for_upgrade:{id:"identityAndProvisioning.claimWorkspaces.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to claim workspaces with verified domains or set external domain requirements"},eligible_for_trial:{id:"identityAndProvisioning.claimWorkspaces.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to claim workspaces with verified domains or set external domain requirements"},sales_eligible:{id:"identityAndProvisioning.claimWorkspaces.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to claim workspaces with verified domains or set external domain requirements"},sales_assisted:{id:"identityAndProvisioning.claimWorkspaces.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to claim workspaces with verified domains or set external domain requirements"},eligible_to_request:{id:"identityAndProvisioning.claimWorkspaces.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to claim workspaces with verified domains or set external domain requirements"},not_eligible:{id:"identityAndProvisioning.claimWorkspaces.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to claim workspaces with verified domains or set external domain requirements"},request_pending:{id:"identityAndProvisioning.claimWorkspaces.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to claim workspaces with verified domains or set external domain requirements"}}),sa=(0,A().YK)({eligible_for_upgrade:{id:"identityAndProvisioning.emailDomains.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to verify email domain ownership for SSO and security features"},eligible_for_trial:{id:"identityAndProvisioning.emailDomains.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to verify email domain ownership for SSO and security features"},sales_eligible:{id:"identityAndProvisioning.emailDomains.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to verify email domain ownership for SSO and security features"},sales_assisted:{id:"identityAndProvisioning.emailDomains.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to verify email domain ownership for SSO and security features"},eligible_to_request:{id:"identityAndProvisioning.emailDomains.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to verify email domain ownership for SSO and security features"},not_eligible:{id:"identityAndProvisioning.emailDomains.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to verify email domain ownership for SSO and security features"},request_pending:{id:"identityAndProvisioning.emailDomains.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to verify email domain ownership for SSO and security features"}}),aa=(0,A().YK)({eligible_for_upgrade:{id:"identityAndProvisioning.workspaceCreation.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to customize who can create new workspaces"},eligible_for_trial:{id:"identityAndProvisioning.workspaceCreation.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to customize who can create new workspaces"},sales_eligible:{id:"identityAndProvisioning.workspaceCreation.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to customize who can create new workspaces"},sales_assisted:{id:"identityAndProvisioning.workspaceCreation.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to customize who can create new workspaces"},eligible_to_request:{id:"identityAndProvisioning.workspaceCreation.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to customize who can create new workspaces"},not_eligible:{id:"identityAndProvisioning.workspaceCreation.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to customize who can create new workspaces"},request_pending:{id:"identityAndProvisioning.workspaceCreation.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to customize who can create new workspaces"}}),ra=(0,A().YK)({eligible_for_upgrade:{id:"identityAndProvisioning.customSessionDuration.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to set managed user session duration before requiring re-authentication"},eligible_for_trial:{id:"identityAndProvisioning.customSessionDuration.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to set managed user session duration before requiring re-authentication"},sales_eligible:{id:"identityAndProvisioning.customSessionDuration.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to set managed user session duration before requiring re-authentication"},sales_assisted:{id:"identityAndProvisioning.customSessionDuration.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to set managed user session duration before requiring re-authentication"},eligible_to_request:{id:"identityAndProvisioning.customSessionDuration.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to set managed user session duration before requiring re-authentication"},not_eligible:{id:"identityAndProvisioning.customSessionDuration.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to set managed user session duration before requiring re-authentication"},request_pending:{id:"identityAndProvisioning.customSessionDuration.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to set managed user session duration before requiring re-authentication"}}),la=(0,A().YK)({eligible_for_upgrade:{id:"identityAndProvisioning.enableNotionMail.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to enable Notion Mail for company domain members"},eligible_for_trial:{id:"identityAndProvisioning.enableNotionMail.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to enable Notion Mail for company domain members"},sales_eligible:{id:"identityAndProvisioning.enableNotionMail.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to enable Notion Mail for company domain members"},sales_assisted:{id:"identityAndProvisioning.enableNotionMail.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to enable Notion Mail for company domain members"},eligible_to_request:{id:"identityAndProvisioning.enableNotionMail.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to enable Notion Mail for company domain members"},not_eligible:{id:"identityAndProvisioning.enableNotionMail.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to enable Notion Mail for company domain members"},request_pending:{id:"identityAndProvisioning.enableNotionMail.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to enable Notion Mail for company domain members"}}),da=(0,A().YK)({eligible_for_upgrade:{id:"identityAndProvisioning.forcePasswordReset.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to force password reset for all managed users on next login"},eligible_for_trial:{id:"identityAndProvisioning.forcePasswordReset.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to force password reset for all managed users on next login"},sales_eligible:{id:"identityAndProvisioning.forcePasswordReset.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to force password reset for all managed users on next login"},sales_assisted:{id:"identityAndProvisioning.forcePasswordReset.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to force password reset for all managed users on next login"},eligible_to_request:{id:"identityAndProvisioning.forcePasswordReset.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to force password reset for all managed users on next login"},not_eligible:{id:"identityAndProvisioning.forcePasswordReset.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to force password reset for all managed users on next login"},request_pending:{id:"identityAndProvisioning.forcePasswordReset.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to force password reset for all managed users on next login"}}),ca=(0,A().YK)({eligible_for_upgrade:{id:"identityAndProvisioning.logoutUsers.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to force log out managed users and require re-authentication"},eligible_for_trial:{id:"identityAndProvisioning.logoutUsers.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to force log out managed users and require re-authentication"},sales_eligible:{id:"identityAndProvisioning.logoutUsers.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to force log out managed users and require re-authentication"},sales_assisted:{id:"identityAndProvisioning.logoutUsers.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to force log out managed users and require re-authentication"},eligible_to_request:{id:"identityAndProvisioning.logoutUsers.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to force log out managed users and require re-authentication"},not_eligible:{id:"identityAndProvisioning.logoutUsers.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to force log out managed users and require re-authentication"},request_pending:{id:"identityAndProvisioning.logoutUsers.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to force log out managed users and require re-authentication"}}),ua=(0,A().YK)({eligible_for_upgrade:{id:"identityAndProvisioning.managedUsers.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to manage users with verified domains"},eligible_for_trial:{id:"identityAndProvisioning.managedUsers.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to manage users with verified domains"},sales_eligible:{id:"identityAndProvisioning.managedUsers.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to manage users with verified domains"},sales_assisted:{id:"identityAndProvisioning.managedUsers.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to manage users with verified domains"},eligible_to_request:{id:"identityAndProvisioning.managedUsers.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to manage users with verified domains"},not_eligible:{id:"identityAndProvisioning.managedUsers.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to manage users with verified domains"},request_pending:{id:"identityAndProvisioning.managedUsers.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to manage users with verified domains"}}),pa=(0,A().YK)({eligible_for_upgrade:{id:"identityAndProvisioning.preventGrantingSupportAccess.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to control managed usersâ€™ support access permissions"},eligible_for_trial:{id:"identityAndProvisioning.preventGrantingSupportAccess.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to control managed usersâ€™ support access permissions"},sales_eligible:{id:"identityAndProvisioning.preventGrantingSupportAccess.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to control managed usersâ€™ support access permissions"},sales_assisted:{id:"identityAndProvisioning.preventGrantingSupportAccess.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to control managed usersâ€™ support access permissions"},eligible_to_request:{id:"identityAndProvisioning.preventGrantingSupportAccess.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to control managed usersâ€™ support access permissions"},not_eligible:{id:"identityAndProvisioning.preventGrantingSupportAccess.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to control managed usersâ€™ support access permissions"},request_pending:{id:"identityAndProvisioning.preventGrantingSupportAccess.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to control managed usersâ€™ support access permissions"}}),ga=(0,A().YK)({eligible_for_upgrade:{id:"identityAndProvisioning.preventMembersJoiningExternalSpaces.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to control external workspace access for managed users"},eligible_for_trial:{id:"identityAndProvisioning.preventMembersJoiningExternalSpaces.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to control external workspace access for managed users"},sales_eligible:{id:"identityAndProvisioning.preventMembersJoiningExternalSpaces.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to control external workspace access for managed users"},sales_assisted:{id:"identityAndProvisioning.preventMembersJoiningExternalSpaces.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to control external workspace access for managed users"},eligible_to_request:{id:"identityAndProvisioning.preventMembersJoiningExternalSpaces.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to control external workspace access for managed users"},not_eligible:{id:"identityAndProvisioning.preventMembersJoiningExternalSpaces.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to control external workspace access for managed users"},request_pending:{id:"identityAndProvisioning.preventMembersJoiningExternalSpaces.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to control external workspace access for managed users"}}),ma=(0,A().YK)({eligible_for_upgrade:{id:"identityAndProvisioning.preventProfileEdits.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to control managed user profile editing permissions"},eligible_for_trial:{id:"identityAndProvisioning.preventProfileEdits.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to control managed user profile editing permissions"},sales_eligible:{id:"identityAndProvisioning.preventProfileEdits.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to control managed user profile editing permissions"},sales_assisted:{id:"identityAndProvisioning.preventProfileEdits.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to control managed user profile editing permissions"},eligible_to_request:{id:"identityAndProvisioning.preventProfileEdits.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to control managed user profile editing permissions"},not_eligible:{id:"identityAndProvisioning.preventProfileEdits.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to control managed user profile editing permissions"},request_pending:{id:"identityAndProvisioning.preventProfileEdits.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to control managed user profile editing permissions"}}),fa=(0,A().YK)({eligible_for_upgrade:{id:"identityAndProvisioning.samlEnforce.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to customize SAML SSO workspace access. Workspace owners retain password or passkey login options."},eligible_for_trial:{id:"identityAndProvisioning.samlEnforce.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to customize SAML SSO workspace access. Workspace owners retain password or passkey login options."},sales_eligible:{id:"identityAndProvisioning.samlEnforce.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to customize SAML SSO workspace access. Workspace owners retain password or passkey login options."},sales_assisted:{id:"identityAndProvisioning.samlEnforce.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to customize SAML SSO workspace access. Workspace owners retain password or passkey login options."},eligible_to_request:{id:"identityAndProvisioning.samlEnforce.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to customize SAML SSO workspace access. Workspace owners retain password or passkey login options."},not_eligible:{id:"identityAndProvisioning.samlEnforce.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to customize SAML SSO workspace access. Workspace owners retain password or passkey login options."},request_pending:{id:"identityAndProvisioning.samlEnforce.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to customize SAML SSO workspace access. Workspace owners retain password or passkey login options."}}),ha=(0,A().YK)({eligible_for_upgrade:{id:"identityAndProvisioning.saml.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to enable SAML SSO login for users with verified domains"},eligible_for_trial:{id:"identityAndProvisioning.saml.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to enable SAML SSO login for users with verified domains"},sales_eligible:{id:"identityAndProvisioning.saml.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to enable SAML SSO login for users with verified domains"},sales_assisted:{id:"identityAndProvisioning.saml.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to enable SAML SSO login for users with verified domains"},eligible_to_request:{id:"identityAndProvisioning.saml.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to enable SAML SSO login for users with verified domains"},not_eligible:{id:"identityAndProvisioning.saml.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to enable SAML SSO login for users with verified domains"},request_pending:{id:"identityAndProvisioning.saml.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to enable SAML SSO login for users with verified domains"}}),va=(0,A().YK)({eligible_for_upgrade:{id:"identityAndProvisioning.scimTokens.upsellMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to generate a token to configure SCIM"},eligible_for_trial:{id:"identityAndProvisioning.scimTokens.upsellMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to generate a token to configure SCIM"},sales_eligible:{id:"identityAndProvisioning.scimTokens.upsellMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to generate a token to configure SCIM"},sales_assisted:{id:"identityAndProvisioning.scimTokens.upsellMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to generate a token to configure SCIM"},eligible_to_request:{id:"identityAndProvisioning.scimTokens.upsellMessages.eligibleToRequest",defaultMessage:"<highlight>Request access</highlight> to generate a token to configure SCIM"},not_eligible:{id:"identityAndProvisioning.scimTokens.upsellMessages.notEligible",defaultMessage:"<highlight>Upgrade</highlight> to generate a token to configure SCIM"},request_pending:{id:"identityAndProvisioning.scimTokens.upsellMessages.requestPending",defaultMessage:"<highlight>Requested</highlight> to generate a token to configure SCIM"}});function ya({spaceStore:e,samlConfigStore:t,domainSettingsStore:n}){var i;const o=(0,r().v3)(),s=(0,d().K8)((()=>t.state.emailDomains),[t]),a=(0,d().K8)((()=>"disabled"!==t.state.status&&"unconfigured"!==t.state.status),[t]),l=(0,zt().P9)({name:"domain_settings",spaceId:e.id,userId:null===(i=o.currentUser)||void 0===i?void 0:i.id})??!1,c=function({environment:e,samlConfigStore:t,spaceStore:n}){var i;const o=(0,zt().P9)({name:"saml",spaceId:n.id,userId:null===(i=e.currentUser)||void 0===i?void 0:i.id});return(0,d().K8)((()=>t.state.emailDomains.length>0||o),[t,o])}({environment:o,samlConfigStore:t,spaceStore:e})??!1,u=(0,d().K8)((()=>c&&(!t.state.id||t.state.id===e.id)),[c,t,e]),p=(0,d().K8)((()=>n.state.emailDomains.length>0&&l),[n,l]);return{verifiedDomains:s,isSamlStatusEnabled:a,isSamlAvailable:c,isSamlEditable:u,isDomainSettingsAvailable:p}}var ba=()=>n(863330),Sa=()=>n(543649),xa=()=>n(375243),Aa=()=>n(689216);function Ma({spaceStore:e,samlConfigStore:t,promptUpgrade:n,disabled:o,renderOverrideAddDomainButton:s}){const a=(0,r().v3)(),l=(0,d().uB)(void 0,Sa().A),u=(0,c().IS)((()=>({flex:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",margin:"18px 0px"},button:{position:"relative",marginInlineStart:"auto",marginInlineEnd:0,opacity:o?.5:1}})),[o]),p=(0,be.jsx)(A().sA,{id:"identityAndProvisioning.emailDomainsSection.title",defaultMessage:"Verified domains"}),g=(0,be.jsx)(A().sA,{id:"identityAndProvisioning.emailDomainsSection.byline",defaultMessage:"Verify ownership of an email domain to access advanced security features including single sign-on."}),m=[...(0,d().K8)((()=>t.state.emailDomains.map(xa().vv)),[t]),...(0,d().K8)((()=>t.state.domainVerifications.filter((e=>!t.state.emailDomains.includes(e.domain))).sort(((e,t)=>e.createdAt-t.createdAt)).map(xa().W0)),[t])],f=(0,i.useCallback)((async()=>{await $s({environment:a,spaceId:e.id,store:t})}),[a,e,t]),h=(0,i.useCallback)((async t=>{switch(t.type){case"verified":return(0,Aa().n)({onRequest:()=>q().callApi({eventName:"setSamlConfig",environment:a,data:{spaceId:e.id,removedEmailDomains:[t.domain]}}),onSuccess:async()=>{await f()}});case"unverified":case"invalid":return(0,Aa().n)({onRequest:()=>q().callApi({eventName:"deleteDomainVerificationCode",environment:a,data:{id:t.id}}),onSuccess:()=>f()})}}),[a,e,f]),v=(0,i.useCallback)((()=>(0,Aa().n)({onRequest:()=>q().callApi({eventName:"setSamlConfig",environment:a,data:{spaceId:e.id}}),onSuccess:()=>f()})),[a,f,e]),y=(0,i.useCallback)((async()=>{await f()}),[f]);return n?(0,be.jsx)(ia,{title:p,byline:g,targetTier:"business",customMessages:sa}):(0,be.jsx)(xa().Ay,{disabled:o,domains:m,onRemoveDomain:h,domainVerificationStore:l,verificationType:"saml_config",verificationTargetId:e.id,refreshDomains:y,onClickAddDomain:v,renderOverrideAddDomainButton:e=>s?s():(0,be.jsxs)("div",{style:u.flex,children:[(0,be.jsxs)("div",{children:[(0,be.jsx)(Ie().A,{smallMarginBottom:!0,style:{fontWeight:w().Wy.medium},children:p}),(0,be.jsx)(Ee().A,{isSmall:!0,isMultiline:!0,style:{marginBottom:4},children:g})]}),(0,be.jsx)("div",{children:(0,be.jsx)(qt().p,{colorPalette:"blue",style:u.button,iconLeading:{icon:ba().plusSmallIcon,size:"xs"},disabled:o,onClick:e,children:(0,be.jsx)(A().sA,{defaultMessage:"Add domain",id:"securitySAMLSettings.emailDomainsSection.addDomain"})})})]})})}function wa({spaceStore:e,samlConfigStore:t,domainSettingsStore:n}){const i=(0,A().tz)(),{isSamlEditable:o,isSamlAvailable:s}=ya({spaceStore:e,samlConfigStore:t,domainSettingsStore:n}),a=(0,c().IS)((e=>({settingContainer:{margin:"18px 0"}})),[]);return(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(Ma,{disabled:!o,promptUpgrade:!s,spaceStore:e,samlConfigStore:t}),(0,be.jsx)("div",{style:a.settingContainer,children:(0,be.jsx)(ia,{title:i.formatMessage(ja.workspaceCreationTitle),byline:i.formatMessage(ja.workspaceCreationByline),targetTier:"enterprise",customMessages:aa})}),(0,be.jsx)("div",{style:a.settingContainer,children:(0,be.jsx)(ia,{title:i.formatMessage(ja.claimWorkspacesTitle),byline:i.formatMessage(ja.claimWorkspacesByline),targetTier:"enterprise",customMessages:oa})})]})}const ja=(0,A().YK)({workspaceCreationTitle:{id:"domainSettings.workspaceCreation.title",defaultMessage:"Workspace creation"},workspaceCreationByline:{id:"domainSettings.workspaceCreation.byline",defaultMessage:"Customize who can create new workspaces."},claimWorkspacesTitle:{id:"identityAndProvisioning.claimWorkspaces.title",defaultMessage:"Claim workspaces"},claimWorkspacesByline:{id:"identityAndProvisioning.claimWorkspaces.message",defaultMessage:"Claim workspaces created by users with a verified domain or require owners to use an external domain."}});var ka=()=>n(564766);function Ia(e){const{samlConfigStore:t,spaceStore:n}=e;(0,c().IS)((e=>({container:{marginBottom:12},code:{fontFamily:"monospace"}})),[]),(0,d().K8)((()=>(0,ka().J4)({samlConfigStatus:t.state.status,emailDomains:t.state.emailDomains,idp_metadata:t.state.idpMetadata,idp_metadata_url:t.state.idpMetadataUrl})),[t]),(0,d().K8)((()=>n.getSubscriptionTier()),[n]);return null}function Ca(){const e=(0,c().IS)((e=>({byline:{fontSize:14,fontWeight:w().Wy.regular,color:e.text.secondary},helpButton:{marginTop:18,marginBottom:16},settingContainer:{margin:"18px 0"}})),[]),t=(0,A().tz)();return(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)("div",{children:(0,be.jsx)(Ee().A,{isSmall:!0,isMultiline:!0,style:e.byline,children:(0,be.jsx)(A().sA,{id:"identityAndProvisioning.managedUsers.byline",defaultMessage:"These settings apply to all users with a verified domain, even if they are not a member of this workspace."})})}),(0,be.jsx)(Rt().A,{title:(0,be.jsx)(A().sA,{id:"identityAndProvisioning.managedUsers.helpButton",defaultMessage:"Learn about managed users"}),href:(0,rt().x)("guides.managedUsers"),style:e.helpButton,analyticsFrom:"managed_users_section"}),(0,be.jsx)("div",{style:e.settingContainer,children:(0,be.jsx)(ia,{title:t.formatMessage(Ta.manageUsersButtonTitle),byline:t.formatMessage(Ta.manageUsersButtonByline),targetTier:"enterprise",customMessages:ua})}),(0,be.jsx)("div",{style:e.settingContainer,children:(0,be.jsx)(ia,{title:t.formatMessage(Ta.preventProfileEditsTitle),byline:t.formatMessage(Ta.preventProfileEditsByline),targetTier:"enterprise",customMessages:ma})}),(0,be.jsx)("div",{style:e.settingContainer,children:(0,be.jsx)(ia,{title:t.formatMessage(Ta.preventMembersJoiningExternalSpacesTitle),byline:t.formatMessage(Ta.preventMembersJoiningExternalSpacesByline),targetTier:"enterprise",customMessages:ga})}),(0,be.jsx)("div",{style:e.settingContainer,children:(0,be.jsx)(ia,{title:t.formatMessage(Ta.preventGrantingSupportAccessTitle),byline:t.formatMessage(Ta.preventGrantingSupportAccessByline),targetTier:"enterprise",customMessages:pa})}),(0,be.jsx)("div",{style:e.settingContainer,children:(0,be.jsx)(ia,{title:t.formatMessage(Ta.customSessionDurationTitle),byline:t.formatMessage(Ta.customSessionDurationByline),targetTier:"enterprise",customMessages:ra})}),(0,be.jsx)("div",{style:e.settingContainer,children:(0,be.jsx)(ia,{title:t.formatMessage(Ta.logoutUsersTitle),byline:t.formatMessage(Ta.logoutUsersByline),targetTier:"enterprise",customMessages:ca})}),(0,be.jsx)("div",{style:e.settingContainer,children:(0,be.jsx)(ia,{title:t.formatMessage(Ta.forcePasswordResetTitle),byline:t.formatMessage(Ta.forcePasswordResetByline),targetTier:"enterprise",customMessages:da})}),(0,be.jsx)("div",{style:e.settingContainer,children:(0,be.jsx)(ia,{title:t.formatMessage(Ta.enableNotionMailTitle),byline:(0,be.jsxs)(be.Fragment,{children:[t.formatMessage(Ta.enableNotionMailByline1),(0,be.jsx)("br",{}),t.formatMessage(Ta.enableNotionMailByline2)]}),targetTier:"enterprise",customMessages:la})})]})}const Ta=(0,A().YK)({manageUsersButtonTitle:{id:"identityAndProvisioning.managedUsers.title",defaultMessage:"Managed users dashboard"},manageUsersButtonByline:{id:"identityAndProvisioning.managedUsers.message",defaultMessage:"Manage and view users that are using your verified domains"},preventProfileEditsTitle:{id:"identityAndProvisioning.managedUsers.preventProfileEdits.title",defaultMessage:"Allow managed users to change profile information"},preventProfileEditsByline:{id:"identityAndProvisioning.managedUsers.preventProfileEdits.message",defaultMessage:"Control if managed users can change their preferred name, email address, and profile photo."},preventMembersJoiningExternalSpacesTitle:{id:"identityAndProvisioning.managedUsers.preventMembersJoiningExternalSpaces.title",defaultMessage:"External workspace access"},preventMembersJoiningExternalSpacesByline:{id:"identityAndProvisioning.managedUsers.preventMembersJoiningExternalSpaces.message",defaultMessage:"Control if managed users are able to join workspaces that arenâ€™t owned by your organization."},preventGrantingSupportAccessTitle:{id:"identityAndProvisioning.managedUsers.preventGrantingSupportAccess.title",defaultMessage:"Prevent managed users from granting support access"},preventGrantingSupportAccessByline:{id:"identityAndProvisioning.managedUsers.preventGrantingSupportAccess.message",defaultMessage:"Control if managed users can enable support access on their accounts."},customSessionDurationTitle:{id:"identityAndProvisioning.managedUsers.customSessionDuration.title",defaultMessage:"Session duration"},customSessionDurationByline:{id:"identityAndProvisioning.managedUsers.customSessionDuration.message",defaultMessage:"Control how long your managed users can be logged in for before they must re-authenticate."},logoutUsersTitle:{id:"identityAndProvisioning.managedUsers.logoutAllUsers.title",defaultMessage:"Log out all users"},logoutUsersByline:{id:"identityAndProvisioning.managedUsers.logoutAllUsers.message",defaultMessage:"Force log out all managed users and require them to re-authenticate."},forcePasswordResetTitle:{id:"identityAndProvisioning.managedUsers.forcePasswordReset.title",defaultMessage:"Reset passwords for all users"},forcePasswordResetByline:{id:"identityAndProvisioning.managedUsers.forcePasswordReset.message",defaultMessage:"Force reset the passwords for all managed users and require them to create a new one the next time they log in."},enableNotionMailTitle:{id:"identityAndProvisioning.managedUsers.enableNotionMail.title",defaultMessage:"Notion Mail"},enableNotionMailByline1:{id:"identityAndProvisioning.managedUsers.enableNotionMail.message",defaultMessage:"Enable Notion Mail for all members under your company domains."},enableNotionMailByline2:{id:"identityAndProvisioning.managedUsers.enableNotionMail.terms",defaultMessage:"By using Notion Mail, you agree to the Notion Mail and Notion AI Supplementary Terms."}});var _a=()=>n(721479),Pa=()=>n(285790);function Ba({title:e,byline:t,isOn:n,onToggle:i,disabled:o,tooltipForDisabled:s}){function a(){o||i()}return(0,be.jsx)(Re().A,{placement:"top",alignment:"end",disableTooltip:!s||!o,renderTooltip:()=>s,render:i=>(0,be.jsx)("div",{...i,children:(0,be.jsx)(Et,{title:e,byline:t,settingItem:(0,be.jsx)(Ki().A,{on:n,disabled:o,onClick:a})})})})}function Da({spaceStore:e,samlConfigStore:t}){const n=(0,r().v3)();return{updateSamlIdpUrl:(0,i.useCallback)((async i=>{let o=!1;return await(0,Aa().n)({onRequest:()=>q().callApi({eventName:"setSamlConfig",environment:n,data:{spaceId:e.id,idpMetadataUrl:i}}),onSuccess:()=>{o=!0,t.setState({...t.state,useMetadataUrl:!0,idpMetadataUrl:i,idpMetadata:void 0})}}),o}),[t,e,n]),updateSamlIdpXml:(0,i.useCallback)((async i=>{let o=!1;return await(0,Aa().n)({onRequest:()=>q().callApi({eventName:"setSamlConfig",environment:n,data:{spaceId:e.id,idpMetadata:i}}),onSuccess:()=>{o=!0,t.setState({...t.state,useMetadataUrl:!1,idpMetadataUrl:void 0,idpMetadata:i})}}),o}),[t,e,n]),updateStatus:(0,i.useCallback)((i=>(0,Aa().n)({onRequest:()=>q().callApi({eventName:"setSamlConfig",environment:n,data:{spaceId:e.id,status:i}}),onSuccess:()=>{t.setState({...t.state,status:i})}})),[t,e,n]),updateCreateAccount:(0,i.useCallback)((i=>(0,Aa().n)({onRequest:()=>q().callApi({eventName:"setSamlConfig",environment:n,data:{spaceId:e.id,createAccount:i}}),onSuccess:()=>{t.setState({...t.state,createAccount:i})}})),[t,e,n])}}function Ra({spaceStore:e,samlConfigStore:t,disabled:n}){const{updateCreateAccount:i}=Da({samlConfigStore:t,spaceStore:e}),o=(0,r().v3)(),s=(0,c().IS)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),a=(0,d().K8)((()=>t.state.createAccount),[t]);return(0,be.jsx)("div",{style:s.settingContainer,children:(0,be.jsx)(Ba,{title:(0,be.jsxs)("div",{style:s.settingsTitle,children:[(0,be.jsx)(A().sA,{id:"identityAndProvisioning.createAccount.title",defaultMessage:"Automatic account creation"}),(0,be.jsx)(Pa().A,{icon:_a().questionMarkCircleSmallIcon,onClick:()=>(0,P().L)({environment:o,url:(0,rt().x)("guides.samlJIT")})})]}),byline:(0,be.jsx)(A().sA,{id:"identityAndProvisioning.createAccount.byline",defaultMessage:"Automatically create Notion accounts for new users who log in via SAML SSO"}),isOn:a,onToggle:async function(){await i(!t.state.createAccount)},disabled:n})})}function Ea({spaceStore:e,samlConfigStore:t,promptUpgrade:n,disabled:i}){const o=(0,r().v3)(),{updateStatus:s}=Da({samlConfigStore:t,spaceStore:e}),a=(0,c().IS)((()=>({settingContainer:{margin:"18px 0"}})),[]),l=(0,be.jsx)(A().sA,{id:"identityAndProvisioning.accountAuth.title",defaultMessage:"Login method"}),u=(0,be.jsx)(A().sA,{id:"identityAndProvisioning.accountAuth.byline",defaultMessage:"Customize how users access workspaces that have SAML SSO enabled. Workspace owners can always log in with a password or passkey."}),p=(0,d().K8)((()=>"enforced"===t.state.status?"enforced":"enforced_for_domain"===t.state.status?"enforced_for_domain":"not_enforced"),[t]);if(n)return(0,be.jsx)("div",{style:a.settingContainer,children:(0,be.jsx)(ia,{title:l,byline:u,targetTier:"business",customMessages:fa})});const g=[{key:"enforced",label:(0,be.jsx)(A().sA,{id:"identityAndProvisioning.accountAuth.option.enforced",defaultMessage:"Only SAML SSO"})},{key:"not_enforced",label:(0,be.jsx)(A().sA,{id:"identityAndProvisioning.accountAuth.option.notEnforced",defaultMessage:"Any method"})}];return"enforced_for_domain"===p?(0,be.jsx)("div",{style:a.settingContainer,children:(0,be.jsx)(Lt().A,{isMobile:o.device.isMobile,disabled:!0,title:l,caption:u,type:"custom",customButton:(0,be.jsx)(qt().p,{disabled:!0,disabledFeedback:!0,children:(0,be.jsx)(A().sA,{id:"identityAndProvisioning.accountAuth.option.enforcedForDomain",defaultMessage:"Enforced for domain"})})})}):(0,be.jsx)("div",{style:a.settingContainer,children:(0,be.jsx)(Lt().A,{isMobile:o.device.isMobile,title:l,caption:u,type:"dropdown",currentOption:p,options:g,onSelectOption:async function(e){"enforced"===e?await s("enforced"):"enforced_for_domain"===e?await s("enforced_for_domain"):await s("configured")}})})}var La=()=>n(759358);function Oa({spaceStore:e,samlConfigStore:t,domainSettingsStore:n,isSamlStatusEnabled:o,promptUpgrade:s,disabled:a}){const[r,l]=(0,i.useState)(!1),[u,p]=(0,i.useState)({isOpened:!1,enableSamlOnSave:!1}),[g,m]=(0,i.useState)(!1),{updateStatus:f,updateSamlIdpUrl:h,updateSamlIdpXml:v}=Da({samlConfigStore:t,spaceStore:e}),{verifiedDomains:y}=ya({spaceStore:e,samlConfigStore:t,domainSettingsStore:n}),b=(0,d().K8)((()=>({id:e.id,status:t.state.status,idpMetadataUrl:t.state.idpMetadataUrl,idpMetadata:t.state.idpMetadata,createAccount:t.state.createAccount,emailDomains:t.state.emailDomains})),[e.id,t]),S="unconfigured"===b.status,x=(0,c().IS)((()=>({configButton:{marginTop:14}})),[]),M=(0,be.jsx)(A().sA,{id:"identityAndProvisioning.samlToggle.title",defaultMessage:"Enable SAML SSO"}),w=(0,be.jsx)(A().sA,{id:"identityAndProvisioning.samlToggle.byline",defaultMessage:"Workspace members can log in with SAML SSO if their email address uses a verified domain."}),j=S?(0,be.jsx)(A().sA,{id:"identityAndProvisioning.editSamlConfig.enableSaml",defaultMessage:"Enable SAML"}):(0,be.jsx)(A().sA,{id:"identityAndProvisioning.editSamlConfig.saveChanges",defaultMessage:"Save changes"});async function k(e){try{m(!0),await f(e)}finally{m(!1)}}return s?(0,be.jsx)(ia,{title:M,byline:w,targetTier:"business",customMessages:ha}):(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(Ba,{title:M,byline:w,isOn:o,disabled:a||g,tooltipForDisabled:0===y.length?(0,be.jsx)(A().sA,{id:"identityAndProvisioning.samlToggle.disabledTooltipNoVerifiedDomains",defaultMessage:"Verify a domain to enable SAML."}):void 0,onToggle:async function(){if(a)return;const{useMetadataUrl:e,idpMetadata:n,idpMetadataUrl:i}=t.state,o=e&&i||!e&&n;switch(t.state.status){case"disabled":o?await k("configured"):p({isOpened:!0,enableSamlOnSave:!0});break;case"unconfigured":p({isOpened:!0,enableSamlOnSave:!0});break;case"configured":case"enforced":await k("disabled");break;case"enforced_for_domain":break;default:(0,bt().HB)(t.state.status)}}}),(0,be.jsx)(Mt().A,{disabled:a,disabledFeedback:a,size:"lg",style:x.configButton,onClick:function(){a||p({isOpened:!0,enableSamlOnSave:!1})},children:(0,be.jsx)(A().sA,{id:"identityAndProvisioning.samlToggle.configure",defaultMessage:"Edit SAML SSO configuration"})}),u.isOpened?(0,be.jsx)(La().N,{saveButtonText:j,onSave:async function(e){const{metadataUrl:n,metadataXml:i}=e;l(!0);let o=!1;if(n?o=await h(n):i&&(o=await v(i)),o){switch(t.state.status){case"disabled":u.enableSamlOnSave&&await f("configured");break;case"unconfigured":await f("configured");break;case"enforced":case"enforced_for_domain":case"configured":break;default:(0,bt().HB)(t.state.status)}p({isOpened:!1,enableSamlOnSave:!1}),l(!1)}else l(!1)},samlConfig:b,loading:r,onDismiss:()=>p({isOpened:!1,enableSamlOnSave:!1}),headerByline:(0,be.jsx)(A().sA,{id:"identityAndProvisioning.editSamlConfig.byline",defaultMessage:"Configure SAML SSO for your Notion workspace with your Identity Provider (IDP). <guidelink>Learn more</guidelink>.",values:{guidelink:e=>(0,be.jsx)(zn().A,{hoverColor:"blue",href:(0,rt().x)("guides.samlSettings"),external:!0,children:e})}})}):null]})}var Na=()=>n(994877),Fa=()=>n(869190),Ua=()=>n(824160);const za={id:"name",headerTitle:(0,be.jsx)(A().sA,{id:"identityAndProvisioning.secondaryWorkspaces.table.name",defaultMessage:"Name"}),renderCell:e=>(0,be.jsx)(Ha,{space:e.space,isCurrentSpace:e.isCurrentSpace}),widthData:{width:50},sortable:!0},Ka={id:"memberCount",headerTitle:(0,be.jsx)(A().sA,{id:"identityAndProvisioning.secondaryWorkspaces.table.memberCount",defaultMessage:"Members"}),renderCell:e=>(0,be.jsx)(Ee().A,{children:(0,be.jsx)(A().sA,{id:"identityAndProvisioning.secondaryWorkspaces.table.members",defaultMessage:"{count} members",values:{count:e.space.memberCount}})}),widthData:{width:20},sortable:!0},Va={id:"createdAt",headerTitle:(0,be.jsx)(A().sA,{id:"identityAndProvisioning.secondaryWorkspaces.table.plan",defaultMessage:"Created at"}),renderCell:e=>{const t=e.space.createdTime;return(0,be.jsx)(Ee().A,{children:t?(0,Fa().W_)(t,"medium",Ln().locale):void 0})},widthData:{width:20},sortable:!0},qa=[za,Ka,Va];function Wa({spaceStore:e,spaces:t}){const[n,o]=(0,i.useState)({column:za,sortAscending:!1}),s=(0,d().K8)((()=>t.map((t=>({id:t.id,isClickable:!1,isCurrentSpace:e.id===t.id,space:t})))),[t,e]),a=(0,c().IS)((e=>(0,De().rC)({columnRenderInfo:qa,theme:e,containerMarginTop:12})),[]);return(0,be.jsx)(De().WE,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:qa,rows:Ga(s,n),sortState:n,onSortStateChanged:o,renderNoRowsComponent:()=>(0,be.jsx)(Ee().A,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:(0,be.jsx)(A().sA,{id:"identityAndProvisioning.secondaryWorkspaces.empty",defaultMessage:"No linked workspaces."})}),styles:a})}function Ga(e,{column:t,sortAscending:n}){let i=[];switch(t.id){case"name":i=M().Ul(e,(e=>e.space.name));break;case"createdAt":i=M().Ul(e,(e=>e.space.createdTime));break;case"memberCount":i=M().Ul(e,(e=>e.space.memberCount))}return n?i:i.reverse()}function Ha(e){const t=(0,c().IS)((()=>({container:{display:"flex",justifyContent:"center",alignItems:"center",gap:4}})),[]);return(0,be.jsxs)(Ee().A,{style:t.container,children:[e.space.name,e.isCurrentSpace?(0,be.jsx)(Ua().A,{children:(0,be.jsx)(A().sA,{id:"identityAndProvisioning.secondaryWorkspaces.table.name.currentBadge",defaultMessage:"Current"})}):null]})}function Ya({spaceStore:e,spaces:t}){const n=(0,r().v3)(),o=(0,c().IS)((()=>({settingContainer:{margin:"18px 0"}})),[]),s=(0,i.useCallback)((()=>{Na().SI({environment:n,from:"saml_settings",prepopulatedContent:`Request to add or remove a workspace for SAML single sign-on on workspace ${e.id}.`})}),[e,n]),a=(0,d().K8)((()=>(0,x().bp)(e.getSubscriptionTier())),[e]);return(0,be.jsxs)("div",{style:o.settingContainer,children:[(0,be.jsx)(Et,{title:(0,be.jsx)(A().sA,{id:"identityAndProvisioning.secondaryWorkspaces.title",defaultMessage:"Linked workspaces"}),byline:(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(A().sA,{id:"identityAndProvisioning.secondaryWorkspaces.description",defaultMessage:"This SAML SSO configuration applies to the following other workspaces"}),a?(0,be.jsxs)(be.Fragment,{children:[" ",(0,be.jsx)(A().sA,{id:"identityAndProvisioning.secondaryWorkspaces.contact",defaultMessage:"<contactlink>Contact support</contactlink> to add or remove a workspace.",values:{contactlink:e=>(0,be.jsx)(zn().A,{onClick:s,children:e})}})]}):void 0]}),settingItem:null}),(0,be.jsx)(Wa,{spaceStore:e,spaces:t})]})}function $a({spaceStore:e,samlConfigStore:t,domainSettingsStore:n}){const{verifiedDomains:i,isSamlAvailable:o,isSamlEditable:s,isSamlStatusEnabled:a}=ya({spaceStore:e,samlConfigStore:t,domainSettingsStore:n}),r=!s||!o||!a,l=(0,d().K8)((()=>t.state.spaces),[t]);return(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(Rt().A,{title:(0,be.jsx)(A().sA,{id:"identityAndProvisioning.samlToggle.learnMore",defaultMessage:"Learn about SAML SSO"}),href:(0,rt().x)("guides.samlSettings"),style:{marginTop:18,marginBottom:16},analyticsFrom:"saml_settings"}),(0,be.jsx)(Oa,{disabled:!s||0===i.length,promptUpgrade:!o,isSamlStatusEnabled:a,spaceStore:e,samlConfigStore:t,domainSettingsStore:n}),(0,be.jsx)(Ea,{disabled:r,promptUpgrade:!o,spaceStore:e,samlConfigStore:t}),(0,be.jsx)(Ra,{disabled:r,spaceStore:e,samlConfigStore:t}),(0,be.jsx)(Ya,{spaceStore:e,spaces:l})]})}var Qa=()=>n(122555);function Za({spaceStore:e,samlConfigStore:t,domainSettingsStore:n,organizationOnboardingInfo:o}){const s=(0,r().v3)(),a=(0,c().IS)((()=>({iconArrow:{height:14,width:14,fill:"currentColor",transform:"rotate(90deg)",marginTop:4},button:{margin:"4px 0px 16px",width:"fit-content",display:"flex",alignItems:"center",justifyContent:"center",gap:4}})),[]),{buttonLabel:l,onClick:u}=(0,ta().gO)({environment:s,organizationOnboardingInfo:o}),p=(0,i.useCallback)((()=>(0,be.jsxs)(qt().p,{colorPalette:"blue",onClick:u,style:a.button,children:[l,(0,Qa().p)(a.iconArrow)]})),[l,u,a.button,a.iconArrow]),g=(0,i.useCallback)((()=>(0,be.jsx)(Et,{title:(0,be.jsx)(A().sA,{id:"identityAndProvisioning.emailDomainsSection.organization.title",defaultMessage:"Verified domains"}),byline:(0,be.jsx)(A().sA,{id:"identityAndProvisioning.emailDomainsSection.organization.byline",defaultMessage:"Verify ownership of an email domain to access advanced security features including single sign-on."}),settingItem:p()})),[p]),m=(0,d().K8)((()=>t.state.emailDomains.length+t.state.domainVerifications.length>0),[t]);return(0,be.jsxs)(No().VP,{gap:16,children:[m?(0,be.jsx)(Ma,{disabled:!0,promptUpgrade:!1,spaceStore:e,samlConfigStore:t,renderOverrideAddDomainButton:g}):g(),(0,be.jsx)(Et,{title:(0,be.jsx)(A().sA,{id:"identityProvisioningSettings.saml.organization.title",defaultMessage:"Enable SAML SSO"}),byline:(0,be.jsx)(A().sA,{id:"identityProvisioningSettings.saml.organization.byline",defaultMessage:"Workspace members can log in with SAML SSO if their email address uses a verified email domain."}),settingItem:p()})]})}var Ja=()=>n(978604),Xa=()=>n(799288),er=()=>n(951105),tr=()=>n(158661),nr=()=>n(792071),ir=()=>n(384100),or=()=>n(124749),sr=()=>n(406699),ar=()=>n(453697);const rr={container:{display:"flex",alignItems:"center",fontSize:w().J.UIRegular.desktop,overflow:"hidden"},userAvatar:{paddingInlineEnd:6},userName:{flexShrink:1,...w().RC}};function lr(e,t){const n=nr().Bj6.fromValue(K().GP,e);return n.getCreatedByTable()===V().oo&&n.getCreatedById()===t}function dr({onRevokeToken:e}){const t=(0,A().tz)(),[o,s]=(0,i.useState)(!1);return(0,be.jsx)(Re().A,{textWrap:!1,renderTooltip:()=>(0,be.jsx)(A().sA,{defaultMessage:"Revoke this token.",id:"revokeTokenButton.tooltip"}),placement:"right",render:i=>(0,be.jsx)(sr().A,{popupType:sr().z.Popup,placementToOrigin:"right",renderOrigin:e=>(0,be.jsx)(Pa().A,{className:ot().hqd,ariaLabel:t.formatMessage({id:"revokeTokenButton.tooltip",defaultMessage:"Revoke this token."}),icon:n(259476).trashSmallIcon,colorPalette:"gray",colorVariant:"secondary",...i,...e}),onClick:()=>{s(!0)},render:t=>o?(0,be.jsx)(n(817045).S,{onCancel:t.close,onSubmit:e,headerText:(0,be.jsx)(A().sA,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.message",defaultMessage:"Revoke this token?"}),bylineText:(0,be.jsx)(A().sA,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.description",defaultMessage:"Existing SCIM configurations that use this token will no longer work once the token is revoked, and youâ€™ll have to provide them with a new token."}),submitText:(0,be.jsx)(A().sA,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.acceptButton.label",defaultMessage:"Revoke token"})}):null})})}function cr(){return(0,be.jsx)(Re().A,{textWrap:!1,renderTooltip:()=>(0,be.jsx)(A().sA,{defaultMessage:"Outdated token. Revoke this token and generate a new one to view its contents.",id:"manageScimTokenTable.OutdatedWarningIcon.tooltip"}),placement:"right",render:e=>(0,be.jsx)("div",{...e,children:(0,be.jsx)(g().I,{icon:tr().exclamationMarkTriangleFillSmallIcon,size:"xs",colorPalette:"orange",colorVariant:"accentPrimary"})})})}function ur({clipboardTextFn:e}){const t=(0,r().v3)();return(0,be.jsx)(qt().p,{size:"xs",onClick:async function(){const n=await e();if(void 0!==n){const e=await Be().R.clipboardActions.load();e.copyString({environment:t,stringValue:n,copiedMessage:e.clipboardMessages.copiedTokenToClipboard,showCopyModal:!!t.device.isSafari||void 0})}},iconLeading:er().k,children:(0,be.jsx)(A().sA,{defaultMessage:"Copy",id:"codeBlock.copyToClipboard.button"})})}const pr="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢";function gr(){return(0,be.jsx)(Re().A,{textWrap:!1,renderTooltip:()=>(0,be.jsx)(A().sA,{defaultMessage:"This token can only be viewed by its creator.",id:"manageScimTokenTable.renderTokenThatCannotBeViewed.tooltip"}),placement:"right",render:e=>(0,be.jsx)("div",{...e,children:pr})})}function mr({row:e}){const t=(0,r().v3)();return e.legacy?(0,be.jsxs)(No().fI,{alignItems:"center",gap:4,children:[pr,(0,be.jsx)(cr,{})]}):e.ownedByCurrentUser?(0,be.jsxs)(No().fI,{gap:2,children:[pr,(0,be.jsx)(ur,{clipboardTextFn:()=>Es().dA({environment:t,botId:e.id})})]}):(0,be.jsx)(gr,{})}const fr={id:"token",headerTitle:(0,be.jsx)(A().sA,{id:"manageScimTokenTable.columnTitle.token",defaultMessage:"Token"}),renderCell:e=>(0,be.jsx)(mr,{row:e}),widthData:{width:40},sortable:!1,hasClickableContents:!0};function hr(){const e=rr;return(0,be.jsx)(Re().A,{textWrap:!1,renderTooltip:()=>(0,be.jsx)(A().sA,{defaultMessage:"This token was created by a user who is no longer an admin in the workspace.",id:"scimTableLegacyUserCell.tooltip"}),placement:"right",render:t=>(0,be.jsx)("div",{...t,children:(0,be.jsxs)("div",{style:e.container,children:[(0,be.jsx)(ar().A,{style:e.userAvatar,avatarShouldShowShadow:!0,size:20}),(0,be.jsx)("div",{style:e.userName,children:(0,be.jsx)("i",{children:"Deactivated user"})})]})})})}const vr={id:"addedBy",headerTitle:(0,be.jsx)(A().sA,{id:"manageScimTokenTable.columnTitle.addedBy",defaultMessage:"Added by"}),renderCell:e=>{if(e.legacy)return(0,be.jsx)(hr,{});{const t=e.ownedByCurrentUser?(0,be.jsx)(Ee().A,{isSecondaryColor:!0,style:{marginInlineStart:4,textAlign:"center"},children:(0,be.jsx)(A().sA,{id:"manageSCIMTokenTable.colums.addedBy.selfIndicator",defaultMessage:"(you)"})}):null;return(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(fs().l,{isClickable:!1,userStores:[e.ownerUserStore]}),t]})}},widthData:{width:40},sortable:!1,hasClickableContents:!1},yr={id:"created",headerTitle:(0,be.jsx)(A().sA,{id:"manageScimTokenTable.columnTitle.created",defaultMessage:"Created"}),renderCell:e=>(0,be.jsx)(Vo().d,{includeTime:!0,dateTs:e.createdAt}),widthData:{width:40},sortable:!0,hasClickableContents:!1},br=[fr,vr,yr,{id:"revokeToken",headerTitle:void 0,renderCell:e=>(0,be.jsx)(dr,{onRevokeToken:e.onRevokeToken}),widthData:{width:10},sortable:!1,hasClickableContents:!0}];function Sr(e,{column:t,sortAscending:n}){const i=null==t?void 0:t.id;let o=e=>e.id;switch(i){case"name":o=e=>e.name;break;case"created":o=e=>e.createdAt;break;case"token":case"addedBy":case"revokeToken":case void 0:break;default:(0,bt().HB)(i)}const s=M().Ul(e,o);return n||s.reverse(),s}function xr({botStores:e,onRevokeToken:t}){const n=(0,or().$)(),o=(0,d().O$)(di().AppStoreSidebarSpaceStore),s=(0,A().tz)(),a=(0,d().K8)((()=>{if(!o)return[];const i=null==n?void 0:n.id;return M().oE(e.map((e=>{const n=e.getModel();if(!n||!(0,Xa().SZ)(n))return;const a={id:n.id,isClickable:!1,createdAt:n.getCreatedAt(),userLocale:s.locale,name:n.getName(),onRevokeToken:async()=>{await t(n.id)}},r=function(e){const t=nr().Bj6.fromValue(K().GP,e);return"notion_user"===t.getCreatedByTable()&&t.getCreatedById()===V().BF.id}(n);return r?{...a,legacy:r}:{...a,legacy:r,ownedByCurrentUser:lr(n,i),ownerUserStore:"notion_user"===n.getCreatedByTable()?(0,ir().z5)({userId:n.getCreatedById(),currentSpaceStore:o}):void 0}})))}),[e,o,n,s.locale,t]),[r,l]=(0,i.useState)({column:yr,sortAscending:!1}),u=(0,c().IS)((e=>(0,De().rC)({columnRenderInfo:br,theme:e,containerMarginTop:0})),[]);return(0,be.jsx)(De().WE,{columnRenderInfo:br,rows:Sr(a,r),sortState:r,onSortStateChanged:l,onRowClick:()=>null,renderNoRowsComponent:()=>(0,be.jsx)(Ee().A,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:(0,be.jsx)(A().sA,{id:"manageSCIMTokenTable.noTokensFound.message",defaultMessage:"No active SCIM tokens."})}),styles:u})}async function Ar({environment:e,spaceId:t}){return(await Es().Ju({environment:e,table:Rs().NX,id:t,type:"scim"})).botIds}const Mr=function({botIds:e,setBotIds:t,spaceStore:n}){const o=(0,r().v3)(),s=n.id;if((0,i.useEffect)((()=>{void 0===e&&Ar({environment:o,spaceId:s}).then(t)}),[e,o,t,s]),e){const i=e.map((e=>he().v.createChildStore(n,{table:K().GP,id:e,spaceId:s})));return(0,be.jsx)(xr,{botStores:i,onRevokeToken:async e=>{await Es().KA({environment:o,botId:e,onSuccess:()=>{Ar({environment:o,spaceId:s}).then(t)}})}})}return(0,be.jsx)(Fo().k,{})};function wr({userStore:e,spaceStore:t,promptUpgrade:n}){const[o,s]=(0,i.useState)(void 0),a=(0,r().v3)(),l=(0,d().K8)((()=>function({botIds:e,spaceStore:t,environment:n}){if(void 0===e)return"Undefined";const i=e.map((e=>he().v.createChildStore(t,{table:K().GP,id:e,spaceId:t.id}))).filter((e=>e.isDefined()));if(i.some((e=>e.getCreatedByTable()===V().oo&&e.getCreatedById()===V().BF.id)))return"SpaceHasExistingToken";const o=i.some((e=>e.getCreatedByTable()===V().oo&&e.getCreatedById()===n.currentUser.id));if(o)return"UserHasExistingToken";return"Able"}({botIds:o,spaceStore:t,environment:a})),[o,a,t]),c=(0,be.jsx)(A().sA,{id:"identityAndProvisioning.scim.title",defaultMessage:"SCIM tokens"}),u=(0,be.jsx)(A().sA,{id:"identityAndProvisioning.scim.byline",defaultMessage:"Generate a token to configure SCIM."});return n?(0,be.jsx)(ia,{title:c,byline:u,targetTier:"enterprise",customMessages:va}):(0,be.jsxs)("div",{children:[(0,be.jsx)(Et,{title:c,byline:u,settingItem:(0,be.jsx)(Ja().K,{onNewScimToken:e=>s((t=>[...t??[],e])),spaceStore:t,userStore:e,tokenCreationAbility:l})}),(0,be.jsx)(Rt().A,{title:(0,be.jsx)(A().sA,{id:"securitySAMLSettings.SCIMSection.helpButton.label",defaultMessage:"Learn about SCIM"}),style:{marginTop:18,marginBottom:24},href:(0,rt().x)("guides.scim"),analyticsFrom:"scim_settings"}),(0,be.jsx)(Mr,{spaceStore:t,userStore:e,botIds:o,setBotIds:s})]})}var jr=()=>n(675801);function kr({userStore:e,spaceStore:t}){const n=(0,r().v3)(),i=(0,zt().P9)({name:"scim",spaceId:t.id,userId:e.id}),o=(0,d().K8)((()=>Boolean(t.getSettings().are_scim_invite_emails_suppressed)),[t]),s=(0,c().IS)((()=>({container:{display:"flex",flexDirection:"column",gap:i?16:0}})),[i]);return(0,be.jsxs)("div",{style:s.container,children:[(0,be.jsx)(wr,{promptUpgrade:!i,userStore:e,spaceStore:t}),i?(0,be.jsx)(jr().S,{isEnabled:o,onToggle:()=>{(0,jr().i)({environment:n,spaceStore:t,areScimInviteEmailsSuppressed:!o})}}):null]})}var Ir=()=>n(234695);function Cr({userStore:e,spaceStore:t,samlConfigStore:n,domainSettingsStore:o}){const{organizationInfo:s,isOrganizationOwner:a}=(0,uo().n)({spaceId:t.id}),{onboardingInfo:l}=function({spaceId:e,allowSecondaryWorkspace:t}){const n=(0,r().v3)(),{updateCacheWithRecordMap:o}=(0,i.useContext)(na().N),[{status:s,value:a},l]=(0,Ys().Yb)((async()=>{const i=await q().callApi({eventName:"getOrganizationOnboardingInfo",environment:n,data:{spaceId:e,allowSecondaryWorkspace:t}});return"success"===i.type?(o({data:i.data}),i.data.result):"failed"===i.type?{onboardingStatus:"ineligible"}:(0,bt().HB)(i)}),[n,e,o,t]);return{loading:"pending"===s||"idle"===s,onboardingInfo:a,refresh:l}}({spaceId:t.id,allowSecondaryWorkspace:!0});return(0,be.jsx)(Tr,{userStore:e,spaceStore:t,samlConfigStore:n,domainSettingsStore:o,organizationInfo:s,isOrganizationOwner:a,organizationOnboardingInfo:l})}function Tr({userStore:e,spaceStore:t,samlConfigStore:n,domainSettingsStore:o,organizationInfo:s,isOrganizationOwner:a,organizationOnboardingInfo:r}){const l=(0,d().O$)(u().e),{loadingSaml:p,loadedSaml:g,errorSaml:m}=(0,i.useContext)(Qs),f=void 0!==s,h=r&&("not_started"===r.onboardingStatus||"domain_verified"===r.onboardingStatus),v=f&&!a,y=r&&"ineligible"!==(null==r?void 0:r.onboardingStatus),b=(0,c().IS)((()=>({header:{marginTop:36},title:{display:"flex",alignItems:"center",gap:6}})),[]),S=(0,d().K8)((()=>(0,Xs().OX)()),[]);return(0,i.useEffect)((()=>{l&&!p&&m&&T().c1(m.message)}),[m,p,l]),l?p?(0,be.jsx)(St().Ay,{centerContent:!0,children:(0,be.jsx)(Fo().k,{})}):m?null:g?(0,be.jsxs)(St().Ay,{children:[(0,be.jsx)(Ia,{samlConfigStore:n,spaceStore:t}),h?(0,be.jsx)(ta().s,{organizationOnboardingInfo:r}):null,s&&!a?(0,be.jsx)(ea().l,{display:"inline",tint:"blue",iconGroup:Js().x,label:(0,be.jsx)(A().sA,{id:"workspaceSettingsModal.organizationsBanner.member.title",defaultMessage:"Settings that can only be managed by organization owners have been moved to the organization console."}),description:(0,be.jsx)(A().sA,{id:"workspaceSettingsModal.organizationsBanner.member.tooltip",defaultMessage:"Verifying domains and managing accounts can only be done by organization owners. Organization owners can manage all workspaces in {organizationName}.",values:{organizationName:s.name}})}):null,S?null:(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(Ie().A,{large:!0,divider:"full",children:(0,be.jsx)(A().sA,{id:"identityProvisioningSettings.domain.title",defaultMessage:"Domain management"})}),(0,be.jsx)(wa,{spaceStore:t,samlConfigStore:n,domainSettingsStore:o})]}),S?null:(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(Ie().A,{large:!0,divider:"full",style:b.header,children:(0,be.jsx)(A().sA,{id:"identityProvisioningSettings.userManagement.title",defaultMessage:"User management"})}),(0,be.jsx)(Ca,{})]}),v?null:y?(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(Ie().A,{large:!0,divider:"full",style:"completed"===(null==r?void 0:r.onboardingStatus)?void 0:b.header,children:(0,be.jsxs)("div",{style:b.title,children:[(0,be.jsx)(A().sA,{id:"identityProvisioningSettings.saml.title",defaultMessage:"SAML single sign-on (SSO)"}),(0,be.jsx)(Rt().A,{href:(0,rt().x)("guides.samlSettings"),analyticsFrom:"saml_settings"})]})}),(0,be.jsx)(Za,{spaceStore:t,samlConfigStore:n,domainSettingsStore:o,organizationOnboardingInfo:r})]}):(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(Ie().A,{large:!0,divider:"full",style:b.header,children:(0,be.jsx)(A().sA,{id:"identityProvisioningSettings.saml.title",defaultMessage:"SAML single sign-on (SSO)"})}),(0,be.jsx)($a,{spaceStore:t,samlConfigStore:n,domainSettingsStore:o})]}),(0,be.jsx)(Ie().A,{large:!0,divider:"full",style:b.header,children:(0,be.jsx)(A().sA,{id:"identityProvisioningSettings.scim.title",defaultMessage:"SCIM provisioning"})}),(0,be.jsx)(kr,{userStore:e,spaceStore:t}),(0,be.jsx)(Ir().K,{spaceStore:t})]}):null:(0,be.jsx)(St().Ay,{children:(0,be.jsx)(Ee().A,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"},children:(0,be.jsx)(A().sA,{defaultMessage:"Please go online to manage identity and provisioning settings.",id:"identityProvisioningSettings.offline.message"})})})}function _r({userStore:e,spaceStore:t,samlConfigStore:n,domainSettingsStore:i}){return(0,be.jsx)(Cr,{userStore:e,spaceStore:t,samlConfigStore:n,domainSettingsStore:i})}const Pr=function({userStore:e,spaceStore:t,samlConfigStore:n,domainSettingsStore:i}){return(0,be.jsx)(Zs,{spaceStore:t,samlConfigStore:n,domainSettingsStore:i,children:(0,be.jsx)(_r,{userStore:e,spaceStore:t,samlConfigStore:n,domainSettingsStore:i})})};var Br=()=>n(417399),Dr=()=>n(402390),Rr=()=>n(863569),Er=()=>n(506731),Lr=()=>n(789148),Or=()=>n(942906),Nr=()=>n(113474);function Fr({isMobile:e}){const t=(0,r().v3)(),n=G().A.getIntl(),i=(0,d().O$)(di().AppStoreCurrentUserSettingsStore),{currentTimeZone:o,auto_update_disabled:s}=(0,d().K8)((()=>{const e=null==i?void 0:i.getSettings();return{currentTimeZone:null!=e&&e.time_zone&&(0,Lr().PJ)(null==e?void 0:e.time_zone)?e.time_zone:void 0,auto_update_disabled:null==e?void 0:e.disable_auto_set_timezone}}),[i]),a=!s||!o;return i?(0,be.jsx)(Lt().A,{isMobile:e,type:"timezonePicker",currentTimeZone:o,title:(0,be.jsx)(A().sA,{id:"dateAndTimeSettings.timeZone.title",defaultMessage:"Timezone"}),caption:(0,be.jsx)(A().sA,{id:"dateAndTimeSettings.timeZone.caption",defaultMessage:"Current timezone setting."}),renderOrigin:e=>(0,be.jsx)(Nr()._,{focused:!1,disabled:a,buttonStyle:{width:void 0,margin:0},title:o?(0,Er().Dy)(n,o):(0,be.jsx)(A().sA,{id:"dateAndTimeSettings.timeZone.error",defaultMessage:"Error finding timezone"}),...e}),disabled:a,onSelect:e=>{Or().Lj({environment:t,userSettingsStore:i,timeZone:e})}}):null}function Ur({isMobile:e}){const t=(0,r().v3)(),n=(0,d().O$)(di().AppStoreCurrentUserSettingsStore),o=(0,d().K8)((()=>{var e;return null==n||null===(e=n.getSettings())||void 0===e?void 0:e.disable_auto_set_timezone}),[n])??!1,s=(0,i.useCallback)((e=>{const n=!o;Or().W2({environment:t,userSettingsStore:e,disableAutoSetTimezone:n}),n||Or().xw({environment:t,userSettingsStore:e})}),[t,o]),a=(0,be.jsx)(A().sA,{id:"dateAndTimeSettings.autoTimeZone.title",defaultMessage:"Set timezone automatically using your location"}),l=(0,be.jsx)(A().sA,{id:"dateAndTimeSettings.autoTimeZone.caption",defaultMessage:"Reminders, notifications and emails are delivered based on your time zone."});return(n&&(0,be.jsx)(Lt().A,{isMobile:e,title:a,caption:l,type:"toggle",isOn:!o,onToggle:()=>s(n)}))??null}var zr=()=>n(482641),Kr=()=>n(537296),Vr=()=>n(165358),qr=()=>n(668725),Wr=()=>n(229833),Gr=()=>n(89924);const Hr=function(e){const[t,o]=i.useState([]),[s,a]=i.useState([]),l=(0,r().v3)(),u=(0,d().uB)(void 0,Xo().A),p=(0,c().IS)((e=>({plainButton:{paddingInlineStart:8,paddingInlineEnd:8,marginInlineStart:-8},icon:{width:10,marginInlineStart:4,fill:e.icon.tertiary}})),[]);function g(e){return s.some((t=>t.code===e.code))}(0,i.useEffect)((()=>{const e=l.SpellCheckService;e&&(e.getAvailableLanguages().then(o).catch((e=>{Vr().log({level:"error",from:"SpellcheckerLanguagesPicker",type:"getAvailableLanguages",error:(0,Wr().convertErrorToLog)(e)})})),e.getLanguages().then(a).catch((e=>{Vr().log({level:"error",from:"SpellcheckerLanguagesPicker",type:"getLanguages",error:(0,Wr().convertErrorToLog)(e)})})))}),[l]),(0,i.useEffect)((()=>{const e=l.SpellCheckService;if(!e)return;const t=s.map((({code:e})=>e));e.setLanguages(t)}),[s,l.SpellCheckService]);const m=s.length>0?s.slice(0,3).map((({name:e})=>e)).join(", ")+(s.length>3?"â€¦":""):(0,be.jsx)(A().sA,{id:"languageRegionSettings.spellchecker.picker.label",defaultMessage:"Select languages"});return(0,be.jsx)(sr().A,{popupType:sr().z.Popup,buttonPopupStore:u,renderOrigin:e=>(0,be.jsxs)(qt().p,{style:p.plainButton,...e,children:[m,(0,qr().b)(p.icon)]}),placementToOrigin:"bottom",alignmentToOrigin:"start",render:e=>{const i=[{key:"spellcheckerlanguages",render:e=>(0,be.jsx)(Gr().A,{...e,topBorder:0!==e.index}),items:t.map((e=>{const t={key:e.code,render:t=>function(e){const t=e.language.name||e.language.code;return(0,be.jsx)(is().A,{...e.props,title:(0,be.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,be.jsx)("div",{style:{marginInlineEnd:0},children:t})}),shouldWrapCaption:!0,right:g(e.language)?(0,n(982615).$)({width:12,height:12}):void 0})}({language:e,props:t}),action:()=>{g(e)?a(s.filter((t=>t.code!==e.code))):a([...s,e])}};return t}))}],o={menuType:Zo().gu.Popup,width:240};return(0,be.jsx)(os().A,{className:ot().jtA,...o,children:(0,be.jsx)(ss().Ay,{type:ss().Oh.Vertical,initialFocus:void 0,sections:i})})}})};const Yr=function(e){const t=(0,r().v3)();return t.device.isElectron&&t.device.isWindows?(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(Gs().A,{size:24,isHidden:!0}),(0,be.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto"},children:(0,be.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",width:"100%"},children:[(0,be.jsxs)("div",{style:{flex:1},children:[(0,be.jsx)(Ee().A,{children:(0,be.jsx)(A().sA,{id:"languageRegionSettings.spellchecker.label",defaultMessage:"Spellchecker languages"})}),(0,be.jsx)(Ee().A,{isSmall:!0,isMultiline:!0,style:{width:"80%"},children:(0,be.jsx)(A().sA,{id:"languageSettings.spellcheckerSwitcher.subtitle",defaultMessage:"Change the languages used by the spellchecker."})})]}),(0,be.jsx)(Hr,{})]})})]}):null};function $r(){const e=(0,d().O$)(di().AppStoreCurrentUserSettingsStore),t=(0,d().K8)((()=>{var t;return(null==e||null===(t=e.getSettings())||void 0===t?void 0:t.preferred_locale)||Dr().q}),[e]),n=Boolean(_e().A.isMobile);if(!e)return null;const i=[{key:"timezone-auto",renderSettingsItem:()=>(0,be.jsx)(Ur,{isMobile:n})},{key:"timezone-manual",renderSettingsItem:()=>(0,be.jsx)(Fr,{isMobile:n})}].filter(bt().O9);return n?(0,be.jsxs)("div",{style:{paddingTop:48},children:[(0,be.jsx)(Ie().A,{large:!0,divider:"full",children:(0,be.jsx)(A().sA,{id:"languageSettings.languageSection.title",defaultMessage:"Language & region"})}),(0,be.jsx)(zr().o,{locale:t,userSettingsStore:e}),(0,be.jsx)(Rr().A,{})]}):(0,be.jsxs)("div",{style:{paddingTop:48},children:[(0,be.jsx)(Ie().A,{large:!0,divider:"full",children:(0,be.jsx)(A().sA,{id:"languageSettings.languageAndTimeSection.title",defaultMessage:"Language & Time"})}),(0,be.jsx)(zr().o,{locale:t,userSettingsStore:e}),(0,be.jsx)(Yr,{}),(0,be.jsx)(Gs().A,{size:18,isHidden:!0}),(0,be.jsx)(Rr().A,{}),(0,be.jsx)(Gs().A,{size:18,isHidden:!0}),(0,be.jsx)(Kr().U,{items:i})]})}const Qr=new($e().O2)("SpaceProfileSettings",(()=>n.e(30001).then(n.bind(n,570712)))),Zr=(0,$e()._h)(Qr,(e=>e.SpaceProfileSettings));var Jr=()=>n(739793),Xr=()=>n(540144);var el=()=>n(878079),tl=()=>n(617871),nl=()=>n(402904),il=()=>n(384944),ol=()=>n(53137),sl=()=>n(878710),al=()=>n(347306),rl=()=>n(963550),ll=()=>n(324254),dl=()=>n(973647),cl=()=>n(510683);function ul(e){const{currentExternalAuthentication:t,externalAuthentications:n,spaceId:o,spaceViewStore:s}=e,a=(0,r().v3)(),l=(0,r().Y0)(),u=(0,d().K8)((()=>ol().A.integrations.state.find((e=>e.id===tl().wi))),[]),g=(0,c().IS)((e=>({popupContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:14,marginTop:12},dropdownButtonContainer:{display:"flex",alignItems:"center",minWidth:0,padding:"0px 8px",borderRadius:4,marginInlineStart:8},currentValueLabel:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",flex:1},icon:{marginInlineStart:8,width:12,height:12,color:e.text.tertiary}})),[]);let m;m=l.isPhone?{menuType:Zo().gu.ActionSheet}:{menuType:Zo().gu.Popup,width:280,maxHeight:"50vh"};const f=i.useCallback((e=>n.map(((n,i)=>({key:n.id,items:[{key:n.id,action:()=>{e.close(),pl({environment:a,spaceViewStore:s,currentExternalBotId:null==t?void 0:t.parent_id,selectedExternalBotId:n.parent_id})},render:e=>(0,be.jsx)(is().A,{...e,title:n.account_name||"Discord Account",isChecked:n.id===(null==t?void 0:t.id)})}],render:e=>(0,be.jsx)(Gr().A,{...e,title:n.account_name||"Discord Account",topBorder:0!==i})})))),[null==t?void 0:t.id,null==t?void 0:t.parent_id,a,n,s]),h=i.useCallback((e=>u?[{key:"disable-notification",items:[{key:"disable-discord-notification",action:()=>{e.close(),function(e){const{environment:t,spaceViewStore:n}=e;E().createAndCommit({userAction:"NotificationsAndPersonalSettings.DiscordNotificationsAccountSetting",environment:t,canUndo:!0,perform:e=>{il().zv({store:n.getSettingsStore(),data:{notify_discord:null},transaction:e})}})}({environment:a,spaceViewStore:s})},render:e=>(0,be.jsx)(is().A,{...e,title:(0,be.jsx)(A().sA,{id:"personalDiscordNotificationsAccountDropdownButton.disableNotification.label",defaultMessage:"Off"}),isChecked:void 0===t})}],render:e=>(0,be.jsx)(Gr().A,{...e,topBorder:f.length>0})},{key:"create-new-auth",items:[{key:"connect",render:e=>(0,be.jsx)(is().A,{...e,icon:(0,ba().plusSmallIcon)({width:12,height:12}),title:(0,be.jsx)(A().sA,{id:"database.viewSettings.notificationsTab.discord.addNewAccount.label",defaultMessage:"Add new account"})}),action:async()=>{var e;const t=await cl().Jq({environment:a,integration:u,spaceId:o,from:"notifications_and_settings"});if(dl().Q.isFail(t))return;const n=null===(e=t.value.externalAuthentication)||void 0===e?void 0:e.parent_id;n&&pl({environment:a,spaceViewStore:s,currentExternalBotId:void 0,selectedExternalBotId:n})}}],render:e=>(0,be.jsx)(Gr().A,{...e,topBorder:!0})}]:[]),[t,a,f.length,o,s,u]),v=function(e){const{currentExternalAuthentication:t}=e;if(!t)return null;const n=t.account_name||"Discord Account";return n}(e);return(0,be.jsx)("div",{style:g.popupContainer,children:(0,be.jsx)(sr().A,{popupType:sr().z.Popup,alignmentToOrigin:"end",render:e=>(0,be.jsx)(os().A,{...m,children:(0,be.jsx)(ss().Ay,{type:ss().Oh.Vertical,initialFocus:0,sections:[...f(e),...h(e)]})}),renderOrigin:e=>(0,be.jsxs)(p().Ay,{...e,style:g.dropdownButtonContainer,children:[(0,be.jsx)("div",{style:g.currentValueLabel,children:v||(0,be.jsx)(A().sA,{id:"DiscordNotificationsPersonalSettingsAccountPicker.accountDropdown.selectPlaceholder",defaultMessage:"Off"})}),(0,ll().arrowChevronSingleDownSmallIcon)(g.icon)]})})})}function pl(e){const{environment:t,spaceViewStore:n,selectedExternalBotId:i,currentExternalBotId:o}=e,s=n.getSettingsStore(),a=s.getKeyStore("notify_discord").getValue();if(o!==i){const e=!o||Boolean(null==a?void 0:a.notify_discord_enabled),n=!o||Boolean(null==a?void 0:a.allow_discord_ai_usage);E().createAndCommit({userAction:"NotificationsAndPersonalSettings.DiscordNotificationsAccountSetting",environment:t,canUndo:!0,perform:t=>{il().zv({store:s,data:{notify_discord:{external_bot_id:i,notify_discord_enabled:e,allow_discord_ai_usage:n}},transaction:t})}})}}function gl(e){const t=(0,r().v3)(),{target:n}=e,o=(0,d().O$)(di().AppStoreSidebarSpaceViewStore),s=(0,d().O$)(di().AppStoreSidebarSpaceStore),a=(0,d().O$)(ol().A.externalAuthentications),l=(0,d().K8)((()=>a.filter((e=>e.integration_id===tl().wi))),[a]),c=(0,d().K8)((()=>{var e;const t=null==o||null===(e=o.getSettings())||void 0===e||null===(e=e.notify_discord)||void 0===e?void 0:e.external_bot_id;if(!t)return;const n=l.find((e=>e.parent_id===t));if(n)return n;if(!o)return;const i=(0,sl().v3)(o,{id:t,table:nl().As}),s=i.id,a=i.getKeyStore("parent_id").getValue(),r=i.getKeyStore("account_name").getValue();return s&&a&&void 0!==r?{id:s,parent_id:a,account_name:r}:void 0}),[o,l]),u=(0,d().K8)((()=>{var e;const t=null==o||null===(e=o.getSettingsStore())||void 0===e||null===(e=e.getKeyStore("notify_discord"))||void 0===e?void 0:e.getValue();switch(n){case"notify_discord_enabled":return c&&(null==t?void 0:t.notify_discord_enabled)||!1;case"allow_discord_ai_usage":return(null==t?void 0:t.allow_discord_ai_usage)||!1;case"notify_discord":return!1;default:(0,bt().HB)(n)}}),[o,n,c]),p=(0,i.useCallback)((()=>{if(o){const e=!u,i=o.getSettingsStore();let s=i.getKeyStore("notify_discord").getValue();if(!s)return;"notify_discord_enabled"===n?(s[n]=e,e||s.allow_discord_ai_usage||(s=void 0),E().createAndCommit({userAction:"DiscordNotificationsSetting.onToggle",environment:t,canUndo:!0,perform:e=>{il().zv({store:i,data:{notify_discord:s},transaction:e})}})):"allow_discord_ai_usage"===n&&(s[n]=e,E().createAndCommit({userAction:"DiscordNotificationsSetting.onToggle",environment:t,canUndo:!0,perform:e=>{il().zv({store:i,data:{notify_discord:s},transaction:e})}}))}}),[t,o,u,n]);return o&&s?"notify_discord"===n?(0,be.jsx)(Lt().A,{type:"custom",isMobile:_e().A.isMobile,title:(0,be.jsx)(rl().A,{target:n}),caption:c?(0,be.jsx)(A().sA,{id:"notificationSettings.discordNotificationsSettings.serverSelected.description",defaultMessage:"Receive notifications in {discordServerName} about mentions and comments.",values:{discordServerName:(0,be.jsx)("span",{style:{fontWeight:"bold"},children:c.account_name})}}):(0,be.jsx)(al().A,{target:n}),customButton:(0,be.jsx)(ul,{currentExternalAuthentication:c,externalAuthentications:l,spaceId:s.id,spaceViewStore:o})}):c?(0,be.jsx)(Lt().A,{isMobile:_e().A.isMobile,title:(0,be.jsx)(rl().A,{target:n}),caption:(0,be.jsx)(al().A,{target:n}),type:"toggle",isOn:u,onToggle:p}):null:null}var ml=()=>n(332381),fl=()=>n(388450);function hl(){const{isElectron:e,isElectronMac:t,isMobile:n,desktopAppId:i}=(0,r().Y0)(),a=(0,r().v3)(),l=(0,o().X)("show_discord_notion_ai_option"),c=(0,d().K8)((()=>(0,el().Z5)()),[]),u=(0,d().K8)((()=>{const o=(0,el().fb)();return function(e){const{isMobile:t,isElectron:n,isElectronMac:i,desktopAppId:o,slackFeatureGateChecks:{showSlackNotificationSetting:s,showNotionActivityNotificationsToSlackSetting:a}}=e,r=!t&&n,l=r&&i&&Boolean(o),d=n&&(0,Xr().M5)();return[t?{key:"notify_mobile",renderSettingsItem:()=>(0,be.jsx)(ml().L,{target:"notify_mobile"})}:void 0,r?{key:"notify_desktop",renderSettingsItem:()=>(0,be.jsx)(ml().L,{target:"notify_desktop"})}:void 0,d?{key:"disable_ai_meeting_notes_audio_process_detection_notification",renderSettingsItem:()=>(0,be.jsx)(ml().L,{target:"disable_ai_meeting_notes_audio_process_detection_notification"})}:void 0,l?{key:"desktop_badge",renderSettingsItem:()=>(0,be.jsx)(ml().L,{target:"desktop_badge"})}:void 0,s&&!a?{key:"notify_slack",renderSettingsItem:()=>(0,be.jsx)(fl().R,{target:"notify_slack"})}:void 0].filter(bt().O9)}({isMobile:n,isElectron:e,isElectronMac:t,desktopAppId:i,slackFeatureGateChecks:{showSlackNotificationSetting:o,showNotionActivityNotificationsToSlackSetting:c}})}),[n,e,t,i,c]),p=(0,d().K8)((()=>{var e;const t=(0,el().fb)();return function(e){const{isSlackNotificationSettingEnabled:t,showSlackNotificationSetting:n,showNotionActivityNotificationsToSlackSetting:i}=e;if(!n||!i)return[];return[{key:"notify_slack",renderSettingsItem:()=>(0,be.jsx)(fl().R,{target:"notify_slack"})},t?{key:"notify_slack_all_activity",renderSettingsItem:()=>(0,be.jsx)(fl().R,{target:"notify_slack_all_activity"})}:void 0,t?{key:"notify_slack_mention",renderSettingsItem:()=>(0,be.jsx)(fl().R,{target:"notify_slack_mention"})}:void 0].filter(bt().O9)}({isSlackNotificationSettingEnabled:Boolean(null===(e=di().default.state.sidebarSpaceViewStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.notify_slack),showSlackNotificationSetting:t,showNotionActivityNotificationsToSlackSetting:c})}),[c]),g=(0,d().K8)((()=>{var e;if(!s().default.checkGate({gateName:"enable_discord_account_connection"}))return[];return function(e){const{isDiscordNotificationSettingEnabled:t,showDiscordNotionAiOption:n}=e;return[{key:"notify_discord",renderSettingsItem:()=>(0,be.jsx)(gl,{target:"notify_discord"})},t?{key:"notify_discord_enabled",renderSettingsItem:()=>(0,be.jsx)(gl,{target:"notify_discord_enabled"})}:void 0,t&&n?{key:"allow_discord_ai_usage",renderSettingsItem:()=>(0,be.jsx)(gl,{target:"allow_discord_ai_usage"})}:void 0].filter(bt().O9)}({isDiscordNotificationSettingEnabled:Boolean(null===(e=di().default.state.sidebarSpaceViewStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.notify_discord),showDiscordNotionAiOption:l})}),[l]),m=(0,d().K8)((()=>{var e;return function(e){const{showNotifyEmailAlwaysSetting:t}=e;return[{key:"notify_email",renderSettingsItem:()=>(0,be.jsx)(ml().L,{target:"notify_email"})},t?{key:"notify_email_always",renderSettingsItem:()=>(0,be.jsx)(ml().L,{target:"notify_email_always"})}:void 0,{key:"notify_email_digest",renderSettingsItem:()=>(0,be.jsx)(ml().L,{target:"notify_email_digest"})},{key:"notify_home_digest_email",renderSettingsItem:()=>(0,be.jsx)(ml().L,{target:"notify_home_digest_email"})},{key:"marketing_emails",renderSettingsItem:()=>(0,be.jsx)(ml().L,{target:"marketing_emails"})}].filter(bt().O9)}({showNotifyEmailAlwaysSetting:(null===(e=di().default.state.sidebarSpaceViewStore)||void 0===e?void 0:e.getNotifyEmail())||!1})}),[]),f=(0,d().K8)((()=>a.WindowSizeStore.state.paddingBottomCSS),[a.WindowSizeStore]);return(0,be.jsxs)(St().Ay,{children:[u.length>0?(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(Ie().A,{large:!n,divider:"full",children:(0,be.jsx)(A().sA,{id:"notificationSettings.notificationsSection.title.v2",defaultMessage:"Notifications"})}),(0,be.jsx)(Kr().U,{items:u}),(0,be.jsx)(Gs().A,{size:48,isHidden:!0})]}):void 0,c?(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(Ie().A,{large:!n,divider:"full",children:(0,be.jsx)(A().sA,{id:"notificationSettings.slackNotificationsSection.title",defaultMessage:"Slack notifications"})}),(0,be.jsx)(Kr().U,{items:p}),(0,be.jsx)(Gs().A,{size:48,isHidden:!0})]}):void 0,g.length>0?(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(Ie().A,{large:!n,divider:"full",children:(0,be.jsx)(A().sA,{id:"notificationSettings.discordNotificationsSection.title",defaultMessage:"Discord notifications"})}),(0,be.jsx)(Kr().U,{items:g}),(0,be.jsx)(Gs().A,{size:48,isHidden:!0})]}):void 0,(0,be.jsx)(Ie().A,{large:!n,divider:"full",children:(0,be.jsx)(A().sA,{id:"notificationSettings.emailNotificationsSection.title",defaultMessage:"Email notifications"})}),(0,be.jsx)(Kr().U,{items:m}),(0,be.jsx)(Gs().A,{size:48,isHidden:!0}),(0,be.jsx)("div",{style:{marginTop:4,marginBottom:n?f:void 0},children:(0,be.jsx)(Rt().A,{title:(0,be.jsx)(A().sA,{id:"myNotificationSettings.helpButton.caption",defaultMessage:"Learn about notifications"}),href:(0,rt().x)("guides.notificationSettings"),analyticsFrom:"notifications_settings"})})]})}var vl=()=>n(471327);function yl(e){const t=(0,r().v3)(),{onView:n}=e,o=(0,A().tz)();(0,i.useEffect)((()=>{n(t)}),[t,n]);const s=o.formatMessage({id:"settingsPrompt.learnMore.button",defaultMessage:"Learn more"});return(0,be.jsxs)("div",{children:[(0,be.jsx)(Gs().A,{size:0}),(0,be.jsx)(vl().X,{icon:e.icon,title:e.title,description:e.descriptionMessage,onDismiss:e.onDismiss,primaryAction:{text:e.buttonText,onClick:t=>(e.onDismiss(),e.onClick(t)),ariaLabel:e.buttonAriaLabel},secondaryAction:{icon:_a().questionMarkCircleSmallIcon,text:s,ariaLabel:s,onClick:e.onClickLearnMore}})]})}const bl=function(e){const t=(0,c().IS)((t=>({style:{display:"flex",height:"100%",flexDirection:e.isReversed?"row-reverse":"row"},sidebarStyle:{height:"100%",background:t.background.secondary,flexGrow:0,flexShrink:0,width:240,overflowY:"auto"},childrenStyle:{flexGrow:1,position:"relative",zIndex:1,height:"100%",overflow:"hidden"}})),[e.isReversed]);return(0,be.jsxs)("div",{style:t.style,onMouseDown:e.onMouseDown,onClick:e.onClick,onDoubleClick:e.onDoubleClick,onContextMenu:e.onContextMenu,tabIndex:-1,role:"presentation",children:[(0,be.jsx)("div",{style:t.sidebarStyle,children:e.sidebar}),(0,be.jsx)("div",{style:t.childrenStyle,role:e.contentRole,"aria-labelledby":e.contentLabelledBy,id:e.contentId,children:e.children})]})};var Sl=()=>n(76590),xl=()=>n(593467),Al=()=>n(400857),Ml=()=>n(591779),wl=()=>n(301608),jl=()=>n(5347),kl=()=>n(452864);const Il=(0,v().wt)("eyePadded",{viewBox:"0 0 24 24",svg:(0,be.jsx)("path",{d:"M12 17.9912C17.6055 17.9912 21.3857 13.4727 21.3857 12.0713C21.3857 10.6699 17.5986 6.1582 12 6.1582C6.47656 6.1582 2.60742 10.6699 2.60742 12.0713C2.60742 13.4727 6.46973 17.9912 12 17.9912ZM12 16.6787C7.63184 16.6787 4.15918 13.0283 4.15918 12.0713C4.15918 11.2715 7.63184 7.4707 12 7.4707C16.3613 7.4707 19.8408 11.2715 19.8408 12.0713C19.8408 13.0283 16.3613 16.6787 12 16.6787ZM12 15.7559C14.0508 15.7559 15.6914 14.0811 15.6914 12.0713C15.6914 10.0137 14.0508 8.39355 12 8.39355C9.94238 8.39355 8.29492 10.0137 8.30176 12.0713C8.31543 14.0811 9.94238 15.7559 12 15.7559ZM12 13.2607C11.3369 13.2607 10.7969 12.7275 10.7969 12.0713C10.7969 11.415 11.3369 10.8818 12 10.8818C12.6631 10.8818 13.1963 11.415 13.1963 12.0713C13.1963 12.7275 12.6631 13.2607 12 13.2607Z"})});var Cl=()=>n(687646),Tl=()=>n(997583),_l=()=>n(249117),Pl=()=>n(655546),Bl=()=>n(175458),Dl=()=>n(733815);const Rl=640;function El({data:e,loading:t,error:n,daysFilter:o,setDaysFilter:s}){const[a,l]=(0,Tl().z)(),d=(0,c().IS)((e=>({title:{fontWeight:w().Wy.medium,fontSize:16,marginBlock:"8px 4px",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:1},titleText:{flexShrink:1},infoIcon:{marginInlineStart:4,flexShrink:0},container:{display:"flex",flexDirection:"column",gap:16},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},cardContainer:{justifyContent:"flex-start",gap:18},cardTextContainer:{alignItems:"flex-start"}})),[]),{pageViews:u,uniquePageViews:p,pagesCreated:g,pageEdits:m}=e,f=(0,r().v3)(),h=(0,i.useCallback)((e=>{Sl().Y5(f,{daysFilter:e}),s(e)}),[f,s]);return(0,be.jsxs)("div",{style:d.container,ref:a,children:[(0,be.jsxs)("div",{style:d.titleContainer,children:[(0,be.jsxs)(Ee().A,{style:d.title,children:[(0,be.jsx)("div",{style:d.titleText,children:(0,be.jsx)(A().sA,{id:"workspaceAnalytics.content.contentEngagement.title",defaultMessage:"Content engagement"})}),(0,be.jsx)(Re().A,{placement:"bottom",render:e=>(0,be.jsx)(Rt().A,{...e,href:(0,rt().x)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:d.infoIcon}),renderTooltip:()=>"all_time"!==o?(0,be.jsx)(A().sA,{id:"settings.workspaceAnalytics.contentTab.contentEngagement.tooltip.lastDays",defaultMessage:"Activity on all workspace pages (includes private and shared) over the {dateRange}",values:{dateRange:G().A.formatMessage(wl().Yr[o])}}):(0,be.jsx)(A().sA,{id:"settings.workspaceAnalytics.contentTab.contentEngagement.tooltip.allTime",defaultMessage:"All time activity on all pages in the workspace (includes private and shared)"})})]}),(0,be.jsx)(Dl().Z,{currentFilter:o,onChangeFilter:h})]}),(0,be.jsxs)(_l().xA,{gap:16,children:[(0,be.jsx)(_l().LX,{row:1,col:1,children:(0,be.jsx)(Bl().a,{style:d.cardContainer,textStyles:d.cardTextContainer,loading:t,error:n,icon:Il,iconStyles:{height:48,width:48},title:(0,be.jsx)(A().sA,{id:"workspaceAnalytics.content.contentEngagement.totalViews",defaultMessage:"{pageViews} total views",values:{pageViews:(0,be.jsx)(Pl()._,{abbreviateNumber:l<Rl,num:u})}}),byline:(0,be.jsx)(Ee().A,{isSecondaryColor:!0,children:(0,be.jsx)(A().sA,{id:"workspaceAnalytics.content.contentEngagement.uniqueViews",defaultMessage:"{uniquePageViews, plural, one {{uniquePageViews} unique page viewed} other {{uniquePageViews} unique pages viewed}}",values:{uniquePageViews:(0,be.jsx)(Pl()._,{abbreviateNumber:l<Rl,num:p})}})})})}),(0,be.jsx)(_l().LX,{row:1,col:2,children:(0,be.jsx)(Bl().a,{style:d.cardContainer,textStyles:d.cardTextContainer,loading:t,error:n,icon:Cl().k,iconStyles:{height:36,width:36},title:(0,be.jsx)(A().sA,{id:"workspaceAnalytics.content.contentEngagement.pagesCreated",defaultMessage:"{pagesCreated} pages created",values:{pagesCreated:(0,be.jsx)(Pl()._,{abbreviateNumber:l<Rl,num:g})}}),byline:(0,be.jsx)(Ee().A,{isSecondaryColor:!0,children:(0,be.jsx)(A().sA,{id:"workspaceAnalytics.content.contentEngagement.pageEdits.byline",defaultMessage:"{pageEdits} edits",values:{pageEdits:(0,be.jsx)(Pl()._,{abbreviateNumber:l<Rl,num:m})}})})})})]})]})}var Ll=()=>n(422366),Ol=()=>n(994776),Nl=()=>n(773290),Fl=()=>n(882690);const Ul=(0,A().YK)({views:{id:"workspaceAnalytics.contentTab.contentTable.viewsColumn.tooltip",defaultMessage:"Number of times users have viewed the page"},uniqueViews:{id:"workspaceAnalytics.contentTab.contentTable.uniqueViewsColumn.tooltip",defaultMessage:"Total number of users that have viewed page in the selected period"}}),zl={id:"page",headerTitle:(0,be.jsx)(Ql,{message:wl().bo.page}),renderCell:e=>(0,be.jsx)(bs().EB,{store:e.navigableBlockStore,rightIcon:(0,be.jsx)(n(663484).r,{blockStore:e.navigableBlockStore})}),widthData:{width:320,maxWidth:320},sortable:!1},Kl={id:"location",headerTitle:(0,be.jsx)(A().sA,{id:"settings.workspaceAnalytics.contentTab.allPages.table.location.name",defaultMessage:"Location"}),renderCell:e=>(0,be.jsx)(n(421645).E,{blockStore:e.navigableBlockStore,teamStore:e.teamStore}),widthData:{width:140},sortable:!1},Vl={id:"audience",headerTitle:(0,be.jsx)(Ql,{message:wl().bo.audience}),renderCell:e=>(0,be.jsx)(Ee().A,{children:(0,n(592010).Z)(e.audience)}),widthData:{width:140},sortable:!1},ql={id:"views",headerTitle:(0,be.jsx)(Fl().Z,{tooltipMessageDescriptor:Ul.views,columnHeader:wl().bo.allViews}),renderCell:e=>(0,be.jsx)(Ee().A,{children:e.views.toLocaleString()}),widthData:{width:100},sortable:!0},Wl={id:"uniqueViews",headerTitle:(0,be.jsx)(Fl().Z,{tooltipMessageDescriptor:Ul.uniqueViews,columnHeader:wl().bo.uniqueViews}),renderCell:e=>(0,be.jsx)(Ee().A,{children:e.uniqueViews.toLocaleString()}),widthData:{width:100},sortable:!0},Gl={id:"createdBy",headerTitle:(0,be.jsx)(Ql,{message:wl().bo.createdBy}),renderCell:e=>e.createdById?(0,be.jsx)(Nl().T,{store:e.navigableBlockStore,actorPointers:e.createdById?[{table:V().oo,id:e.createdById}]:[]}):null,widthData:{width:140},sortable:!1},Hl={id:"createdTime",headerTitle:(0,be.jsx)(Ql,{message:wl().bo.createdAt}),renderCell:e=>(0,be.jsx)(Vo().d,{dateTs:e.createdTime}),widthData:{width:100},sortable:!1},Yl=[zl,ql,Wl,Kl,Vl,{id:"lastEditedBy",headerTitle:(0,be.jsx)(Ql,{message:wl().bo.lastEditedBy}),renderCell:e=>e.lastEditedById?(0,be.jsx)(Nl().T,{store:e.navigableBlockStore,actorPointers:e.lastEditedById?[{table:V().oo,id:e.lastEditedById}]:[]}):null,widthData:{width:140},sortable:!1},{id:"lastEditedTime",headerTitle:(0,be.jsx)(Ql,{message:wl().bo.lastEditedAt}),renderCell:e=>(0,be.jsx)(Vo().d,{dateTs:e.lastEditedTime}),widthData:{width:100},sortable:!1},Gl,Hl];function $l({navigableBlockStores:e,analyticsByPageId:t,runNewSearch:n,sort:o,setSort:s,loadNextPage:a,loading:r,error:l}){const u=(0,d().K8)((()=>e.map((e=>{var n,i,o;return{id:e.id,isClickable:!1,navigableBlockStore:e,teamStore:(0,Ll().U)(e),views:(null===(n=t.get(e.id))||void 0===n?void 0:n.pageViews)||0,uniqueViews:(null===(i=t.get(e.id))||void 0===i?void 0:i.uniquePageViews)||0,createdTime:e.getCreatedTime(),lastEditedTime:e.getLastEditedTime(),createdById:e.getCreatedById(),lastEditedById:e.getLastEditedById(),audience:(null===(o=t.get(e.id))||void 0===o?void 0:o.audience)||"private"}}))),[e,t]),p=(0,i.useMemo)((()=>function(e){const t=Yl.find((t=>"pageViews"===e.field&&"views"===t.id||"uniquePageViews"===e.field&&"uniqueViews"===t.id)),n=t?{column:t,sortAscending:"asc"===e.direction}:void 0;return n}(o)),[o]),g=(0,c().IS)((e=>(0,De().rC)({columnRenderInfo:Yl,theme:e,containerMarginTop:0})),[]),m=(0,c().IS)((e=>({emptyQuery:{marginTop:15,marginBottom:40,textAlign:"center"},loadingSpinner:{margin:"24px auto 24px"}})),[]);return l?(0,be.jsx)(Ol().t,{error:l,runNewSearch:n}):(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(De().WE,{hideHeaderRowPadding:!0,allowHorizontalScroll:!0,setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:Yl,rows:u,sortState:p,onSortStateChanged:e=>{s(function(e){const t="views"===e.column.id?"pageViews":"uniquePageViews",n=e.sortAscending?"asc":"desc";return{field:t,direction:n}}(e))},loadMoreMethod:{type:"scroll",onLoadMore:a},renderNoRowsComponent:()=>(0,be.jsx)(Ee().A,{isSmall:!0,style:m.emptyQuery,children:r||0!==e.length?void 0:(0,be.jsx)(A().sA,{id:"settings.workspaceAnalytics.contentTab.allPages.table.empty",defaultMessage:"No pages found with your query."})}),styles:g}),r?(0,be.jsx)(Fo().A,{style:m.loadingSpinner}):null]})}function Ql({message:e}){const t=(0,A().tz)();return(0,be.jsx)(be.Fragment,{children:t.formatMessage(e)})}var Zl=()=>n(179034),Jl=()=>n(148832);const Xl={query:"",createdBy:[],lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},teamIds:[]},ed={field:"pageViews",direction:"desc"},td=xl().Jb,nd={filters:Xl,sort:ed,timeRange:td,navigableBlockIds:[],analyticsByPageId:new Map,numPagesLoaded:0,paginationToken:void 0,hasNextPage:!0,loading:!1,error:void 0,shouldReRunSearch:!1};var id=()=>n(435761);function od({spaceStore:e,teamStores:t,timeRange:n,filters:i,runNewSearch:o,setFilters:s,setTimeRange:a}){const r=(0,id().xJ)({spaceStore:e}),l=(0,id().gc)({spaceStore:e,teams:r.teams}).map((e=>e.store)),u=(0,d().K8)((()=>t??l),[t,l]),p=(0,c().IS)((e=>({container:{width:"100%",margin:"0 auto 14px"},filterPillsContainer:{width:"100%",display:"flex",flexWrap:"wrap",rowGap:4,flexDirectionRow:"row",alignItems:"center"},timeRangeContainer:{display:"flex",flexDirectionRow:"row",alignItems:"center",justifyContent:"center",gap:4,borderInlineEnd:`1px solid ${e.tableDividerColor}`,marginInlineEnd:12,paddingInlineEnd:6}})),[]);return(0,be.jsxs)("div",{style:p.container,children:[(0,be.jsx)(wo().nv,{mode:wo().Ke.OnChange,query:i.query,setQueryFilter:function(e){s({query:e},{runSearchAfter:!0})},placeholderText:G().A.formatMessage(wo().Jj.titleOnlyPlaceholder)}),(0,be.jsxs)("div",{style:p.filterPillsContainer,children:[(0,be.jsxs)("div",{style:p.timeRangeContainer,children:[(0,be.jsx)(Ee().A,{isSecondaryColor:!0,children:(0,be.jsx)(A().sA,{id:"settings.workspaceAnalytics.contentTab.timeRange",defaultMessage:"Views from"})}),(0,be.jsx)(Dl().Z,{currentFilter:n,onChangeFilter:a})]}),(0,be.jsx)(Do().j,{selectedTeamIds:i.teamIds,setSelectedTeamIds:function(e){s({teamIds:e})},onMenuClose:o,teamStores:u}),(0,be.jsx)(Io().Q,{spaceStore:e,createdByFilterIds:i.createdBy,setCreatedByFilter:function(e){s({createdBy:e})},runNewSearch:o,includeGuests:!1}),(0,be.jsx)(Co().Z,{lastEditedTime:i.lastEditedTime,createdTime:i.createdTime,setLastEditedTime:function(e){s({lastEditedTime:e,createdTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})},setCreatedOnTime:function(e){s({createdTime:e,lastEditedTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})}})]})]})}function sd({spaceStore:e,teamStores:t,contentEngagement:n}){var o;const a=(0,Ml().ZC)(e.id),l=(0,i.useRef)(!1),{loadNextPage:u,navigableBlockStores:p,analyticsByPageId:g,runNewSearch:m,setFilters:f,setTimeRange:h,timeRange:v,filters:y,sort:b,setSort:S,loading:x,error:A}=function({spaceStore:e}){const t=(0,r().v3)(),[n,o]=(0,i.useState)(nd),s=(0,i.useRef)(Xl),a=(0,i.useRef)(ed),l=(0,i.useRef)(td),d=(0,i.useCallback)((async({fetchFromFirstPage:i,ignoreSearchInputComparison:r})=>{const d=!M().n4(n.filters,s.current)||!M().n4(n.sort,a.current)||!M().n4(n.timeRange,l.current);if(!r&&!d)return;s.current=n.filters,a.current=n.sort,l.current=n.timeRange;let c=n.loading,u=n.error,p=n.hasNextPage,g=n.paginationToken;if(i&&(o((e=>({...nd,filters:e.filters,timeRange:e.timeRange,sort:e.sort}))),c=nd.loading,u=nd.error,p=nd.hasNextPage,g=nd.paginationToken),!p||c)return;if(u)return;o((e=>({...e,loading:!0})));const m=await q().callApi({eventName:"loadContentAnalytics",environment:t,data:{spaceId:e.id,sort:n.sort,titleQuery:n.filters.query,filters:{inTeams:n.filters.teamIds,lastEditedTime:(0,ye().ES)(n.filters.lastEditedTime),createdTime:(0,ye().ES)(n.filters.createdTime),createdBy:n.filters.createdBy},timeRange:n.timeRange,startCursor:g}});if("failed"===m.type)return void o((e=>({...e,loading:!1,error:m.error})));const f=m.data.results;o((e=>{const t=[],n=new Set(e.navigableBlockIds),i=new Map(e.analyticsByPageId);for(const s of f){const e=s.id,o=s.analytics;n.has(e)||(t.push(e),i.set(e,o))}const o=[...e.navigableBlockIds,...t];return{...e,navigableBlockIds:o,analyticsByPageId:i,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:m.data.nextCursor,hasNextPage:Boolean(m.data.nextCursor)}}))}),[t,e,n.filters,n.sort,n.timeRange,n.loading,n.error,n.hasNextPage,n.paginationToken]),c=(0,i.useMemo)((()=>n.navigableBlockIds.map((e=>new(Jl().B)(t,{id:e,table:Zl().ev})))),[n.navigableBlockIds,t]);(0,i.useEffect)((()=>{n.shouldReRunSearch&&(o((e=>({...e,shouldReRunSearch:!1}))),d({fetchFromFirstPage:!0,ignoreSearchInputComparison:!1}))}),[n.shouldReRunSearch,d]);const u=(0,i.useCallback)((async()=>{n.shouldReRunSearch||await d({fetchFromFirstPage:!1,ignoreSearchInputComparison:!0})}),[n.shouldReRunSearch,d]),p=(0,i.useCallback)((async e=>{await d({fetchFromFirstPage:!0,ignoreSearchInputComparison:e||!1})}),[d]),g=(0,i.useCallback)(((e,n)=>{o((t=>({...t,filters:{...t.filters,...e},...null!=n&&n.runSearchAfter?{shouldReRunSearch:null==n?void 0:n.runSearchAfter}:void 0})));for(const i of(0,bt().uv)(e))M().n4(e[i],Xl[i])||Sl().Tm(t,{filter:i,value:"createdBy"===i||"teamIds"===i?e[i]:void 0})}),[t]),m=(0,i.useCallback)((e=>{o((t=>({...t,timeRange:e,shouldReRunSearch:!0}))),Sl().$s(t,{daysFilter:e})}),[t]),f=(0,i.useCallback)((e=>{o((t=>({...t,sort:e,shouldReRunSearch:!0}))),Sl().PH(t,{column:e.field,isAscending:"asc"===e.direction})}),[t]);return{filters:n.filters,sort:n.sort,timeRange:n.timeRange,analyticsByPageId:n.analyticsByPageId,loading:n.loading,error:n.error,navigableBlockStores:c,loadNextPage:u,runNewSearch:p,setFilters:g,setTimeRange:m,setSort:f}}({spaceStore:e}),w=(0,c().IS)((e=>({container:{display:"flex",flexDirection:"column",gap:16}})),[]),j=(0,d().K8)((()=>{const t=s().default.checkGate({gateName:"allow_space_member_to_export_analytics"});return Boolean(e.canAdmin())||t&&e.canRead()}),[e]),k=(0,i.useMemo)((()=>void 0!==a&&e.id!==a),[e.id,a]);(0,i.useEffect)((()=>{l.current&&!k||(m(!0),l.current=!0)}),[m,k]);const I=(0,d().K8)((()=>e.getName()),[e]);if("NotFoundError"===(null==n||null===(o=n.error)||void 0===o?void 0:o.name))return(0,be.jsx)(kl().H,{type:"empty",spaceName:I});const C={...y,daysFilter:v,lastEditedTime:(0,ye().ES)(y.lastEditedTime),createdTime:(0,ye().ES)(y.createdTime)};return(0,be.jsxs)("div",{style:w.container,children:[(0,be.jsx)(El,{data:n.data,loading:n.loading,error:n.error,daysFilter:n.daysFilter,setDaysFilter:n.setDaysFilter}),(0,be.jsx)(ad,{canExport:j,filters:C}),(0,be.jsx)(od,{spaceStore:e,teamStores:t,runNewSearch:m,setFilters:f,filters:y,timeRange:v,setTimeRange:h}),(0,be.jsx)($l,{navigableBlockStores:p,analyticsByPageId:g,runNewSearch:m,sort:b,setSort:S,loadNextPage:u,loading:x,error:A})]})}function ad(e){const t=(0,c().IS)((()=>({sectionTitle:{fontWeight:w().Wy.semibold,fontSize:16},sectionTitleSection:{display:"flex",flexFlow:"row",alignItems:"center"},helpInfo:{marginInlineStart:4},wrapper:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:12},exportButton:{marginInlineStart:5}})),[]),{canExport:n,filters:i}=e,{daysFilter:o}=i,s=(0,be.jsxs)("div",{style:t.sectionTitleSection,children:[(0,be.jsx)(Ee().A,{style:t.sectionTitle,children:(0,be.jsx)(A().sA,{id:"settings.workspaceAnalytics.contentTab.allPages.title",defaultMessage:"Pages"})}),(0,be.jsx)(Re().A,{placement:"bottom",render:e=>(0,be.jsx)(Rt().A,{...e,href:(0,rt().x)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:t.helpInfo}),renderTooltip:()=>"all_time"!==o?(0,be.jsx)(A().sA,{id:"settings.workspaceAnalytics.contentTab.pages.tooltip.lastDays",defaultMessage:"Activity from the {dateRange} on pages you have access to",values:{dateRange:G().A.formatMessage(wl().Yr[o])}}):(0,be.jsx)(A().sA,{id:"settings.workspaceAnalytics.contentTab.pages.tooltip.allTime",defaultMessage:"All time activity on pages you have access to in the workspace"})})]});return(0,be.jsxs)("div",{style:t.wrapper,children:[s,n?(0,be.jsx)(jl().L,{style:t.exportButton,analyticsType:hi().e.Content,filters:i}):void 0]})}var rd=()=>n(957963),ld=()=>n(385527),dd=()=>n(374255);const cd=640;function ud({data:e,loading:t,error:n,daysFilter:o,setDaysFilter:s}){const a=(0,r().v3)(),{organizationOwnerRecordCache:l}=(0,i.useContext)(na().N),u=(0,c().IS)((e=>({title:{fontWeight:w().Wy.medium,fontSize:16,marginBlock:"9px 4px",display:"flex",alignItems:"center",overflow:"hidden"},titleText:{...w().RC,flexShrink:1},helpInfo:{marginInlineStart:4},container:{display:"flex",flexDirection:"column",gap:16},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},overviewCard:{width:"fit-content"}})),[]),[p,g]=(0,Tl().z)(),{pageViews:m,uniquePageViews:f,pageEdits:h,topPages:v}=e,y=(0,d().K8)((()=>v.map((({pageId:e,pageViews:t})=>({store:new(Jl().B)(a,{id:e,table:Zl().ev},{inMemoryRecordCache:l}),caption:(0,be.jsx)(A().sA,{id:"workspaceAnalytics.overview.contentEngagement.caption.pageView",defaultMessage:"{pageViews} views",values:{pageViews:(0,be.jsx)(Pl()._,{abbreviateNumber:!1,num:t})}})})))),[a,v,l]),b=(0,i.useCallback)((e=>{s(e),Sl().n_(a,{filter:"content_engagement",daysFilter:e})}),[a,s]);return(0,be.jsxs)("div",{style:u.container,ref:p,children:[(0,be.jsxs)("div",{style:u.titleContainer,children:[(0,be.jsxs)(Ee().A,{style:u.title,children:[(0,be.jsx)("div",{style:u.titleText,children:(0,be.jsx)(A().sA,{id:"workspaceAnalytics.overview.contentEngagement.title",defaultMessage:"Content engagement"})}),(0,be.jsx)(Re().A,{placement:"bottom",render:e=>(0,be.jsx)(Rt().A,{...e,href:(0,rt().x)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:u.helpInfo}),renderTooltip:()=>"all_time"!==o?(0,be.jsx)(A().sA,{id:"settings.workspaceAnalytics.overviewTab.contentEngagement.tooltip.lastDays",defaultMessage:"Activity on all pages in the workspace over the {dateRange}",values:{dateRange:G().A.formatMessage(wl().Yr[o])}}):(0,be.jsx)(A().sA,{id:"settings.workspaceAnalytics.overviewTab.contentEngagement.tooltip.allTime",defaultMessage:"All time activity on all pages in the workspace"})})]}),(0,be.jsx)(Dl().Z,{currentFilter:o,onChangeFilter:b})]}),(0,be.jsxs)(_l().xA,{gap:16,children:[(0,be.jsx)(_l().LX,{row:1,col:1,colEnd:3,children:(0,be.jsx)(Bl().a,{loading:t,error:n,icon:Il,textStyles:u.overviewCard,title:(0,be.jsx)(A().sA,{id:"workspaceAnalytics.overview.contentEngagement.views",defaultMessage:"{pageViews} total views",values:{pageViews:(0,be.jsx)(Pl()._,{abbreviateNumber:g<cd,num:m})}})})}),(0,be.jsx)(_l().LX,{row:2,col:1,colEnd:3,children:(0,be.jsx)(Bl().a,{loading:t,error:n,icon:ld().h,textStyles:u.overviewCard,iconStyles:{height:18,width:18},title:(0,be.jsx)(A().sA,{id:"workspaceAnalytics.overview.contentEngagement.uniqueViews",defaultMessage:"{uniquePageViews, plural, one {{uniquePageViews} unique page viewed} other {{uniquePageViews} unique pages viewed}}",values:{uniquePageViews:(0,be.jsx)(Pl()._,{abbreviateNumber:g<cd,num:f})}})})}),(0,be.jsx)(_l().LX,{row:3,col:1,colEnd:3,children:(0,be.jsx)(Bl().a,{loading:t,error:n,icon:rd().j,textStyles:u.overviewCard,iconStyles:{height:18,width:18},title:(0,be.jsx)(A().sA,{id:"workspaceAnalytics.overview.contentEngagement.pageEdits",defaultMessage:"{pageEdits} edits",values:{pageEdits:(0,be.jsx)(Pl()._,{abbreviateNumber:g<cd,num:h})}})})}),(0,be.jsx)(_l().LX,{row:1,rowEnd:4,col:3,colEnd:5,children:(0,be.jsx)(dd().N,{loading:t,error:n,title:(0,be.jsx)(A().sA,{id:"workspaceAnalytics.overview.contentEngagement.popularPages",defaultMessage:"Most popular pages"}),items:y})})]})]})}var pd=()=>n(82139);function gd({onUserTabFilterChange:e,spaceStore:t,contentEngagement:n,userEngagement:i}){var o,s;const a=(0,c().IS)((e=>({container:{display:"flex",flexDirection:"column",gap:24}})),[]),r=(0,d().K8)((()=>t.getName()),[t]);if("NotFoundError"===(null===(o=n.error)||void 0===o?void 0:o.name)||"NotFoundError"===(null===(s=i.error)||void 0===s?void 0:s.name))return(0,be.jsx)(kl().H,{type:"empty",spaceName:r});return(0,be.jsxs)("div",{style:a.container,children:[(0,be.jsx)(pd().R,{data:i.data,loading:i.loading,error:i.error,daysFilter:i.daysFilter,setDaysFilter:function(t){e({graphFilter:"all_time"===t?"last_90_days":t}),i.setDaysFilter(t)}}),(0,be.jsx)(ud,{data:n.data,loading:n.loading,error:n.error,daysFilter:n.daysFilter,setDaysFilter:n.setDaysFilter})]})}var md=()=>n(63964),fd=()=>n(254685);const hd={[hi().e.Overview]:(0,be.jsx)(A().sA,{id:"workspaceAnalyticsTabs.overview.title",defaultMessage:"Overview"}),[hi().e.Users]:(0,be.jsx)(A().sA,{id:"workspaceAnalyticsTabs.members.title",defaultMessage:"Members"}),[hi().e.Content]:(0,be.jsx)(A().sA,{id:"workspaceAnalyticsTabs.content.title",defaultMessage:"Content"}),[hi().e.Search]:(0,be.jsx)(A().sA,{id:"workspaceAnalyticsTabs.search.title",defaultMessage:"Search"}),[hi().e.AI]:(0,be.jsx)(A().sA,{id:"workspaceAnalyticsTabs.ai.title",defaultMessage:"AI"})};function vd(e){const{currentTab:t,spaceAnalyticsStoreState:n,onUserTabFilterChange:i,spaceStore:o}=e;switch(t){case hi().e.Content:return(0,be.jsx)(sd,{spaceStore:o,contentEngagement:e.contentEngagementData});case hi().e.Users:return(0,be.jsx)(fd().A,{spaceStore:o,usersTabData:n.usersTabData,onUserTabFilterChange:i,userEngagement:e.userEngagementData});case hi().e.Overview:return(0,be.jsx)(gd,{contentEngagement:e.contentEngagementData,userEngagement:e.userEngagementData,spaceStore:o,onUserTabFilterChange:i});case hi().e.Search:return(0,be.jsx)(md().A,{spaceStore:o});case hi().e.AI:return(0,be.jsx)(Al().q,{spaceStore:o});default:(0,bt().HB)(t)}}const yd=function({spaceStore:e}){const t=(0,c().IS)((e=>({headingStyle:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:w().Wy.medium,display:"flex",justifyContent:"space-between"},title:{display:"flex",alignItems:"center"},helpInfo:{marginInlineStart:4},tabsStyle:{paddingInlineStart:0,paddingInlineEnd:0,marginTop:-6,marginBottom:14}})),[]),s=(0,r().v3)(),a=(0,jo().T)(),l=(0,n(23534).M)({spaceId:e.id}),u=(0,n(807106)._)({spaceStore:e,userId:a}),[p,g]=(0,d().$y)(hi().A),m=(0,d().K8)((()=>Boolean(null==e?void 0:e.getSettings().disable_page_analytics)),[e]),f=(0,d().K8)((()=>null==e?void 0:e.getName()),[e]),h=(0,o().X)("ai_analytics_space"),v=(0,i.useCallback)((async t=>{await xl().OJ({environment:s,spaceStore:e,currentTab:p.currentTab,currentSpaceId:p.currentSpaceId,usersTabData:p.usersTabData,setState:g,graphFilter:t.graphFilter,tableFilter:t.tableFilter})}),[s,e,p,g]),y=(0,i.useCallback)((e=>{Sl().Wt(s,{tab:e}),g({...p,currentTab:e})}),[g,p,s]),b=(0,d().K8)((()=>{const t=Boolean(null==e?void 0:e.canAdmin()),n=[];return t&&n.push(hi().e.Overview,hi().e.Users),n.push(hi().e.Content),h&&t&&n.push(hi().e.AI),t&&n.push(hi().e.Search),n}),[e,h]),S=b.length>1,x=p.currentTab||b[0];(0,i.useEffect)((()=>{!async function(){const t=e.id;t&&hi().A.shouldRefreshState(t)&&(x===hi().e.Users?await v({graphFilter:"last_90_days",tableFilter:"last_90_days"}):x===hi().e.Content||x===hi().e.Overview||x===hi().e.Search||x===hi().e.AI||(0,bt().HB)(x))}()}));const M=(0,i.useCallback)((()=>{(0,P().L)({environment:s,url:(0,rt().x)("guides.workspaceAnalytics")})}),[s]),j=b.map((e=>hd[e])),k=m?(0,be.jsx)(kl().H,{type:"disabled",spaceName:f}):(0,be.jsxs)(be.Fragment,{children:[S?(0,be.jsx)(xt().Ay,{tabs:j,selectedIndex:b.indexOf(x),onChange:e=>{y(b[e])},style:t.tabsStyle}):void 0,vd({currentTab:x,spaceAnalyticsStoreState:p,onUserTabFilterChange:v,spaceStore:e,contentEngagementData:l,userEngagementData:u})]});return(0,be.jsxs)(St().Ay,{children:[(0,be.jsxs)(Ie().A,{large:!0,style:t.headingStyle,children:[(0,be.jsxs)("div",{style:t.title,children:[(0,be.jsx)(A().sA,{id:"settings.workspaceAnalytics.title",defaultMessage:"Workspace analytics"}),(0,be.jsx)(Re().A,{placement:"right",render:e=>(0,be.jsx)(Rt().A,{...e,href:(0,rt().x)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:t.helpInfo}),renderTooltip:()=>(0,be.jsx)(A().sA,{id:"settings.workspaceAnalytics.dataDisclaimerTooltip",defaultMessage:"Data available from the start date of your Enterprise Plan"})})]}),(0,be.jsx)(Mt().A,{size:"sm",onClick:M,iconLeading:{icon:_a().questionMarkCircleSmallIcon,size:"sm"},children:(0,be.jsx)(A().sA,{id:"workspaceAnalytics.title.helpButton",defaultMessage:"Learn more"})})]}),(0,St().J_)(),k]})};var bd=()=>n(452177),Sd=()=>n(701763),xd=()=>n(240865);function Ad(){const e=(0,d().K8)((()=>{const{sidebarSpaceStore:e}=di().default.state;return e}),[]),t=(0,Mn().lh)({spaceId:null==e?void 0:e.id});return(0,d().K8)((()=>{if(!e)return!1;const n=(0,S().AI)(t);return(0,x().dL)(n)||(0,x().Pg)(n)}),[e,t])}var Md=()=>n(232461);function wd(){const e=(0,d().O$)(di().AppStoreSidebarSpaceStore),t=(0,Md().J)(),n=(0,d().K8)((()=>{const t=null==e?void 0:e.getModel();if(!e||!t)return!1;const n=e.getSubscriptionTier();return"personal"===e.getPlanType()||"enterprise"!==n}),[e]);return!(!t||!n)}var jd=()=>n(910609),kd=()=>n(334992),Id=()=>n(709438),Cd=()=>n(304231),Td=()=>n(792223),_d=()=>n(777967),Pd=()=>n(888867),Bd=()=>n(329443),Dd=()=>n(970209),Rd=()=>n(280161);function Ed({spaceStore:e,spacePermissionsSettingsStore:t}){const{canUseGroups:n,canEditGroups:i,isSpaceStoreDefined:s}=function({spaceStore:e}){const t=(0,Td().zh)(),{canEditMembership:n,isSpaceStoreDefined:i}=(0,d().K8)((()=>({canEditMembership:e.canEditMembership(),isSpaceStoreDefined:e.isDefined()})),[e]),o=n&&t;return{canUseGroups:t,canEditMembership:n,canEditGroups:o,isSpaceStoreDefined:i}}({spaceStore:e}),a=(0,d().K8)((()=>0!==(0,An().zI)()),[]),r=(0,d().K8)((()=>0!==(0,Bd().Qo)()),[]),l=(0,o().X)("upgrade_system_settings");return s?(0,be.jsxs)("div",{children:[n?!r&&(0,be.jsx)(Ee().A,{isMultiline:!0,style:{marginTop:17,marginBottom:17},children:a?(0,be.jsx)(A().sA,{id:"spacePermissionsSettings.groupsTab.captionWithTeamsV2",defaultMessage:"Set up groups to streamline page permissions from the share menu and manage teamspace members in bulk."}):(0,be.jsx)(A().sA,{id:"spacePermissionsSettings.groupsTab.caption",defaultMessage:"Set up groups to conveniently control page permissions from the share menu."})}):l?void 0:(0,be.jsx)(Dd().A,{subscriptionTier:"plus",from:"permission_groups",icon:Pd().s,title:(0,be.jsx)(A().sA,{id:"spacePermissionsSettings.groupsTab.upgradeTitle",defaultMessage:"Upgrade to create groups"}),caption:(0,be.jsx)(A().sA,{id:"spacePermissionsSettings.groupsTab.upgradeCaption.plus",defaultMessage:"Upgrade to the Plus Plan to set up groups and control permissions from the share menu."}),learnMoreRoute:"guides.groups"}),(0,be.jsx)(Rd().r,{spaceStore:e,permissionsSettingsStore:t,canEdit:i,containerMarginTop:n?0:void 0,upsell:!n&&l?{type:"product",product:"plus",limit:{type:"none"},trialability:"none"}:void 0})]}):null}var Ld=()=>n(30537);const Od=(0,v().xh)("personCropCircleBadgePlus",{default:{loader:()=>n.e(89509).then(n.bind(n,582094))},small:{loader:()=>n.e(89509).then(n.bind(n,845052))},fill:{loader:()=>n.e(89509).then(n.bind(n,845324))},fillSmall:{loader:()=>n.e(89509).then(n.bind(n,478419))}},["person","add","user","new","plus"]);var Nd=()=>n(980427),Fd=()=>n(496414),Ud=()=>n(618841),zd=()=>n(592674),Kd=()=>n(460292),Vd=()=>n(748868),qd=()=>n(70899);const Wd=(0,v().xh)("checkmarkShield",{default:{loader:()=>Promise.resolve().then(n.bind(n,15936))},small:{loader:()=>Promise.resolve().then(n.bind(n,105062))},fill:{loader:()=>Promise.resolve().then(n.bind(n,681242))},fillSmall:{loader:()=>Promise.resolve().then(n.bind(n,452745))}},["checkmark","shield","protect","secure","validate"]);var Gd=()=>n(105062),Hd=()=>n(101163),Yd=()=>n(252953),$d=()=>n(785606),Qd=()=>n(19575),Zd=()=>n(803025),Jd=()=>n(567865);const Xd=(0,A().YK)({infoTitle:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.title",defaultMessage:"Find teammates more easily by filtering to your workspaceâ€™s email domains"},infoDescription:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.description",defaultMessage:"Upgrade these guests to members for better collaboration and reduced page-by-page permissions."},emailDomainTooltip:{defaultMessage:"Your workspaceâ€™s email domains include allowed email domains, verified domains, and workspace owner email domains.",id:"spacePermissionsSettings.guestsTab.internalGuestBanner.tooltip"},overLimitTitle:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.overLimit.title",defaultMessage:"Your workspace is over the {limit}-guest limit"},upsellDescription:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.overLimit.upselldescription",defaultMessage:"Find teammates who are currently guests by filtering to your workspaceâ€™s email domains and upgrade them to members to continue collaborating. To get more guest seats, <upgradelink>upgrade your plan</upgradelink> or <saleslink>reach out to sales</saleslink>."},contactSalesDescription:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.overLimit.contactSales.description",defaultMessage:"Find teammates who are currently guests by filtering to your workspaceâ€™s email domains and upgrade them to members to continue collaborating. To get more guest seats, <saleslink>reach out to sales</saleslink>."},salesAssistedDescription:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.overLimit.salesAssisted.description",defaultMessage:"Find teammates who are currently guests by filtering to your workspaceâ€™s email domains and upgrade them to members to continue collaborating. To get more guest seats, reach out to your account manager."},nonAdminTooltip:{id:"spacePermissionsSettings.guestsTab.internalGuestBanner.overLimit.nonAdmin.tooltip",defaultMessage:"New users can continue to be added as members. To resume adding guests, contact your workspace owner to upgrade or remove existing guests from your workspace."}}),ec={warning_upsell:{iconGroup:Yd().A,tint:"yellow",label:Xd.overLimitTitle,description:Xd.upsellDescription,tooltip:Xd.emailDomainTooltip},warning_contact_sales:{iconGroup:Yd().A,tint:"yellow",label:Xd.overLimitTitle,description:Xd.contactSalesDescription,tooltip:Xd.emailDomainTooltip},warning_sales_assisted:{iconGroup:Yd().A,tint:"yellow",label:Xd.overLimitTitle,description:Xd.salesAssistedDescription,tooltip:Xd.emailDomainTooltip},warning_nonadmin:{iconGroup:Yd().A,tint:"yellow",label:Xd.overLimitTitle,tooltip:Xd.nonAdminTooltip},info:{iconGroup:Wd,tint:"gray",label:Xd.infoTitle,description:Xd.infoDescription,tooltip:Xd.emailDomainTooltip}};function tc({spaceStore:e,internalDomains:t,domainFilterValues:n,setDomainFilterValues:i}){const o=(0,Td().r1)({spaceStore:e}),s=t.length>0;if(!s)return null;const a=s&&o,r=(0,be.jsx)(nc,{spaceStore:e});return a||r?(0,be.jsxs)(yt().Y1,{padding:"16px 0px",gap:16,children:[r,a?(0,be.jsx)(ic,{internalDomains:t,domainFilterValues:n??[],setDomainFilterValues:i}):void 0]}):null}function nc({spaceStore:e}){const t=function({spaceStore:e}){const t=(0,r().v3)(),n=(0,Td().r1)({spaceStore:e}),i=t.currentUser.id,o=e.id,s=(0,zt()._X)({name:"internal_guests",spaceId:o,userId:i,amount:0}),a=(0,Mn().lh)({spaceId:o}),l=(0,S().AI)(a),c=(0,Zd().q)(),u=(0,d().K8)((()=>(0,Xs().RL)({currentSubscriptionTier:l,salesStatus:c})),[l,c]);if(!s)return null;return(0,Dt().N9)(s,{available:()=>n?{...ec.info,messageValues:{}}:null,unavailable:({limit:e,upsell:t})=>n?"sales_assisted"===c?{...ec.warning_sales_assisted,messageValues:{limit:e.total}}:"none"===t.type||"enterprise"===t.product&&!u?{...ec.warning_contact_sales,messageValues:{limit:e.total,saleslink:e=>(0,be.jsx)(zn().A,{onClick:()=>(0,Qd().lK)({initialQuestion:"manage_guests",openedFrom:"people_guest_limit_banner"}),children:e})}}:"product"===t.type?{...ec.warning_upsell,messageValues:{limit:e.total,saleslink:e=>(0,be.jsx)(zn().A,{onClick:()=>(0,Qd().lK)({initialQuestion:"manage_guests",openedFrom:"people_guest_limit_banner"}),children:e}),upgradelink:e=>(0,be.jsx)(zn().A,{onClick:()=>{At().A.setState({...At().A.state,currentTab:"plans",defaultSubtab:void 0})},children:e})}}:(0,bt().HB)(t):{...ec.warning_nonadmin,messageValues:{limit:e.total}}})}({spaceStore:e});if(!t)return null;const n=(0,be.jsx)(Re().A,{style:{width:250},textWrap:!0,renderTooltip:()=>(0,be.jsx)(A().sA,{...t.tooltip}),originGap:6,placement:"bottom",alignment:"start",render:e=>(0,be.jsx)("div",{style:{paddingInlineStart:3,display:"inline-block",verticalAlign:"text-bottom"},...e,children:(0,be.jsx)(g().I,{icon:_a().questionMarkCircleSmallIcon,size:"sm"})})});return(0,be.jsx)($d().I,{children:(0,be.jsx)(ea().l,{iconGroup:t.iconGroup,display:"inline",tint:t.tint,label:(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(A().sA,{...t.label,values:t.messageValues}),t.description?void 0:n]}),description:t.description&&(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(A().sA,{...t.description,values:t.messageValues}),n]})})})}function ic({internalDomains:e,domainFilterValues:t,setDomainFilterValues:n}){const i=[...e.map((e=>({key:e.url,value:`${e.url}`,title:oc({domain:`${e.url}`})}))),{key:"other",value:"other",title:oc({domain:"other"})}];return(0,be.jsx)(Jd().uI,{pillIcon:qd().U,pillTitle:t?(0,be.jsx)(A().sA,{id:"spacePermissionsSettings.guestsTab.internalDomainFilter.filtered",defaultMessage:"Email domain: {domainFilter}",values:{domainFilter:t.join(", ")}}):(0,be.jsx)(A().sA,{id:"spacePermissionsSettings.guestsTab.internalDomainFilter.placeholder",defaultMessage:"Email domain"}),selectedItems:t,setSelectedItems:e=>{n(e)},items:i})}function oc({domain:e}){return(0,be.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4},children:["other"===e?(0,be.jsx)(A().sA,{defaultMessage:"Other",id:"spacePermissionsSettings.guestsTab.internalDomainFilter.otherOptionLabel"}):`@${e}`,(0,be.jsx)(g().I,{icon:"other"===e?Hd().globeSmallIcon:Gd().checkmarkShieldSmallIcon,size:"sm"})]})}var sc=()=>n(124092),ac=()=>n(842599);const rc={viewBox:"0 0 20 20",fittedViewBox:"1.68 2.37 17.29 15.26",svg:(0,be.jsx)("path",{d:"M5.326 3.617C5.946 2.844 6.863 2.375 8 2.375s2.055.47 2.675 1.242c.608.757.9 1.765.9 2.824s-.292 2.066-.9 2.824c-.62.772-1.538 1.241-2.675 1.241s-2.054-.469-2.674-1.241c-.608-.758-.9-1.766-.9-2.824 0-1.059.292-2.067.9-2.824M1.88 14.935C2.899 12.945 5.3 11.63 8 11.63s5.101 1.316 6.12 3.306c.361.706.199 1.421-.23 1.923-.412.48-1.06.767-1.74.767h-8.3c-.68 0-1.328-.287-1.74-.767-.429-.502-.591-1.217-.23-1.923m16.996-7.958a.625.625 0 0 0-1.072-.643L15.25 10.59l-1.435-1.675a.625.625 0 1 0-.95.814l2 2.333a.625.625 0 0 0 1.011-.085z"})},lc=(0,v().wt)("personCheckmarkFill",rc),dc={viewBox:"0 0 20 20",fittedViewBox:"1.68 2.37 17.01 15.26",svg:(0,be.jsx)("path",{d:"M8 2.375c-1.137 0-2.054.47-2.674 1.242-.608.757-.9 1.765-.9 2.824s.292 2.066.9 2.824c.62.772 1.537 1.241 2.674 1.241s2.055-.469 2.675-1.241c.608-.758.9-1.766.9-2.824 0-1.059-.292-2.067-.9-2.824-.62-.773-1.538-1.242-2.675-1.242m0 9.255c-2.7 0-5.101 1.315-6.12 3.305-.361.706-.199 1.421.23 1.923.412.48 1.06.767 1.74.767h8.3c.68 0 1.328-.287 1.74-.767.429-.502.591-1.217.23-1.923C13.1 12.945 10.7 11.63 8 11.63m10.486-4.693a.625.625 0 0 1 0 .884L16.807 9.5l1.68 1.68a.625.625 0 1 1-.884.883l-1.68-1.68-1.68 1.68a.625.625 0 0 1-.883-.884L15.04 9.5l-1.68-1.68a.625.625 0 1 1 .884-.883l1.68 1.68 1.678-1.68a.625.625 0 0 1 .884 0"})},cc=(0,v().wt)("personXmarkFill",dc);var uc=()=>n(196131),pc=()=>n(471995);const gc=5;function mc({request:e,shouldDisableInteraction:t,requestType:n,handleApprove:o,handleDecline:s}){const a=function({shouldDisableInteraction:e}){return(0,c().IS)((t=>({approveButton:{background:t.outlineBlueButtonHoveredBackground,color:t.blue.text.accentPrimary,fontWeight:510,fontSize:14,borderRadius:4,paddingInlineStart:10,paddingInlineEnd:10},declineButton:{marginInlineEnd:10,borderRadius:4,paddingInlineStart:10,paddingInlineEnd:10},container:{opacity:e?.5:1,display:"flex",width:"100%",justifyContent:"flex-end"}})),[e])}({shouldDisableInteraction:t}),[l,d]=(0,i.useState)(!1),u=(0,r().v3)(),p=(0,i.useCallback)((()=>{Sd().jR(u,{from:`${n}_request`,button_name:"decline"}),s(e)}),[u,n,e,s]),g=(0,i.useCallback)((async()=>{d(!0),Sd().jR(u,{from:`${n}_request`,button_name:"approve"}),await o(e),d(!1)}),[u,e,n,o]);return(0,be.jsxs)("div",{style:a.container,children:[(0,be.jsx)("div",{children:(0,be.jsx)(qt().p,{style:a.declineButton,onClick:p,disabled:t,children:(0,be.jsx)(A().sA,{id:"spaceSettings.peopleSection.requestsTable.Decline",defaultMessage:"Decline"})})}),(0,be.jsx)("div",{children:(0,be.jsx)(qt().p,{style:a.approveButton,onClick:g,isLoading:l,disabled:t,children:(0,be.jsx)(A().sA,{id:"spaceSettings.peopleSection.requestsTable.approve",defaultMessage:"Approve"})})})]})}function fc({isModalOpen:e,handleDismiss:t,handleConfirm:n,title:i,description:o,ctaText:s}){const{styles:a}=function(){const e=(0,c().IS)((e=>({modal:{width:300,overflow:"hidden",borderRadius:5},container:{display:"flex",paddingTop:20,paddingInlineEnd:20,paddingBottom:12,paddingInlineStart:20,flexDirection:"column",width:299,justifyContent:"center",alignItems:"flex-start",gap:20},iconAndTitle:{display:"flex",flexDirection:"column",alignItems:"center",gap:9,width:"100%"},iconContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:36,height:36},icon:{color:e.icon.secondary,fontSize:24,fontWeight:510},title:{color:e.text.primary,textAlign:"center",fontSize:17,fontWeight:590,width:"100%",wordBreak:"break-word"},description:{color:e.text.secondary,textAlign:"center"},footer:{display:"flex",flexDirection:"column",gap:8,alignItems:"center",width:"100%"},declineButton:{height:32,padding:"0 12px",borderRadius:6,width:"100%",textAlign:"center",alignItems:"center",justifyContent:"center",background:e.red.background.accentPrimary},declineButtonHovered:{background:(0,p().i)({color:e.red.background.accentPrimary,mode:e.mode})},declineText:{fontWeight:590,color:e.text.inversePrimary},cancelButton:{display:"flex",height:24,padding:"0px 6px",justifyContent:"center",alignItems:"center",gap:4,textAlign:"center"}})),[]);return{styles:e}}();return(0,ut().A)({shouldPreserveTextSelection:!0,shouldPreserveBlockSelection:!0,shouldRestoreSelection:!0}),(0,be.jsx)(On().a,{open:e,innerStyle:a.modal,showCloseIcon:!0,onDismiss:t,render:()=>(0,be.jsx)(Hs().A,{capture:!0,allowEsc:!0,render:()=>(0,be.jsxs)("div",{style:a.container,children:[(0,be.jsxs)("div",{style:a.iconAndTitle,children:[(0,be.jsx)("div",{style:a.iconContainer,children:(0,be.jsx)("div",{style:a.icon,children:cc({width:24,height:24})})}),(0,be.jsx)("div",{style:a.title,children:i})]}),(0,be.jsx)("div",{style:a.description,children:o}),(0,be.jsxs)("div",{style:a.footer,children:[(0,be.jsx)(qt().p,{style:a.declineButton,onClick:()=>{n(),t()},hoveredStyle:a.declineButtonHovered,children:(0,be.jsx)("div",{style:a.declineText,children:s})}),(0,be.jsx)(qt().p,{style:a.cancelButton,onClick:t,children:(0,be.jsx)("div",{children:(0,be.jsx)(A().sA,{id:"BulkDeclineConfirmationDialog.cancel",defaultMessage:"Cancel"})})})]})]})})})}function hc(e){const{isModalOpen:t,handleClickDecline:n,handleClickDismiss:o,requestType:s,requests:a}=e,l=function(e,t,n){const o=(0,r().v3)();return(0,i.useCallback)((()=>{n(),Sd().jR(o,{from:"member"===e?"member_request":"guest_request",button_name:"dismiss_in_dialog",count:t.length})}),[n,o,t,e])}(s,a,o),c=(0,A().tz)(),u=(0,d().K8)((()=>{var e;return null===(e=a[0])||void 0===e||null===(e=e.createdByActorsWithReason[0])||void 0===e?void 0:e.actor.getDisplayName(c)}),[a,c]),p=(0,d().K8)((()=>{var e;return null===(e=a[0])||void 0===e?void 0:e.forActor.email}),[a]);return 0===a.length?null:(0,be.jsx)(fc,{isModalOpen:t,handleDismiss:l,handleConfirm:()=>n(a),title:(0,be.jsx)(A().sA,{id:"RequestBulkDeclineConfirmationDialog.title",defaultMessage:"Decline {numberOfRequests, plural, one {{requestType} request for {firstRequestEmail}} other {{numberOfRequests} {requestType} requests}}?",values:{numberOfRequests:a.length,requestType:s,firstRequestEmail:p}}),description:(0,be.jsx)(A().sA,{id:"RequestBulkDeclineConfirmationDialog.description",defaultMessage:"{numberOfRequests, plural, one {To add them as a {requestType} in the future, {inviter} must resubmit a request, or an admin must invite them} other {Requests must be resubmitted, or an admin must add them as {isMemberRequest, select, true {members} other {guests}} in the future}}.",values:{numberOfRequests:a.length,requestType:s,isMemberRequest:"member"===s,inviter:u}}),ctaText:(0,be.jsx)(A().sA,{id:"RequestBulkDeclineConfirmationDialog.decline",defaultMessage:"Decline"})})}function vc({createdByActorsWithReason:e,latestRequestTime:t}){return(0,be.jsx)("div",{style:{width:241,maxHeight:600,overflowY:"auto",whiteSpace:"pre-wrap",paddingTop:12,paddingInlineEnd:12,paddingBottom:12,paddingInlineStart:12},children:e.map((e=>(0,be.jsx)(yc,{createdByActorWithReason:e,latestRequestTime:t},e.actor.id)))})}function yc({createdByActorWithReason:e,latestRequestTime:t}){const{requestorName:n,reason:i,actor:o,styles:s}=function({createdByActorWithReason:e}){const{actor:t,reason:n}=e,i=(0,A().tz)(),o=(0,d().K8)((()=>t.getDisplayName(i)),[i,t]),s=(0,c().IS)((e=>({avatar:{width:24,height:24},metadata:{display:"flex",alignItems:"center",gap:6,flex:"1 0 0"},userName:{textOverflow:"ellipsis",fontSize:14,fontWeight:510,overflow:"hidden",width:100,whiteSpace:"nowrap"},timestamp:{color:e.text.tertiary,textAlign:"end",fontSize:12,fontWeight:400,lineHeight:"15px"},header:{display:"flex",alignItems:"center",gap:10},reason:{paddingInlineStart:30,fontSize:14,fontWeight:400,color:e.text.primary,display:"inline-block",overflowWrap:"break-word",inlineSize:200},noReason:{color:e.text.quaternary}})),[]);return{requestorName:o,reason:n,actor:t,styles:s}}({createdByActorWithReason:e});return(0,be.jsxs)("div",{children:[(0,be.jsxs)("div",{style:s.header,children:[(0,be.jsx)(ar().A,{hasTooltip:!0,userValue:o,style:s.avatar,size:24,avatarShouldShowShadow:!1}),(0,be.jsxs)("div",{style:s.metadata,children:[(0,be.jsx)("div",{style:s.userName,children:n}),(0,be.jsx)(Ee().A,{isSmall:!0,isSecondaryColor:!0,isMultiline:!0,style:s.timestamp,children:(0,Uo().nl)(t)})]})]}),(0,be.jsx)("span",{style:s.reason,children:i||(0,be.jsx)("div",{style:s.noReason,children:(0,be.jsx)(A().sA,{id:"requestReasonContent.noReason",defaultMessage:"No message"})})})]})}function bc({request:e,shouldDisableInteraction:t,requestType:n}){const{styles:i,firstRequestorName:o,numberOfRequestors:s}=function({request:e,shouldDisableInteraction:t}){const n=(0,c().IS)((e=>({firstRequestorName:{opacity:t?.5:1,maxWidth:118,...w().RC},buttonSuffix:{color:e.text.tertiary,paddingInlineStart:4},chevron:{width:10,marginInlineStart:4,fill:e.icon.secondary}})),[t]),i=(0,r().v3)(),o=(0,A().tz)(),s=(0,d().K8)((()=>{if(0===e.createdByActorsWithReason.length)return;return new(ve().L)(i,{table:V().oo,id:e.createdByActorsWithReason[0].actor.id}).getDisplayName(o)}),[i,o,e.createdByActorsWithReason]);return{styles:n,firstRequestorName:s,numberOfRequestors:e.createdByActorsWithReason?e.createdByActorsWithReason.length:0}}({request:e,shouldDisableInteraction:t}),a=(0,r().v3)();return void 0===o||0===s?null:(0,be.jsx)(sr().A,{popupType:sr().z.Popup,onClick:()=>{Sd().jR(a,{from:`${n}_request`,button_name:"open_requested_by"})},renderOrigin:e=>(0,be.jsx)(qt().p,{...e,disabled:t,children:(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)("span",{style:i.firstRequestorName,title:o,children:o}),(0,be.jsx)("span",{style:i.buttonSuffix,children:s>1?(0,be.jsxs)("div",{children:["+",s-1]}):null}),(0,qr().b)(i.chevron)]})}),render:()=>(0,be.jsx)(vc,{createdByActorsWithReason:e.createdByActorsWithReason,latestRequestTime:e.accessRequest.created_time})})}var Sc=()=>n(312788),xc=()=>n(584262),Ac=()=>n(492414),Mc=()=>n(305390),wc=()=>n(597703);function jc({guestUserId:e,pageIds:t}){const{menuListItems:n,styles:o,noAccessPageCount:s}=function({guestUserId:e,pageIds:t}){const{navigate:n}=(0,i.useContext)(Sc().E),o=(0,c().IS)((()=>({container:{width:300},chevron:{marginInlineStart:8,width:16,height:16}})),[]),s=(0,r().v3)(),{menuListItems:a,noAccessPageCount:l}=(0,d().K8)((()=>{let e=0;const i=[];return t.forEach((t=>{const o=new(Jl().B)(s,{table:Zl().ev,id:t});if(!o.canAdmin())return void(e+=1);const a={key:t,render:e=>(0,be.jsx)(Mc().A,{...e,store:o}),action:()=>{const e=(0,Ac().Ay)({store:o,fullyQualified:!1,pageVisitSource:xc().y8.LinkInPage});n({environment:s,url:e,openInNew:"tab"})}};i.push(a)})),{menuListItems:i,noAccessPageCount:e}}),[t,s,n]);return{menuListItems:a,styles:o,noAccessPageCount:l}}({guestUserId:e,pageIds:t});if(s>0){const e={key:"guest-pages-content-no-access-summary",render:e=>(0,be.jsx)(wc().H,{...e,noAccessPageCount:s}),action:()=>{}};n.push(e)}return(0,be.jsx)("div",{style:o.container,children:(0,be.jsx)(ss().Ay,{type:ss().Oh.Vertical,initialFocus:void 0,sections:[{key:"pages",render:e=>(0,be.jsx)(Gr().A,{...e}),items:n}]})})}function kc({from:e,guestUserId:t,pageIds:n,shouldDisableInteraction:i}){const{styles:o}=function({shouldDisableInteraction:e}){const t=(0,c().IS)((t=>({button:{opacity:e?.5:1},chevron:{width:10,marginInlineStart:4,fill:t.icon.secondary}})),[e]);return{styles:t}}({shouldDisableInteraction:i}),s=(0,r().v3)(),a=n.length;return 0===a?(0,be.jsx)(qt().p,{disabled:!0,style:o.button,children:(0,be.jsx)(A().sA,{id:"peopleSectionguestsTab.GuestPagesButton.noPages",defaultMessage:"No pages"})}):(0,be.jsx)(sr().A,{popupType:sr().z.Popup,onClick:()=>{Sd().jR(s,{from:e,button_name:"open_pages"})},renderOrigin:e=>(0,be.jsxs)(qt().p,{...e,style:o.button,children:[(0,be.jsx)(A().sA,{id:"GuestPagesButton.button",defaultMessage:"{numOfPages, plural, one {{numOfPages} page} other {{numOfPages} pages}}",values:{numOfPages:a}}),(0,qr().b)(o.chevron)]}),disabled:i,render:()=>(0,be.jsx)(jc,{pageIds:n,guestUserId:t})})}function Ic({request:e,spaceStore:t,shouldDisableInteraction:n}){const{accessRequest:i,forActor:o}=e,s=function({accessRequest:e}){return(0,d().K8)((()=>e.isGuestInviteRequest()?e.getAttributes().permission_records_and_roles.map((e=>e.id)):[]),[e])}({accessRequest:i});return(0,be.jsx)(kc,{pageIds:s,guestUserId:o.id,shouldDisableInteraction:n,from:"guest_request"})}var Cc=()=>n(854150),Tc=()=>n(95758);function _c({spaceStore:e,request:t}){const{teamStores:i}=function({request:{accessRequest:e},spaceStore:t}){const n=(0,id().xJ)({spaceStore:t}),i=(0,id().gc)({spaceStore:t,teams:n.teams}).map((e=>e.store)),o=(0,d().K8)((()=>{var n,o;const s=i.filter((e=>e.isDefault())),a=null===(n=e.getAttributes())||void 0===n?void 0:n.origin_table,r=null===(o=e.getAttributes())||void 0===o?void 0:o.origin_id;if(a&&r){const e=Tc().h.createChildStore(t,{table:Cc().yK,id:r});s.includes(e)||s.push(e)}return s}),[e,t,i]);return{teamStores:o}}({request:t,spaceStore:e});return(0,be.jsx)(n(37625).RR,{teamsForMember:i})}function Pc({request:e,spaceStore:t}){const{relativeDate:n,email:i,userStore:o,styles:s}=function({request:{accessRequest:e,forActor:t},spaceStore:n}){const i=(0,c().IS)((e=>({container:{display:"flex",alignItems:"center",fontSize:w().J.UIRegular.desktop,gap:10,flex:"1 0 0",maxWidth:50},userAvatar:{},title:{height:17,alignSelf:"stretch",fontSize:w().J.UIRegular.desktop,fontStyle:"normal",fontWeight:510,lineHeight:"18px",maxWidth:160,...w().RC},subtitle:{height:17,alignSelf:"stretch",fontSize:w().J.UISmall.desktop,fontStyle:"normal",fontWeight:400,lineHeight:"15px",color:e.text.secondary,maxWidth:160,...w().RC}})),[]),o=ve().L.createChildStore(n,{table:V().oo,id:t.id}),s=(0,d().K8)((()=>o.getEmail()),[o]),a=(0,A().tz)(),r=(0,d().K8)((()=>e.created_time),[e]),l=N().KQ(r,(0,oe().P)()),u=(0,Fa().ZF)({value:l,date_format:"relative",userTimeZone:(0,oe().P)(),intl:a,allowRelativeDates:!0});return{email:s,styles:i,userStore:o,relativeDate:u}}({request:e,spaceStore:t});return(0,be.jsxs)("div",{style:s.container,children:[(0,be.jsx)(ar().A,{style:s.userAvatar,userStore:o,size:28}),(0,be.jsxs)("div",{children:[(0,be.jsx)("div",{style:s.title,title:i,children:i}),(0,be.jsx)("div",{style:s.subtitle,title:n,children:n})]})]})}var Bc=()=>n(762286);function Dc({spaceStore:e,requests:t,requestType:n,domainFilterValues:o,internalDomains:s}){const a=(0,r().v3)(),[l,u]=(0,i.useState)(gc),[p,m]=(0,i.useState)({column:Rc,sortAscending:!0}),f=(0,d().K8)((()=>Bc().A.state.searchQuery),[]),[h,v]=(0,i.useState)([]),{rows:y,hasMore:b}=function({spaceStore:e,requestType:t,requests:n,searchQuery:i,domainFilters:o=[],internalDomains:s=[],limit:a,selectedRowIds:r,sortState:l}){const c=(0,d().K8)((()=>n.map((n=>{const i=ve().L.createChildStore(e,{table:V().oo,id:n.forActor.id});return{id:n.accessRequest.id,spaceStore:e,isClickable:!1,request:n,requestType:t,email:i.getEmail(),shouldDisableInteraction:r.includes(n.accessRequest.id)}}))),[e,t,n,r]),u=(0,M().oE)(o),p=c.filter((e=>{var t;const n=e.email?(0,ac().zN)(e.email):void 0,o=(0,uc().C7)(e.email,s);return!(i&&(null===(t=e.email)||void 0===t||!t.includes(i)))&&(!(u.length>0)||u.some((e=>"other"===e?!o:n===e)))})),g=function(e,{sortAscending:t}){const n=(0,M().Ul)(e,(e=>e.email));t||n.reverse();return n}(p,l),m=g.length>a;return{rows:g.slice(0,a),hasMore:m}}({spaceStore:e,requestType:n,requests:t,domainFilters:(0,M().oE)(o),internalDomains:s,searchQuery:f,limit:l,sortState:p,selectedRowIds:h}),S=(0,i.useMemo)((()=>t.filter((e=>h.includes(e.accessRequest.id)))),[t,h]),[x,w]=(0,i.useState)(!1),[j,k]=(0,i.useState)(void 0),I=!y.some((e=>h.includes(e.id))),C=(0,i.useCallback)((async()=>{w(!0),Sd().jR(a,{from:`${n}_request`,button_name:"bulk_approve",count:S.length});const t=await Fc({environment:a,spaceStore:e,requests:S.map((e=>e.accessRequest)),requestType:n,status:"approved"});w(!1),t&&v([])}),[a,e,S,n]),T=(0,i.useCallback)((()=>{Sd().jR(a,{from:`${n}_request`,button_name:"bulk_decline",count:S.length}),k(S)}),[a,n,k,S]),_=(0,i.useCallback)((()=>k(void 0)),[k]),P=function({requestType:e,onClickApprove:t,onClickDecline:n}){return"member"===e?[Rc,Ec,Oc,Nc({onClickApprove:t,onClickDecline:n})]:[Rc,Lc,Oc,Nc({onClickApprove:t,onClickDecline:n})]}({requestType:n,onClickApprove:t=>Fc({environment:a,spaceStore:e,requests:[t.accessRequest],requestType:n,status:"approved"}),onClickDecline:e=>k([e])}),B=(0,c().IS)((e=>({container:{paddingBottom:30},headerContainer:{display:"flex",justifyContent:"space-between"},titleContainer:{display:"flex",alignItems:"center",gap:6,alignSelf:"stretch",fontSize:"14px",fontStyle:"normal",fontWeight:510,minHeight:30,paddingTop:10},titleNumber:{color:e.text.tertiary},actionsContainer:{display:"flex",borderRadius:6,border:`1px solid ${e.border.primary}`,boxShadow:"0px 2px 12px 0px rgba(29, 27, 22, 0.06)"},actionLeftButton:{borderStartStartRadius:4,borderStartEndRadius:0,borderEndEndRadius:0,borderEndStartRadius:4,paddingInlineStart:10,paddingInlineEnd:0,height:30},buttonContainerApprove:{display:"flex",paddingTop:0,paddingInlineEnd:12,paddingBottom:0,paddingInlineStart:0,justifyContent:"center",alignItems:"center",gap:4,alignSelf:"stretch",color:e.blue.text.accentPrimary},buttonContainerDecline:{display:"flex",paddingTop:0,paddingInlineEnd:12,paddingBottom:0,paddingInlineStart:10,justifyContent:"center",alignItems:"center",gap:4,alignSelf:"stretch",color:e.text.secondary},buttonIcon:{width:20,height:20,paddingTop:1,flexDirection:"column",justifyContent:"center",alignItems:"center",gap:10},buttonText:{fontSize:14,fontWeight:510},buttonDivider:{width:1,background:e.border.secondary},actionRightButton:{borderStartStartRadius:0,borderStartEndRadius:4,borderEndEndRadius:4,borderEndStartRadius:0,paddingInlineStart:0,paddingInlineEnd:0,height:30},noRowContainer:{display:"flex",height:32,padding:"0px 4px",alignItems:"center",borderBottom:`1px solid ${e.border.primary}`},noRowText:{color:e.text.secondary,fontSize:14,fontWeight:400,textAlign:"center"}})),[]),D=function(e){return(0,c().IS)((t=>({...(0,De().rC)({columnRenderInfo:e,theme:t,containerMarginTop:0})})),[e])}(P);return 0===t.length?null:(0,be.jsxs)("div",{style:B.container,children:[(0,be.jsxs)("div",{style:B.headerContainer,children:[(0,be.jsxs)("div",{style:B.titleContainer,children:[(0,be.jsx)("div",{children:(0,be.jsx)(A().sA,{id:"peopleSectionMembersTab.memberRequests.title",defaultMessage:"Requests"})}),(0,be.jsx)("span",{style:B.titleNumber,children:t.length})]}),h.length>0&&!I?(0,be.jsxs)("div",{style:B.actionsContainer,children:[(0,be.jsx)(sc().p,{style:B.actionLeftButton,onClick:C,isLoading:x,children:(0,be.jsxs)("div",{style:B.buttonContainerApprove,children:[(0,be.jsx)("div",{style:B.buttonIcon,children:(0,be.jsx)(g().I,{icon:lc})}),(0,be.jsx)("div",{style:B.buttonText,children:(0,be.jsx)(A().sA,{id:"spaceSettings.peopleSection.requestsTable.bulkApprove",defaultMessage:"Approve {numberOfRequests, plural, one {1 request} other {{numberOfRequests} requests}}",values:{numberOfRequests:h.length}})})]})}),(0,be.jsx)("div",{style:B.buttonDivider}),(0,be.jsx)(sc().p,{style:B.actionRightButton,onClick:T,isLoading:!1,children:(0,be.jsxs)("div",{style:B.buttonContainerDecline,children:[(0,be.jsx)("div",{style:B.buttonIcon,children:(0,be.jsx)(g().I,{icon:cc})}),(0,be.jsx)("div",{style:B.buttonText,children:(0,be.jsx)(A().sA,{id:"spaceSettings.peopleSection.requestsTable.bulkDecline",defaultMessage:"Decline"})})]})})]}):void 0]}),(0,be.jsx)("div",{style:{marginTop:4},children:(0,be.jsx)(De().WE,{allowHorizontalScroll:!0,setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:P,rows:y,showRowBorders:!0,hideHeaderRowPadding:!0,sortState:p,onSortStateChanged:m,renderNoRowsComponent:()=>(0,be.jsx)("div",{style:B.noRowContainer,children:(0,be.jsx)("div",{style:B.noRowText,children:(0,be.jsx)(A().sA,{id:"peopleSectionRequestTable.emptySearch",defaultMessage:"No search results"})})}),styles:D,getStyleForRow:e=>{if(e.shouldDisableInteraction)return{backgroundColor:"rgba(35, 131, 226, 0.07)"}},loadMoreMethod:b?{type:"button",onLoadMore:()=>u(l+gc)}:void 0,multiselect:t.length>0?{header:{isDisabled:0===y.length,isSelected:h.length>0&&h.length===y.length,onClick:()=>{h.length===y.length?(v([]),Sd().Y1(a,{from:`${n}_request`,action:"deselect_all",row_count:h.length})):(v(y.map((e=>e.id))),Sd().Y1(a,{from:`${n}_request`,action:"select_all",row_count:y.length}))}},row:{getDisabledState:e=>!1,getSelectedState:e=>h.includes(e.id),onClick:e=>{v((t=>t.includes(e.id)?(Sd().Y1(a,{from:`${n}_request`,action:"deselect_row",row_count:1}),t.filter((t=>t!==e.id))):(Sd().Y1(a,{from:`${n}_request`,action:"select_row",row_count:1}),t.concat(e.id))))}}}:void 0})}),(0,be.jsx)(hc,{isModalOpen:(0,bt().O9)(j),requestType:n,requests:j??[],handleClickDecline:async t=>{await Fc({environment:a,spaceStore:e,requests:t.map((e=>e.accessRequest)),requestType:n,status:"rejected"})&&v([]),k(void 0)},handleClickDismiss:_})]})}const Rc={id:"user",headerTitle:(0,be.jsx)("div",{style:{fontSize:14},children:(0,be.jsx)(A().sA,{id:"peopleSectionRequestsTable.user",defaultMessage:"User"})}),renderCell:e=>(0,be.jsx)(Pc,{request:e.request,spaceStore:e.spaceStore}),widthData:{width:219},sortable:!0},Ec={id:"teamspaces",headerTitle:(0,be.jsx)("div",{style:{paddingInlineStart:8,fontSize:14},children:(0,be.jsx)(A().sA,{id:"peopleSectionRequestsTable.teamspaces",defaultMessage:"Teamspaces"})}),renderCell:e=>(0,be.jsx)(_c,{spaceStore:e.spaceStore,request:e.request}),widthData:{width:175},sortable:!1},Lc={id:"pages",headerTitle:(0,be.jsx)("div",{style:{paddingInlineStart:8,fontSize:14,minWidth:175,textAlign:"start"},children:(0,be.jsx)(A().sA,{id:"peopleSectionRequestsTable.pages",defaultMessage:"Access"})}),renderCell:e=>(0,be.jsx)(Ic,{request:e.request,spaceStore:e.spaceStore,shouldDisableInteraction:e.shouldDisableInteraction}),widthData:{width:175},sortable:!1},Oc={id:"requestBy",headerTitle:(0,be.jsx)("div",{style:{paddingInlineStart:8,fontSize:14,minWidth:160,textAlign:"start"},children:(0,be.jsx)(A().sA,{id:"peopleSectionRequestsTable.requestBy",defaultMessage:"Requested by"})}),renderCell:e=>(0,be.jsx)(bc,{request:e.request,shouldDisableInteraction:e.shouldDisableInteraction,requestType:e.requestType}),widthData:{width:120},sortable:!1};function Nc({onClickApprove:e,onClickDecline:t}){return{id:"actions",headerTitle:(0,be.jsx)("div",{style:{minWidth:155}}),renderCell:n=>(0,be.jsx)(mc,{request:n.request,shouldDisableInteraction:n.shouldDisableInteraction,requestType:n.requestType,handleApprove:e,handleDecline:t}),widthData:{width:100},sortable:!1}}async function Fc({environment:e,spaceStore:t,requests:n,requestType:i,status:o}){if(0===n.length)return!0;let s;if("member"===i){const i=n.filter((e=>"guest_invite_request"!==e.getType())),a=n.filter((e=>"guest_invite_request"===e.getType())),r=await j().p4({environment:e,store:t,requests:i,status:o,from:"requests_center"}),l=await j().KB({environment:e,store:t,requests:a,status:o,from:"requests_center"});s={failedUsers:r.failedUsers.concat(l.failedUsers),resolvedUsers:r.resolvedUsers.concat(l.resolvedUsers)}}else"guest"===i?s=await j().aV({environment:e,requests:n,status:o,from:"requests_center"}):(0,bt().HB)(i);const a=function({requestType:e,result:{resolvedUsers:t,failedUsers:n},status:i}){if("guest"===e&&"approved"===i&&t.length>0)return{label:(0,be.jsx)(A().sA,{id:"PeopleSectionRequestsTable.bulkApproveToast.guests",defaultMessage:"Approved {numberOfSuccesses, plural, one {guest request for {userEmail}} other {{numberOfSuccesses} guest requests}}",values:{numberOfSuccesses:t.length,userEmail:t[0].getEmail()}})};if("guest"===e&&"approved"===i&&n.length>0)return{label:(0,be.jsx)(A().sA,{id:"PeopleSectionRequestsTable.bulkApproveToast.guests.failed",defaultMessage:"Failed approve {numberOfRequests, plural, one {guest request for {userEmail}} other {{numberOfRequests} guest requests}}, please try again.",values:{numberOfRequests:n.length,userEmail:n[0].getEmail()}})};if("guest"===e&&"rejected"===i&&t.length>0)return{label:(0,be.jsx)(A().sA,{id:"PeopleSectionRequestsTable.bulkDeclineToast.guests.success",defaultMessage:"Declined {numberOfSuccesses, plural, one {guest request for {userEmail}} other {{numberOfSuccesses} guest requests}}",values:{numberOfSuccesses:t.length,userEmail:t[0].getEmail()}})};if("guest"===e&&"rejected"===i&&n.length>0)return{label:(0,be.jsx)(A().sA,{id:"PeopleSectionRequestsTable.bulkDeclineToast.guests.failed",defaultMessage:"Failed decline {numberOfSuccesses, plural, one {guest request for {userEmail}} other {{numberOfSuccesses} guest requests}}, please try again.",values:{numberOfSuccesses:n.length,userEmail:n[0].getEmail()}})};if("member"===e&&"approved"===i&&t.length>0)return{label:(0,be.jsx)(A().sA,{id:"PeopleSectionRequestsTable.bulkApproveToast.members.success",defaultMessage:"Approved {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}",values:{numberOfRequests:t.length,userEmail:t[0].getEmail()}})};if("member"===e&&"approved"===i&&n.length>0)return{label:(0,be.jsx)(A().sA,{id:"PeopleSectionRequestsTable.bulkApproveToast.members.failed",defaultMessage:"Failed to approve {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}, please try again.",values:{numberOfRequests:n.length,userEmail:n[0].getEmail()}})};if("member"===e&&"rejected"===i&&t.length>0)return{label:(0,be.jsx)(A().sA,{id:"PeopleSectionRequestsTable.bulkDeclineToast.members.success",defaultMessage:"Declined {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}",values:{numberOfRequests:t.length,userEmail:t[0].getEmail()}})};if("member"===e&&"rejected"===i&&n.length>0)return{label:(0,be.jsx)(A().sA,{id:"PeopleSectionRequestsTable.bulkDeclineToast.members.failed",defaultMessage:"Failed to decline {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}, please try again.",values:{numberOfRequests:n.length,userEmail:n[0].getEmail()}})};return}({requestType:i,result:s,status:o});return a&&pc().D6(a),0===s.failedUsers.length}var Uc=()=>n(911259),zc=()=>n(35588),Kc=()=>n(205224),Vc=()=>n(118789),qc=()=>n(710149),Wc=()=>n(368401),Gc=()=>n(278238),Hc=()=>n(589407);class Yc extends $().Store{getInitialState(){return{isModalOpen:!1,guests:[],handleClickDecline:()=>{}}}}const $c=new Yc;function Qc({userId:e,spaceStore:t,shouldDisableInteraction:n}){const{environment:o,styles:s,isSubscribed:a,handleConvertToMemberClick:l,handleRemoveClick:u}=function({userId:e,spaceStore:t,shouldDisableInteraction:n}){const o=(0,c().IS)((e=>({container:{width:"100%",display:"flex",justifyContent:"flex-end",opacity:n?.5:1},button:{display:"flex",width:24,height:24,justifyContent:"center",alignItems:"center",gap:10,paddingInlineStart:0,paddingInlineEnd:0},buttonIcon:{width:20,height:20,fill:e.icon.secondary},upgradeButton:{paddingTop:0,paddingBottom:0,width:257},removeMenuDivider:{paddingTop:4,paddingBottom:4,borderTop:`1px solid ${e.border.secondary}`},removeButton:{width:257,paddingTop:0,paddingBottom:0,color:Gc().l8[e.mode].red}})),[n]),s=(0,d().K8)((()=>{const e=yo().subscriptionDataStoreInstance.state;return Boolean(e&&Wn().Fq(e))}),[]),a=(0,r().v3)(),l=(0,i.useCallback)((()=>{const n=ve().L.createChildStore(t,{table:V().oo,id:e}),i=s?"member":"owner";Kc().P({environment:a,guestUserStore:n,membershipType:i,store:t,origin:"guest_pages_popup"})}),[s,t,a,e]),u=(0,i.useCallback)((()=>{$c.setState({...$c.state,isModalOpen:!0,guests:[e],handleClickDecline:()=>{Sd().jR(a,{from:"guest",button_name:"confirm_in_dialog",count:1});const n=ve().L.createChildStore(t,{table:V().oo,id:e});Kc().D({environment:a,guestUserStore:n,store:t})}})}),[t,a,e]);return{environment:a,styles:o,isSubscribed:s,handleConvertToMemberClick:l,handleRemoveClick:u}}({userId:e,spaceStore:t,shouldDisableInteraction:n});return(0,be.jsx)("div",{style:s.container,children:(0,be.jsx)(sr().A,{popupType:sr().z.Popup,renderOrigin:e=>(0,be.jsx)(qt().p,{style:s.button,...e,children:(0,be.jsx)(be.Fragment,{children:(0,Hc().ellipsisIcon)(s.buttonIcon)})}),onClick:()=>{Sd().jR(o,{from:"guest",button_name:"actions"})},disabled:n,render:()=>(0,be.jsx)("div",{children:(0,be.jsx)(ss().Ay,{type:ss().Oh.Vertical,initialFocus:void 0,sections:[{key:"upgrade",render:e=>(0,be.jsx)(Gr().A,{...e}),items:[{key:"upgrade",render:e=>(0,be.jsx)(is().A,{...e,buttonStyle:s.upgradeButton,icon:(0,be.jsx)(g().I,{icon:Uc().arrowInCircleUpIcon}),title:(0,be.jsx)(A().sA,{id:"peopleSectionguestsTab.upgradeToAdmin",defaultMessage:"Upgrade to {isSubscribed, select, true {member} other {admin}}",values:{isSubscribed:a}})}),action:()=>{l(),Sd().jR(o,{from:"guest",button_name:"upgrade"})}}]},{key:"remove",render:e=>(0,be.jsx)(Gr().A,{...e,style:s.removeMenuDivider}),items:[{key:"remove",render:e=>(0,be.jsx)(is().A,{...e,buttonStyle:s.removeButton,icon:(0,be.jsx)(g().I,{icon:zc()._}),title:(0,be.jsx)(A().sA,{id:"peopleSectionguestsTab.remove",defaultMessage:"Remove from workspace"})}),action:()=>{u(),Sd().jR(o,{from:"guest",button_name:"remove"})}}]}]})})})})}function Zc(){const{isModalOpen:e,handleClickDecline:t,handleDismiss:n,guests:o,firstGuestName:s}=function(){const{isModalOpen:e,guests:t,handleClickDecline:n}=(0,d().K8)((()=>{const{isModalOpen:e,guests:t,handleClickDecline:n}=$c.state;return{isModalOpen:e,guests:t,handleClickDecline:n}}),[]),o=(0,A().tz)(),s=(0,d().K8)((()=>{const{sidebarSpaceStore:e}=di().default.state;if(0===t.length||!e)return;return ve().L.createChildStore(e,{table:V().oo,id:t[0]}).getDisplayName(o)}),[t,o]),a=(0,r().v3)(),l=(0,i.useCallback)((()=>{$c.reset(),Sd().jR(a,{from:"guest",button_name:"confirm_in_dialog",count:t.length})}),[a,t]);return{isModalOpen:e,guests:t,firstGuestName:s,handleClickDecline:n,handleDismiss:l}}();return 0===o.length?null:(0,be.jsx)(fc,{isModalOpen:e,handleDismiss:n,handleConfirm:t,title:(0,be.jsx)(A().sA,{id:"GuestBulkRemoveConfirmationDialog.title",defaultMessage:"Remove {numberOfGuests, plural, one {{firstGuestName}} other {{numberOfGuests} guests}} from the workspace?",values:{numberOfGuests:o.length,firstGuestName:s}}),description:(0,be.jsx)(A().sA,{id:"GuestBulkRemoveConfirmationDialog.description",defaultMessage:"They will lose access to all shared pages. To add them as a guest in the future, a request must be submitted, or an admin must invite them."}),ctaText:(0,be.jsx)(A().sA,{id:"GuestBulkRemoveConfirmationDialog.remove",defaultMessage:"Remove"})})}function Jc({userId:e,guestPageIds:t,shouldDisableInteraction:n}){return(0,be.jsx)(kc,{pageIds:t,guestUserId:e,shouldDisableInteraction:n,from:"guest"})}var Xc=()=>n(636020);function eu({spaceStore:e,domainFilterValues:t,internalDomains:n}){const o=(0,Yi().fC)({spaceStore:e}),s=(0,Td().r1)({spaceStore:e}),a=(0,c().IS)((e=>({titleContainer:{display:"flex",alignItems:"center",gap:6,alignSelf:"stretch",fontSize:"14px",fontStyle:"normal",fontWeight:510,height:32},emptyMessage:{display:"flex",height:32,padding:"0px 4px",alignItems:"center",borderBottom:`1px solid ${e.border.primary}`},headerContainer:{display:"flex",justifyContent:o&&s?"space-between":"flex-end"},actionsContainer:{display:"flex",borderRadius:6,border:`1px solid ${e.border.primary}`,boxShadow:"0px 2px 12px 0px rgba(29, 27, 22, 0.06)"},actionLeftButton:{borderStartStartRadius:4,borderStartEndRadius:0,borderEndEndRadius:0,borderEndStartRadius:4,paddingInlineStart:10,paddingInlineEnd:12,height:30},buttonDivider:{width:1,background:e.border.secondary},actionRightButton:{borderStartStartRadius:0,borderStartEndRadius:4,borderEndEndRadius:4,borderEndStartRadius:0,paddingInlineStart:10,paddingInlineEnd:12,height:30}})),[o,s]),l=(0,d().K8)((()=>Bc().A.state.searchQuery),[]),[u,p]=(0,i.useState)({by:tu.id,asc:!1}),g=(0,i.useMemo)((()=>({field:"user"===u.by?"name_normalized":"type",direction:u.asc?"asc":"desc"})),[u]),m=(0,Vc().n)({query:l??"",sort:g,filter:b().nc,limit:30}),f=(0,d().K8)((()=>{var e;return null==m||null===(e=m.rowsStore.state.rows)||void 0===e?void 0:e.filter((e=>{var i;if(void 0===t||0===t.length)return!0;const o=null===(i=e.email)||void 0===i?void 0:i.split("@")[1];return null==t?void 0:t.some((e=>"other"===e?!(null!=n&&n.some((e=>e.url===o))):o===e))}))}),[t,n,m]),h=(0,Td().k4)({spaceStore:e}),v=(0,r().v3)(),[y,S]=(0,i.useState)(new Set),x=(0,i.useMemo)((()=>{const e=void 0!==f&&y.size>0&&y.size===f.length;return h?{header:{isDisabled:void 0===f||0===f.length,isSelected:e,onClick:()=>{void 0!==f&&(e?(S(new Set),Sd().Y1(v,{from:"guests",action:"deselect_all",row_count:y.size})):(S(new Set(f.map((e=>e.id)))),Sd().Y1(v,{from:"guests",action:"select_all",row_count:f.length})))}},row:{getDisabledState:()=>!1,getSelectedState:e=>y.has(e.id),onClick:e=>{S((t=>{if(t.has(e.id)){Sd().Y1(v,{from:"guests",action:"deselect_row",row_count:1});const n=new Set(t);return n.delete(e.id),n}return Sd().Y1(v,{from:"guests",action:"select_row",row_count:1}),new Set(t).add(e.id)}))}}}:void 0}),[h,f,y,v]),M=(0,d().K8)((()=>{const e=yo().subscriptionDataStoreInstance.state;return Boolean(e&&Wn().Fq(e))}),[]),w=(0,i.useCallback)((()=>{Sd().jR(v,{from:"guest",button_name:"bulk_upgrade",count:y.size}),y.forEach((t=>{const n=ve().L.createChildStore(e,{table:V().oo,id:t}),i=M?"member":"owner";Kc().P({environment:v,guestUserStore:n,membershipType:i,store:e,origin:"guest_actions"})})),S(new Set)}),[y,v,M,e]),j=(0,i.useCallback)((()=>{Sd().jR(v,{from:"guest",button_name:"bulk_remove",count:y.size}),$c.setState({...$c.state,isModalOpen:!0,guests:Array.from(y),handleClickDecline:()=>{Sd().jR(v,{from:"guest",button_name:"confirm_in_dialog",count:y.size}),y.forEach((t=>{const n=ve().L.createChildStore(e,{table:V().oo,id:t});Kc().D({environment:v,guestUserStore:n,store:e})})),S(new Set)}})}),[y,v,e]),k=!(null!=f&&f.some((e=>y.has(e.id)))),{columns:I,transformRow:C}=function({users:e,spaceStore:t,internalDomains:n,selectedGuestIds:o,environment:s,canEditMembership:a}){const[r,l]=(0,i.useState)({});(0,Ys().Yb)((async()=>{if(!e)return;if(!a)return;const n=e.map((e=>e.id)),i=await q().callApi({eventName:"getGuestPagesForUserIds",environment:s,data:{spaceId:t.id,guestUserIds:n,includeRecordMap:!0},headers:(0,U().WS)({cellId:void 0,spaceId:t.id})});"success"===i.type&&l((e=>{const t={...e};for(const s of n){var o;t[s]=(null===(o=i.data.guestIdToPages[s])||void 0===o?void 0:o.pageIds)??[]}return t}))}),[t,s,e,a]);const d=(0,i.useCallback)((e=>{const i=e.email.split("@")[1],s=n.some((e=>e.url===i));if("page_guest"===((0,pt().dp)(t,e.id).getMembershipType()??e.membership_type))return{id:e.id,spaceStore:t,shouldDisableInteraction:o.has(e.id),guestPageIds:r[e.id],isInternalGuest:s}}),[t,n,r,o]),c=(0,i.useMemo)((()=>a?[tu,nu,iu]:[tu]),[a]);return{columns:c,transformRow:d}}({users:f,spaceStore:e,internalDomains:n,selectedGuestIds:y,environment:v,canEditMembership:h});return(0,be.jsxs)(be.Fragment,{children:[(0,be.jsxs)("div",{style:a.headerContainer,children:[o&&s?(0,be.jsx)("div",{style:a.titleContainer,children:(0,be.jsx)("span",{children:(0,be.jsx)(A().sA,{id:"peopleSectionguestsTab.activeguests.title",defaultMessage:"Active"})})}):void 0,y.size>0&&!k?(0,be.jsxs)("div",{style:a.actionsContainer,children:[(0,be.jsx)(qt().p,{style:a.actionLeftButton,onClick:w,iconLeading:Uc().arrowInCircleUpIcon,colorPalette:"blue",children:(0,be.jsx)(A().sA,{id:"spaceSettings.peopleSection.guestsTable.bulkUpgrade",defaultMessage:"Upgrade {numberOfRequests, plural, one {1 guest} other {{numberOfRequests} guests}} to {isSubscribed, select, true {member} other {admin}}",values:{numberOfRequests:y.size,isSubscribed:M}})}),(0,be.jsx)("div",{style:a.buttonDivider}),(0,be.jsx)(qt().p,{style:a.actionRightButton,onClick:j,iconLeading:zc()._,colorPalette:"red",children:(0,be.jsx)(A().sA,{id:"spaceSettings.peopleSection.guestsTable.bulkDecline",defaultMessage:"Remove from workspace"})})]}):void 0]}),(0,be.jsxs)("div",{style:{marginTop:o&&s?4:-1,height:"100%"},children:[(0,be.jsx)(Wc().M,{columns:I,rows:f,listSource:m,transformRow:C,sort:u,onSortChange:p,estimatedRowHeight:42,allowHorizontalScroll:!0,renderEmpty:()=>(0,be.jsx)(Ee().A,{isSmall:!0,style:a.emptyMessage,children:(0,be.jsx)(A().sA,{id:"peopleSectionGuestsTab.emptySearch",defaultMessage:"No search results"})}),multiselect:x}),(0,be.jsx)(Zc,{})]})]})}const tu={id:"user",headerTitle:(0,be.jsx)("div",{style:{fontSize:14},children:(0,be.jsx)(A().sA,{id:"peopleSectionGuestsTab.user",defaultMessage:"User"})}),renderCell:e=>(0,be.jsx)(Xc().A,{userId:e.id,spaceStore:e.spaceStore,isInternalGuest:e.isInternalGuest}),widthData:{widthPercent:35,minWidth:250},sortable:!0},nu={id:"access",headerTitle:(0,be.jsx)("div",{style:{fontSize:14},children:(0,be.jsx)(A().sA,{id:"peopleSectionGuestsTab.access",defaultMessage:"Access"})}),headerCellPadding:"0 0 0 8px",renderCell:e=>void 0!==e.guestPageIds?(0,be.jsx)(Jc,{userId:e.id,guestPageIds:e.guestPageIds,shouldDisableInteraction:e.shouldDisableInteraction}):(0,be.jsx)(qc().A,{style:{width:60,height:12,borderRadius:4,marginInlineStart:8}}),widthData:{widthPercent:55,minWidth:180},sortable:!1},iu={id:"actions",headerTitle:void 0,renderCell:e=>(0,be.jsx)(Qc,{userId:e.id,spaceStore:e.spaceStore,shouldDisableInteraction:e.shouldDisableInteraction}),widthData:{widthPercent:10,minWidth:50},sortable:!1},ou=(0,A().YK)({updatingPermissions:{id:"spacePermissionsSettings.updatePermissionsMessage",defaultMessage:"Updatingâ€¦"}});function su(){Fd().m({message:ou.updatingPermissions})}function au(){Fd().V()}function ru({spaceStore:e,spacePermissionsSettingsStore:t}){const[n,o]=(0,i.useState)(),s=(0,r().v3)(),a=(0,Kn().r)()??0,l=(0,d().K8)((()=>{const t=zd().A.getData(s,{spaceId:e.id});return t?t.filter((e=>e.hasGuests)).map((e=>e.domain)):[]}),[s,e]),c=(0,Yi().fC)({spaceStore:e}),u=(0,Td().r1)({spaceStore:e}),p=(0,Yi().e6)({spaceStore:e,requestType:"guest"});return(0,Yi().Wz)({requestType:"guest",spaceStore:e}),(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(tc,{spaceStore:e,internalDomains:l,domainFilterValues:n,setDomainFilterValues:o}),c&&u?(0,be.jsx)(Dc,{requests:p,spaceStore:e,requestType:"guest",domainFilterValues:n,internalDomains:l}):void 0,a>0?(0,be.jsx)(eu,{spaceStore:e,domainFilterValues:n??[],internalDomains:l}):(0,be.jsx)("div",{children:(0,be.jsx)(lu,{spacePermissionsSettingsStore:t})})]})}function lu({spacePermissionsSettingsStore:e}){const t=(0,c().IS)((e=>({container:{marginTop:32,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",minHeight:296,width:"100%",border:`1px dashed ${e.palette.gray[300]}`,borderRadius:4,padding:16,gap:12},icon:{width:24,height:24}})),[]),n=(0,d().O$)(di().AppStoreSidebarSpaceStore),i=(0,Md().J)();return(0,be.jsxs)("div",{style:t.container,children:[(0,be.jsx)(Kd().Q,{iconGroup:Od,variantName:"fill",style:t.icon}),(0,be.jsx)(Fi().D,{styleKey:"Body/Medium",children:(0,be.jsx)(A().sA,{id:"spaceSettings.people.guestsTab.noGuests",defaultMessage:"No guests yet"})}),i?(0,be.jsx)(du,{spaceStore:n,spacePermissionsSettingsStore:e}):void 0]})}function du(e){const{spaceStore:t,spacePermissionsSettingsStore:n}=e,i=(0,c().IS)((()=>({origin:{padding:"12px",height:32},importListButton:{height:28,borderRadius:4,border:void 0,width:"100%"},importListButtonContainer:{padding:"0 6px",alignItems:"center"}})),[]),o=(0,r().v3)();if(!t)return null;const s=(0,Ud().A)({onInviteClick:su,onInviteComplete:au,buttonStyle:i.importListButton,buttonContainerStyle:i.importListButtonContainer,spacePermissionsSettingsStore:n,shouldAddMembers:!1});return(0,be.jsx)(sr().A,{popupType:Ld().n.Popup,alignmentToOrigin:"center",placementToOrigin:"bottom",render:()=>(0,be.jsx)(Vd().A,{importListItems:s}),renderOrigin:e=>(0,be.jsx)(Mt().A,{style:i.origin,...e,onClick:()=>{e.onClick(),Nd().V(o,{source:"guests_tab"})},children:(0,be.jsx)(A().sA,{id:"spaceSettings.people.guestsTab.importContacts",defaultMessage:"Import contacts"})})})}var cu=()=>n(786251),uu=()=>n(569397),pu=()=>n(97835);function gu({isPrimary:e,leftIcon:t,rightIcon:n,onClick:i,content:o,style:s,titleStyle:a}){const r=(0,c().IS)((t=>({container:{display:"flex",width:"100%",padding:8,justifyContent:"flex-start",alignItems:"center",borderRadius:8,background:t.onboardingPreviewBackground,...s},iconContainer:{display:"flex",width:20,height:20,paddingTop:1,flexDirection:"column",alignItems:"center",justifyContent:"center",gap:10},title:{display:"flex",fontSize:14,fontWeight:500,color:e?t.text.primary:t.text.secondary,paddingInlineStart:6,paddingInlineEnd:2,height:18,cursor:i?"pointer":"default",width:"100%",...a},ctaIconContainer:{display:"flex",width:16,height:16,paddingTop:1,flexDirection:"column",alignItems:"center",gap:10,paddingInlineStart:2,paddingInlineEnd:0,cursor:i?"pointer":"default"}})),[i,e,s,a]);return(0,be.jsxs)("div",{style:r.container,children:[t?(0,be.jsx)("div",{style:r.iconContainer,onClick:i,children:t}):void 0,(0,be.jsx)("div",{style:r.title,onClick:i,children:o}),n?(0,be.jsx)("div",{style:r.ctaIconContainer,onClick:i,children:n}):void 0]})}function mu({currentTab:e}){const t=(0,c().IS)((e=>({icon:{fontSize:14,fontWeight:510,fill:e.icon.secondary,cursor:"pointer"},ctaIcon:{fontSize:12,fill:e.icon.secondary,fontWeight:510}})),[]),n=(0,r().v3)(),o=(0,i.useCallback)((()=>{At().A.setState({...At().A.state,currentTab:"security",defaultSubtab:"members_and_guests"}),Sd().pf(n,{current_tab:e})}),[n,e]);return(0,i.useEffect)((()=>{Sd().W2(n,{current_tab:e})}),[n,e]),(0,be.jsx)(gu,{leftIcon:(0,pu().inviteMemberIcon)(t.icon),content:(0,be.jsx)(A().sA,{id:"PeopleSectionSecurityBanner.title",defaultMessage:"Some invite settings have moved, make changes in Security tab"}),rightIcon:(0,uu().arrowStraightRightSmallIcon)(t.ctaIcon),onClick:o})}var fu=()=>n(566910),hu=()=>n(406533);const vu=3;function yu({spaceStore:e,internalDomains:t}){const{environment:n,tableStyles:o,sortState:a,setSortState:l,selectedRowIds:u,setSelectedRowIds:p,rows:m,searchQuery:f,canEditMembership:h,columnRenderInfo:v,guestsCount:y,onClickApprove:b,isSubscribed:S}=function({spaceStore:e,internalDomains:t}){const n=(0,r().v3)(),o=(0,Td().k4)({spaceStore:e}),a=(0,i.useMemo)((()=>o?[xu,Au,Mu]:[xu]),[o]),l=(0,c().IS)((e=>({...(0,De().rC)({columnRenderInfo:a,theme:e,containerMarginTop:0})})),[a]),u=(0,d().K8)((()=>a[0]),[a]),[p,g]=(0,i.useState)({column:u,sortAscending:!0}),[m,f]=(0,i.useState)([]),h=(0,A().tz)(),v=(0,d().K8)((()=>Bc().A.state.searchQuery),[]),y=(0,d().K8)((()=>{const e=yo().subscriptionDataStoreInstance.state;return Boolean(e&&Wn().Fq(e))}),[]),[b,S]=(0,i.useState)([]),[x,M]=(0,i.useState)(new Set),[w,j]=(0,i.useState)({}),k=(0,d().K8)((()=>O().A.state.shouldUseEdgeCache&&s().default.checkGate({gateName:"edge_cache_plus_settings"})),[]),I=(0,i.useRef)(void 0);(0,Ys().Yb)((async()=>{var i;if(!k)return;I.current&&I.current.abort(),I.current=new AbortController;const o=s().default.getConfigKey("email_alias_migration","mode"),a=await q().callApi({eventName:"listUsers",environment:n,data:{cursor:void 0,membershipFilter:"guests",limit:vu+x.size,sort:"name_normalized",sortDirection:"asc",query:v??"",spaceId:e.id,includeDomains:t.map((e=>e.url)),includeAliasSearch:(0,ue().K)(o)},abortSignal:null===(i=I.current)||void 0===i?void 0:i.signal});if(I.current=void 0,"success"===a.type){const e=a.data.users;S(e.filter((e=>!x.has(e.id))).slice(0,vu).map((e=>e.id)))}}),[n,t,v,k,e.id,x]),(0,Ys().Yb)((async()=>{if(!k)return;const t=await q().callApi({eventName:"getGuestPagesForUserIds",environment:n,data:{spaceId:e.id,guestUserIds:b,includeRecordMap:!0},headers:(0,U().WS)({cellId:void 0,spaceId:e.id})});"success"===t.type&&j((e=>{const n={...e};for(const o of b){var i;n[o]=(null===(i=t.data.guestIdToPages[o])||void 0===i?void 0:i.pageIds)??[]}return n}))}),[k,n,e.id,b]);const C=(0,d().K8)((()=>{if(k)return[];const e=yo().subscriptionDataStoreInstance.state;return e?(0,Wn().oe)(e):[]}),[k]),T=(0,d().K8)((()=>k?b.map((t=>{const n=ve().L.createChildStore(e,{table:V().oo,id:t}),i=n.getEmail();return{spaceStore:e,id:t,guestPageIds:w[t],email:i,userName:n.getDisplayName(h),guestUserStore:n,shouldDisableInteraction:m.includes(t),isClickable:!1,isInternalGuest:!0,isSubscribed:y,setUpgradedGuestIds:M}})):C.map((n=>{const i=ve().L.createChildStore(e,{table:V().oo,id:n.userId}),o=i.getEmail(),s=null==o?void 0:o.split("@")[1],a=t.some((e=>e.url===s));return{spaceStore:e,id:n.userId,guestPageIds:n.guestPageIds,email:o,userName:i.getDisplayName(h),guestUserStore:i,shouldDisableInteraction:m.includes(n.userId),isClickable:!1,isInternalGuest:a,isSubscribed:y}})).filter((e=>{if(v){var t;if(!((null===(t=e.email)||void 0===t?void 0:t.includes(v))||e.userName.includes(v)))return!1}return e.isInternalGuest})).slice(0,vu)),[k,b,e,t,w,h,m,y,C,v]),_=(0,i.useCallback)((()=>{Sd().jR(n,{from:"guest_suggestions",button_name:"bulk_upgrade",count:m.length}),m.forEach((t=>{const i=ve().L.createChildStore(e,{table:V().oo,id:t}),o=y?"member":"owner";Kc().P({environment:n,guestUserStore:i,membershipType:o,store:e,origin:"suggested_guest_table"})})),M((e=>{const t=new Set(e);for(const n of m)t.add(n);return t})),f([])}),[m,n,y,e]),P=!T.some((e=>m.includes(e.id)));return{environment:n,tableStyles:l,sortState:p,setSortState:g,selectedRowIds:m,setSelectedRowIds:f,rows:T,searchQuery:v,isApproveButtonLoading:!1,canEditMembership:o,columnRenderInfo:a,isSubscribed:y,shouldHideActions:P,guestsCount:T.length,onClickApprove:_}}({spaceStore:e,internalDomains:t}),x=(0,A().tz)(),M=function(){const e=(0,c().IS)((e=>({suggestions:{transition:"opacity 1s",marginTop:12},suggestionsHidden:{transition:"opacity 1s",opacity:0},titleContainer:{display:"flex",alignItems:"center",gap:6,alignSelf:"stretch",fontSize:"14px",fontStyle:"normal",fontWeight:510,height:32},titleNumber:{color:e.text.tertiary},emptyMessage:{display:"flex",height:32,padding:"0px 4px",alignItems:"center",borderBottom:`1px solid ${e.border.primary}`},emptyDivider:{height:1,backgroundColor:e.border.secondary},headerContainer:{display:"flex",justifyContent:"space-between",alignItems:"center"},suggestionsMenu:{width:265},learnMoreMenuItem:{color:e.text.secondary},learnMoreSection:{paddingTop:4,paddingBottom:4,borderTop:`1px solid ${e.border.secondary}`},optionsContainer:{display:"flex",alignItems:"center"},actionsContainer:{display:"flex",borderRadius:6,border:`1px solid ${e.border.primary}`,boxShadow:"0px 2px 12px 0px rgba(29, 27, 22, 0.06)"}})),[]);return e}(),[w,j]=(0,i.useState)(!0),k=(0,i.useCallback)((()=>{(0,P().L)({environment:n,url:(0,rt().x)("guides.invitePerson")})}),[n]);if(0===t.length)return null;if(0===m.length)return null;if(!w)return null;const I=u.length>0;return(0,be.jsxs)("div",{style:w?M.suggestions:M.suggestionsHidden,children:[(0,be.jsxs)("div",{style:M.headerContainer,children:[(0,be.jsxs)("div",{style:M.titleContainer,children:[(0,be.jsx)("span",{children:(0,be.jsx)(A().sA,{id:"peopleSectionguestsTab.suggestions.title",defaultMessage:"Suggestions"})}),(0,be.jsx)("span",{style:M.titleNumber,children:y})]}),(0,be.jsx)("div",{style:M.optionsContainer,children:I?(0,be.jsx)("div",{style:M.actionsContainer,children:(0,be.jsx)(qt().p,{onClick:b,iconLeading:Uc().arrowInCircleUpIcon,colorPalette:"blue",children:(0,be.jsx)(A().sA,{id:"spaceSettings.peopleSection.guestsTable.bulkUpgrade",defaultMessage:"Upgrade {numberOfRequests, plural, one {1 guest} other {{numberOfRequests} guests}} to {isSubscribed, select, true {member} other {admin}}",values:{numberOfRequests:u.length,isSubscribed:S}})})}):(0,be.jsx)(sr().A,{popupType:sr().z.Popup,renderOrigin:e=>(0,be.jsx)(Pa().A,{icon:Hc().ellipsisIcon,ariaLabel:x.formatMessage({id:"peopleSectionSuggestionsTable.ellipsisButton.ariaLabel",defaultMessage:"More"}),style:{height:24,width:24},iconStyle:{width:20,height:20},...e}),onClick:()=>{Sd().jR(n,{from:"guest_suggestions",button_name:"upgrade"})},render:()=>(0,be.jsx)("div",{children:(0,be.jsx)(ss().Ay,{type:ss().Oh.Vertical,initialFocus:void 0,style:M.suggestionsMenu,sections:[{key:"hide_suggestions",render:e=>(0,be.jsx)(Gr().A,{...e}),items:[{key:"hide_suggestions",render:e=>(0,be.jsx)(is().A,{...e,icon:(0,be.jsx)(g().I,{icon:fu().e}),title:(0,be.jsx)(A().sA,{id:"peopleSectionguestsTab.hideSuggestions",defaultMessage:"Hide Suggestions"})}),action:()=>{j(!1),Sd().jR(n,{from:"guest_suggestions",button_name:"hide_suggestions"})}}]},{key:"learn_more",render:e=>(0,be.jsx)(Gr().A,{...e,style:M.learnMoreSection}),items:[{key:"learn_more",render:e=>(0,be.jsx)(is().A,{...e,icon:(0,be.jsx)(g().I,{icon:hu().questionMarkCircleIcon}),title:(0,be.jsx)(A().sA,{id:"peopleSectionguestsTab.learnMore",defaultMessage:"Learn more"}),style:M.learnMoreMenuItem}),action:()=>{k(),Sd().jR(n,{from:"guest_suggestions",button_name:"suggestions_learn_more"})}}]}]})})})})]}),(0,be.jsx)("div",{style:{marginBottom:36,marginTop:4},children:(0,be.jsx)(De().WE,{allowHorizontalScroll:h,setStickyHeaderRow:!0,columnRenderInfo:v,rows:wu(m,a),showRowBorders:!0,hideHeaderRowPadding:!0,sortState:a,onSortStateChanged:l,renderNoRowsComponent:()=>(0,be.jsx)(Ee().A,{isSmall:!0,style:M.emptyMessage,children:f?(0,be.jsx)(A().sA,{id:"peopleSectionGuestsTab.emptySearch",defaultMessage:"No search results"}):(0,be.jsx)(A().sA,{id:"peopleSectionGuestsTab.emptyRow",defaultMessage:"No guests"})}),styles:o,multiselect:h?{header:{isDisabled:0===m.length,isSelected:u.length>0&&u.length===m.length,onClick:()=>{u.length===m.length?(p([]),Sd().Y1(n,{from:"guest_suggestions",action:"deselect_all",row_count:u.length})):(p(m.map((e=>e.id))),Sd().Y1(n,{from:"guest_suggestions",action:"select_all",row_count:m.length}))}},row:{getDisabledState:()=>!1,getSelectedState:e=>u.includes(e.id),onClick:e=>{p((t=>t.includes(e.id)?(Sd().Y1(n,{from:"guest_suggestions",action:"deselect_row",row_count:1}),t.filter((t=>t!==e.id))):(Sd().Y1(n,{from:"guest_suggestions",action:"select_row",row_count:1}),t.concat(e.id))))}}}:void 0})})]})}function bu(){return(0,be.jsx)("div",{children:(0,be.jsx)(A().sA,{id:"peopleSectionguestsTab.suggestions.reason.approvedEmailDomain",defaultMessage:"Approved email domain"})})}function Su({spaceStore:e,upgradeMember:t,guestUserStore:n,disabled:o}){const s=(0,c().DP)(),a=(0,r().v3)(),[l,d]=(0,i.useState)(!1);return(0,be.jsx)(qt().p,{disabled:o,style:{background:s.blue.background.secondaryTranslucent,color:s.blue.text.accentPrimary,fontWeight:510,fontSize:14,borderRadius:4,paddingTop:4,paddingBottom:4,paddingInlineStart:12,paddingInlineEnd:12,marginInlineStart:24,...o&&{color:s.blue.text.disabled}},hoveredStyle:{background:(0,p().i)({color:s.blue.background.secondaryTranslucent,mode:s.mode})},onClick:async()=>{d(!0),Sd().jR(a,{from:"guest_suggestions",button_name:"upgrade"}),await t({environment:a,store:e,guestUserStore:n}),d(!1)},isLoading:l,children:(0,be.jsx)(A().sA,{id:"spaceSettings.peopleSection.suggestionsTable.upgrade",defaultMessage:"Upgrade"})})}const xu={id:"user",headerTitle:(0,be.jsx)("div",{style:{fontSize:14},children:(0,be.jsx)(A().sA,{id:"peopleSectionGuestsTab.guest",defaultMessage:"User"})}),renderCell:e=>(0,be.jsx)(Xc().A,{userId:e.id,spaceStore:e.spaceStore,isInternalGuest:e.isInternalGuest,isForSuggestionsTable:!0}),widthData:{width:210},sortable:!0},Au={id:"access",headerTitle:(0,be.jsx)("div",{style:{paddingInlineStart:8,fontSize:14},children:(0,be.jsx)(A().sA,{id:"peopleSectionGuestsTab.access",defaultMessage:"Access"})}),renderCell:e=>(0,be.jsx)("div",{style:{display:"flex"},children:void 0!==e.guestPageIds?(0,be.jsx)(Jc,{userId:e.id,guestPageIds:e.guestPageIds,shouldDisableInteraction:e.shouldDisableInteraction}):(0,be.jsx)(qc().A,{style:{width:60,height:12,borderRadius:4,marginInlineStart:8}})}),widthData:{width:120},sortable:!1},Mu={id:"reason",headerTitle:(0,be.jsx)("div",{style:{fontSize:14},children:(0,be.jsx)(A().sA,{id:"peopleSectionguestsTab.suggestions.reason",defaultMessage:"Reason"})}),renderCell:e=>(0,be.jsxs)("div",{style:{display:"flex",width:"100%",justifyContent:"space-between",alignItems:"center"},children:[(0,be.jsx)(bu,{}),(0,be.jsx)(Su,{upgradeMember:async t=>{var n;await Kc().P({origin:"suggested_guest_table",membershipType:e.isSubscribed?"member":"owner",...t}),null===(n=e.setUpgradedGuestIds)||void 0===n||n.call(e,(t=>{const n=new Set(t);return n.add(e.id),n}))},spaceStore:e.spaceStore,guestUserStore:e.guestUserStore,disabled:e.shouldDisableInteraction})]}),widthData:{width:256},sortable:!1};function wu(e,{sortAscending:t}){const n=M().Ul(e,(e=>e.email));return t||n.reverse(),n}var ju=()=>n(675291);function ku({spaceStore:e,spacePermissionsSettingsStore:t}){const n=(0,r().v3)(),i=(0,d().K8)((()=>{const t=zd().A.getData(n,{spaceId:e.id});return(null==t?void 0:t.filter((e=>e.hasMembers)).map((e=>e.domain)))??[]}),[n,e]),o=(0,Yi().fC)({spaceStore:e}),s=(0,Td().r1)({spaceStore:e}),a=(0,Yi().e6)({spaceStore:e,requestType:"member"});(0,Yi().Wz)({requestType:"member",spaceStore:e});const l=(0,Yi().zA)({spaceStore:e,internalDomains:i}),u=o&&0!==a.length,p=u||l,g=(0,c().IS)((e=>({titleContainer:{display:"flex",alignItems:"center",gap:6,alignSelf:"stretch",fontSize:"14px",fontStyle:"normal",fontWeight:510,height:32}})),[]);return(0,be.jsxs)(be.Fragment,{children:[l&&!u?(0,be.jsx)(yu,{spaceStore:e,internalDomains:i}):void 0,u?(0,be.jsxs)("div",{style:{paddingTop:16,paddingBottom:16},children:[s?(0,be.jsx)(mu,{currentTab:"members"}):void 0,(0,be.jsx)(Dc,{requests:a,spaceStore:e,requestType:"member"})]}):void 0,p?(0,be.jsx)("div",{style:g.titleContainer,children:(0,be.jsx)(A().sA,{id:"peopleSectionMembersTab.activeMembers.title",defaultMessage:"Active"})}):void 0,(0,be.jsx)("div",{style:{marginTop:p?4:-1},children:(0,be.jsx)(ju().Hw,{spaceStore:e,spacePermissionsSettingsStore:t})}),l&&u?(0,be.jsx)(yu,{spaceStore:e,internalDomains:i}):void 0]})}var Iu=()=>n(738418);function Cu({recentRecoverableUser:e,spaceStore:t}){const{environment:o,styles:s,handleReprovisionToUserChange:a,userId:l,selectedTransferToUser:d}=function({recentRecoverableUser:e,spaceStore:t}){const n=(0,c().IS)((e=>({container:{display:"flex",width:"100%",justifyContent:"flex-end"},button:{display:"flex",width:24,height:24,justifyContent:"center",alignItems:"center",gap:10,paddingInlineStart:0,paddingInlineEnd:0},buttonIcon:{width:20,height:20,fill:e.icon.secondary},removeMenuDivider:{borderTop:e.border.secondary},upgradeIcon:{width:17,height:17}})),[]),o=(0,r().v3)(),[s,a]=(0,i.useState)(),l=(0,i.useCallback)((async(n,i)=>{const{accept:s}=await T().Gh({message:(0,be.jsx)(A().sA,{id:"spacePermissionsSettings.reprovisionPrivatePagesConfirmationDialog.confirmationMessage",defaultMessage:"Transfer their private pages?"}),description:(0,be.jsx)(A().sA,{id:"spacePermissionsSettings.reprovisionPrivatePagesConfirmationDialog.confirmationDescription",defaultMessage:"This action cannot be undone."}),acceptLabel:(0,be.jsx)(A().sA,{id:"spacePermissionsSettings.reprovisionPrivatePagesConfirmationDialog.confirmButton.label",defaultMessage:"Transfer private pages"})});if(!s)return;a(i);const r=await q().callApi({eventName:"transferSpaceUserContent",environment:o,data:{spaceId:t.id,fromUserId:n,toUserId:i}});"failed"===r.type?T().Qg(r):(e.privatePagesCount=0,Bc().A.setState({...Bc().A.state,recentRecoverableUsers:[...Bc().A.state.recentRecoverableUsers.filter((e=>e.userId!==n)),e]}))}),[o,t,e]);return{environment:o,styles:n,handleReprovisionToUserChange:l,userId:e.userId,selectedTransferToUser:s}}({recentRecoverableUser:e,spaceStore:t});return l?(0,be.jsx)("div",{style:s.container,children:(0,be.jsx)(sr().A,{popupType:sr().z.Popup,onClick:()=>{Sd().jR(o,{from:"recently_left",button_name:"actions"})},renderOrigin:e=>(0,be.jsx)(qt().p,{style:s.button,...e,children:(0,be.jsx)(be.Fragment,{children:(0,n(568625).L)(s.buttonIcon)})}),render:()=>(0,be.jsx)("div",{children:(0,be.jsx)(ss().Ay,{type:ss().Oh.Vertical,initialFocus:void 0,sections:[{key:"transfer",render:e=>(0,be.jsx)(Gr().A,{...e,style:s.removeMenuDivider}),items:[{key:"transfer",render:e=>(0,be.jsx)(n(140828).A,{mode:re().C.Button,focused:!1,title:(0,be.jsx)(A().sA,{id:"spacePermissionsSettings.reprovision.toUser.title",defaultMessage:"Transfer private pages"}),parentStore:t,userIds:d?[d]:[],onChange:([e])=>{a(l,e)}}),action:()=>{Sd().jR(o,{from:"recently_left",button_name:"open_transfer_ownership"})}}]}]})})})}):null}function Tu({spaceStore:e,recentRecoverableUsers:t}){const n=(0,c().IS)((e=>({icon:{fontSize:14,fontWeight:510,fill:e.icon.secondary}})),[]);return(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)("div",{style:{paddingTop:16,paddingBottom:16},children:(0,be.jsx)(gu,{leftIcon:(0,Iu().G)(n.icon),content:(0,be.jsx)(A().sA,{id:"peopleSectionReprovisioningTab.settingsDeeplinkBannerTitle",defaultMessage:"People left the workspace in the past 30 days and had private pages appear here"})})}),(0,be.jsx)(_u,{recentRecoverableUsers:t,spaceStore:e})]})}function _u({spaceStore:e,recentRecoverableUsers:t}){const{rows:n,sortState:o,setSortState:s,tableStyles:a}=function({recentRecoverableUsers:e,spaceStore:t}){const n=(0,c().IS)((e=>(0,De().rC)({columnRenderInfo:Bu,theme:e,containerMarginTop:0})),[]),[o,s]=(0,i.useState)({column:Bu[0],sortAscending:!0}),a=(0,d().K8)((()=>e.map((e=>{const n=ve().L.createChildStore(t,{table:V().oo,id:e.userId});return{spaceStore:t,reprovisioningUser:e,email:n.getEmail(),id:e.userId,isClickable:!1}}))),[t,e]);return{rows:a,sortState:o,setSortState:s,tableStyles:n}}({recentRecoverableUsers:t,spaceStore:e}),r=(0,c().IS)((e=>({noRowContainer:{display:"flex",height:32,padding:"0px 4px",alignItems:"center",borderBottom:`1px solid ${e.border.primary}`}})),[]);return(0,be.jsx)("div",{style:{marginTop:4},children:(0,be.jsx)(De().WE,{setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:Bu,rows:Du(n,o),showRowBorders:!0,hideHeaderRowPadding:!0,sortState:o,onSortStateChanged:s,renderNoRowsComponent:()=>(0,be.jsx)(Ee().A,{isSmall:!0,style:r.noRowContainer,children:(0,be.jsx)(A().sA,{id:"peopleSectionReprovisioningTab.noUser",defaultMessage:"No recent left user"})}),styles:a})})}function Pu({userLeftTime:e}){const t=(0,A().tz)(),n=(0,d().K8)((()=>{const n=N().KQ(e,(0,oe().P)());return(0,Fa().ZF)({value:n,date_format:"relative",userTimeZone:(0,oe().P)(),intl:t,allowRelativeDates:!0})}),[e,t]);return(0,be.jsx)(Ee().A,{isSmall:!0,children:n})}const Bu=[{id:"user",headerTitle:(0,be.jsx)("div",{style:{fontSize:14},children:(0,be.jsx)(A().sA,{id:"peopleSectionReprovisioningTab.user",defaultMessage:"User"})}),renderCell:e=>(0,be.jsx)(Xc().A,{userId:e.reprovisioningUser.userId,spaceStore:e.spaceStore}),widthData:{width:220},sortable:!0},{id:"pageCount",headerTitle:(0,be.jsx)("div",{style:{fontSize:14},children:(0,be.jsx)(A().sA,{defaultMessage:"Private pages",id:"peopleSectionReprovisioningTab.privatePages"})}),renderCell:e=>(0,be.jsx)(Ee().A,{isSmall:!0,children:e.reprovisioningUser.privatePagesCount}),widthData:{width:100},sortable:!1},{id:"leftTime",headerTitle:(0,be.jsx)("div",{style:{fontSize:14},children:(0,be.jsx)(A().sA,{defaultMessage:"Left workspace",id:"peopleSectionReprovisioningTab.leftTime"})}),renderCell:e=>(0,be.jsx)(Pu,{userLeftTime:e.reprovisioningUser.userLeftTime}),widthData:{width:100},sortable:!1},{id:"actions",headerTitle:"",renderCell:e=>(0,be.jsx)(Cu,{recentRecoverableUser:e.reprovisioningUser,spaceStore:e.spaceStore}),widthData:{width:100},sortable:!1}];function Du(e,{sortAscending:t}){const n=M().Ul(e,(e=>e.email));return t||n.reverse(),n}var Ru=()=>n(437607),Eu=()=>n(778078),Lu=()=>n(190106);const Ou=(0,v().wt)("arrowDownPage",{viewBox:"0 0 14 18",svg:(0,be.jsx)("path",{d:"M7.67969 9.39844V11.7891L7.61719 13.0078L8.21875 12.3828L8.8125 11.7656C8.875 11.7031 8.94531 11.6536 9.02344 11.6172C9.10677 11.5755 9.19271 11.5547 9.28125 11.5547C9.45312 11.5547 9.59635 11.612 9.71094 11.7266C9.83073 11.8411 9.89062 11.9844 9.89062 12.1562C9.89062 12.2552 9.8724 12.3411 9.83594 12.4141C9.79948 12.487 9.74479 12.5573 9.67188 12.625L7.51562 14.6016C7.42708 14.6849 7.34115 14.7448 7.25781 14.7812C7.17969 14.8177 7.09375 14.8359 7 14.8359C6.90104 14.8359 6.8125 14.8177 6.73438 14.7812C6.65625 14.7448 6.57031 14.6849 6.47656 14.6016L4.32031 12.625C4.2474 12.5573 4.19271 12.487 4.15625 12.4141C4.11979 12.3411 4.10156 12.2552 4.10156 12.1562C4.10156 11.9844 4.15885 11.8411 4.27344 11.7266C4.39323 11.612 4.54167 11.5547 4.71875 11.5547C4.79688 11.5547 4.8776 11.5755 4.96094 11.6172C5.04427 11.6536 5.11719 11.7031 5.17969 11.7656L5.77344 12.3828L6.375 13.0078L6.32031 11.7891V9.39844C6.32031 9.21615 6.38542 9.0625 6.51562 8.9375C6.65104 8.80729 6.8125 8.74219 7 8.74219C7.18229 8.74219 7.34115 8.80729 7.47656 8.9375C7.61198 9.0625 7.67969 9.21615 7.67969 9.39844ZM2.83594 17.3203C1.9974 17.3203 1.36458 17.1042 0.9375 16.6719C0.510417 16.2396 0.296875 15.6016 0.296875 14.7578V2.96875C0.296875 2.13021 0.510417 1.49479 0.9375 1.0625C1.36458 0.625 1.9974 0.40625 2.83594 0.40625H6.60156C6.92969 0.40625 7.21615 0.429688 7.46094 0.476562C7.70573 0.518229 7.93229 0.598958 8.14062 0.71875C8.34896 0.833333 8.5625 1.0026 8.78125 1.22656L12.875 5.39062C13.1042 5.61979 13.276 5.84115 13.3906 6.05469C13.5104 6.26302 13.5911 6.49479 13.6328 6.75C13.6745 7 13.6953 7.30729 13.6953 7.67188V14.7578C13.6953 15.5964 13.4818 16.2318 13.0547 16.6641C12.6276 17.1016 11.9948 17.3203 11.1562 17.3203H2.83594ZM2.96094 15.7812H11.0312C11.4115 15.7812 11.6953 15.6849 11.8828 15.4922C12.0703 15.2995 12.1641 15.0234 12.1641 14.6641V7.88281H7.95312C7.39583 7.88281 6.97917 7.74479 6.70312 7.46875C6.43229 7.19271 6.29688 6.77604 6.29688 6.21875V1.9375H2.96875C2.58854 1.9375 2.30469 2.03646 2.11719 2.23438C1.92969 2.43229 1.83594 2.71094 1.83594 3.07031V14.6641C1.83594 15.0234 1.92969 15.2995 2.11719 15.4922C2.30469 15.6849 2.58594 15.7812 2.96094 15.7812ZM8.10156 6.53125H11.9531L7.64844 2.14844V6.07031C7.64844 6.23177 7.68229 6.34896 7.75 6.42188C7.82292 6.49479 7.9401 6.53125 8.10156 6.53125Z"})});var Nu=()=>n(370872);function Fu({spaceStore:e}){const{styles:t,shouldEnableExportGuests:n,handleExportGuestsClick:o}=function({spaceStore:e}){const t=(0,c().IS)((e=>({button:{display:"flex",width:28,height:28,justifyContent:"center",gap:10,alignItems:"center"},buttonIcon:{width:20,height:20,fontSize:16,fontStyle:"normal",flexDirection:"column",flexShrink:0,fontWeight:510,fill:e.icon.secondary}})),[]),n=(0,d().K8)((()=>{const{sidebarSpaceStore:e}=di().default.state,t=yo().subscriptionDataStoreInstance.state;return Boolean(e&&t&&"subscribed_admin"===t.type&&s().default.checkGate({gateName:"enable_guest_export"}))}),[]),o=(0,r().v3)(),a=(0,A().tz)(),l=(0,d().K8)((()=>s().default.checkGate({gateName:"edge_cache_plus_settings"})),[]),u=(0,i.useCallback)((()=>{if(l)return void Nu().li({spaceStore:e,intl:a,environment:o});const t=yo().subscriptionDataStoreInstance.state;if(e&&t&&"subscribed_admin"===t.type){const n=(0,Wn().oe)(t);Nu().s6(o,{intl:a,spaceStore:e,guests:n})}}),[o,a,l,e]);return{styles:t,shouldEnableExportGuests:n,handleExportGuestsClick:u}}({spaceStore:e});return n?(0,be.jsx)(Re().A,{render:e=>(0,be.jsx)(qt().p,{style:t.button,onClick:o,...e,children:Ou(t.buttonIcon)}),renderTooltip:()=>(0,be.jsx)(A().sA,{id:"exportGuestsButton.label",defaultMessage:"Export guests as CSV"})}):null}var Uu=()=>n(347930),zu=()=>n(562866),Ku=()=>n(317025),Vu=()=>n(406999),qu=()=>n(998109);function Wu({spaceStore:e,origin:t,requestFrom:n,inviteFrom:o}){const s=(0,i.useMemo)((()=>(0,Vu().nc)()),[]),{shouldShowRequestMemberButton:a,canEditMembership:l}=(0,d().K8)((()=>({shouldShowRequestMemberButton:!e.canEditMembership()&&!e.getDisableMembershipRequests()&&(0,Le().x3)(),canEditMembership:e.canEditMembership()})),[e]),c=(0,d().K8)((()=>{const e=yo().subscriptionDataStoreInstance.state;return Boolean(e&&Wn().Fq(e))}),[]),u=(0,Md().J)(),p=(0,i.useCallback)((()=>{const e=(0,A().YK)({updatingPermissions:{id:"spacePermissionsSettings.updatePermissionsMessage",defaultMessage:"Updatingâ€¦"}});Fd().m({message:e.updatingPermissions})}),[]),g=(0,i.useCallback)((()=>{Fd().V()}),[]),m=(0,r().v3)(),f=(0,i.useCallback)((()=>{(0,Ku().qU)(m)}),[m]);return a?(0,be.jsx)(zu().cx,{spaceStore:e,analyticsFrom:n,origin:t?(0,be.jsx)("div",{onClick:f,children:t}):(0,be.jsx)(wt().A,{colorPalette:"blue",size:"lg",onClick:f,children:(0,be.jsx)(A().sA,{id:"inviteUserButton.requestMemberLabel",defaultMessage:"Add members"})})}):(0,be.jsx)(qu().n,{step:"collaborate_add_member",isFullWidth:!1,showContentOverlays:!1,children:(0,be.jsx)(Uu().H,{disabled:!l,targetStore:e,spaceStore:e,onInviteClick:p,onInviteComplete:g,isSubscribed:c,membersOnly:!1,upgradeButtonName:"space_permission_settings",shouldGrow:!1,enableInviteDropdown:u,permissionsInviteStore:s,origin:t,analyticsFrom:o})})}function Gu({spaceStore:e,currentTab:t,spacePermissionsSettingsStore:n}){return(0,i.useEffect)((()=>()=>{Bc().A.reset()}),[]),(0,be.jsxs)("div",{style:{display:"flex",height:34,paddingBottom:0,justifyContent:"flex-end",alignItems:"center",gap:10},children:[(0,be.jsxs)("div",{style:{display:"flex",height:28,justifyContent:"flex-end",alignItems:"center",gap:4},children:[(0,be.jsx)(Lu().A,{handleSearchQueryChange:e=>{Bc().A.setState({...Bc().A.state,searchQuery:e}),t===qn().d.Groups&&n.setState({...n.state,groupsFilter:e??""})},isSearchBarAlwaysOpen:!1,currentTab:t}),t===qn().d.Guests?(0,be.jsx)(Fu,{spaceStore:e}):null]}),(0,be.jsx)("div",{style:{paddingBottom:2},children:(0,be.jsx)(Hu,{spaceStore:e,currentTab:t,spacePermissionsSettingsStore:n})})]})}function Hu({spaceStore:e,currentTab:t,spacePermissionsSettingsStore:n}){const{canUseGroups:o,canCreateGroups:s,handleCreateGroupClick:a,shouldShowRequestMemberButtion:l,canEditMembership:c}=function({spaceStore:e,currentTab:t,spacePermissionsSettingsStore:n}){const o=(0,Td().zh)(),s=(0,Td().k4)({spaceStore:e}),a=(0,r().v3)(),l=(0,i.useCallback)((()=>{E().createAndCommit({userAction:"PeopleSectionGroupsTab.handleCreateGroupClick",environment:a,canUndo:!0,perform:t=>{const i=D().np({spaceStore:e,transaction:t});if(i){n.setState({...n.state,editingNameGroupId:i.getGroupId(),groupNameInputValue:""});const e=nr().Bj6.fromValue(Ru().n,i.getValue()),t=[...cs().A.state.permissionGroupsAndMemberCounts,{group:e,memberCount:0}],o=(0,Eu().Ay)(n.state.groupsFilter,t,(e=>e.group.name||""));cs().A.setState({...cs().A.state,permissionGroupsAndMemberCounts:o})}}})}),[a,e,n]),c=(0,d().K8)((()=>!e.canEditMembership()&&!e.getDisableMembershipRequests()&&(0,Le().x3)()),[e]),u=(0,Td().k4)({spaceStore:e});return{canUseGroups:o,canCreateGroups:s,shouldShowRequestMemberButtion:c,canEditMembership:u,handleCreateGroupClick:l}}({spaceStore:e,currentTab:t,spacePermissionsSettingsStore:n});return t===qn().d.Groups&&o?s?(0,be.jsx)(Re().A,{renderTooltip:()=>!s&&(0,be.jsx)(A().sA,{id:"spacePermissionsSettings.groupsTab.groupCreationInsufficientPermissions",defaultMessage:"Only membership admins and workspace owners can add a permission group."}),render:e=>(0,be.jsx)(wt().A,{colorPalette:"blue",size:"lg",onClick:a,...e,children:(0,be.jsx)(A().sA,{id:"spacePermissionsSettings.groupsTab.createGroupButton.label",defaultMessage:"Create a group"})})}):null:l||c?(0,be.jsx)(Wu,{spaceStore:e,requestFrom:"space_settings_add_members",inviteFrom:"space_settings_add_members"}):null}var Yu=()=>n(480822);function $u(){const e=(0,d().K8)((()=>{const e=di().default.state.sidebarSpaceStore;if(null!=e&&e.isDefined())return e}),[]),t=(0,d().O$)(yo().subscriptionDataStoreInstance),n=(0,jd().o)({spaceId:null==e?void 0:e.id}),o=(0,d().uB)(void 0,qn().A),s=Ad();return(0,i.useEffect)((()=>{s&&o.setState({...o.state,currentTab:qn().d.Guests})}),[o,s]),e&&t?(0,be.jsxs)(St().Ay,{children:[(0,be.jsx)(cu().gz,{spaceStore:e}),(0,be.jsx)(cu().K,{spaceStore:e,inviteLinkCode:n,spacePermissionsSettingsStore:o}),(0,be.jsx)(Zu,{subscriptionData:t,spaceStore:e,spacePermissionsSettingsStore:o})]}):(0,be.jsx)(Qu,{})}function Qu(){return(0,be.jsx)(St().Ay,{centerContent:!0,children:(0,be.jsx)(Fo().k,{})})}function Zu({subscriptionData:e,spaceStore:t,spacePermissionsSettingsStore:n}){var o;(0,i.useEffect)((()=>{if(At().A.state.open&&"members"===At().A.state.currentTab&&At().A.state.defaultSubtab){const e=At().A.state.defaultSubtab!==qn().d.Requests?At().A.state.defaultSubtab:qn().d.Members;n.setState({...n.state,currentTab:e})}}),[n]);const{memberCount:s,recentRecoverableUsers:a,currentTab:l,canReprovisionContent:u,tabs:p,currentTabs:g,environment:m,billingData:f}=function({subscriptionData:e,spaceStore:t,spacePermissionsSettingsStore:n}){const i=(0,r().v3)(),o=(0,xd().V)()??1,s=(0,Kn().r)(),a=(0,jo().T)(),l=(0,pt().V_)({spaceStore:t,userId:a}),u=(0,Cd().x)({spaceUserMembershipType:l});(0,Td().rl)({spaceStore:t,subscriptionData:e});const p=(0,d().K8)((()=>{const{recentRecoverableUsers:e}=Bc().A.state;return e.filter((e=>e.privatePagesCount>0))}),[]),g=(0,d().K8)((()=>n.state.currentTab),[n]),m=(0,Td().t1)({spaceStore:t,subscriptionData:e}),f=(0,Yi().U4)({spaceStore:t,requestType:"guest"}),h=(0,Yi().U4)({spaceStore:t,requestType:"member"}),v=(0,c().IS)((e=>({activeTabStyle:{color:e.text.primary},inactiveTabStyle:{color:e.text.tertiary},redDot:{background:e.red.icon.accentPrimary,marginInlineStart:6,marginTop:6}})),[]),y=(0,d().K8)((()=>{const e=cs().A.state.permissionGroupsAndMemberCounts.length;return void 0===o?{}:{[qn().d.Members]:(0,be.jsx)(ep,{text:(0,be.jsx)("div",{children:(0,be.jsx)(A().sA,{id:"spacePermissionsSettings.membersTab.title",defaultMessage:"Members"})}),number:u?o:void 0,isCurrentTab:g===qn().d.Members,styles:v,unread:(h??0)>0}),[qn().d.Guests]:(0,be.jsx)(ep,{text:(0,be.jsx)(A().sA,{id:"spacePermissionsSettings.guestsTab.title",defaultMessage:"Guests"}),number:u?s:void 0,isCurrentTab:g===qn().d.Guests,styles:v,unread:(f??0)>0}),[qn().d.Groups]:(0,be.jsx)(ep,{text:(0,be.jsx)(A().sA,{id:"spaceBasicSettings.groupsTab.title",defaultMessage:"Groups"}),number:u?e:void 0,isCurrentTab:g===qn().d.Groups,styles:v}),[qn().d.Reprovisioning]:(0,be.jsx)(ep,{text:(0,be.jsx)(A().sA,{id:"spaceBasicSettings.reprovisioningTab.title",defaultMessage:"Recently left"}),number:u?p.length:void 0,isCurrentTab:g===qn().d.Reprovisioning,styles:v}),[qn().d.Requests]:(0,be.jsx)(A().sA,{id:"spaceBasicSettings.requestsTab.title",defaultMessage:"Requests"}),[qn().d.Contacts]:(0,be.jsx)(ep,{text:(0,be.jsx)(A().sA,{id:"spaceBasicSettings.contactsTab.title",defaultMessage:"Contacts"}),isCurrentTab:g===qn().d.Contacts,styles:v})}}),[o,s,g,v,h,f,p.length,u]),b=(0,Mn()._3)({spaceId:t.id}),S=Ad(),x=wd(),M=Xu({canReprovisionContent:m,hideGroupsTab:!1,showGuestTabFirst:S,showContactsTab:x}),w=M.map((e=>y[e]));return{billingData:b,memberCount:o,recentRecoverableUsers:p,currentTab:g,canReprovisionContent:m,tabs:w,currentTabs:M,environment:i}}({subscriptionData:e,spaceStore:t,spacePermissionsSettingsStore:n}),h=(0,kd().A)(t),v=(0,Mn().Q7)(t.id,f,s),y=h&&l===qn().d.Members&&(null==f?void 0:f.subscription),b=Ad(),S=wd();return(0,be.jsxs)("div",{style:{paddingInlineStart:2,paddingInlineEnd:2},children:[(0,be.jsx)(xt().Ay,{tabs:p,selectedIndex:g.indexOf(l),onChange:e=>function({newSelectedIndex:e,environment:t,spacePermissionsSettingsStore:n,currentTab:i,canReprovisionContent:o,hideGroupsTab:s,showGuestTabFirst:a,showContactsTab:r}){const l=Xu({canReprovisionContent:o,hideGroupsTab:s,showGuestTabFirst:a,showContactsTab:r})[e];switch(l){case qn().d.Members:Sd().K4(t,{tab:"members"});break;case qn().d.Groups:Sd().K4(t,{tab:"groups"});break;case qn().d.Guests:Sd().K4(t,{tab:"guests"});break;case qn().d.Reprovisioning:Sd().K4(t,{tab:"reprovisioning"});break;case qn().d.Requests:Sd().K4(t,{tab:"requests"});break;case qn().d.Contacts:Sd().K4(t,{tab:"contacts"});break;default:(0,bt().HB)(l)}i===qn().d.Requests&&l!==qn().d.Requests&&Si().A.reset();n.setState({...n.state,currentTab:l})}({newSelectedIndex:e,environment:m,spacePermissionsSettingsStore:n,currentTab:l,canReprovisionContent:u,hideGroupsTab:!1,showGuestTabFirst:b,showContactsTab:S}),style:{paddingInlineEnd:0,marginTop:-6,marginInlineStart:-12,paddingInlineStart:4,width:"calc(100% + 12px)"},tabTitleStyle:{fontSize:16,fontWeight:400},tabBorderStyle:{insetInlineStart:0,insetInlineEnd:0},hideTabBorder:!0,right:(0,be.jsx)(Gu,{spaceStore:t,currentTab:l,spacePermissionsSettingsStore:n})}),y?(0,be.jsx)("div",{style:{marginTop:20,marginInlineEnd:0,marginBottom:20,marginInlineStart:0},children:(0,be.jsx)(Yu().x,{quantityOfPaidSeats:v,quantityOfSpaceMembers:s,nextBillingDate:(null===(o=f.subscription)||void 0===o?void 0:o.currentPeriodEnd.toLocaleString({month:"short",day:"numeric",year:"numeric"}))??""})}):null,(0,be.jsx)(Ju,{currentTab:l,spaceStore:t,spacePermissionsSettingsStore:n,recentRecoverableUsers:a})]})}function Ju({currentTab:e,spaceStore:t,spacePermissionsSettingsStore:n,recentRecoverableUsers:i}){switch(e){case qn().d.Members:return(0,be.jsx)(ku,{spaceStore:t,spacePermissionsSettingsStore:n});case qn().d.Guests:return(0,be.jsx)(ru,{spaceStore:t,spacePermissionsSettingsStore:n});case qn().d.Groups:return(0,be.jsx)(Ed,{spaceStore:t,spacePermissionsSettingsStore:n});case qn().d.Reprovisioning:return(0,be.jsx)(Tu,{spaceStore:t,recentRecoverableUsers:i});case qn().d.Contacts:return(0,be.jsx)(_d().x,{spaceStore:t});default:return null}}function Xu({canReprovisionContent:e,hideGroupsTab:t,showGuestTabFirst:n,showContactsTab:i}){return n?[qn().d.Guests,qn().d.Members,...t?[]:[qn().d.Groups],...e?[qn().d.Reprovisioning]:[],...i?[qn().d.Contacts]:[]]:[qn().d.Members,qn().d.Guests,...t?[]:[qn().d.Groups],...e?[qn().d.Reprovisioning]:[],...i?[qn().d.Contacts]:[]]}function ep({text:e,number:t,isCurrentTab:n,unread:i,styles:o}){return(0,be.jsxs)("div",{style:{display:"flex",fontSize:w().J.UIRegular.desktop,fontWeight:w().Wy.medium,lineHeight:"18px",...n?o.activeTabStyle:o.inactiveTabStyle},children:[e,t&&t>0?(0,be.jsx)("div",{style:{fontSize:w().J.UIRegular.desktop,lineHeight:"18px",paddingInlineStart:4,...o.inactiveTabStyle},children:t}):void 0,i?(0,be.jsx)(Id().m,{style:o.redDot,size:6}):void 0]})}var tp=()=>n(667734),np=()=>n(782649);const ip="teamColumn",op="ownersColumn",sp="AccessLevelColumn",ap="lastUpdatedColumn",rp="contextMenuColumn",lp=[ip,sp,ap],dp="filterAccessAny",cp="filterAccessOnlyOpen",up="filterAccessOnlyClosed",pp="filterAccessOnlyPrivate",gp="filterOwnerAny",mp="filterOwnerShowOrphaned",fp="filterOwnerById";class hp extends $().Store{getInitialState(){return{searchQuery:"",sortColumn:ap,sortAscending:!1,showOnlyArchivedTeams:!1,filterByOwner:{type:gp},filterAccess:dp,showTeamsWithSecurityOverrides:!1}}}const vp=new hp;var yp=()=>n(848237);var bp=()=>n(812941),Sp=()=>n(284230),xp=()=>n(344417),Ap=()=>n(753363),Mp=()=>n(946141),wp=()=>n(56394),jp=()=>n(933117);function kp({selectItems:e,currentSelectedItem:t,onChange:n,icon:i}){const o=(0,c().IS)((()=>({filterWrap:{marginInlineEnd:0}})),[]);return(0,be.jsx)(jp().A,{items:e,getKey:e=>e.key,selectedItem:t,onSelect:n,renderItem:e=>(0,be.jsx)(is().A,{title:e.value.name,...e,isChecked:t.key===e.value.key}),renderOrigin:e=>(0,be.jsx)(wp().A,{...e,title:t.originName??t.name,on:!t.showFilterAsOffWhenSelected,icon:i,wrapStyle:o.filterWrap})})}const Ip={[dp]:{key:dp,name:(0,be.jsx)(A().sA,{id:"manageTeamsAccessFilter.accessFilter.filterAllTeams",defaultMessage:"Any"}),originName:(0,be.jsx)(A().sA,{id:"manageTeamsAccessFilter.accessSelectPlaceolder",defaultMessage:"Access"}),showFilterAsOffWhenSelected:!0},[cp]:{key:cp,name:(0,be.jsx)(A().sA,{id:"manageTeamsAccessFilter.accessFilter.filterOpenTeams",defaultMessage:"Open"})},[up]:{key:up,name:(0,be.jsx)(A().sA,{id:"manageTeamsAccessFilter.accessFilter.filterClosedTeams",defaultMessage:"Closed"})},[pp]:{key:pp,name:(0,be.jsx)(A().sA,{id:"manageTeamsAccessFilter.accessFilter.filterPrivateTeams",defaultMessage:"Private"})}},Cp=M().oE([Ip[dp],Ip[cp],Ip[up],Ip[pp]]);function Tp({manageTeamsStore:e}){const t=(0,r().v3)(),n=(0,d().K8)((()=>e.state.filterAccess),[e]),o=(0,c().IS)((e=>({keyIcon:{marginInlineEnd:6}})),[]),s=(0,i.useCallback)((n=>{e.update((e=>({...e,filterAccess:n.key}))),Mp().hj(t,{filter:"access",value:n.key})}),[e,t]),a=Ip[n];return(0,be.jsx)(kp,{selectItems:Cp,currentSelectedItem:a,onChange:s,icon:(0,be.jsx)(g().I,{icon:Ap().keyIcon,style:o.keyIcon})})}var _p=()=>n(934999);const Pp="showArchived",Bp="hideArchived",Dp={[Bp]:{key:Bp,name:(0,be.jsx)(A().sA,{id:"manageTeamsArchivedFilter.archivedFilter.hideArchivedTeams",defaultMessage:"Active"}),originName:(0,be.jsx)(A().sA,{id:"manageTeamsArchivedFilter.archivedSelectPlaceolder",defaultMessage:"Active"}),showFilterAsOffWhenSelected:!0},[Pp]:{key:Pp,name:(0,be.jsx)(A().sA,{id:"manageTeamsArchivedFilter.archivedFilter.showArchivedTeams",defaultMessage:"Archived"})}};function Rp({manageTeamsStore:e}){const t=(0,r().v3)(),n=(0,d().K8)((()=>e.state.showOnlyArchivedTeams),[e]),o=(0,c().IS)((()=>({archiveIcon:{marginInlineEnd:6}})),[]),s=[Dp[Bp],Dp[Pp]],a=(0,i.useCallback)((n=>{e.update((e=>({...e,showOnlyArchivedTeams:n.key===Pp}))),Mp().hj(t,{filter:"archived",value:n.key})}),[e,t]),l=Dp[n?Pp:Bp];return(0,be.jsx)(kp,{selectItems:s,currentSelectedItem:l,onChange:a,icon:(0,be.jsx)(g().I,{icon:_p().B,style:o.archiveIcon})})}n(430670);var Ep=()=>n(695608);const Lp="ShowTeamsWithNoOwnersId";function Op({teamStores:e,manageTeamsStore:t}){const n=(0,r().v3)(),o=(0,d().K8)((()=>t.state.filterByOwner),[t]),s=function(e){switch(e.type){case gp:return;case fp:return e.id;case mp:return Lp;default:(0,bt().HB)(e)}}(o),a=(0,d().O$)(di().AppStoreSidebarSpaceStore),l=(0,A().tz)(),c=(0,d().K8)((()=>{const t=e.flatMap((e=>e.getOwnerUserIds()));return M().sb(t)}),[e]),u=(0,i.useCallback)((e=>{if(a)return(0,ir().z5)({userId:e,currentSpaceStore:a}).getValue()}),[a]),p=(0,i.useCallback)((e=>{const i=e[e.length-1];let o;o=i===s||void 0===i?{type:gp}:i===Lp?{type:mp}:{type:fp,id:i},t.update((e=>({...e,filterByOwner:o}))),Mp().hj(n,{filter:"owner",value:o.type})}),[s,t,n]),g=(0,$e().fJ)(H().T.searchActions),m=(0,i.useCallback)((async({query:e})=>{if(!a||"resolved"!==g.status)return[];const t=g.value,i=(await t.searchUsers({environment:n,query:e,parentStore:a,userIds:c})).map((e=>e.id));return""===e?[Lp,...i]:i}),[a,c,g.status,g.value,n]),f=(0,i.useCallback)(((e,t)=>{if(!a)return null;if(e===Lp)return(0,be.jsx)(is().A,{...t,title:(0,be.jsx)(A().sA,{id:"manageTeamsOwnerFilter.noOwnersFilterOption",defaultMessage:"No owners"}),isChecked:o.type===mp,className:"notranslate"});const n=u(e);return n?(0,i.createElement)(fe().A,{...t,key:e,actor:(0,ce().MR)(n),isChecked:s===e}):null}),[a,u,s,o.type]),h=(0,d().K8)((()=>{if(o.type!==fp)return;const e=u(o.id);return e?(0,Ep().c6)(l,e):void 0}),[o,u,l]);let v;return v=o.type===mp?(0,be.jsx)(A().sA,{id:"manageTeamsOwnerFilter.filterTitle.onlyOrphanedTeams",defaultMessage:"Owner: None"}):h?(0,be.jsx)(A().sA,{id:"manageTeamsOwnerFilter.filterTitle.withSpecifiedOwner",defaultMessage:"Owner: {teamOwnerName}",values:{teamOwnerName:h}}):(0,be.jsx)(A().sA,{id:"manageTeamsOwnerFilter.filterTitle.unset",defaultMessage:"Owner"}),(0,be.jsx)(re().A,{mode:re().C.Pill,title:v,disabled:0===e.length,icon:pe().personIcon,items:M().oE([s]),hasItemsSelected:(0,bt().O9)(s),onChange:p,labelText:{title:v,tokenInputPlaceholder:l.formatMessage({defaultMessage:"Search teamspace owner...",id:"manageTeamsOwnerFilter.searchOwner.placeholder"}),resultSectionTitle:l.formatMessage({defaultMessage:"Select users",id:"manageTeamsOwnerFilter.searchOwner.resultsTitle"}),componentDebugName:"ManageTeamsSearchOwnerFilter"},performRequest:m,renderResultMenuItem:f,renderToken:()=>null,renderFilter:()=>null,renderItemForSummary:()=>null,addItemLabel:null,focused:!1})}var Np=()=>n(15936);const Fp="showAll",Up="showTeamsWithSecurityOverrides",zp={[Fp]:{key:Fp,name:(0,be.jsx)(A().sA,{id:"ManageTeamsSecurityOverridesFilter.showAllOption",defaultMessage:"Show all"}),originName:(0,be.jsx)(A().sA,{id:"ManageTeamsSecurityOverridesFilter.showAllPlaceholder",defaultMessage:"Security"}),showFilterAsOffWhenSelected:!0},[Up]:{key:Up,name:(0,be.jsx)(A().sA,{id:"ManageTeamsSecurityOverridesFilter.showTeamsWithSecurityOverrides",defaultMessage:"Has overrides"})}};function Kp({manageTeamsStore:e}){const t=(0,r().v3)(),n=(0,d().K8)((()=>e.state.showTeamsWithSecurityOverrides),[e]),o=(0,c().IS)((e=>({securityIcon:{marginInlineEnd:6}})),[]),s=[zp[Fp],zp[Up]],a=(0,i.useCallback)((n=>{e.setState({...e.state,showTeamsWithSecurityOverrides:n.key===Up}),Mp().hj(t,{filter:"securityOverrides",value:n.key})}),[e,t]),l=zp[n?Up:Fp];return(0,be.jsx)(kp,{selectItems:s,currentSelectedItem:l,onChange:a,icon:(0,be.jsx)(g().I,{icon:Np().checkmarkShieldIcon,style:o.securityIcon})})}const Vp=16,qp=5;function Wp({manageTeamsStore:e,teamStores:t}){const n=(0,c().IS)((()=>({container:{display:"flex",alignItems:"center",marginTop:20,flexWrap:"wrap",gap:`${Vp}px ${qp}px`},searchContainer:{maxWidth:250,marginInlineEnd:"auto"},dropdownContainer:{display:"flex",alignContent:"stretch",flexWrap:"wrap",gap:`${Vp}px ${qp}px`}})),[]),o=(0,d().K8)((()=>e.state.searchQuery),[e]),s=(0,i.useCallback)((t=>{e.update((e=>({...e,searchQuery:t})))}),[e]);return(0,be.jsxs)("div",{style:n.container,children:[(0,be.jsx)(Gp,{style:n.searchContainer,onChange:s,value:o}),(0,be.jsxs)("div",{style:n.dropdownContainer,children:[(0,be.jsx)(Rp,{manageTeamsStore:e}),(0,be.jsx)(Op,{teamStores:t,manageTeamsStore:e}),(0,be.jsx)(Tp,{manageTeamsStore:e}),(0,be.jsx)(Kp,{manageTeamsStore:e})]})]})}function Gp({style:e,value:t,onChange:n}){const o=(0,A().tz)(),s=(0,c().IS)((e=>({input:{boxShadow:e.inputBoxShadow,borderRadius:100,fontSize:12},searchIcon:{width:v().Ev.sm,height:v().Ev.sm,marginInlineEnd:2,flexGrow:0,flexShrink:0,fill:e.icon.secondary}})),[]),a=(0,i.useCallback)((e=>n(e.target.value)),[n]);return(0,be.jsx)(Ht().A,{placeholder:o.formatMessage({defaultMessage:"Search teamspaces...",id:"manageTeamsFilterRow.searchFilter.placeholder"}),style:{...s.input,...e},value:t,onChange:a,left:(0,xp().u)(s.searchIcon),format:Ht().C.Small,showClearButton:!0})}var Hp=()=>n(402014),Yp=()=>n(126158),$p=()=>n(468006),Qp=()=>n(632709),Zp=()=>n(553965);function Jp({teamStore:e,accessLevel:t,isTeamOwner:i,isArchivedTeam:o,onChangeAccessLevel:s,width:a}){const l=(0,r().v3)(),u=function(e){return(0,d().K8)((()=>e.isDefault()),[e])}(e),p=(0,n(209592).Z)({teamStore:e,onChange:s,isDefault:u}),g=u?"default":t,m=p.find((e=>e.key===g)),f=!i||o||Boolean(null==m?void 0:m.disableAllOptionsTooltip);let h;f&&(null!=m&&m.disableAllOptionsTooltip||!i?h=(0,be.jsx)(A().sA,{id:"manageTeamsAccessCell.onlyTeamOwnersCanChangeAccessLevel",defaultMessage:"Only teamspace owners can change teamspace access levels"}):o&&(h=(0,be.jsx)(A().sA,{id:"manageTeamsAccessCell.archivedTeamCannotChangeAccessLevel",defaultMessage:"Cannot change access level for archived team"})));const v=(0,n(233510).c)(),y=(0,c().IS)((e=>{const t=e.text.tertiary;return{selectButton:{paddingInlineStart:8,marginInlineStart:-8,maxWidth:a},label:{...f&&{color:t},fontSize:w().J.UIRegular.desktop,fontWeight:w().Wy.regular},chevron:{width:10,marginInlineStart:4,fill:e.icon.secondary,...f&&{fill:t}},tooltip:{width:200}}}),[f,a]);if(!m)throw new Error(`Selected access level is not an option found in team access level option: ${g}`);return(0,be.jsx)(jp().A,{items:p,getKey:e=>e.key,selectedItem:m,onSelect:e=>"private"!==e.key||v?e.onSelect():Ot().K(l,{from:"team_security_settings",upsell:{type:"product",product:"business",limit:{type:"none"},trialability:"none"}}),renderItem:e=>(0,be.jsx)(Re().A,{textWrap:!0,style:y.tooltip,placement:"bottom",disableTooltip:!e.value.tooltip,renderTooltip:()=>e.value.tooltip,render:t=>(0,be.jsx)(is().A,{title:e.value.title,...(0,Zp().A)(e,t)})}),disabled:f,renderOrigin:e=>(0,be.jsx)(Re().A,{textWrap:!0,style:y.tooltip,disableTooltip:!h,renderTooltip:()=>h,alignment:"center",placement:"left",render:t=>(0,be.jsxs)(qt().p,{style:y.selectButton,disabled:f,...(0,Zp().A)(e,t),children:[(0,be.jsx)(Vt().j,{style:y.label,children:m.level}),(0,qr().b)(y.chevron)]})})})}function Xp({teamOwnerIds:e,manageTeamsStore:t}){const o=(0,d().O$)(di().AppStoreSidebarSpaceStore),s=(0,A().tz)(),{userIds:a,groupIds:r}=e,l=(0,i.useMemo)((()=>[...a,...r]),[r,a]),{userStore:u,groupStore:p}=(0,d().K8)((()=>{if(!o)return{userStore:void 0,groupStore:void 0};const{filterByOwner:e}=t.state;let i=a[0]||r[0];if(e.type===fp){const t=e.id;l.includes(t)&&(i=t)}return i?a.includes(i)?{userStore:(0,ir().z5)({userId:i,currentSpaceStore:o}),groupStore:void 0}:{userStore:void 0,groupStore:(0,n(510473).E)({groupId:i,spaceStore:o})}:{userStore:void 0,groupStore:void 0}}),[o,r,t,l,a]),g=(0,d().K8)((()=>null!=u&&u.isDefined()?(0,Ep().c6)(s,u.getModel()):null!=p&&p.isDefined()?p.getName():void 0),[u,p,s]),m=(0,c().IS)((e=>({container:{display:"flex",alignItems:"center",fontSize:w().J.UIRegular.desktop,overflow:"hidden"},userAvatar:{paddingInlineEnd:6},nMoreOwnersText:{paddingInlineStart:3,color:e.text.secondary},noOwners:{marginInlineEnd:8,color:e.text.tertiary},userName:{flexShrink:1}})),[]);return l.length<1?(0,be.jsx)("div",{style:m.noOwners,children:(0,be.jsx)(A().sA,{id:"manageTeamsOwnersCell.noOwners",defaultMessage:"No owners"})}):(0,be.jsxs)("div",{style:m.container,children:[(0,be.jsx)(ar().A,{style:m.userAvatar,avatarShouldShowShadow:!0,userStore:u,size:20}),(0,be.jsx)(Vt().j,{style:m.userName,children:g}),l.length>1?(0,be.jsx)("div",{style:m.nMoreOwnersText,children:(0,be.jsx)(A().sA,{id:"manageTeamsOwnersCell.nMoreOwnersLabel",defaultMessage:"+{numAdditionalOwners}",values:{numAdditionalOwners:l.length-1}})}):void 0]})}const eg=[ip,op,sp,ap,rp],tg={[sp]:{headerTitle:(0,be.jsx)(A().sA,{id:"manageTeamsTable.columnTitle.access",defaultMessage:"Access"}),renderCell:({data:e,environment:t})=>(0,be.jsx)(Jp,{teamStore:e.store,accessLevel:e.accessLevel,isTeamOwner:e.isCurrentUserOwnerOfTeam,isArchivedTeam:e.isArchivedTeam,onChangeAccessLevel:(n,i)=>yp().qH({environment:t,store:e.store,accessLevel:n,isDefault:i,teamName:e.name,from:"manage_teams_table"}),width:90}),colWidth:{width:90},hasClickableContents:!0},[ip]:{headerTitle:(0,be.jsx)(A().sA,{id:"manageTeamspacesTable.columnTitle.teamspace",defaultMessage:"Teamspace"}),renderCell:({data:e})=>(0,be.jsx)(ng,{teamStore:e.store,isArchivedTeam:e.isArchivedTeam,name:e.name}),colWidth:{minWidth:30,widthPercent:35}},[op]:{headerTitle:(0,be.jsx)(A().sA,{id:"manageTeamsTable.columnTitle.owners",defaultMessage:"Owners"}),renderCell:({data:e,manageTeamsStore:t})=>(0,be.jsx)(Xp,{teamOwnerIds:e.owners,manageTeamsStore:t}),colWidth:{minWidth:60,widthPercent:25}},[ap]:{headerTitle:(0,be.jsx)(A().sA,{id:"manageTeamsTable.columnTitle.updated",defaultMessage:"Updated"}),renderCell:({data:e})=>e.lastUpdated&&(0,be.jsx)(ig,{lastUpdatedMillis:e.lastUpdated}),colWidth:{minWidth:50,widthPercent:15}},[rp]:{headerTitle:void 0,renderCell:({data:e})=>(0,be.jsx)(n(569047).OutlinerTeamOverflow,{teamStore:e.store,from:"manage_teams_table"}),colWidth:{width:30},hasClickableContents:!0}};function ng({teamStore:e,name:t,isArchivedTeam:i}){const o=(0,r().v3)(),s=(0,n(211825).G)(e),a=(0,c().IS)((e=>({container:{display:"flex",alignItems:"center",overflow:"hidden"},teamIcon:{marginInlineEnd:12},nameAndMembersContainer:{display:"flex",flexDirection:"column",minWidth:0},nameAndArchivedPillContainer:{display:"flex"},nameText:{lineHeight:"18px",fontWeight:w().Wy.regular},smallText:{fontSize:(0,n(115512).ny)(o,"UISmall"),color:e.text.secondary,fontWeight:w().Wy.regular},archivedTag:{marginInlineStart:5}})),[o]),l=`${(0,n(192940).h)(e)}`;return(0,be.jsxs)("div",{style:a.container,children:[(0,be.jsx)(n(898808).x,{style:a.teamIcon,size:28,store:e,disabled:!0}),(0,be.jsxs)("div",{style:a.nameAndMembersContainer,children:[(0,be.jsxs)("div",{style:a.nameAndArchivedPillContainer,children:[(0,be.jsx)(Vt().j,{style:a.nameText,children:t}),i?(0,be.jsx)(Ua().A,{desktopStyle:a.archivedTag,mobileStyle:a.archivedTag,children:(0,be.jsx)(A().sA,{id:"manageTeamsTable.archivedTag",defaultMessage:"Archived"})}):void 0]}),(0,be.jsxs)(Vt().j,{style:a.smallText,children:[(0,be.jsx)(A().sA,{id:"manageTeamsTableColumnData.numMembersLabel",defaultMessage:"{numMembers, plural, one {1 member} other {{numMembers} members}}",values:{numMembers:l}}),s?(0,be.jsxs)(be.Fragment,{children:[" â€¢ ",(0,be.jsx)(A().sA,{id:"manageTeamsTableColumnData.joinedLabel",defaultMessage:"Joined"})]}):void 0]})]})]})}function ig({lastUpdatedMillis:e}){return(0,be.jsx)(Vt().j,{children:(0,Fa().W_)(e,"very_short",Ln().locale)})}function og({teamStores:e,manageTeamsStore:t}){const n=(0,r().v3)(),o=(0,or().$)(),{sortAscending:s,sortColumn:a}=(0,d().K8)((()=>{const{sortAscending:e,sortColumn:n}=t.state;return{sortAscending:e,sortColumn:n}}),[t]),l=(0,d().K8)((()=>{const t=null==o?void 0:o.id;return t?M().oE(e.map((e=>{if(!e.canRead()||!e.isReady())return;const{ownerUserIds:n,ownerGroupIds:i}=e.getAllOwnerIds();return{store:e,name:e.getName()??"",owners:{userIds:n,groupIds:i},isCurrentUserOwnerOfTeam:Boolean(e.isOwner(t)),hasSecurityOverrides:e.hasSecurityOverrides(),accessLevel:e.getTeamAccessLevel(),isArchivedTeam:(0,$p().Sh)({archived_by:e.getArchivedBy()}),lastUpdated:e.getLastEditedTime()}}))):[]}),[null==o?void 0:o.id,e]),u=(0,d().K8)((()=>{const{showOnlyArchivedTeams:e,filterByOwner:n,showTeamsWithSecurityOverrides:i,filterAccess:o}=t.state;return l.filter((t=>e?t.isArchivedTeam:!t.isArchivedTeam)).filter((e=>!i||e.hasSecurityOverrides)).filter((e=>{if(o===cp&&"open"!==e.accessLevel)return!1;if(o===up&&"closed"!==e.accessLevel)return!1;if(o===pp&&"private"!==e.accessLevel)return!1;switch(n.type){case mp:return e.owners.userIds.length+e.owners.groupIds.length===0;case fp:return[...e.owners.userIds,e.owners.groupIds].includes(n.id);case gp:return!0;default:(0,bt().HB)(n)}}))}),[t,l]),p=(0,d().K8)((()=>{const{sortAscending:e,sortColumn:n}=t.state;return function({data:e,sortColumn:t,sortAscending:n}){const i=[n?"asc":"desc"],o=[n?"desc":"asc"];switch(t){case ip:return M().My(e,(e=>e.name),o);case sp:return M().My(e,(e=>Cc().nJ.indexOf(e.accessLevel)),i);case ap:return M().My(e,(e=>e.lastUpdated),i);default:(0,bt().HB)(t)}}({data:u,sortAscending:e,sortColumn:n})}),[t,u]),g=(0,d().K8)((()=>(0,Eu().Ay)(t.state.searchQuery,p,(e=>e.name))),[t,p]),m=(0,i.useCallback)((e=>yp().F2({environment:n,teamId:e,tab:Qp().p.Members,from:"manage_teams_table"})),[n]),f=(0,c().IS)((e=>({container:{marginTop:17,tableLayout:"fixed",borderCollapse:"collapse",width:"100%",minWidth:eg.reduce(((e,t)=>e+pg(tg[t].colWidth)+cg),0)},tableHeaderRow:{borderTop:`1px solid ${e.tableDividerColor}`,borderBottom:`1px solid ${e.tableDividerColor}`},noTeamsLabel:{marginTop:15,marginBottom:40,textAlign:"center"}})),[]),h=(0,i.useCallback)((e=>{const{sortColumn:i,sortAscending:o}=t.state,s=e===i&&!o;t.setState({...t.state,sortAscending:s,sortColumn:e}),Mp().xl(n,{sortBy:e,sortOrder:o?"ascending":"descending"})}),[t,n]),v=(0,i.useCallback)((()=>{t.reset()}),[t]);return(0,be.jsxs)(be.Fragment,{children:[(0,be.jsxs)("table",{style:f.container,children:[(0,be.jsx)("thead",{children:(0,be.jsx)("tr",{style:f.tableHeaderRow,children:eg.map((e=>(0,be.jsx)(ag,{column:e,onSortableColumnClick:h,sortAscending:s,sortColumn:a},`header_${e}`)))})}),(0,be.jsxs)("tbody",{children:[(0,be.jsx)("tr",{children:eg.map((e=>(0,be.jsx)("td",{},`padding_row_${e}`)))}),g.map((e=>(0,be.jsx)(sg,{onShowTeamSettings:m,teamData:e,manageTeamsStore:t},`${e.store.id}_row`)))]})]}),(0,be.jsx)(lg,{style:f.noTeamsLabel,numItemsAfterFilter:g.length,numItemsBeforeFilter:e.length,onResetFilters:v})]})}function sg({teamData:e,manageTeamsStore:t,onShowTeamSettings:n}){const[o,s]=(0,i.useState)(!1),a=(0,i.useCallback)((()=>s(!0)),[]),r=(0,i.useCallback)((()=>s(!1)),[]),l=(0,i.useCallback)((t=>{dg(t,(()=>n(e.store.id)))}),[n,e.store.id]),d=!e.isArchivedTeam,u=(0,c().IS)((e=>({teamRow:{cursor:d?"pointer":"default",borderBottom:`1px solid ${e.tableDividerColor}`}})),[d]);return(0,be.jsx)("tr",{onMouseLeave:d?r:void 0,onMouseEnter:d?a:void 0,style:u.teamRow,onClick:d?l:void 0,children:eg.map((n=>(0,be.jsx)(rg,{isRowHovered:o,teamData:e,columnData:tg[n],manageTeamsStore:t},`${e.store.id}_${n}`)))})}function ag({column:e,onSortableColumnClick:t,sortColumn:n,sortAscending:i}){const o=tg[e],s=(0,c().IS)((e=>({th:gg(o),innerDiv:{display:"flex",alignItems:"center",minWidth:pg(o.colWidth),height:32},text:{fontSize:w().J.UISmall.desktop,fontWeight:w().Wy.regular,color:e.text.secondary},sortButton:{padding:5,margin:-5,overflow:"hidden",maxWidth:"100%"},sortIcon:{fill:e.text.secondary,width:12,height:12,marginInlineStart:4}})),[o]),a=(0,be.jsx)(Vt().j,{style:s.text,children:o.headerTitle}),r=(l=e,lp.includes(l)?(0,be.jsxs)(qt().p,{style:s.sortButton,onClick:()=>t(e),children:[a,(()=>{if(e===n)return(0,Yp().m)({...s.sortIcon,...i&&{transform:"rotate(180deg)"}})})()]}):a);var l;return(0,be.jsx)("th",{style:s.th,children:(0,be.jsx)("div",{style:s.innerDiv,children:r})})}function rg({teamData:e,columnData:t,isRowHovered:n,manageTeamsStore:i}){const o=(0,r().v3)(),s=(0,c().IS)((e=>({td:{...gg(t),...n&&{background:e.buttonHoveredBackground}},innerDiv:{minWidth:pg(t.colWidth),fontSize:w().J.UIRegular.desktop,color:e.text.primary,height:56,display:"flex",alignItems:"center"}})),[t,n]),a=dg,l=Boolean(t.hasClickableContents);return(0,be.jsx)("td",{style:s.td,children:(0,be.jsx)("div",{style:s.innerDiv,onClick:l?a:void 0,children:t.renderCell({environment:o,data:e,manageTeamsStore:i})})})}function lg({style:e,numItemsBeforeFilter:t,numItemsAfterFilter:n,onResetFilters:i}){if(0!==n)return null;let o;return o=0!==t?(0,be.jsx)(A().sA,{id:"manageTeamsTable.emptyManageTeamTableDisclaimer.teamsFilteredOut",defaultMessage:"Could not find any teamspaces. <linkbutton>Reset your filters</linkbutton>",values:{linkbutton:e=>(0,be.jsx)(zn().A,{onClick:i,children:e})}}):(0,be.jsx)(A().sA,{id:"manageTeamsTable.emptyManageTeamTableDisclaimer.noTeamsExist",defaultMessage:"Could not find any teamspaces."}),(0,be.jsx)(Ee().A,{isSmall:!0,style:e,children:o})}function dg(e,t){(0,Hp().SQ)({event:e,context:Hp().y$.Click,callback:t})}const cg=10,ug={paddingInlineStart:cg/2,paddingInlineEnd:cg/2};function pg(e){return"minWidth"in e?e.minWidth:e.width}function gg(e){let t={};return t="width"in e.colWidth?{width:e.colWidth.width}:{width:`${e.colWidth.widthPercent}%`,minWidth:e.colWidth.minWidth},{...ug,...t}}function mg({}){const{isMobile:e=!1}=(0,r().Y0)(),t=(0,d().uB)(vp),n=(0,c().IS)((()=>({container:{marginTop:8},header:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:8},subheader:{display:"flex",flexDirection:"column",flexShrink:1,overflow:"hidden"}})),[]),{teams:o,isLoading:s,isError:a}=(0,id().sj)(),l=(0,id().gc)({teams:o}).map((e=>e.store)),u=(0,i.useCallback)((()=>yp().vn("workspace_settings")),[]);return(0,be.jsxs)("div",{style:n.container,children:[(0,be.jsxs)(Ie().A,{large:!e,style:n.header,small:!0,children:[(0,be.jsxs)("div",{style:n.subheader,children:[(0,be.jsx)(A().sA,{id:"manageTeamsBrowser.title",defaultMessage:"Manage teamspaces"}),(0,be.jsx)(Ee().A,{isSmall:!0,style:{marginTop:3},children:(0,be.jsx)(A().sA,{id:"manageTeamsBrowser.subtitle",defaultMessage:"Manage all teamspaces you have access to here"})})]}),(0,be.jsx)(wt().A,{colorPalette:"blue",onClick:u,size:"lg",className:ot().e6S,children:(0,be.jsx)(A().sA,{id:"manageTeamsBrowser.newTeamButton.text",defaultMessage:"New teamspace"})})]}),s||a?(0,be.jsx)(Fo().k,{}):(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(Wp,{teamStores:l,manageTeamsStore:t}),(0,be.jsx)(og,{teamStores:l,manageTeamsStore:t})]})]})}var fg=()=>n(885067);function hg(){const e=(0,r().Y0)();return(0,be.jsx)(Ie().A,{large:!e.isMobile||void 0,divider:e.isMobile?void 0:"full",children:(0,be.jsx)(A().sA,{id:"teamsWorkspaceSettings.title",defaultMessage:"Teamspace settings"})})}function vg(){const e=(0,r().v3)(),t=(0,d().O$)(di().AppStoreSidebarSpaceStore),n=(0,d().uB)(void 0,fi().A),o=(0,d().K8)((()=>t&&n.getValueForSpace(t)),[t,n]),s=(0,d().K8)((()=>(0,Le().Qd)()),[]),a=(null==o?void 0:o.disableTeamCreation)??!1,l=(null==o?void 0:o.disableTeamGuests)??!1,c=void 0===o,u=(0,i.useCallback)((()=>{t&&o&&async function({newSettingValue:e,environment:t,workspaceSecuritySettings:n,spaceStore:i}){const o="allowTeamCreation"===e?(0,be.jsx)(A().sA,{id:"manageTeamsHelpers.confirmChangeSecuritySetting.allowTeamCreation",defaultMessage:"Allow all members of this workspace to create teamspaces?"}):(0,be.jsx)(A().sA,{id:"manageTeamsHelpers.confirmChangeSecuritySetting.workspaceOwners.disableTeamCreation",defaultMessage:"Limit teamspace creation to only workspace owners?"}),{accept:s}=await T().Gh({message:o});!!s&&zi().V(t,{securitySettingsState:{...n,disableTeamCreation:"disableTeamCreation"===e},spaceStore:i})}({newSettingValue:a?"allowTeamCreation":"disableTeamCreation",environment:e,spaceStore:t,workspaceSecuritySettings:o})}),[t,a,e,o]);return(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(fg().y,{disabled:c,onChange:u,title:(0,be.jsx)(A().sA,{id:"teamWorkspacesSettings.disableTeamCreation.workspaceOwners.title",defaultMessage:"Limit teamspace creation to only workspace owners"}),description:(0,be.jsx)(A().sA,{id:"teamWorkspacesSettings.disableTeamCreation.workspaceOwners.caption",defaultMessage:"Only allow workspace owners to create teamspaces"}),selected:a}),(0,be.jsx)(Gs().A,{size:34}),s?(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(fg().y,{disabled:c,onChange:async function(){if(t&&o){if(!Boolean(o.disableTeamGuests)){const{accept:e}=await T().Gh({message:(0,be.jsx)(A().sA,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.message",defaultMessage:"Are you sure you want to disable teamspace guests?"}),description:(0,be.jsx)(A().sA,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.description",defaultMessage:"This action will remove all teamspace guests from the workspace."}),acceptLabel:(0,be.jsx)(A().sA,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.acceptButton",defaultMessage:"Disable and remove teamspace guests"})});if(!e)return}zi().V(e,{securitySettingsState:{...o,disableTeamGuests:!o.disableTeamGuests},spaceStore:t})}},title:(0,be.jsx)(A().sA,{id:"teamWorkspacesSettings.disableTeamGuests.workspaceOwners.title",defaultMessage:"Allow teamspace owners to add teamspace guests"}),description:(0,be.jsx)(A().sA,{id:"teamWorkspacesSettings.disableTeamGuests.workspaceOwners.caption",defaultMessage:"This will allow teamspace owners with membership admin permissions to add teamspace guests. Disabling will remove all teamspace guests."}),selected:!l}),(0,be.jsx)(Gs().A,{size:34})]}):void 0]})}function yg({}){const e=(0,c().IS)((()=>({learnMoreLinkContainer:{paddingTop:6,paddingBottom:20}})),[]),t=(0,r().v3)(),n=(0,d().O$)(di().AppStoreSidebarSpaceStore),o=(0,i.useCallback)((async({addedTeams:e,removedTeams:i})=>{n&&await async function({addedTeams:e,removedTeams:t,environment:n,spaceStore:i}){return!!i.isDefined()&&await yp().FE({addedStores:e.map((({store:e})=>e)),removedStores:t.map((({store:e})=>e)),environment:n,spaceStore:i,createNewTeamFlowId:void 0,from:"workspace_settings"})}({environment:t,addedTeams:e,removedTeams:i,spaceStore:n})}),[n,t]),{teams:s,isLoading:a,isError:l}=(0,id().xJ)(),u=(0,id().gc)({teams:s}).map((e=>e.store)),p=0===u.length?null:(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(Sp().A,{unarchivedTeams:u,onUpdate:o,description:(0,be.jsx)(Ee().A,{isSmall:!0,isMultiline:!0,children:(0,be.jsx)(A().sA,{id:"teamsWorkspaceSettings.defaultTeams.caption",defaultMessage:"Choose teamspaces that all new and current workspace members will automatically join"})})}),(0,be.jsx)(Gs().A,{size:34})]});return(0,be.jsxs)(St().Ay,{children:[(0,be.jsx)(hg,{}),(0,be.jsx)(bp().A,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_workspace_settings",containerStyle:e.learnMoreLinkContainer}),a||l?null:(0,be.jsxs)(be.Fragment,{children:[p,(0,be.jsx)(vg,{}),(0,be.jsx)(mg,{})]})]})}var bg=()=>n(939938),Sg=()=>n(44551);function xg(e){var t;null===Sg().electronApi||void 0===Sg().electronApi||null===(t=Sg().electronApi.setGlobalShortcutsEnabled)||void 0===t||t.call(Sg().electronApi,e)}var Ag=()=>n(75435),Mg=()=>n(20022);function wg(){const e=(0,d().K8)((()=>{var e;return null===(e=Ag().A.state.preferences)||void 0===e?void 0:e.onStartup}),[]);if(!e)return null;const t=[{key:"continue",label:(0,be.jsx)(A().sA,{id:"OnDesktopAppStartupSetting.continue.label",defaultMessage:"Continue where you left off"})},{key:"default_page",label:(0,be.jsx)(A().sA,{id:"OnDesktopAppStartupSetting.defaultPage.label",defaultMessage:"Your default page"})}];return(0,be.jsx)(Lt().A,{isMobile:!1,title:(0,be.jsx)(A().sA,{id:"onStartup.title",defaultMessage:"On startup"}),caption:(0,be.jsx)(A().sA,{id:"onStartup.description",defaultMessage:"Choose what to show when the Notion app starts."}),type:"dropdown",currentOption:e,options:t,onSelectOption:e=>{Mg().Zq.setPreference("onStartup",e)}})}var jg=()=>n(420844);const kg=function(){const e=(0,d().K8)((()=>{var e;return null===(e=Ag().A.state.preferences)||void 0===e?void 0:e.onStartup}),[]),t=(0,r().v3)(),i=(0,jg().OC)({environment:t}),o=_e().A.isMobile,s=[...(0,d().K8)((()=>o||!Array.isArray(i)?[]:i),[o,i]),e?{key:"on-startup",renderSettingsItem:()=>(0,be.jsx)(wg,{})}:void 0,{key:"default-page",renderSettingsItem:()=>(0,be.jsx)(n(993342).A,{isMobile:!1})}].filter(bt().O9);return(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(Ie().A,{large:!0,divider:"full",children:o?(0,be.jsx)(A().sA,{id:"desktopAppStartupSettings.settingsSection.title",defaultMessage:"Startup"}):(0,be.jsx)(A().sA,{id:"desktopAppSettings.settingsSection.title",defaultMessage:"Desktop app"})}),(0,be.jsx)(Kr().U,{items:s}),(0,be.jsx)(Gs().A,{size:48,isHidden:!0})]})};var Ig=()=>n(72897),Cg=()=>n(152197);function Tg(){const e=(0,r().v3)(),t=(0,d().O$)(di().AppStoreCurrentUserSettingsStore),n=(0,Cg().r)(),o=(0,d().K8)((()=>{var e;return n&&(null==t||null===(e=t.getSettings())||void 0===e||null===(e=e.beta_ai_co_editing_settings)||void 0===e||null===(e=e[n])||void 0===e?void 0:e.autocorrect)}),[t,n])??!1,s=(0,i.useCallback)((async()=>{n&&t&&await Ig().setCoEditingSetting({environment:e,userSettingsStore:t,spaceId:n,active:!o})}),[e,o,t,n]),a=(0,be.jsx)(A().sA,{id:"aiCoEditingSettings.title",defaultMessage:"AI Co-editor"}),l=(0,be.jsx)(A().sA,{id:"aiCoEditingSettings.caption",defaultMessage:"Notion AI checks for writing suggestions and fixes errors as you type."});return(0,be.jsx)(Lt().A,{title:a,caption:l,isOn:o,type:"toggle",onToggle:s})}var _g=()=>n(704444);const Pg=function({isMobile:e}){const t=(0,r().v3)(),n=(0,d().O$)(di().AppStoreCurrentUserSettingsStore),o=(0,d().K8)((()=>{var e;return null==n||null===(e=n.getSettings())||void 0===e?void 0:e.profile_discoverable}),[n])??!0,s=(0,i.useCallback)((e=>{const i=!o;E().createAndCommit({userAction:"ProfileDIscoverabilitySettings.onToggleOption",environment:t,canUndo:!0,perform:e=>{n&&L().mJ({userSettingsStore:n,data:{profile_discoverable:i},transaction:e})}})}),[t,o,n]),a=(0,be.jsx)(A().sA,{id:"profileDiscoverabilitySettings.title",defaultMessage:"Profile discoverability"}),l=(0,be.jsx)(A().sA,{id:"profileDiscoverabilitySettings.caption",defaultMessage:"Users with your email can see your name and profile picture when inviting you to a new workspace. <inlinelink>Learn more</inlinelink>.",values:{inlinelink:e=>(0,be.jsx)(zn().A,{external:!0,href:(0,rt().x)("guides.profileSettings"),onClick:e=>{e.stopPropagation()},children:e})}});return(0,be.jsx)(Lt().A,{isMobile:e,title:a,caption:l,isOn:o,type:"toggle",onToggle:()=>s(n)})};const Bg=(0,n(149397).k)((function({passwordRequestStore:e,userEmailDomainSettings:t,billingData:o}){const{isPhone:a,isMobile:c,isElectron:u,isMobileNative:p,isAndroid:g,isTablet:m}=(0,r().Y0)(),f=(0,r().v3)(),h=(0,jg().jo)(),v=(0,d().uB)(void 0,bi().A);(0,l().l)((()=>{B().Q(f,v)}));const y=(0,d().K8)((()=>v.state.accountSettings),[v]),b=(0,mt().y6)(),S=(0,d().K8)((()=>n(430483).zD.isAiEnabled()&&s().default.checkGate({gateName:"ai_co_editing"})&&!m),[m]),x=(0,d().K8)((()=>c&&e?(0,jg().xF)({isPhone:a,isMobileNative:p,isAndroid:g,showOfflineSettings:b,passwordRequestStore:e,userEmailDomainSettings:t,billingData:o,accountSettings:y}):h),[c,a,p,g,b,e,t,y,o,h]);(0,i.useEffect)((()=>(u&&xg(!1),()=>{u&&xg(!0)})),[u]);const M=[{key:"ai-co-editing",renderSettingsItem:()=>(0,be.jsx)(Tg,{})}],w=[(0,d().K8)((()=>(0,_g().y)(f)),[f])?{key:"cookies",renderSettingsItem:()=>(0,be.jsx)(_g().S,{isMobile:c})}:void 0,{key:"view-history",renderSettingsItem:()=>(0,be.jsx)(n(991627).L,{isMobile:c})},{key:"profile-discoverability",renderSettingsItem:()=>(0,be.jsx)(Pg,{isMobile:c})}].filter(bt().O9);return(0,be.jsxs)(St().Ay,{children:[(0,be.jsx)(Ie().A,{large:!c,divider:"full",children:(0,be.jsx)(A().sA,{id:"preferences.settingsSection.title",defaultMessage:"Preferences"})}),(0,be.jsx)(Kr().U,{items:x}),(0,be.jsx)($r,{}),(0,be.jsx)(Gs().A,{size:48,isHidden:!0}),(0,be.jsx)(kg,{}),S?(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(Ie().A,{large:!c,divider:"full",children:(0,be.jsx)(A().sA,{id:"notificationAndPersonalSettings.aiSection.title",defaultMessage:"Notion AI"})}),(0,be.jsx)(Kr().U,{items:M}),(0,be.jsx)(Gs().A,{size:48,isHidden:!0})]}):null,(0,be.jsx)(Ie().A,{large:!c,divider:"full",children:(0,be.jsx)(A().sA,{id:"mySettings.privacySection.title",defaultMessage:"Privacy"})}),(0,be.jsx)(Kr().U,{items:w})]})}));var Dg=()=>n(271084),Rg=()=>n(317182);function Eg(e){const{up:t}=e,n={width:10,height:10,marginInlineStart:4};return t?(0,Yp().m)({...n,transform:"rotate(180deg)"}):(0,Yp().m)(n)}function Lg({users:e,store:t,extraColumns:n,initialSort:o,tableStyle:s}){const[a,r]=(0,i.useState)(o),l=(0,A().tz)();function c(e,t){return(0,be.jsxs)(p().Ay,{disabled:!t.sortable,ignoreLocalHoverState:!0,onClick:()=>{!function(e){r({column:e,asc:(null==a?void 0:a.column)===e&&!(null!=a&&a.asc)})}(e)},style:{display:"flex",alignItems:"center"},children:[t.title,t.sortable&&a&&a.column===e?Eg({up:a.asc}):void 0]},e)}const u=(0,i.useMemo)((()=>({title:(0,be.jsx)(A().sA,{id:"spacePermissionsSettings.userTable.userColumn.header",defaultMessage:"User"}),style:{width:"60%"},sortable:!0,renderer:e=>(0,be.jsx)(Oe().A,{actorStore:e}),getValue:e=>e.getDisplayName(l)})),[l]),g=(0,i.useMemo)((()=>({name:u,...n})),[n,u]),m=M().HP(g).map((e=>({key:e,header:c(e,g[e]),style:g[e].style}))),f=(0,d().K8)((()=>{const n=e.map((e=>ve().L.createChildStore(t,{table:V().oo,id:e.userId}))).filter((e=>e.isDefined()));return a?n.sort(((e,t)=>{const n=g[a.column].getValue(e),i=g[a.column].getValue(t),o=n<i?-1:n>i?1:0;return a.asc?o:-1*o})):n}),[e,t,g,a]);return(0,be.jsx)(Rg().A,{columns:m,rows:f.map((e=>{const t=Object.values(g).map(((t,n)=>t.renderer?t.renderer(e):(0,be.jsx)(i.Fragment,{children:t.getValue(e)},n)));return{key:e.id,columns:t}})),tableStyle:s})}function Og(e){const{store:t}=e,{isOnline:n,subscriptionDataStoreData:i,userSimilarityData:o,visibleUsersLoaded:s,visibleUsers:a}=(0,d().K8)((()=>{const e=yo().subscriptionDataStoreInstance.state,n=e?(0,Wn().Be)(e):[],i=M().Si(n.map((e=>ve().L.createChildStore(t,{table:V().oo,id:e.userId}).isReady())));return{isOnline:u().A.state.online,subscriptionDataStoreData:e,userSimilarityData:Dg().k.state||{},visibleUsersLoaded:i,visibleUsers:n}}),[t]);if(!n)return(0,be.jsx)(Ee().A,{isSmall:!0,style:{textAlign:"center"},children:(0,be.jsx)(A().sA,{id:"spacePermissionsSettings.offlineMessage",defaultMessage:"Please go online to manage members."})});if(!i)return(0,be.jsx)(Fo().A,{style:{marginTop:"calc(50%",marginInlineEnd:"-",marginBottom:"1em)",marginInlineStart:"auto"}});if(!s)return(0,be.jsx)(Fo().A,{style:{marginTop:"calc(50%",marginInlineEnd:"-",marginBottom:"1em)",marginInlineStart:"auto"}});const r={style:{},title:(0,be.jsx)(be.Fragment,{children:"Similarity Score"}),sortable:!0,renderer:e=>{var t;return(0,be.jsx)(be.Fragment,{children:(null===(t=o[e.id])||void 0===t?void 0:t.toFixed(3))||0})},getValue:e=>o[e.id]||0};return(0,be.jsxs)("div",{style:{width:"100%"},children:[(0,be.jsx)(Ie().A,{large:!0,divider:"full",style:{marginBottom:16,paddingBottom:4,display:"flex"},children:"User Similarity Scores"}),(0,be.jsx)(Lg,{users:a,store:t,extraColumns:{similarityColumn:r},initialSort:{column:"similarityColumn",asc:!1},tableStyle:{borderTop:void 0}})]})}function Ng(){const e=(0,r().v3)(),{isAndroid:t,isMobileNative:n}=e.device,o=(0,i.useCallback)((()=>{e.mobileNative&&e.mobileNative.openInternalSettings()}),[e]);return i.useEffect((()=>{n&&t&&e.mobileNative&&o()}),[n,t,e.mobileNative,o]),(0,be.jsx)("div",{style:{padding:16,textAlign:"center"},children:(0,be.jsx)(A().sA,{id:"mobileNativeSettings.opening",defaultMessage:"Opening Internal Settings..."})})}const Fg=new($e().O2)("experimentSettings",(()=>Promise.all([n.e(23930),n.e(7717)]).then(n.bind(n,45135)))),Ug=(0,$e()._h)(Fg,(e=>e.ExperimentSettings)),zg={display:"flex",flexDirection:"column",justifyContent:"space-between",overflow:"hidden",height:"100%"},Kg={display:"flex",flexDirection:"column",justifyContent:"space-between",paddingTop:12,paddingBottom:12,paddingInlineStart:8,paddingInlineEnd:8,gap:4,overflowY:"auto"},Vg={user_settings:{},profile:{},notifications:{},notifications_and_settings:{},connected_apps:{},language_and_region:{},offline:{},settings:{},teams:{adminOnly:!0,membersOnly:!0},members:{membersOnly:!0},analytics:{membersOnly:!0,enterpriseOnly:!0},plans:{membersOnly:!0},billing:{},subscription:{},requests:{adminOnly:!0},security:{adminOnly:!0},identity_provisioning:{adminOnly:!0},admin_content_search:{adminOnly:!0,enterpriseOnly:!0},integrations:{adminOnly:!0},imports:{},audit_log:{adminOnly:!0,enterpriseOnly:!0},public_pages:{membersOnly:!0},sites:{membersOnly:!0},custom_emoji:{membersOnly:!0},verified_pages:{membersOnly:!0},experiments:{},performance_toolbar:{},user_similarity_scores:{},collection_debug:{},offline_mode_debug:{},ai:{},design_previews:{},mobile_native:{}},qg=(0,A().YK)({dialogLabel:{id:"spaceSettings.dialogLabel",defaultMessage:"Settings & members"}});function Wg({spaceStore:e,userStore:t}){const o=(0,r().v3)(),{open:s,currentTab:a,openedFrom:u,upsellType:p}=(0,d().K8)((()=>{const{open:e,currentTab:t,openedFrom:n,upsellType:i}=At().A.state;return{open:e,currentTab:t,openedFrom:n,upsellType:i}}),[]),g=(0,d().uB)(void 0,n(194763).A),m=(0,d().uB)(void 0,bi().A),f=(0,d().uB)(void 0,fi().A),h=(0,d().uB)(void 0,mi),v=(0,d().uB)(void 0,yi);(0,l().l)((()=>{const t=f.getValueForSpace(e);t&&f.setState(t)})),(0,l().l)((()=>{B().Q(o,m)})),(0,i.useEffect)((()=>{s&&C().bt(o,{tab:a,from:u,upsell_type:p})}),[s]);const y=(0,i.useCallback)((()=>{n(224701).x(o),Yg(),j().Wy({environment:o,spaceId:e.id,canAdmin:e.canAdmin()})}),[o,e]),b=(0,i.useCallback)((()=>{nm((()=>{At().A.setState({...At().A.state,open:!1}),n(189157).A.reset(),v.reset(),Yg(),Si().A.reset()}),o,e,g,m,f)}),[o,e,g,m,f,v]),S=(0,c().IS)((()=>({modalInner:{width:1150,maxWidth:"calc(100vw - 100px)",height:"calc(100vh - 100px)",overflow:"hidden",borderRadius:12,maxHeight:715}})),[]);return(0,be.jsx)(On().a,{ariaLabel:G().A.formatMessage(qg.dialogLabel),open:s,innerStyle:S.modalInner,onOpen:y,onDismiss:b,render:()=>(0,be.jsx)(lm,{spaceStore:e,userStore:t,spaceBasicSettingsStore:g,spaceProfileSettingsStore:m,securitySettingsStore:f,samlSettingsStore:h,spaceDomainSettingsStore:v,onModalDismiss:b}),className:ot().w7$})}function Gg(e,t){const n=Vg[e];return!(n.adminOnly&&!t.canAdmin())&&(!(n.membersOnly&&!t.canRead())&&!(n.enterpriseOnly&&!(0,x().OX)(t.getSubscriptionTier())))}function Hg(e,t){return!!u().A.state.online||!(!t||!["offline","mobile_native"].includes(e))}function Yg(){Y().A.reset(),X.reset()}function $g(e,t,n){const{disablePublicAccess:i,disableGuests:o,disableMoveToSpace:s,disableExport:a,disableSpacePageEdits:r,disablePublicAccessRequests:l,disableTeamCreation:d,disableMembershipRequests:c,disableExternalMembershipRequests:u,disableGuestMembershipRequests:p,disableTeamGuests:g,disableGuestPrivatePages:m,enableGuestInviteRequests:f,enableAiTraining:h,zeroRetentionEnabled:v,disableMemberUpgradeRequests:y}=e.state;E().createAndCommit({userAction:"SpaceSettings.attemptCloseCurrentTab",environment:n,canUndo:!0,perform:e=>{D().l3({environment:n,disablePublicAccess:i,disableGuests:o,disableMoveToSpace:s,disableExport:a,disableSpacePageEdits:r,disablePublicAccessRequests:l,transaction:e,spaceStore:t,disableTeamCreation:d,disableMembershipRequests:c,disableExternalMembershipRequests:u,disableGuestPrivatePages:m,disableGuestMembershipRequests:p,disableTeamGuests:g,enableGuestInviteRequests:f,enableAiTraining:Boolean(h),zeroRetentionEnabled:Boolean(v),disableMemberUpgradeRequests:Boolean(y)})}})}function Qg({spaceStore:e}){const t=(0,r().v3)(),n=(0,d().K8)((()=>(0,Le().bW)(t)),[t]),i=(0,d().K8)((()=>Si().A.state.count),[]);return n?(0,be.jsx)($u,{}):(0,be.jsx)(si().A,{store:e,unreadAccessRequests:i})}function Zg({spaceStore:e}){const t=(0,r().v3)(),n=(0,d().O$)(yo().subscriptionDataStoreInstance),i=(0,Mn()._3)({spaceId:e.id}),o=(0,d().K8)((()=>xi().A.getData(t,{spaceId:e.id})),[e,t]),s=(0,d().K8)((()=>ci().L.getData(t,{spaceId:e.id})??[]),[e,t]);if(i){if((0,S().Fq)(i)){const t=Wn().BA(n);return t?(0,be.jsx)(Mi().Ay,{spaceStore:e,billingData:i,upcomingInvoiceData:o,customerData:t,billingEvents:s}):null}return(0,be.jsx)(Pi,{spaceStore:e,billingData:i,billingEvents:s})}return null}function Jg(){const e=(0,d().K8)((()=>(0,at().LB)()),[]),t=(0,d().K8)((()=>(0,at().jw)()),[]);return(0,be.jsx)(St().Ay,{children:(0,be.jsx)(Br().A,{genericImporterEnabled:e,zipImporterEnabled:t})})}function Xg(e){return{fontSize:12,lineHeight:1,marginBottom:1,color:e.text.secondary,fontWeight:w().Wy.semibold,alignItems:"center",display:"flex",height:24,paddingInlineStart:8,paddingInlineEnd:8,textOverflow:"ellipsis",overflow:"hidden"}}function em({tab:e}){const t=(0,c().DP)(),n=(0,r().v3)(),i=(0,d().O$)(di().AppStoreSidebarSpaceStore);return(0,d().K8)((()=>"members"===e&&n.device.isDesktop&&(null==i?void 0:i.canEditMembership())&&(0,Le().x3)()&&!(0,Le().bW)(n)&&Si().A.state.count>0),[e,n,i])?(0,be.jsx)(Id().m,{color:t.red.icon.accentPrimary}):null}function tm({spaceProfileSettingsStore:e,billingData:t}){const n=(0,S().eh)(t,"student");return(0,be.jsx)(Zr,{isEducationPlan:n,spaceProfileSettingsStore:e})}async function nm(e,t,n,i,o,s){const{currentUserStore:a,currentUserSettingsStore:r}=di().default.state;if(!a||!r)throw new Error("No user or settings store.");const l=(0,be.jsx)(A().sA,{id:"spaceSettings.closeSettingsDialog.confirmationMessage",defaultMessage:"Your changes have not been saved. Save changes?"}),d=(0,be.jsx)(A().sA,{id:"spaceSettings.closeSettingsDialog.confirmationButton.label",defaultMessage:"Yes"}),c=(0,be.jsx)(A().sA,{id:"spaceSettings.closeSettingsDialog.cancelationButton.label",defaultMessage:"No"}),{currentTab:u}=At().A.state;if("profile"===u){if(!M().n4(o.state,o.getValueForUser(a,r,G().A.getIntl()))){const{profilePhoto:n,name:i,startDayOfWeek:s}=o.state;return i?T().ui({message:l,showCancel:!0,keepFocus:!0,items:[{label:(0,be.jsx)(A().sA,{id:"spaceSettings.closeSettingsDialog.updateSettingsButton.label",defaultMessage:"Update"}),color:"blue",onAccept:()=>{E().createAndCommit({userAction:"SpaceSettings.attemptCloseCurrentTab",environment:t,canUndo:!0,perform:e=>{const{currentUserStore:t}=di().default.state;if(t&&k().b({userStore:t,data:{name:i,profilePhoto:n},transaction:e}),r){const t=r.getSettings();(null==t?void 0:t.start_day_of_week)!==s&&L().mJ({userSettingsStore:r,data:{start_day_of_week:s},transaction:e})}}}),e()}}],handleCancel:()=>{e()}}):T().f1((0,be.jsx)(A().sA,{id:"profileSettings.personalInfoSection.nameMissing.message",defaultMessage:"Please fill in name."})),!0}e()}else if("settings"===u&&n.canEdit()){const o=!M().n4(s.state,s.getValueForSpace(n)),a=!M().n4(i.state,i.getValueForSpace(n));if(o||a){const{accept:r}=await T().Gh({message:l,acceptLabel:d,cancelLabel:c});return r?(a&&D().Ef({environment:t,spaceStore:n,spaceBasicSettingsStore:i}),o&&$g(s,n,t),e()):e(),!0}e()}else if("audit_log"===u)Yg(),e();else if("analytics"===u)hi().A.reset(),e();else if("plans"===u&&n.canAdmin()){const i=s.getValueForSpace(n);!M().n4(s.state,s.getValueForSpace(n))&&i&&(s.setState(i),$g(s,n,t)),e()}else e();return!1}function im({tab:e,spaceStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:i,securitySettingsStore:s,spaceDomainSettingsStore:l}){const u=(0,c().DP)(),g=(0,r().v3)(),{itemRef:m,onKeyDown:f,onFocus:h,isTabbable:v}=(0,a().e)(),y=(0,d().K8)((()=>At().A.state.currentTab===e),[e]),b=(0,d().K8)((()=>Gg(e,t)),[t,e]),S=(0,d().K8)((()=>wi().ug[e](g,u)),[g,e,u]),x=(0,d().K8)((()=>wi().j$[e](g)),[g,e]),A=(0,d().K8)((()=>wi().pG[e](g)),[g,e]),M=(0,mt().y6)(),j=(0,d().K8)((()=>!Hg(e,M)),[e,M]),k=(0,Ri().EF)(yo().subscriptionDataStoreInstance),I=(0,o().X)("upgrade_system"),T="plans"===e&&!k,_=y&&!T,{animationState:P,animationTriggers:B}=(0,bo().lP)(),D=(0,c().IS)((e=>({title:j?{color:e.text.quaternary}:T?{color:e.blue.text.accentPrimary}:{},button:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingInlineStart:8,paddingInlineEnd:8,borderRadius:4,marginTop:1,marginBottom:1,minHeight:27,position:"relative",...y?{background:e.buttonHoveredBackground}:{}}})),[j,T,y]),R=I&&T,E=R?gt().C:void 0;return b?(0,be.jsxs)(p().Ay,{...B,ref:m,onKeyDown:f,onFocus:h,disallowTabbing:!v,role:"tab","aria-selected":y,"aria-controls":y?`settings-tabpanel-${e}`:void 0,id:`settings-tab-${e}`,disabled:j,hovered:y,style:D.button,onClick:o=>{if(y)return null;nm((()=>{At().A.setState({...At().A.state,currentTab:e,defaultSubtab:void 0}),l.reset(),C().Y7(g,{tab:e})}),g,t,n,i,s)},testId:`settings-tab-${e}`,children:[(0,be.jsxs)("div",{style:{display:"flex",alignItems:"center",..._&&{fontWeight:w().Wy.semibold}},children:[(0,be.jsx)(om,{shouldRenderAnimatedIcon:R,animatedIconFn:E,icon:S,animationState:P,isBlue:T,disabled:j}),(0,be.jsx)(Ee().A,{style:D.title,isMultiline:!0,children:x}),A]}),(0,be.jsx)(em,{tab:e})]}):null}function om(e){const{shouldRenderAnimatedIcon:t,animationState:n,icon:i,animatedIconFn:o,disabled:s,isBlue:a}=e,r=(0,c().IS)((e=>({icon:{...(0,wi().P6)(e,a),...s?{fill:e.text.quaternary}:{}}})),[s,a]);return t&&o?(0,be.jsx)("div",{style:{paddingInlineStart:2,paddingInlineEnd:2},children:(0,be.jsx)(g().I,{...(0,bo().e4)({icon:{type:"animated",iconFn:gt().C},animationState:n}),size:"sm",style:{...r.icon,width:v().Ev.sm,height:v().Ev.sm}})}):(0,be.jsx)("div",{style:r.icon,children:i})}function sm({spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:s,renderBelowPrompt:a}){const l=(0,r().v3)(),c=(0,A().tz)(),u=(0,d().K8)((()=>function(e){var t,n;const{sidebarSpaceViewStore:i,sidebarSpaceStore:o,currentUserStore:s}=di().default.state;if(!o||!Gg("analytics",o))return!1;if(null==s||!s.id)return!1;if(null==o||!o.isDefined())return!1;const a=null==i?void 0:i.getSettings();return"dismissed"!==(null==a||null===(t=a.space_analytics_settings_prompt)||void 0===t?void 0:t.status)&&"hidden"!==(null==a||null===(n=a.space_analytics_settings_prompt)||void 0===n?void 0:n.status)&&(R().OV(e),!0)}(l)),[l]),p=(0,d().O$)(di().AppStoreSidebarSpaceStore),g=(0,d().K8)((()=>null==p?void 0:p.canAdmin()),[p]),m=(0,d().K8)((()=>function(e,t){var n,i;const{sidebarSpaceViewStore:o,sidebarSpaceStore:s,currentUserStore:a}=di().default.state;if(null==a||!a.id)return!1;if(null==s||!s.isDefined())return!1;const r=null==o?void 0:o.getSettings();return!("dismissed"===(null==r||null===(n=r.passkey_settings_prompt)||void 0===n?void 0:n.status)||"hidden"===(null==r||null===(i=r.passkey_settings_prompt)||void 0===i?void 0:i.status)||!t.state.accountSettings.hasPassword||t.state.accountSettings.hasPasskeys||(R().mj(e),0))}(l,n)),[l,n]),v=(0,o().X)("passkey_nudges");if(u){const o=g?(0,be.jsx)(A().sA,{id:"enterpriseSpaceAnalyticsSettingsPrompt.caption.workspaceOwner",defaultMessage:"Explore how members & guests are engaging with this workspace, common searches that are made, and content engagement metrics with workspace analytics."}):(0,be.jsx)(A().sA,{id:"enterpriseSpaceAnalyticsSettingsPrompt.caption.member",defaultMessage:"See how your content is performing by reviewing metrics like number of views or unique visitors using workspace analytics."});return(0,be.jsx)(yl,{onDismiss:()=>R().Jm(l),onClick:()=>{nm((()=>{At().A.setState({...At().A.state,currentTab:"analytics",defaultSubtab:void 0}),s.reset(),C().Y7(l,{tab:"analytics"}),R().p$(l)}),l,e,t,n,i)},onView:e=>{"enterprise"===(null==p?void 0:p.getSubscriptionTier())&&R().p$(e)},onClickLearnMore:()=>{const e=(0,rt().x)("guides.workspaceAnalytics");(0,P().L)({environment:l,url:e})},descriptionMessage:o,title:(0,be.jsx)(A().sA,{id:"enterpriseSpaceAnalyticsSettingsPrompt.title",defaultMessage:"New workspace analytics"}),buttonText:(0,be.jsx)(A().sA,{id:"enterpriseSpaceAnalyticsSettingsPrompt.cta",defaultMessage:"View metrics"}),buttonAriaLabel:c.formatMessage({id:"enterpriseSpaceAnalyticsSettingsPrompt.cta",defaultMessage:"View metrics"}),icon:h().J})}return v&&m?(0,be.jsx)(yl,{onClick:()=>{nm((()=>{At().A.setState({...At().A.state,open:!0,currentTab:"profile",defaultSubtab:void 0,highlightedSetting:At().r.Passkey}),C().Y7(l,{tab:"profile"})}),l,e,t,n,i)},onView:R().VW,onDismiss:()=>R().VI(l),onClickLearnMore:()=>{const e=(0,rt().x)("guides.passkeys");(0,P().L)({environment:l,url:e})},descriptionMessage:(0,be.jsx)(A().sA,{id:"passkeySettingsPrompt.description",defaultMessage:"Set up a passkey for faster, safer log-ins."}),title:(0,be.jsx)(A().sA,{id:"passkeySettingsPrompt.title",defaultMessage:"Enable passkeys for better protection"}),buttonText:(0,be.jsx)(A().sA,{id:"passkeySettingsPrompt.button.label",defaultMessage:"Enable passkeys"}),buttonAriaLabel:c.formatMessage({id:"passkeySettingsPrompt.button.ariaLabel",defaultMessage:"Enable passkeys"}),icon:f().h}):a}function am({spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l}){const u=(0,c().DP)(),p=(0,r().v3)(),g=(0,Mn().lh)({spaceId:e.id}),m=(0,d().K8)((()=>At().A.state.currentTab),[]),f=(0,pt().I_)(),h=(0,S().et)(g),v=function(e,t){const n=(0,d().O$)(yo().subscriptionDataStoreInstance),i=(0,Mn()._3)({spaceId:t.id});return!(!n||!i||e||!((0,S().Fq)(i)||i.paymentMethod||n.hasPaidNonzero))}(h,e),M=(0,d().K8)((()=>e.canAdmin()),[e]),w=(0,d().K8)((()=>null==f?void 0:f.getMembershipType()),[f]),j=function(){const e=(0,Ei().L)(),t=(0,Mn().lh)({spaceId:null==e?void 0:e.id});return(0,d().K8)((()=>{if(!e)return!1;const n=e.canAdmin(),i=(0,S().AI)(t);return!_e().A.isMobile&&n&&(0,x().jR)(i)}),[t,e])}(),k=!p.device.isMobile&&(0,b().V2)({minimumType:"member",membershipType:w}),C=(0,b().V2)({minimumType:"member",membershipType:w}),T=(0,mt().y6)(),_=function(e){const t=(0,o().X)("mobile_native_plan_upgrade_tab_kill_switch"),n=(0,o().X)("samsung_disable_all_upgrades"),i=(0,li().T)("isInstalledFromSamsungAppStore"),s=(0,li().T)("isSamsungPreload");return!(e.device.isMobileNative&&(t||!s&&!i||n))}(p),[P,B,D,R,E]=(0,d().K8)((()=>{const e=(0,lt().l5)();return[e,e,e,e&&s().default.checkGate({gateName:"download_for_offline"}),e||s().default.checkGate({gateName:"design_previews_enabled"})]}),[]),L=(0,ht().kg)(),O=(0,d().K8)((()=>{const t=ui().A.getData(p,{spaceId:e.id}),n=t&&(null==t?void 0:t.pointers.length)>0;return!p.device.isMobile&&((0,st().wA)({spaceStore:e})||n)}),[p,e]);(0,ut().A)({shouldPreserveTextSelection:!0,shouldPreserveBlockSelection:!0,shouldRestoreSelection:!0});const N=(0,d().K8)((()=>(0,dt().Ur)({environment:p,spaceStore:e})),[p,e]),F=(0,b().V2)({minimumType:"member",membershipType:w}),U=(0,ct().J)(),z=(0,d().K8)((()=>e.isAiEnabledOnSpace()),[e]),K=(0,o().X)("notion_ai_workspace_settings")&&(U||z),V=(0,ai().H)(),q=(0,d().K8)((()=>(0,ri().y)(p)),[p]);return(0,be.jsxs)("div",{style:zg,children:[(0,be.jsx)("div",{style:Kg,children:(0,be.jsx)(a().Y,{direction:"vertical",children:(0,be.jsxs)("div",{role:"tablist","aria-orientation":"vertical",children:[(0,be.jsx)("div",{style:Xg(u),children:(0,be.jsx)(A().sA,{id:"spaceSettings.sidebar.personalSettingsSection.title",defaultMessage:"Account"})}),(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"profile"}),(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"user_settings"}),(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"notifications"}),C?(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"connected_apps"}):void 0,T?(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"offline"}):void 0,(0,be.jsx)(Gs().A,{size:18,isHidden:!0}),(0,be.jsx)("div",{style:Xg(u),children:(0,be.jsx)(A().sA,{id:"spaceSettings.sidebar.workspaceSettingsSection.title",defaultMessage:"Workspace"})}),(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"settings"}),(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"members"}),(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"teams"}),V?null:(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"security"}),V?null:(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"identity_provisioning"}),k?(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"analytics"}):void 0,p.device.isMobile?void 0:(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"admin_content_search"}),p.device.isMobile?void 0:(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"audit_log"}),(0,be.jsx)(Gs().A,{size:16,colorVariant:"secondary"}),h?(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"subscription"}):void 0,K?(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"ai"}):void 0,N?(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"verified_pages"}):void 0,F?(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"public_pages"}):void 0,O?(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"custom_emoji"}):void 0,(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"integrations"}),p.device.isMobile||q?void 0:(0,be.jsx)("span",{onClick:()=>{const e=y().JW();pi().A.setState({flowId:e}),I().kY(p,{from:"settings",flowId:e})},children:(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"imports"})}),!q&&[j,v,_,P].some((e=>e))?(0,be.jsx)(Gs().A,{size:16,colorVariant:"secondary"}):null,j?(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"requests"}):null,v?(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"billing"}):null,_?(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"plans"}):null,P?(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(Gs().A,{size:18,isHidden:!0}),(0,be.jsx)("div",{style:Xg(u),children:(0,be.jsx)(A().sA,{id:"spaceSettings.sidebar.developmentSettingsSection.title",defaultMessage:"Development"})}),B?(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"experiments"}):void 0,L?(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"performance_toolbar"}):void 0,D?(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"user_similarity_scores"}):void 0,B?(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"collection_debug"}):void 0,R?(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"offline_mode_debug"}):void 0,P&&p.device.isMobileNative&&p.device.isAndroid?(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"mobile_native"}):void 0]}):void 0,E?(0,be.jsxs)(be.Fragment,{children:[(0,be.jsx)(Gs().A,{size:18,isHidden:!0}),(0,be.jsx)("div",{style:Xg(u),children:(0,be.jsx)(A().sA,{id:"spaceSettings.sidebar.qaSettingsSection.title",defaultMessage:"QA"})}),E?(0,be.jsx)(im,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,tab:"design_previews"}):void 0]}):void 0]})})}),(0,be.jsx)(sm,{spaceStore:e,spaceBasicSettingsStore:t,spaceProfileSettingsStore:n,securitySettingsStore:i,spaceDomainSettingsStore:l,renderBelowPrompt:M?(0,be.jsx)(Ai().Zy,{currentSettingsTab:m}):null})]})}function rm(){const e=(0,c().IS)((e=>({container:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},icon:{width:22,height:22,fill:e.text.secondary}})),[]);return(0,be.jsx)(St().Ay,{centerContent:!0,children:(0,be.jsxs)("div",{style:e.container,children:[(0,m().C)(e.icon),(0,be.jsx)(tp().g,{isSecondaryColor:!0})]})})}function lm({spaceStore:e,userStore:t,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:a,samlSettingsStore:r,spaceDomainSettingsStore:c,onModalDismiss:p}){const{organizationOverrides:g}=(0,uo().n)({spaceId:e.id}),m=(0,o().X)("settings_modal_close_button"),f=(0,mt().y6)(),h=(0,d().O$)(u().e),v=(0,d().K8)((()=>At().A.state.currentTab),[]);(0,i.useEffect)((()=>{if(!Gg(v,e)){const t=_().Yp(e);_().Ow({currentTab:t})}}),[v,e]),(0,l().w)((()=>{f&&!h&&"offline"!==v&&_().Ow({currentTab:"offline"})}));const y=(0,Mn()._3)({spaceId:e.id}),b=(0,d().K8)((()=>function(e,t,n,i,o,s,a,r,l,d){const c={profile:()=>(0,be.jsx)(tm,{spaceProfileSettingsStore:o,billingData:d}),notifications_and_settings:()=>(0,be.jsx)(Jr().A,{isMobile:!1,isMobileNative:!1,billingData:d}),user_settings:()=>(0,be.jsx)(Bg,{billingData:d}),notifications:()=>(0,be.jsx)(hl,{}),language_and_region:()=>(0,be.jsx)($r,{}),connected_apps:()=>(0,be.jsx)(bg().et,{location:"settings-page",spaceStore:t}),offline:()=>(0,be.jsx)(ft().bG,{}),settings:()=>(0,be.jsx)(bd().Ay,{spaceStore:t,billingData:d,spaceBasicSettingsStore:i,securitySettingsStore:s,organizationOverrides:l}),requests:()=>(0,be.jsx)(ho,{securitySettingsStore:s,spaceStore:t}),teams:()=>(0,be.jsx)(yg,{}),members:()=>(0,be.jsx)(Qg,{spaceStore:t}),analytics:()=>(0,be.jsx)(yd,{spaceStore:t}),plans:()=>(0,be.jsx)(Li().o3,{}),billing:()=>(0,be.jsx)(Zg,{spaceStore:t}),subscription:()=>(0,be.jsx)(St().Ay,{children:(0,be.jsx)(np().L,{})}),security:()=>(0,be.jsx)(oi,{securitySettingsStore:s,spaceStore:t,organizationOverrides:l}),identity_provisioning:()=>(0,be.jsx)(Pr,{spaceStore:t,userStore:n,samlConfigStore:a,domainSettingsStore:r}),admin_content_search:()=>(0,be.jsx)(Ps,{spaceStore:t,userStore:n}),integrations:()=>(0,be.jsx)(Ks,{spaceStore:t,userStore:n,organizationOverrides:l}),audit_log:()=>(0,be.jsx)(St().Ay,{children:(0,be.jsx)(Ye,{spaceStore:t})}),imports:()=>(0,be.jsx)(Jg,{}),sites:()=>(0,be.jsx)(tt,{spaceStore:t}),public_pages:()=>(0,be.jsx)(vt().fh,{spaceStore:t}),custom_emoji:()=>(0,be.jsx)(Xe,{spaceStore:t}),verified_pages:()=>(0,be.jsx)(xo,{spaceStore:t}),experiments:()=>(0,be.jsx)(St().Ay,{children:(0,be.jsx)(Ug,{})}),performance_toolbar:()=>(0,be.jsx)(St().Ay,{children:(0,be.jsx)(ht().dt,{})}),user_similarity_scores:()=>(0,be.jsx)(St().Ay,{children:(0,be.jsx)(Og,{store:t})}),collection_debug:()=>(0,be.jsx)(St().Ay,{children:(0,be.jsx)(Ze,{})}),offline_mode_debug:()=>(0,be.jsx)(St().Ay,{children:(0,be.jsx)(ft().Pz,{})}),ai:()=>(0,be.jsx)(St().Ay,{children:(0,be.jsx)(Ds().KZ,{spaceStore:t,billingData:d,securitySettingsStore:s})}),design_previews:()=>(0,be.jsx)(St().Ay,{children:(0,be.jsx)(it,{})}),mobile_native:()=>(0,be.jsx)(St().Ay,{children:(0,be.jsx)(Ng,{})})};return Gg(e,t)?c[e]:()=>null}(v,e,t,n,s,a,r,c,g,y)),[v,r,a,n,c,s,e,t,g,y]),S=(0,d().K8)((()=>!Hg(v,f)),[v,f]);return(0,be.jsx)(Hs().A,{capture:!0,allowEsc:!0,render:t=>(0,be.jsxs)(bl,{sidebar:(0,be.jsx)(am,{spaceStore:e,spaceBasicSettingsStore:n,spaceProfileSettingsStore:s,securitySettingsStore:a,spaceDomainSettingsStore:c}),contentId:`settings-tabpanel-${v}`,contentLabelledBy:`settings-tab-${v}`,contentRole:"tabpanel",...t,children:[S?(0,be.jsx)(rm,{}):b(),m?(0,be.jsx)(Ws().A,{onClick:p}):null]})})}const dm=i.memo(Wg)},525639:(e,t,n)=>{n.r(t),n.d(t,{DatePropertyMenu:()=>je});var i=n(296540),o=()=>n(59226),s=()=>n(726637),a=()=>n(662303),r=()=>n(484714),l=()=>n(56366),d=()=>n(604995),c=()=>n(416504),u=()=>n(971404),p=()=>n(69708),g=()=>n(722872),m=()=>n(117586),f=()=>n(805751),h=()=>n(404277),v=()=>n(89924),y=()=>n(597777),b=()=>n(760217),S=()=>n(581369),x=n(474848);function A({dateValue:e,onChangeValue:t}){const n=(0,o().X)("adoption_date_menu_relative_initial_time"),s=(0,i.useCallback)((()=>{if("date"===e.type){const i=M(e,n),o={type:"datetime",start_date:e.start_date,start_time:i,time_zone:(0,c().P)(),reminder:(0,y().Lh)(e)?y().ex(e.reminder):void 0};null==t||t(o)}else if("daterange"===e.type){const i=M(e,n),o={type:"datetimerange",start_date:e.start_date,start_time:i,end_date:e.end_date,end_time:i,time_zone:(0,c().P)(),reminder:(0,y().Lh)(e)?y().ex(e.reminder):void 0};null==t||t(o)}else if("datetime"===e.type){const n={type:"date",start_date:e.start_date,reminder:(0,y().Lh)(e)?y().vW(e.reminder,(0,c().P)()):void 0};null==t||t(n)}else{const n={type:"daterange",start_date:e.start_date,end_date:e.end_date,reminder:(0,y().Lh)(e)?y().vW(e.reminder,(0,c().P)()):void 0};null==t||t(n)}}),[e,t,n]);return(0,x.jsx)(b().A,{focused:!1,onClick:s,title:(0,x.jsx)(p().sA,{defaultMessage:"Include time",id:"LuxonDatePropertyMenu.menuItem.includeTime.label"}),right:(0,x.jsx)(S().A,{on:"date"!==e.type&&"daterange"!==e.type,onClick:s})})}function M(e,t){if(!t)return"00:00";const n=e.start_date,i=d().C6.isoToUnixMs(n,(0,c().P)()),o=d().T_((0,c().P)()).start_time;if(!i)return o;return d().c_(i)?d().Tj((0,c().P)()).start_time:y().vM}var w=()=>n(906745),j=()=>n(595555),k=()=>n(401497),I=()=>n(718827),C=()=>n(631524),T=()=>n(100622),_=()=>n(209199),P=()=>n(534177),B=()=>n(284371),D=()=>n(541181),R=()=>n(805025),E=()=>n(807778),L=()=>n(498140),O=()=>n(515872);const N=Object.freeze({backgroundColor:T().Tj.blue,color:T().Tj.white}),F=Object.freeze({backgroundColor:T().IF.blueWithAlpha(.43)});function U(e,t){switch(e){case m().dz.InvalidDate:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateError.tooltip",defaultMessage:"Invalid date"});case m().dz.InvalidRange:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateOrTimeRangeError.tooltip",defaultMessage:"Invalid range"});case m().dz.InvalidTime:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidTimeError.tooltip",defaultMessage:"Invalid time"})}}function z(e,t,n){return void 0===e||"relative"===e||"ll"===e?y().WA(H(n,t)):y().c1(e)}function K(e,t){return e&&(e!==y().jk||t)?y().B4(e):y()._g}function V(){return(0,u().X)(a().locale).time}function q(e,t,n){return(0,L().FM)(e,K(t,!1),n)}function W(e,t,n,i,o){return i.device.isMobile?(0,L().yc)(e,d().tr,t):(0,L().yc)(e,z(n,t,o),t)}function G(e,t,n,i){return!e||"number"==typeof e&&isNaN(e)?t&&(0,O().J)(t)?function(e,t){var n,i;const o=(null==t||null===(n=t.getPropertyTypeSpecificConfig("date"))||void 0===n?void 0:n.endDate)??!1,s=(null==t||null===(i=t.getPropertyTypeSpecificConfig("date"))||void 0===i?void 0:i.includeTime)??!1,a=d().vF({timezone:(0,c().P)()});if(o&&s)return d().NC(a.startOf("day").valueOf(),a.startOf("day").valueOf(),(0,c().P)());if(o)return d().Mk(a.valueOf(),a.valueOf(),(0,c().P)());if(s)return d().Xo(a.startOf("day"));return e}(n,i):n:e}function H(e,t){return e||t.locale}function Y(e,t,n){return"date"===e.type?{...e,type:"daterange",end_date:t||e.start_date}:"datetime"===e.type?{...e,type:"datetimerange",end_date:t||e.start_date,end_time:n||e.start_time}:void(0,P().HB)(e)}const $=(0,p().YK)({todayButtonLabel:{id:"datePicker.todayButton.label",defaultMessage:"Today"},nowButtonLabel:{id:"datePicker.nowButton.label",defaultMessage:"Now"},previousMonthLabel:{id:"datePicker.previousMonth.label",defaultMessage:"Go to previous month"},nextMonthLabel:{id:"datePicker.nextMonth.label",defaultMessage:"Go to next month"}});function Q({store:e,dateValue:t,disabled:n,firstDayOfWeek:s,onChangeValue:u}){const f=(0,r().v3)(),h=(0,r().Y0)(),v=(0,g().Tf)(),b=(0,o().X)("adoption_date_menu_relative_initial_time"),S=(0,l().K8)((()=>(0,E().D$)(f)),[f]),{focus:A,currentMonth:M}=(0,l().K8)((()=>({focus:e.state.focus,currentMonth:e.state.currentMonth})),[e]),L=(0,k().IS)((e=>({container:{textAlign:"center",...h.isMobile?{padding:"16px 14px 16px",background:e.popoverBackground,...!v&&{borderBottom:`1px solid ${e.regularDividerColor}`}}:{padding:`0 ${R().Qm}px`}},todayButton:{width:43,height:20},button:{background:"none",border:"none",cursor:"pointer",padding:0,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:3},navButtonSize:{width:20,height:20},navButton:{width:"11px",height:"17px",color:T().Tj.uiGray}})),[h.isMobile,v]),O=d().AA(t,(0,c().P)()),U=M||O.start,z=O.start.toJSDate(),K=A===m().xQ.StartDate||A===m().xQ.StartTime,V=(0,i.useCallback)((({day:i,activeModifiers:o,domEvent:s,datePreset:a})=>{if(n)return;const r=d().T_((0,c().P)()),l=w().c9.fromJSDate(i).setLocale(y().M5).toFormat(d().tr);if(s.shiftKey&&(y().$P(t)||y().Ar(t))){const n=Y(t,l);return null==u||u(n),void e.setState({...e.state,focus:m().xQ.EndDate})}let p;if(y().oM(t)||y().L3(t)){A===m().xQ.StartDate||A===m().xQ.StartTime?p={...t,start_date:l,..."now"===a&&b?{start_time:r.start_time}:{}}:A===m().xQ.EndDate||A===m().xQ.EndTime?p={...t,end_date:l,..."now"===a&&b?{end_time:r.start_time}:{}}:(0,P().HB)(A);const n=d().AA(p,(0,c().P)());n.end<n.start&&(y().oM(p)?p={...p,start_date:p.end_date,end_date:p.start_date}:y().L3(p)?p={...p,start_date:p.end_date,start_time:p.end_time,end_date:p.start_date,end_time:p.start_time}:(0,P().HB)(p),e.setState({...e.state,focus:A===m().xQ.StartDate||A===m().xQ.StartTime?m().xQ.EndDate:m().xQ.StartDate})),e.setState({...e.state,focus:A===m().xQ.StartDate||A===m().xQ.StartTime?m().xQ.EndDate:m().xQ.StartDate})}else p={...t,start_date:l,..."now"===a&&b?{start_time:r.start_time}:{}};return e.setState({...e.state,error:{...e.state.error,[A]:void 0},inputTemporaryValue:{...e.state.inputTemporaryValue,[A]:void 0}}),null==u||u(p),p}),[t,n,A,u,e,b]),q=(0,i.useCallback)(((e,t,n)=>{V({day:e,activeModifiers:t,domEvent:n})}),[V]),W=(0,i.useCallback)((t=>{e.setState({...e.state,currentMonth:w().c9.fromJSDate(t)})}),[e]),G=(0,i.useMemo)((()=>{if(O.end){const e=O.end.toJSDate();return{modifiers:{range:{from:z,to:e},...K?{end:e,start:z}:{start:z,end:e}},modifiersStyles:{range:{backgroundColor:"transparent"},start:K?N:F,end:K?F:N}}}return{selected:z,modifiers:{start:z},modifiersStyles:{start:N}}}),[O.end,z,K]),H=(0,i.useCallback)((e=>{const n=y().Ar(t)||y().L3(t),i=n&&b?$.nowButtonLabel:$.todayButtonLabel;return(0,x.jsx)("div",{className:"notion-calendar-caption",children:(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,x.jsx)(j().$J,{displayMonth:e.displayMonth}),(0,x.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[(0,x.jsx)(C().p,{onClick:e=>{W(w().c9.now().toJSDate());const t=n?"now":"today";V({day:w().c9.now().toJSDate(),domEvent:e,datePreset:t})},colorPalette:"gray",style:{...L.button,...L.todayButton,fontSize:12,fontWeight:B().Wy.medium},children:(0,x.jsx)(p().sA,{...i})}),(0,x.jsx)(I().Ay,{onClick:()=>W(w().c9.fromJSDate(e.displayMonth).minus({months:1}).toJSDate()),style:{...L.button,...L.navButtonSize},"aria-label":$.previousMonthLabel.defaultMessage,children:(0,_().A1)()?(0,x.jsx)(j()._l,{style:L.navButton}):(0,x.jsx)(j().Bu,{style:L.navButton})}),(0,x.jsx)(I().Ay,{onClick:()=>W(w().c9.fromJSDate(e.displayMonth).plus({months:1}).toJSDate()),style:{...L.button,...L.navButtonSize},"aria-label":$.nextMonthLabel.defaultMessage,children:(0,_().A1)()?(0,x.jsx)(j().Bu,{style:L.navButton}):(0,x.jsx)(j()._l,{style:L.navButton})})]})]})})}),[L.button,L.navButtonSize,L.todayButton,L.navButton,W,t,V,b]);return(0,x.jsx)("div",{style:L.container,children:S?(0,x.jsx)(D().n,{className:"notion-date-property-menu notranslate",components:{Caption:H},numberOfMonths:1,weekStartsOn:s,defaultMonth:U.toJSDate(),month:U.toJSDate(),locale:a().locale,showOutsideDays:!0,fixedWeeks:!0,onDayClick:q,onMonthSelected:W,...G}):(0,x.jsx)(D().n,{className:"notion-date-property-menu notranslate",numberOfMonths:1,weekStartsOn:s,defaultMonth:U.toJSDate(),month:U.toJSDate(),locale:a().locale,showOutsideDays:!0,fixedWeeks:!0,onDayClick:q,onMonthSelected:W,...G})})}function Z({onChangeValue:e}){const t=(0,i.useCallback)((()=>{null==e||e(void 0)}),[e]);return(0,x.jsx)(b().A,{focused:!1,onClick:t,title:(0,x.jsx)(p().sA,{defaultMessage:"Clear",id:"LuxonDatePropertyMenu.clearButton.label"})})}n(581454);var J=()=>n(406699),X=()=>n(113474),ee=()=>n(939740);function te({dateFormat:e,onChangeDateFormat:t}){const{isMobile:n}=(0,r().Y0)(),o=(0,p().tz)(),s=e||y().vz,a=(0,i.useCallback)((e=>{null==t||t(e)}),[t]),l=(0,i.useCallback)((e=>(0,x.jsx)(X()._,{...e,focused:!1,title:(0,x.jsx)(p().sA,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.menuItem.format.label"}),showExtensionArrow:n,chevronType:"right",right:s?o.formatMessage(y().xz[s]):(0,x.jsx)(p().sA,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.formatMenu.emptyButton.label"})})),[s,o,n]);return(0,x.jsx)(J().A,{popupType:n?J().z.BottomSheet:J().z.Popup,bottomSheetInitialState:"half",placementToOrigin:"right",renderOrigin:l,render:e=>{const t=y().wJ.map((t=>({key:t,action:()=>{a(t),e.close()},render:e=>(0,x.jsx)(b().A,{...e,title:o.formatMessage(y().xz[t]),isChecked:t===s})})));let i={menuType:g().gu.Popup};return n&&(i={menuType:g().gu.Modal,title:(0,x.jsx)(p().sA,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.mobileDateFormatModal.title"})}),(0,x.jsx)(h().A,{...i,children:(0,x.jsx)(ee().Ay,{type:ee().Oh.Vertical,initialFocus:void 0,sections:[{key:"date format section",render:e=>(0,x.jsx)(v().A,{...e}),items:t}]})})}})}function ne({dateValue:e,onChangeValue:t}){const n=(0,i.useCallback)((()=>{if("datetimerange"===e.type){const n={type:"datetime",start_date:e.start_date,start_time:e.start_time,time_zone:e.time_zone,reminder:e.reminder};null==t||t(n)}else if("daterange"===e.type){const n={type:"date",start_date:e.start_date,reminder:e.reminder};null==t||t(n)}else{const n=Y(e);null==t||t(n)}}),[e,t]);return(0,x.jsx)(b().A,{focused:!1,onClick:n,title:(0,x.jsx)(p().sA,{defaultMessage:"End date",id:"LuxonDatePropertyMenu.menuItem.endDate.label"}),right:(0,x.jsx)(S().A,{on:"daterange"===e.type||"datetimerange"===e.type,onClick:n})})}var ie=()=>n(720665),oe=()=>n(623580),se=()=>n(859428);const ae=12;function re({store:e,disabled:t,locale:n,surface:o,dateFormat:a,timeFormat:u,dateValue:g,formQuestionStore:f,onChangeValue:h}){const v=(0,r().v3)(),{device:b,WindowSizeStore:S}=v,A=(0,p().tz)(),{focus:M,inputTemporaryValue:w,error:j}=(0,l().K8)((()=>({focus:e.state.focus,inputTemporaryValue:e.state.inputTemporaryValue,error:e.state.error})),[e]),{formQuestionHasEndDate:I,formQuestionIncludesTime:C}=(0,l().K8)((()=>{var e,t;return{formQuestionHasEndDate:(null==f||null===(e=f.getPropertyTypeSpecificConfig("date"))||void 0===e?void 0:e.endDate)??!1,formQuestionIncludesTime:(null==f||null===(t=f.getPropertyTypeSpecificConfig("date"))||void 0===t?void 0:t.includeTime)??!1}}),[f]),T=(0,i.useMemo)((()=>d().AA(g,(0,c().P)(),H(n,A))),[g,n,A]),_=o&&(0,O().J)(o)?C:"datetime"===g.type||"datetimerange"===g.type,B=o&&(0,O().J)(o)?I:"daterange"===g.type||"datetimerange"===g.type,D=(0,i.useCallback)((()=>{const t=e.state.inputTemporaryValue.startDate;if(!t)return;const i=W(t,A,a,v,n);if(!i)return m().dz.InvalidDate;const o={...g,start_date:i},s=d().Dz(o);if(!s)return m().dz.InvalidRange;e.setState({...e.state,currentMonth:s.start,error:{...e.state.error,[m().xQ.StartDate]:void 0},inputTemporaryValue:{...e.state.inputTemporaryValue,[m().xQ.StartDate]:void 0}}),null==h||h(o)}),[a,g,v,A,n,h,e]),E=(0,i.useCallback)((()=>{const t=e.state.inputTemporaryValue.startTime;if(!t)return;const n=q(t,u,A);if(!n)return m().dz.InvalidTime;if(y().L3(g)){const{newDate:t,currentMonth:i}=d().uj({previous:g,updatedStartTime:n});e.setState({...e.state,currentMonth:i,error:{...e.state.error,[m().xQ.StartTime]:void 0,[m().xQ.EndDate]:void 0,[m().xQ.EndTime]:void 0},inputTemporaryValue:{...e.state.inputTemporaryValue,[m().xQ.StartTime]:void 0}}),null==h||h(t)}else{if(!y().Ar(g))return m().dz.InvalidTime;{const t={...g,start_time:n},i=d().Dz(t);e.setState({...e.state,currentMonth:i.start,error:{...e.state.error,[m().xQ.StartTime]:void 0},inputTemporaryValue:{...e.state.inputTemporaryValue,[m().xQ.StartTime]:void 0}}),null==h||h(t)}}}),[g,A,h,e,u]),L=(0,i.useCallback)((()=>{const t=e.state.inputTemporaryValue.endDate;if(!t)return;const i=W(t,A,a,v,n);if(!i)return m().dz.InvalidDate;if(!y().oM(g)&&!y().L3(g))return;const o={...g,end_date:i},s=d().Dz(o);if(!s)return m().dz.InvalidRange;e.setState({...e.state,currentMonth:s.end,error:{...e.state.error,[m().xQ.EndDate]:void 0},inputTemporaryValue:{...e.state.inputTemporaryValue,[m().xQ.EndDate]:void 0}}),null==h||h(o)}),[a,g,v,A,n,h,e]),N=(0,i.useCallback)((()=>{const t=e.state.inputTemporaryValue.endTime;if(!t)return;const n=q(t,u,A);if(!n)return m().dz.InvalidTime;if(!y().L3(g))return;const i={...g,end_time:n},o=d().Dz(i);if(!o)return m().dz.InvalidRange;e.setState({...e.state,currentMonth:o.end,error:{...e.state.error,[m().xQ.EndTime]:void 0},inputTemporaryValue:{...e.state.inputTemporaryValue,[m().xQ.EndTime]:void 0}}),null==h||h(i)}),[g,A,h,e,u]),F=(0,i.useCallback)((()=>{e.setState({...e.state,focus:m().xQ.StartDate,inputIsFocused:!0,currentMonth:T.start})}),[T.start,e]),U=(0,i.useCallback)((()=>{e.setState({...e.state,focus:m().xQ.StartTime,inputIsFocused:!0,currentMonth:T.start})}),[T.start,e]),z=(0,i.useCallback)((()=>{T.end&&e.setState({...e.state,focus:m().xQ.EndDate,inputIsFocused:!0,currentMonth:T.end})}),[T.end,e]),K=(0,i.useCallback)((()=>{T.end&&e.setState({...e.state,focus:m().xQ.EndTime,inputIsFocused:!0,currentMonth:T.end})}),[T.end,e]),V=(0,i.useCallback)((()=>{let t;if(e.state.focus===m().xQ.StartDate)t=D();else if(e.state.focus===m().xQ.StartTime)t=E();else if(e.state.focus===m().xQ.EndDate)t=L();else{if(e.state.focus!==m().xQ.EndTime)return(0,P().HB)(e.state.focus);t=N()}t?e.setState({...e.state,error:{...e.state.error,[e.state.focus]:t}}):e.setState({...e.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},inputIsFocused:!1,error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})}),[L,N,D,E,e]),G=(0,i.useCallback)((t=>{e.setState({...e.state,inputTemporaryValue:{...e.state.inputTemporaryValue,[e.state.focus]:t.target.value||""}}),b.isAndroid&&V()}),[b.isAndroid,V,e]),[Y,$]=(0,l().K8)((()=>[s().A.isMobile?S.getSafePaddingLeftCSS(16):R().Qm,s().A.isMobile?S.getSafePaddingRightCSS(16):R().Qm]),[S]),Q=(0,k().IS)((e=>({container:{paddingTop:s().A.isMobile?16:8,paddingBottom:s().A.isMobile?16:8,paddingInlineStart:Y,paddingInlineEnd:$,display:_?"block":"flex",...s().A.isMobile&&{boxShadow:`\n                            0 1px 0 ${e.regularDividerColor}\n                        `,position:"relative",zIndex:2},background:s().A.isMobile?e.popoverBackground:void 0}})),[Y,$,_]);return(0,x.jsxs)("div",{style:Q.container,children:[(0,x.jsx)(le,{inputDateValue:w.startDate,inputTimeValue:w.startTime,rangeValue:T.start,disabled:t,dateError:j.startDate,timeError:j.startTime,isDateFocused:M===m().xQ.StartDate,isTimeFocused:M===m().xQ.StartTime,hasTime:_,hasEndDate:B,locale:n,dateFormat:a,timeFormat:u,onChange:G,onDateFocus:F,onTimeFocus:U,onBlur:V,onSubmit:V}),B?(0,x.jsx)("div",{style:{width:12,height:8}}):void 0,T.end?(0,x.jsx)(le,{inputDateValue:w.endDate,inputTimeValue:w.endTime,rangeValue:T.end,disabled:t,dateError:j.endDate,timeError:j.endTime,isDateFocused:M===m().xQ.EndDate,isTimeFocused:M===m().xQ.EndTime,hasTime:_,hasEndDate:B,locale:n,dateFormat:a,timeFormat:u,onChange:G,onDateFocus:z,onTimeFocus:K,onBlur:V,onSubmit:V}):void 0]})}function le({inputDateValue:e,inputTimeValue:t,rangeValue:n,disabled:a,dateError:l,timeError:c,isDateFocused:u,isTimeFocused:g,hasTime:m,hasEndDate:f,locale:h,dateFormat:v,timeFormat:b,onChange:S,onDateFocus:A,onTimeFocus:M,onBlur:w,onSubmit:j}){const I=(0,r().Y0)(),C=(0,p().tz)(),T=(0,P().O9)(l)||(0,P().O9)(c),_=u||g,B=(0,o().X)("ios_date_picker_input_fix"),D=(0,k().IS)((e=>({input:de(I,e,T,_,f,B),separator:{height:14,width:1,background:e.regularDividerColor,marginInlineStart:6,marginInlineEnd:12,flexShrink:0}})),[I,T,_,f,B]),R=(0,i.useCallback)((()=>U(l,C)),[l,C]),E=(0,i.useCallback)((()=>U(c,C)),[c,C]),L=(0,i.useCallback)((()=>{if(s().A.isMobile){const t=(0,ie().pN)(e)?n.toFormat(d().tr):e;return(0,x.jsx)(oe().A,{type:I.isIOS&&B?"text":"date",format:oe().C.Transparent,value:I.isIOS&&B?n.toFormat(z(v,C,h)):t,onChange:S,onFocus:A,onBlur:w,onSubmit:j,onCancel:j,disabled:a,size:1})}{const t=(0,ie().pN)(e)?n.toFormat(z(v,C,h)):e;return(0,x.jsx)(oe().A,{selectAll:!0,format:oe().C.Transparent,value:t,focusInitial:u,onChange:S,onFocus:A,onBlur:w,onSubmit:j,onCancel:j,disabled:a,size:1})}}),[v,I.isIOS,a,w,S,A,j,e,C,u,h,n,B]),O=(0,i.useCallback)((()=>{const e=I.isIOS&&B?{paddingTop:10}:void 0;if(s().A.isMobile){const i=(0,ie().pN)(t)?n.toFormat(y().GE):t;return(0,x.jsx)(oe().A,{type:"time",format:oe().C.Transparent,value:i,onChange:S,onFocus:M,onBlur:w,onSubmit:j,onCancel:j,size:1,disabled:a,style:e})}{const i=(0,ie().pN)(t)?n.toFormat(K(b,!1)):t;return(0,x.jsx)(oe().A,{format:oe().C.Transparent,value:i,focusInitial:g,onChange:S,onFocus:M,onBlur:w,onSubmit:j,onCancel:j,size:1,disabled:a,style:e})}}),[I.isIOS,B,a,w,S,j,M,t,g,n,b]);return(0,x.jsxs)("div",{style:D.input,children:[(0,x.jsx)(se().A,{renderTooltip:R,originGap:ae,forceVisibleState:(0,P().O9)(l),placement:"left",render:L}),m?(0,x.jsx)("div",{style:D.separator}):void 0,m?(0,x.jsx)(se().A,{renderTooltip:E,originGap:ae,forceVisibleState:(0,P().O9)(c),placement:"right",render:O}):void 0]})}function de(e,t,n,i,o,a){return{display:"flex",alignItems:"center",borderRadius:6,height:28,lineHeight:1.2,paddingInlineStart:8,paddingInlineEnd:8,flexBasis:"50%",flexGrow:1,fontSize:s().A.isMobile?16:14,...e.isIOS&&a&&{verticalAlign:"middle"},...n?{background:T().IF.redWithAlpha(.15),boxShadow:`inset 0 0 0 2px ${T().Tj.red}`}:i&&o?{background:T().IF.blueWithAlpha(.15),boxShadow:`inset 0 0 0 2px ${T().Tj.blue}`}:{background:t.inputBackground,boxShadow:t.inputBoxShadow}}}var ce=()=>n(656704),ue=()=>n(869190),pe=()=>n(496603),ge=()=>n(314529);function me({dateValue:e,onChangeValue:t,defaultReminder:n}){const a=(0,r().v3)(),l=s().A.isMobile,d=(0,p().tz)(),u=(0,o().X)("enable_no_reminder_setting"),m=(0,i.useCallback)((n=>{y().Mb(n)?u?null==t||t({...e,reminder:n}):null==t||t({...e,reminder:void 0}):y().fc(n)?null==t||t({...e,reminder:{...n,defaultTimeZone:(0,c().P)()}}):"datetime"!==e.type&&"datetimerange"!==e.type||null==t||t({...e,reminder:n}),function(e,t){(0,ge().DO_NOT_USE_trackLegacy)(e,"set_reminder",{date:t.date,reminder:t.reminder})}(a,{date:e,reminder:n})}),[e,a,t,u]),f=(0,i.useCallback)((t=>(0,x.jsx)(X()._,{...t,title:(0,x.jsx)(p().sA,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.menuItem.remind.label"}),focused:!1,showExtensionArrow:l,chevronType:"right",right:(0,ce().y)({reminder:void 0===e.reminder?n:e.reminder,intl:d,formatTime:ue().fU})})),[e.reminder,l,d,n]),S=(0,i.useCallback)((t=>{let i;i=l?{menuType:g().gu.Modal,title:(0,x.jsx)(p().sA,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.mobileRemindModal.title"})}:{menuType:g().gu.Popup,width:250};const o=("date"===e.type||"daterange"===e.type?y().vK:y().SA).map((i=>{const o=(0,ce().y)({reminder:i,shouldShowTime:!0,intl:d,formatTime:ue().fU});return{key:o,action:()=>{m(i),t.close()},render:t=>{let s;return s=void 0===e.reminder?void 0===n?y().Mb(i):pe().n4(i,n):y().Mb(e.reminder)?y().Mb(i):pe().n4(i,e.reminder),(0,x.jsx)(b().A,{...t,title:o,isChecked:s})}}}));return(0,x.jsx)(h().A,{...i,children:(0,x.jsx)(ee().Ay,{type:ee().Oh.Vertical,sections:[{key:"reminder section",render:e=>(0,x.jsx)(v().A,{...e}),items:o}],initialFocus:void 0})})}),[e.type,e.reminder,l,d,m,n]);return(0,x.jsx)(J().A,{popupType:l?J().z.BottomSheet:J().z.Popup,bottomSheetInitialState:"half",placementToOrigin:"right",renderOrigin:f,render:S})}var fe=()=>n(232930),he=()=>n(962036),ve=()=>n(64901);function ye(){return(0,r().Y0)().isMobile?(0,x.jsx)(ve().A,{href:(0,fe().x)("guides.reminders"),analyticsFrom:"date_selector"}):(0,x.jsx)(he().g,{title:(0,x.jsx)(p().sA,{defaultMessage:"Learn about reminders",id:"LuxonDatePropertyMenu.learnMore.helpButton.label"}),href:(0,fe().x)("guides.reminders"),analyticsFrom:"date_selector"})}function be({dateValue:e,timeFormat:t,onChangeTimeFormat:n}){const{isMobile:o}=(0,r().Y0)(),s=(0,p().tz)(),a="date"===e.type||"daterange"===e.type,l=K(t,!0),d=function(e){const t=K(e,!0),n=V();for(const i in n)if(n[i]===t)return i;return"12h"}(t),c=V(),u=(0,i.useCallback)((e=>{const t=c[e];null==n||n(t)}),[n,c]),m=(0,i.useCallback)((e=>(0,x.jsx)(X()._,{...e,focused:!1,title:(0,x.jsx)(p().sA,{defaultMessage:"Time format",id:"LuxonDatePropertyMenu.menuItem.timeFormat.label"}),disabled:a,showExtensionArrow:o,chevronType:"right",right:!a&&(l?s.formatMessage(y().px[d]):(0,x.jsx)(p().sA,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.timeFormatMenu.emptyButton.label"}))})),[s,a,o,d,l]);if(a)return null;return(0,x.jsx)(J().A,{popupType:o?J().z.BottomSheet:J().z.Popup,bottomSheetInitialState:"half",placementToOrigin:"right",renderOrigin:m,render:e=>{const t=y().ZD.map((t=>({key:t,action:()=>{u(t),e.close()},render:e=>(0,x.jsx)(b().A,{...e,title:s.formatMessage(y().px[t]),isChecked:t===d})})));let n={menuType:g().gu.Popup};return o&&(n={menuType:g().gu.Modal,title:(0,x.jsx)(p().sA,{defaultMessage:"Time format",id:"LuxonDatePropertyMenu.mobileTimeFormatModal.title"})}),(0,x.jsx)(h().A,{...n,children:(0,x.jsx)(ee().Ay,{type:ee().Oh.Vertical,initialFocus:void 0,sections:[{key:"time format section",render:e=>(0,x.jsx)(v().A,{...e}),items:t}]})})}})}var Se=()=>n(304422);function xe(e){const{dateValue:t,onChangeValue:n}=e,{isMobile:o}=(0,r().Y0)(),s="date"===t.type||"daterange"===t.type,a="datetime"===t.type||"datetimerange"===t.type?t.time_zone:(0,c().P)(),l=(0,i.useCallback)((e=>{if("datetime"===t.type||"datetimerange"===t.type){const i={...t,time_zone:e};null==n||n(i)}}),[t,n]);return s?null:(0,x.jsx)(Se().G,{enableRecents:!0,placementToOrigin:"right",currentValue:a,onSelect:l,renderOrigin:e=>(0,x.jsx)(X()._,{...e,title:(0,x.jsx)(p().sA,{defaultMessage:"Timezone",id:"datePropertyMenuFormatAndTimezone.timezone.label"}),focused:!1,right:!s&&d().GF(a),showExtensionArrow:o,chevronType:"right"})})}var Ae=()=>n(173979),Me=()=>n(877750);function we(e){const{onChangeValue:t}=e,n=(0,p().tz)();return(0,x.jsx)(v().A,{title:(0,x.jsx)(p().sA,{defaultMessage:"Shortcuts",id:"DatePropertyMenu.menuItem.shortcuts.label"}),children:["now","today"].map((e=>(0,x.jsx)(b().A,{title:(0,x.jsx)(Me().W,{templateVariableType:e}),caption:(0,Ae().EC)(e,n),inline:!0,onClick:()=>{null==t||t(e)},focused:!1},`relative-date-shortcut-${e}`)))})}const je=i.memo((function(e){const t=(0,l().uB)(void 0,m().Ay),{inputIsFocused:i}=(0,l().O$)(t);return(0,n(691298).A)({shouldPreserveTextSelection:!0,shouldPreserveBlockSelection:!0,shouldRestoreSelection:!0}),(0,x.jsx)(f().A,{debugName:"DatePropertyMenu",capture:i,allowEsc:!0,children:(0,x.jsx)(f().A,{debugName:"DatePropertyMenu",allowEsc:!0,capture:!0,allowUndo:!0,children:(0,x.jsx)(ke,{store:t,...e})})})}));function ke(e){const{store:t,value:m,header:f,isTemplatePage:y,shouldShowReminder:b,shouldShowControls:S=!0,canConfigureCollection:M,disabled:w,surface:j,dateFormat:k,timeFormat:I,defaultReminder:C,firstDayOfWeek:T,formQuestionStore:_,onChangeValue:P,onChangeDateFormat:B,onChangeTimeFormat:D}=e,R=s().A.isMobile,E=(0,i.useMemo)((()=>d().Ec((0,c().P)())),[]),L=(0,l().K8)((()=>G(m,j,E,_)),[m,j,E,_]),O=(0,l().K8)((()=>t.state.inputIsFocused),[t]),N=(0,i.useMemo)((()=>R?{menuType:g().gu.Modal,title:(0,x.jsx)(p().sA,{defaultMessage:"Date",id:"LuxonDatePropertyMenu.mobileDate.title"}),left:b?(0,x.jsx)(ye,{}):void 0,header:(0,x.jsx)(v().A,{children:(0,x.jsx)(re,{store:t,disabled:w,locale:a().locale,surface:j,dateFormat:k,timeFormat:I,dateValue:L,formQuestionStore:_,onChangeValue:P})}),includeFixedHeaderSpacing:!0,scrollerStyle:{paddingBottom:n(838364).Hc}}:{menuType:g().gu.Popup,maxHeight:"none",width:"min-content",header:f}),[k,L,R,w,j,_,f,P,b,t,I]),F=!u().V.includes(a().locale),U=(0,r().Y0)(),z=(0,o().X)("ios_date_picker_input_fix"),K=O&&!(U.isIOS&&z);return(0,x.jsxs)(h().A,{...N,children:[(0,x.jsx)(n(594739).A,{show:K}),y?(0,x.jsx)(we,{onChangeValue:P}):void 0,(0,x.jsxs)(v().A,{topBorder:y,children:[R?void 0:(0,x.jsx)(re,{store:t,disabled:w,locale:a().locale,surface:j,dateFormat:k,timeFormat:I,dateValue:L,formQuestionStore:_,onChangeValue:P}),(0,x.jsx)(Q,{store:t,dateValue:L,firstDayOfWeek:T,disabled:w,onChangeValue:P})]}),w?void 0:(0,x.jsxs)(x.Fragment,{children:[b||S?(0,x.jsxs)(v().A,{topBorder:!0,children:[S?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(ne,{dateValue:L,onChangeValue:P}),M?(0,x.jsx)(te,{dateFormat:k,onChangeDateFormat:B}):void 0,(0,x.jsx)(A,{dateValue:L,onChangeValue:P}),M&&F?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(be,{dateValue:L,timeFormat:I,onChangeTimeFormat:D}),(0,x.jsx)(xe,{dateValue:L,onChangeValue:P})]}):void 0]}):void 0,b?(0,x.jsx)(me,{dateValue:L,onChangeValue:P,defaultReminder:C}):void 0]}):void 0,(0,x.jsx)(v().A,{topBorder:!0,children:(0,x.jsx)(Z,{onChangeValue:P})}),!R&&b?(0,x.jsx)(v().A,{topBorder:!0,children:(0,x.jsx)(ye,{})}):void 0]})]})}},526669:(e,t,n)=>{n.d(t,{Ox:()=>k,ei:()=>M,gO:()=>A,jw:()=>I,s:()=>x});n(296540);var i=()=>n(564884),o=()=>n(484714),s=()=>n(401497),a=()=>n(160432),r=()=>n(493552),l=()=>n(148307),d=()=>n(8741),c=()=>n(90907),u=()=>n(835607),p=()=>n(737693),g=()=>n(340498),m=()=>n(734459),f=()=>n(713996),h=()=>n(69708),v=()=>n(534177),y=()=>n(577142),b=()=>n(146869),S=n(474848);function x({organizationOnboardingInfo:e}){const t=(0,o().v3)(),n=k(),i=(0,h().tz)();if(!e||"ineligible"===e.onboardingStatus)return null;const{buttonLabel:s,onClick:c}=A({environment:t,organizationOnboardingInfo:e});return(0,S.jsxs)("div",{style:n.bannerContainer,children:[(0,S.jsxs)("div",{style:n.title,children:[(0,S.jsx)("img",{src:l().A.images.onboarding.planTypeForWorkSplitIntentDarkmodePng,style:{height:77,width:77},alt:"Organization onboarding icon"}),(0,S.jsx)(r().D,{styleKey:"Title-lg/Semibold",children:i.formatMessage(I.title)}),(0,S.jsx)(r().D,{styleKey:"Body/Regular",colorVariant:"secondary",children:i.formatMessage(I.byline)})]}),(0,S.jsx)(M,{}),(0,S.jsx)(a().A,{colorPalette:"blue",size:"lg",style:n.button,onClick:c,iconTrailing:{icon:d().arrowDiagonalUpRightSmallIcon,size:"sm"},children:s})]})}function A({environment:e,organizationOnboardingInfo:t}){switch(t.onboardingStatus){case"not_started":return{buttonLabel:(0,S.jsx)(h().sA,{id:"workspaceSettingsModal.organizationsBanner.startSetUpButton",defaultMessage:"Set up organization"}),onClick:()=>{(0,i().u)({environment:e,event:{eventName:"org_console_onboarding_navigate",eventProperties:{spaceId:t.spaceId,route:f()._P.name,from:"settings-modal-banner"}}}),(0,y().navigate)({environment:e,openInNew:"tab",makeTabActive:!0,url:(0,m().re)({organizationId:m().Zf,tabRoute:f()._P,queryParams:{[b().g]:t.spaceId}})})}};case"domain_verified":return{buttonLabel:(0,S.jsx)(h().sA,{id:"workspaceSettingsModal.organizationsBanner.finishSetUpButton",defaultMessage:"Finish set up"}),onClick:()=>{(0,i().u)({environment:e,event:{eventName:"org_console_onboarding_navigate",eventProperties:{organizationId:t.organizationId,route:f()._P.name,from:"settings-modal-banner"}}}),(0,y().navigate)({environment:e,openInNew:"tab",makeTabActive:!0,url:(0,m().re)({organizationId:t.organizationId,tabRoute:f()._P})})}};case"completed":return{buttonLabel:(0,S.jsx)(h().sA,{id:"workspaceSettingsModal.organizationsBanner.orgSettingsButton",defaultMessage:"Go to organization console"}),onClick:()=>{(0,y().navigate)({environment:e,openInNew:"tab",makeTabActive:!0,url:(0,m().re)({organizationId:t.organizationId,tabRoute:f().Vo})})}};default:(0,v().HB)(t)}}function M(){const e=k();return(0,S.jsxs)("div",{style:e.features,children:[(0,S.jsx)(j,{icon:c().h,description:(0,S.jsx)(h().sA,{id:"workspaceSettingsModal.organizationsBanner.owner.item.organizationOwnerRole",defaultMessage:"<blue>A new organization owner role</blue> manages all workspace settings and owner permissions.",values:{blue:(...e)=>(0,S.jsx)(w,{chunks:e})}})}),(0,S.jsx)(j,{icon:p().V,description:(0,S.jsx)(h().sA,{id:"workspaceSettingsModal.organizationsBanner.owner.item.organizationWideVisibility",defaultMessage:"<blue>Organization-wide visibility</blue> of people, sharing and security settings, and audit logs all in one place.",values:{blue:(...e)=>(0,S.jsx)(w,{chunks:e})}})}),(0,S.jsx)(j,{icon:u().F,description:(0,S.jsx)(h().sA,{id:"workspaceSettingsModal.organizationsBanner.owner.item.simplifiedSettingsManagement",defaultMessage:"<blue>Simplified settings management</blue> across organization, workspace, and teamspace levels.",values:{blue:(...e)=>(0,S.jsx)(w,{chunks:e})}})})]})}function w(e){return(0,S.jsx)(r().D,{styleKey:"Body/Medium",colorPalette:"blue",colorVariant:"accentPrimary",as:"span",children:e.chunks})}function j(e){const t=(0,s().IS)((e=>({container:{display:"flex",alignItems:"flex-start",justifyContent:"center",flexDirection:"row",gap:8},icon:{fill:e.blue.icon.accentPrimary,height:g().Ev.default,width:g().Ev.default}})),[]);return(0,S.jsxs)("div",{style:t.container,children:[e.icon(t.icon),(0,S.jsx)(r().D,{styleKey:"Body/Regular",colorVariant:"secondary",children:e.description})]})}function k(){return(0,s().IS)((e=>({bannerContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start",gap:20,padding:24,borderRadius:12,marginBlock:12,background:"dark"===e.mode?e.cardBackground:"#F0F6FD"},title:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start",gap:6,width:"100%"},features:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center",gap:10,width:"100%"},icon:{height:16,width:16,fill:e.icon.secondary},button:{display:"flex",alignItems:"center",justifyContent:"center",gap:4}})),[])}const I=(0,h().YK)({title:{id:"organization.onboarding.modal.title",defaultMessage:"Get more from your Enterprise plan"},titleLimited:{id:"organization.onboarding.modal.title.limited",defaultMessage:"Get more from your Enterprise Limited plan"},byline:{id:"organization.onboarding.modal.byline",defaultMessage:"Get a birdâ€™s-eye view of members, guests, and security settings across all your workspaces."}})},532731:(e,t,n)=>{n.d(t,{F1:()=>h,KQ:()=>d,Wt:()=>p,dB:()=>f,vP:()=>u,wL:()=>c,zD:()=>g});n(944114),n(898992),n(581454),n(908872);var i=()=>n(69708),o=()=>n(33301),s=()=>n(231297),a=()=>n(972435),r=()=>n(806638),l=()=>n(404141);const d=(0,i().YK)({emptyWithIcon:{defaultMessage:"Empty page with icon",id:"templatePickerHelpers.basicTemplateItems.emptyWithIcon"},empty:{defaultMessage:"Empty page",id:"templatePickerHelpers.basicTemplateItems.empty"},templates:{defaultMessage:"Templates",id:"templatePickerHelpers.basicTemplateItems.templates"},import:{defaultMessage:"Import",id:"templatePickerHelpers.basicTemplateItems.import"}}),c={name:a().A.formatMessage(d.empty),iconFn:n(177148).Y,type:"empty_page",shouldShow:()=>!0,onClick:(e,t)=>{s().createAndCommit({userAction:"templatePickerHelpers.emptyTemplateItems",environment:e,canUndo:!0,perform:n=>{o().n({environment:e,store:t,transaction:n})}})}},u={name:a().A.formatMessage(d.templates),type:"templates",iconFn:e=>(0,n(826693).notionTemplateIcon)(e),shouldShow:()=>!0,onClick:e=>{(0,r().P)({environment:e})}},p={name:a().A.formatMessage(d.templates),type:"templates",iconFn:e=>(0,n(235773).notionTemplateTintableIcon)(e),shouldShow:()=>!0,onClick:e=>{(0,r().P)({environment:e})}},g={name:a().A.formatMessage(d.import),type:"import",iconFn:n(820579).arrowLineDownIcon,shouldShow:()=>!0,onClick:(e,t)=>{const i=n(206267).JW();n(522094).A.setState({flowId:i}),n(559926).kY(e,{from:"new_page",flowId:i}),l().A.setState({...l().A.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0})}},m=(0,i().YK)({pageWithIcon:{defaultMessage:"Page with icon",id:"templatePickerHelpers.mobileBasicTemplateItems.pageWithIcon"},emptyPage:{defaultMessage:"Empty page",id:"templatePickerHelpers.mobileBasicTemplateItems.emptyPage"}}),f=[{name:a().A.formatMessage(m.pageWithIcon),type:"page_with_icon",shouldShow:()=>!0,onClick:(e,t)=>{s().createAndCommit({userAction:"templatePickerHelpers.mobileBasicTemplateItems",environment:e,canUndo:!0,perform:n=>{o().T({environment:e,store:t,transaction:n})}})}},{name:a().A.formatMessage(m.emptyPage),type:"empty_page",shouldShow:()=>!0,onClick:(e,t)=>{s().createAndCommit({userAction:"templatePickerHelpers.mobileBasicTemplateItems",environment:e,canUndo:!0,perform:n=>{o().n({environment:e,store:t,transaction:n})}})}}];function h(e,t){const n=new Map(e.map((e=>[e.type,e])));return t.reduce(((e,t)=>(n.has(t)&&e.push(n.get(t)),e)),[])}},536612:(e,t,n)=>{n.d(t,{A:()=>o});class i extends(()=>n(959180))().A{}const o=new i},538075:(e,t,n)=>{n.d(t,{H8:()=>f,I7:()=>v,aE:()=>m});n(296540);var i=()=>n(66689),o=()=>n(69708),s=()=>n(534177),a=()=>n(10521),r=()=>n(457190),l=()=>n(223393),d=()=>n(575143),c=()=>n(765957),u=()=>n(518773),p=n(474848);const g=(0,o().YK)({repliesAndMentions:{id:"pageNotificationSettings.repliesAndMentions.displayName",defaultMessage:"Mentions"},comments:{id:"pageNotificationSettings.comments.displayName",defaultMessage:"Comments"},allUpdates:{id:"pageNotificationSettings.allUpdates.displayName",defaultMessage:"All"},importantUpdates:{id:"pageNotificationSettings.importantUpdates.displayName",defaultMessage:"Important"}});function m(e){switch(e){case"Mentions":return g.repliesAndMentions;case"Comments":return g.comments;case"All":return g.allUpdates;case"Important":return g.importantUpdates;default:return}}function f(e){const{followSettingsKey:t,environment:n,blockStore:s,from:a}=e,r=h({key:"none",selectedKey:t,title:(0,p.jsx)(o().sA,{id:"GetNotifiedDropdown.repliesAndMentions.label",defaultMessage:"Replies and @mentions"}),displayName:g.repliesAndMentions,environment:n,blockStore:s,from:a}),l=h({key:"comments",selectedKey:t,title:(0,p.jsx)(o().sA,{id:"GetNotifiedDropdown.allComments.label",defaultMessage:"All comments"}),displayName:g.comments,environment:n,blockStore:s,from:a}),d=h({key:"all",selectedKey:t,title:(0,p.jsx)(o().sA,{id:"GetNotifiedDropdown.allUpdates.label",defaultMessage:"All updates"}),caption:(0,p.jsx)(o().sA,{id:"GetNotifiedDropdown.simpleAllUpdates.caption",defaultMessage:"All comments and property changes"}),displayName:g.allUpdates,environment:n,blockStore:s,from:a}),c=s.getAssociatedCollectionStore();if(!c)return[l,r];const u=c.getDatabaseType();if(u===i().dC){return[d,h({key:"important",selectedKey:t,title:(0,p.jsx)(o().sA,{id:"GetNotifiedDropdown.importantUpdatesTasks.label",defaultMessage:"Important updates"}),caption:(0,p.jsx)(o().sA,{id:"GetNotifiedDropdown.importantUpdatesTasks.caption",defaultMessage:"All comments and changes to Status, Assignee, or Due Date"}),displayName:g.importantUpdates,environment:n,blockStore:s,from:a}),r]}if(u===i().Tw){return[d,h({key:"important",selectedKey:t,title:(0,p.jsx)(o().sA,{id:"GetNotifiedDropdown.importantUpdatesProjects.label",defaultMessage:"Important updates"}),caption:(0,p.jsx)(o().sA,{id:"GetNotifiedDropdown.importantUpdatesProjects.caption",defaultMessage:"All comments and changes to Status or Date"}),displayName:g.importantUpdates,environment:n,blockStore:s,from:a}),r]}return[d,h({key:"comments",selectedKey:t,title:(0,p.jsx)(o().sA,{id:"GetNotifiedDropdown.onlyCommentsAllComments.label",defaultMessage:"All comments"}),displayName:g.comments,environment:n,blockStore:s,from:a}),r]}function h(e){const{key:t,title:n,caption:i,selectedKey:o,environment:s,blockStore:g,from:m,displayName:f}=e,h=v({key:t,userSelectedKey:o}),b={icon:{width:14,height:14}};return{action:(0,a().Ls)({key:t,displayName:f,analyticsName:t,validators:[],closeParentMenu:!0,action:()=>{const{currentUserRootStore:e}=c().default.state;if(e){const{following:n,followSettings:i}=(0,u().A)(t),a=e.id,d=g.id,c=g.getSpaceId();r().v({environment:s,following:n,followSettings:i,navigableBlockId:d,spaceId:c,userId:a,from:m,key:t,selectedKey:o}),"inbox"!==m&&"more_menu"!==m||(0,l().r)({item:{label:y(t)},undoFunc:()=>{const{following:e,followSettings:n}=(0,u().A)(o);r().v({environment:s,following:e,followSettings:n,navigableBlockId:d,spaceId:c,userId:a,from:m,key:t,selectedKey:o})}})}},render:e=>(0,p.jsx)(d().A,{...e,title:n,caption:i,shouldWrapCaption:!0,isChecked:h,right:!h&&(0,p.jsx)("div",{style:b.icon}),rightStyle:b.right})}),title:n,isSelectedOption:h}}function v(e){const{key:t,userSelectedKey:n}=e;return"important"===n||"comments"===n?"important"===t||"comments"===t:t===n}function y(e){switch(e){case"none":return(0,p.jsx)(o().sA,{id:"GetNotifiedDropdown.subscribedRepliesAndMentionsSuccess.snackbarMessage",defaultMessage:"Subscribed to replies and @mentions"});case"comments":return(0,p.jsx)(o().sA,{id:"GetNotifiedDropdown.subscribedAllCommentsSuccess.snackbarMessage",defaultMessage:"Subscribed to all comments"});case"important":return(0,p.jsx)(o().sA,{id:"GetNotifiedDropdown.subscribedImportantUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to important updates"});case"all":return(0,p.jsx)(o().sA,{id:"GetNotifiedDropdown.subscribedAllUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to all updates"});default:(0,s().HB)(e)}}},541372:(e,t,n)=>{n.d(t,{Ce:()=>N,GV:()=>O,T_:()=>_,Tw:()=>T,VN:()=>P,Xw:()=>L,ei:()=>D,gi:()=>I,h8:()=>R});n(16280),n(18107),n(967357),n(898992),n(823215),n(581454),n(737550);var i=()=>n(564884),o=()=>n(726637),s=()=>n(584262),a=()=>n(700500),r=()=>n(921940),l=()=>n(696706),d=()=>n(179034),c=()=>n(201980),u=()=>n(496603),p=()=>n(534177),g=()=>n(18387),m=()=>n(989616),f=()=>n(695625),h=()=>n(430483),v=()=>n(84349),y=()=>n(77246),b=()=>n(148832),S=()=>n(292167),x=()=>n(44729),A=()=>n(384944),M=()=>n(391214),w=()=>n(778417),j=()=>n(319975),k=()=>n(231297);function I(e){const{environment:t,blocks:n,copiedStores:o,pageSource:s}=e,a=u().HV(n);if(!a)return;const r=f().T.getRectFromStore(a);r&&(v().A.setState({open:!0,type:"blocks",blocks:n,rect:r,copiedStores:o,pageSource:s}),(0,i().u)({environment:t,event:{eventName:"block_paste_menu_opened",eventProperties:{type:"blocks"}}}))}const C=250;function T(e){if(!h().zD.areAiActionsOnPasteEnabled())return!1;const{blocks:t,environment:n}=e;if(n.device.isMobileNative)return!1;if(!t.some((e=>e.isAiFollowupEligibleBlock())))return!1;if((0,m().R)(t,!0).length<C)return!1;const o=t.at(0);if(!o)return!1;const s=f().T.getRectFromStore(o);return!!s&&(v().A.setState({open:!0,type:"ai_actions",blocks:t,rect:s}),(0,i().u)({environment:n,event:{eventName:"block_paste_menu_opened",eventProperties:{type:"ai_actions"}}}),!0)}function _(e){const{environment:t,blocks:n,copiedLinks:o,rootStore:s}=e;if(n.length!==o.length)return!1;if(!n.every(B))return!1;if(o.some((e=>e.blockId===s.id)))return!1;const a=u().HV(n);if(!a)return!1;const r=f().T.getRectFromStore(a);return!!r&&(v().A.setState({open:!0,type:"links",blocks:n,rect:r,copiedLinks:o}),(0,i().u)({environment:t,event:{eventName:"block_paste_menu_opened",eventProperties:{type:"links"}}}),!0)}function P(e){v().A.state.open&&(0,i().u)({environment:e,event:{eventName:"block_paste_menu_closed",eventProperties:{type:v().A.state.type}}}),v().A.setState({open:!1})}function B(e){return!(e.isType(a().xd.copyIndicator)||e.isTransclusionType()||e.isInsideCollection())}function D(e){const{blocks:t,pageSource:n,wasContiguousSelection:i,action:o,rootStore:s,copiedStores:r}=e,d=y().Uv.getMode(t[0]);return"copy"===o&&i&&!(0,l().Z2)(n,s.pointer)&&(R(e)||O({currentSpaceId:s.getSpaceId(),...e}))&&t.every(B)&&!r.every((e=>e.getType()===a().xd.externalObjectInstance))&&"suggest"!==d}function R(e){const{blocks:t}=e;return 1===t.length}function E(e){const{transaction:t,blockUrl:n,spaceId:i,environment:o}=e,s=A().Wv({environment:o,type:a().xd.text,inMemoryRecordCache:o.defaultRecordCache.inMemoryRecordCache,transaction:t,spaceId:i}),r=(0,c().xV3)(n),l=[(0,c().Ey_)(r,[(0,c().Sez)(r)],{skipSanitization:!0})];return j().R9({environment:o,store:s.getBlockTitleStore(),value:l,transaction:t}),s}async function L(e){const{environment:t,blocks:n,source:i}=e,a=u().$1(n);if(!a)return;const l=a.getParentBlockStore();if(!l)return;const c=a.getContentStore();let g;await k().createAndCommitAsync({environment:t,userAction:"blockPasteMenuActions.acceptLinkToPage",waitForServerCommit:!0,perform:async e=>{if("blocks"===i.type){const{copiedStores:n,pageSource:u}=i,p=a,m=n[0];if(!p||!m)return;const f=b().B.createChildStore(c,{table:d().ev,id:m.id});if(f.isNavigableBlock())await f.load(),g=[S().s({environment:t,parentBlockStore:l,targetStore:f,transaction:e})];else{const n=(0,r().A)({pageId:u.id,scrollToBlockId:f.id,baseUrl:o().A.domainBaseUrl,pageVisitSource:s().y8.LinkInPage});g=[E({blockUrl:n,spaceId:a.getSpaceId(),environment:t,transaction:e})]}}else if("links"===i.type){const{copiedLinks:p}=i;if(p.length!==n.length)return;g=(0,u().oE)(await Promise.all(p.map((async n=>{const i=n.scrollToBlockId||n.peekViewBlockId||n.blockId;if(i){const u=b().B.createChildStore(c,{table:d().ev,id:i});if(await u.load(),u.isNavigableBlock())return S().s({environment:t,parentBlockStore:l,targetStore:u,transaction:e});{const i=n.peekViewBlockId||n.blockId;if(i){const n=b().B.createChildStore(c,{table:d().ev,id:i});await n.load();return E({blockUrl:(0,r().A)({pageId:i,pageModel:n.getModel(),scrollToBlockId:u.id,baseUrl:o().A.domainBaseUrl,pageVisitSource:s().y8.LinkInPage}),spaceId:a.getSpaceId(),environment:t,transaction:e})}}}}))))}else(0,p().HB)(i);const m=M().LE({environment:t,blocksToInsert:g,target:n,replaceEmptyTextBlock:!0,transaction:e});M().ZL({environment:t,blocks:n,transaction:e}),w().td({environment:t,stores:m}),P(t)}})}function O(e){const{currentSpaceId:t,blocks:n,copiedStores:i}=e;return n.length>0&&!i.some((e=>e.isInsideCollection()))&&i.every((e=>e.canEdit()))&&i.every((e=>e.getSpaceId()===t))}async function N(e){const{environment:t,blocks:n,copiedBlockIds:i,removeBlocks:o}=e,s=await Promise.all(i.map((async e=>{const t=b().B.createChildStore(n[0],{table:d().ev,id:e});await t.load();const i=t.getParentBlockStore();if(!i)throw new Error("Block has no parent.");await i.load();const o=i.getContentStore();return{store:b().B.createChildStore(o,{table:d().ev,id:e}),parentStore:i,parentContentStore:o}}))),r=s[0];if(!r)return;const l=(0,g().Z)();if(!l)return;const{serverCommitResult:c}=k().createAndCommit({userAction:"blockPasteMenuActions.acceptCreateTransclusion",environment:t,canUndo:!0,perform:e=>{let i;if(r.store.getType()===a().xd.transclusionContainer)i=r.store;else if(r.store.getType()===a().xd.transclusionReference){const e=r.store.getTransclusionReferenceTargetStore();if(!e)throw new Error("Could not find transclusion reference target");i=e}else if(r.parentStore.getType()===a().xd.transclusionContainer)i=r.parentStore;else{i=A().Wv({environment:t,type:a().xd.transclusionContainer,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:e,spaceId:r.store.pointer.spaceId});const n=i.getContentStore();x().Br({parentStore:r.parentContentStore,oldChildStore:r.store,newChildStore:i,transaction:e});for(const{store:t}of s)x().NI({parentStore:n,childStore:t,transaction:e})}const d=A().Wv({environment:t,type:a().xd.transclusionReference,format:{transclusion_reference_pointer:i.pointer},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:e,spaceId:0!==n.length?n[n.length-1].pointer.spaceId:l.pointer.spaceId}),c=M().LE({environment:t,blocksToInsert:[d],target:n,transaction:e,replaceEmptyTextBlock:!0});w().td({environment:t,stores:c}),o&&M().ZL({environment:t,blocks:n,transaction:e}),P(t)}});await c}},542371:(e,t,n)=>{n.d(t,{A:()=>i});class i extends(()=>n(757695))().Store{getInitialState(){}}},562866:(e,t,n)=>{n.d(t,{$c:()=>l,Xd:()=>r,aI:()=>a,cx:()=>s,uf:()=>o});var i=()=>n(645873);const o={RequestMembersModal:new(i().O2)("RequestMembersModal",(()=>Promise.all([n.e(75134),n.e(9773),n.e(36556),n.e(40537),n.e(55373),n.e(36192),n.e(71562),n.e(96346),n.e(44711),n.e(53321),n.e(90825),n.e(16471),n.e(37353),n.e(29151),n.e(87248),n.e(48762),n.e(87249),n.e(71621),n.e(88924),n.e(92845),n.e(56369),n.e(5834),n.e(48486),n.e(2411),n.e(89296),n.e(46414),n.e(9294),n.e(11676),n.e(91256),n.e(40563),n.e(67494),n.e(44584),n.e(53141),n.e(4422),n.e(4330),n.e(55162),n.e(71003),n.e(55753),n.e(28866),n.e(22001),n.e(71386),n.e(4351),n.e(6331),n.e(69144),n.e(42660),n.e(55997),n.e(40828),n.e(12341),n.e(96402),n.e(84166),n.e(70359),n.e(29595),n.e(16448),n.e(10442),n.e(16434),n.e(45769),n.e(46080),n.e(75902),n.e(99809),n.e(58636),n.e(78405),n.e(33675),n.e(42056),n.e(34442),n.e(77282)]).then(n.bind(n,123350)))),GoogleImportsInviteWithModal:new(i().O2)("GoogleImportsInviteWithModal",(()=>Promise.all([n.e(55162),n.e(42056),n.e(51226)]).then(n.bind(n,720193)))),MicrosoftImportsInviteWithModal:new(i().O2)("MicrosoftImportsInviteWithModal",(()=>Promise.all([n.e(55162),n.e(42056),n.e(64981)]).then(n.bind(n,72468)))),InviteDropdownMenuItemLabel:new(i().O2)("InviteDropdownMenuItemLabel",(()=>n.e(25171).then(n.bind(n,726799)))),personPropertyInviteActions:new(i().O2)("personPropertyInviteActions",(()=>Promise.all([n.e(55162),n.e(42056),n.e(57613)]).then(n.bind(n,980270))))},s=(0,i()._h)(o.RequestMembersModal,(e=>e.RequestMembersModal)),a=(0,i()._h)(o.GoogleImportsInviteWithModal,(e=>e.GoogleImportsInviteWithModal)),r=(0,i()._h)(o.MicrosoftImportsInviteWithModal,(e=>e.MicrosoftImportsInviteWithModal)),l=(0,i()._h)(o.InviteDropdownMenuItemLabel,(e=>e.InviteDropdownMenuItemLabel))},600144:(e,t,n)=>{n.r(t),n.d(t,{PublicTopbarMoreMenu:()=>I});n(898992),n(823215),n(354520),n(581454),n(908872);var i=n(296540),o=()=>n(312788),s=()=>n(484714),a=()=>n(56366),r=()=>n(584262),l=()=>n(179034),d=()=>n(709906),c=()=>n(741496),u=()=>n(544198),p=()=>n(492414),g=()=>n(722872),m=()=>n(494043),f=()=>n(311337),h=()=>n(578872),v=()=>n(765957),y=()=>n(411671),b=()=>n(148832),S=()=>n(575143),x=()=>n(452558),A=()=>n(404277),M=()=>n(187820),w=()=>n(16006),j=()=>n(89924),k=n(474848);function I({blockStore:e,onDismiss:t,isPublicShareLink:n}){const{navigate:I}=(0,i.useContext)(o().E),C=(0,s().v3)(),{isMobile:T}=C.device,_=(0,a().K8)((()=>y().A.getMode(C,e)),[C,e]),P=(0,a().K8)((()=>e.isFormBlock()),[e]),[B,D]=(0,i.useState)(T&&!P?"initialActions":"more"),R=(0,i.useMemo)((()=>({environment:C,blocks:[e],publicEditMode:_,analyticsFrom:"topbar_more_menu"})),[C,e,_]);let E;E=T?{menuType:g().gu.ActionSheet}:{menuType:g().gu.Popup,width:210,maxHeight:"80vh"};const L=(0,i.useCallback)((e=>{const{mainEditorCurrentBlockStore:n}=v().default.state;if(n){const t=n.getType();if(t){const{collectionId:i,ownedCollectionCount:o,linkedCollectionCount:s}=(0,u().P)(n,{skipPages:!0});(0,c().N)(C,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"public_topbar_more_menu",block_id:n.id,block_type:t,is_toggleable:(0,m().Yt)(t,n.getFormat()),collection_id:i,owned_collection_count:o,linked_collection_count:s,parent_collection_id:n.getParentCollectionIdUpToTwoLevels()})}}e.closeParentMenu&&t()}),[C,t]),O=(0,a().K8)((()=>{var t;if(!T)return;const n=e.getSpaceStore();if(!n)return;const i=h().GN(e),o=null==i||null===(t=i.getSiteStore())||void 0===t||null===(t=t.getHeader())||void 0===t?void 0:t.customItems;if(!o)return;return{key:"custom nav",render:e=>(0,k.jsx)(j().A,{...e}),actions:o.filter((e=>"block"===e.type)).map((t=>{const i=b().B.createChildStore(n,{table:l().ev,id:t.blockId}),o=i.getIcon(),s=(0,p().Ay)({store:i,preferPublicLink:!0,pageVisitSource:r().y8.SiteCustomHeader});return{key:t.blockId,analyticsName:t.blockId,displayName:t.blockId,searchName:t.blockId,render:t=>(0,k.jsx)(S().A,{...t,left:o&&(0,k.jsx)(M().B6,{icon:o,store:e,disabled:!0,isEmptyPage:i.isEmptyPage(),size:18,emojiSize:18,disableShrinking:!0}),title:(0,k.jsx)(w().A,{store:i,maxLength:30})}),action:()=>{I({environment:C,url:s})},closeParentMenu:!0}}))}}),[C,T,e,I]),N=(0,d().B2)((()=>{D("more")})),F=(0,d().pJ)((()=>{D("more")})),U=(0,a().K8)((()=>(0,f().y)(C)),[C]),z=(0,i.useMemo)((()=>U?[F]:O?[O,N]:[N]),[U,F,O,N]),K=(0,a().K8)((()=>1===z.reduce(((e,t)=>e+t.actions.filter((e=>!e.validators||e.validators.every((e=>e(R))))).length),0)),[z,R]);return"initialActions"!==B||K?(0,k.jsx)(A().A,{...E,children:(0,k.jsx)(x().A,{sections:n?d().Sg:d()._4,context:R})}):(0,k.jsx)(A().A,{...E,children:(0,k.jsx)(x().A,{sections:z,onAccept:L,context:R})})}},603533:(e,t,n)=>{function i(){return 330}n.d(t,{W:()=>i})},607810:(e,t,n)=>{n.d(t,{s:()=>a});var i=n(296540),o=()=>n(120997),s=n(474848);const a=i.memo((function({area:e,viewsMainTabId:t,children:a,className:r,style:l}){const{layoutBuilderModuleSelectionStore:d,layoutStore:c}=(0,n(937199).LH)(),u=(0,i.useCallback)((()=>{const n=d.state;if(null==n||!n.isDragging)return;const i=n.moduleId,s=c.getModuleById(i);s&&(0,o().p)(s,e)&&("page_main"===e&&c.isTabbedPageLayout()||d.setState({...n,draggingModuleFinalArea:{..."views_main_tab_modules"===e?{area:e,viewsMainTabId:t}:{area:e}}}))}),[e,d,c,t]),p=(0,i.useCallback)((()=>{const t=d.state;if(null==t||!t.isDragging)return;const n=t.moduleId,i=c.getModuleById(n);i&&(0,o().p)(i,e)&&d.setState({...t,draggingModuleFinalArea:t.draggingModuleInitialArea})}),[e,d,c]);return(0,s.jsx)("div",{onMouseEnter:u,onMouseLeave:p,className:r,style:l,children:a})}))},614367:(e,t,n)=>{n.r(t),n.d(t,{AppComponents:()=>bg});var i=n(296540),o=()=>n(377441),s=()=>n(484714),a=()=>n(257615),r=()=>n(180332),l=()=>n(543886),d=()=>n(405170),c=()=>n(430923),u=()=>n(774733),p=()=>n(645873);const g=new(p().O2)("desktop",(async()=>{const[{Notification:e},{default:t}]=await Promise.all([Promise.all([n.e(14388),n.e(7097)]).then(n.bind(n,15121)),Promise.all([n.e(14388),n.e(7097)]).then(n.bind(n,472089))]);return{Notification:e,ElectronContextMenu:t}})),m=(0,p()._h)(g,(e=>e.ElectronContextMenu));var f=()=>n(75858),h=()=>n(251994),v=(n(898992),n(354520),()=>n(56366)),y=()=>n(30537),b=()=>n(201980),S=()=>n(98244),x=()=>n(231297),A=()=>n(404277),M=()=>n(417392),w=()=>n(722872),j=()=>n(557155),k=()=>n(333665),I=()=>n(486666),C=()=>n(797162),T=()=>n(693202),_=()=>n(97270),P=()=>n(828265),B=n(474848);function D(){const e=(0,s().Y0)(),{open:t,filter:n,emojiTextStore:o,popupOpen:a,originRect:r,alwaysShowPopup:l}=(0,v().K8)((()=>{const e=_().A.state,t=e.open;if(!t)return{open:t,popupOpen:!1};const n=function(e){if(!e.textStore)return;return k().vD(e.textStore,e.oldTextValue,!0)}(e)||"",{textStore:i,showPopupWithEmptyFilter:o,selectionRect:s}=e,a=Boolean(o);return{open:t,filter:n,emojiTextStore:i,popupOpen:n.length>0||a,originRect:s,alwaysShowPopup:a}}),[]),{textMode:d,prevChar:c,singleTextSelectionStore:u}=(0,v().K8)((()=>{var e;const t=T().default.state,{mode:n}=t;if("editing"!==n)return{mode:n};const{multiSelection:i}=t,o=b().qAZ(i.start.store.getValue());return{textMode:n,prevChar:o?o[i.start.index-1]:void 0,singleTextSelectionStore:null===(e=(0,j().H)(i))||void 0===e?void 0:e.store}}),[]),p=(0,v().K8)((()=>C().A.state.open),[]);return(0,i.useEffect)((()=>{t&&!p&&("editing"!==d||!n&&":"!==c||u!==o||void 0===n||":"===n||n.startsWith(" ")||n.includes("\n"))&&S().VN()}),[o,n,p,t,c,u,d]),(0,B.jsx)(M().Ay,{popupType:e.isMobileNative&&!e.isTablet?y().n.SlideUp:y().n.Popup,open:a,originRect:r,placementToOrigin:"bottom",alignmentToOrigin:"start",originGap:4,disableMouseCapture:!0,disableContentScroll:!0,onDismiss:E,render:()=>(0,B.jsx)(R,{open:t,filter:n||"",alwaysShowPopup:l}),keepFocus:!0})}function R({open:e,filter:t,alwaysShowPopup:n}){const o=(0,s().v3)(),a=(0,s().Y0)(),r=(0,i.useRef)(null),l=a.isMobileNative&&!a.isTablet?{menuType:w().gu.ActionSheet}:{menuType:w().gu.Popup,width:I().jv,onClickOutside:S().VN};return e?!Boolean(n)&&t.length<1?null:(0,B.jsx)(A().A,{innerRef:r,...l,children:(0,B.jsx)(P().p,{filter:t,onSubmit:e=>L(e,o),isCallout:!1,menuRef:r,isInline:!0,onUpload:{onComplete:e=>{L(e,o)}}})}):null}function E(){S().VN()}function L(e,t){x().createAndCommit({userAction:"EmojiMenu.handleSubmit",environment:t,canUndo:!0,perform:n=>{S().Ju({environment:t,emoji:e,transaction:n})}})}n(944114),n(803949),n(581454);var O=()=>n(242422),N=()=>n(726637),F=()=>n(813206),U=()=>n(584262),z=()=>n(416504),K=()=>n(921997),V=()=>n(959044),q=()=>n(69708),W=()=>n(496603),G=()=>n(763824),H=()=>n(848259),Y=()=>n(559506),$=()=>n(236357),Q=()=>n(44551),Z=()=>n(577142);function J(e){return null===Q().electronApi||void 0===Q().electronApi?void 0:Q().electronApi.setBadge(e)}var X=()=>n(909470),ee=()=>n(299545),te=()=>n(941541),ne=()=>n(21899),ie=()=>n(303742),oe=()=>n(179534),se=()=>n(524450),ae=()=>n(765957),re=()=>n(865241),le=()=>n(878710);function de(e){const{sidebarSpaceViewStore:t,sidebarSpaceStore:n,currentUserRootStore:o}=(0,v().K8)((()=>({sidebarSpaceViewStore:ae().default.state.sidebarSpaceViewStore,sidebarSpaceStore:ae().default.state.sidebarSpaceStore,currentUserRootStore:ae().default.state.currentUserRootStore})),[]),a=(0,v().K8)((()=>e?null==n?void 0:n.userId:void 0),[e,null==n?void 0:n.userId]),r=(0,v().K8)((()=>(0,ie().o)(t)?(0,ne().f)({currentUserRootStore:o}):[]),[o,t]),l=(0,v().K8)((()=>re().A.state.isVisible),[]),d=(0,q().tz)(),c=(0,s().v3)(),u=(0,i.useRef)(),p=(0,i.useRef)(),g=(0,i.useRef)(-1),m=(0,i.useCallback)((()=>{const{mobileNative:e}=c,{allSpaces:t,currentSpace:n}=ce();e&&(t===u.current&&n===p.current||e.setBadgeNumber(t,n),p.current=n),t!==u.current&&J(t>0?`${t}`:""),u.current=t}),[c]),f=(0,i.useMemo)((()=>W().Oo(m)),[m]),h=(0,i.useCallback)((async(e,i)=>{if(i===g.current||!n&&!(0,ie().o)(t))return;if(g.current=i,!function(e){if(0===oe().A.state.results.length)return!0;if(!document.hasFocus())return!0;if(!e.includes("unreadCount"))return!0;return!1}(String(i)))return;const o=await(async e=>{const t=[],n=Y().callMultiCellApi({eventName:"getUserNotifications",environment:c,data:{size:1e3,isInboxV2:!0,markNotificationsAsReceived:e},headers:{}});for await(const i of n)"success"===i.type&&t.push(...i.data.results);return t})(l);oe().A.setState({results:o}),f();const s=W().KC.apply(null,o.map((e=>e.unreceived.notificationIds)));for(const a of s)(0,ie().o)(t)?r.forEach((e=>{const t=e.getSpaceStore();t&&ue(a,t,e,d,c)})):n&&t&&ue(a,n,t,d,c)}),[n,t,r,f,c,d,l]);(0,i.useEffect)((()=>{l&&h("visibilityChange",g.current)}),[l,h]);const y=(0,i.useMemo)((()=>W().nF(h,1e3)),[h]);(0,i.useEffect)((()=>{if(!a)return;const e=(0,K().dp)(a),t=te().Ay.addListener(e,void 0,(({key:e,value:t})=>{se().A.whenActive((()=>{y(e,t)}))}),void 0,c);return h("initializeListener",-1),oe().A.addListener(m),c.mobileNative&&ae().default.addListener(m),()=>{t&&te().Ay.removeListener(t,c),oe().A.addListener(m),c.mobileNative&&ae().default.removeListener(m)}}),[a,c,h,y,m])}function ce(){const e="mentions";return{allSpaces:oe().A.getTotalUnreadCountForType(e),currentSpace:oe().A.getUnreadCountForSidebarSpace()[e]??0}}async function ue(e,t,n,i,o){const s=(0,le().v3)(t,{table:V()._p,id:e,spaceId:t.id});await s.load();const a=s.getKeyStore("activity_id").getValue(),r=s.getKeyStore("space_id").getValue();if(!r||!a)return;const l=(0,ee().jA)(s,a,r);await l.load();const d=l.getModel(),{currentUserStore:c}=ae().default.state;if(c&&n&&d&&!d.invalid&&!F().zP(d,c.id)&&await(0,$().a)()&&"undefined"!=typeof Notification){if(await n.load(),!n.isDefined())return;if(!d.isMentionType())return;if("reacted"===d.getType())return;if(!n.getNotifyDesktop())return;if(!o.device.isDesktop)return;if(o.device.isBrowser&&O().default.checkGate({gateName:"browser_push_notifications"})&&"granted"!==Notification.permission){const e=Notification.requestPermission();void 0!==e&&await(0,G().nQ)(1e4,e)}const t=(0,(await g.load()).Notification)({activity:d,getRecordValue:s.getRecordValue,userTimeZone:(0,z().P)(),intl:i,pageVisitSource:U().y8.PushNotification,recipientUser:c.getModel(),experimentService:O().default,collectionFeatureGates:(0,X().i)(),spaceIdCreator:o.idCreator.getSpaceIdCreatorSync(r)});if(!t)return;const{subject:a,body:u}=t,p=O().default.checkGate({gateName:"desktop_deduplicate_notifications"}),m=new Notification(a,{body:u,silent:!0,...p?{tag:e}:{}}),f=F().JT(d.type),h={medium:"desktop_push",type:f,badge_number:ce().allSpaces,notification_id:s.id,activity_id:l.id},v=e=>H().Gj({environment:o,args:h,action:e});v("sent"),m.addEventListener("show",(()=>v("shown"))),m.addEventListener("close",(()=>v("closed"))),m.addEventListener("click",(()=>{const e=F().KP({activity:d,getRecordModel:s.getRecordModel,baseUrl:N().A.domainBaseUrl,pageVisitSource:U().y8.PushNotification});!function(e,t){null!==Q().electronApi&&void 0!==Q().electronApi&&Q().electronApi.openNotificationUrl?Q().electronApi.openNotificationUrl(e):(0,Z().navigate)({environment:t,url:e})}((0,U().p3)(e,[f,"desktop_push"],U().y8.PushNotification),o),v("clicked")}))}}const pe=new(p().O2)("linkMenu",(()=>n.e(4586).then(n.bind(n,323779)))),ge=(0,p()._h)(pe,(e=>e.default)),me=new(p().O2)("message-store-debug-panel",(async()=>await n.e(64199).then(n.bind(n,572107)))),fe=(0,p()._h)(me,(e=>e.MessageStoreDebugPanel));var he=()=>n(971320);function ve(){return(0,v().K8)((()=>he().A.state.open),[],{debugName:"MessageStoreDebugPanelWrapper.isOpen"})?(0,B.jsx)(fe,{}):null}n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698);var ye=()=>n(386164),be=()=>n(571595),Se=()=>n(646736);function xe(){const e=(0,s().v3)(),{shouldTrigger:t,spaceId:n,userId:o}=(0,v().K8)((()=>{const e={shouldTrigger:!1,spaceId:void 0,userId:void 0},{sidebarSpaceStore:t,sidebarSpaceViewStore:n,spaceTransitionStatus:i,currentUserStore:o}=ae().default.state;if((0,ae().isTransitioningSpaces)(i))return e;if(!o||!t||!n)return e;const s=(0,Se().dp)(t,o.id),a=null==s?void 0:s.getMembershipType();return s&&a&&(0,be().m$)(a)?{shouldTrigger:!0,spaceId:t.getSpaceId(),userId:o.id}:e}),[]);return(0,i.useEffect)((()=>{t&&(Ae.has(n)||(Ae.add(n),Y().callApi({eventName:"scheduleSetupPeopleCollection",environment:e,data:{spaceId:n},userId:o,headers:(0,ye().WS)({spaceId:n})})))}),[e,t,n,o]),null}const Ae=new Set;var Me=()=>n(187174),we=()=>n(37433);const je=(0,W().sg)(Y().callApi,1e3,{leading:!0,trailing:!0}),ke=function(){const e=(0,s().v3)(),t=(0,v().K8)((()=>function({environment:e}){const{sidebarSpaceViewStore:t,sidebarSpaceStore:n,currentUserStore:i,spaceTransitionStatus:o}=ae().default.state,s=null==t?void 0:t.getUserId(),a=null==t?void 0:t.getSpaceId(),r={readyForHomePagesRequest:!1,spaceViewUserId:void 0,spaceViewId:void 0,spaceViewSpaceId:void 0};return null!=t&&t.isDefined()&&t.getAlive()&&t.canRead()&&s&&a?(0,ae().isTransitioningSpaces)(o)||e.currentUser.id!==s||(null==i?void 0:i.id)!==s||(null==n?void 0:n.id)!==a?r:(0,we().$H)()?{readyForHomePagesRequest:!0,spaceViewId:t.id,spaceViewUserId:s,spaceViewSpaceId:a}:r:r}({environment:e})),[e]);return(0,Me().Yb)((async()=>{t.readyForHomePagesRequest&&await je({eventName:"getUserHomePages",environment:e,data:{spaceViewId:t.spaceViewId,spaceId:t.spaceViewSpaceId},userId:t.spaceViewUserId,headers:(0,ye().WS)({cellId:void 0,recordId:t.spaceViewId,spaceId:t.spaceViewSpaceId})})}),[e,t.readyForHomePagesRequest,t.spaceViewId,t.spaceViewUserId,t.spaceViewSpaceId]),null};var Ie=()=>n(362749),Ce=()=>n(171510),Te=()=>n(793531),_e=()=>n(93658),Pe=()=>n(578136);function Be(){const e=(0,s().v3)(),t=(0,v().K8)((()=>{const t=e.RouterStore.state.route;if("team"===t.name)return t.teamId}),[e]),n=(0,v().K8)((()=>function({environment:e,currentTeamId:t}){const{sidebarSpaceViewStore:n,sidebarSpaceStore:i,currentUserStore:o,spaceTransitionStatus:s}=ae().default.state,a=e.deviceStore.state,r=null==n?void 0:n.getUserId(),l=null==n?void 0:n.getSpaceId(),d={readyForTeamHomePagesRequest:!1,spaceViewUserId:void 0,spaceViewId:void 0,spaceViewSpaceId:void 0,currentTeamId:void 0};return null!=n&&n.isDefined()&&n.getAlive()&&n.canRead()&&r&&l&&t?(0,ae().isTransitioningSpaces)(s)||e.currentUser.id!==r||(null==o?void 0:o.id)!==r||(null==i?void 0:i.id)!==l?d:(0,Pe().D)({isMobileNative:a.isMobileNative,disableExposureLogging:!0})?{readyForTeamHomePagesRequest:!0,spaceViewId:n.id,spaceViewUserId:r,spaceViewSpaceId:l,currentTeamId:t}:d:d}({environment:e,currentTeamId:t})),[e,t]);return(0,Me().Yb)((async()=>{n.readyForTeamHomePagesRequest&&await De({eventName:"createCollectionViewBlockForPosts",environment:e,data:{teamId:n.currentTeamId,spaceId:n.spaceViewSpaceId},userId:n.spaceViewUserId,headers:(0,ye().WS)({cellId:void 0,recordId:n.spaceViewId,spaceId:n.spaceViewSpaceId})})}),[n.readyForTeamHomePagesRequest,n.spaceViewSpaceId,n.spaceViewUserId,n.spaceViewId,e,n.currentTeamId]),null}const De=(0,W().sg)(Y().callApi,1e3,{leading:!0,trailing:!0});var Re=()=>n(929219),Ee=()=>n(165358),Le=()=>n(96689),Oe=()=>n(534177),Ne=()=>n(47373),Fe=()=>n(249847),Ue=()=>n(369955),ze=()=>n(985405),Ke=()=>n(999830),Ve=()=>n(51781);function qe(){const e=(0,s().v3)(),t=(0,Fe().T)(),n=(0,v().O$)(Re().e),o=(0,Ue().L)(),a=(0,Se().I_)(o),r=null==o?void 0:o.id,l=(0,v().K8)((()=>{if(!a)return!1;return Ge({membershipType:a.getMembershipType()})}),[a]);(0,i.useEffect)((()=>{t&&r&&l&&((0,Ve().Vs)(),n&&(0,Ve().VO)({userId:t,spaceId:r,teamTypes:new Set(["Joined"]),environment:e}))}),[e,t,r,l,n]);const d=(0,v().K8)((()=>{const e=[];for(const t of Object.keys(Ke().q.state))for(const n of Object.keys(Ke().q.state[t]))e.push({userId:t,spaceId:n});return e}),[]);return(0,B.jsx)(B.Fragment,{children:d.map((({userId:e,spaceId:t})=>(0,B.jsx)(We,{userId:e,spaceId:t},`teams-listener-${e}-${t}`)))})}function We(e){const{userId:t,spaceId:n}=e,o=(0,s().v3)(),a=(0,v().K8)((()=>{const e=(0,Le().n2)(n),i=new(ze().SpaceStore)(o,e);return(0,Se().dp)(i,t)}),[o,t,n]),r=(0,v().K8)((()=>Ge({membershipType:a.getMembershipType()})),[a]),l=(0,i.useCallback)((e=>{const{value:i,passThroughData:s}=e;if(null==i)return;const a=Ke().q.getUnit(t,n);a?a.lastEmitValue!==i&&(0,Ve()._T)({userId:t,spaceId:n,teamIds:Array.isArray(s)?new Set(s):"all",environment:o,lastEmitValue:i}):Ee().rateLimitedLog({from:"TeamsListener",level:"error",type:"teamsUnitNotFound",spaceId:n,data:{miscDataToConvertToString:{userId:t}}})}),[o,t,n]);return(0,i.useEffect)((()=>{if(!r)return;const e=te().Ay.addListener((0,K().um)(n),void 0,l,void 0,o);return()=>{e&&te().Ay.removeListener(e,o)}}),[o,t,n,l,r]),null}function Ge(e){const{membershipType:t}=e;if((0,Ne().Qd)())return!0;switch(t){case"owner":case"membership_admin":case"member":case"restricted_member":return!0;case"page_guest":case"none":case void 0:return!1;default:return(0,Oe().HB)(t)}}var He=()=>n(429816),Ye=()=>n(401497),$e=()=>n(721479),Qe=()=>n(995847),Ze=()=>n(284371),Je=()=>n(921855),Xe=()=>n(24973),et=()=>n(721235),tt=()=>n(778417);function nt(e){let t=0,n=!1;const i=Xe().A.state.blockStore;Xe().A.state.open&&null!=i&&i.getPropertyValue("alt_text")&&(t=(0,Je().r4)(i.getPropertyValue("alt_text"),i).length,n=Xe().A.state.isEmptyOnOpen),et().S(e,{number_of_characters:t,did_create:n}),Xe().A.setState({open:!1,blockStore:i}),tt().IU({environment:e})}var it=()=>n(190033),ot=()=>n(792540),st=()=>n(232930),at=()=>n(285790),rt=()=>n(859428),lt=()=>n(712855);const dt=(0,q().YK)({learnTooltip:{defaultMessage:"Learn more about alt text",id:"altTextMenuPopup.helpButton.tooltip"}});function ct(){const e=(0,s().v3)(),{device:t}=e,n=(0,q().tz)(),o=(0,Ye().IS)((e=>({wrapper:{padding:t.isMobile?16:12,display:"flex",flexDirection:"column",fontSize:t.isMobile?Ze().J.UIRegular.mobile:Ze().J.UIRegular.desktop,wordBreak:"break-word",maxHeight:t.isMobile?"35vh":"200px",overflowY:"auto"},closeButton:{borderRadius:"100%",width:22,height:22,float:"inline-end",marginInlineStart:8},input:{marginTop:t.isMobile?16:12,padding:t.isMobile?"8px 12px":"4px 10px",width:"100%",borderRadius:6,boxShadow:e.inputBoxShadow,background:e.background.primary,cursor:"text",overflowX:"hidden"},helpText:{color:e.text.secondary,display:"inline"},helpButton:{marginInlineStart:2,display:"inline-flex",position:"absolute",transform:t.isMobile?void 0:"translateY(-1px)"}})),[t.isMobile]),{altTextStore:a,altText:r,canEdit:l}=(0,v().K8)((()=>{const e=Xe().A.state.blockStore;return{altTextStore:null==e?void 0:e.getPropertyStore("alt_text"),altText:e?(0,Je().r4)(null==e?void 0:e.getPropertyValue("alt_text"),e):void 0,canEdit:(null==e?void 0:e.canEdit())&&!(null!=e&&e.isNavigableAncestorNonEditableState())}}),[]);return(0,i.useEffect)((()=>{a&&(0,it().z)({store:a})}),[a]),(0,B.jsx)(A().A,{menuType:t.isMobile?w().gu.ActionSheet:w().gu.Popup,width:t.isMobile?"100vw":310,children:(0,B.jsxs)("div",{style:o.wrapper,children:[(0,B.jsxs)("div",{children:[(0,B.jsx)(at().A,{style:o.closeButton,hovered:!0,icon:Qe().xMarkSmallIcon,onClick:()=>nt(e),ariaLabel:n.formatMessage({id:"altTextMenuPopup.closeButton",defaultMessage:"Close"})}),l?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)("div",{style:o.helpText,children:(0,B.jsx)(q().sA,{id:"altTextMenuPopup.description",defaultMessage:"Add alt text to describe this image. This makes your page more accessible to people who are vision-impaired or blind"})}),(0,B.jsx)(rt().A,{renderTooltip:()=>n.formatMessage(dt.learnTooltip),render:e=>(0,B.jsx)(at().A,{ariaLabel:n.formatMessage(dt.learnTooltip),icon:$e().questionMarkCircleSmallIcon,external:!0,href:(0,st().x)("guides.altText"),style:o.helpButton,colorVariant:"tertiary",...e})})]}):r]}),l&&a?(0,B.jsx)(lt().A,{store:a,disabled:!1,pasteBehavior:"plaintext",style:o.input,placeholderStyle:o.input,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableInsertText:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableMentions:!0,disableEmbedMenu:!0,disableMobileActionBar:!0,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:()=>nt(e),onEsc:()=>nt(e),onTab:()=>!0,placeholder:n.formatMessage({id:"altTextMenuPopup.placeholder",defaultMessage:"Add alt text..."}),inPageFind:ot().Os.none}):void 0]})})}const ut=function(){const e=(0,s().v3)(),{device:t}=e,n=(0,Ye().IS)((e=>({popup:{background:e.altTextPopupBackground,borderStartStartRadius:t.isMobile?12:6,borderStartEndRadius:t.isMobile?12:6,insetInlineStart:t.isMobile?0:8}})),[t.isMobile]),{open:i,originRect:o}=(0,v().K8)((()=>{const{open:e}=Xe().A.state;return e?{open:e,originRect:Xe().A.state.originRect}:{open:e,originRect:void 0}}),[]);return(0,B.jsx)(M().Ay,{popupType:t.isMobile?y().n.SlideUp:y().n.Popup,open:i,originRect:o,originGap:8,placementToOrigin:"bottom",alignmentToOrigin:"end",onDismiss:()=>nt(e),render:()=>(0,B.jsx)(ct,{}),sameWidthAsOrigin:!1,style:n.popup,trapFocus:!0})};var pt=()=>n(197959),gt=()=>n(182641),mt=()=>n(725332),ft=()=>n(655236),ht=()=>n(517223),vt=()=>n(644914),yt=()=>n(737230),bt=()=>n(372154),St=()=>n(71301),xt=()=>n(611648),At=()=>n(998531),Mt=()=>n(700500),wt=()=>n(273321),jt=()=>n(143943),kt=()=>n(555776),It=()=>n(116008),Ct=()=>n(98182),Tt=()=>n(13679),_t=()=>n(987017);const Pt=[bt().c.Open,bt().c.Resolved],Bt="block_menu";const Dt=function({discussionIds:e,blockStore:t,recursivelyLoadAllDiscussions:o,tab:a,property_id:r}){const l=(0,q().tz)(),d=(0,s().v3)(),{resolved:c,unresolved:u}=(0,v().K8)((()=>{const n=ee().Bw(t,{recursivelyLoadAllDiscussions:o,includePropertyDiscussions:!0}).filter((t=>{if(e&&!e.includes(t.id)&&!ee().j3(t))return!1;return!Boolean(r)||t.getPropertyId()===r})).sort(((e,t)=>t.getReactionStores().length-e.getReactionStores().length)),{resolved:i,unresolved:s}=ee().uy(n);return 0===s.length?{resolved:i,unresolved:s}:{resolved:[],unresolved:s}}),[t,o,e,r]),p=(0,i.useRef)([]);(0,i.useEffect)((()=>{const e=u.filter((e=>(0,ft().s)({discussionStore:e,navigableBlockStore:t.getNavigableBlockStore()})));p.current=e}),[u,t]);const g=(0,Ye().IS)((e=>({closeButton:{position:"absolute",insetInlineEnd:10,borderRadius:"50%",background:e.background.tertiaryTranslucent}})),[]),m=(0,i.useCallback)((()=>{if(u.length>0){const e=u.filter((e=>p.current.includes(e)));(0,mt().X)({environment:d,discussionStores:e})}gt().xl()}),[d,u]);let f;return f=N().A.isMobile?{menuType:w().gu.Modal,title:e&&e.length>1?(0,B.jsx)(q().sA,{defaultMessage:"Discussions",id:"multipleBlockDiscussionMenu.mobileMenuSheet.title"}):(0,B.jsx)(q().sA,{defaultMessage:"Discussion",id:"singleBlockDiscussionMenu.mobileMenuSheet.title"}),header:(0,B.jsx)(Ot,{tab:a,resolved:c,unresolved:u}),right:(0,B.jsx)(at().A,{icon:n(297813).xMarkFillIcon,style:g.closeButton,onClick:m,ariaLabel:l.formatMessage({id:"blockDiscussionMenu.closeButton.ariaLabel",defaultMessage:"Close"})}),onClickRight:m,whiteBackground:!0,height:"100%"}:{menuType:w().gu.Popup,header:(0,B.jsx)(Ot,{tab:a,resolved:c,unresolved:u}),width:480,maxHeight:"50vh",onClickOutside:m},(0,B.jsx)(n(700180).A,{capture:!0,preventType:xt().A.All,children:(0,B.jsx)(n(297872).A,{capture:!0,allowMobileAutoScroll:!0,render:()=>(0,B.jsx)(At().N,{debugName:"BlockDiscussionMenu",capture:!0,onEsc:m,onBackspace:Lt,onDelete:Lt,children:(0,B.jsx)(Tt().A,{store:t,droppable:!0,render:()=>(0,B.jsx)(A().A,{...f,children:(0,B.jsx)(Ft,{tab:a,blockStore:t,resolved:c,unresolved:u,onDismiss:m})})},t.id)})})})};function Rt({message:e}){const t=(0,s().v3)(),{device:n}=t,i=(0,Ye().IS)((e=>({emptyState:{textAlign:"center",padding:n.isMobile?"64px 18px":"32px 18px 36px",fontSize:14,color:e.text.secondary}})),[n.isMobile]);return(0,B.jsx)("div",{style:i.emptyState,children:e})}function Et(e){const t=bt().A.state;t.open&&bt().A.setState({...t,tab:Pt[e]})}function Lt(e){null==e||e.preventDefault(),gt().xl()}function Ot({tab:e,resolved:t,unresolved:n}){const i=(0,s().v3)(),{device:o}=i,a=n.length,r=t.length,l=(0,Ye().IS)((e=>({openCountStyle:{color:e.text.tertiary},resolvedCountStyle:{color:e.text.quaternary}})),[]);return 0===r||0===a?null:(0,B.jsx)(_t().Ay,{tabs:[(0,B.jsxs)("div",{children:[(0,B.jsx)(q().sA,{defaultMessage:"Open",id:"blockDiscussionMenu.openDiscussionsTab.title"},"openDiscussionsTitle"),"Â ",(0,B.jsx)("span",{style:l.openCountStyle,children:a})]},"openDiscussions"),(0,B.jsxs)("div",{children:[(0,B.jsx)(q().sA,{defaultMessage:"Resolved",id:"blockDiscussionMenu.resolvedDiscussionsTab.title"},"resolvedDiscussionsTitle"),"Â ",(0,B.jsx)("span",{style:l.resolvedCountStyle,children:r})]},"resolvedDiscussions")],selectedIndex:Pt.indexOf(e),onChange:Et,style:{...o.isAndroid&&{borderBottom:"none"}}})}function Nt(e){const{value:t}=(0,p().fJ)(u().commentsDependency),n=(0,s().v3)(),i=(0,v().K8)((()=>It().A.state.open&&kt().A.state.overlapsExistingDiscussionMenu),[]),o=(0,v().K8)((()=>bt().A.state.open&&bt().A.state.tab===bt().c.Open),[]),a=(0,v().K8)((()=>bt().A.state.open&&bt().A.state.keepNewDiscussionAtBottom),[]),r=(0,v().K8)((()=>(It().A.state.open&&kt().A.state.overlapsExistingDiscussionMenu)??!1),[]);if(0===e.discussionStores.length)return null;const l=a?e.discussionStores[0]:void 0;return(0,B.jsxs)(B.Fragment,{children:[t?e.discussionStores.slice(l?1:0).map(((n,i,o)=>(0,B.jsx)(u().PW,{store:n,format:t.discussionHelpers.DiscussionFormat.Menu,isFirst:0===i,isOnly:1===o.length,discussionLocation:Bt,showResolveButtonByDefaultIfPossible:!1,blockStore:e.blockStore,onDismiss:e.onDismiss},n.id))):void 0,l&&t?(0,B.jsx)(u().PW,{store:l,format:t.discussionHelpers.DiscussionFormat.Menu,isFirst:1===e.discussionStores.length,isOnly:1===e.discussionStores.length,discussionLocation:Bt,showResolveButtonByDefaultIfPossible:!1,blockStore:e.blockStore,onDismiss:e.onDismiss},l.id):void 0,i&&o?(0,B.jsx)(wt().A,{environment:n,shouldShowTopDividerLine:!0,shouldExpandDiscussionWidth:r,noBackgroundColors:!0}):void 0]})}function Ft({tab:e,blockStore:t,resolved:n,unresolved:o,onDismiss:s}){const a=(0,Ye().DP)(),r=(0,jt().C)({type:"discussionLocation",location:Bt}),l=(0,v().K8)((()=>t.getType()),[t]),d=(0,v().K8)((()=>Ct().B(t)),[t]),{value:c}=(0,p().fJ)(u().commentsDependency);if(!c)return null;if(e===bt().c.Open){if(o.length>0){const e=l&&(0,Oe().O)(Mt().kt,l);return N().A.isMobile&&e&&d&&!r?(0,B.jsxs)(i.Fragment,{children:[(0,B.jsx)("div",{style:{padding:"12px 16px",boxShadow:`0 1px 0 ${a.regularDividerColor}`,marginBottom:1},children:(0,B.jsx)(d,{store:t,disabled:!0,hideContent:!0,style:{fontSize:14,pointerEvents:"none"},isQuickFind:!0})}),(0,B.jsx)(Nt,{discussionStores:o,blockStore:t,onDismiss:s})]}):(0,B.jsx)(Nt,{discussionStores:o,blockStore:t,onDismiss:s})}return(0,B.jsx)(Rt,{message:(0,B.jsx)(q().sA,{defaultMessage:"No comments to show.",id:"blockDiscussionMenu.emptyState.noCommentsMessage"})})}return n.length>0?(0,B.jsx)(Nt,{discussionStores:n,blockStore:t,onDismiss:s}):(0,B.jsx)(Rt,{message:(0,B.jsx)(q().sA,{defaultMessage:"No resolved comments.",id:"blockDiscussionMenu.emptyState.noResolvedCommentsMessage"})})}const Ut=function(){const e=(0,s().v3)(),t=(0,s().Y0)(),o=(0,v().K8)((()=>bt().A.state.rect),[]),a=(0,i.useRef)([]),r=(0,v().K8)((()=>bt().A.state.open),[]);(0,i.useEffect)((()=>{const e=bt().A.state;if(!r||!e.open)return;const{blockStore:t}=e,{spaceId:n}=t.pointer;if(!n)return;const i=bt().A.getOpenDiscussionIds().map((e=>St().c.createChildStore(t,{table:pt().$Y,id:e,spaceId:n}))).filter((e=>!(0,ft().s)({discussionStore:e,navigableBlockStore:t.getNavigableBlockStore()}))).map((e=>e.id));a.current=i}),[r]);const l=(0,v().K8)((()=>{if(!bt().A.state.open)return!1;let t=!1;const i=bt().A.state.property_id;if(bt().A.state.open&&i){var o;const e=null===(o=bt().A.state.blockStore)||void 0===o||null===(o=o.getAssociatedCollectionStore())||void 0===o?void 0:o.getLayoutStore();e&&(t=(0,ht().Hc)({layoutStore:e,propertyId:i}).isPropertyInPageDetails)}const s=(0,n(835066).$N)(e,bt().A.state.blockStore);return!!t||(yt().Ay.state.currentTab!==yt().tF.Comments||!(0,vt().Nk)(e))&&!s}),[e]),d=(0,i.useCallback)((()=>{const t=bt().A.state;if(t.open){const{blockStore:n}=t,{spaceId:i}=n.pointer;if(i){const t=bt().A.getOpenDiscussionIds().map((e=>St().c.createChildStore(n,{table:pt().$Y,id:e,spaceId:i}))).filter((e=>!a.current.includes(e.id)));(0,mt().X)({environment:e,discussionStores:t})}}gt().xl()}),[e]),c=(0,i.useCallback)((()=>{if(bt().A.state.open)return(0,B.jsx)(Dt,{tab:bt().A.state.tab,blockStore:bt().A.state.blockStore,discussionIds:bt().A.state.discussionIds,recursivelyLoadAllDiscussions:bt().A.state.recursivelyLoadAllDiscussions,property_id:bt().A.state.property_id})}),[]),u=N().A.isMobile?y().n.BottomSheet:y().n.Popup;return(0,B.jsx)(M().Ay,{popupType:u,bottomSheetBackgroundColor:"primary",bottomSheetInitialState:t.isPhone?"full":"half",open:l,originRect:o,placementToOrigin:"bottom",alignmentToOrigin:"center",disableMouseCapture:!0,originGap:4,render:c,preventScaleTransition:!0,preventOpacityTransition:!0,onDismiss:d,trapFocus:!1})};var zt=()=>n(564884),Kt=()=>n(792485),Vt=()=>n(252291),qt=()=>n(925193),Wt=()=>n(847832),Gt=()=>n(412975),Ht=()=>n(471415),Yt=()=>n(541372),$t=()=>n(926010),Qt=()=>n(732067),Zt=()=>n(949575),Jt=()=>n(945710),Xt=()=>n(352097),en=()=>n(310770),tn=()=>n(390849),nn=()=>n(751905),on=()=>n(486674),sn=()=>n(38337),an=()=>n(495159),rn=()=>n(972435),ln=()=>n(84349),dn=()=>n(525569),cn=()=>n(502438),un=()=>n(760217),pn=()=>n(939740),gn=()=>n(89924);const mn=(0,q().YK)({createTransclusion:{defaultMessage:"Paste and sync",id:"blockPasteMenu.actions.createTransclusion.title"},linkToPage:{defaultMessage:"Link to page",id:"blockPasteMenu.actions.linkToPage.title"},dismissItem:{defaultMessage:"Dismiss",id:"blockPasteMenu.actions.dismiss.title"},pasteItem:{defaultMessage:"Paste",id:"blockPasteMenu.actions.paste.label"},suggestedActionsSectionTitle:{defaultMessage:"Suggested actions",id:"blockPasteMenu.actions.suggestedActionsSectionTitle"}});const fn=function(){const e=(0,s().Y0)(),t=(0,s().v3)(),o=(0,v().O$)(ln().A),{stores:a,phase:r}=(0,v().O$)(cn().default);(0,i.useEffect)((()=>{o.open&&((0,n(821062).A)(a,o.blocks)&&r===cn().SelectionPhase.Selected||Yt().VN(t))}),[o,a,r,t]);const l=(0,i.useCallback)((()=>{Yt().VN(t)}),[t]),d=o.open&&"ai_actions"===o.type;return(0,B.jsx)(M().Ay,{popupType:e.isMobileNative&&!e.isTablet?y().n.SlideUp:y().n.Popup,open:o.open,originRect:o.open?o.rect:void 0,placementToOrigin:d?"right":"bottom",alignmentToOrigin:d?"start":"end",originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:()=>(0,B.jsx)(vn,{}),onDismiss:l,disableFlippingPlacement:d})};function hn(e){const{menuItemProps:t}=e,{isMobile:n}=(0,s().Y0)(),i=n?{mobileIconStyle:{marginInlineStart:18,marginInlineEnd:2}}:{};return(0,B.jsx)(un().A,{...t,title:rn().A.formatMessage(an().VT.askAI),icon:(0,B.jsx)(Qt().vF,{}),...i})}function vn(){var e;const t=(0,s().v3)(),n=(0,Ye().DP)(),{device:i}=t,o=null===(e=(0,Kt().S)())||void 0===e?void 0:e.spaceStore,a=(0,v().K8)((()=>{const e=ln().A.state;return e.open?"ai_actions"===e.type?function(e,t,n){var i;const o=(0,on().a)();if(!o)return null;const s=(0,Zt().clientSkillToAssistantSurfaceAction)((0,Jt().getAllClientSkills)({currentPageRecordPointer:void 0,currentCollectionRecordPointer:void 0})),a={type:"entrypoint",entrypoint:"blockPasteMenu",isMobile:t.device.isMobile,pageStore:o,selectionState:cn().default.state,textSelectionState:T().default.state,userSettings:null===(i=ae().default.state.currentUserSettingsStore)||void 0===i?void 0:i.getSettings()},r=(0,Zt().filterAssistantSurfaceActionsForContext)(s,a),l=(0,en().d7)({assistantSuggestionContext:a,validatedActions:r}).filter(Jt().isAssistantSurfaceActionWithClientSkill),d=(0,Zt().clientSkillToAssistantSurfaceAction)(l),c=(0,qt().gC)();return[{key:"ai_actions_paste_menu",render:e=>(0,B.jsx)(gn().A,{...e,title:rn().A.formatMessage(mn.suggestedActionsSectionTitle)}),items:[{key:"paste",render:e=>(0,B.jsx)(un().A,{...e,icon:(0,B.jsx)(Vt().I,{icon:Gt().arrowTurnDownLeftIcon}),title:rn().A.formatMessage(mn.pasteItem)}),action:()=>{(0,zt().u)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:"ai_actions",action:"paste"}}}),Yt().VN(t)}},...d.map((e=>({key:e.skillType,render:t=>(0,B.jsx)(un().A,{...t,title:rn().A.formatMessage(nn().DZ.writerGlobalSkill,{displayName:rn().A.formatMessage(e.displayName),acceptsParameters:(0,Wt().yH)(e.skillType)||(0,Wt().SH)(e.skillType)}),icon:(0,B.jsx)(Ht().O1,{svg:e.icon,svgFill:(0,Xt().vJ)(e.category).color(n).color})}),action:async()=>{try{(0,zt().u)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:"ai_actions",action:"client_skill",skill_type:e.skillType}}}),Yt().VN(t),await(0,$t().toggleInitialPrompt)({from:"block_paste_menu",environment:t,sessionId:c});const n=dn().default.state;if(!n||"assistantCompletionPopup"!==n.type||"initialPrompt"!==n.stage)return;await tn().assistantWriterActions.triggerAssistantSkillCompletion({environment:t,context:n.context,clientSkillWithParameterValues:(0,Jt().dangerouslyCreateClientSkillWithParameterValues)(e),updater:dn().default.createUpdater(),sessionId:c,from:"block_paste_menu",assistantSurfaceType:t.device.isMobile?"mobileWriter":"writer"})}catch{Ee().log({level:"info",from:"BlockPasteMenu",type:"triggerAssistantSkillCompletionError",error:{message:"Error triggering assistant skill completion"},data:{miscDataToConvertToString:{skillType:e.skillType}}})}}}))),{key:"ask_ai",render:e=>(0,B.jsx)(hn,{menuItemProps:e}),action:async()=>{try{(0,zt().u)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:"ai_actions",action:"ask_ai"}}}),Yt().VN(t),await(0,$t().toggleInitialPrompt)({from:"block_paste_menu",environment:t,sessionId:c})}catch{Ee().log({level:"info",from:"BlockPasteMenu",type:"triggerAssistantWriterError",error:{message:"Error opening assistant writer"}})}}}]}]}(0,t,n):"blocks"===e.type||"links"===e.type?function(e,t,n){const{blocks:i}=e,o=[];if("blocks"===e.type){const{copiedStores:s,pageSource:a}=e;Yt().GV({currentSpaceId:null==n?void 0:n.id,blocks:i,copiedStores:s})&&o.push({name:rn().A.formatMessage(mn.createTransclusion),action:async()=>{(0,zt().u)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"create_transclusion"}}}),await Yt().Ce({environment:t,blocks:i,copiedBlockIds:s.map((e=>e.id)),removeBlocks:!0})}}),Yt().h8({blocks:i})&&o.push({name:rn().A.formatMessage(mn.linkToPage),action:async()=>((0,zt().u)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"link_to_page"}}}),Yt().Xw({environment:t,blocks:i,source:{type:"blocks",copiedStores:s,pageSource:a}}))})}return"links"===e.type&&o.push({name:rn().A.formatMessage(mn.linkToPage),action:async()=>((0,zt().u)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"link_to_page"}}}),Yt().Xw({environment:t,blocks:i,source:{type:"links",copiedLinks:e.copiedLinks}}))}),[{key:"embed section",render:e=>(0,B.jsx)(gn().A,{...e}),items:[{key:"dismiss",render:e=>(0,B.jsx)(un().A,{...e,title:rn().A.formatMessage(mn.dismissItem)}),action:()=>{(0,zt().u)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"dismiss"}}}),Yt().VN(t)}},...o.map((({name:e,action:t})=>({key:`embed ${e}`,render:t=>(0,B.jsx)(un().A,{...t,title:e}),action:t})))]}]}(e,t,o):void(0,Oe().HB)(e):null}),[t,n,o]);if(null===a)return null;let r;return r=i.isMobile?{menuType:w().gu.ActionSheet}:{menuType:w().gu.Popup,width:320,maxHeight:"40vh"},(0,B.jsx)(A().A,{...r,className:sn().poM,children:(0,B.jsx)(pn().Ay,{type:pn().Oh.Vertical,sections:a,initialFocus:0})})}var yn=()=>n(179034),bn=()=>n(857783),Sn=()=>n(969197),xn=()=>n(148832);async function An(e,t,n,i){if(null==n||!n.citationAnnotationData)return;if("block"!==n.citationAnnotationData.type)return;const{blockId:o}=n.citationAnnotationData;if(!o)return;e.preventDefault&&e.preventDefault();const s=new(xn().B)(t,{table:yn().ev,id:o});await s.load({timeout:1e3}),n.fromBlockStore&&void 0===i&&bn().uK({store:n.fromBlockStore,environment:t,visitType:void 0,pageVisitSource:void 0}),bn().uK({store:s,environment:t,visitType:void 0,pageVisitSource:U().y8.Citation,openInNew:i})}function Mn(){const e=(0,s().v3)(),t=(0,v().K8)((()=>{const e=T().default.state;if("editing"!==e.mode)return;const t=(0,j().H)(e.multiSelection);if(!t)return;const n=(0,Je().vv)(t);return n?{fromBlockStore:(0,Sn().T)(t.store),citationAnnotationData:n}:void 0}),[]),n=(0,i.useCallback)((n=>function(e,t,n){return An(e,t,n,"tab")}(n,e,t)),[e,t]),o=(0,i.useCallback)((n=>function(e,t,n){return An(e,t,n,void 0)}(n,e,t)),[e,t]);return t?(0,B.jsx)(At().N,{debugName:"CitationListener",capture:!0,onEnter:o,onCommandEnter:n}):null}var wn=()=>n(673898),jn=()=>n(623580),kn=()=>n(125565);const In=function(){const e=(0,s().v3)(),{device:t}=e,{active:n,stringValue:i}=(0,v().K8)((()=>{const{active:e,stringValue:t}=wn().A.state;return{active:e,stringValue:t}}),[]),o=window.innerWidth/2-150,a=window.innerHeight/2,r=t.isMobileNative?(0,B.jsx)(q().sA,{defaultMessage:"Tap to copy the link above",id:"clipboardInputRenderer.copyLink.mobile_message"}):(0,B.jsx)(q().sA,{defaultMessage:"Right click and copy the link above",id:"clipboardInputRenderer.copyLink.message"});return(0,B.jsx)(M().Ay,{popupType:t.isMobileNative?y().n.SlideUp:y().n.Popup,open:n,originRect:{top:a,left:o},onDismiss:Cn,placementToOrigin:"bottom",alignmentToOrigin:"start",originGap:0,render:()=>(0,B.jsx)(At().N,{debugName:"ClipboardInputRenderer",capture:!0,onEnter:W().D_,onCommandEnter:W().D_,onCommandShiftEnter:W().D_,onCommandSlash:W().D_,onDelete:W().D_,onBackspace:W().D_,onEsc:W().D_,onLeft:W().D_,onRight:W().D_,onUntab:W().D_,onTab:W().D_,onSelectAll:W().D_,onRedo:W().D_,onUndo:W().D_,onToggleBold:W().D_,onToggleItalics:W().D_,onToggleStrike:W().D_,onToggleCode:W().D_,onCut:W().D_,onCopy:W().D_,onPaste:W().D_,onKeypress:W().D_,children:(0,B.jsxs)("div",{style:{padding:8,width:300},children:[(0,B.jsx)(jn().A,{style:{width:"100%",fontSize:12},value:i,focus:!0,textarea:!0,selectAll:!0,readOnly:!0}),(0,B.jsx)(kn().A,{isSmall:!0,style:{marginTop:6,pointerEvents:"none"},children:r})]})})})};function Cn(){wn().A.setState({...wn().A.state,active:!1,stringValue:""})}var Tn=()=>n(588264),_n=()=>n(211419),Pn=()=>n(861841),Bn=()=>n(269380);const Dn=function(){const e=(0,v().O$)(Pn().Hf);return(0,B.jsx)(_n().hJ,{open:e,children:(0,B.jsx)(Rn,{})})};function Rn(){const e=(0,v().O$)(Pn().Ay),t=(0,v().K8)((()=>function(){const e=Pn().Ay.state;if(!e.isDragging)return;const{startX:t,startY:n,currentX:i,currentY:o}=e;return{position:"absolute",top:0,insetInlineStart:0,transform:`translate3d(${i-t}px, ${o-n}px, 0)`}}()),[]);if(!e.isDragging)return null;const n=e.draggedStores.map(((t,n)=>(0,B.jsx)("div",{children:e.ghostElements[n].map(((e,t)=>(0,B.jsx)(Bn().A,{element:e},t)))},n)));return(0,B.jsx)("div",{style:t,children:n})}var En=()=>n(887480),Ln=()=>n(229833),On=()=>n(605402);const Nn=function(){const e=(0,s().v3)(),t=(0,v().O$)(ae().AppStoreSidebarSpaceStore);return(0,i.useEffect)((()=>{if(!t)return;const i=te().Ay.addListener((0,K().On)(t.id),void 0,(async({value:i})=>{if(!On().A.shouldRefetch({currentSpaceId:t.id,emitValue:i}))return;const o=await Y().callApi({eventName:"getAllSpacePermissionGroupsWithMemberCount",environment:e,data:{spaceId:t.id},headers:(0,ye().WS)({cellId:void 0,spaceId:t.id})});if("failed"===o.type)return Ee().rateLimitedLog({from:"CurrentSpacePermissionGroupsListener",level:"error",type:"getAllCurrentSpacePermissionGroupsFailed",spaceId:t.id,error:(0,Ln().convertErrorToLog)(o.error)}),[];On().A.setState({permissionGroupsAndMemberCounts:o.data.groupsWithMemberCount.map((e=>({group:n(792071).Bj6.fromValue("space_permission_group",e.group),memberCount:e.memberCount}))),lastEmitData:{spaceId:t.id,value:i}})}),void 0,e);return function(){i&&te().Ay.removeListener(i,e)}}),[t,e]),null};var Fn=()=>n(798880),Un=()=>n(486130);const zn=function(){const e=(0,s().v3)(),{sidebarSpaceStore:t,currentUserStore:n}=(0,v().K8)((()=>({sidebarSpaceStore:ae().default.state.sidebarSpaceStore,currentUserStore:ae().default.state.currentUserStore})),[]),o=null==n?void 0:n.id;return(0,i.useEffect)((()=>{if(!t||!o)return;const n=te().Ay.addListener((0,K().yp)({spaceId:t.id,userId:o}),void 0,(async({value:n})=>{if(!Un()._.shouldRefetch({spaceId:t.id,userId:o,emitValue:n}))return;const i=await Y().callApi({eventName:"getSpacePermissionGroupIdsContainingMembers",environment:e,data:{spaceId:t.id,userIds:[o]},headers:(0,ye().WS)({cellId:void 0,spaceId:t.id})});if("failed"===i.type)return Ee().rateLimitedLog({from:"CurrentUserSpaceGroupMembershipListener",level:"error",type:"getSpacePermissionGroupIdsContainingMembers",spaceId:t.id,actor:{type:"user",id:o,table:Fn().oo},error:(0,Ln().convertErrorToLog)(i.error)}),[];const s=Un()._.getState();Un()._.setState({...s,[o]:{...s[o],[t.id]:{spacePermissionGroupIds:new Set(i.data.userToGroupMap[o]||[]),lastEmitValue:n}}})}),void 0,e);return function(){n&&te().Ay.removeListener(n,e)}}),[t,o,e]),null};var Kn=()=>n(666144),Vn=()=>n(245865),qn=()=>n(423219);function Wn(e){const{environment:t,pointers:n,userIdToCloneFrom:i}=e;for(const o of n)Kn().PC({environment:t,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,pointer:o,model:t.defaultRecordCache.inMemoryRecordCache.getRecordModel({pointer:o,userId:i}),role:"reader",updatePaths:[[]],debugSource:"CustomEmojisListener"})}const Gn=new(n(99895).G)((()=>0));const Hn=function(){const e=(0,s().v3)(),[t,o]=(0,i.useState)(!1);(0,i.useEffect)((()=>{!async function(){await n(807054).waitForInitialPageRenderToComplete(),o(!0)}()}),[]);const a=(0,v().K8)((()=>{var e;return null===(e=(0,n(87878).vZ)())||void 0===e?void 0:e.id}),[]),r=e.currentUser.id,l=(0,v().K8)((()=>{const e=qn().A.getKeys();return a&&r?e.includes(a)?e:[...e,a]:e}),[a,r]);return function(e,t){const n=(0,s().v3)();(0,i.useEffect)((()=>{const i=Gn.get(e)+1;Gn.set(e,i);const o=()=>{};Object.defineProperty(o,"name",{configurable:!0,enumerable:!1,value:`useRetainRecordsInMemory(${e} ${i})`});for(const e of t)n.defaultRecordCache.inMemoryRecordCache.addListenerToRecord(e,o),Vn().cancelEviction({pointer:e,userId:n.currentUser.id});return()=>{for(const e of t)n.defaultRecordCache.inMemoryRecordCache.removeListenerToRecord(e,o),Vn().unsubscribeAfterDelay({environment:n,pointer:e,userId:n.currentUser.id})}}),[e,n,t])}("CustomEmojis",(0,v().K8)((()=>{if(!t)return[];const n=[];for(const t of l){const i=qn().A.getDataWithoutRefetch(e,{spaceId:t});if(!i)continue;const o=i.pointers,s=i.lastFetchedBy;t===a&&s!==r&&Wn({environment:e,pointers:o,userIdToCloneFrom:s}),n.push(...o)}return n}),[l,a,r,e,t])),function(e){const t=(0,s().v3)();(0,i.useEffect)((()=>{const n=[];for(const i of e){const e=te().Ay.addListener((0,K().VW)(i),void 0,(({value:e})=>{qn().A.emit(t,{spaceId:i},e)}),void 0,t);e&&n.push(e)}return()=>{for(const e of n)te().Ay.removeListener(e,t)}}),[t,e])}(l),null};var Yn=()=>n(597777),$n=()=>n(220719),Qn=()=>n(743336),Zn=()=>n(319975),Jn=()=>n(749804),Xn=()=>n(180252),ei=()=>n(536131);const ti=function(){const e=(0,s().v3)(),{device:t}=e,n=(0,v().O$)(ei().A);return(0,B.jsx)(M().Ay,{popupType:t.isMobile?y().n.BottomSheet:y().n.Popup,open:n.open,originRect:n.originRect,onDismiss:Qn().V,render:()=>(0,B.jsx)(ni,{shouldShowReminder:!!n.open&&n.allowReminders}),trapFocus:!0})};function ni({shouldShowReminder:e}){const t=(0,s().v3)(),n=(0,v().K8)((()=>ii()),[]);if(!n)return null;const i="default",{date_format:o,time_format:a,dateValue:r}=n;return(0,B.jsx)(p().u2,{dependency:f().cm,children:({DatePropertyMenu:n})=>(0,B.jsx)(n,{firstDayOfWeek:Xn().XX.state,value:r,canConfigureCollection:!0,onChangeValue:e=>function(e,t,n){if(!e)return void function(e,t){const n=ii();if(!n)return;const{textStore:i,textValue:o,tokenIndex:s}=n,a=b().AhH(o.slice(0,s)),r=b().AhH(o.slice(0,s+1));x().createAndCommit({userAction:"DateMentionMenu.removeDateAnnotation",environment:e,canUndo:!0,perform:t=>{Zn().jQ({environment:e,store:i,selection:{startIndex:a,endIndex:r},transaction:t})}})}(t);if(!Yn().kC(e))return;const i=ii();if(!i)return;const{date_format:o,time_format:s}=i;oi({date_format:o,time_format:s,...e},t,n)}(e,t,i),dateFormat:o,onChangeDateFormat:e=>function(e,t,n){const i=ii();if(!i)return;const{dateValue:o,time_format:s}=i;oi({date_format:e,time_format:s,...o},t,n)}(e,t,i),timeFormat:a,onChangeTimeFormat:e=>function(e,t,n){const i=ii();if(!i)return;const{dateValue:o,date_format:s}=i;oi({date_format:s,time_format:e,...o},t,n)}(e,t,i),onDismiss:Qn().V,disabled:!1,shouldShowReminder:e,isTemplatePage:!1})})}function ii(){const e=ei().A.state;if(e.open){const{textStore:t,tokenIndex:n}=e,i=t.getValue();if(i){const e=i[n];if(e){(0,$n().MX)(b().qXl(e),"Token should be a mention token");const o=b().uPN(e),s=b().$CJ(o);if(s){const{date_format:a,time_format:r,...l}=b().K7D(s);return{textStore:t,textValue:i,tokenIndex:n,token:e,annotations:o,date_format:a,time_format:r,dateValue:l}}}}}}function oi(e,t,n){const i=ii();if(!i)return;const{textStore:o,textValue:s,tokenIndex:a,token:r,annotations:l}=i,d=l.map((t=>b().qsB(t)?["d",e]:t)),c=b().Ey_(r[0],d),u=b().AhH(s.slice(0,a)),p=b().AhH(s.slice(0,a+1));x().createAndCommit({userAction:"DateMentionMenu.setDateAnnotationData",environment:t,canUndo:!0,perform:e=>{Zn().jQ({environment:t,store:o,selection:{startIndex:u,endIndex:p},transaction:e}),Zn().yr({environment:t,store:o,tokens:[c],index:u,transaction:e}),O().default.checkGate({gateName:"mobile_clear_selection_on_date_mention_menu_change_kill_switch"})||(0,Jn().I)({environment:t})}})}n(737550);var si=()=>n(59226),ai=()=>n(852507),ri=()=>n(98126),li=()=>n(90023),di=()=>n(304740),ci=()=>n(651784),ui=()=>n(720665),pi=()=>n(437219),gi=()=>n(131581),mi=()=>n(485444);var fi=()=>n(794144),hi=()=>n(422366);const vi={quip:"Quip",evernote:"Evernote",workflowy:"Workflowy",monday:"Monday",confluence:"Confluence",trello:"Trello"},yi=[{name:vi.quip,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.quip\\.com)\\/(?<docId>[a-zA-Z0-9]+)(?:\\/(?<title>[^\\/?#]+))?\\/?(?:\\?.*)?$"}],bi=[{name:vi.evernote,attributes:[],regex:"^(?<site>https:\\/\\/www\\.evernote\\.com)\\/shard\\/(?<shardId>[^\\/]+)\\/nl\\/(?<userId>[^\\/]+)\\/(?<noteId>[a-zA-Z0-9]+)\\/?(?:.*)?$"},{name:vi.evernote,attributes:[],regex:"^(?<site>https:\\/\\/www\\.evernote\\.com)\\/client\\/web#\\?b=(?<notebookId>[^&]+)&n=(?<noteId>[^&]+)$"},{name:vi.evernote,attributes:[],regex:"^(?<site>https:\\/\\/www\\.evernote\\.com)\\/client\\/web#\\/note\\/(?<noteId>[a-f0-9-]+)(?:\\?.*)?$"}],Si=[{name:vi.workflowy,attributes:[],regex:"^(?<site>https:\\/\\/workflowy\\.com)\\/s\\/(?<shareId>[a-zA-Z0-9-_]+)\\/?(?:.*)?$"},{name:vi.workflowy,attributes:[],regex:"^(?<site>https:\\/\\/workflowy\\.com)\\/#\\/(?<nodeId>[a-zA-Z0-9-_]+)\\/?(?:.*)?$"}],xi=[{name:vi.monday,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.monday\\.com)\\/boards\\/(?<boardId>\\d+)\\/views\\/(?<viewId>\\d+)\\/?(?:.*)?$"},{name:vi.monday,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.monday\\.com)\\/boards\\/(?<boardId>\\d+)\\/?(?:.*)?$"},{name:vi.monday,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.monday\\.com)\\/items\\/(?<itemId>\\d+)\\/?(?:.*)?$"}],Ai=[{name:vi.confluence,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.atlassian\\.net)\\/wiki\\/spaces\\/(?<spaceKey>[a-zA-Z0-9_-]+)\\/pages\\/(?<pageId>\\d+)\\/(?<pageTitle>[^\\/?#]+)\\/?(?:.*)?$"},{name:vi.confluence,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.atlassian\\.net)\\/wiki\\/spaces\\/(?<spaceKey>[a-zA-Z0-9_-]+)\\/?(?:.*)?$"}],Mi=[{name:vi.trello,attributes:[],regex:"^(?<site>https:\\/\\/trello\\.com)\\/b\\/(?<boardId>[a-zA-Z0-9]+)(?:\\/(?<title>[^\\/?#]+))?\\/?(?:\\?.*)?$"}],wi={[vi.quip]:yi,[vi.evernote]:bi,[vi.workflowy]:Si,[vi.monday]:xi,[vi.confluence]:Ai,[vi.trello]:Mi};function ji(e){if(!e||"string"!=typeof e)return{type:"failure"};for(const[t,n]of Object.entries(wi))for(const i of n)if(new RegExp(i.regex).test(e)&&ki(t))return{type:"success",importName:t,pattern:i};return{type:"failure"}}function ki(e){return Object.values(vi).some((t=>t===e))}var Ii=()=>n(176106),Ci=()=>n(666803),Ti=()=>n(261358),_i=()=>n(404141),Pi=()=>n(160475),Bi=()=>n(802790),Di=()=>n(515918);const Ri=(0,q().YK)({image:{defaultMessage:"Embed image",id:"embedMenu.action.image"},video:{defaultMessage:"Embed video",id:"embedMenu.action.video"},tweet:{defaultMessage:"Embed Tweet",id:"embedMenu.action.tweet"},drive:{defaultMessage:"Embed Google Drive",id:"embedMenu.action.drive"},gist:{defaultMessage:"Embed GitHub Gist",id:"embedMenu.action.gist"},figma:{defaultMessage:"Embed Figma",id:"embedMenu.action.figma"},invision:{defaultMessage:"Embed Invision project",id:"embedMenu.action.invision"},abstract:{defaultMessage:"Embed Abstract project",id:"embedMenu.action.abstract"},framer:{defaultMessage:"Embed Framer prototype",id:"embedMenu.action.framer"},whimsical:{defaultMessage:"Embed Whimsical board",id:"embedMenu.action.whimsical"},mixpanel:{defaultMessage:"Embed Mixpanel project",id:"embedMenu.action.mixpanel"},sketch:{defaultMessage:"Embed Sketch document",id:"embedMenu.action.sketch"},excalidraw:{defaultMessage:"Embed Excalidraw",id:"embedMenu.action.excalidraw"},replit:{defaultMessage:"Embed a repl",id:"embedMenu.action.replit"},miro:{defaultMessage:"Embed Miro board",id:"embedMenu.action.miro"},audio:{defaultMessage:"Embed audio",id:"embedMenu.action.audio"},maps:{defaultMessage:"Embed Google Maps",id:"embedMenu.action.maps"},loom:{defaultMessage:"Embed Loom",id:"embedMenu.action.loom"},typeform:{defaultMessage:"Embed Typeform",id:"embedMenu.action.typeform"},codepen:{defaultMessage:"Embed CodePen",id:"embedMenu.action.codepen"},pdf:{defaultMessage:"Embed PDF",id:"embedMenu.action.pdf"},embed:{defaultMessage:"Embed",id:"embedMenu.action.createEmbed"},hex:{defaultMessage:"Embed Hex",id:"embedMenu.action.hex"},deepnote:{defaultMessage:"Embed Deepnote",id:"embedMenu.action.deepnote"},drawing:{defaultMessage:"Embed a drawing",id:"embedMenu.action.drawing"}}),Ei=(0,q().YK)({mentionBlock:{defaultMessage:"Mention",id:"embedMenu.actions.mentionBlock.title"},createLinkedViewOfDatabase:{defaultMessage:"Linked database view",id:"embedMenu.actions.createLinkedViewOfDatabase.title"},bookmarkMenuItem:{defaultMessage:"Bookmark",id:"embedMenu.actions.createBookmark.title"},newBookmarkMenuItem:{defaultMessage:"Preview",id:"embedMenu.actions.createNewBookmark.title"},createTransclusionItem:{defaultMessage:"Synced block",id:"embedMenu.actions.createTransclusion.title"},dismissItem:{defaultMessage:"URL",id:"embedMenu.actions.dismiss.title"},linkMention:{defaultMessage:"Mention",id:"embedMenu.actions.linkMention.title"},embed:{defaultMessage:"Embed",id:"embedMenu.actions.embed.title"}}),Li="3rd party import section",Oi={image:rn().A.formatMessage(Ri.image),video:rn().A.formatMessage(Ri.video),tweet:rn().A.formatMessage(Ri.tweet),drive:rn().A.formatMessage(Ri.drive),gist:rn().A.formatMessage(Ri.gist),figma:rn().A.formatMessage(Ri.figma),invision:rn().A.formatMessage(Ri.invision),abstract:rn().A.formatMessage(Ri.abstract),framer:rn().A.formatMessage(Ri.framer),whimsical:rn().A.formatMessage(Ri.whimsical),mixpanel:rn().A.formatMessage(Ri.mixpanel),miro:rn().A.formatMessage(Ri.miro),sketch:rn().A.formatMessage(Ri.sketch),excalidraw:rn().A.formatMessage(Ri.excalidraw),replit:rn().A.formatMessage(Ri.replit),audio:rn().A.formatMessage(Ri.audio),maps:rn().A.formatMessage(Ri.maps),loom:rn().A.formatMessage(Ri.loom),typeform:rn().A.formatMessage(Ri.typeform),codepen:rn().A.formatMessage(Ri.codepen),pdf:rn().A.formatMessage(Ri.pdf),embed:rn().A.formatMessage(Ri.embed),hex:rn().A.formatMessage(Ri.hex),deepnote:rn().A.formatMessage(Ri.deepnote),drawing:rn().A.formatMessage(Ri.drawing)};const Ni=function(){const e=(0,s().v3)(),t=(0,s().Y0)(),n=(0,v().O$)(Ii().A);return(0,B.jsx)(M().Ay,{popupType:t.isMobileNative&&!t.isTablet?y().n.SlideUp:y().n.Popup,open:n.open,originRect:n.open?n.selectionRect:void 0,placementToOrigin:"bottom",alignmentToOrigin:"start",originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:N().A.isMobile,keepFocus:N().A.isMobile,render:()=>n.loading?(0,B.jsx)(ri().k,{}):(0,B.jsx)(Gi,{}),onDismiss:()=>Fi(e)})};function Fi(e){const t=Ii().A.state;if(!t.open)return;const{url:n}=t;pi().ol(e,{url:n,type:"close"}),(0,Ii().V)()}function Ui({environment:e,importType:t,isImportGateEnabled:n}){return n?{key:Li,render:e=>(0,B.jsx)(gn().A,{...e}),items:[{key:"import",render:n=>(0,B.jsx)(zi,{environment:e,importType:t,menuItemProps:n}),action:()=>function(e,t){let n;(0,Pi().t)({environment:e,action:"click",from:"paste_link"}),t&&(n=function(e){switch(e){case"Evernote":return"evernote";case"Monday":return"monday";case"Confluence":return"confluence";case"Trello":return"trello";case"Workflowy":return"workflowy";case"Quip":return"quip";default:return}}(t)),_i().A.setState({..._i().A.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:n,openedFrom:"link_paste"}),(0,Ii().V)()}(e,t)}]}:null}function zi({environment:e,importType:t,menuItemProps:n}){return(0,ai().w)((()=>{(0,Pi().t)({environment:e,action:"view",from:"paste_link"})})),(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(Bi().A,{size:4}),(0,B.jsx)(un().A,{...n,title:(0,B.jsx)(q().sA,{id:"embedMenu.actions.import.title",defaultMessage:"Import from {importType}",values:{importType:t}})})]})}const Ki=["youtube.com","youtu.be","instagram.com","twitter.com","x.com","facebook.com","linkedin.com","pinterest.com","tiktok.com","spotify.com","maps.google.com","drive.google.com","docs.google.com","slides.google.com","sheets.google.com","forms.google.com","indify.co","open.spotify.com","music.youtube.com","figma.com","amazon","wikipedia.org","medium.com","naver.com","canva.com","miro.com","reddit.com","calendly.com","forms.gle"];function Vi(e){var t;const{environment:n,url:i,textStore:o}=e,s=[],a=o.getRecordStoreUIParent(),r=null===(t=(0,Ti().aP)(o))||void 0===t?void 0:t.getSpaceStore(),l=gi().en(o),d=function(e){if(!(e instanceof xn().B))return!1;const t=e.getType();return!!t&&(0,Mt().IU)(t,e.getFormat())}(a),c=(0,ci().parseRoute)({url:i,baseUrl:N().A.domainBaseUrl,publicDomainName:N().A.publicDomainName,isMobile:N().A.isMobile||!1,protocol:N().A.protocol,currentUrl:window.location.href}),u=(0,ci().WZ)(c),p="page"===c.name?c.blockId:u?c.peekViewBlockId:void 0,g=void 0!==p,m="collection"===c.name;if(u&&!g&&!m)return[];if(g){const e=xn().B.createChildStore(o,{table:yn().ev,id:p}),t=function(e){const t=e.getSystemBlockTypeStore().getValue();return!(0,li().xm)(t)}(e);t&&s.push({name:rn().A.formatMessage(Ei.mentionBlock),type:"mention-page"});const n="page"===c.name&&c.scrollToBlockId,i=n?xn().B.createChildStore(o,{table:yn().ev,id:n}):void 0,a=(null==r?void 0:r.id)===e.getSpaceId();e.isType("form")&&!l&&d&&a&&s.push({name:rn().A.formatMessage(Ei.embed),type:Mt().xd.form});const u=e.isCollectionView(),g="page"===c.name?c.collectionViewId:void 0;i||!u||l||e.isCollectionViewPageWithContent()&&function(e,t){const n=e.getCollectionViewStores(),i=W().I6(n,(e=>e.id===t&&"page"===e.getType()));return Boolean(i)}(e,g)||function(e,t){const n=e.getCollectionViewStores(),i=W().I6(n,(e=>e.id===t&&"form_editor"===e.getType()));return Boolean(i)}(e,g)||!a||!d||!t||s.push({name:rn().A.formatMessage(Ei.createLinkedViewOfDatabase),type:Mt().xd.collectionView}),null==i||!i.canEdit()||i.isNavigableBlock()||l||i.isNonEditableState()||i.isNavigableAncestorNonEditableState()||function(e){const t=e.getParentBlockStore();return!(null==t||!t.isTranscriptionBlock())&&t.getContentIds().includes(e.id)}(i)||i.getSpaceId()!==(null==r?void 0:r.id)||!d||!t||s.push({name:rn().A.formatMessage(Ei.createTransclusionItem),type:"create-transclusion"})}else m?(s.push({name:rn().A.formatMessage(Ei.mentionBlock),type:"mention-page"}),s.push({name:rn().A.formatMessage(Ei.createLinkedViewOfDatabase),type:Mt().xd.collectionView})):s.push({name:rn().A.formatMessage(Ei.linkMention),type:"link-mention"});const f={url:i,baseUrl:N().A.domainBaseUrl,publicDomainName:N().A.publicDomainName},h=ui().HP(Oi);for(const b of h)"embed"!==b&&d&&di().dA[b](f)&&s.push({name:Oi[b],type:b});if(!l&&d&&di().Vp(f)&&s.push({name:rn().A.formatMessage(Ei.bookmarkMenuItem),type:Mt().xd.bookmark}),!l&&!m&&d&&di().dA.embed(f)&&s.push({name:Oi.embed,type:"embed"}),0===s.length)return[];const v=s.map((({name:e,type:t})=>({key:`embed ${e}`,render:t=>(0,B.jsx)(un().A,{...t,title:e}),action:()=>function(e,t,n){const i=Ii().A.state;if(!i.open)return;const{url:o}=i;gi().Ju({environment:t,type:e,spaceId:n}),"form"!==e&&pi().ol(t,{url:o,type:e})}(t,n,null==r?void 0:r.id)}))),y={key:"dismiss",render:e=>(0,B.jsx)(un().A,{...e,title:rn().A.formatMessage(Ei.dismissItem)}),action:()=>Fi(n)};return(0,ci().Jx)(c)||m||Wi(i,Ki)?v.push(y):v.splice(1,0,y),v}function qi(e,t,n){const{url:i,textStore:o}=e,s=Vi({environment:t,url:i,textStore:o});if(0===s.length)return[];const a={key:"embed section",render:e=>(0,B.jsx)(gn().A,{...e}),items:s},r={key:"import section",render:e=>(0,B.jsx)(gn().A,{...e,style:{paddingTop:0,paddingBottom:6}}),items:[{key:"jira-sync",render:e=>(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(Bi().A,{size:4}),(0,B.jsx)(un().A,{...e,title:(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(q().sA,{id:"embedMenu.actions.import.jiraTitle",defaultMessage:"Sync Jira projects and issues"}),(0,B.jsx)(Di().A,{style:{display:"inline"}})]})})]}),action:()=>function(e){var t,n;const i=Ii().A.state;if(!i.open)return;const{url:o}=i,s=ae().default.state.mainEditorCurrentBlockStore,a=s&&(null===(t=(0,hi().U)(s))||void 0===t?void 0:t.id),r=null===(n=o.match(/\/projects\/(\w+)\//))||void 0===n?void 0:n[1];Ci().Ay.setState({...Ci().Ay.state,teamSpaceId:a,projectKeys:r?[r]:[]}),mi().j({environment:e,from:"external_object_instance_block",action:"show_teamspaces"}),(0,zt().u)({environment:e,event:{eventName:"external_sync_entry_point",eventProperties:{integration:"jira",flowId:Ci().Ay.createNewFlowId(),from:"link_paste_menu"}}}),(0,Ii().V)(),pi().ol(e,{url:o,type:"jira-sync"})}(t)}]},l=ji(i),d="success"===l.type?l.importName:void 0,c=Ui({environment:t,importType:d,isImportGateEnabled:n});return Wi(i,["atlassian.net/jira","/jira/"])?[a,r]:n&&function(e){return"success"===ji(e).type}(i)&&c?[a,c]:[a]}function Wi(e,t){return t.some((t=>e.includes(t)))}function Gi(){const e=(0,s().v3)(),t=(0,si().X)("contextualized_import_entrypoints"),n=(0,v().K8)((()=>{const n=Ii().A.state;return n.open?qi(n,e,t):null}),[e,t]),o=(0,v().K8)((()=>!!Ii().A.state.loading),[]);(0,i.useEffect)((()=>{const e=(null==n?void 0:n.length)??0;o||0!==e||(0,Ii().V)()}),[n,o]),function(){const e=(0,v().O$)(Ii().A),t=(0,v().O$)(T().default);(0,i.useEffect)((()=>{if(e.open&&"editing"===t.mode){const{multiSelection:n}=t;(0,fi().K)(n)&&n.start.store.id===e.textStore.id&&n.end.index===e.urlSelection.endIndex||(0,Ii().V)()}}),[e,t])}();const a=(0,Ye().IS)((e=>({header:N().A.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:Ze().Wy.semibold,background:e.background.secondary,height:45}:{paddingInlineStart:12,paddingInlineEnd:12,paddingTop:10,paddingBottom:4,color:e.text.secondary,fontSize:Ze().J.UISmall.desktop,fontWeight:450,fontStyle:"normal",font:"SF Pro"}})),[]);if(null===n)return null;let r;return r=N().A.isMobile?{menuType:w().gu.ActionSheet}:{menuType:w().gu.Popup,width:n.some((e=>e.key===Li))?270:n.some((e=>"import section"===e.key))?260:200,maxHeight:"40vh"},o?(0,B.jsx)(ri().A,{style:{marginInlineStart:3,marginInlineEnd:3}}):(0,B.jsx)(A().A,{...r,className:sn().poM,header:(0,B.jsx)(kn().A,{style:a.header,isSmall:!N().A.isMobile,isSecondaryColor:!N().A.isMobile,children:(0,B.jsx)(q().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,B.jsx)(pn().Ay,{type:pn().Oh.Vertical,sections:n,initialFocus:0})})}var Hi=()=>n(949237),Yi=()=>n(152197),$i=()=>n(523713);function Qi(){const e=(0,s().v3)(),t=e.currentUser.id,n=(0,Yi().r)(),o=(0,v().K8)((()=>(0,$i().x)({isPhone:e.device.isPhone,spaceStore:ae().default.state.sidebarSpaceStore})),[e.device]);return(0,i.useEffect)((()=>{if(!n||!t||!o)return;const i=te().Ay.addListener((0,K().DZ)({notionUserId:t,spaceId:n}),void 0,(0,te().AY)((({version:t})=>{-1!==t&&Zi(e)})),void 0,e);return function(){i&&te().Ay.removeListener(i,e)}}),[e,t,n,o]),null}const Zi=(0,W().sg)((e=>{Hi().oX({environment:e})}),5e3,{leading:!0,trailing:!0});var Ji=()=>n(205262),Xi=()=>n(908006),eo=()=>n(631524),to=()=>n(522419),no=()=>n(340498);const io={viewBox:"0 0 20 20",fittedViewBox:"3.23 3.23 13.54 13.54",svg:(0,B.jsx)("path",{d:"M7.491 8.375 3.418 4.302a.625.625 0 0 1 .884-.884L8.375 7.49V4a.625.625 0 0 1 1.25 0v5c0 .345-.28.625-.625.625H4a.625.625 0 1 1 0-1.25zm4.137 4.137v3.491a.625.625 0 1 1-1.25 0v-5c0-.345.28-.625.625-.625h5a.625.625 0 1 1 0 1.25h-3.491l4.07 4.07a.625.625 0 0 1-.884.884z"})},oo=(0,no().wt)("arrowCollapse",io);var so=()=>n(973238),ao=()=>n(526278),ro=()=>n(940563),lo=()=>n(236190),co=()=>n(617668),uo=()=>n(343666),po=()=>n(100622),go=()=>n(124952),mo=()=>n(161773),fo=()=>n(35622),ho=()=>n(391214),vo=()=>n(569912),yo=()=>n(129522),bo=()=>n(640867),So=()=>n(145214);const xo={background:"rgba(255, 255, 255, 0.055)"},Ao={padding:"6px 10px 6px 6px"},Mo={padding:"6px 6px 6px 10px"},wo={display:"flex",borderRadius:4,background:po().IF.blackWithAlpha(.65)},jo=.5,ko=.5,Io=2,Co=-.002,To=-.004;function _o({visible:e,isOpen:t,zoomScale:n,handleZoomIn:i,handleZoomOut:o,handleNext:a,handlePrevious:r,setZoomScale:l,disableZoomEditing:d,enableZoomEditing:c,resetHideControlsTimeout:u,clearHideControlsTimeout:p,isSaving:g,isEditingZoom:m,handleClose:f}){const h=(0,s().Y0)(),y=(0,s().v3)(),{blockStore:S,imageUrl:x}=(0,v().K8)((()=>({blockStore:bo().A.state.blockStore,imageUrl:bo().A.state.imageUrl})),[]),A=(0,v().K8)((()=>{var e;return Boolean(S&&(x||(null===(e=S.getProperties())||void 0===e?void 0:e.source)&&b().q4_(S.getProperties().source)))}),[S,x]);if(h.isMobile)return null;return(0,B.jsxs)(So().A,{visible:e,initial:{opacity:1},exit:{opacity:0},animate:{opacity:1},style:Fo(t),onClick:e=>{!function(e){e.stopPropagation()}(e),u(),d()},children:[(0,B.jsx)("div",{style:{...wo,marginInlineEnd:10},children:(0,B.jsx)(Bo,{handlePrevious:r,handleNext:a})}),(0,B.jsxs)("div",{style:wo,children:[(0,B.jsx)(Po,{zoomScale:n,handleZoomIn:i,handleZoomOut:o,setZoomScale:l,disableZoomEditing:d,enableZoomEditing:c,isEditingZoom:m}),(0,B.jsx)(qo,{}),A?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(Do,{onClick:()=>{if(!S||!A)return;bo().A.setState({...bo().A.state,isSaving:!0}),p();const e=null==S?void 0:S.getProperties();let t,n;if(t=x||b().q4_(null==e?void 0:e.source),t){if((0,to()._J)(t)){const i=b().q4_(null==e?void 0:e.title)||(0,to().Jt)(t);n=mo().KE(y,{url:t,download:!0,downloadName:i,permissionRecord:S.pointer})}else{const i=b().q4_(null==e?void 0:e.caption);n=(0,to().pJ)(t,null==S?void 0:S.pointer,N().A.domainBaseUrl,y.currentUser.id,i)}n.then((()=>{bo().A.setState({...bo().A.state,isSaving:!1}),(0,go().d)(y,{type:"download",triggered_by:"click"}),u()}))}},loading:g}),(0,B.jsx)(qo,{})]}):void 0,(0,B.jsx)(Ro,{onClick:f})]})]})}function Po({zoomScale:e,handleZoomIn:t,handleZoomOut:n,setZoomScale:o,disableZoomEditing:a,enableZoomEditing:r,isEditingZoom:l}){const d=(100*e).toFixed(0),c=(0,s().v3)(),u=(0,i.useCallback)((e=>{const t=e.target,n=parseInt(t.value);if(!isNaN(n)){const e=n/100;(0,go().d)(c,{type:"set_zoom",new_zoom:e}),o(e)}a()}),[a,c,o]);return(0,B.jsxs)("div",{style:{alignItems:"center",display:"flex",height:"100%",justifySelf:"flex-start"},children:[(0,B.jsx)(rt().A,{renderTooltip:()=>(0,B.jsx)(Vo,{primaryText:(0,B.jsx)(q().sA,{id:"fullScreenRenderer.zoomOut",defaultMessage:"Zoom out"}),secondaryText:"-"}),disableTooltip:e<=ko,render:t=>(0,B.jsx)(eo().p,{...t,disabled:e<=ko,style:{...zo(e<=ko),...Mo},onClick:n,iconLeading:{icon:lo().c,size:"sm",colorVariant:"inversePrimary"}})}),l?(0,B.jsx)(Eo,{initialValue:d,onSubmit:u,onCancel:a,primaryColor:po().Tj.white,secondaryColor:Uo()}):(0,B.jsx)(eo().p,{onClick:e=>{e.stopPropagation(),r()},style:{color:Uo(),margin:0,width:46,padding:0,justifyContent:"center"},children:`${d}%`}),(0,B.jsx)(rt().A,{renderTooltip:()=>(0,B.jsx)(Vo,{primaryText:(0,B.jsx)(q().sA,{id:"fullScreenRenderer.zoomIn",defaultMessage:"Zoom in"}),secondaryText:"+"}),disableTooltip:e>=Io,render:n=>(0,B.jsx)(eo().p,{...n,disabled:e>=Io,style:zo(e>=Io),onClick:t,iconLeading:{icon:co().plusIcon,colorVariant:"inversePrimary"}})})]})}function Bo({handlePrevious:e,handleNext:t}){const n=(0,B.jsx)("div",{}),{blockStore:i,allImageBlocksOnPage:o}=(0,v().K8)((()=>{const{blockStore:e}=bo().A.state;return{blockStore:e,allImageBlocksOnPage:e?Oo():[]}}),[]);if(!i)return n;if(o.length<=1)return n;const s=o.findIndex((e=>e.id===(null==i?void 0:i.id)))??-1;if(-1===s)return n;const a=o.length;return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(rt().A,{renderTooltip:()=>(0,B.jsx)(Vo,{primaryText:(0,B.jsx)(q().sA,{id:"fullScreenRenderer.previous",defaultMessage:"Back"}),secondaryText:(0,B.jsx)(Ko,{imageIndex:s-1,totalImageCount:a})}),disableTooltip:0===s,render:t=>(0,B.jsx)(eo().p,{...t,disabled:s<=0,style:{...zo(s<=0),...Mo},hoveredStyle:xo,onClick:()=>e(),iconLeading:{icon:ao().w,colorVariant:"inversePrimary"}})}),(0,B.jsx)(rt().A,{renderTooltip:()=>(0,B.jsx)(Vo,{primaryText:(0,B.jsx)(q().sA,{id:"fullScreenRenderer.next",defaultMessage:"Next"}),secondaryText:(0,B.jsx)(Ko,{imageIndex:s+1,totalImageCount:a})}),disableTooltip:s+1===a,render:e=>(0,B.jsx)(eo().p,{...e,disabled:s>=a-1,style:{...zo(s>=a-1),...Ao},hoveredStyle:xo,onClick:()=>t(),iconLeading:{icon:ro().arrowStraightRightIcon,colorVariant:"inversePrimary"}})})]})}function Do({onClick:e,loading:t}){return(0,B.jsx)(rt().A,{renderTooltip:()=>(0,B.jsx)(Vo,{primaryText:(0,B.jsx)(q().sA,{id:"fullScreenRenderer.download",defaultMessage:"Download"})}),render:n=>(0,B.jsx)(eo().p,{...n,disabled:t,onClick:e,style:zo(!1),hoveredStyle:xo,iconLeading:t?void 0:{icon:so().arrowInCircleDownIcon,colorVariant:"inversePrimary"},isLoading:t})})}function Ro({onClick:e}){return(0,B.jsx)(rt().A,{renderTooltip:()=>(0,B.jsx)(Vo,{primaryText:(0,B.jsx)(q().sA,{defaultMessage:"Close",id:"fullscreenRenderer.closeButton.label"}),secondaryText:"esc"}),render:t=>(0,B.jsx)(eo().p,{...t,onClick:e,style:{...zo(!1),...Ao},hoveredStyle:xo,iconLeading:{icon:oo,colorVariant:"inversePrimary"}})})}function Eo(e){const[t,n]=(0,i.useState)(e.initialValue);return(0,B.jsx)(jn().A,{style:{width:46,color:e.primaryColor},inputStyle:{textAlign:"center",border:"solid 1px rgba(45, 156, 219, 0.72)",borderRadius:4,boxShadow:"0px 0px 0px 3px rgba(45, 156, 219, 0.2)"},onClick:e=>e.stopPropagation(),onChange:e=>{const t=e.target;n(t.value)},value:t,onSubmit:e.onSubmit,focusInitial:!0,selectAll:!0,format:jn().C.Transparent,right:(0,B.jsx)("span",{style:{color:e.secondaryColor},children:"%"}),onKeyDown:t=>{t.stopPropagation(),"Escape"===t.key?e.onCancel():"Tab"===t.key&&e.onSubmit(t)}})}const Lo=function(){const e=(0,s().v3)(),t=(0,i.useRef)(!1),o=(0,i.useRef)(),a=(0,i.useRef)(),[r,l]=(0,i.useState)(!1),[d,c]=(0,i.useState)(void 0),[u,p]=(0,i.useState)(!1),{isOpen:g,rendered:m,fullScreenNodeRect:f,fullscreenNodeAnimationComplete:h,contentAspectRatio:y,zoomScale:b,panOffset:S,skipAnimations:x,isSaving:A,blockStore:M,panStartPosition:w}=(0,v().K8)((()=>{var e;const{state:t}=bo().A;return{isOpen:t.isOpen,rendered:null===(e=t.renderFullScreenNode)||void 0===e?void 0:e.call(t),fullScreenNodeRect:t.fullScreenNodeRect,fullscreenNodeAnimationComplete:t.fullscreenNodeAnimationComplete,contentAspectRatio:t.contentAspectRatio,zoomScale:t.zoomScale,panOffset:t.panOffset,skipAnimations:t.skipAnimations,isSaving:Boolean(t.isSaving),blockStore:t.blockStore,panStartPosition:t.panStartPosition}}),[]),j=(0,v().K8)((()=>{const t=e.WindowSizeStore.state.width;return fo().wX(t)}),[e.WindowSizeStore]);(0,n(388487).A)({capture:g,preventType:xt().A.All});const k=(0,i.useCallback)((()=>{o.current&&clearTimeout(o.current)}),[]),I=(0,i.useCallback)((()=>{p(!0),k(),r||A||(o.current=setTimeout((()=>p(!1)),2e3))}),[k,r,A]),C=(0,i.useCallback)((e=>{I();const t=Math.max(Math.min(e,Io),ko),n=t<=1?{x:0,y:0}:S;bo().A.setState({...bo().A.state,zoomScale:t,panOffset:n})}),[S,I]),T=(0,i.useCallback)((e=>{const t=Yo(e,d);t&&(e.x!==t.x&&(w.x=w.x+(e.x-t.x)),e.y!==t.y&&(w.y=w.y+(e.y-t.y)),bo().A.setState({...bo().A.state,panOffset:t,panStartPosition:w}))}),[d,w]),_=(0,i.useCallback)((()=>{l(!1),bo().A.setState({...bo().A.state,zoomScale:1,panStartPosition:{x:0,y:0},panOffset:{x:0,y:0}})}),[]),P=(0,i.useCallback)((()=>{l(!0),k()}),[k]),D=(0,i.useCallback)((()=>{l(!1),I()}),[I]),R=(0,i.useCallback)(((t=!1)=>{fo().VN(),(0,go().d)(e,{type:"close",triggered_by:t?"keypress":"click"}),tt().IU({environment:e}),Ho(),Xi().default.afterNextFlush((()=>{_()}))}),[e,_]),E=(0,i.useCallback)((e=>{(0,Ji().V)(e)||R()}),[R]),L=(0,i.useCallback)((e=>{if(e.stopPropagation(),(0,Ji().V)(e))return;let t,n;t=b<1?1:b<1.5?1.5:1,n=t<=1?{x:0,y:0}:Yo({x:(window.innerWidth/2-e.clientX)/(t/(t-1)),y:(window.innerHeight/2-e.clientY)/(t/(t-1))},d)??S,bo().A.setState({...bo().A.state,zoomScale:t,panOffset:n}),I(),D()}),[d,D,S,I,b]),O=(0,i.useCallback)(((t,n=!1)=>{if(!M)return;const i=Oo();if(!i)return;const o=i.findIndex((e=>e.id===M.id));if(o+t<0||o+t>=i.length)return;(0,go().d)(e,{type:t>0?"next":"previous",image_count:i.length,image_index:o+t,triggered_by:n?"keypress":"click"}),bo().A.setState({...bo().A.state,skipAnimations:!0}),a.current&&clearTimeout(a.current),a.current=setTimeout((()=>{bo().A.setState({...bo().A.state,skipAnimations:!1})}),250);const s=i[o+t];ho().iy({environment:e,blockStore:s}),_()}),[M,e,_]),N=(0,i.useCallback)(((e=!1)=>{O(-1,e)}),[O]),F=(0,i.useCallback)(((e=!1)=>{O(1,e)}),[O]),U=(0,i.useCallback)(((t=!1)=>{let n=Math.ceil(2*(b-jo))/2;b-n<.25&&(n-=jo),(0,go().d)(e,{type:"zoom_out",new_zoom:n,triggered_by:t?"keypress":"click"}),C(n)}),[e,C,b]),z=(0,i.useCallback)(((t=!1)=>{let n=Math.floor(2*(b+jo))/2;n-b<.25&&(n+=jo),(0,go().d)(e,{type:"zoom_in",new_zoom:n,triggered_by:t?"keypress":"click"}),C(n)}),[e,C,b]),K=(0,i.useCallback)((e=>{d&&1===e.buttons&&No()&&T({x:e.clientX/b-w.x,y:e.clientY/b-w.y})}),[d,w.x,w.y,T,b]),V=(0,i.useCallback)((e=>{switch(e.key){case"+":case"=":z(!0);break;case"-":case"_":U(!0)}}),[z,U]);(0,i.useEffect)((()=>{const e=e=>{C(b+e)},n=t=>{g&&(t.preventDefault(),t.ctrlKey?t.deltaY?e(t.deltaY*To):t.deltaX&&e(t.deltaX*To):t.metaKey?t.deltaY?e(t.deltaY*Co):t.deltaX&&e(t.deltaX*Co):No()&&T({x:S.x-t.deltaX,y:S.y-t.deltaY}))};return g&&(window.addEventListener("wheel",n,{passive:!1}),t.current=!0),()=>{window.removeEventListener("wheel",n),t.current=!1}}),[g,S.x,S.y,T,C,b]);const q=window.innerWidth,G=window.innerHeight-2*j;let H=q-2*j;const Y=y??(f?f.width/f.height:void 0);if(void 0===Y)return null;let $=H/Y;if($>G){const e=$/G;$/=e,H/=e}const Q={opacity:0},Z={scale:b,opacity:1,translateX:S.x,translateY:S.y,width:"100%",height:"100%"};let J;return J=u?b>=1.5?"zoom-out":"zoom-in":"none",(0,B.jsx)(_n().hJ,{open:g||!h,children:(0,vo().A)((e=>(0,B.jsx)(At().N,{debugName:"FullScreenRenderer",capture:g,onEsc:()=>{R(!0)},onEnter:W().D_,onSpace:()=>R(!0),onCommandEnter:()=>R(!0),onCommandShiftEnter:W().D_,onCommandSlash:W().D_,onUp:W().D_,onDown:W().D_,onDelete:W().D_,onBackspace:W().D_,onLeft:()=>N(!0),onRight:()=>F(!0),onUntab:W().D_,onTab:W().D_,onSelectAll:W().D_,onRedo:W().D_,onUndo:W().D_,onToggleBold:W().D_,onToggleItalics:W().D_,onToggleStrike:W().D_,onToggleCode:W().D_,onCut:W().D_,onCopy:W().D_,onPaste:W().D_,onKeypress:V,children:(0,B.jsxs)("div",{style:$o({isOpen:g,showControls:u}),...e,onClick:E,onMouseMove:I,children:[g?(0,B.jsx)(n(552713).B,{}):void 0,(0,B.jsx)(So().A,{visible:g,initial:Q,exit:Q,animate:Z,skip:x,forceCompositeLayer:!0,style:{display:"flex",cursor:J,maxWidth:H,maxHeight:$,justifyContent:"center"},ref:e=>{e&&!d&&c({width:e.clientWidth,height:e.clientHeight})},onClick:L,onMouseDown:Go,onMouseUp:Ho,onMouseLeave:Ho,onMouseMove:K,onAnimationEnd:Wo,children:m}),(0,B.jsx)(_o,{visible:u,isOpen:g,zoomScale:b,handleZoomIn:z,handleZoomOut:U,handlePrevious:N,handleNext:F,setZoomScale:C,disableZoomEditing:D,enableZoomEditing:P,clearHideControlsTimeout:k,resetHideControlsTimeout:I,isSaving:A,isEditingZoom:r,handleClose:R})]})})))})};function Oo(){const{blockStore:e}=bo().A.state;if(!e)return[];if(function(){const{blockStore:e}=bo().A.state;return(null==e?void 0:e.getParentTable())===uo().SN}()){return e.getParentStore().getContentStores().filter((e=>"image"===e.getType())).filter((e=>Boolean(e.getProperties().source)))}const t=cn().default.getCurrentRootStore();return yo().K.getMembersByDOMOrder({filter:e=>"image"===e.renderedType&&Boolean(e.getBlockStore().findRecordStoreUIAncestor((e=>Boolean(t&&e===t))).ancestor)}).map((e=>e.getBlockStore())).filter((e=>Boolean(e.getProperties().source)))}function No(){const{zoomScale:e}=bo().A.state;return e>1}function Fo(e){return{bottom:30,display:e?"flex":"none",fontSize:14,insetInlineStart:"50%",lineHeight:1.2,position:"absolute",transform:"translate(-50%, 0)"}}function Uo(){return po().IF.whiteWithAlpha(.5)}function zo(e){return{borderRadius:4,opacity:e?.4:1,padding:6}}function Ko({imageIndex:e,totalImageCount:t}){return(0,B.jsx)(q().sA,{values:{currentIndex:e+1,totalCount:t},defaultMessage:"{currentIndex} of {totalCount}",id:"fullscreenRenderer.imageCount.label"})}function Vo(e){const{primaryText:t,secondaryText:n}=e;return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)("span",{style:{marginInlineEnd:n?4:void 0},children:t}),n?(0,B.jsx)("span",{style:{color:Uo()},children:n}):void 0]})}function qo(){return(0,B.jsx)("span",{style:{borderInlineStart:`1px solid ${po().IF.whiteWithAlpha(.25)}`,height:"100%"}})}function Wo(){const{isOpen:e}=bo().A.state;e||bo().A.setState({...bo().A.state,fullscreenNodeAnimationComplete:!0})}function Go(e){const{panOffset:t,zoomScale:n}=bo().A.state;bo().A.setState({...bo().A.state,panStartPosition:{x:e.clientX/n-t.x,y:e.clientY/n-t.y},skipAnimations:!0})}function Ho(){bo().A.setState({...bo().A.state,skipAnimations:!1})}function Yo(e,t){if(!t)return;let n,i;n=t.width*Io>window.innerWidth?(t.width*Io-window.innerWidth)/(2*Io):(window.innerWidth-t.width*Io)/(2*Io),i=t.height*Io>window.innerHeight?(t.height*Io-window.innerHeight)/(2*Io):(window.innerHeight-t.height*Io)/(2*Io);return{x:Math.min(Math.max(e.x,-1*n),n),y:Math.min(Math.max(e.y,-1*i),i)}}function $o(e){const{isOpen:t,showControls:n}=e;return{zIndex:999,position:"fixed",top:0,insetInlineStart:0,insetInlineEnd:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:t?"auto":"none",cursor:n?void 0:"none"}}var Qo=()=>n(834974),Zo=()=>n(448619),Jo=()=>n(792002),Xo=()=>n(569777);const es=function(){const e=(0,s().v3)(),t=(0,i.useRef)(null),o=(0,i.useCallback)((n=>function(e,t,n){if(!Xo().A.isOpen())return;if(!n.current)return;const i=n.current.getSelection();if(!i)return;const o=Xo().A.state.value.length;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&i.startIndex===o&&i.endIndex===o&&(is(t),Zo().IV())}(n,e,t)),[e]),a=(0,i.useCallback)((n=>function(e,t,n){if(!n.current)return;const i=n.current.getSelection();if(!i)return;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&0===i.startIndex&&0===i.endIndex&&(is(t),Zo().IV(Xo().q.Backward))}(n,e,t)),[e]),r=(0,i.useCallback)((()=>is(e)),[e]),l=(0,v().O$)(Xo().A),d=(0,v().K8)((()=>function(){if(!Xo().A.isOpen())return;return Xo().A.state.savedTextSelectionRect}()),[]),c=(0,v().K8)((()=>function(){var e;if("editing"!==T().default.state.mode&&!Xo().A.isOpen())return!0;const t=Xo().A.isOpen()?null===(e=(0,j().H)(Xo().A.state.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store:void 0;if(t&&!t.canEdit())return!0;if(t){const e=(0,Sn().TL)(t);if(e&&e.isNonEditableState())return!0}const n={[b().Ifu.User]:b().Ifu.User,[b().Ifu.Page]:b().Ifu.Page,[b().Ifu.Collection]:b().Ifu.Collection,[b().Ifu.CustomEmoji]:b().Ifu.CustomEmoji,[b().Ifu.Comment]:b().Ifu.Comment,[b().Ifu.Bot]:b().Ifu.Bot,[b().Ifu.Date]:b().Ifu.Date,[b().Ifu.ExternalObjectInstance]:b().Ifu.ExternalObjectInstance,[b().Ifu.TemporaryPage]:b().Ifu.TemporaryPage,[b().Ifu.TemporaryCollection]:b().Ifu.TemporaryCollection,[b().Ifu.TemplateVariable]:b().Ifu.TemplateVariable,[b().Ifu.FormulaPageProperty]:b().Ifu.FormulaPageProperty,[b().Ifu.FormulaContextValue]:b().Ifu.FormulaContextValue,[b().Ifu.Group]:b().Ifu.Group,[b().Ifu.Team]:b().Ifu.Team,[b().Ifu.Citation]:b().Ifu.Citation,[b().Ifu.TemporaryCitation]:b().Ifu.TemporaryCitation,[b().Ifu.LinkMention]:b().Ifu.LinkMention,[b().Ifu.AssistantInstructionsCollection]:b().Ifu.AssistantInstructionsCollection,[b().Ifu.Place]:b().Ifu.Place,[b().Ifu.SlackSpecialMention]:b().Ifu.SlackSpecialMention,[b().Ifu.TemporarySearchFilter]:b().Ifu.TemporarySearchFilter,[b().Ifu.TitleOnly]:b().Ifu.TitleOnly,[b().Ifu.Sort]:b().Ifu.Sort,[b().Ifu.SearchFilterCreatedTime]:b().Ifu.SearchFilterCreatedTime,[b().Ifu.SearchFilterLastEditedTime]:b().Ifu.SearchFilterLastEditedTime};for(const i of Object.values(n))if((0,Jo().y_)(i))return!0;return!1}()),[]);if(!l.open)return null;const u=l.value,g=l.error;return(0,B.jsx)(p().u2,{dependency:n(354584).y,children:e=>l.open?(0,B.jsx)(n(548901).A,{Prism:e,ref:t,isOpen:!0,equationValue:u,error:g,displayMode:"inline",disabled:c,originRect:d,originGap:8,onDismiss:ns,onChange:ts,onSubmit:r,onLeft:a,onRight:o}):null})};function ts(e,t){Xo().A.isOpen()&&Xo().A.setState({...Xo().A.state,value:e,error:t})}function ns(){Zo().IV()}function is(e){x().createAndCommit({userAction:"InlineEquationOverlay.handleSubmit",environment:e,canUndo:!0,perform:t=>{Zo().t5({environment:e,equationStore:Xo().A,transaction:t})}})}var os=()=>n(813743),ss=()=>n(966080),as=()=>n(933765),rs=()=>n(487494),ls=()=>n(525112);function ds(e){switch(e){case rs().A.Preview:return(0,B.jsx)(q().sA,{id:"internalUnfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Preview"});case rs().A.Mention:return(0,B.jsx)(q().sA,{id:"internalUnfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Mention"});case rs().A.Link:return(0,B.jsx)(q().sA,{id:"internalUnfurlingMenu.actions.pasteAsLink.title",defaultMessage:"Link"});default:(0,Oe().HB)(e)}}const cs=function(){const e=(0,s().v3)(),t=(0,i.useRef)(null),[n]=(0,v().$y)(ls().A),o=(0,i.useCallback)((t=>{if(n.open){var i;if(!t)os().fS({actionType:n.focusedIndex,environment:e,commentStore:null===(i=n.args.commentStore)||void 0===i?void 0:i.state,useTempStores:!1});ls().A.setState({open:!1})}}),[e,n]),a=(0,i.useCallback)((e=>{n.open&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&o(void 0)}),[o,n.open]),r=(0,i.useCallback)((e=>{if(!n.open||!e.target)return;const i=t.current;i&&(i.contains(e.target)||o(void 0))}),[o,n.open]);(0,i.useEffect)((()=>((0,ss().P)(window,"keydown",a),(0,ss().P)(window,"mousedown",r),()=>{(0,as().O)(window,"keydown",a),(0,as().O)(window,"mousedown",r)})),[a,r]);const l=(0,i.useRef)(!1);function d(t){var i;n.open&&void 0!==t.indexGlobal&&(ls().A.setState({...n,focusedIndex:t.indexGlobal}),os().fS({actionType:t.indexGlobal,environment:e,commentStore:null===(i=n.args.commentStore)||void 0===i?void 0:i.state,useTempStores:!0}))}(0,v().K8)((()=>{var t,i;const o=(n.open&&(null===(t=n.args.commentStore)||void 0===t?void 0:t.state)&&(null===(i=n.args.commentStore.state)||void 0===i?void 0:i.isReady()))??!1;var s;o&&!l.current&&n.open&&os().fS({actionType:n.focusedIndex,environment:e,commentStore:null===(s=n.args.commentStore)||void 0===s?void 0:s.state,useTempStores:!0});l.current=o}),[e,n]);const c=(0,v().K8)((()=>e.device.isMobileNative&&!e.device.isTablet),[e]),u=e.device.isMobile;return(0,B.jsx)(M().Ay,{popupType:c?y().n.SlideUp:y().n.Popup,open:n.open,originRect:n.open?n.selectionRect:void 0,placementToOrigin:"top",alignmentToOrigin:"start",originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:u,keepFocus:u,render:function(){var i;const{device:o}=e;if(!n.open)return;const s=function(t){const{url:n,args:i}=t,o=[];o.push({title:ds(rs().A.Preview),validator:()=>!0,type:rs().A.Preview}),o.push({title:ds(rs().A.Mention),validator:()=>!0,type:rs().A.Mention}),o.push({title:ds(rs().A.Link),validator:()=>!0,type:rs().A.Link});return[{key:"menu section",render:e=>(0,B.jsx)(gn().A,{...e}),items:W().oE(o.map((({title:t,validator:o,type:s})=>{if(o({url:n,baseUrl:N().A.domainBaseUrl,publicDomainName:N().A.publicDomainName})){return{key:`item ${s}`,render:n=>(0,B.jsx)(un().A,{...n,title:t,onMouseEnter:t=>{var o;n.onMouseEnter(t),os().fS({actionType:s,environment:e,commentStore:null===(o=i.commentStore)||void 0===o?void 0:o.state,useTempStores:!0})}}),action:()=>{var t;return os().fS({actionType:s,environment:e,commentStore:null===(t=i.commentStore)||void 0===t?void 0:t.state,useTempStores:!1})}}}})))}]}(n),a=o.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:Ze().Wy.semibold,height:45}:{paddingInlineStart:12,paddingInlineEnd:12,paddingTop:10,paddingBottom:4,fontWeight:Ze().Wy.semibold};let r;return r=o.isMobile?{menuType:w().gu.ActionSheet}:{menuType:w().gu.Popup,width:200,maxHeight:"40vh"},null!==(i=n.args.commentStore)&&void 0!==i&&i.state&&n.args.commentStore.state.isReady()?(0,B.jsx)(A().A,{...r,className:sn().poM,ref:t,header:(0,B.jsx)(kn().A,{style:a,isSmall:!o.isMobile,isSecondaryColor:!o.isMobile,children:(0,B.jsx)(q().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,B.jsx)(pn().Ay,{type:pn().Oh.Vertical,sections:s,onKeyboardArrow:d,initialFocus:0,priority:1,disallowBackspace:!0})}):(0,B.jsx)(A().A,{...r,className:sn().poM,ref:t,header:(0,B.jsx)(kn().A,{style:a,isSmall:!o.isMobile,isSecondaryColor:!o.isMobile,children:(0,B.jsx)(q().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,B.jsx)(gn().A,{style:{display:"flex",justifyContent:"center"},children:(0,B.jsx)(ri().k,{})})})},onDismiss:()=>o(void 0)})};var us=()=>n(775812),ps=(n(672577),()=>n(209199)),gs=()=>n(536612),ms=()=>n(663038),fs=()=>n(691298),hs=()=>n(875497),vs=()=>n(529183),ys=()=>n(757695);class bs extends ys().Store{getInitialState(){return{formulaTypecheckContextValue:void 0}}}const Ss=bs;var xs=()=>n(375447),As=()=>n(472090),Ms=()=>n(278132),ws=()=>n(852424),js=()=>n(247331),ks=()=>n(239381),Is=()=>n(879765),Cs=()=>n(797809),Ts=()=>n(829300);var _s=()=>n(543665),Ps=()=>n(279647),Bs=()=>n(603533),Ds=()=>n(17022);class Rs extends ys().Store{getInitialState(){}}const Es=new Rs;function Ls(e){const{isFirefox:t}=(0,s().Y0)();return(0,i.useCallback)((n=>{Ds().e.withListenerIgnored((()=>{var i;const o=xs().Ay.state;if(!o.open)return;if(!n)return void o.temporaryInputData.setState(void 0);const{title:s,icon:a,allowTabCompletion:r}=n,l=e.current??"",d=s.toLowerCase().startsWith(l)?o.oldTextValue&&0!==(null===(i=o.oldTextValue)||void 0===i?void 0:i.length)?"":s.slice(l.length):"";Es.setState(r?d:void 0);const c=t?void 0:a;o.temporaryInputData.setState({prefix:o.insertionType,suffix:"[["===o.insertionType&&l.endsWith("]]")?"]]":"",completion:d,prefixIcon:c})}))}),[e,t])}const Os=(0,q().YK)({backButtonAriaLabel:{defaultMessage:"Back",id:"formulaMentionMenu.backButton.ariaLabel"},possessiveContextValueProperty:{defaultMessage:"{contextValueName}â€™s {propertyName}",id:"formulaMentionMenu.possessiveContextValueProperty.title"}}),Ns=i.memo((function(e){const{mentionMenuCurrentFormulaStore:t,queryRef:n}=e,o=(0,v().K8)((()=>(0,Bs().W)()),[]),a=(0,v().K8)((()=>{const e=t.state.formulaTypecheckContextValue;if(e&&e.kind===js().FormulaContextValueKind.ContextValue)return e}),[t]),r=function(e){const{contextValue:t,queryRef:n,setTemporaryInputData:i}=e,o=(0,s().v3)(),a=(0,q().tz)(),r=(0,v().K8)((()=>{if(!t)return;const e=function(){const e=cn().default.getCurrentRootStore();if(e&&e instanceof xn().B)return e;const{sidebarSpaceStore:t}=ae().default.state;return t||void 0}();return e?function(e,t){const n=function(e){if("block"!==e.type.type||!(0,Oe().O9)(e.type.collection))return;return e.type.collection}(t);if(!n)return;const i=_s().m.createChildStore(e,n);return i.getSchema()}(e,t):void 0}),[t]);if(!t)return[];const l=(0,ks().sM)(t),d=new Set,c=r?(0,W().oE)(Object.entries(r).map((([e,s])=>{if(s&&js().FORMULAS_SUPPORTED_COLLECTION_PROPERTY_TYPES.includes(s.type))return void 0!==(null==s?void 0:s.type)&&(0,Oe().Xk)(js().FormulaTokenSupportedBlockSystemPropertyList,null==s?void 0:s.type)&&d.add(s.type),{action:i=>{x().createAndCommit({userAction:"FormulaMentionMenu.menuItem",environment:o,canUndo:!0,perform:r=>{const d=(0,b().ESw)({contextValueId:t.id,name:(0,Ms().Nl)(a,l,s.name),property:e,valueSnapshot:"current"});Ts().Ju({annotations:[d],editorMode:"default",environment:o,mentionType:"formulaContextVariable",menuListItemAction:i,query:n.current??"",transaction:r})}})},key:`formula property ${e}`,render:e=>(e.focused&&i({allowTabCompletion:!0,icon:(0,B.jsx)(Ps().sL,{}),title:a.formatMessage(Os.possessiveContextValueProperty,{contextValueName:l,propertyName:s.name})}),(0,B.jsx)(un().A,{...e,icon:(0,B.jsx)(Fs,{children:ws().LE[s.type]({height:17,width:17})}),title:s.name}))}}))):[],u="block"===t.type.type?(0,W().oE)(Cs().BY.map((e=>{if(d.has(e))return;const s=Cs().g1(e,a);return{action:i=>{x().createAndCommit({userAction:"FormulaMentionMenu.systemProperty",environment:o,canUndo:!0,perform:r=>{const d=(0,b().ESw)({contextValueId:t.id,name:(0,Ms().Nl)(a,l,s),property:e,valueSnapshot:"current"});Ts().Ju({annotations:[d],editorMode:"default",environment:o,mentionType:"formulaContextVariable",menuListItemAction:i,query:n.current??"",transaction:r})}})},key:`system property ${e}`,render:t=>{t.focused&&i({allowTabCompletion:!0,icon:(0,B.jsx)(Ps().sL,{}),title:a.formatMessage(Os.possessiveContextValueProperty,{contextValueName:l,propertyName:s})});const n=e;return(0,B.jsx)(un().A,{...t,icon:(0,B.jsx)(Fs,{children:ws().LE[n]({height:17,width:17})}),title:s})}}}))):[];return[...c,...u]}({contextValue:a,queryRef:n,setTemporaryInputData:Ls(n)}),l=function(e){const{contextValue:t,items:n,mentionMenuCurrentFormulaStore:o}=e,s=(0,q().tz)(),a=(0,i.useCallback)((()=>{o.setState({formulaTypecheckContextValue:void 0}),xs().Ay.updateOpenState({showFormulaProperty:!1})}),[o]),r=(0,Ye().IS)((()=>({backButton:{height:20,width:20},backButtonIcon:{width:17},sectionDesktopTitle:{paddingInline:10},titleHeader:{display:"inline-flex",alignItems:"center",gap:2}})),[]);if(0===n.length||!t)return[];const l=(0,ks().sM)(t);return[{items:n,key:"formula properties section",render:e=>(0,B.jsx)(gn().A,{...e,desktopTitleStyle:r.sectionDesktopTitle,title:(0,B.jsxs)("header",{style:r.titleHeader,children:[(0,B.jsx)(at().A,{ariaLabel:s.formatMessage(Os.backButtonAriaLabel),icon:Is().$,iconStyle:r.backButtonIcon,onClick:a,style:r.backButton}),(0,B.jsx)(q().sA,{defaultMessage:"Property from {contextValueName}",id:"formulaMentionMenu.formulaPropertiesSection.title",values:{contextValueName:l}})]})})}]}({contextValue:a,items:r,mentionMenuCurrentFormulaStore:t});if(!l||0===l.length)return null;const d={menuType:w().gu.Popup,width:o};return(0,B.jsx)(A().A,{...d,children:(0,B.jsx)(pn().Ay,{initialFocus:0,sections:l,type:pn().Oh.Vertical})})}));function Fs(e){const{children:t}=e,n=(0,Ye().IS)((()=>({wrapper:{display:"inline-flex",alignItems:"center",justifyContent:"center",height:20,width:20}})),[]);return(0,B.jsx)("div",{style:n.wrapper,children:t})}class Us extends ys().Store{getInitialState(){return{userId:"",userEmail:"",displayName:""}}}const zs=Us;function Ks(e,t){return t?xs().Ay.state.open&&"@"===xs().Ay.state.insertionType&&e.device.isAndroid&&t.startsWith("@")?t.slice(1).trim():xs().Ay.state.open&&"[["===xs().Ay.state.insertionType&&t.endsWith("]]")?t.slice(0,-2).trim():t.trim():""}var Vs=()=>n(567141),qs=()=>n(966505),Ws=()=>n(766637);function Gs(e,t){const n=(0,v().K8)((()=>xs().Ay.getMentionMenuContext()),[]);return(0,i.useCallback)((()=>{let i,o=Date.now();const s=xs().Ay.state;if(s.open&&(o=s.openTime,i=s.flowId),s.open){var a;const r=Date.now(),{numServerRequests:l}=Ws().A.state,d=s.sessionId,c=s.showMentionAndShare;Vs().sM(e,{timeToAbandonInMs:r-o,analyticsFrom:n,queryLength:(null===(a=t.current)||void 0===a?void 0:a.length)??0,flowId:i,searchSessionId:d,searchSessionFlowNumber:l,stage:c?"share":"user_selection"})}s.open&&s.showInvite&&qs().F$(e,{origin:xs().Ay.getInviteOrigin(),invite_flow_id:s.flowId}),(0,xs().q6)()}),[n,e,t])}function Hs({usePopupOnMobile:e}){const t=(0,s().Y0)();return!e&&(t.isMobileNative&&!t.isTablet)}var Ys=()=>n(963248);function $s({clearSavedSelection:e,filter:t}){var n;const i=(0,s().v3)(),o=(0,v().O$)(xs().Ay),a=(0,v().K8)((()=>(0,Bs().W)()),[]),r=null===(n=(0,Kt().S)())||void 0===n?void 0:n.spaceStore;if(!o.open)return null;const l="block"===o.textStore.table?o.textStore.id:void 0;return(0,B.jsx)(Ys().v8,{blocksToMove:[],isAddTo:!0,isCreateIn:!0,onAccept:n=>{Ts().eh({environment:i,titleText:Ks(i,t),clearSavedSelection:e,createInValue:n,spaceStore:r,menuListItemAction:void 0})},parentBlockId:l,onAutocompleteQueryChange:Qs,autocompleteQuery:o.createInQuery,desktopWidth:a,onCancel:Zs})}function Qs(e){xs().Ay.updateOpenState({createInQuery:e})}function Zs(){xs().Ay.updateOpenState({showCreateIn:!1,createInQuery:""}),Ts().VN(!0)}var Js=()=>n(893263);function Xs({inviteTargetsStore:e,personPropertyInviteStore:t,filter:n}){const o=(0,s().v3)(),a=(0,i.useCallback)((()=>ea(o,e,t)),[o,e,t]),r=(0,v().K8)((()=>(0,on().a)()),[]),l=(0,v().K8)((()=>xs().Ay.getInviteOrigin()),[]);return r?(0,B.jsx)(Js().A,{inviteOrigin:l,store:r,onInviteCompleteFn:i=>{if(!i.success)return ea(o,e,t),null;const{invitedUsers:s,requestedUsers:a}=i,r=W().xW(Object.values(s),Object.values(a));r.length?x().createAndCommit({userAction:"MentionMenu.inviteMenu",environment:o,canUndo:!0,perform:e=>{Ts().Ju({environment:o,editorMode:"default",annotations:r.map((e=>(0,b().P4h)(e))),transaction:e,menuListItemAction:void 0,query:Ks(o,n),mentionType:"user"})}}):ea(o,e,t)},handleBackButtonClick:a,inviteTargetsStore:e,personPropertyInviteStore:t}):null}function ea(e,t,n){const i=xs().Ay.state;i.open&&(qs().F$(e,{origin:xs().Ay.getInviteOrigin(),invite_flow_id:i.flowId}),t.setState({tokenQuery:"",inviteTargets:[]}),n.setState({...n.state,emailMessage:""}),xs().Ay.updateOpenState({showInvite:!1}))}var ta=()=>n(988083),na=()=>n(537193),ia=()=>n(97835),oa=()=>n(763884),sa=()=>n(134696),aa=()=>n(579627),ra=()=>n(223393),la=()=>n(272053),da=()=>n(773706);function ca(e){const t=(0,s().v3)(),n=(0,v().K8)((()=>(0,on().a)()),[]),{mentionMenuCurrentMentionStore:i,menuPopupType:o}=e,{userId:a,displayName:r,userEmail:l}=(0,v().K8)((()=>i.getState()),[i]),d=(0,v().K8)((()=>(0,la().y)(t,ta().A.state.estimatedKeyboardWebViewOverlap,ta().A.state.nativeBottomBarHeight)),[t]),c=(0,v().K8)((()=>xs().Ay.state.open),[]);if(!n)return null;const u={key:"invite buttons",render:e=>(0,B.jsx)(gn().A,{...e}),items:[{key:"MentionMenu.MentionWithoutSharing",render:e=>(0,B.jsx)(un().A,{title:(0,B.jsx)(q().sA,{defaultMessage:"Mention without sharing",id:"mentionMenu.peopleSection.invitePrompt.mentionWithoutSharing"}),caption:(0,B.jsx)(q().sA,{defaultMessage:"Mention {userDisplayName} without sharing this document",id:"mentionMenu.peopleSection.invitePrompt.mentionWithoutSharingCaption",values:{userDisplayName:r}}),icon:(0,B.jsx)(Vt().I,{icon:na().b}),...e}),action:()=>{x().createAndCommit({userAction:"MentionMenu.menuItem",environment:t,canUndo:!0,perform:e=>{Ts().Ju({environment:t,editorMode:"default",annotations:[(0,b().P4h)(a)],transaction:e,menuListItemAction:void 0,query:"",mentionType:"user",shareMenuSelection:"mention_without_share"})}}),oa().K.set({userId:t.currentUser.id,key:(0,da().T)(n.id),value:!0})}},{key:"MentionMenu.MentionAndShare",render:e=>(0,B.jsx)(un().A,{title:(0,B.jsx)(q().sA,{defaultMessage:"Mention and share",id:"mentionMenu.peopleSection.invitePrompt.mentionAndShare"}),caption:(0,B.jsx)(q().sA,{defaultMessage:"Grant {userDisplayName} full access",id:"mentionMenu.peopleSection.invitePrompt.mentionAndShareCaption",values:{userDisplayName:r}}),icon:(0,B.jsx)(Vt().I,{icon:ia().inviteMemberIcon}),...e}),action:()=>{x().createAndCommit({userAction:"MentionMenu.menuItem",environment:t,canUndo:!0,perform:e=>{Ts().Ju({environment:t,editorMode:"default",annotations:[(0,b().P4h)(a)],transaction:e,menuListItemAction:void 0,query:"",mentionType:"user",shareMenuSelection:"mention_and_share"})}}),x().createAndCommit({userAction:"MentionAndInviteUserComponent.setPermission",environment:t,canUndo:!0,perform:e=>{aa().zP({environment:t,transaction:e,store:n,permissionItems:[{type:"user_permission",role:"editor",user_id:a}],pagePermissionChangeLocation:"mention_share_menu"})}}),sa().Jg(t,{role:"editor",is_space:!1,invite_targets:[{type:"existingUser",value:{id:a,version:0,email:l}}],is_onboarding:!1,invite_origin:"mention_menu",permission_items:[{type:"user_permission",role:"editor",user_id:a}],invite_message_length:0}),(0,ra().r)({item:{label:(0,B.jsx)(q().sA,{id:"mentionMenu.mentionShareMenu.mentionAndShare.snackbarMessage",defaultMessage:"Successfully granted {user} full access",values:{user:r}})},undoFunc:()=>x().createAndCommit({userAction:"MentionAndInviteUserComponent.setPermission.undoShare",environment:t,canUndo:!0,perform:e=>{aa().zP({environment:t,transaction:e,store:n,permissionItems:[{type:"user_permission",role:"none",user_id:a}],pagePermissionChangeLocation:"mention_share_menu"})}})})}}]},p=o===w().gu.ActionSheet?{menuType:w().gu.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${d}px)`}:{menuType:w().gu.Popup};return(0,B.jsxs)(A().A,{...p,children:[(0,B.jsx)(At().N,{debugName:"MentionMenu",capture:c}),(0,B.jsx)(pn().Ay,{type:pn().Oh.Vertical,initialFocus:0,sections:[u]})]})}const ua=(0,q().YK)({addPage:{defaultMessage:"Type to add or link pageâ€¦",id:"mentionMenu.addPage.prompt2"}});var pa=()=>n(30626),ga=()=>n(406792),ma=()=>n(311337),fa=()=>n(310109),ha=()=>n(173979),va=()=>n(778078),ya=()=>n(227894),ba=()=>n(876794);var Sa=()=>n(834316),xa=()=>n(217827);function Aa(e){const{isMobileNative:t}=(0,s().Y0)(),{query:n}=e,i=(0,v().K8)((()=>(0,Pe().D)({isMobileNative:t,disableExposureLogging:!0})&&xs().Ay.state.mentionTypes.team),[t]),o=(0,v().K8)((()=>{var e;if(!i)return[];if(!xs().Ay.state.open)return[];const t=(null===(e=ae().default.state.sidebarSpaceViewStore)||void 0===e?void 0:e.getTeamsStores().filter(Oe().O9))||[];return(0,va().Ay)(n,t,(e=>e.getName()||""),{normalizeFuzzyScore:!0})}),[i,n]),a=(0,v().K8)((()=>xs().Ay.state.open?xs().Ay.state.textStore:void 0),[]);return{teamResults:o,currentTeamResultStore:(0,v().K8)((()=>{if(a&&(0,Sa().W)(a))return function(e){const t=(0,ya().g)(e),n=t.filter((e=>e.table===yn().ev)).find((e=>e.isType("page")));if(n){const e=n.getAssociatedCollectionStore(),i=(0,ba().Y)(t);if((null==e?void 0:e.id)===(null==i?void 0:i.id))return i}}(a)}),[a])}}var Ma=()=>n(68263),wa=()=>n(496703),ja=()=>n(812182),ka=()=>n(329443),Ia=()=>n(124749),Ca=()=>n(106628),Ta=()=>n(94522),_a=()=>n(865342),Pa=()=>n(176235);const Ba=100,Da=(0,q().YK)({agentInviteToastTitle:{id:"agentMention.inviteToast.title",defaultMessage:"Invite agent to page?"},agentInviteToastDescription:{id:"agentMention.inviteToast.description",defaultMessage:"This agent doesnâ€™t have access to this page yet."},agentInviteToastSettingsButton:{id:"agentMention.inviteToast.settingsButton",defaultMessage:"Agent Settings"},agentNoEditToastTitle:{id:"agentMention.noEditToast.title",defaultMessage:"Agent cannot access this page"},agentNoEditToastDescription:{id:"agentMention.noEditToast.description",defaultMessage:"Ask the owner of the agent to allow it access to this page."},agentNoEditToastViewButton:{id:"agentMention.noEditToast.viewButton",defaultMessage:"View Agent"},agentMentionTriggerToastTitle:{id:"agentMention.triggerToast.title",defaultMessage:"Have agent listen to mentions?"},agentMentionTriggerToastSettingsButton:{id:"agentMention.triggerToast.settingsButton",defaultMessage:"Agent Settings"},agentMentionTriggerToastMessage:{id:"agentMention.triggerToast.message",defaultMessage:"This agent is not triggered when itâ€™s mentioned."}});function Ra(e,t){return`ShowBotMentionInvite-${e}-${t}`}function Ea(e){return`ShowMentionTrigger-${e}`}function La(e){const{bot:t,message:n}=e,i=(0,Ye().IS)((()=>{const e=(0,po().O4)({theme:"dark"});return{container:{display:"flex",flexDirection:"column",gap:4},tokenContainer:{paddingTop:4,paddingBottom:4},darkTooltip:{background:e.background.accentPrimary,color:e.text.inversePrimary}}}),[]);return(0,B.jsxs)("div",{style:i.container,children:[(0,B.jsx)(rt().A,{overlayContainerZIndex:202,alignment:"center",originGap:2,placement:"top",renderTooltip:()=>t.name,render:e=>(0,B.jsx)("div",{style:i.tokenContainer,...e,children:(0,B.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,padding:"4px 8px",borderRadius:6,background:"rgba(55, 53, 47, 0.06)",fontSize:14,fontWeight:500},children:[(0,B.jsx)(_a().Z,{icon:t.icon}),t.name]})}),style:i.darkTooltip}),(0,B.jsx)("div",{children:n})]})}function Oa(e){const{isFirstSection:t,query:n,setTemporaryInputData:o,disabled:a}=e,r=(0,s().v3)(),l=(0,q().tz)(),d=(0,si().X)("mention_agents_in_notion"),c=(0,v().K8)((()=>xs().Ay.state.mentionTypes.bot&&d),[d]),{results:u,isLoading:p}=function(e){const{query:t,disabled:n}=e,i=(0,s().v3)(),o=(0,v().K8)((()=>xs().Ay.state.open),[]),a=(0,v().K8)((()=>xs().Ay.state.mentionTypes.bot),[]),r=(0,v().O$)(Re().e),l=(0,Ue().L)(),d=(0,Ia().$)(),c=(0,Ne().ke)(),u=!n&&a&&c&&o&&Boolean(l)&&Boolean(d),[{value:p=[],status:g}]=(0,Me().Yb)((async()=>{if(!u||!r)return[];try{if(!l||!d)return[];const e=await Ca().T.customAgentSearchService.load(),{workflowStores:n}=await e.getCustomAgents({environment:i,spaceStore:l,userStore:d}),o=e.searchWorkflowStores({query:t,workflowStores:n,limit:3}),s=[];for(const t of o){const n=e.getAvailableWorkflowData(t);if(!n)continue;if(!t.getAlive())continue;const i=n.name,o=n.icon,a=n.runtime_actor_pointer,r="bot"===(null==a?void 0:a.table)?a.id:void 0;i&&r&&s.push({id:r,name:i,icon:o,workflowStore:t})}return s}catch(e){return Ee().log({level:"error",from:"botResults",type:"BotMentionSearchError",error:(0,Ln().convertErrorToLog)(e),data:{query:t}}),[]}}),[u,r,l,d,t,i],{debounce:Ba});return{results:p,isLoading:"pending"===g}}({query:n,disabled:a}),g=(0,v().K8)((()=>(0,on().a)()),[]),m=(0,i.useCallback)((({bot:e})=>{if(!g)return;const t=Boolean(oa().K.get({userId:r.currentUser.id,key:Ra(g.id,e.id)}));if(!(!N().A.isMobile&&!t))return;if(!e.workflowStore)return;const n={id:e.id,name:e.name,icon:e.icon,workflowStore:e.workflowStore},i=n.workflowStore.canEdit(),o=(s=n.workflowStore,((0,Ta().dh)(s).triggers||[]).filter((e=>{const t=e.state;return"notion.agent.mentioned"===(null==t?void 0:t.type)&&!1!==e.enabled})).length>0);var s;if(!o&&i){if(!Boolean(oa().K.get({userId:r.currentUser.id,key:Ea(e.id)})))return oa().K.set({userId:r.currentUser.id,key:Ea(e.id),value:!0}),void ja().HK(function(e){const{environment:t,bot:n,intl:i}=e;return{id:`agent_mention_trigger_${n.id}`,title:i.formatMessage(Da.agentMentionTriggerToastTitle,{agentName:n.name}),jsxMessage:(0,B.jsx)(La,{bot:n,message:(0,B.jsx)(q().sA,{...Da.agentMentionTriggerToastMessage})}),actions:{primary:{title:i.formatMessage(Da.agentMentionTriggerToastSettingsButton),onAction:()=>{oa().K.set({userId:t.currentUser.id,key:Ea(n.id),value:!1});const e=(0,wa().L)({workflowId:n.workflowStore.id,params:{workflowViewType:"settings"}});(0,Z().navigate)({environment:t,url:e})}}}}}({environment:r,bot:n,intl:l,pageStore:g}))}if(o){if(function(e,t){try{const n=(0,ka().X2)({botId:e,store:t});return!(!n||!n.role)&&"none"!==n.role&&(0,Ma().Tt)(n.role)}catch(n){return Ee().log({level:"error",from:"doesBotHavePageAccess",type:"BotPermissionCheckError",error:(0,Ln().convertErrorToLog)(n),data:{botId:e,pageId:t.id}}),!1}}(n.id,g))return;e.workflowStore&&(oa().K.set({userId:r.currentUser.id,key:Ra(g.id,e.id),value:!0}),i?ja().HK(function(e){const{environment:t,bot:n,intl:i,pageStore:o}=e;return{id:`agent_invite_${n.id}`,title:i.formatMessage(Da.agentInviteToastTitle,{agentName:n.name}),jsxMessage:(0,B.jsx)(La,{bot:n,message:(0,B.jsx)(q().sA,{...Da.agentInviteToastDescription})}),actions:{primary:{title:i.formatMessage(Da.agentInviteToastSettingsButton),onAction:()=>{oa().K.set({userId:t.currentUser.id,key:Ra(o.id,n.id),value:!1});const e=(0,wa().L)({workflowId:n.workflowStore.id,params:{workflowViewType:"settings"}});(0,Z().navigate)({environment:t,url:e})}}}}}({environment:r,bot:n,intl:l,pageStore:g})):ja().HK(function(e){const{environment:t,bot:n,intl:i,pageStore:o}=e;return{id:`agent_no_edit_${n.id}`,title:i.formatMessage(Da.agentNoEditToastTitle,{agentName:n.name}),jsxMessage:(0,B.jsx)(La,{bot:n,message:(0,B.jsx)(q().sA,{...Da.agentNoEditToastDescription})}),actions:{primary:{title:i.formatMessage(Da.agentNoEditToastViewButton),onAction:()=>{oa().K.set({userId:t.currentUser.id,key:Ra(o.id,n.id),value:!1});const e=(0,wa().L)({workflowId:n.workflowStore.id,params:{}});(0,Z().navigate)({environment:t,url:e})}}}}}({environment:r,bot:n,intl:l,pageStore:g})))}}),[r,l,g]),f=(0,i.useMemo)((()=>u.map((e=>{const t=e.id;return{key:t,render:n=>(n.focused&&o({title:e.name,icon:(0,B.jsx)(Ps().sL,{}),allowTabCompletion:!0}),(0,i.createElement)(Pa().M,{...n,key:t,name:e.name,icon:e.icon})),action:t=>{x().createAndCommit({userAction:"MentionMenu.botMenuItem",environment:r,canUndo:!0,perform:i=>{Ts().Ju({environment:r,editorMode:"default",annotations:[(0,b().Vb6)(e.id)],transaction:i,menuListItemAction:t,query:n,mentionType:"bot"})}}),m({bot:e})}}}))),[u,r,n,o,m]),h=(0,i.useMemo)((()=>{if(c&&0!==f.length)return{key:"bot results",render:e=>(0,B.jsx)(gn().A,{...e,title:(0,B.jsx)(q().sA,{defaultMessage:"Agents",id:"mentionMenu.botsSection.title"}),desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:f}}),[f,t,c]);return c?{botResultsSection:h,isBotResultsLoading:p,numberOfBotResults:u.length}:{botResultsSection:void 0,isBotResultsLoading:!1,numberOfBotResults:0}}var Na=()=>n(148307),Fa=()=>n(955363),Ua=()=>n(264879),za=()=>n(553965),Ka=()=>n(276303);const Va={...Ze().RC,fontWeight:Ze().Wy.medium,maxWidth:160,display:"inline-block",verticalAlign:"bottom"};function qa(e){const{pageTitle:t}=e;return t?(0,B.jsx)(q().sA,{defaultMessage:"New â€œ{filterText}â€ page inâ€¦",id:"createPageMenuItem.title.withPageName",values:{filterText:(0,B.jsx)("span",{style:Va,children:t})}}):(0,B.jsx)(q().sA,{defaultMessage:"Add new page inâ€¦",id:"createPageMenuItem.title.withoutPageName"})}function Wa(e){const{pageTitle:t}=e;return t?(0,B.jsx)(q().sA,{defaultMessage:"New â€œ{filterText}â€ sub-page",id:"createSubpageMenuItem.title.withPageName",values:{filterText:(0,B.jsx)("span",{style:Va,children:t})}}):(0,B.jsx)(q().sA,{defaultMessage:"Add new sub-page",id:"createSubpageMenuItem.title.withoutPageName"})}var Ga=()=>n(103448);function Ha(e){const{isFirstSection:t,query:n,clearSavedSelection:o,setTemporaryInputData:a}=e,{isOpen:r,insertionType:l,isCreatePageEnabled:d,textStore:c}=(0,v().K8)((()=>{const e=xs().Ay.state.open;return{isOpen:e,isCreatePageEnabled:xs().Ay.state.mentionTypes.createPage,insertionType:e?xs().Ay.state.insertionType:void 0,textStore:e?xs().Ay.state.textStore:void 0}}),[]),u=function(e){var t;const{query:n,textStore:o,clearSavedSelection:a,setTemporaryInputData:r}=e,l=(0,s().v3)(),d=(0,q().tz)(),c=(0,v().K8)((()=>Ua().D8(o)),[o]),u=null===(t=(0,Kt().S)())||void 0===t?void 0:t.spaceStore,p=(0,i.useMemo)((()=>({key:"add new subpage",action:async e=>{c&&await Ts().eh({environment:l,clearSavedSelection:a,titleText:n,createInValue:c.createInValue,onPageCreated:e=>{e&&""===b().q4_(e.getTitleValue())&&bn().uK({environment:l,store:e,pageVisitSource:U().y8.Create})},menuListItemAction:e,spaceStore:u})},render:e=>{e.focused&&r({title:0===n.length?d.formatMessage(ua.addPage):"",icon:(0,B.jsx)(Ps().Yo,{}),allowTabCompletion:!1});const t=t=>(0,B.jsx)(un().A,{...(0,za().A)(t||{},e),icon:(0,B.jsx)(Vt().I,{icon:co().plusIcon}),title:(0,B.jsx)(Wa,{pageTitle:n})});return l.device.isMobile?t():(0,B.jsx)(rt().A,{renderTooltip:()=>(0,B.jsx)(Ga().A,{imageURL:Na().A.images.tooltips.pageMenu.newSubpagePng,imageWidth:140,imageHeight:100,caption:(0,B.jsx)(q().sA,{...Ka().DZ.createSubpage})}),placement:"right",delayThreshold:0,render:e=>t(e)})}})),[l,a,c,d,n,r,u]);return p}({query:n,textStore:c,clearSavedSelection:o,setTemporaryInputData:a}),p=function(e){const{query:t,setTemporaryInputData:n}=e,o=(0,s().v3)(),a=(0,q().tz)(),r=(0,i.useCallback)((()=>{xs().Ay.updateOpenState({showCreateIn:!0})}),[]),l=(0,i.useMemo)((()=>({key:"open create in menu",action:r,render:e=>{e.focused&&n({title:0===t.length?a.formatMessage(ua.addPage):"",icon:(0,B.jsx)(Ps().Yo,{}),allowTabCompletion:!1});const i=n=>(0,B.jsx)(un().A,{...(0,za().A)(n||{},e),icon:(0,B.jsx)(Vt().I,{icon:Fa().arrowDiagonalUpRightIcon}),title:(0,B.jsx)(qa,{pageTitle:t})});return o.device.isMobile?i():(0,B.jsx)(rt().A,{renderTooltip:()=>(0,B.jsx)(Ga().A,{imageURL:Na().A.images.tooltips.pageMenu.newPageInPng,imageWidth:140,imageHeight:100,caption:(0,B.jsx)(q().sA,{...Ka().DZ.newPageIn})}),placement:"right",delayThreshold:0,render:e=>i(e)})}})),[o.device.isMobile,r,a,t,n]);return l}({query:n,setTemporaryInputData:a}),g=(0,i.useMemo)((()=>{if(!d||!r)return;const e="@"===l?(0,B.jsx)(q().sA,{id:"mentionMenu.createPageSection.title",defaultMessage:"New page"}):void 0;return{key:"create page",render:n=>(0,B.jsx)(gn().A,{...n,title:e,desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:[u,p]}}),[t,u,p,d,r,l]);return g}var Ya=()=>n(906745),$a=()=>n(395361),Qa=()=>n(869190),Za=()=>n(604995),Ja=()=>n(498140),Xa=()=>n(68913),er=()=>n(274570),tr=()=>n(5580);function nr(e){const{category:t,query:n,setTemporaryInputData:i,templateVariableResults:o}=e,a=(0,s().v3)(),r=(0,q().tz)();return o.filter((e=>(0,ha().BX)(e,t))).map((e=>({key:e,render:t=>{const n=(0,ha().Ti)(e,r),o=(0,ha().EC)(e,r);return t.focused&&i({title:n,icon:(0,B.jsx)(Ps().sL,{}),allowTabCompletion:!0}),(0,B.jsx)(un().A,{...t,title:n,caption:o,inline:!0})},action:t=>{x().createAndCommit({userAction:"MentionMenu.menuItem",environment:a,canUndo:!0,perform:i=>{Ts().Ju({environment:a,editorMode:"default",annotations:[b().Ii$({type:e})],transaction:i,menuListItemAction:t,query:n,mentionType:"templateVariable"})}})}})))}var ir=()=>n(280244);function or(e){const{templateVariableResults:t,formulaContextVariableResults:o,isFirstSection:a,query:r,setTemporaryInputData:l,disabled:d=!1}=e,c=(0,s().v3)(),u=(0,q().tz)(),p=function(e,t=!1){const[o,s]=(0,i.useState)([]),a=(0,q().tz)(),{areDateMentionsAllowed:r,areReminderMentionsAllowed:l}=(0,v().K8)((()=>({areDateMentionsAllowed:xs().Ay.state.mentionTypes.date,areReminderMentionsAllowed:xs().Ay.state.mentionTypes.reminder})),[]),d=(0,tr().n)(),c=(0,si().X)("chrono_node_date_mentions",{disableExposureLogging:!1,enableEventTrailLogging:!1}),u=(0,si().X)("default_mentioned_dates_to_reminders",{disableExposureLogging:!1,enableEventTrailLogging:!1}),p=(0,si().X)("adoption_reminder_rendering_improvements",{disableExposureLogging:!1,enableEventTrailLogging:!1}),g=(0,i.useCallback)((async()=>{if(0===e.length)return;const t=await async function(e){const{query:t,intl:i,userLocal:o,areReminderMentionsAllowed:s,isReminderRenderingImprovementsEnabled:a}=e,{chronoNodeDependency:r}=await Promise.all([n.e(91757),n.e(58587)]).then(n.bind(n,211051)),l=await r.load(),d={en:l.en.parse,ja:l.ja.parse,zh:l.zh.parse,fr:l.fr.parse,de:l.de.parse,es:l.es.parse,pt:l.pt.parse,nl:l.nl.parse},c=t.toLowerCase(),u=c.includes(i.formatMessage(hr.ago).toLowerCase()),p=[d[o]??l.en.parse,l.en.parse];let g=[];p.some((e=>{const n=e(t,void 0,{forwardDate:!u});return n.length>0&&(g=n,!0)}));const m=g.length>0?g[0]:void 0;if(!m)return;const{start:f,end:h}=m,v=f.isCertain("minute")||f.isCertain("hour"),y=(null==h?void 0:h.isCertain("minute"))||(null==h?void 0:h.isCertain("hour")),b=f.date().getTime(),S=null==h?void 0:h.date().getTime(),x=(0,z().P)(),A=Za().KQ(b,x),M={unit:"day",value:0,time:Yn().lM,defaultTimeZone:x},w=t.toLowerCase().startsWith(i.formatMessage(Ja().DZ.remind).toLowerCase())&&s;let j;if(b&&!S)j=v?{...A,reminder:w?ar(f):void 0}:{type:"date",start_date:A.start_date,reminder:w?M:void 0};else if(S){const e=Za().NC(b,S,(0,z().P)());j=v&&y?{...e,reminder:w?ar(f):void 0}:{type:"daterange",end_date:e.end_date,start_date:e.start_date,reminder:w?M:void 0}}if(!j)return;const k=(0,Qa().ZF)({value:j,allowRelativeDates:!0,date_format:"relative",userTimeZone:(0,z().P)(),intl:i,getToday:()=>Za().ah((0,z().P)())}),I={label:k,value:()=>j,source:"chrono-node"},C=s&&(w||e.isDefaultMentionedDatesToRemindersEnabled)?fr(j):void 0;if(!C||!w&&!mr(j))return[I];const T=i.formatMessage(hr.reminder,{dateTime:k}),_={label:a?k:T,value:()=>C,source:"chrono-node"};if(w)return[_];return[I,_]}({query:e,intl:a,userLocal:d,isDefaultMentionedDatesToRemindersEnabled:u,areReminderMentionsAllowed:l,isReminderRenderingImprovementsEnabled:p}),i=t&&t.filter((e=>e.label.length>0));i&&0!==i.length?s(i):s([])}),[a,u,e,d,l,p]),m=(0,$a().Y)((async()=>await g()),100);return(0,Me().Yb)((async()=>{if(t||!r)return void s([]);c&&m.cancel();const n=function(e){const{query:t,allowReminder:n,intl:i,isDefaultMentionedDatesToRemindersEnabled:o,isReminderRenderingImprovementsEnabled:s}=e;if(0===t.length)return(0,W().oE)([{label:i.formatMessage(hr.autocompleteToday),value:()=>Za().Ec((0,z().P)()),source:"luxon"},n?void 0:{label:i.formatMessage(hr.autocompleteNextTuesday),value:()=>{const e=Za().ah((0,z().P)()),t=e.set({weekday:2,hour:15}),n=t<=e?t.plus({week:2}):t.plus({week:1});return{type:"datetime",start_date:n.toFormat(Za().tr),start_time:n.toFormat(Yn().GE),time_zone:(0,z().P)()}},source:"luxon"},n?{label:s?i.formatMessage(hr.autocompleteReminderV2):i.formatMessage(hr.autocompleteReminder),value:()=>({type:"datetime",start_date:Za().uf((0,z().P)()).start_date,start_time:Yn().vM,reminder:{unit:"day",value:0,time:Yn().lM,defaultTimeZone:(0,z().P)()},time_zone:(0,z().P)()}),source:"luxon"}:void 0]);const a=t.normalize("NFKD"),r=n?Ja().bm(a,i):Ja().FA(a,i);if(!r)return[];const l=(0,Qa().ZF)({value:r,date_format:"relative",userTimeZone:(0,z().P)(),intl:i,allowRelativeDates:!0}),d=(0,Yn().Lh)(r)||t.toLowerCase().startsWith(i.formatMessage(Ja().DZ.remind).toLowerCase()),c={label:l,value:()=>r,source:"luxon"},u=n?fr(r):void 0,p=mr(r);if(!(u&&(0,Yn().Lh)(u)&&p))return[c];const g=i.formatMessage(hr.reminder,{dateTime:l}),m={label:s?l:g,value:()=>u,source:"luxon"};if(d)return[m];if(o)return[c,m];return[]}({query:e,allowReminder:l,isDefaultMentionedDatesToRemindersEnabled:u,intl:a,isReminderRenderingImprovementsEnabled:p}).slice(0,6);n.length>0||!c?s(n):await m()}),[t,r,c,e,l,u,a,m,p]),o}(r,d),g=nr({templateVariableResults:t,category:"date",query:r,setTemporaryInputData:l}),m=(0,ir().DK)({formulaReturnType:"date",query:r,formulaContextVariableResults:o,setTemporaryInputData:l}),f=(0,si().X)("adoption_reminder_rendering_improvements",{disableExposureLogging:!1,enableEventTrailLogging:!1}),h=(0,v().K8)((()=>{if("fr-FR"!==u.locale)return"control";return O().default.getEligibleGroup({experimentId:"adoption_reminder_french_test",defaultGroup:"control",disableExposureLogging:!1,enableEventTrailLogging:!1})}),[u.locale]),y=(0,i.useMemo)((()=>{const e=p.some((e=>(0,Yn().Lh)(e.value())));return p.map((({label:t,value:n,source:i})=>{const o=n();return{key:(0,Yn().Lh)(o)?`${t}-reminder-date-result`:`${t}-date-result`,render:o=>(0,B.jsx)(sr,{...o,label:t,value:n,source:i,intl:u,setTemporaryInputData:l,hasReminderInResults:e,isReminderRenderingImprovementsEnabled:f,reminderFrenchTestVariant:h}),action:e=>{x().createAndCommit({userAction:"MentionMenu.menuItem",environment:c,canUndo:!0,perform:t=>{Ts().Ju({environment:c,editorMode:"default",annotations:[["d",{...o,date_format:"relative"}]],transaction:t,menuListItemAction:e,query:r,mentionType:(0,Yn().Lh)(o)?"reminder":"date"})}})}}}))}),[h,p,u,l,c,r,f]),b=(0,i.useMemo)((()=>d?[]:[...m,...g,...y]),[y,m,g,d]),S=(0,i.useMemo)((()=>{if(!d&&0!==b.length)return{key:"date results",render:e=>(0,B.jsx)(gn().A,{...e,title:(0,B.jsx)(q().sA,{defaultMessage:"Date",id:"mentionMenu.dateSection.title"}),desktopTitleStyle:a?{paddingTop:4}:void 0,topBorder:!a}),items:b}}),[b,a,d]);return S}function sr(e){const{label:t,value:n,source:o,intl:s,setTemporaryInputData:a,hasReminderInResults:r,isReminderRenderingImprovementsEnabled:l,reminderFrenchTestVariant:d}=e,c=n();if((0,i.useEffect)((()=>{e.focused&&a({title:t,icon:(0,B.jsx)(Ps().sL,{}),allowTabCompletion:!0})}),[e.focused,t,a]),l){const i="chrono-node"===o?pr(n(),s):Ja().e_(t,s)?(0,Qa().ZF)({value:c,userTimeZone:(0,z().P)(),intl:s,allowRelativeDates:!1}):void 0;if((0,Yn().Lh)(n())){const n="imperative"===d?"Rappel":"ios_version"===d?"Rappel programmÃ©":s.formatMessage(hr.remind);return(0,B.jsx)(un().A,{...e,title:n,caption:i??t,inline:!0,icon:(0,B.jsx)(Vt().I,{icon:Xa().alarmIcon}),shouldWrapCaption:!0})}return(0,B.jsx)(un().A,{...e,title:t,caption:r?"":i,inline:Boolean(i),icon:(0,B.jsx)(Vt().I,{icon:er().clockIcon}),shouldWrapCaption:!0})}if("chrono-node"===o){const i=pr(n(),s);return(0,B.jsx)(un().A,{...e,title:t,caption:i,inline:!0,shouldWrapCaption:!0})}if(Ja().e_(t,s)){const n=(0,Qa().ZF)({value:c,userTimeZone:(0,z().P)(),intl:s,allowRelativeDates:!1});return(0,B.jsx)(un().A,{...e,title:t,caption:n,inline:!0,shouldWrapCaption:!0})}return(0,B.jsx)(un().A,{...e,title:t})}function ar(e){const t=e.isCertain("minute")?"minute":e.isCertain("hour")?"hour":"day";return"minute"===t?{unit:t,value:e.get("minute")??0}:"hour"===t?{unit:t,value:e.get("hour")??0}:{unit:"day",value:0,time:Yn().lM}}const rr=7,lr=30,dr=365,cr=60,ur=24*cr;function pr(e,t){if("daterange"===e.type||"datetimerange"===e.type)return;const n=(0,z().P)(),i=Ya().c9.now().setZone(n);let o=Ya().c9.fromFormat(e.start_date,Za().tr,{zone:n});if("date"===e.type?o=o.startOf("day"):"datetime"===e.type&&(o=(0,Za().mF)(e)),"datetime"===e.type&&e.start_time){const e=Math.round(o.diff(i,"minutes").minutes),n=Math.abs(e),s=e>0;if(n<cr)return 0===n?t.formatMessage(hr.now):t.formatMessage(s?hr.minutesFromNow:hr.minutesAgo,{count:n});if(n<ur){const e=Math.round(n/60);return t.formatMessage(s?hr.hoursFromNow:hr.hoursAgo,{count:e})}}const s=i.startOf("day"),a=Math.round(o.startOf("day").diff(s,"days").days);if(0===a)return t.formatMessage(hr.today);if(1===a)return t.formatMessage(hr.tomorrow);if(-1===a)return t.formatMessage(hr.yesterday);const r=Math.abs(a),l=a>0;return r<rr?t.formatMessage(l?hr.daysFromToday:hr.daysAgo,{count:r}):r<lr?t.formatMessage(l?hr.weeksFromToday:hr.weeksAgo,{count:Math.round(r/rr)}):r<dr?t.formatMessage(l?hr.monthsFromToday:hr.monthsAgo,{count:Math.round(r/lr)}):t.formatMessage(l?hr.yearsFromToday:hr.yearsAgo,{count:Math.round(r/dr)})}const gr={time:Yn().lM,unit:"day",value:0};function mr(e){const t=Za().Dz(e);if(!t)return!1;if("datetime"===e.type&&e.start_time){const t=Ya().c9.now().setZone((0,z().P)());return(0,Za().mF)(e)>t}return t.start>Za().ah((0,z().P)())}function fr(e){if((0,Yn().Lh)(e)||!mr(e))return e;switch(e.type){case"date":case"daterange":return{...e,reminder:gr};case"datetimerange":case"datetime":return{...e,reminder:{unit:"minute",value:0}};default:(0,Oe().HB)(e)}}const hr=(0,q().YK)({autocompleteToday:{defaultMessage:"Today",id:"mentionMenu.date.autocomplete.today"},autocompleteNextTuesday:{defaultMessage:"Next Tuesday 3pm",id:"mentionMenu.date.autocomplete.nextTuesday"},autocompleteReminder:{defaultMessage:"Remind tomorrow 9am",id:"mentionMenu.date.autocomplete.reminder"},autocompleteReminderV2:{defaultMessage:"Tomorrow 9am",id:"mentionMenu.date.autocomplete.reminderV2"},remind:{defaultMessage:"Remind me",id:"mentionMenu.date.autocomplete.remind"},reminder:{defaultMessage:"Remind {dateTime}",id:"mentionMenu.date.remindAtDateTime"},now:{defaultMessage:"Now",id:"mentionMenu.date.timeCaption.now"},today:{defaultMessage:"Today",id:"mentionMenu.date.timeCaption.today"},tomorrow:{defaultMessage:"Tomorrow",id:"mentionMenu.date.timeCaption.tomorrow"},yesterday:{defaultMessage:"Yesterday",id:"mentionMenu.date.timeCaption.yesterday"},minutesFromNow:{defaultMessage:"{count, plural, one {# minute from now} other {# minutes from now}}",id:"mentionMenu.date.timeCaption.minutesFromNow"},minutesAgo:{defaultMessage:"{count, plural, one {# minute ago} other {# minutes ago}}",id:"mentionMenu.date.timeCaption.minutesAgo"},hoursFromNow:{defaultMessage:"{count, plural, one {# hour from now} other {# hours from now}}",id:"mentionMenu.date.timeCaption.hoursFromNow"},hoursAgo:{defaultMessage:"{count, plural, one {# hour ago} other {# hours ago}}",id:"mentionMenu.date.timeCaption.hoursAgo"},daysFromToday:{defaultMessage:"{count, plural, one {# day from now} other {# days from now}}",id:"mentionMenu.date.timeCaption.daysFromToday"},daysAgo:{defaultMessage:"{count, plural, one {# day ago} other {# days ago}}",id:"mentionMenu.date.timeCaption.daysAgo"},weeksFromToday:{defaultMessage:"{count, plural, one {# week from now} other {# weeks from now}}",id:"mentionMenu.date.timeCaption.weeksFromToday"},weeksAgo:{defaultMessage:"{count, plural, one {# week ago} other {# weeks ago}}",id:"mentionMenu.date.timeCaption.weeksAgo"},monthsFromToday:{defaultMessage:"{count, plural, one {# month from now} other {# months from now}}",id:"mentionMenu.date.timeCaption.monthsFromToday"},monthsAgo:{defaultMessage:"{count, plural, one {# month ago} other {# months ago}}",id:"mentionMenu.date.timeCaption.monthsAgo"},yearsFromToday:{defaultMessage:"{count, plural, one {# year from now} other {# years from now}}",id:"mentionMenu.date.timeCaption.yearsFromToday"},yearsAgo:{defaultMessage:"{count, plural, one {# year ago} other {# years ago}}",id:"mentionMenu.date.timeCaption.yearsAgo"},ago:{defaultMessage:"ago",id:"mentionMenu.date.timeCaption.ago"}});var vr=()=>n(862139);const yr=(0,q().YK)({groupMentionCaption:{defaultMessage:"{numMembersInGroup, plural, one {{numMembersInGroup} member} other {{numMembersInGroup} members}}",id:"mentionMenu.group.caption"}});function br(e){const{isFirstSection:t,query:n,setTemporaryInputData:o}=e,a=(0,s().v3)(),r=(0,q().tz)(),l=function(e){const{query:t}=e,n=(0,v().K8)((()=>xs().Ay.state.mentionTypes.group),[]),o=(0,v().K8)((()=>On().A.state.permissionGroupsAndMemberCounts.map((e=>e.group))),[]),s=(0,i.useMemo)((()=>n?(0,va().Ay)(t,o,(e=>e.name||""),{normalizeFuzzyScore:!0}):[]),[n,t,o]);return s}({query:n}),d=(0,v().K8)((()=>W().pY(On().A.state.permissionGroupsAndMemberCounts,(e=>e.group.group_id))),[]),c=(0,Yi().r)(),u=(0,i.useMemo)((()=>W().oE(l.map((e=>{var t;if(!c)return;const i=r.formatMessage(yr.groupMentionCaption,{numMembersInGroup:(null===(t=d[e.group_id])||void 0===t?void 0:t.memberCount)||0});return{key:e.id,render:t=>(t.focused&&o({title:e.name||"",icon:(0,B.jsx)(Ps().sL,{}),allowTabCompletion:!0}),(0,B.jsx)(vr()._,{menuListItemProps:{...t,caption:i},group:e,iconSizeOverride:a.device.isMobile?24:void 0})),action:t=>{x().createAndCommit({userAction:"MentionMenu.groupMention",environment:a,canUndo:!0,perform:i=>{Ts().Ju({environment:a,editorMode:"default",annotations:[b().dWL(e.group_id,c)],transaction:i,menuListItemAction:t,query:n,mentionType:"group"})}})}}})))),[l,c,r,d,o,a,n]),p=(0,i.useMemo)((()=>{if(0!==u.length)return{key:"group results",render:e=>(0,B.jsx)(gn().A,{...e,title:(0,B.jsx)(q().sA,{defaultMessage:"Groups",id:"mentionMenu.groupSection.title"}),desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:u}}),[u,t]);return p}var Sr=()=>n(125958),xr=()=>n(18387),Ar=()=>n(712505);const Mr={viewBox:"0 0 20 20",fittedViewBox:"4.01 3.95 12.04 12.09",svg:(0,B.jsx)("path",{d:"M15.422 3.956a.625.625 0 0 1 0 1.25h-1.75v10.213a.625.625 0 0 1-1.25 0V5.206h-1.875V15.42a.625.625 0 0 1-1.25 0v-4.544H7.412a3.46 3.46 0 0 1 0-6.919zm-8.01 1.25a2.21 2.21 0 0 0 0 4.419h1.885V5.206z"})},wr=(0,no().wt)("pilcrow",Mr);var jr=()=>n(16006);const kr=i.forwardRef((function(e,t){const{store:n}=e;return(0,B.jsx)(un().A,{...e,ref:t,title:(0,B.jsx)(jr().A,{store:n}),className:"notranslate",icon:(0,B.jsx)(Vt().I,{icon:wr})})}));function Ir(e){const t=(0,s().v3)(),n=(0,q().tz)(),{query:o,setTemporaryInputData:a,isFirstSection:r}=e,l=function(e){const{intl:t,query:n}=e,i=n.toLowerCase(),o=(0,si().X)("mention_menu_page_headings"),s=(0,v().K8)((()=>o&&xs().Ay.state.mentionTypes.heading),[o]),a=(0,v().K8)((()=>{const e=(0,xr().Z)();if(!e)return;const{mainEditorCurrentBlockStore:t}=ae().default.state;return e===t?t:Ar().default.peekTargetStore.state===e?Ar().default.peekTargetStore.state:void 0}),[]),r=(0,v().K8)((()=>s&&a?(0,Sr().T)(a.id,a.getRecordModel):[]),[s,a],{recomputeSchedule:"lazy"}),l=(0,v().K8)((()=>a?(0,W().oE)(r.map((e=>{const n=xn().B.createChildStore(a,{table:yn().ev,id:e}),o=n.getModel();if(!o)return;const s=o.getRenderTitle({getRecordModel:n.getRecordModel,userTimeZone:(0,z().P)(),intl:t});return s&&s.toLowerCase().includes(i)?n:void 0}))):[]),[t,i,a,r],{recomputeSchedule:"lazy"});return l}({query:o,intl:n}),d=0===l.length,c=(0,v().K8)((()=>l.map((e=>{const i=e.id;return{key:i,render:t=>{if(t.focused){const t=e.getModel();if(t){const i=t.getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:(0,z().P)(),intl:n});a({title:i||"",icon:(0,B.jsx)(Ps().zC,{}),allowTabCompletion:!0})}}return(0,B.jsx)(kr,{...t,store:e})},action:e=>{x().createAndCommit({userAction:"MentionMenu.getHeaderResultsMenuSection",environment:t,canUndo:!0,perform:n=>{Ts().Ju({environment:t,editorMode:"default",annotations:[["p",i]],transaction:n,menuListItemAction:e,query:o,mentionType:"heading"})}})}}}))),[t,l,n,o,a]),u=(0,i.useMemo)((()=>{if(!d)return{key:"heading results",render:e=>(0,B.jsx)(gn().A,{...e,title:(0,B.jsx)(q().sA,{defaultMessage:"Link to heading",id:"mentionMenu.headerSection.title"}),desktopTitleStyle:r?{paddingTop:4}:void 0,topBorder:!r}),items:c}}),[c,r,d]);return u}var Cr=()=>n(519831);var Tr=()=>n(626822);var _r=()=>n(542129),Pr=(n(908872),()=>n(764880)),Br=()=>n(671089),Dr=()=>n(695608),Rr=()=>n(498212),Er=()=>n(928074),Lr=()=>n(448693);const Or=(0,q().YK)({here:{id:"mentionMenu.SlackSpecialMentionMenuItem.hereMention",defaultMessage:"@here"},channel:{id:"mentionMenu.SlackSpecialMentionMenuItem.channelMention",defaultMessage:"@channel"}}),Nr=(0,q().YK)({here:{id:"mentionMenu.SlackSpecialMentionMenuItem.hereMentionNoAmpersand",defaultMessage:"here"},channel:{id:"mentionMenu.SlackSpecialMentionMenuItem.channelMentionNoAmpersand",defaultMessage:"channel"}}),Fr=[{message:Nr.here,channelRecipient:"here"},{message:Nr.channel,channelRecipient:"channel"}],Ur=i.forwardRef((function(e,t){const{channelRecipient:i}=e;return(0,B.jsx)(un().A,{...e,icon:(0,n(522500).q)({width:14,height:14}),title:(0,B.jsx)(q().sA,{...Or[i]}),ref:t,inline:!0,caption:(0,B.jsx)(q().sA,{...Or[i]})})}));var zr=()=>n(421861),Kr=()=>n(341694),Vr=()=>n(62088);const qr="__invite";function Wr(e){const{isFirstSection:t,query:n,inviteTargetsStore:o,personPropertyInviteStore:a,mentionMenuCurrentMentionStore:r,setTemporaryInputData:l,templateVariableResults:d,formulaContextVariableResults:c,currentTeamResultStore:u,disabled:p}=e,g=(0,s().v3)(),m=(0,q().tz)(),f=(0,v().K8)((()=>xs().Ay.state.mentionTypes.user),[]),{results:h,isLoading:y}=(0,Vr().uE)({query:n,environment:g,intl:m,disabled:p,useMentionMenuStore:!0}),S=(0,v().K8)((()=>(0,on().a)()),[]),A=(0,v().K8)((()=>S&&Boolean(oa().K.get({userId:g.currentUser.id,key:(0,da().T)(S.id)}))),[g.currentUser.id,S]),M=(0,v().K8)((()=>xs().Ay.state.mentionTypes.inviteUserToPage&&!A),[A]),w=nr({templateVariableResults:d,category:"user",query:n,setTemporaryInputData:l}),j=(0,ir().DK)({formulaReturnType:"person",query:n,formulaContextVariableResults:c,setTemporaryInputData:l}),k=(0,v().K8)((()=>{const e=xs().Ay.state.mentionTypes.team;return(0,Pe().D)({isMobileNative:g.device.isMobileNative,disableExposureLogging:!0})&&e}),[g.device.isMobileNative]),I=(0,v().K8)((()=>!h.find((e=>e.email===n))&&xs().Ay.state.mentionTypes.inviteUserToWorkspace&&o&&a),[n,h,o,a]),C=(0,Yi().r)(),T=(0,v().K8)((()=>{var e;return"slack_notification"===(null===(e=xa().A.state.automationActionStore)||void 0===e?void 0:e.getType())}),[]),_=I||h.length>0||w.length>0||j.length>0||k,P=(0,v().K8)((()=>{if(!C||!u||!_)return;const e=m.formatMessage({id:"posts.teamMenuItem.everyoneMentionNoAmpersand",defaultMessage:"everyone"});return e.startsWith(n)?{key:"everyone-unique-item",render:t=>(t.focused&&l({title:e,icon:(0,B.jsx)(Ps().sL,{}),allowTabCompletion:!0}),(0,i.createElement)(Tr().A,{...t,key:"everyone-unique-item",teamStore:u,renderAsEveryoneMention:!0})),action:e=>{x().createAndCommit({userAction:"MentionMenu.teamMention",environment:g,canUndo:!0,perform:t=>{Ts().Ju({environment:g,editorMode:"default",annotations:[b().DH3(u.id,C,"everyone")],transaction:t,menuListItemAction:e,query:n,mentionType:"team"})}})}}:void 0}),[_,u,g,m,n,l,C]),D=(0,v().K8)((()=>Fr.reduce(((e,t)=>{if(!T)return e;const{channelRecipient:o,message:s}=t,a=m.formatMessage(s);if("channel"!==o&&"here"!==o)return e;if(!a.startsWith(n))return e;const r=function(e){return`slack-special-mention-${e}-unique-item`}(o),d={key:r,render:e=>(e.focused&&l({title:a,icon:(0,B.jsx)(Ps().sL,{}),allowTabCompletion:!0}),(0,i.createElement)(Ur,{...e,channelRecipient:o,key:r})),action:e=>{x().createAndCommit({userAction:`MentionMenu.slackSpecialMention.${s.id}MenuItem`,environment:g,canUndo:!0,perform:t=>{Ts().Ju({environment:g,editorMode:"default",annotations:[b().zP1(o)],transaction:t,menuListItemAction:e,query:n,mentionType:"slackSpecialMention"})}})}};return e.push(d),e}),[])),[T,g,m,n,l]),R=(0,Kr().H)(),E=(0,v().K8)((()=>xs().Ay.getMentionMenuContext()??yn().ev),[]),L=(0,v().K8)((()=>!!S&&((0,Er().Aj)({store:S})&&S.canAdmin())),[S]),N=(0,i.useCallback)((async({user:e})=>{if(!(!g.device.isMobile&&R&&!A&&L))return;if(!S)return;const t=await Y().callApi({eventName:"canMentionInviteUserToPage",environment:g,data:{block:{id:S.pointer.id,table:yn().ev,spaceId:S.getSpaceId()},mentionedUser:{id:e.id,table:Fn().oo,spaceId:S.getSpaceId()}}});if("success"!==t.type||!t.data.canInvite)return;const n=(0,Rr().Ay)();ja().HK(function(e){const{environment:t,user:n,pageStore:i,intl:o,flowId:s,from:a}=e;return i&&oa().K.set({userId:t.currentUser.id,key:(0,da().T)(i.id),value:!0}),{id:`invite_${n.id}`,title:o.formatMessage(Yr.pageInviteToastTitle,{name:n.name??n.email}),jsxMessage:(0,B.jsx)(Gr,{user:n}),actions:{primary:{title:o.formatMessage(Yr.pageInviteToastInviteButton),onAction:()=>{if(!i)return;const o="read_and_write";x().createAndCommit({userAction:"MentionMenu.menuItem",environment:t,canUndo:!0,perform:e=>{aa().zP({environment:t,transaction:e,store:i,permissionItems:[{type:"user_permission",role:o,user_id:n.id}],pagePermissionChangeLocation:"mention_share_menu",fromPermissionWrapper:"mention_menu",flowId:s})}}),oa().K.set({userId:t.currentUser.id,key:(0,da().T)(i.id),value:!1}),sa().Jg(t,{role:o,is_space:!1,invite_targets:[{type:"existingUser",value:n}],is_onboarding:!1,invite_origin:"mention_menu",permission_items:[{type:"user_permission",role:o,user_id:n.id}],invite_message_length:0,invite_flow_id:s}),Hr(t,{flow_id:s,selection:"invite",target_user_id:n.id,from:a}),ja().HK(function(e){const{user:t,intl:n,environment:i,pageStore:o,flowId:s,from:a}=e;return{id:`invite_${t.id}`,icon:Br().checkmarkCircleIcon,title:n.formatMessage(Yr.pageInviteSnackbarSuccessTitle),jsxMessage:void 0,message:n.formatMessage(Yr.pageInviteSnackbarSuccessMessage),actions:{primary:{title:n.formatMessage(Yr.pageInviteUndo),onAction:()=>{x().createAndCommit({userAction:"MentionMenu.menuItem",environment:i,canUndo:!0,perform:e=>{o&&aa().zP({environment:i,transaction:e,store:o,permissionItems:[{type:"user_permission",role:"none",user_id:t.id}],pagePermissionChangeLocation:"mention_share_menu",flowId:s})}}),ja().UW(`invite_${t.id}`),function(e,t){(0,zt().u)({environment:e,event:{eventName:"undo_invite_to_page_popup",eventProperties:t}}),O().default.logEvent("undo_invite_to_page_popup",void 0,t)}(i,{flow_id:s,target_user_id:t.id,from:a})}}}}}(e))}},secondary:{title:o.formatMessage(Yr.pageInviteToastIgnoreButton),onAction:()=>{i&&(ja().UW(`invite_${n.id}`),Hr(t,{flow_id:s,selection:"dismiss",target_user_id:n.id,from:a}))}}}}}({environment:g,user:e,pageStore:S,intl:m,flowId:n,from:E})),function(e,t){(0,zt().u)({environment:e,event:{eventName:"trigger_invite_to_page_popup",eventProperties:t}}),O().default.logEvent("trigger_invite_to_page_popup",void 0,t)}(g,{flow_id:n,target_user_id:e.id,from:E})}),[g,A,L,R,S,E,m]),F=(0,v().K8)((()=>xs().Ay.state.open?xs().Ay.state.flowId:void 0),[]),U=(0,i.useCallback)(((e,t,n,i)=>{t.reset(),n.reset(),F&&(t.setState({...t.state,tokenQuery:i}),n.setState({...n.state,flowId:F}),qs().TS(e,{origin:xs().Ay.getInviteOrigin(),invite_flow_id:F}),xs().Ay.updateOpenState({showInvite:!0}))}),[F]),z=(0,v().K8)((()=>h.map((e=>{const t=e.id;return{key:t,render:n=>(n.focused&&l({title:(0,Dr().c6)(m,e),icon:(0,B.jsx)(Ps().sL,{}),allowTabCompletion:!0}),(0,i.createElement)(zr().i,{...n,key:t,user:e})),action:i=>{const o=(0,ka().om)(t);M&&"none"===o?(r.setState({userId:t,userEmail:e.email,displayName:(0,Pr().A7)(e).getDisplayName(m)}),xs().Ay.updateOpenState({showMentionAndShare:!0})):(x().createAndCommit({userAction:"MentionMenu.menuItem",environment:g,canUndo:!0,perform:t=>{Ts().Ju({environment:g,editorMode:"default",annotations:[(0,b().P4h)(e.id)],transaction:t,menuListItemAction:i,query:n,mentionType:"user"})}}),N({user:e}))}}})).concat(I&&_&&o&&a?[{key:qr,action:()=>U(g,o,a,n),render:e=>(e.focused&&l({title:"",icon:(0,B.jsx)(Ps().sL,{}),allowTabCompletion:!1}),(0,B.jsx)(un().A,{...e,icon:(0,B.jsx)(Vt().I,{icon:ia().inviteMemberIcon}),title:n.length>0?(0,B.jsx)(q().sA,{defaultMessage:"Invite â€œ{query}â€â€¦",id:"mentionMenu.peopleSection.invitePrompt",values:{query:n}}):(0,B.jsx)(q().sA,{defaultMessage:"Inviteâ€¦",id:"mentionMenu.peopleSection.invitePrompt.empty"})}))}]:[])),[N,g,U,m,o,r,a,n,l,I,M,_,h]),K=(0,i.useMemo)((()=>[...P?[P]:[],...D,...j,...w,...z]),[P,j,w,D,z]),V=(0,i.useMemo)((()=>{if(0!==K.length||y)return{key:"user results",render:e=>(0,B.jsx)(gn().A,{...e,title:(0,B.jsx)(q().sA,{defaultMessage:"People",id:"mentionMenu.peopleSection.title"}),desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:K}}),[K,t,y]);return f?{userResultsSection:V,isUserResultsLoading:y,numberOfUserResults:h.length}:{userResultsSection:void 0,isUserResultsLoading:!1,numberOfUserResults:0}}function Gr(e){const{user:t}=e,n=(0,Ye().IS)((()=>{const e=(0,po().O4)({theme:"dark"});return{container:{display:"flex",flexDirection:"column",gap:4},tokenContainer:{paddingTop:4,paddingBottom:4},darkTooltip:{background:e.background.accentPrimary,color:e.text.inversePrimary}}}),[]);return(0,B.jsxs)("div",{style:n.container,children:[(0,B.jsx)(rt().A,{overlayContainerZIndex:202,alignment:"center",originGap:2,placement:"top",renderTooltip:()=>t.email,render:e=>(0,B.jsx)("div",{style:n.tokenContainer,...e,children:(0,B.jsx)(Lr().t_,{userValue:t,isSingle:!0,shouldShrink:!0,format:Lr().t_.Format.Medium,hasPersonHoverCard:!1})}),style:n.darkTooltip}),(0,B.jsx)("div",{children:(0,B.jsx)(q().sA,{...Yr.pageInviteToastMessage})})]})}function Hr(e,t){(0,zt().u)({environment:e,event:{eventName:"select_invite_to_page_popup",eventProperties:t}}),O().default.logEvent("select_invite_to_page_popup",t.selection,t)}const Yr=(0,q().YK)({pageInviteToastTitle:{defaultMessage:"Invite to page?",id:"mentionMenu.UserMentionMenuItem.inviteToastTitle"},pageInviteToastMessage:{defaultMessage:"They wonâ€™t be notified unless you invite them to the page.",id:"mentionMenu.UserMentionMenuItem.inviteToastMessage"},pageInviteToastInviteButton:{defaultMessage:"Invite",id:"mentionMenu.UserMentionMenuItem.inviteToastInviteButton"},pageInviteToastIgnoreButton:{defaultMessage:"Ignore",id:"mentionMenu.UserMentionMenuItem.inviteToastIgnoreButton"},pageInviteSnackbarSuccessTitle:{defaultMessage:"Invite sent",id:"mentionMenu.UserMentionMenuItem.snackbarInviteSuccessTitle"},pageInviteSnackbarSuccessMessage:{defaultMessage:"They were notified and invited to edit the page.",id:"mentionMenu.UserMentionMenuItem.snackbarInviteSuccessMessage"},pageInviteUndo:{defaultMessage:"Undo",id:"mentionMenu.UserMentionMenuItem.undoToastMessage"}});var $r=()=>n(842599);function Qr(e){const{numberOfUserResults:t,templateVariableResults:n,query:o}=e,s=o.length>0,a=(0,v().K8)((()=>xs().Ay.state.open&&xs().Ay.state.insertionType),[]),r=function(e){const{templateVariableResults:t,query:n,numberOfUserResults:i}=e,o=(0,v().K8)((()=>xs().Ay.state.open),[]),s=(0,v().K8)((()=>xs().Ay.state.open?xs().Ay.state.sectionOrder:void 0),[]),a=function(e){const{numberOfUserResults:t,templateVariableResults:n,query:i}=e,o=t+n.length;if(""===i||o>0||(0,$r().xn)(i))return!0;const s=n.some((e=>(0,ha().BX)(e,"user")));if(s)return!0;return!1}({numberOfUserResults:i,templateVariableResults:t,query:n});if(o&&s)return s;if(a)return Jr;return Zr}({numberOfUserResults:t,templateVariableResults:n,query:o});return(0,i.useMemo)((()=>{const e=r,t=(0,ui().sb)([...e,...xs().kc]),n=t.filter((e=>"createPage"!==e));return"+"===a?["createPage",...n]:"@"===a&&s||"[["===a?[...n,"createPage"]:t}),[s,a,r])}const Zr=["date","page","team","group","heading","user","bot"],Jr=["date","user","bot","page","team","group","heading"];function Xr(e){const{query:t,clearSavedSelection:n,inviteTargetsStore:o,personPropertyInviteStore:a,mentionMenuCurrentMentionStore:r,mentionMenuCurrentFormulaStore:l,setTemporaryInputData:d,shouldIncludeDataSourceMentions:c}=e,[u,p]=(0,i.useState)(Zr[0]),g=(0,s().v3)(),m=(0,v().K8)((()=>(0,ma().y)(g)),[g]),f=(0,Ye().DP)(),h=(0,s().WS)(),y=(0,si().X)("mention_agents_in_notion"),{expandSection:S,isOpen:A,collectionStore:M}=(0,v().K8)((()=>({isOpen:xs().Ay.state.open,expandSection:xs().Ay.state.open?xs().Ay.state.expandSection:void 0,collectionStore:xs().Ay.state.open?xs().Ay.state.collectionStore:void 0})),[]),w=function(e){const t=(0,q().tz)();return(0,v().K8)((()=>xs().Ay.state.mentionTypes.templateVariable),[])?(0,ha().W4)(e,t):[]}(t),j=function(e){const t=(0,v().K8)((()=>xs().Ay.state.mentionTypes.formulaContextVariable),[]),{automationActionStore:n,typecheckResult:o}=(0,v().K8)((()=>({automationActionStore:xa().A.state.automationActionStore,typecheckResult:xa().A.state.typecheckResult})),[]),s=(0,i.useMemo)((()=>n&&o?(0,fa().getContextValuesForAction)({value:o},n.id):(null==o?void 0:o.valueTypes)||[]),[n,o]),a=o&&t;return(0,i.useMemo)((()=>a?(0,va().Ay)(e,s,(e=>e.kind!==js().FormulaContextValueKind.ContextValue?"":e.name),{normalizeFuzzyScore:!0}):[]),[a,e,s])}(t),{pageResultsSection:k,isPageResultsLoading:I}=(0,_r().v)({query:t,isFirstSection:"page"===u,setTemporaryInputData:d,formulaContextVariableResults:j,shouldIncludeDataSourceMentions:c}),C=or({templateVariableResults:w,formulaContextVariableResults:j,isFirstSection:"date"===u,query:t,setTemporaryInputData:d}),T=Ir({query:t,setTemporaryInputData:d,isFirstSection:"heading"===u}),{teamResultsSection:_,currentTeamResultStore:P}=function(e){const{isFirstSection:t,query:n,setTemporaryInputData:o,disabled:a=!1}=e,{teamResults:r,currentTeamResultStore:l}=Aa({query:n}),d=(0,s().v3)(),c=(0,Yi().r)(),u=(0,v().K8)((()=>W().oE(r.map((e=>{if(c)return{key:e.id,render:t=>(t.focused&&o({title:e.getName()||"",icon:(0,B.jsx)(Ps().sL,{}),allowTabCompletion:!0}),(0,i.createElement)(Tr().A,{...t,key:e.id,teamStore:e})),action:t=>{x().createAndCommit({userAction:"MentionMenu.teamMention",environment:d,canUndo:!0,perform:i=>{const o=b().DH3(e.id,c,"teamspace");Ts().Ju({environment:d,editorMode:"default",annotations:[o],transaction:i,menuListItemAction:t,query:n,mentionType:"team"})}})}}})))),[d,n,o,c,r]),p=(0,i.useMemo)((()=>{if(!a&&0!==u.length)return{key:"team results",render:e=>(0,B.jsx)(gn().A,{...e,title:(0,B.jsx)(q().sA,{defaultMessage:"Teams",id:"mentionMenu.teamSection.title"}),desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:u}}),[u,t,a]);return{currentTeamResultStore:a?void 0:l,teamResultsSection:p}}({isFirstSection:"team"===u,query:t,setTemporaryInputData:d}),{userResultsSection:D,isUserResultsLoading:R,numberOfUserResults:E}=Wr({isFirstSection:"user"===u,query:t,inviteTargetsStore:o,personPropertyInviteStore:a,mentionMenuCurrentMentionStore:r,setTemporaryInputData:d,templateVariableResults:w,formulaContextVariableResults:j,currentTeamResultStore:P,disabled:m}),L=br({isFirstSection:"group"===u,query:t,setTemporaryInputData:d}),O=Ha({isFirstSection:"createPage"===u,query:t,clearSavedSelection:n,setTemporaryInputData:d}),N=(0,ir().BT)({mentionMenuCurrentFormulaStore:l,setTemporaryInputData:d,isFirstSection:"formula"===u,formulaContextVariableResults:j}),F=(0,ir().bO)({query:t,formulaContextVariableResults:j,setTemporaryInputData:d,isFirstSection:"custom-formula"===u}),{botResultsSection:U,isBotResultsLoading:z}=Oa({isFirstSection:"bot"===u,query:t,setTemporaryInputData:d,disabled:m}),K=function(e){const{query:t,setTemporaryInputData:n,collectionStore:o,disabled:a=!1}=e,r=(0,s().v3)(),l=(0,v().K8)((()=>{if(!o||a)return[];const e=o.getSchema();return e?Object.entries(e).map((([e,t])=>({id:e,name:t.name||"",type:t.type}))):[]}),[o,a]),d=(0,i.useMemo)((()=>l.length?(0,va().Ay)(t,l,(e=>e.name)):[]),[l,t]),c=(0,Ye().DP)(),u=(0,i.useMemo)((()=>d.map((e=>({key:`property-${e.id}`,render:t=>(t.focused&&n({title:e.name,icon:(0,B.jsx)(Ps().sL,{}),allowTabCompletion:!0}),(0,B.jsx)(un().A,{...t,title:e.name,caption:e.type,inline:!0,icon:(0,B.jsx)(ws().zB,{type:e.type,icon:void 0,size:16,theme:c})})),action:n=>{if(!o)return;const i=b().ESw({property:e.id,collection:{table:Cr().Vl,id:o.id,spaceId:o.getSpaceId()},name:e.name});x().createAndCommit({userAction:"insertPropertyMention",environment:r,canUndo:!0,perform:e=>{Ts().Ju({environment:r,editorMode:"default",annotations:[i],transaction:e,menuListItemAction:n,query:t,mentionType:"property"})}})}})))),[d,n,o,r,t,c]);if((0,si().X)("database_agent_property_mention")||a){if(u.length&&!a)return{key:"property",render:e=>(0,B.jsx)(gn().A,{...e,title:(0,B.jsx)(q().sA,{id:"mentionMenu.propertySection",defaultMessage:"Properties"})}),items:u}}else Ee().log({level:"warning",from:"usePropertyResultsMenuSection",team:"editor",type:"propertyMentionFeatureGateDisabled",data:{gateName:"database_agent_property_mention",collectionId:null==o?void 0:o.id}})}({isFirstSection:"property"===u,query:t,setTemporaryInputData:d,collectionStore:M,disabled:!M}),V=(0,i.useMemo)((()=>({date:C,user:D,page:k,group:L,team:_,heading:T,createPage:O,formula:N,"custom-formula":F,property:K,bot:y?U:void 0})),[C,y,D,k,L,_,T,O,N,F,K,U]),G=Qr({templateVariableResults:w,numberOfUserResults:E,query:t});(0,i.useEffect)((()=>{const e=G.find((e=>void 0!==V[e]));p(e??G[0])}),[V,G]);const H=!R&&!I&&!z;(0,i.useEffect)((()=>{const e=ga().default.DO_NOT_USE_markLegacy("rum.mention_menu_ready");H&&ga().default.DO_NOT_USE_measureLegacy(e,{environment:g})}),[g,H]);const Y=(0,i.useCallback)((e=>function(e){const{sectionName:t,menuSection:n,isOpen:i,expandSection:o,theme:s,isPhone:a}=e;if(!i||o===t)return n;const{items:r}=n,l=a||"heading"===t?3:5;if(r.length<=l)return n;const d=[...r.slice(0,l),{key:"show more",render:e=>(0,B.jsx)(un().A,{...e,icon:(0,pa()._)({width:16,fill:s.text.secondary}),title:(0,B.jsx)("span",{style:{color:s.text.secondary},children:(0,B.jsx)(q().sA,{defaultMessage:"{numberMore} more results",id:"mentionMenu.showMoreResultsButton.title",values:{numberMore:r.length-l}})})}),action:()=>{xs().Ay.updateOpenState({expandSection:t})}}];return{...n,items:d}}({sectionName:e.sectionName,menuSection:e.menuSection,isPhone:h,isOpen:A,expandSection:S,theme:f})),[h,A,S,f]);return(0,i.useMemo)((()=>{const e=[];for(const t of G){const n=V[t];n&&(m&&"user"===t||e.push("createPage"===t?n:Y({sectionName:t,menuSection:n})))}return e}),[G,V,Y,m])}const el=(0,q().YK)({noResults:{defaultMessage:"No results",id:"mentionMenu.noSearchResults.title"}}),tl=(0,q().YK)({mentionAll:{defaultMessage:"Mention a person, page, or dateâ€¦",id:"mentionMenu.personPageDate.prompt2"},mentionPersonPage:{defaultMessage:"Mention a person or pageâ€¦",id:"mentionMenu.personPage.prompt2"},mentionPersonDate:{defaultMessage:"Mention a person or dateâ€¦",id:"mentionMenu.personDate.prompt2"},mentionPageDate:{defaultMessage:"Mention a page or dateâ€¦",id:"mentionMenu.pageDate.prompt2"},mentionPerson:{defaultMessage:"Mention a personâ€¦",id:"mentionMenu.person.prompt2"},mentionDate:{defaultMessage:"Mention a dateâ€¦",id:"mentionMenu.date.prompt2"},mentionPage:{defaultMessage:"Type to link or add pageâ€¦",id:"mentionMenu.page.prompt2"}}),nl=i.memo((function(e){const{query:t,queryRef:n,clearSavedSelection:i,inviteTargetsStore:o,personPropertyInviteStore:s,mentionMenuCurrentMentionStore:a,mentionMenuCurrentFormulaStore:r}=e;return(0,B.jsx)(il,{query:t,queryRef:n,clearSavedSelection:i,inviteTargetsStore:o,personPropertyInviteStore:s,mentionMenuCurrentMentionStore:a,mentionMenuCurrentFormulaStore:r})}));function il({query:e,queryRef:t,clearSavedSelection:o,inviteTargetsStore:a,personPropertyInviteStore:r,mentionMenuCurrentMentionStore:l,mentionMenuCurrentFormulaStore:d}){const c=(0,q().tz)(),u=(0,s().v3)(),p=(0,v().O$)(xs().Ay),g=(0,v().O$)(Re().e),m=Boolean(p.open&&p.usePopupOnMobile),f=Ls(t),h=Xr({clearSavedSelection:o,query:e,inviteTargetsStore:a,personPropertyInviteStore:r,mentionMenuCurrentMentionStore:l,mentionMenuCurrentFormulaStore:d,setTemporaryInputData:f,shouldIncludeDataSourceMentions:p.mentionTypes.collection}),y=(0,n(111043).o)();(0,i.useEffect)((()=>{if(!g)return;const e=p.mentionTypes.user,t=p.mentionTypes.page,n=p.mentionTypes.date;let i="";e&&t&&n?i=c.formatMessage(tl.mentionAll):e&&t?i=c.formatMessage(tl.mentionPersonPage):e&&n?i=c.formatMessage(tl.mentionPersonDate):t&&n?i=c.formatMessage(tl.mentionPageDate):e?i=c.formatMessage(tl.mentionPerson):n?i=c.formatMessage(tl.mentionDate):t&&p&&(i=p.open&&"+"===p.insertionType?c.formatMessage(ua.addPage):c.formatMessage(tl.mentionPage)),f({title:i,icon:(0,B.jsx)(Ps().gf,{insertionType:p.open?p.insertionType:"+"}),allowTabCompletion:!1})}),[g,f,c,p]);const b=(0,Ye().IS)((e=>({offlineMessage:{display:"flex",gap:4,alignItems:"center",background:e.background.secondary,borderRadius:4,padding:"8px 12px",margin:"12px 12px 0"},offlineIcon:{height:18,width:18,fill:e.icon.secondary}})),[]);let S;g||(S=(0,B.jsxs)("div",{style:b.offlineMessage,children:[(0,n(553034).C)(b.offlineIcon),(0,B.jsx)(kn().A,{isSmall:!0,isMobile:N().A.isMobile,showTooltipWhenTruncated:!0,children:(0,B.jsx)(q().sA,{defaultMessage:"Offline: Connect to see all options",id:"mentionMenu.offlineMessage"})})]}));const{device:x}=u,M=(0,v().K8)((()=>(0,Bs().W)()),[]),j=Gs(u,t);let k;k=Hs({usePopupOnMobile:m})?{menuType:w().gu.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${y}px)`}:{menuType:w().gu.Popup,width:M,maxHeight:x.isMobile?"30vh":"40vh",onClickOutside:j};const I=(0,i.useCallback)((e=>{(function(e){return""===e})(t.current??"")&&(e.preventDefault(),j())}),[t,j]);return(0,B.jsxs)(A().A,{...k,header:S,children:[(0,B.jsx)(At().N,{debugName:"MentionMenu",capture:p.open,onBackspace:I}),(0,B.jsx)(pn().Ay,{type:pn().Oh.Vertical,initialFocus:0,sections:h,onEmptyEnter:j,resetInitialFocusOnSectionChange:!0,performHandleEnterOnTab:!0}),0===h.length?(0,B.jsx)(gn().A,{children:(0,B.jsx)(n(64e3).A,{title:(0,B.jsx)(q().sA,{...el.noResults})})}):void 0]})}function ol(){const e=(0,s().v3)(),t=(0,v().O$)(xs().Ay),n=t.open&&t.showCreateIn,o=t.open&&t.showInvite,a=t.open&&t.showMentionAndShare,r=t.open&&t.showFormulaProperty,l=Boolean(t.usePopupOnMobile),d=(0,v().uB)(void 0,vs().Ay),c=(0,v().uB)(void 0,hs().A),u=(0,v().uB)(void 0,zs),p=(0,v().uB)(void 0,Ss),g=(0,v().K8)((()=>{if(t.open)return k().aX(t.textStore,t.oldTextValue,t.isEmptyPageTitle?"":t.insertionType)}),[t]),m=(0,v().K8)((()=>{if(g&&t.open)return k().mX(t.textStore,g)}),[g,t]),f=(0,v().K8)((()=>Ks(e,m)),[e,m]),h=(0,i.useRef)(f);(0,i.useEffect)((()=>{h.current=f}),[f]);const b=(0,v().K8)((()=>!!t.open&&("+"!==t.insertionType||""!==f)),[f,t]),S=(0,v().K8)((()=>(0,on().a)()),[]),x=b&&(S&&(n||o)||a),{clearSavedSelection:A,getSavedSelection:I}=(0,fs().A)({shouldPreserveTextSelection:x,shouldPreserveBlockSelection:!1,shouldRestoreSelection:x});(0,i.useEffect)((()=>{const e=xs().Ay.state;if(e.open){var t;const n=T().default.state,i="editing"===n.mode?(0,j().H)(n.multiSelection):void 0,o=(null==i?void 0:i.store)===e.textStore,s=I().textSelectionState,a=s&&"editing"===s.mode&&(null===(t=(0,j().H)(s.multiSelection))||void 0===t?void 0:t.store)===e.textStore;if(!o&&!a)return void(0,xs().q6)();const r=o&&(null==i?void 0:i.selection);if(g&&r&&(r.startIndex<g.filter.startIndex||r.endIndex>g.filter.endIndex))return void(0,xs().q6)();const l=m&&m[0];if("+"===e.insertionType&&l&&!(0,ms().D$)(l))return void(0,xs().q6)();if("@"===e.insertionType&&l&&(0,ms().Yv)(l))return void(0,xs().q6)();void 0!==m||e.isEmptyPageTitle||(0,xs().q6)()}}),[m,I,g]);const[C,_]=(0,i.useState)(void 0),P=gs().A.getSize(),D=(0,v().K8)((()=>{if(N().A.isMobile&&0!==P)return gs().A.find((e=>e.isCaptured()))}),[P]);(0,i.useEffect)((()=>{const e=null==D?void 0:D.getNode();if(e){const t=new(As().E);return t.observe(e),t.rect.addListener((e=>{_({height:`calc(100vh - ${e.state.height}px)`})})),()=>t.destroy()}}),[D]);const R=Hs({usePopupOnMobile:l}),E=R?y().n.SlideUp:y().n.Popup,L=Gs(e,h);return(0,B.jsx)(M().Ay,{popupType:E,open:b,originRect:t.open?t.selectionRect?{...t.selectionRect,left:t.selectionRect.left-22*((0,ps().A1)()?-1:1)}:t.selectionRect:void 0,slideUpWrapStyle:C,placementToOrigin:"bottom",alignmentToOrigin:"start",originGap:12,disableMouseCapture:!o,disableContentScroll:!0,onDismiss:L,disableDarkOverlayBackground:N().A.isMobile,keepFocus:!0,trapFocus:!1,render:()=>N().A.isMobile?(0,B.jsxs)(B.Fragment,{children:[a||n?void 0:(0,B.jsx)(nl,{query:f,queryRef:h,clearSavedSelection:A,inviteTargetsStore:d,personPropertyInviteStore:c,mentionMenuCurrentMentionStore:u,mentionMenuCurrentFormulaStore:p}),(0,B.jsx)(M().Ay,{popupType:y().n.SlideUp,render:()=>(0,B.jsx)($s,{clearSavedSelection:A,filter:m}),open:n,keepFocus:!0,trapFocus:!1}),(0,B.jsx)(M().Ay,{popupType:y().n.SlideUp,render:()=>(0,B.jsx)(Xs,{inviteTargetsStore:d,personPropertyInviteStore:c,filter:m}),open:o,keepFocus:!0,trapFocus:!1}),(0,B.jsx)(M().Ay,{popupType:E,render:()=>(0,B.jsx)(ca,{mentionMenuCurrentMentionStore:u,menuPopupType:R?w().gu.ActionSheet:w().gu.Popup}),open:a,keepFocus:!0,originRect:t.open?t.selectionRect:void 0,slideUpWrapStyle:C,placementToOrigin:"bottom",alignmentToOrigin:"start",originGap:12,isFullWidthOnMobile:!0,trapFocus:!1}),(0,B.jsx)(M().Ay,{keepFocus:!0,open:r,popupType:y().n.SlideUp,render:()=>(0,B.jsx)(Ns,{mentionMenuCurrentFormulaStore:p,queryRef:h}),trapFocus:!1})]}):n?(0,B.jsx)($s,{clearSavedSelection:A,filter:m}):o?(0,B.jsx)(Xs,{inviteTargetsStore:d,personPropertyInviteStore:c,filter:m}):a?(0,B.jsx)(ca,{mentionMenuCurrentMentionStore:u,menuPopupType:w().gu.Popup}):r?(0,B.jsx)(Ns,{mentionMenuCurrentFormulaStore:p,queryRef:h}):(0,B.jsx)(nl,{query:f,queryRef:h,clearSavedSelection:A,inviteTargetsStore:d,personPropertyInviteStore:c,mentionMenuCurrentMentionStore:u,mentionMenuCurrentFormulaStore:p})})}var sl=()=>n(415651),al=()=>n(490884),rl=()=>n(559926),ll=()=>n(209660),dl=()=>n(755199),cl=()=>n(680074),ul=()=>n(522094);const pl={...al().k2,csv:[...al().k2.csv,"text/csv"]},gl=al().fF.filter((e=>["csv","docx","html","txt","markdown","pdf"].includes(e)));function ml(e){return Object.keys(pl).includes(e)}function fl(e){var t;const{type:n,environment:i}=e,o=function(e){for(const t of Object.keys(pl)){if(!ml(t))continue;const n=pl[t];if((Array.isArray(n)?n.flat(1/0):[n]).includes(e))return t}}(n);if(!o||"string"!=typeof n||!gl.includes(o))return;const s=(0,cl().R$)(i),a=null==s||null===(t=s.getSettings())||void 0===t?void 0:t.adoption_entry_points,r=a?null==a?void 0:a.import_nudge_on_drag:void 0;if(r&&r.length>0)return;O().default.checkGate({gateName:"contextualized_import_entrypoints"})&&((0,Pi().t)({environment:i,action:"view",from:"import_nudge_on_drag"}),ja().Iz({message:rn().A.formatMessage(hl.triggerNudgeOnDragDescription),presentationType:"transient",id:"nudge-on-drag",title:rn().A.formatMessage(hl.triggerNudgeOnDragTitle),onUserDismiss:()=>{(0,Pi().t)({environment:i,action:"dismiss",from:"import_nudge_on_drag"})},onDismiss:()=>{dl().pr(i,{entryPoint:"import_nudge_on_drag"})},actions:{primary:{title:rn().A.formatMessage(hl.triggerNudgeOnDragPrimaryAction),onAction:()=>{const e=ul().A.getOrCreateFlowId();(0,Pi().t)({environment:i,action:"click",from:"import_nudge_on_drag"}),rl().kY(i,{from:"import_nudge_on_drag",flowId:e}),ja().UW("nudge-on-drag"),ll().Ow({currentTab:"imports",openedFrom:"import_nudge_on_drag",subtab:o})}}}}))}const hl=(0,q().YK)({triggerNudgeOnDragTitle:{id:"adoption.nudgeOnDrag.title",defaultMessage:"Try importing your file"},triggerNudgeOnDragDescription:{id:"adoption.nudgeOnDrag.description",defaultMessage:"You can import this file to directly edit your content in a Notion database"},triggerNudgeOnDragPrimaryAction:{id:"adoption.nudgeOnDrag.primaryAction",defaultMessage:"Import now"}});const vl=function(){const e=(0,s().v3)(),t=(0,i.useRef)(void 0);return(0,i.useEffect)((()=>{const n=t=>{var n;if(null!==(n=t.dataTransfer)&&void 0!==n&&n.types.includes("application/x.notion.tab-id"))return t.dataTransfer.dropEffect="move",void t.preventDefault();t.preventDefault(),function(e,t){const n=sl().v7(t,{startX:e.clientX,startY:e.clientY,stores:[],isNativeDrag:!0,getGhostElement:void 0});n&&tt().IU({environment:t})}(t,e),i(t)},i=W().nF((n=>{t.current&&window.clearTimeout(t.current),t.current=window.setTimeout(bl,function(e){const{device:t}=e;if(t.isLinux)return 2e3;if(t.isIOS&&O().default.checkGate({gateName:"ios_native_drag_handler_delay"}))return 1e3;return 200}(e),e),sl().GB(e,{currentX:n.clientX,currentY:n.clientY})}),yl),o=t=>{!function(e,t){var n;e.preventDefault();const i=Array.from((null===(n=e.dataTransfer)||void 0===n?void 0:n.files)||[]);i.length>0&&(fl({environment:t,type:i[0].type}),sl().b({environment:t,files:i,analyticsFrom:"native_drag"}))}(t,e)};return window.addEventListener("dragover",n),window.addEventListener("drop",o),()=>{window.removeEventListener("dragover",n),window.removeEventListener("drop",o)}}),[e]),null},yl=62.5;function bl(e){sl().Pt(e)}var Sl=()=>n(211716),xl=()=>n(906537),Al=()=>n(35392);const Ml=function(){const e=(0,s().v3)(),t=(0,v().K8)((()=>{const e=T().default.state;if("editing"!==e.mode)return null;const t=(0,j().H)(e.multiSelection);if(!t)return null;const{store:n,selection:i}=t;if(i.endIndex!==i.startIndex+1)return null;const o=n.getValue(),s=b().ANx(o,i.startIndex);if(!s||!b().rjO(s))return null;const[a]=b().N5L([s]);return{pageId:a,store:n}}),[]),n=(0,i.useCallback)((()=>(0,B.jsx)(wl,{pageMentionTokenStoreState:t})),[t]);if(e.device.isMobile)return null;const o=xl().getSelectionRect();return(0,B.jsx)(rt().A,{render:()=>{},renderTooltip:n,originRect:o,forceVisibleState:Boolean(t&&o),placement:"bottom"})};function wl({pageMentionTokenStoreState:e}){const t=(0,Ye().DP)(),n=(0,s().v3)(),o=(0,i.useCallback)((t=>function(e,t,n){if(!n)return;const{pageId:i,store:o}=n;if(!i)return;e.preventDefault();const s=xn().B.createChildStore(o,{table:yn().ev,id:i});bn().uK({store:s,environment:t,visitType:Sl().ig.Link,openInNew:"tab",pageVisitSource:U().y8.MentionInPage})}(t,n,e)),[n,e]),a=(0,i.useCallback)((t=>function(e,t,n){if(!n)return;const{pageId:i,store:o}=n;if(!i)return;e.preventDefault&&e.preventDefault();const s=xn().B.createChildStore(o,{table:yn().ev,id:i});bn().uK({store:s,environment:t,visitType:Sl().ig.Link,pageVisitSource:U().y8.MentionInPage})}(t,n,e)),[n,e]);return(0,B.jsx)(At().N,{debugName:"PageMentionOverlay",capture:!0,onEnter:a,onCommandEnter:o,children:(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(q().sA,{defaultMessage:"Open page",id:"pageMentionOverlay.openPage"}),(0,B.jsx)("div",{children:(0,B.jsx)(Al().A,{onlyShowFirst:!0,name:"enter",style:{color:t.text.inverseSecondary}})})]})})}var jl=()=>n(569577),kl=()=>n(391381),Il=()=>n(315957);const Cl=Object.freeze({property:!0});function Tl(){const e=(0,q().tz)(),t=(0,Ye().DP)(),n=(0,s().v3)(),{device:o}=n,a=(0,v().K8)((()=>Il().A.state.blockStore),[]),r=(0,v().K8)((()=>null==a?void 0:a.getTitleStore()),[a]),l=(0,v().K8)((()=>(null==a?void 0:a.canEdit())??!1),[a]),d=(0,v().K8)((()=>{var t;return(null==a||null===(t=a.getModel())||void 0===t?void 0:t.getEmptyTitlePlaceholder({getRecordModel:a.getRecordModel,userTimeZone:(0,z().P)(),intl:e}))??""}),[a,e]);if((0,i.useEffect)((()=>{const{blockStore:e}=Il().A.state;if(!e)return;const t=e.getTitleStore();t&&(0,kl().x)({environment:n,store:t,canSelectAllBlocks:!1})}),[n]),!a||!r)return null;let c;return c=o.isMobile?{menuType:w().gu.ActionSheet}:{menuType:w().gu.Popup,width:380},(0,B.jsx)(A().A,{...c,children:(0,B.jsx)("div",{style:Pl(t),children:(0,B.jsx)(lt().A,{store:r,disabled:!l,onEsc:()=>jl().V(n),onEnter:()=>jl().V(n),onTab:()=>!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,placeholder:d,style:Bl(t),pasteBehavior:"inline",inPageFind:ot().Os.none,disabledMentionTypes:Cl})})})}const _l=function(){const e=(0,s().v3)(),{device:t}=e,{blockStore:n,originRect:i}=(0,v().K8)((()=>{const{blockStore:e,originRect:t}=Il().A.state;return{blockStore:e,originRect:t}}),[]);return(0,B.jsx)(M().Ay,{popupType:t.isMobile?y().n.SlideUp:y().n.Popup,open:Boolean(n),originRect:i,placementToOrigin:"bottom",alignmentToOrigin:"center",originGap:4,onDismiss:()=>jl().V(e),render:()=>(0,B.jsx)(Tl,{}),trapFocus:!0})};function Pl(e){return{display:"flex",alignItems:"center",color:e.text.primary,fontSize:"13px",padding:"4px 8px"}}function Bl(e){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingInlineStart:10,paddingInlineEnd:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}}var Dl=()=>n(236262),Rl=()=>n(384944),El=()=>n(898286),Ll=()=>n(270710),Ol=()=>n(187820);const Nl={property:!0};function Fl(e){const t=(0,q().tz)(),n=(0,s().v3)(),{device:o}=n,a=(0,v().K8)((()=>Ll().A.state.clonedBlockStore),[]),r=(0,v().K8)((()=>null==a?void 0:a.getTitleStore()),[a]),l=(0,v().K8)((()=>(null==a?void 0:a.canEdit())??!1),[a]),d=(0,v().K8)((()=>{var e;if(a)return null===(e=a.getModel())||void 0===e?void 0:e.getEmptyTitlePlaceholder({getRecordModel:a.getRecordModel,userTimeZone:(0,z().P)(),intl:t})}),[a,t]);(0,i.useEffect)((()=>{if(!a)return;const e=a.getTitleStore();e&&(0,kl().x)({environment:n,store:e,canSelectAllBlocks:!1})}),[a,n]);const c=(0,Ye().IS)((e=>({wrapper:{display:"flex",alignItems:"center",color:e.text.primary,fontSize:"13px",padding:"4px 8px"},input:{display:"block",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingInlineStart:10,paddingInlineEnd:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}})),[]);if(!a||!r)return null;const{renderDelete:u}=e;let p;return p=o.isMobile?{menuType:w().gu.ActionSheet}:{menuType:w().gu.Popup,width:380},(0,B.jsx)(A().A,{...p,children:(0,B.jsxs)("div",{style:c.wrapper,children:[(0,B.jsx)(Vl,{blockStore:a}),(0,B.jsx)(lt().A,{store:r,disabled:!l,onEsc:()=>El().V(n),onEnter:()=>El().V(n),onTab:()=>!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,placeholder:d,style:c.input,pasteBehavior:"inline",inPageFind:ot().Os.none,disabledMentionTypes:Nl}),u&&l?(0,B.jsx)(zl,{}):void 0]})})}const Ul=function(){const e=(0,s().v3)(),{device:t}=e,{clonedBlockStore:n,originRect:i}=(0,v().K8)((()=>{const{clonedBlockStore:e,originRect:t}=Ll().A.state;return{clonedBlockStore:e,originRect:t}}),[]);return(0,B.jsx)(M().Ay,{popupType:t.isMobile?y().n.SlideUp:y().n.Popup,open:Boolean(n),originRect:i,placementToOrigin:"bottom",alignmentToOrigin:"center",originGap:4,onDismiss:()=>El().V(e),render:()=>(0,B.jsx)(Kl,{}),trapFocus:!0})};function zl(){const e=(0,s().v3)(),t=(0,q().tz)();return(0,B.jsx)(at().A,{ariaLabel:t.formatMessage({id:"renamePageMenu.deleteButton.ariaLabel",defaultMessage:"Delete"}),icon:e=>(0,Dl().trashIcon)({height:20,width:20,...e}),style:{marginInlineStart:6},hasBackground:!0,colorVariant:"primary",showShadow:!0,onClick:async()=>{const{originalBlockStore:t}=Ll().A.state;t&&await ho().Af({environment:e,blocks:[t],shouldCheckSuggestEdit:!0}),El().V(e)}})}function Kl(){const e=(0,v().K8)((()=>Ll().A.state.renderDelete),[]);return(0,B.jsx)(Fl,{renderDelete:Boolean(e)})}function Vl({blockStore:e}){const t=(0,Ye().DP)(),n=(0,s().v3)(),i={width:28,height:28,marginInlineEnd:6,flexShrink:0,flexGrow:0,boxShadow:`inset 0 0 0 1px ${t.darkDividerColor}`},o=(0,v().K8)((()=>e.canEdit()),[e]),a=(0,v().K8)((()=>{var t;return null===(t=e.getIconStore())||void 0===t?void 0:t.table}),[e]),r=(0,v().K8)((()=>{var t;return null===(t=e.getIconStore())||void 0===t?void 0:t.id}),[e]),l=(0,v().K8)((()=>e.getIcon()),[e]),d=(0,v().K8)((()=>e.isEmptyPage()),[e]),c=(0,v().K8)((()=>e.getType()),[e]),u=(0,v().K8)((()=>(0,Ol().Te)(e)),[e]);return o?(0,B.jsx)(Ol().B6,{disabled:!1,bucket:"secure",store:e,icon:l,iconRecordCategory:u,isEmptyPage:d,size:18,style:i,iconLoggingData:{recordTable:a,source:"breadcrumb",block_type:c,collection_id:"collection"===a?r:void 0},onChange:e=>function(e,t){const{clonedBlockStore:n}=Ll().A.state;if(n){const i=n.getIconStore();i&&x().createAndCommit({userAction:"RenamePageMenuPopup.handleRecordIconChange",environment:t,canUndo:!0,perform:t=>{Rl().KY({store:i,value:e,transaction:t})}})}}(e,n)}):(0,B.jsx)(Ol().B6,{disabled:!0,icon:l,iconRecordCategory:u,isEmptyPage:d,size:18,style:i})}n(823215);var ql=()=>n(551541),Wl=()=>n(587682),Gl=()=>n(718827),Hl=()=>n(713998),Yl=()=>n(324254),$l=()=>n(476195),Ql=()=>n(703778),Zl=()=>n(156425);const Jl={viewBox:"0 0 16 16",fittedViewBox:"4.31 3.03 7.37 9.94",svg:(0,B.jsx)("path",{d:"M5.143 3.035a.825.825 0 0 0-.825.825v8.28c0 .456.369.825.825.825H8.19c1.116 0 2.02-.241 2.645-.802.646-.578.847-1.357.847-2.093 0-.948-.436-1.733-1.117-2.245.514-.526.736-1.2.736-1.895 0-.904-.438-1.63-1.08-2.127s-1.488-.768-2.314-.768zm.825 4.14v-2.49h1.94c1.12 0 1.744.688 1.744 1.245 0 .38-.125.641-.365.83-.27.213-.789.415-1.724.415zm0 4.14v-2.49h2.561c.495 0 .87.152 1.122.38.25.23.382.54.382.865 0 .447-.117.702-.297.864-.2.179-.63.381-1.545.381z"})},Xl=(0,no().wt)("textBoldSmall",Jl),ed={viewBox:"0 0 16 16",fittedViewBox:"4.49 3.23 7.02 9.54",svg:(0,B.jsx)("path",{d:"M10.88 3.235h-3.6a.625.625 0 0 0 0 1.25h.991l-1.834 7.03H5.12a.625.625 0 1 0 0 1.25h3.6a.625.625 0 0 0 0-1.25h-.99l1.833-7.03h1.317a.625.625 0 1 0 0-1.25"})},td=(0,no().wt)("textItalicSmall",ed),nd={viewBox:"0 0 16 16",fittedViewBox:"2.33 2.69 11.34 10.61",svg:(0,B.jsx)("path",{d:"M11.505 10.553c0-.732-.226-1.391-.74-1.928h2.275a.625.625 0 1 0 0-1.25H8.065c-.94-.201-1.516-.483-1.853-.792-.319-.293-.467-.65-.467-1.136 0-.413.192-.766.565-1.036.385-.278.968-.466 1.69-.466s1.306.188 1.691.466c.373.27.564.623.564 1.036a.625.625 0 1 0 1.25 0c0-.863-.426-1.574-1.081-2.048-.644-.466-1.5-.704-2.424-.704s-1.78.238-2.423.704c-.656.474-1.082 1.185-1.082 2.048 0 .732.226 1.391.74 1.928H2.96a.625.625 0 0 0 0 1.25h4.975c.94.201 1.517.483 1.853.792.319.293.467.65.467 1.136 0 .413-.191.766-.564 1.036-.386.278-.969.466-1.691.466s-1.306-.187-1.69-.466c-.374-.27-.565-.623-.565-1.036a.625.625 0 0 0-1.25 0c0 .863.426 1.574 1.081 2.048.644.466 1.5.704 2.424.704s1.78-.238 2.424-.704c.655-.474 1.08-1.185 1.08-2.048"})},id=(0,no().wt)("textStrikethroughSmall",nd),od={viewBox:"0 0 16 16",fittedViewBox:"2.33 3.23 11.33 11.51",svg:(0,B.jsx)("path",{d:"M3.68 3.235a.625.625 0 0 0 0 1.25h.455v4.307c0 .955.294 1.908.952 2.63.668.73 1.654 1.163 2.913 1.163 2.23 0 3.865-1.793 3.865-3.793V4.485h.455a.625.625 0 1 0 0-1.25h-2.16a.625.625 0 0 0 0 1.25h.455v4.307c0 1.327-1.093 2.543-2.615 2.543-.957 0-1.59-.32-1.99-.756-.407-.447-.625-1.079-.625-1.787V4.485h.455a.625.625 0 0 0 0-1.25zm-.72 10.26a.625.625 0 1 0 0 1.25h10.08a.625.625 0 1 0 0-1.25z"})},sd=(0,no().wt)("textUnderlineSmall",od);var ad=()=>n(843005),rd=()=>n(741496),ld=()=>n(21869),dd=()=>n(332751);function cd(e){const{clientSkill:t}=e,n=(0,q().tz)(),i=(0,v().K8)((()=>n.formatMessage(t.displayName)),[t,n]);return(0,B.jsx)(B.Fragment,{children:i})}var ud=()=>n(602098),pd=()=>n(696418),gd=()=>n(790392);function md(e){if(e.inMemoryRecordCache.isMockTextStore){const t=(0,Ti().zH)(e);if(t.table===yn().ev){if("automation_id"in t.getProperties())return!0}}return Boolean(e.findRecordStoreUIAncestor((e=>e instanceof pd().b||e instanceof gd().d)).ancestor)}var fd=()=>n(746630),hd=()=>n(495506),vd=()=>n(481292),yd=()=>n(962845),bd=()=>n(478726),Sd=()=>n(494043),xd=()=>n(441199),Ad=()=>n(430483),Md=()=>n(337567),wd=()=>n(77246),jd=()=>n(195613),kd=()=>n(396831),Id=()=>n(285288),Cd=()=>n(170722),Td=()=>n(369241),_d=()=>n(496889),Pd=()=>n(452558),Bd=()=>n(406699),Dd=()=>n(720263),Rd=()=>n(209416),Ed=()=>n(473227);function Ld(e){const t=(0,s().v3)(),{isMobile:n}=(0,s().Y0)(),o=(0,v().K8)((()=>"suggest"===wd().Uv.getMode(e.blockStore)),[e.blockStore]),a=()=>{const n=e.blockStore.getRecordStoreUIRoot();n&&n instanceof xn().B&&n.isNavigableBlock()&&Ed().PD({environment:t,navigableBlockStore:n,mode:o?"default":"suggest",location:"rich_text_menu"})},r=(0,Ye().IS)((t=>({button:{display:"flex",alignItems:"center",padding:e.iconOnly?6:"0 6px",whiteSpace:"nowrap",gap:4,color:o?t.blue.icon.accentPrimary:t.icon.primary,...e.style},keyboardShortcut:{color:t.text.inverseSecondary}})),[o,e.iconOnly,e.style]);return(0,B.jsx)(rt().A,{renderTooltip:()=>(0,B.jsxs)(i.Fragment,{children:[(0,B.jsx)("div",{children:o?(0,B.jsx)(q().sA,{defaultMessage:"Turn off suggesting",id:"inlineSuggestButton.tooltipDisable"}):(0,B.jsx)(q().sA,{defaultMessage:"Suggest edits",id:"inlineSuggestButton.tooltipEnable"})}),(0,B.jsx)("div",{children:(0,B.jsx)(Al().A,{style:r.keyboardShortcut,name:"suggest"})})]}),render:t=>(0,B.jsxs)(Gl().Ay,{style:r.button,disabled:e.disabled,disabledFeedback:e.disabled,onClick:a,...t,children:[(0,B.jsx)(Vt().I,{icon:Rd().a}),n||e.iconOnly?void 0:o?(0,B.jsx)(q().sA,{defaultMessage:"Suggesting",id:"inlineSuggestButton.suggestingLabel"}):(0,B.jsx)(q().sA,{defaultMessage:"Suggest",id:"inlineSuggestButton.suggestLabel"})]})})}var Od=()=>n(236228),Nd=()=>n(777849),Fd=()=>n(780243);function Ud(){var e;if(!(0,si().X)("selectable_word_count"))return null;const t=null===(e=xl().get())||void 0===e?void 0:e.cloneContents(),n=t?zd(t):0;return 0===n?null:(0,B.jsx)("div",{style:{justifyContent:"center",alignSelf:"center",whiteSpace:"pre-wrap",padding:"0px 6px"},children:(0,B.jsx)(q().sA,{id:"richTextMenu.wordCount",defaultMessage:"{count, plural, one {# word} other {# words}}",values:{count:n}})})}function zd(e){if(0===e.childNodes.length)return 0;let t=0;for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes[n];i.childNodes.length>0?t+=zd(i):i.textContent&&(t+=(0,Je().sQ)(i.textContent))}return t}const Kd={[Mt().xd.button]:new Set(["showActionButton","showCompletions","showDiscuss","showReact","showSuggest","showTurnInto"]),[Mt().xd.code]:new Set(["showCode","showCompletions"]),[Mt().xd.table]:new Set(["showTurnInto","showActionButton","showCompletions"]),[Mt().xd.tableRow]:new Set(["showTurnInto","showActionButton","showCompletions"]),[Mt().xd.aiBlock]:new Set(["showTurnInto","showActionButton","showCompletions","showSuggest","showDiscuss","showReact"])},Vd={[Mt().xd.factory]:!0};const qd=function(){const e=(0,Kt().S)(),t=(0,s().v3)(),o=(0,s().Y0)(),a=(0,v().O$)(Cd().A),{isActive:r,blockTarget:c,isAnimatingClosed:u}=a,p=(0,v().O$)(ae().AppStoreMainEditorCurrentBlockStore),g=(0,v().K8)((()=>Ad().zD.isRichTextMenuSuggestionEnabled()),[]),m=(0,v().K8)((()=>{var e;return"slack_notification"===(null===(e=xa().A.getState().automationActionStore)||void 0===e?void 0:e.getType())}),[]),[f,h]=(0,i.useState)(void 0),y=(0,i.useCallback)((()=>{var e;if(!g||!p)return;const n=(0,Zt().filterAndRankAssistantSurfaceActionsForContext)((0,Zt().clientSkillToAssistantSurfaceAction)((0,Jt().getAllClientSkills)({currentPageRecordPointer:void 0,currentCollectionRecordPointer:void 0})),{type:"entrypoint",entrypoint:"richTextMenu",pageStore:p,selectionState:cn().default.state,textSelectionState:T().default.state,isMobile:t.device.isMobile,userSettings:null===(e=ae().default.state.currentUserSettingsStore)||void 0===e?void 0:e.getSettings()});return n.length?n[0]:void 0}),[g,p,t]),S=(0,v().K8)((()=>{const t=c,i=T().default.state;if(!r||"empty"===i.mode)return;const{multiSelection:o}=i,s=(0,fi().K)(o);if(s){if(o.start.index+1===o.end.index){const e=(0,b().ANx)(o.start.store.getValue(),o.start.index);if(e&&(0,b().B8H)(e))return}if((0,vd().k)(o))return}const a=(0,yd().$W)(o),u=a.map((({editable:e})=>e.getContextClosestSelectableStore())),p=T().default.isEditingComment(),g=T().default.isEditingFormQuestion(),h=t&&"form"===t.getType(),v=g||h,y=T().default.isEditingCaption(),S=t&&t.getParentTable()===Cr().Vl,x=s&&t&&o.start.store===t.getCollectionViewSourceDescriptionStore(),A=n(747100).Gb(),M=null==e?void 0:e.publicEditModeStore.state,w=!(0,ka().QT)(M)&&(o.start.store.canEdit()&&o.end.store.canEdit()),j=t&&"suggest"===wd().Uv.getMode(t),k=O().default.checkGate({gateName:"block_reactions"}),I=u.some(((e,t)=>{const n=a[t].store.table===uo().SN&&!a[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!n})),C=w&&!I&&!a.some((e=>e.editable.props.disableFormattingAnnotations)),_=t&&t.getType(),P=_&&Kd[_],B=null==t?void 0:t.isType("button"),D=(0,ud().u)(o.start.store)||(0,ud().u)(o.end.store),R=md(o.start.store)||md(o.end.store);let E=!1;const L=l().A.state.isOpen?l().A.state:d().A.state.isOpen?d().A.state:void 0;if(L){const e=L.store.getParentStore();if((null==e?void 0:e.table)===Cr().Vl){const t=e.getSchema(),n=L.property,i=(0,Hl()._g)({schema:t,property:n});"text"!==(null==i?void 0:i.type)||i.ai_inference||(E=!0)}}const N={isSingleStoreSelection:s,showTurnInto:Boolean(s&&!p&&!S&&!x&&!y&&t&&C&&!B&&!j&&!v&&(D||!R)),showBold:Boolean(C),showItalic:Boolean(C),showStrikethrough:Boolean(C),showUnderline:Boolean(C)&&!m,showCode:Boolean(C)&&!m,showLink:Boolean(s&&C),showHighlight:Boolean(C)&&!m,showDiscuss:Boolean(!p&&t&&(E||!S)&&!x&&!v&&!R),showReact:Boolean(k&&!p&&t&&!S&&!x&&!R&&!v),showSuggest:Boolean(!p&&t&&!a.some((e=>e.editable.props.disableSuggestEdit))&&!S&&!x&&!R&&!A&&!I&&!v),showEquation:Boolean(s&&C&&!j&&!v&&!m),showActionButton:Boolean(s&&!p&&!y&&t&&!S&&!v&&!a.some((e=>e.editable.props.disableRichTextActions))&&(D||!R)),targetBlockStore:t,isComment:p,showCompletions:Boolean((0,n(68465).ZE)(M)&&C&&!p&&!y&&t&&!S&&!x&&!B&&!R&&!j&&!v),topRankedSkill:f};if(P&&P.size>0)for(const e of P)N[e]=!1;return N}),[c,r,null==e?void 0:e.publicEditModeStore,f,m]),[x,A]=(0,i.useState)(S);(0,i.useEffect)((()=>{S&&A(S)}),[S]);const M=(0,v().K8)((()=>t.WindowSizeStore.state.height),[t.WindowSizeStore]),w=(0,v().K8)((()=>S&&S.showDiscuss&&!S.showBold),[S]),j=(0,i.useCallback)((()=>{if(n(711319).A.state.open||Td().A.state.open)return;if(n(620149).l.state)return dd().I();const e=T().default.state;if("empty"===e.mode)return dd().I();const i=(0,yd().$W)(e.multiSelection);if(0===i.length)return dd().I();if(!i.every((({store:e})=>e.table===yn().ev||e.table===uo().SN||e.table===Cr().Vl||e.table===n(37165).lo)))return dd().I();if(!t.currentUser.isLoggedIn()||!i.every((({store:e})=>e.canComment())))return;const s=xl().get();if((0,n(560595).f)())return dd().I();if(i.some((({editable:e})=>e.props.disableStyleAnnotations)))return dd().I();const r=i.map((({editable:e})=>e.getContextClosestSelectableStore()));if(r.some((e=>e&&e.pathIsDead())))return dd().I();if(r.some((e=>e&&(0,Md().dL)(e))))return dd().I();if(r.some(((e,t)=>{const n=i[t].store.canComment(),o=i[t].store.table===uo().SN&&i[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!n||o})))return dd().I();const l=i.some((({store:e})=>{const t=(0,Ti().zH)(e);if(!(t instanceof xn().B))return!1;const n=t.getValue();return!!n&&Vd[n.type]}));if(l)return dd().I();const d=s?xl().getRect(s):void 0;if(d&&!Wl().HY(d,(0,ql().A)()))return dd().I();if(Ll().A.isActive()||Il().A.isActive()||Xo().A.isOpen()||l||xd().default.isPeekDismissableState()||!s||!function(){const e=xl().get();return void 0!==e&&!e.collapsed&&"empty"!==T().default.state.mode&&!(0,vd().k)(T().default.state.multiSelection)}()||n(807926).A.state.open||"assistantCompletionPopup"===dn().default.state.type)return dd().I();let c=0,u=0;if(d){c=(0,ps().A1)()?(0,ql().A)().width-d.right:d.left;const e=25,t=d.top-36-e,i=n(175947).ek(o.isElectronMac),s=M-36-e;u=Math.min(Math.max(t,i),s)}0===Math.abs(Cd().A.state.top-u)&&Math.abs(Cd().A.state.left-c)<10&&(u=Cd().A.state.top,c=Cd().A.state.left),h(y()),Cd().A.setState({...a,isActive:!0,isAnimatingClosed:!1,top:u,left:c,blockTarget:cn().default.state.stores[0]})}),[t.currentUser,M,o.isElectronMac,a,h,y]),k=(0,i.useMemo)((()=>W().nF(j,200,{leading:!1})),[j]);(0,i.useEffect)((()=>(cn().default.addListener(k),T().default.addListener(k),jd().A.addListener(j),Id().A.addListener(j),kd().A.addListener(j),xd().default.addListener(j),()=>{T().default.removeListener(k),cn().default.removeListener(k),jd().A.removeListener(j),Id().A.removeListener(j),kd().A.removeListener(j),xd().default.removeListener(j)})),[j,k]);const I=(0,v().K8)((()=>function(e){const t=null==e?void 0:e.getParentStore();if((null==t?void 0:t.table)===yn().ev)return!!t&&(0,bd().fc)(t);return!1}(c)),[c]),C=(0,i.useCallback)((()=>{a.isActive||Cd().A.setState({...a,isAnimatingClosed:!1}),A(S)}),[a,S]);return(0,B.jsx)(_n().hJ,{open:r||u,children:(0,B.jsx)(Gd,{handleAnimationEnd:C,isActive:r,isExternallyImportedAndSyncedCollectionPageBlockTarget:I,lastRenderState:x,richTextMenuStoreState:a,canOnlyDiscuss:w})})},Wd=i.forwardRef((function({lastRenderState:e,richTextMenuStoreState:t,canOnlyDiscuss:n,style:i},o){const{top:s,left:a}=t,r=Math.max(n?a:a-60,0),l=n?"12px 0":12;return(0,B.jsxs)("div",{className:sn().Vl,style:{pointerEvents:"none",position:"absolute",top:s,insetInlineStart:0,display:"flex",width:"100%",...i},ref:o,children:[(0,B.jsx)("div",{style:{flexShrink:1,width:r,minWidth:24}}),(0,vo().A)((t=>(0,B.jsx)("div",{style:{pointerEvents:"none",padding:l},...t,children:e?(0,B.jsx)(rc,{renderState:e}):void 0}))),(0,B.jsx)("div",{style:{flexGrow:1,flexShrink:1,minWidth:36}})]})}));function Gd({handleAnimationEnd:e,isActive:t,isExternallyImportedAndSyncedCollectionPageBlockTarget:n,lastRenderState:i,richTextMenuStoreState:o,canOnlyDiscuss:s}){return(0,B.jsx)(So().A,{tag:Wd,visible:t&&!n,initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.98},onAnimationEnd:e,config:{duration:120},lastRenderState:i,richTextMenuStoreState:o,canOnlyDiscuss:s})}function Hd({theme:e,styles:t}){return(0,B.jsx)("div",{style:{height:24,width:1,borderInlineEnd:`1px solid ${e.regularDividerColor}`,margin:"auto 6px",...t}})}function Yd({blockStore:e}){const t=(0,Ye().DP)(),n=(0,s().v3)(),i=(0,q().tz)();let o=(0,B.jsx)(q().sA,{defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.label"});const a=(0,v().K8)((()=>e.getType()),[e]);if(a){const e=hd().ry[a];o=e&&e.displayName||o}return(0,B.jsx)(Bd().A,{popupType:Bd().z.Popup,buttonPopupStore:Td().A,originGap:4,renderOrigin:e=>(0,B.jsx)(rt().A,{renderTooltip:()=>i.formatMessage({defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.tooltip"}),render:n=>(0,B.jsxs)(Gl().Ay,{style:{display:"flex",alignItems:"center",paddingInlineStart:7,paddingInlineEnd:6,gap:6,whiteSpace:"nowrap",color:t.icon.primary,borderRadius:6},...(0,za().A)(e,n),children:[o,(0,B.jsx)(Vt().I,{icon:Yl().arrowChevronSingleDownSmallIcon,size:"xs",colorVariant:"tertiary",fitToViewBox:"horizontal"})]})}),render:()=>(0,B.jsx)(A().A,{menuType:w().gu.Popup,children:(0,B.jsx)(Pd().A,{context:{blocks:[e],environment:n,publicEditMode:void 0,analyticsFrom:"rich_text_menu"},sections:[ad().t3],onAccept:t=>{const i=e.getType(),o=e.getFormat();dd().I(),(0,rd().N)(n,{analyticsName:t.analyticsName,action_type:t.analyticsActionType,from:"rich_text_menu",block_id:e.id,block_type:i,is_toggleable:i?(0,Sd().Yt)(i,o):void 0,parent_collection_id:e.getParentCollectionIdUpToTwoLevels()})}})}),onClick:()=>{(0,ld().s)(n,{action:"turn_into"})}})}function $d(){const e=(0,Ye().DP)();return(0,B.jsx)(Od().A,{type:"b",tooltipLabel:(0,B.jsxs)(i.Fragment,{children:[(0,B.jsx)("div",{children:(0,B.jsx)(q().sA,{defaultMessage:"Bold",id:"richTextMenu.boldButton.tooltip"})}),(0,B.jsx)("div",{children:(0,B.jsx)(Al().A,{style:{color:e.text.inverseSecondary},name:"toggleBold"})})]}),children:(0,B.jsx)(Vt().I,{icon:Xl,size:"sm"})})}function Qd(){const e=(0,Ye().DP)();return(0,B.jsx)(Od().A,{type:"i",tooltipLabel:(0,B.jsxs)(i.Fragment,{children:[(0,B.jsx)("div",{children:(0,B.jsx)(q().sA,{defaultMessage:"Italicize",id:"richTextMenu.italicsButton.tooltip"})}),(0,B.jsx)("div",{children:(0,B.jsx)(Al().A,{style:{color:e.text.inverseSecondary},name:"toggleItalics"})})]}),children:(0,B.jsx)(Vt().I,{icon:td,size:"sm"})})}function Zd(){const e=(0,Ye().DP)();return(0,B.jsx)(Od().A,{type:"s",tooltipLabel:(0,B.jsxs)(i.Fragment,{children:[(0,B.jsx)("div",{children:(0,B.jsx)(q().sA,{defaultMessage:"Strike-through",id:"richTextMenu.strikeThroughButton.tooltip"})}),(0,B.jsx)("div",{children:(0,B.jsx)(Al().A,{style:{color:e.text.inverseSecondary},name:"toggleStrike"})})]}),children:(0,B.jsx)(Vt().I,{icon:id,size:"sm"})})}function Jd(){const e=(0,Ye().DP)();return(0,B.jsx)(Od().A,{type:"_",tooltipLabel:(0,B.jsxs)(i.Fragment,{children:[(0,B.jsx)("div",{children:(0,B.jsx)(q().sA,{defaultMessage:"Underline",id:"richTextMenu.underlineButton.tooltip"})}),(0,B.jsx)("div",{children:(0,B.jsx)(Al().A,{style:{color:e.text.inverseSecondary},name:"toggleUnderline"})})]}),children:(0,B.jsx)(Vt().I,{icon:sd,size:"sm"})})}function Xd(){const e=(0,Ye().DP)();return(0,B.jsx)(Od().A,{type:"c",tooltipLabel:(0,B.jsxs)(i.Fragment,{children:[(0,B.jsx)("div",{children:(0,B.jsx)(q().sA,{defaultMessage:"Mark as code",id:"richTextMenu.markAsCodeButton.tooltip"})}),(0,B.jsx)("div",{children:(0,B.jsx)(Al().A,{style:{color:e.text.inverseSecondary},name:"toggleCode"})})]}),children:(0,B.jsx)(Vt().I,{icon:$l().codeSmallIcon,size:"sm"})})}function ec({}){return(0,B.jsx)(Fd().A,{children:(0,B.jsxs)("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[(0,B.jsx)(Vt().I,{icon:Ql().linkSmallIcon,size:"sm",fitToViewBox:"horizontal"}),(0,B.jsx)(Vt().I,{icon:Yl().arrowChevronSingleDownSmallIcon,size:"xs",colorVariant:"tertiary",fitToViewBox:"horizontal"})]})})}function tc({intl:e,topRankedSkill:t}){const n=(0,Ye().DP)(),i=(0,s().v3)(),o=(0,v().K8)((()=>Ad().zD.isXMLAssistantEnabled()),[]);return(0,B.jsxs)(B.Fragment,{children:[t?(0,B.jsxs)(Gl().Ay,{style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",borderRadius:6},onClick:()=>{(0,Ht().Nj)({environment:i,clientSkillWithParameterValues:(0,Jt().dangerouslyCreateClientSkillWithParameterValues)(t),from:"rich_text_menu",assistantSurfaceType:i.device.isMobile?"mobileWriter":"writer"}),(0,ld().s)(i,{action:"completions"})},children:[t.icon({width:16,height:16,marginInlineEnd:6,fill:(0,Xt().vJ)(t.category).color(n).color}),(0,B.jsx)("span",{children:(0,B.jsx)(cd,{clientSkill:t})})]}):void 0,(0,B.jsx)(rt().A,{renderTooltip:()=>(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)("div",{children:o?e.formatMessage({defaultMessage:"Make edits, find answers, and more",id:"richTextMenu.assist.assistantTooltip"}):e.formatMessage({defaultMessage:"Ask AI to help edit, review, or generate text.",id:"richTextMenu.assist.tooltip"})}),(0,B.jsx)("div",{children:(0,B.jsx)(Al().A,{style:{color:n.text.inverseSecondary},name:"commandJ"})})]}),render:e=>(0,B.jsxs)(Gl().Ay,{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"0 6px",whiteSpace:"nowrap",borderRadius:6,height:28},...e,onClick:()=>{(0,$t().toggleInitialPrompt)({from:"rich_text_menu",environment:i}),(0,ld().s)(i,{action:"completions"})},children:[(0,B.jsx)(Qt().Su,{}),(0,B.jsx)("span",{style:{marginInlineStart:6,marginInlineEnd:2},children:(0,B.jsx)(q().sA,{defaultMessage:"Ask AI",id:"richTextMenu.assistButton.label"})})]})})]})}function nc(){const e=(0,s().v3)();return(0,B.jsx)(Nd().A,{onClick:()=>{(0,ld().s)(e,{action:"e"}),dd().I()},children:(0,B.jsx)(Vt().I,{icon:Zl().M,size:"sm"})})}function ic({targetBlockStore:e,iconOnly:t}){const n=(0,Ye().DP)(),i=(0,q().tz)();return(0,B.jsx)(Dd().A,{style:{borderRadius:6,color:n.icon.primary,fill:n.icon.primary,height:28},iconOnly:t,blockStore:e,ariaLabel:i.formatMessage({id:"richTextMenu.Discussions.OpenDiscussionButton",defaultMessage:"Write a comment"})})}function oc({targetBlockStore:e,iconOnly:t}){const n=(0,Ye().DP)();return(0,B.jsx)(fd().A,{style:{borderRadius:6,color:n.icon.primary,fill:n.icon.primary,height:28,width:t?28:void 0},iconOnly:t,blockStore:e})}function sc({targetBlockStore:e,iconOnly:t}){return(0,B.jsx)(Ld,{style:{borderRadius:6,height:28},iconOnly:t,blockStore:e})}function ac({targetBlockStore:e}){const t=(0,Ye().DP)(),n=(0,s().v3)();return(0,B.jsx)(_d().A,{store:e,style:{borderRadius:6,padding:6,width:28,height:28},iconStyle:{fill:t.icon.primary},fadeIn:!1,onClick:()=>{(0,ld().s)(n,{action:"more"})}})}function rc({renderState:e}){const t=(0,q().tz)(),i=(0,Ye().DP)(),o=(0,v().K8)((()=>Cd().A.state.isActive),[]),s=e.showDiscuss||e.showReact||e.showSuggest,a=e.showBold||e.showItalic||e.showUnderline||e.showStrikethrough||e.showCode||e.showEquation||e.showHighlight,r=a;return(0,B.jsxs)("div",{style:{display:"inline-flex",alignItems:"stretch",height:36,background:i.popoverBackground,overflow:"hidden",fontSize:14,lineHeight:1.2,borderRadius:8,boxShadow:i.shadowMD,pointerEvents:o?"auto":"none",padding:"4px"},onMouseDown:e=>e.preventDefault(),children:[e.showCompletions?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(tc,{intl:t,topRankedSkill:e.topRankedSkill}),(0,B.jsx)(Hd,{theme:i})]}):void 0,s&&e.targetBlockStore?(0,B.jsxs)(B.Fragment,{children:[e.showDiscuss?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(ic,{targetBlockStore:e.targetBlockStore,iconOnly:!1}),r||!e.showReact&&!e.showSuggest?void 0:(0,B.jsx)(Hd,{theme:i})]}):void 0,e.showReact?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(oc,{targetBlockStore:e.targetBlockStore,iconOnly:r}),!r&&e.showSuggest?(0,B.jsx)(Hd,{theme:i}):void 0]}):void 0,e.showSuggest?(0,B.jsx)(sc,{targetBlockStore:e.targetBlockStore,iconOnly:r}):void 0,a?(0,B.jsx)(Hd,{theme:i}):void 0]}):void 0,a?(0,B.jsxs)(B.Fragment,{children:[e.showTurnInto&&e.targetBlockStore?(0,B.jsx)(Yd,{blockStore:e.targetBlockStore}):void 0,(0,B.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[e.showBold?(0,B.jsx)($d,{}):void 0,e.showItalic?(0,B.jsx)(Qd,{}):void 0,e.showUnderline?(0,B.jsx)(Jd,{}):void 0,e.showStrikethrough?(0,B.jsx)(Zd,{}):void 0,e.showCode?(0,B.jsx)(Xd,{}):void 0,e.showEquation?(0,B.jsx)(nc,{}):void 0]}),e.showLink?(0,B.jsx)(ec,{}):void 0,e.showHighlight?(0,B.jsx)(n(213799).A,{blockStore:e.targetBlockStore}):void 0]}):void 0,(0,B.jsx)(Ud,{}),e.showActionButton&&e.targetBlockStore?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(Hd,{theme:i}),(0,B.jsx)(ac,{targetBlockStore:e.targetBlockStore})]}):void 0]})}var lc=()=>n(402014),dc=()=>n(960955),cc=()=>n(489348),uc=()=>n(869562),pc=()=>n(749687),gc=()=>n(730591);const mc=4,fc=18,hc=.38,vc=100;const yc=function(){const e=(0,s().v3)(),t=(0,i.useRef)(void 0),n=(0,i.useRef)(void 0),o=(0,i.useRef)(1/0),a=(0,i.useRef)(void 0),r=(0,i.useRef)(void 0),l=(0,v().K8)((()=>e.WindowSizeStore.state.width),[e]);return(0,i.useEffect)((()=>{l<uc().OnlyOneSidebarVisibleWidthThreshold&&(0,vt().Nk)(e)&&(0,vt().KB)(e)&&uc().setExpand({environment:e,isExpanded:!1,from:"sidebar_listener",saveDetailsSidebarPreference:!1})}),[e,l]),(0,i.useEffect)((()=>{const i=i=>{!function({e,environment:t,timerRef:n,hoverDelayTimerRef:i,cachedPageViewRectRef:o,previousMousePositionRef:s,mouseSpeedRef:a}){(0,lc().SQ)({event:e,context:lc().y$.SidebarMouseMove,callback:()=>{if(!dc().A.hasOpenPopups()){if(bc(o),void 0!==s.current){const t=e.clientX-s.current.x,n=e.clientY-s.current.y;a.current=Math.hypot(t,n)}if(function({x:e,y:t,timerRef:n,previousMousePositionRef:i}){i.current={x:e,y:t},clearTimeout(n.current),n.current=setTimeout((()=>{i.current=void 0}),100)}({x:e.clientX,y:e.clientY,timerRef:n,previousMousePositionRef:s}),o.current){const n=pc().sidebarOpenStore.state,s=(0,ps().A1)(),r=t.WindowSizeStore.state.width,l=s?r-e.clientX:e.clientX,d=s?r-o.current.right:o.current.left,c=Math.max(d*hc,fc,pc().sidebarMousePeekXStore.state);l<c&&!Ar().default.isCenterPeekOpen()&&!gc().A.getState().open&&a.current<mc&&!n?(clearTimeout(i.current),i.current=setTimeout((()=>{uc().open({fromElectron:!1})}),vc)):clearTimeout(i.current),n&&l>(0,vt().r6)(t)&&l>c&&uc().close()}}}})}({e:i,environment:e,timerRef:a,hoverDelayTimerRef:r,cachedPageViewRectRef:t,previousMousePositionRef:n,mouseSpeedRef:o})},s=e=>{clearTimeout(r.current),function(e){e.relatedTarget||uc().close()}(e)};return window.addEventListener("mousemove",i),window.addEventListener("mouseout",s),()=>{window.removeEventListener("mousemove",i),window.removeEventListener("mouseout",s)}}),[e]),null};const bc=W().nF((function(e){const t=function(){const{mainEditorCurrentBlockStore:e}=ae().default.state,t=cc().A.find((t=>t.store===e));if(t)return t.getContentWrapEl()??void 0;return}();e.current=t?t.getBoundingClientRect():document.body.getBoundingClientRect()}),500);var Sc=()=>n(791531),xc=()=>n(312788),Ac=()=>n(662303),Mc=()=>n(97294),wc=()=>n(406094),jc=()=>n(160432),kc=()=>n(493552),Ic=()=>n(484392),Cc=()=>n(177167);const Tc=(0,no().xh)("page",{default:{loader:()=>n.e(82985).then(n.bind(n,982985))},small:{loader:()=>n.e(88931).then(n.bind(n,188931))},mini:{loader:()=>n.e(35189).then(n.bind(n,735189))},large:{loader:()=>n.e(86763).then(n.bind(n,686763))},extraLarge:{loader:()=>n.e(83295).then(n.bind(n,683295))}});var _c=()=>n(132855),Pc=()=>n(26440),Bc=()=>n(555690),Dc=()=>n(161479),Rc=()=>n(232802),Ec=()=>n(979340),Lc=()=>n(148024),Oc=()=>n(901389),Nc=()=>n(82926),Fc=()=>n(675925),Uc=()=>n(120303),zc=()=>n(112995),Kc=()=>n(650843),Vc=()=>n(788436),qc=()=>n(600871),Wc=()=>n(891078),Gc=()=>n(62856),Hc=()=>n(448291),Yc=()=>n(570323),$c=()=>n(548821),Qc=()=>n(991249),Zc=()=>n(324561),Jc=()=>n(807778),Xc=()=>n(134217),eu=()=>n(10984),tu=()=>n(201145),nu=()=>n(138405),iu=()=>n(667474),ou=()=>n(270812),su=()=>n(71743),au=()=>n(749240),ru=()=>n(823541),lu=()=>n(958846),du=()=>n(45552),cu=()=>n(460292),uu=()=>n(2143),pu=()=>n(64901),gu=()=>n(221844),mu=()=>n(898244),fu=()=>n(452540),hu=()=>n(388821),vu=()=>n(696706),yu=()=>n(869558),bu=()=>n(299772);const Su=function(e){const{navigate:t}=(0,i.useContext)(xc().E),o=(0,s().v3)(),a=(0,s().Y0)(),{isMobile:r}=a,l=(0,v().K8)((()=>e.blockStore.getAssociatedCollectionStore()),[e.blockStore]),d=(0,v().K8)((()=>{var e;return null==l||null===(e=l.getLayoutStore())||void 0===e?void 0:e.getModules()}),[l]),c=(0,v().K8)((()=>{if(!l)return 0;const{count:e}=(0,ht().pm)({collectionStore:l});return e}),[l])>0&&!r,u=(0,Ye().IS)((e=>({spinnerWrapper:{padding:32,display:"flex",alignItems:"center",justifyContent:"center"},scroller:{background:e.background.primary,zIndex:1,flexGrow:1,...c&&{paddingInlineStart:70,paddingInlineEnd:70}},container:{display:"flex",flexDirection:"row",flexGrow:1,overflow:"hidden"},layoutDetailsSidebar:{width:n(253658).xt,flexShrink:0,borderInlineStart:`1px solid ${e.border.secondary}`}})),[c]),p=(0,i.useCallback)((e=>{Nc().un(),t({environment:o,url:e})}),[o,t]),g=e.blockStore.id,m=e.timestamp,[f]=(0,Me().Yb)((async()=>await async function(e,t,n){const{timestamp:i}=e,o=e.block.id,s=await Y().callApi({eventName:"getSnapshotContents",environment:n,data:e});if("failed"===s.type)throw s.error;const a=hu().RecordMapWithRole.create(s.data.contentMap),r=n.currentUser.id,l=new(gu().A)({name:"PageSnapshotPreview"});for(const{pointer:g,model:m}of a)m&&l.setModelAndRole({pointer:g,userId:r},m,"reader");l.snapshotData={blockId:o,timestamp:i};const d=new Map,c=e=>{const n=l.getRecord({pointer:e,userId:r}),i=(0,fu().jV)(e);n||!(0,Rr().uj)(e.id)||d.has(i)||d.set(i,(0,le().v3)(t,e))},u=[];for(const{model:g}of a)if(g)if(g.table===yn().ev){const e=g,t=e.getProperties(),n=vu().L3.uniq(W().Bq(Object.keys(t).map((e=>t[e])).map(b().moK)));for(const d of n)c(d);const i=vu().L3.uniq(W().Bq(Object.keys(t).map((e=>t[e])).map(Hl().n)));for(const d of i)c(d);const o=e.isNavigableBlock()?[]:e.getContentIds()||[];for(const d of o)c({table:yn().ev,id:d});const s=e.getCollectionPointers();for(const d of s)c(d),u.push(d.id);const a=W().sb(W().Bq(Object.keys(t).map((e=>t[e])).map(b().Fbh)));for(const d of a)c({table:Fn().oo,id:d});const r=g.getCreatedByPointer();r&&c(r);const l=g.getLastEditedByPointer();l&&c(l)}else if(g.table===yu().Gy){var p;const e=null===(p=g.getFormat())||void 0===p?void 0:p.collection_pointer;e&&c(e)}else if(g.table===uo().SN){const e=g.getCreatedByPointer();e&&c(e)}return await xu({relatedStoresMap:d,inMemoryRecordCache:l,currentUserId:r}),u.forEach((e=>{var t;const n=null===(t=l.getRecord({pointer:{table:Cr().Vl,id:e},userId:r}))||void 0===t?void 0:t.value;n&&n.schema&&Object.keys(n.schema).forEach((e=>{var t;const i=null===(t=n.schema)||void 0===t?void 0:t[e],o=i&&(0,mu().nC)(i)?(0,mu().zO)(i):void 0;o&&c({table:Cr().Vl,id:o})}))})),await xu({relatedStoresMap:d,inMemoryRecordCache:l,currentUserId:r}),{blockStore:new(xn().B)(n,{table:yn().ev,id:o},{inMemoryRecordCache:l}),timestamp:i}}({block:{id:g,spaceId:(0,Dc().e)(e.blockStore.pointer.spaceId)},timestamp:m},e.blockStore,o)),[g,o,e.blockStore,m]),h="pending"!==f.status&&"idle"!==f.status,y=f.value,S=f.error,x=(0,Gc().A)(!h||!y,400,400),A=(0,v().K8)((()=>{if(x)return(0,B.jsx)("div",{style:u.spinnerWrapper,children:(0,B.jsx)(ri().k,{})});if(S)return(0,B.jsx)("div",{style:{padding:32},children:(0,B.jsx)(q().sA,{defaultMessage:"Something went wrong.",id:"pageSnapshotPreview.unknownPreviewLoadError.message"})});const t=(0,n(122001).f)({environment:o,store:e.blockStore});return y?(0,B.jsxs)(n(21140).Ye,{style:u.container,children:[(0,B.jsx)(Tt().A,{store:y.blockStore,isDefaultContainer:!0,droppable:!0,render:({selectableEvents:e})=>(0,B.jsx)(uu().H,{style:u.scroller,type:t,...e,children:(0,B.jsx)(bu().Ay,{store:y.blockStore,disabled:!0,context:$c().Rr.InPageSnapShot,paddingBottom:(0,bu().Wj)(a),layoutModulesByArea:d})})},y.timestamp),c&&null!=d&&d.page_details?(0,B.jsx)(uu().H,{style:u.layoutDetailsSidebar,type:xt().A.Y,children:(0,B.jsx)(n(146594).H,{store:y.blockStore,context:$c().Rr.InPageSnapShot,disabled:!0,shownAs:"static_sidebar",modules:d.page_details})}):void 0]}):void 0}),[x,S,o,e.blockStore,y,u.spinnerWrapper,u.container,u.layoutDetailsSidebar,u.scroller,c,d,a]);return(0,B.jsx)(zc().K,{from:"PageSnapshotPreview",fallback:({error:e,errorId:t})=>(0,B.jsx)(Kc().LargeSurfaceRenderError,{error:e,errorId:t}),children:(0,B.jsx)(n(110525).B,{value:p,children:A})})};async function xu(e){const{relatedStoresMap:t,inMemoryRecordCache:n,currentUserId:i}=e,o=Array.from(t.values());await(0,G().lX)(o,25,(async e=>{await e.load();const t=e.getValue();t&&n.setRecord({pointer:e.pointer,userId:i},{role:"reader",value:t})}))}const Au={SnapshotAdminDebugButton:new(p().O2)("SnapshotAdminDebugButton",(async()=>await n.e(14201).then(n.bind(n,776721))))},Mu=(0,p().jQ)(Au.SnapshotAdminDebugButton,(e=>e.SnapshotAdminDebugButton));var wu=()=>n(147577);const ju={display:"flex",justifyContent:"center",padding:32},ku=(0,q().YK)({restoreSnapshotError:{id:"historyModal.restoreSnapshot.errorMessage",defaultMessage:"Failed to restore version."}});const Iu=function(){const e=(0,q().tz)(),t=(0,s().v3)(),{device:i}=t,o=(0,v().O$)(Yc().A),a=Gu();return i.isMobile?(0,B.jsx)(M().Ay,{ariaLabel:Ru(e),popupType:y().n.SlideUp,open:o.open,render:()=>(0,B.jsx)(Wu,{}),onDismiss:Nc().un}):(0,B.jsx)(n(676007).a,{ariaLabel:Ru(e),open:o.open,innerStyle:a.modal,onDismiss:Nc().un,render:()=>(0,B.jsx)(Wu,{}),className:sn().uMd})},Cu=(0,B.jsx)(q().sA,{defaultMessage:"This page does not have any snapshots yet. Allow up to 10 minutes for the first snapshot to be generated.",id:"historyModal.noSnapshotsYet.message"});function Tu(){return Bc().MO.filter((e=>"personal"!==e.tier))}function _u(e){const t=Tu(),n=t.findIndex((t=>t.tier===e));if(!(n<=0))return t[n-1]}function Pu(e){var t,n;if(N().A.isAdminMode)return;const{nextFutureSnapshot:i}=e;if(!i)return;const o=(s=i,(Date.now()-parseInt(s.timestamp))/ui().nD);var s;if((0,eu().sP)()&&o<=Bc().et.plus.days)return;const a=function(e){return Tu().filter((t=>t.days>e)).map((e=>e.tier))}(o);if((0,eu().bw)(a))return;const r=a[0]??"enterprise";return(0,Ec().dL)(r)?void 0:{tier:r,titleMessage:(0,B.jsx)(q().sA,{defaultMessage:"{snapshotLimitDays} day page history",id:"historyModal.upsell.title",values:{snapshotLimitDays:(null===(t=_u(r))||void 0===t?void 0:t.days)??Math.floor(o)}}),bodyMessage:(0,B.jsx)(q().sA,{defaultMessage:"Please upgrade to the {upsellTier} plan to access versions older than {snapshotLimitDays} days",id:"historyModal.upsell.message",values:{upsellTier:(0,Ic().A)((0,Ec().$P)(r)?"plus":r),snapshotLimitDays:(null===(n=_u(r))||void 0===n?void 0:n.days)??Math.floor(o)}})}}function Bu(){return(0,B.jsx)(pu().A,{href:(0,st().x)("guides.pageHistory"),analyticsFrom:"page_history"})}function Du(e,t){const{device:n}=t;return!n.isMobile||"personal"===e&&(0,qc().mM)({environment:t})}function Ru(e){return e.formatMessage({id:"historyModal.ariaLabel",defaultMessage:"Page History"})}function Eu(e){const{device:t}=e;return t.isMobile?24:20}function Lu({menuState:e}){const t=(0,s().v3)(),n=(0,v().K8)((()=>e.blockStore.getIcon()),[e.blockStore]),o=(0,v().K8)((()=>e.blockStore.isEmptyPage()),[e.blockStore]),a=Gu();return e.snapshot?(0,B.jsxs)(i.Fragment,{children:[(0,B.jsxs)("div",{style:a.header,children:[n?(0,B.jsx)(Ol().B6,{disabled:!0,icon:n,isEmptyPage:o,size:Eu(t)}):null,n?null:(0,B.jsx)(cu().Q,{iconGroup:Tc,variantName:"default",colorVariant:"secondary"}),(0,B.jsx)(kc().D,{styleKey:"Body/Regular",colorVariant:"tertiary",style:{minWidth:0,flex:1},children:(0,B.jsx)(jr().A,{store:e.blockStore,style:{maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}})})]}),(0,B.jsx)(Su,{blockStore:e.blockStore,timestamp:e.snapshot.timestamp})]}):null}function Ou(e,t){Qc().K(t,{from:"history_modal",upsell:{type:"product",product:e,limit:{type:"none"},trialability:"none"}})}function Nu({message:e,showUpgradeButtonForTier:t}){const n=(0,s().v3)(),{device:i}=n,o=(0,v().K8)((()=>Xc().qc(au().subscriptionDataStoreInstance.state)),[]),a=Gu();let r=Du(t,n);return r&&(0,qc().mM)({environment:n})&&"personal"===t&&!o&&(r=!1),o||(r=!1),(0,B.jsxs)("div",{style:i.isMobile?a.unavailableMessageComponentMobile:a.unavailableMessageComponent,children:[Du(t,n)?(0,B.jsx)("img",{src:Na().A.images.icons.clockArrowLockSvg,alt:"locked clock icon"}):null,(0,B.jsx)("div",{style:{...!i.isMobile&&{maxWidth:283}},children:e}),r&&t?(0,B.jsx)(wc().A,{size:"lg",onClick:()=>Ou(t,n),style:a.upsell,iconLeading:{icon:_c().arrowInCircleUpFillIcon,colorPalette:"blue",colorVariant:"accentPrimary"},children:(0,B.jsx)(q().sA,{defaultMessage:"Upgrade plan",id:"historyModal.upgradeForHistoryButton.labelVHR"})}):null]})}function Fu(e){const t=(0,q().tz)(),{requestUpgradeTier:n}=e,{requestState:i,openModal:o}=(0,ou().E)({type:"product",product:n,entrypoint:"version_history",analyticsEntrypoint:"version_history",isOptimisticUpsell:!1}),s=(0,iu().j)(i,t),a=(0,nu().k)(i,t),r=Gu();return(0,B.jsxs)("div",{style:r.unavailableMessageComponent,children:[(0,B.jsx)("img",{src:Na().A.images.icons.clockArrowLockSvg,alt:"locked clock icon"}),(0,B.jsx)("div",{style:{maxWidth:283},children:(0,B.jsx)(q().sA,{defaultMessage:"Your workspace owners must upgrade to the {requestUpgradeTier} plan to restore this page.",id:"historyModal.desktopModal.requestUpgradeMessage",values:{requestUpgradeTier:(0,Ic().A)(n)}})}),(0,B.jsx)(su().U,{onClick:o,label:s,testId:`${n}-request-button`,disabledTooltip:a,tooltipPlacement:"bottom",useOutlineButton:!0})]})}function Uu(e){const t=(0,s().v3)(),n=(0,q().tz)(),{device:o}=t,{menuState:a,loadingMore:r}=e,l=(0,Gc().A)(r,300,100),d=Gu();const c=function(e){const t=new Map;return e.forEach((e=>{const n=(0,Qa().W_)(parseInt(e.timestamp),"very_short",Ac().locale),i=t.get(n)??0;t.set(n,i+1)})),t}(e.snapshotValues),u=(0,i.useCallback)((e=>{const t=e>Date.now()-6*ui().nD,n=c.get((0,Qa().W_)(e,"very_short",Ac().locale));return!!n&&(n>1||t)}),[c]),p=(0,v().K8)((()=>W().oE(e.snapshotValues.map(((i,s)=>{const r=s>0?e.snapshotValues[s-1]:void 0,l=!Pu({snapshot:i,nextFutureSnapshot:r});return{key:i.id,action:()=>{Nc().Xn({environment:t,snapshot:i,nextFutureSnapshot:r})},render:e=>{const t=i.authors||[],s=n.formatList(W().oE(t.map((e=>(0,Hc().JQ)({parentStore:a.blockStore,pointer:e}).getDisplayName(n)))),{type:"conjunction",style:"narrow"}),r=(0,B.jsx)("div",{style:{...Ze().RC},children:s}),c=Boolean(a.snapshot&&a.snapshot.id===i.id),p=parseInt(i.timestamp),g=u(p),m=new Date(p).getFullYear()!==(new Date).getFullYear()?"long":"month_day_long",f=g?(0,Qa().jE)(p,Ac().locale,n,"Â·",m):(0,Qa().W_)(p,m,Ac().locale);return l?(0,B.jsx)(un().A,{...e,title:f,focused:!o.isMobile&&c,caption:r,buttonStyle:d.buttonMenuItem,itemMarginLeft:8,right:N().A.isAdminMode?(0,B.jsx)(Mu,{snapshot:i}):null}):(0,B.jsx)(un().A,{...e,title:(0,B.jsx)("div",{style:d.menuItem,children:(0,B.jsx)("div",{style:{...o.isMobile&&{display:"flex",flex:1},...Ze().RC},children:f})}),focused:!o.isMobile&&c,caption:r,right:(0,B.jsx)(cu().Q,{iconGroup:Cc().x,variantName:"small",colorVariant:"tertiary"}),buttonStyle:d.buttonMenuItem,itemMarginLeft:8,rightStyle:{marginInlineEnd:"7px"}})}}})))),[e.snapshotValues,o.isMobile,t,n,a.blockStore,a.snapshot,d,u]),g=a.snapshot&&a.snapshot.id,m=p.findIndex((e=>g===e.key)),f=[{key:"snapshots",render:e=>(0,B.jsx)(gn().A,{...e}),items:p}];return(0,B.jsxs)(i.Fragment,{children:[(0,B.jsx)(pn().Ay,{type:pn().Oh.Vertical,initialFocus:m,sections:f}),(0,B.jsx)(lu().A,{loading:r,fetchSize:a.size,resultSize:e.snapshotValues.length,onLoadMore:Nc().p2}),l?(0,B.jsx)("div",{style:ju,children:(0,B.jsx)(ri().k,{})}):void 0]})}function zu({menuState:e,onRestoreSnapshot:t}){const n=(0,s().v3)();return(0,B.jsx)(M().Ay,{popupType:y().n.SlideUp,open:Boolean(e.snapshot),forceFullScreenSlideUp:!0,render:()=>{if(!e.snapshot)return null;const i=Pu({snapshot:e.snapshot,nextFutureSnapshot:e.nextFutureSnapshot}),o=!i,s=o?(0,B.jsx)(Su,{blockStore:e.blockStore,timestamp:e.snapshot.timestamp}):(0,B.jsx)(Nu,{message:i.bodyMessage,showUpgradeButtonForTier:i.tier}),a=!o&&n.device.isMobileBrowser;return(0,B.jsx)(A().A,{menuType:w().gu.Modal,title:(0,Qa().jE)(parseInt(e.snapshot.timestamp),Ac().locale,rn().A.getIntl()),right:(0,B.jsx)(du().DoneMenuText,{}),onClickRight:Nc().j8,leftDisabled:!o&&!n.device.isMobileBrowser,left:a?(0,B.jsx)(q().sA,{defaultMessage:"Upgrade",id:"historyModal.mobileSnapshotMenu.upgradeButton.label"}):(0,B.jsx)(q().sA,{defaultMessage:"Restore",id:"historyModal.mobileSnapshotMenu.restoreButton.label"}),onClickLeft:()=>(async()=>{a?Ou(i.tier,n):await t()})(),whiteBackground:o,forceFullScreenSlideUp:!0,children:s})}})}function Ku(e){const{navigate:t}=(0,i.useContext)(xc().E),n=(0,s().v3)(),{menuState:o}=e,a=(0,Wc().i0)(o.blockStore),r=(0,Wc().ty)(o.blockStore),l=(0,v().K8)((()=>Boolean(o.snapshot&&!a&&!r&&!Pu({snapshot:o.snapshot,nextFutureSnapshot:o.nextFutureSnapshot})&&function(e,t){return(0,Vc().X)({environment:t,blocks:[e.blockStore],originRect:void 0,publicEditMode:void 0})}(o,n))),[n,o,a,r]),d=Gu();return(0,B.jsxs)("div",{style:d.sidebarStyle,children:[(0,B.jsxs)("div",{style:d.sidebarHeader,children:[(0,B.jsx)(kc().D,{styleKey:"Title-sm/Semibold",colorVariant:"primary",children:(0,B.jsx)(q().sA,{id:"historyModal.desktopModal.sidebar.title",defaultMessage:"Version history"})}),(0,B.jsx)(Uc().R,{onClick:Nc().un,style:d.dismiss})]}),(0,B.jsx)(uu().H,{type:xt().A.Y,style:{flex:1},children:(0,B.jsx)(Uu,{...e})}),(0,B.jsxs)("div",{style:d.actions,children:[(0,B.jsx)(eo().p,{size:"lg",colorPalette:"gray",onClick:()=>{Lc().FH(n,{from:"page_history"}),t({environment:n,url:(0,st().x)("guides.pageHistory"),openInNew:"tab"})},iconLeading:{icon:$e().questionMarkCircleSmallIcon,size:"sm"},children:(0,B.jsx)(q().sA,{defaultMessage:"Learn more",id:"historyModal.desktopModal.learnMoreButtonVHR.label"})}),(0,B.jsx)(rt().A,{disableTooltip:l,renderTooltip:()=>r?(0,B.jsx)(q().sA,{defaultMessage:"Resolve pending edits to restore snapshots.",id:"historyModal.desktopModal.sidebar.resolvePendingEdits.tooltip"}):a?(0,B.jsx)(q().sA,{defaultMessage:"Restore page from trash to restore snapshots.",id:"historyModal.desktopModal.sidebar.restorePageFromTrashMessage.tooltip"}):(0,B.jsx)(q().sA,{defaultMessage:"Upgrade to restore snapshots.",id:"historyModal.desktopModal.sidebar.upgradeMessage.tooltip"}),render:t=>(0,B.jsx)(jc().A,{colorPalette:"blue",size:"lg",onClick:e.onRestoreSnapshot,disabled:!l,...t,style:d.restoreButton,children:(0,B.jsx)(q().sA,{defaultMessage:"Restore",id:"historyModal.desktopModal.restoreButtonVHR.label"})})})]})]})}function Vu(e){let t,n;return e.loadingMore||0!==e.snapshotValues.length||(t=(0,B.jsx)(Nu,{message:Cu,showUpgradeButtonForTier:!1})),n=e.error?(0,B.jsx)("div",{style:ju,children:(0,B.jsx)(q().sA,{defaultMessage:"Something went wrong",id:"historyModal.errorMessage"})}):e.initialLoading?(0,B.jsx)("div",{style:ju,children:(0,B.jsx)(ri().k,{})}):(0,B.jsxs)(i.Fragment,{children:[(0,B.jsx)(uu().H,{type:xt().A.Y,children:(0,B.jsx)(Uu,{...e})}),(0,B.jsx)(zu,{...e})]}),(0,B.jsx)(A().A,{menuType:w().gu.Modal,title:(0,B.jsx)(q().sA,{defaultMessage:"History",id:"historyModal.mobileHistoryMenu.title"}),left:(0,B.jsx)(Bu,{}),right:(0,B.jsx)(du().DoneMenuText,{}),onClickRight:Nc().un,header:t,children:(0,B.jsx)(zc().K,{from:"MobileHistory",fallback:({error:e,errorId:t})=>(0,B.jsx)(Kc().LargeSurfaceRenderError,{error:e,errorId:t}),children:n})})}function qu(e){const t=(0,s().Y0)(),n=(0,si().X)("upgrade_system_page"),i=(0,v().K8)((()=>e.menuState.snapshot?Pu({snapshot:e.menuState.snapshot,nextFutureSnapshot:e.menuState.nextFutureSnapshot}):null),[e.menuState.nextFutureSnapshot,e.menuState.snapshot]),o=Gu(),a=(0,v().K8)((()=>(0,bu().Wj)(t)),[t]),r=(0,Zc().lh)({spaceId:e.menuState.blockStore.pointer.spaceId}),l=(0,tu().y)(r),d=(0,v().K8)((()=>(0,Jc().NV)()),[]);let c;return c=e.error?(0,B.jsx)("div",{style:ju,children:(0,B.jsx)(q().sA,{defaultMessage:"Something went wrong",id:"historyModal.desktopModal.errorMessage"})}):e.initialLoading?(0,B.jsx)("div",{style:ju,children:(0,B.jsx)(ri().k,{})}):i?n?(0,B.jsxs)("div",{style:o.blurContainer,children:[(0,B.jsx)("div",{style:t.isMobile?o.unavailableMessageComponentMobile:o.unavailableMessageComponent,children:(0,B.jsx)(ru().V,{icon:Pc().w,title:i.titleMessage,description:i.bodyMessage,source:"history_modal",upsell:{type:"product",product:i.tier,limit:{type:"none"},trialability:"none"}})}),(0,B.jsx)("div",{style:o.snapshotBlur,children:(0,B.jsx)(bu().Ay,{store:e.menuState.blockStore,disabled:!0,context:$c().Rr.InPageSnapShot,paddingBottom:a})})]}):d&&(0,Rc().rU)(i.tier)&&l?(0,B.jsxs)("div",{style:o.blurContainer,children:[(0,B.jsx)("div",{style:o.unavailableMessageText,children:(0,B.jsx)(Fu,{requestUpgradeTier:i.tier})}),(0,B.jsx)("div",{style:o.snapshotBlur,children:(0,B.jsx)(bu().Ay,{store:e.menuState.blockStore,disabled:!0,context:$c().Rr.InPageSnapShot,paddingBottom:a})})]}):(0,B.jsxs)("div",{style:o.blurContainer,children:[(0,B.jsx)("div",{style:o.unavailableMessageText,children:(0,B.jsx)(Nu,{message:i.bodyMessage,showUpgradeButtonForTier:i.tier})}),(0,B.jsx)("div",{style:o.snapshotBlur,children:(0,B.jsx)(bu().Ay,{store:e.menuState.blockStore,disabled:!0,context:$c().Rr.InPageSnapShot,paddingBottom:a})})]}):e.loadingMore||0!==e.snapshotValues.length?(0,B.jsx)(Lu,{menuState:e.menuState}):(0,B.jsx)(Nu,{message:Cu,showUpgradeButtonForTier:!1}),(0,B.jsxs)(zc().K,{from:"DesktopHistory",fallback:({errorId:e})=>(0,B.jsx)(Kc().LargeSurfaceRenderError,{errorId:e}),children:[(0,B.jsx)("div",{style:o.preview,children:c}),(0,B.jsx)(Ku,{...e})]})}function Wu(){const e=(0,s().v3)(),{device:t}=e,n=(0,v().O$)(Yc().A),[i]=(0,Me().Yb)((async()=>{if(n.open)return await async function(e,t,n){const{device:i}=n,o=await Y().callApi({eventName:"getSnapshotsList",environment:n,data:e});if("failed"===o.type)throw o.error;const{snapshots:s}=o.data;if(t.pageHasCollection=s.some((e=>{var t;const n="collection"===e.parent_table,i=null===(t=e.collection_ids)||void 0===t?void 0:t.length;return n||i&&0!==i})),t.openSnapshotNearTimestamp){const e=parseInt(t.openSnapshotNearTimestamp),i=s.findIndex((t=>parseInt(t.timestamp)<e));0===s.length||(0===i?Nc().Xn({environment:n,snapshot:s[i],nextFutureSnapshot:void 0}):i>0?Nc().Xn({environment:n,snapshot:s[i-1],nextFutureSnapshot:i>1?s[i-2]:void 0}):s.length<t.size?Nc().Xn({environment:n,snapshot:s[s.length-1],nextFutureSnapshot:s.length>1?s[s.length-2]:void 0}):Nc().p2())}else Boolean(t.snapshot)||i.isMobile||Yc().A.setState({...t,snapshot:s[0],nextFutureSnapshot:void 0});return o.data}({block:{id:n.blockStore.id,spaceId:(0,Dc().e)(n.blockStore.pointer.spaceId)},size:n.size},n,e)}),[e,n]),o="pending"!==i.status&&"idle"!==i.status,a=i.error,r=i.value,l=(0,Gc().A)(Boolean(n.open&&(!r||r.snapshots.length>=n.size&&n.openSnapshotNearTimestamp)),400,100);if(!n.open)return null;const d=t.isMobile?Vu:qu;return(0,B.jsx)(d,{snapshotValues:r?r.snapshots:[],menuState:n,onRestoreSnapshot:async function(){if(!n.open)return;const t="restore_collection",i=n.pageHasCollection?[{key:t,text:(0,B.jsx)(q().sA,{defaultMessage:"Also restore databases on this page",id:"historyModal.confirmDialog.selectOption.collection"}),description:(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(q().sA,{defaultMessage:"All database pages and their properties from this version will be restored, which may impact other users or database views. To restore database page content, restore an earlier version for each page.",id:"historyModal.confirmDialog.selectOption.collection.description"})," ",(0,B.jsx)(Mc().N,{external:!0,href:(0,st().x)("guides.pageHistoryRestore"),style:{display:"inline",textDecoration:"underline"},children:(0,B.jsx)(q().sA,{id:"historyModal.confirmDialog.selectOption.collection.learnMore",defaultMessage:"Learn more"})})]})}]:void 0,{accept:o,selectionResult:s}=await Oc().Gh({message:(0,B.jsx)("div",{style:{fontWeight:Ze().Wy.semibold,fontSize:"medium"},children:(0,B.jsx)(q().sA,{defaultMessage:"Restore to this version?",id:"historyModal.confirmDialog.description"})}),acceptLabel:(0,B.jsx)(q().sA,{defaultMessage:"Restore",id:"historyModal.confirmDialog.restoreButton.label"}),selectionItems:i,mode:i?"wide":void 0,textAlign:"left"});if(o){try{await(0,Fc().o)(e,{action:"restore_snapshot",from:"snapshot_history_modal",block_type:void 0},(n=>Nc().n5(e,null==s?void 0:s[t]).then(n)))}catch{Oc().f1(rn().A.formatMessage(ku.restoreSnapshotError))}Nc().un()}},error:a,initialLoading:l,loadingMore:!o})}function Gu(){return(0,Ye().IS)((e=>({sidebarStyle:{display:"flex",flexDirection:"column",flexShrink:0,width:wu().pN,paddingTop:10,paddingInlineEnd:8,paddingBottom:0,paddingInlineStart:8,borderInlineStart:`\n\t\t\t1px solid ${e.regularDividerColor}\n\t\t`},sidebarHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",alignSelf:"stretch",paddingTop:4,paddingInlineEnd:4,paddingBottom:4,paddingInlineStart:8},actions:{display:"flex",paddingTop:12,paddingInlineEnd:12,paddingBottom:12,paddingInlineStart:6,borderTop:`\n\t\t\t\t\t1px solid ${e.regularDividerColor}\n\t\t\t\t`,justifyContent:"space-between",marginInlineStart:"-8px",marginInlineEnd:"-8px"},preview:{display:"flex",flexDirection:"column",width:`calc(100% - ${wu().pN}px)`,boxShadow:`calc(var(--direction, 1) * 1px) 0 0 ${e.regularDividerColor}`,overflow:"hidden"},restoreButton:{backgroundColor:e.blue.text.accentPrimary,borderRadius:"6px",boxShadow:"none"},buttonMenuItem:{marginInlineStart:"0px",marginInlineEnd:"0px",width:"100%",borderRadius:"6px"},menuItem:{display:"flex",alignItems:"center",justifyContent:"space-between"},header:{display:"flex",alignItems:"center",flexShrink:0,height:45,paddingInlineStart:14,paddingInlineEnd:14,gap:6,width:"100%",overflow:"hidden"},modal:{height:`${wu().fi}vh`,width:`${wu().oR}vw`,overflow:"hidden",display:"flex",borderRadius:"12px"},blurContainer:{position:"relative",width:"100%",height:"100%",overflow:"hidden"},unavailableMessageText:{position:"absolute",width:"100%",height:"100%",zIndex:1},snapshotBlur:{position:"relative",pointerEvents:"none",filter:"blur(20px)",opacity:"30%",margin:"-5px"},unavailableMessageComponentMobile:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:28,padding:16,textAlign:"center",fontSize:14,position:"relative",zIndex:1,background:e.popoverBackground,boxShadow:`\n\t\t\t\t\t\t\t\t0 -1px 0 ${e.regularDividerColor},\n\t\t\t\t\t\t\t\t0 1px 0 ${e.regularDividerColor}\n\t\t\t\t\t\t\t`},unavailableMessageComponent:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:16,textAlign:"center",fontSize:14,height:"100%",gap:16},upsell:{gap:4,paddingInlineStart:"8px",paddingInlineEnd:"12px",borderRadius:"6px"},dismiss:{position:"unset"}})),[])}var Hu=()=>n(510683),Yu=()=>n(444768);const $u=function(){const e=(0,Ye().DP)(),t=(0,s().v3)(),i=(0,v().O$)(Yu().A),o=(0,v().O$)(n(661179).A);if(!i.open)return null;const a=i.integration.info.icon;return a?(0,B.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",cursor:"default",padding:16,background:e.popoverBackground,borderRadius:4,boxShadow:e.shadowSM,position:"absolute",bottom:65+o,insetInlineEnd:16+o,width:240,zIndex:111,clipPath:"inset(-10px -10px -10px -10px)"},children:[(0,B.jsx)(n(854672).A,{type:"image_url",imageURL:a,size:38,style:{marginBottom:6}}),(0,B.jsx)("div",{style:{color:e.text.primary,fontSize:14,fontWeight:Ze().Wy.semibold,marginBottom:6,textAlign:"center"},children:(0,B.jsx)(q().sA,{id:"inlineUnfurlingAuthenticationPopup.title",defaultMessage:"Connect to {integration}",values:{integration:i.integration.name}})}),(0,B.jsxs)("div",{style:{color:e.text.secondary,fontSize:12,marginBottom:8,textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,B.jsx)(q().sA,{id:"inlineUnfurlingAuthenticationPopup.caption",defaultMessage:"You, and anyone else who has access to this Notion page, will see rich previews that update live."}),(0,B.jsx)(n(719147).A,{href:(0,st().x)("guides.unfurling"),external:!0,children:(0,B.jsx)(q().sA,{id:"inlineUnfurlingAuthenticationPopup.learnMore.text",defaultMessage:"Learn more"})})]}),(0,B.jsx)(jc().A,{colorPalette:"blue",onClick:()=>async function(e){const t=Yu().A.state,{sidebarSpaceStore:n}=ae().default.state;if(!t.open||!n)return;await Hu().Jq({environment:e,integration:t.integration,spaceId:n.id,unfurlUrl:t.unfurlUrl,externalObjectInstanceBlockId:t.externalObjectInstanceBlockId,from:"external_object_instance_inline_popup"}),Qu(t.integration.id,e),Yu().A.reset()}(t),style:{width:"100%"},children:(0,B.jsx)(q().sA,{id:"inlineUnfurlingAuthenticationPopup.connectButton",defaultMessage:"Connect"})}),(0,B.jsx)(at().A,{icon:n(212050).u,onClick:()=>function(e){const t=Yu().A.state;t.open&&Qu(t.integration.id,e);Yu().A.reset()}(t),style:{position:"absolute",top:6,insetInlineEnd:6}})]}):null};function Qu(e,t){const{currentUserSettingsStore:n}=ae().default.state;n&&x().createAndCommit({userAction:"UnfurlingInformationPopup.markPopupAsDismissed",environment:t,canUndo:!0,perform:t=>{dl().Cw({transaction:t,userSettingsStore:n,integrationId:e})}})}n(18107),n(967357);var Zu=()=>n(617871),Ju=()=>n(506391),Xu=()=>n(650829),ep=()=>n(859004),tp=()=>n(397740),np=()=>n(398209),ip=()=>n(13898);const op=function(){const e=(0,v().uB)(np().A),t=(0,s().v3)(),n=(0,i.useRef)(null),o=(0,s().Y0)(),[a,r]=(0,v().K8)((()=>[e.state.open,e.state.open?e.state.renderRect:void 0]),[e]);return(0,i.useEffect)((()=>{const e=e=>{a&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&cp(t)},i=e=>{if(!a||!e.target||!n.current)return;const i=n.current;i&&i!==e.target&&cp(t)};return(0,ss().P)(window,"keydown",e),(0,ss().P)(window,"mousedown",i),()=>{(0,as().O)(window,"keydown",e),(0,as().O)(window,"mousedown",i)}}),[a,n,t]),(0,B.jsx)(M().Ay,{popupType:o.isMobileNative&&!o.isTablet?y().n.SlideUp:y().n.Popup,open:Boolean(a&&r),originRect:a?r:void 0,placementToOrigin:"top",alignmentToOrigin:"start",originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:o.isMobile,keepFocus:o.isMobile,render:()=>(0,B.jsx)(sp,{}),onDismiss:cp})};function sp(){const e=(0,v().uB)(np().A),t=(0,s().v3)(),n=(0,s().Y0)(),o=(0,i.useRef)(null),a=(0,q().tz)(),[r,l,d,c]=(0,v().K8)((()=>[e.state.open,e.state.open?e.state.allOptionTypes:[],e.state.open?e.state.integration:void 0,e.state.open?e.state.url:void 0]),[e]),u=(0,Ye().IS)((e=>({header:n.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:Ze().Wy.semibold,background:e.background.secondary,height:45}:{paddingInlineStart:12,paddingInlineEnd:12,paddingTop:10,paddingBottom:4,color:e.text.secondary,fontSize:Ze().J.UISmall.desktop,fontWeight:450,font:"SF Pro"}})),[n]);if(!r)return null;const p={fontSize:Ze().J.UIRegular.desktop,fontWeight:Ze().Wy.regular,font:"SF Pro"},g=(null==d?void 0:d.id)===Zu().mn&&l.includes("import"),m={key:"embed section",render:e=>(0,B.jsx)(gn().A,{...e,topBorder:0!==e.index}),items:l.filter((e=>"import"!==e)).map((e=>({key:e,render:n=>(0,B.jsx)(un().A,{...n,title:(0,B.jsx)(ap,{optionType:e,integration:d}),onMouseEnter:i=>{n.onMouseEnter(i),rp(e,a,t)},style:p}),action:()=>lp(e,t)})))},f=l.filter((e=>"import"===e)),h=f.length>0?{key:"import section",render:e=>(0,B.jsx)(gn().A,{...e,topBorder:0!==e.index}),items:f.map((e=>({key:e,render:n=>(0,B.jsx)(up,{props:n,optionType:e,integration:d,environment:t,intl:a,menuTextStyle:p}),action:()=>lp(e,t)})))}:void 0,y=(g?[h,m]:[m,h]).filter(Oe().O9);return(0,B.jsx)(Xu().LazyAssistantUnfurlingMenuWithAiSection,{url:c,integration:d,headerStyle:u.header,menuTextStyle:p,updateUnfurlingOptionType:rp,handleDismiss:lp,renderMenu:({maybeAiActionSection:e})=>{let i;return i=n.isMobile?{menuType:w().gu.ActionSheet}:{menuType:w().gu.Popup,width:l.includes("import")?260:Boolean(e)?220:200,maxHeight:"40vh",onClickOutside:()=>cp(t)},(0,B.jsx)(A().A,{...i,className:sn().Uvd,ref:o,header:(0,B.jsx)(kn().A,{style:u.header,isSmall:!n.isMobile,isSecondaryColor:!n.isMobile,children:(0,B.jsx)(q().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,B.jsx)(pn().Ay,{type:pn().Oh.Vertical,sections:e?[...y,e]:y,initialFocus:0,onKeyboardArrow:n=>function(e,t,n,i){const o=np().A.state;if(!o.open||void 0===e.indexGlobal)return;const s=o.allOptionTypes.at(e.indexGlobal);if(!s)return void(i&&rp("preview",t,n));rp(s,t,n)}(n,a,t,Boolean(e)),priority:1,disallowBackspace:!0})})}})}function ap({optionType:e,integration:t}){return"preview"===e?(0,B.jsx)(q().sA,{id:"unfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Preview"}):"mention"===e?(0,B.jsx)(q().sA,{id:"unfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Mention"}):"link"===e?(0,B.jsx)(q().sA,{id:"unfurlingMenu.actions.pasteAsLink.title",defaultMessage:"URL"}):"drive"===e?(0,B.jsx)(q().sA,{id:"unfurlingMenu.actions.pasteAsDrive.title",defaultMessage:"Embed"}):"collection"===e?(0,B.jsx)(q().sA,{id:"unfurlingMenu.actions.pasteAsDatabase.title",defaultMessage:"Database"}):"import"===e?(null==t?void 0:t.id)===Zu().me?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(q().sA,{id:"unfurlingMenu.actions.import.jiraTitle",defaultMessage:"Sync Jira projects and issues"}),(0,B.jsx)(Di().A,{style:{display:"inline"}})]}):(null==t?void 0:t.id)===Zu().mn?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(q().sA,{id:"unfurlingMenu.actions.import.salesforceTitle",defaultMessage:"Sync Reports"}),(0,B.jsx)(ip().A,{style:{display:"inline"}})]}):(0,B.jsx)(q().sA,{id:"unfurlingMenu.actions.import.title",defaultMessage:"Import from {integration}",values:{integration:null==t?void 0:t.name}}):void(0,Oe().HB)(e)}function rp(e,t,n){x().createAndCommit({userAction:"UnfurlingMenu.handleMenuListKeyboardArrow",environment:n,canUndo:!1,perform:i=>{Hi().Oi({environment:n,type:dp(e),useTemporaryRecordCache:!0,transaction:i,intl:t})}})}function lp(e,t){const n=np().A.state;rl().Gp(t,{unfurl_option_type:e||"default",integration:n.open?n.integration.name:"default"}),"import"===e&&n.open?(x().createAndCommit({userAction:"UnfurlingMenu.handleDismiss",environment:t,canUndo:!0,perform:e=>{Hi().VN({environment:t,setType:"link",transaction:e})}}),function({environment:e,integration:t,url:n,blockStore:i}){var o,s;switch(t.id){case Zu().MN:_i().A.setState({..._i().A.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"asana",openedFrom:"link_paste"});break;case Zu().Hd:const a=(0,Ju().WS)({url:n,integration:t});if(a){const e=a.find((e=>"title"===e.id)),t=null==e?void 0:e.values[0];tp().A.setState({...tp().A.state,selectedFileId:t})}_i().A.setState({..._i().A.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"googleDocs",openedFrom:"link_paste"});break;case Zu().wK:_i().A.setState({..._i().A.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"trello",openedFrom:"link_paste"});break;case Zu().me:const r=i&&(null===(o=(0,hi().U)(i))||void 0===o?void 0:o.id),l=/\/projects\/(\w+)\//,d=null===(s=n.match(l))||void 0===s?void 0:s[1];Ci().Ay.setState({...Ci().Ay.state,teamSpaceId:r,projectKeys:d?[d]:[]}),mi().j({environment:e,from:"external_object_instance_block",action:"show_teamspaces"});const c=Ci().Ay.createNewFlowId();(0,zt().u)({environment:e,event:{eventName:"external_sync_entry_point",eventProperties:{integration:"jira",from:"link_paste_menu",flowId:c}}});break;case Zu().mn:ep().M2({url:n,environment:e,from:"external_object_instance_block",integration:t,blockStore:i})}}({environment:t,integration:n.integration,url:n.url,blockStore:n.stores.blockStore})):x().createAndCommit({userAction:"UnfurlingMenu.handleDismiss",environment:t,canUndo:!0,perform:n=>{Hi().VN({environment:t,setType:e?dp(e):void 0,transaction:n})}})}function dp(e){return"import"===e?"link":e}function cp(e){lp(void 0,e)}function up({props:e,optionType:t,integration:n,environment:i,intl:o,menuTextStyle:s}){return(0,B.jsx)(un().A,{...e,title:(0,B.jsx)(ap,{optionType:t,integration:n}),onMouseEnter:n=>{e.onMouseEnter(n),rp(t,o,i)},style:s})}var pp=()=>n(999752),gp=()=>n(664713),mp=()=>n(367014),fp=()=>n(349990),hp=()=>n(751348),vp=()=>n(90873);const yp=10;function bp(){const e=(0,s().v3)(),{sidebarSpaceStore:t,sidebarSpaceViewStore:n,currentUserStore:o,currentUserRootStore:a}=(0,v().K8)((()=>({sidebarSpaceStore:ae().default.state.sidebarSpaceStore,sidebarSpaceViewStore:ae().default.state.sidebarSpaceViewStore,currentUserStore:ae().default.state.currentUserStore,currentUserRootStore:ae().default.state.currentUserRootStore})),[]),r=null==o?void 0:o.id,l=(0,hp().n)(n),d=(0,fp().l)(),c=(0,v().K8)((()=>W().oE(l?(0,ne().f)({currentUserRootStore:a}).map((e=>e.getSpaceId())):d?(0,mp().k)({currentUserRootStore:a,currentSpaceOnly:!0}).map((e=>e.getSpaceId())):[null==t?void 0:t.id])),[l,d,t,a]);return(0,i.useEffect)((()=>{if(!r)return;const t=async(t,n)=>{const i=vp().A.getSharedPagesState({userId:r,spaceId:t});i&&i.emitValue===n||await gp().Z({environment:e,userId:r,spaceId:t,emitValue:n})},n=c.length>yp?new(pp().O)(yp):void 0,i=c.map((i=>{const o=W().nF((async({value:e})=>n?n.enqueue((async()=>t(i,e))):t(i,e)),5e3);return{listener:te().Ay.addListener((0,K().Rs)({userId:r,spaceId:i}),void 0,o,void 0,e),throttledHandler:o}}));return function(){null==n||n.cancel(),i&&i.forEach((({listener:t,throttledHandler:n})=>{t&&te().Ay.removeListener(t,e),n&&n.cancel()}))}}),[c,r,e]),null}n(16280);var Sp=()=>n(721908),xp=()=>n(636081),Ap=()=>n(62371),Mp=()=>n(854150),wp=()=>n(242028),jp=()=>n(799832),kp=()=>n(467276),Ip=()=>n(993996),Cp=()=>n(158658),Tp=()=>n(125591),_p=()=>n(779212),Pp=()=>n(199896),Bp=()=>n(854502),Dp=()=>n(666710);const Rp=200,Ep=30,Lp=125,Op=25;var Np=function(e){return e[e.Selectable=0]="Selectable",e[e.DropTarget=1]="DropTarget",e}(Np||{});function Fp(e){return e.type===Np.Selectable?{type:Pn().OX.Selectable,store:e.target.props.store,direction:e.direction}:{type:Pn().OX.DropTarget,key:e.target.props.dropTargetKey,direction:e.direction}}function Up(e){const{target:t,device:n,direction:i,points:o}=e;return i===Pn().bH.Onto||!n.isPhone||t.props.dropzoneShouldNeverUseOrigin?o.mousePoint:{x:o.originPoint.x,y:o.mousePoint.y}}function zp(e){return(0,Pp().MS)(e)?{type:Np.Selectable,target:e}:{type:Np.DropTarget,target:e}}function Kp(e){if(!e||!(0,Pp().MS)(e))return!1;let t=e;const n=Pn().Ay.state;if(!n.isDragging)return!1;const{draggedStores:i}=n;for(;t;){if(i.indexOf(t.props.store)>=0)return!0;t=t.getContextClosestSelectable()}return!1}function Vp(e){const{dropzoneMustBeWithinHorizontalBound:t,device:n}=e;return t?0:n.isPhone?9999:0}function qp(e){switch(e.direction){case Pn().bH.Onto:return function(e){const{device:t,isNativeDrag:n,rect:i,target:o,points:s,priority:a,canAcceptDrop:r}=e,l=Pn().bH.Onto,d=Up({device:t,target:o,direction:l,points:s});if((n?o.props.canNativeDropOnto:o.props.canDropOnto)&&Gp(d,i)&&!Kp(o)&&r(o,l))return{...zp(o),direction:l,left:i.left,top:i.top,width:i.width,height:i.height,priority:a}}(e);case Pn().bH.Left:return function(e){const{device:t,isNativeDrag:n,rect:i,target:o,points:s,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=Pn().bH.Left,c=Up({device:t,target:o,direction:d,points:s});if(i){const e=(0,ps().A1)(),t=e?i.right:i.left,s=e?i.right:i.left;if((n?o.props.canNativeDropLeft:o.props.canDropLeft)&&c.y>=i.top&&c.y<=i.bottom&&Math.abs(c.x-t)<=Rp&&(r||!Kp(o))&&l(o,d))return{...zp(o),direction:d,left:s,top:i.top,width:0,height:i.height,priority:a}}}(e);case Pn().bH.Right:return function(e){const{device:t,isNativeDrag:n,rect:i,target:o,points:s,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=Pn().bH.Right,c=Up({device:t,target:o,direction:d,points:s});if(i){const e=(0,ps().A1)(),t=e?i.left:i.right,s=e?i.left:i.right;if((n?o.props.canNativeDropRight:o.props.canDropRight)&&c.y>=i.top&&c.y<=i.bottom&&Math.abs(c.x-t)<=Rp&&(r||!Kp(o))&&l(o,d))return{...zp(o),direction:d,left:s,top:i.top,width:0,height:i.height,priority:a}}}(e);case Pn().bH.Above:return function(e){const{device:t,isNativeDrag:n,rect:i,target:o,points:s,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=o.props.verticalDropZoneExtraLeftEdgeOffset??Ep,c=Vp({dropzoneMustBeWithinHorizontalBound:o.props.dropzoneMustBeWithinHorizontalBound,device:t}),u=Pn().bH.Above,p=Up({device:t,target:o,direction:u,points:s});if((n?o.props.canNativeDropAbove:o.props.canDropAbove)&&i&&p.x>=i.left-d-c&&p.x<=i.right+c&&(r||!Kp(o))&&Math.abs(p.y-i.top)<=Lp&&(i.height<=2*Op||p.y<=i.top+Op)&&l(o,u))return{...zp(o),direction:u,left:i.left,top:i.top,width:i.width,height:0,priority:a}}(e);case Pn().bH.Below:return function(e){const{device:t,isNativeDrag:n,rect:i,target:o,points:s,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=o.props.verticalDropZoneExtraLeftEdgeOffset??Ep,c=Vp({dropzoneMustBeWithinHorizontalBound:o.props.dropzoneMustBeWithinHorizontalBound,device:t}),u=Lp,p=o.props.isLastItem?Number.MAX_SAFE_INTEGER:Lp,g=Pn().bH.Below,m=Up({device:t,target:o,direction:g,points:s});if((n?o.props.canNativeDropBelow:o.props.canDropBelow)&&i&&m.x>=i.left-d-c&&m.x<=i.right+c&&i.bottom-m.y<=u&&m.y-i.bottom<=p&&(i.height<=2*Op||m.y>=i.bottom-Op)&&(r||o.props.isLastItem||!Kp(o))&&l(o,Pn().bH.Below))return{...zp(o),direction:Pn().bH.Below,left:i.left,top:i.bottom,width:i.width,height:0,priority:a}}(e)}}function Wp(e){const{device:t,rect:n,target:i,points:o,optionKeyDown:s}=e;return Gp(Up({device:t,target:i,direction:Pn().bH.Onto,points:o}),n)&&Kp(i)&&!s}function Gp(e,t){return Boolean(t&&e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom)}var Hp=()=>n(281322),Yp=()=>n(500758),$p=()=>n(396301),Qp=()=>n(49650),Zp=()=>n(585533),Jp=()=>n(182106),Xp=()=>n(696152),eg=()=>n(695625),tg=()=>n(444570),ng=()=>n(154060),ig=()=>n(95758),og=()=>n(915440),sg=()=>n(871399);const ag=2,rg=20,lg=7;function dg(){const e=(0,i.useRef)(!1),t=(0,i.useRef)(!1),n=(0,i.useRef)(void 0),o=(0,s().Y0)(),a=(0,s().v3)(),r=(0,Kt().S)(),l=(0,Sp().d)((e=>Ds().e.withListenerIgnored((()=>(e=>{const i=sg().default.state;if(!(e&&e.target instanceof Element)||i.isOpen&&i.menuIsOpen||(n.current={target:e.target,x:e.clientX,y:e.clientY}),t.current)return void(t.current=!1);const{isDragging:o}=Pn().Ay.state;if(o)m();else{if(!n.current)return;pg(a,n.current.target,n.current.x,n.current.y)}})(e)))),60),d=(0,i.useCallback)((()=>{e.current||l(void 0)}),[l]),c=W().nF((()=>{const{isDragging:e}=Pn().Ay.state;Xi().default.afterNextFlush((()=>{n.current&&!e&&pg(a,n.current.target,n.current.x,n.current.y)}))}),60),u=(0,i.useMemo)((()=>new WeakMap),[]),p=(0,i.useCallback)((e=>{const t=u.get(e);if(u.has(e))return t??!1;const n=(0,Ip().x)({environment:a,blocks:e,publicEditMode:null==r?void 0:r.publicEditModeStore.state});return u.set(e,n),n??!1}),[a,null==r?void 0:r.publicEditModeStore,u]),g=(0,i.useCallback)((()=>{const e=Pn().Ay.state;if(!e.isDragging)return;const{draggedStores:t,currentX:n,currentY:i,offsetX:o,offsetY:s,isNativeDrag:l}=e,d=function(e){const{points:t,draggingStore:n,isNativeDrag:i,environment:o,pageContext:s,canDragFn:a}=e,{device:r}=o,l=Hp().r(),d=function(){const{selectableRectMap:e}=Dp().default.state,{dropTargetRectMap:t}=Bp().A.state,n=new Map;for(const[i,o]of e.entries())n.set(i,o);return t.forEach(((e,t)=>{n.set(t,e)})),n}(),c=d.keys();let u=c.next();const p=eg().T.findSelectableFromStore(n),g=p?p.getContextSelectableContainer():void 0,m={blocks:[n],environment:o,pageContext:s,publicEditMode:null==s?void 0:s.publicEditModeStore.state},f=(0,_p().r)(m)&&(0,kp().p)(m)&&(0,ng().A)();let h=[];for(;!u.done;){const e=u.value;u=c.next();const n=d.get(e),p=e.getContextSelectableContainer();if(r.isPhone&&p!==g)continue;if(!p||p.getProps().disable)continue;const m=ug(p),f={device:r,isNativeDrag:i,rect:n,target:e,points:t,priority:m,optionKeyDown:l.option,canAcceptDrop:(e,t)=>yg({target:e,direction:t,optionKeyDown:l.option,environment:o,pageContext:s,canDragFn:a})};if(Wp(f))return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};h.push(...W().oE([qp({...f,direction:Pn().bH.Onto}),qp({...f,direction:Pn().bH.Left}),qp({...f,direction:Pn().bH.Right}),qp({...f,direction:Pn().bH.Above}),qp({...f,direction:Pn().bH.Below})]))}h=function(e){const t=mg(W().Sk(e,mg));return e.filter((e=>mg(e)===t))}(h);const v=h.filter((e=>e.direction===Pn().bH.Above||e.direction===Pn().bH.Below)),y=W().wq(v,(e=>Math.abs(e.top-gg(e,t,o).y)));if(y&&y.target===p)return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};let b=v.filter((({top:e})=>Math.abs(e-(y?y.top:0))<=ag));if(b.length>1){b=b.filter((e=>{const n=gg(e,t,o).x,i=Vp({device:r});return n>=e.left-i&&n<=e.left+e.width+i})),b=W().Ul(b,(({left:e})=>e));let e=0;for(;e<b.length-1;e++){const n=b[e+1],i=gg(n,t,o).x;if(n.left>i)break}b=b.slice(0,e+1),b.reverse()}const S=b.map(Fp);let x;const A=h.filter((e=>e.direction===Pn().bH.Onto)),M=W().wq(A,(e=>e.height));if(M){v.some((e=>{const n=gg(e,t,o).y;return Math.abs(e.top-n)<lg}))||(x=Fp(M))}let w;const j=h.filter((e=>e.direction===Pn().bH.Left||e.direction===Pn().bH.Right)).sort(((e,t)=>e.height-t.height));let k=W().wq(j,(e=>{const n=gg(e,t,o).x;return Math.abs(e.left-n)}));if(k){const e=k,t=j.filter((t=>Math.abs(t.left-e.left)<rg));t.length>0&&(k=W().wq(t,(e=>e.left)))}if(k){const e=k;v.some((t=>t.top>=e.top&&t.top+t.height<=e.top+e.height))||(w=Fp(k))}f&&(w=void 0,x=void 0);return{ontoDropZone:x,verticalDropZone:w,horizontalDropZones:S}}({points:{mousePoint:{x:n,y:i},originPoint:{x:n-o,y:i-s}},draggingStore:t[0],isNativeDrag:l,environment:a,pageContext:r,canDragFn:p});if(d.ontoDropZone)Pn().Ay.setState({...e,currentDropZone:d.ontoDropZone,currentHintDropZones:[],currentParentStore:void 0});else if(d.verticalDropZone)Pn().Ay.setState({...e,currentDropZone:d.verticalDropZone,currentHintDropZones:[],currentParentStore:void 0});else{if(d.horizontalDropZones.length>0){const t=d.horizontalDropZones[0],n=W().RT(d.horizontalDropZones);if(t.type===Pn().OX.Selectable){const i=eg().T.findSelectableFromStore(t.store);if(i){const o=i.getContextClosestSelectable();let s;return o&&o.props.store!==t.store&&o.props.shouldShowParentHalo&&(s=o.props.store),void Pn().Ay.setState({...e,currentDropZone:t,currentHintDropZones:n,currentParentStore:s})}}else{if(Zp().A.findDropTargetFromKey(t.key))return void Pn().Ay.setState({...e,currentDropZone:t,currentHintDropZones:n,currentParentStore:void 0})}}Pn().Ay.setState({...e,currentDropZone:void 0,currentHintDropZones:[],currentParentStore:void 0})}}),[a,p,r]),m=(0,i.useCallback)((()=>{if(e.current)throw new Error("Assertion failure, updateDragState() called when isUpdatingDragState === true!");e.current=!0;try{g()}finally{e.current=!1}}),[g]),f=(0,i.useCallback)((()=>{const{isDragging:e}=Pn().Ay.state;e&&m()}),[m]),h=(0,i.useCallback)((()=>{t.current=!0}),[]);(0,i.useEffect)((()=>(window.addEventListener("mousemove",l),cn().default.addListener(c),o.isIOS&&window.addEventListener("touchend",h),window.addEventListener("keydown",f),window.addEventListener("keyup",f),Pn().Ay.addListener(d),window.addEventListener("scroll",fg,!0),window.addEventListener("resize",hg),Xn().RR.addListener(vg),tt().sf(),()=>{window.removeEventListener("mousemove",l),cn().default.removeListener(c),o.isIOS&&window.removeEventListener("touchend",h),window.removeEventListener("keydown",f),window.removeEventListener("keyup",f),Pn().Ay.removeListener(d),window.removeEventListener("scroll",fg,!0),window.removeEventListener("resize",hg),Xn().RR.removeListener(vg)})),[o.isIOS,d,c,f,l,h])}function cg(){const e=sg().default.state;e.isOpen&&!e.menuIsOpen&&sg().default.reset()}function ug(e){return(cn().default.state.droppableContainerStack||[]).indexOf(e)}function pg(e,t,n,i){var o,s;const a=sg().default.state;if(a.isOpen&&a.menuIsOpen)return;const r=function(e){const{environment:t,target:n,x:i,y:o,rightMarginCommentActionsEnabled:s}=e;if(og().A.state.isResizing||Pn().Ay.state.isDragging||_e().default.state.isActive||Xn().RR.state)return;const{selectableRectMap:a}=Dp().default.state,r=Xp().A.getMembersByDOMOrder({filter:e=>{const t=e.getNode();return Boolean(t&&t.contains(n))}})[0];if(!r)return;const l=a.keys();let d=l.next();const c=[],u=[];for(;!d.done;){const e=d.value,n=a.get(e),p=tg().TH({environment:t,store:e.props.store,selectableBoundingRect:n}),g=tg().KG({store:e.props.store,selectableBoundingRect:n,containerWidth:p}),m=tg().mC(e);if((e.props.shouldShowHoverMenu||e.props.shouldShowCommentMenu)&&e.getContextSelectableContainer()===r&&n&&Wl().ux((0,sg().getExpandedSelectableRect)(n,s,p,g,m),i,o)){for(const t of sg().HOVER_REGIONS)Wl().ux((0,sg().getHoverRegionOfRect)(n,t,p,g,m),i,o)&&u.push({selectable:e,hoveredRegion:t});Wl().ux((0,sg().getExactSelectableRect)(n,s),i,o)&&c.push(e)}d=l.next()}const p=(0,ps().A1)()?-1:1,g=W().Ul(c,(e=>{const t=a.get(e);return t?-t.left*p:1/0})),m=g.find((e=>{const t=e.getNode();return!t||!g.find((n=>{if(n!==e){const e=n.getNode();return Boolean(e&&t.contains(e))}return!1}))}));return m?{exactSelectable:m,nearbySelectables:u,container:r}:{nearbySelectables:u,container:r}}({environment:e,target:t,x:n,y:i,rightMarginCommentActionsEnabled:!0});if(!r)return void sg().default.reset();const l=!a.isOpen||(null===(o=r.exactSelectable)||void 0===o?void 0:o.props.store)!==a.currentStore,d=a.isOpen&&(null===(s=r.exactSelectable)||void 0===s?void 0:s.props.store)===a.currentStore;var c,u;l?sg().default.setState({...a,isOpen:!0,menuIsOpen:!1,container:r.container,nearbySelectables:r.nearbySelectables,currentStore:null===(c=r.exactSelectable)||void 0===c?void 0:c.props.store,selectableBoundingRect:null===(u=r.exactSelectable)||void 0===u||null===(u=u.getNode())||void 0===u?void 0:u.getBoundingClientRect(),mouseX:n,mouseY:i}):d&&sg().default.setState({...a,nearbySelectables:r.nearbySelectables,mouseX:n,mouseY:i})}function gg(e,t,n){return Up({device:n.device,target:e.target,points:t})}function mg(e){return(null==e?void 0:e.priority)??0}function fg(){tt().AP(),cg()}function hg(){tt().AP(),cg()}function vg(){const e=sg().default.state,t=Xn().RR.state;e.isOpen&&!e.menuIsOpen&&t&&sg().default.reset()}function yg(e){const{target:t,direction:n,optionKeyDown:i,environment:o,pageContext:s,canDragFn:a}=e;if(l().A.state.isOpen&&!Ar().default.state.open)return!1;if(d().A.state.isOpen)return!1;const r=Pn().Ay.state,c=r.isDragging?r.draggedStores:[],u=!!r.isDragging&&r.isNativeDrag;let p,g,m,f=!1,h=!1;c.find((e=>{const t=Jp().A.findOutlinerItemFromStore(e);return!!t&&(p=t,g=t.type,f=t.isTopLevelItem,!0)}));const v=(0,Pp().MS)(t)?Jp().A.findOutlinerItemFromStore(t.props.store):void 0,y=null==v?void 0:v.parentStore;var b;v&&(m=v.type,h=v.isTopLevelItem||"team"===(null===(b=v.parentStore)||void 0===b?void 0:b.table));if(function(e){var t;const{draggingOutlinerItem:n,selectableOutlinerItemParent:i,direction:o}=e;if(n&&"team"===n.type&&n.isTopLevelItem&&(null===(t=n.parentStore)||void 0===t?void 0:t.pointer.table)===Mp().yK){const e=n.parentStore;if(!(n.store.getParentId()===e.pointer.id||i&&i.pointer.id===e.pointer.id&&o!==Pn().bH.Onto))return!0}return!1}({draggingOutlinerItem:p,selectableOutlinerItemParent:y,direction:n}))return!1;if(!(0,Pp().MS)(t))return t.props.canAcceptDrop({direction:n,draggingStores:c,isNativeDrag:u});const S=t.props.store;if(S.pathIsDead())return!1;if((0,ng().A)()){if(n===Pn().bH.Onto){const e=S.getSpaceId();if(e){if(c.some((t=>{const n=t.getSpaceId();return n&&n!==e})))return!1}}if("private"===m){const e=S.getSpaceId();if(e){if(c.some((t=>{const n=t.getSpaceId();return n&&n!==e})))return!1}}}if((0,Md().dL)(S))return!1;if("suggest"===wd().Uv.getMode(S))return!1;const x=(0,jp().U)(S);if(x&&x.isInTrashStore.state)return!1;const A=S.getAssociatedCollectionStore();if(n===Pn().bH.Onto&&A){const e=A.id,t=(0,jp().U)(S),n=null==t?void 0:t.collectionViewBlockStore(),i=null==t?void 0:t.collectionViewStore();if(n&&i&&"page"!==i.getType()){if(c.find((i=>{const o=i.getAssociatedCollectionStore(),s=(0,jp().U)(i);return Boolean(i instanceof xn().B&&o&&o.id===e)||Boolean(s===t&&S.id!==n.id)})))return!1}}if(n!==Pn().bH.Onto){const e=(0,jp().U)(S);if("collectionTypedView"===(null==e?void 0:e.contextType)&&e.databaseType){if(!c.find((t=>{const n=(0,jp().U)(t);return(null==n?void 0:n.databaseType)===e.databaseType})))return!1}}if(t.props.groupsPointer){var M;const e=(null==A?void 0:A.getSchema())??(null===(M=(0,jp().U)(S))||void 0===M||null===(M=M.collectionStore())||void 0===M?void 0:M.getSchema());if(Boolean(t.props.groupsPointer.find((t=>!e||!(0,xp().wj)(t,e))))){if(c.find((e=>{var n;const i=eg().T.findSelectableFromStore(e);return(null==i||null===(n=i.props)||void 0===n?void 0:n.groupsPointer)&&t.props.groupsPointer&&!(0,Ap().PZ)(i.props.groupsPointer,t.props.groupsPointer)})))return!1}}if(!(0,Yp().Zw)({itemsToMove:c,destinationStore:S,direction:n,draggingOutlinerType:g}))return!1;if(i&&c.find((e=>e.isTypedCollectionViewBlock()||(0,wp().s)(e))))return!1;if(v&&n!==Pn().bH.Onto&&!h&&!(0,Tp().e)({environment:o,blocks:[v.store],publicEditMode:null==s?void 0:s.publicEditModeStore.state}))return!1;if(m&&u)return!1;if("bookmarks"===g&&f&&("bookmarks"!==m||!h||n===Pn().bH.Onto))return!1;if("bookmarks"===m&&h&&n!==Pn().bH.Onto&&("bookmarks"!==g||!f))return!1;if(p&&p.isTopLevelItem&&"team"===p.type&&p.parentStore&&p.parentStore.table===Mp().yK){const e=p.parentStore,t=ig().h.createChildStore(e,{...e.pointer,table:Mp().yK});if(t&&!(0,$p().dp)({teamStore:t,environment:o}))return!1}if(v&&v.isTopLevelItem&&"team"===v.type&&v.parentStore&&v.parentStore.table===Mp().yK){const e=v.parentStore,t=ig().h.createChildStore(e,{...e.pointer,table:Mp().yK});if(t&&!(0,$p().dp)({teamStore:t,environment:o}))return!1}const{sidebarSpaceViewStore:w,currentUserSettingsStore:j}=ae().default.state,k=m?$p().r_[m]:void 0;if(w&&v&&p&&k&&v.isTopLevelItem&&n!==Pn().bH.Onto&&p.type!==m){const{sortOption:e}=(0,$p().RQ)({spaceViewStore:w,type:k,userSettingsStore:j});if("lastEdited"===e)return!1}if("shared"===m&&h&&n!==Pn().bH.Onto&&("shared"!==g||!f))return!1;if(m&&h&&n!==Pn().bH.Onto){if(c.find((e=>{const t=e.getType();return Boolean(!t||!Mt().BJ[t])})))return!1}const{device:I}=o;if(m&&I.isMobile&&n===Pn().bH.Onto&&h)return!1;if(c.some((e=>Boolean(Qp().A.findCollectionTemplatePickerItemFromStore(e))))!==Boolean(Qp().A.findCollectionTemplatePickerItemFromStore(S)))return!1;if(n===Pn().bH.Onto&&S&&!(0,Cp().p)({environment:o,blocks:[S],publicEditMode:null==s?void 0:s.publicEditModeStore.state}))return!1;if(!a(c))return!1;if(c.some((e=>e.isTransclusionType()))){if(S.findRecordStoreUIAncestor((e=>{if(e===S)return!1;const t=e.isTable("block")&&e.isPath([])&&e.getKeyStore("type").getValue();return Boolean(t&&(0,Mt().Mp)(t))})).ancestor)return!1}return!0}function bg(){const e=(0,s().Y0)(),t=(0,s().v3)(),{isMobile:n,isElectron:p}=e;(0,i.useEffect)((()=>{if(n){function e(e){e.preventDefault()}return document.addEventListener("gesturestart",e),()=>{document.removeEventListener("gesturestart",e)}}}),[n]),(0,i.useEffect)((()=>{function e(e){e.preventDefault()}return window.addEventListener("dragstart",e),()=>{window.removeEventListener("dragstart",e)}}),[]),(0,i.useEffect)((()=>{function e(e){_e().default.state.isActive&&(e.preventDefault(),a().K1({environment:t,currentX:_e().default.state.currentX,currentY:_e().default.state.currentY,toggle:e.shiftKey}))}function n(e){_e().default.state.isActive&&(e.preventDefault(),a().K1({environment:t,currentX:e.clientX,currentY:e.clientY,toggle:e.shiftKey}))}function i(e){_e().default.state.isActive&&((0,o().M)(e)||e.preventDefault(),a().OG(t))}return window.addEventListener("keydown",e),window.addEventListener("keyup",e),window.addEventListener("mousemove",n),window.addEventListener("mouseup",i),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",e),window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",i)}}),[t]);const g=t.currentUser.isLoggedIn();return de(g),dg(),(0,B.jsxs)(i.Fragment,{children:[(0,B.jsx)(Ut,{}),(0,B.jsx)(u().Gc,{}),(0,B.jsx)(u().MC,{}),(0,B.jsx)(ve,{}),(0,B.jsx)(He().A,{priority:-1,capture:!0,debugName:"AppComponents"}),g&&!n?(0,B.jsx)(yc,{}):void 0,g?(0,B.jsx)(Ce().AuthSyncListener,{}):void 0,g?(0,B.jsx)(Nn,{}):void 0,g?(0,B.jsx)(zn,{}):void 0,g?(0,B.jsx)(Qi,{}):void 0,g?(0,B.jsx)(ke,{}):void 0,g?(0,B.jsx)(Be,{}):void 0,g?(0,B.jsx)(xe,{}):void 0,g?(0,B.jsx)(bp,{}):void 0,g?(0,B.jsx)(qe,{}):void 0,(0,B.jsx)(Dn,{}),(0,B.jsx)(vl,{}),(0,B.jsx)(f().Li,{}),(0,B.jsx)(f().Tb,{}),(0,B.jsx)(Ul,{}),(0,B.jsx)(_l,{}),(0,B.jsx)(Lo,{}),(0,B.jsx)(In,{}),n?void 0:(0,B.jsx)(qd,{}),(0,B.jsx)(es,{}),(0,B.jsx)(Ml,{}),(0,B.jsx)(Mn,{}),(0,B.jsx)(us().A,{}),(0,B.jsx)(r().C4,{store:l().A}),(0,B.jsx)(r().C4,{store:d().A}),(0,B.jsx)(c().DV,{}),(0,B.jsx)(ol,{}),(0,B.jsx)(Te().Tm,{}),(0,B.jsx)(D,{}),(0,B.jsx)(Ni,{}),(0,B.jsx)(Ie().Sd,{}),(0,B.jsx)(op,{}),(0,B.jsx)(cs,{}),(0,B.jsx)($u,{}),(0,B.jsx)(fn,{}),(0,B.jsx)(Sc().A,{}),(0,B.jsx)(ge,{}),p?(0,B.jsx)(m,{}):void 0,(0,B.jsx)(ti,{}),(0,B.jsx)(Tn().Y,{}),g?(0,B.jsx)(Iu,{}):void 0,(0,B.jsx)(Qo().nJ,{}),(0,B.jsx)(ut,{}),(0,B.jsx)(En().yQ,{}),g?(0,B.jsx)(Hn,{}):void 0,(0,B.jsx)(h().h,{})]})}},618841:(e,t,n)=>{n.d(t,{C:()=>u,A:()=>c});n(296540);var i=()=>n(562866),o=()=>n(645873);const s=new(o().O2)("SlackImportsInviteWithModal",(async()=>await n.e(68117).then(n.bind(n,559183)))),a=(0,o()._h)(s,(e=>e.SlackImportsInviteWithModal));var r=()=>n(803557),l=()=>n(437487),d=n(474848);function c(e){const{onInviteClick:t,onInviteComplete:n,buttonStyle:o,buttonContainerStyle:s,spacePermissionsSettingsStore:r,shouldAddMembers:l=!0}=e;return[{key:"slack_imports",render:()=>(0,d.jsx)(a,{inviteOrigin:"space_setting_slack_dropdown",canEditPermission:!0,onInviteClick:t,onInviteComplete:n,buttonLabel:(0,d.jsx)(i().$c,{type:"slack"}),buttonStyle:o,buttonContainerStyle:s,spacePermissionsSettingsStore:r,shouldAddMembers:l}),action:()=>{}},{key:"google_imports",render:()=>(0,d.jsx)(i().aI,{inviteOrigin:"space_setting_google_dropdown",canEditPermission:!0,onInviteClick:t,onInviteComplete:n,buttonLabel:(0,d.jsx)(i().$c,{type:"google"}),buttonStyle:o,buttonContainerStyle:s,spacePermissionsSettingsStore:r,shouldAddMembers:l}),action:()=>{}},{key:"microsoft_imports",render:()=>(0,d.jsx)(i().Xd,{inviteOrigin:"space_setting_microsoft_dropdown",canEditPermission:!0,onInviteClick:t,onInviteComplete:n,buttonLabel:(0,d.jsx)(i().$c,{type:"microsoft"}),spacePermissionsSettingsStore:r,shouldAddMembers:l}),action:()=>{}}]}function u(e){const{onClickAuthenticated:t,hideChevronIcon:n,containerStyle:o,buttonStyle:s,flowId:a}=e;return[{key:"slack_imports",render:()=>(0,d.jsx)(r().Xx,{onClickAuthenticated:({isAfterImportConnection:e})=>t(l().NL.Slack,!e),title:(0,d.jsx)(i().$c,{type:"slack"}),containerStyle:o,buttonStyle:s,from:"share_menu",inviteOrigin:"page_share_modal",flowId:a,loadContacts:!0,hideChevronIcon:n}),action:()=>{}},{key:"google_imports",render:()=>(0,d.jsx)(r().KG,{onClickAuthenticated:({isAfterImportConnection:e})=>t(l().NL.Google,!e),containerStyle:o,buttonStyle:s,from:"share_menu",inviteOrigin:"page_share_modal",flowId:a,loadContacts:!0,hideChevronIcon:n,buttonLabel:(0,d.jsx)(i().$c,{type:"google"})}),action:()=>{}},{key:"microsoft_imports",render:()=>(0,d.jsx)(r().PX,{onClickAuthenticated:({isAfterImportConnection:e})=>t(l().NL.Microsoft,!e),buttonLabel:(0,d.jsx)(i().$c,{type:"microsoft"}),from:"share_menu",inviteOrigin:"page_share_modal",loadContacts:!0,hideChevronIcon:n}),action:()=>{}}]}},622311:(e,t,n)=>{n.d(t,{E:()=>o});n(898992),n(823215);var i=()=>n(329443);function o(e){return e.blocks.every((t=>Boolean(i().qb(e.environment,t))))}},637096:(e,t,n)=>{n.d(t,{W:()=>c});var i=n(296540),o=()=>n(484714),s=()=>n(56366),a=()=>n(40970),r=()=>n(765957),l=()=>n(645200),d=()=>n(583238);function c(e){const{collectionContextStore:t,entrypoint:n}=e,c=(0,o().v3)(),u=(0,s().O$)(r().AppStoreSidebarSpaceStore),p=(0,s().K8)((()=>(0,d().mX)()),[]);return(0,i.useCallback)((()=>{const e=t.collectionViewStore(),i=t.collectionStore(),o=null==i?void 0:i.getParentBlockStore();e&&i&&o&&u&&(a().tC(c,{is_calendar_connected:p,collection_id:i.id,collection_view_id:e.id,collection_view_block_id:o.id,entrypoint:n}),l().Op({environment:c,collectionViewStore:e,spaceStore:u,from:"openInCalendarButton"}))}),[c,t,u,p,n])}},654856:(e,t,n)=>{n.d(t,{A:()=>u});n(581454);var i=n(296540),o=()=>n(56366),s=()=>n(69708),a=()=>n(743260),r=()=>n(299545),l=()=>n(417555),d=()=>n(856952),c=n(474848);const u=function(e){const{origin:t,permissionsInviteStore:u,store:p,handleClickRemoveToken:g,handleInputChange:m,handleInputSubmit:f,right:h,focus:v,handleFocus:y}=e,b=(0,o().K8)((()=>0!==(0,n(329443).Qo)()),[]),S="share_menu"===t||"add_members"===t,x="add_members"===t,[A,M]=(0,o().$y)(u),w=(0,n(484714).v3)(),{device:j}=w,k=(0,s().tz)(),{tokenQuery:I}=A,C=(0,n(101749).N)(p),T=A.inviteTargets.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`,o=(0,a().yi)(e),r="newUser"===e.type||"existingUser"===e.type?e.value.email:void 0,d=o?C:void 0,u={key:t,target:e,onClickRemove:g,shouldWrap:S,showInfoIcon:Boolean(d)};return S&&r?(0,c.jsx)(n(859428).A,{placement:"top",disableTooltip:x,renderTooltip:()=>o?d||(0,c.jsx)(s().sA,{defaultMessage:"{email} will be invited as a guest",id:"ContextualInvite.permissions_invites.guest.tooltip",values:{email:r}}):r,render:n=>(0,i.createElement)("span",{...n,key:t},(0,c.jsx)(l().A,{...u,backgroundColor:(0,a().qv)(e)}))},t):(0,i.createElement)(l().A,{...u,key:t})})),_=0===A.inviteTargets.length;return(0,c.jsx)(d().Ay,{focus:j.isMobile?void 0:v,focusInitial:j.isMobile,focusAfterAnimation:!0,onClick:()=>{j.isMobile||null==y||y()},format:d().le.Share,value:I,onChange:m,type:"email",tokens:T,disabled:!1,autoComplete:"off",placeholder:S?b?k.formatMessage({defaultMessage:"Add people, groups, or emailsâ€¦",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithTeams"}):k.formatMessage({defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots"}):(0,r().Yu)(p)||(0,r().nw)(p)?k.formatMessage({id:"inviteUserModal.searchInput.placeholder",defaultMessage:"Search name or emails"}):k.formatMessage({id:"permissionsInvite.searchInput.placeholder",defaultMessage:"Search emails, names, or groups"}),onRemoveLastToken:()=>{const e={...A};e.inviteTargets=e.inviteTargets.slice(0,-1),M(A)},right:h,inputFullWidth:!0,inputAndTokenWrapRightStyle:{paddingTop:w.device.isMobile||"add_members"===t?0:_?7:6,paddingBottom:w.device.isMobile||S?0:4},onEmptySubmit:()=>f(),dontShowBorderBottom:j.isAndroid,showBorder:S,...!S&&{style:{padding:"10px  9px 4px 9px"}},...S&&{style:{borderRadius:4,paddingTop:_?3:0,paddingBottom:0,...v&&{background:"none"}}}})}},669548:(e,t,n)=>{n.d(t,{w:()=>u});n(16280),n(18107),n(967357);var i=()=>n(388821),o=()=>n(179034),s=()=>n(824438),a=()=>n(544198),r=()=>n(594794),l=()=>n(765957),d=()=>n(970330),c=()=>n(863168);function u(e){var t,n;const{environment:u,createBlockItem:p,from:g,inMemoryRecordCache:m,transaction:f,selection:h}=e;if(!p.templateRootBlockId||!p.createTemplate)throw new Error("Invalid createBlock item.");const v=(h.length>0?h[0].getSpaceId():void 0)??e.spaceId??(null===(t=l().default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.getSpaceId()),y=v?u.idCreator.getSpaceIdCreatorSync(v):void 0,{targetBlockStore:b}=(0,s().j)({environment:u,sourceBlockId:p.templateRootBlockId,targetBlockPointer:(0,r().zP)({environment:u,table:o().ev,spaceId:v}),sourceBlockSubtree:(0,i().partialRecordMapToRecordMap)(p.createTemplate(u)),targetRecordCache:m,transaction:f,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,spaceIdCreator:y});null===(n=p.postCreateCallback)||void 0===n||n.call(p,b,u,f);const[S]=h;if(c().eY({environment:u,store:b,transaction:f,previousStore:S}),g&&p.blockType){var x;const e=p.collectionViewType,t="full_page"===e,n=0!==h.length?null===(x=h[0])||void 0===x?void 0:x.getParentCollectionIdUpToTwoLevels():void 0;let i,o,s,r;if("chart"===e){var A,M;const e=null===(A=b.getCollectionViewStores())||void 0===A?void 0:A.at(0);i=null==e||null===(M=e.getChartConfig())||void 0===M?void 0:M.type,o=null==e?void 0:e.getChartPlaceholderType()}if("form_editor"===e){var w;const e=null===(w=b.getCollectionViewStores())||void 0===w?void 0:w.at(0),t=null==e?void 0:e.getFormBlockStore();s=null==t?void 0:t.id,r=null==e?void 0:e.id}const{collectionId:l,ownedCollectionCount:c,linkedCollectionCount:m}=(0,a().P)(b,{skipPages:!1}),f={from:g,collection_id:l,owned_collection_count:c,linked_collection_count:m,view_type:"inline"===e||"full_page"===e?"table":e,is_toggleable:p.isToggleable,automation_id:b.getAutomationId(),new_page_id:"page"===p.blockType?b.id:void 0,creating_block_id:b.id,parent_collection_id:n,is_full_screen:t,chart_type:"placeholder"===i?o:i,is_chart_placeholder:"placeholder"===i,form_id:s,view_id:r},v=p.blockType;d().tP(v)?d().vH(u,{...f,type:v,collection_id:l||""}):d().vH(u,{...f,type:v})}return b}},673898:(e,t,n)=>{n.d(t,{A:()=>o});class i extends(()=>n(757695))().Store{getInitialState(){return{active:!1,stringValue:""}}}const o=new i},681242:(e,t,n)=>{n.r(t),n.d(t,{checkmarkShieldFillIcon:()=>o,iconDefinition:()=>i});n(296540);const i={viewBox:"0 0 20 20",fittedViewBox:"3.02 2.12 13.95 15.75",svg:(0,n(474848).jsx)("path",{d:"M9.698 2.196a.68.68 0 0 1 .604 0l1.89.945a7.4 7.4 0 0 0 3.32.784h.788c.373 0 .675.302.675.675v6.933a5.18 5.18 0 0 1-3.137 4.756l-3.572 1.531a.68.68 0 0 1-.532 0l-3.573-1.53a5.18 5.18 0 0 1-3.136-4.757V4.6c0-.373.302-.675.675-.675h.788c1.152 0 2.29-.268 3.32-.784zm3.178 5.782a.625.625 0 1 0-1.072-.643L9.25 11.59 7.814 9.916a.625.625 0 0 0-.949.814l2 2.333a.625.625 0 0 0 1.01-.085z"})},o=(0,n(340498).wt)("checkmarkShieldFill",i)},682563:(e,t,n)=>{n.r(t),n.d(t,{gearFillIcon:()=>o,iconDefinition:()=>i});n(296540);const i={viewBox:"0 0 20 20",fittedViewBox:"2.83 2.82 14.36 14.36",svg:(0,n(474848).jsx)("path",{d:"M15.76 5.73c.12.16.12.39 0 .56l.01-.01-.74 1.05c-.11.16-.12.35-.05.52l.09.21c.07.18.22.31.4.34l1.25.22c.21.03.37.19.4.4.05.32.07.64.07.96V10c0 .36-.03.71-.08 1.05-.03.21-.2.36-.4.4l-1.27.22a.52.52 0 0 0-.4.33l-.09.21a.51.51 0 0 0 .04.52l.73 1.03c.12.17.13.4 0 .57-.19.26-.4.5-.63.74h-.01c-.25.25-.51.48-.79.69a.48.48 0 0 1-.56 0l-1.05-.74a.54.54 0 0 0-.52-.05l-.21.09a.53.53 0 0 0-.34.4l-.22 1.25c-.03.21-.19.37-.4.4-.32.05-.64.07-.96.07h-.02c-.36 0-.71-.03-1.05-.08a.49.49 0 0 1-.4-.4l-.22-1.27a.52.52 0 0 0-.33-.4l-.21-.09a.51.51 0 0 0-.52.04l-1.03.73a.48.48 0 0 1-.57 0c-.25-.19-.49-.4-.72-.64h-.01c-.25-.25-.48-.51-.69-.79a.48.48 0 0 1 0-.56L5 12.67c.11-.15.12-.34.05-.51l-.09-.21a.53.53 0 0 0-.4-.34l-1.25-.22a.47.47 0 0 1-.4-.4c-.05-.32-.07-.64-.07-.96v-.02c0-.36.03-.71.08-1.05.03-.21.2-.36.4-.4l1.27-.22a.52.52 0 0 0 .4-.33l.09-.21a.51.51 0 0 0-.04-.52l-.73-1.03a.48.48 0 0 1 0-.57c.19-.26.4-.5.63-.74h.01c.25-.26.51-.48.79-.69a.48.48 0 0 1 .56 0l1.05.74c.15.11.34.12.51.05l.21-.09a.53.53 0 0 0 .34-.4l.22-1.25c.03-.21.19-.37.4-.4.32-.05.64-.07.96-.07h.02c.36 0 .71.03 1.05.08.21.03.36.2.4.4l.22 1.27c.03.19.16.33.33.4l.21.09c.17.08.37.07.52-.04l1.03-.73c.17-.12.4-.13.57 0 .25.19.49.4.72.64h.01c.25.25.48.51.69.79M12.08 10c0-1.15-.93-2.08-2.08-2.08S7.92 8.85 7.92 10s.93 2.08 2.08 2.08 2.08-.93 2.08-2.08"})},o=(0,n(340498).wt)("gearFill",i)},687039:(e,t,n)=>{n.d(t,{Ay:()=>r,VH:()=>s});n(898992),n(803949),n(814603),n(147566),n(198721);var i=n(296540),o=n(474848);const s={"en-US":"en","ja-JP":"ja","ko-KR":"ko","fr-FR":"fr","de-DE":"de","pt-BR":"pt-BR","es-ES":"es-ES"};function a(e){return e.src?(0,o.jsx)("img",{alt:"",style:e.style,src:e.src}):null}const r=i.forwardRef((function(e,t){const s=i.useRef(e);s.current=e;const r=i.useRef(void 0),[l,d]=i.useState(Boolean(e.customPlayButton)),[c,u]=i.useState(!1);i.useEffect((()=>{let t,n=!0;const i=()=>{const o=window.Vimeo;if(!o||!n)return;const a=document.getElementById(e.src);if(a)try{var l,c;if(t=new o.Player(a,{logging:!1}),r.current=t,!n||!t)return;t.on("play",(e=>{var t,n;d(!1),null===(t=(n=s.current).onPlay)||void 0===t||t.call(n,e)})),t.on("pause",(e=>{var t,n;null===(t=(n=s.current).onPause)||void 0===t||t.call(n,e)})),t.on("ended",(e=>{var t,n;null===(t=(n=s.current).onEnd)||void 0===t||t.call(n,e)})),null===(l=(c=s.current).onPlayerReady)||void 0===l||l.call(c,t),t.on("timeupdate",(e=>{var t,n;null===(t=(n=s.current).onTimeUpdate)||void 0===t||t.call(n,e)}))}catch(u){}else setTimeout(i,50)};if(window.Vimeo)i();else{const e=document.createElement("script");e.src="https://player.vimeo.com/api/player.js",e.onload=i,document.body.appendChild(e)}return()=>{if(n=!1,r.current=void 0,t)try{t.off("play"),t.off("pause"),t.off("ended"),t.off("timeupdate")}catch(e){}}}),[e.src]);const p=i.useCallback((()=>{const e=r.current;e&&(u(!0),e.play().catch((e=>{n(165358).log({level:"error",from:"VimeoVideoPlayer",type:"vimeo_play_failed",error:e})})))}),[]),g=function(e,t){const i=new URL(e);return(0,(()=>n(534177))().WP)(t).forEach((([e,t])=>{void 0!==t&&i.searchParams.set(e,String(t))})),i.toString()}(e.src,{texttrack:e.defaultTextTrack,playsinline:!1,...e.options}),m=(0,n(401497).IS)((e=>({innerStyle:{position:"absolute",top:0,insetInlineStart:0,width:"100%",height:"100%",border:0,boxShadow:`0 1px 0 0 ${e.border.secondary}`},customPlayButtonOverlay:{position:"absolute",top:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(0, 0, 0, 0.4)",opacity:c?0:1,transition:"opacity 0.15s ease-out",pointerEvents:c?"none":"auto"}})),[c]);return(0,o.jsxs)(n(25500).A,{ratio:e.aspectRatioOverride??9/16,children:[(0,o.jsx)(a,{style:{...m.innerStyle,...e.preloadThumbnailStyle},src:e.preloadThumbnailSrc}),(0,o.jsx)("iframe",{ref:t,id:e.src,className:e.className,allowFullScreen:!0,src:g,style:{...m.innerStyle,...e.style}}),l&&e.customPlayButton?(0,o.jsx)("div",{style:m.customPlayButtonOverlay,children:(0,o.jsx)(n(160432).A,{onClick:p,size:"lg",colorPalette:"blue",children:e.customPlayButton})}):void 0]})}))},687633:(e,t,n)=>{n.d(t,{u:()=>s});var i=()=>n(314529),o=()=>n(242422);function s(e,t){(0,i().DO_NOT_USE_trackLegacy)(e,"template_gallery_public_page_topbar_click",t,{dontWait:!0}),o().default.logEvent("template_gallery_public_page_topbar_click",t.target)}},687646:(e,t,n)=>{n.d(t,{k:()=>o});n(296540);var i=n(474848);const o=(0,n(340498).wt)("searchInPage",{viewBox:"0 0 12 14",svg:(0,i.jsx)("path",{d:"M2.877 13.365h6.24c.63 0 1.104-.164 1.424-.492.32-.324.48-.8.48-1.43V6.13c0-.274-.015-.504-.046-.691a1.531 1.531 0 00-.182-.522 2.185 2.185 0 00-.387-.498l-3.07-3.123a2.11 2.11 0 00-.48-.38 1.528 1.528 0 00-.51-.183A3.464 3.464 0 005.7.68H2.877c-.629 0-1.104.164-1.424.492-.32.324-.48.8-.48 1.43v8.841c0 .633.16 1.112.48 1.436.32.324.795.486 1.424.486zm.094-1.154c-.282 0-.492-.072-.633-.217-.14-.144-.211-.351-.211-.621V2.678c0-.27.07-.479.21-.627.142-.149.354-.223.64-.223h2.496V5.04c0 .418.101.73.304.938.207.207.52.31.938.31h3.158v5.086c0 .27-.07.477-.21.621-.142.145-.354.217-.64.217H2.971zm3.855-6.938c-.12 0-.209-.027-.263-.082-.051-.054-.077-.142-.077-.263V1.986l3.229 3.287H6.826z"})})},694894:(e,t,n)=>{n.r(t),n.d(t,{arrowInCircleUpFillSmallIcon:()=>o,iconDefinition:()=>i});n(296540);const i={viewBox:"0 0 16 16",fittedViewBox:"1.95 1.95 12.11 12.11",svg:(0,n(474848).jsx)("path",{fillRule:"evenodd",d:"M8 14.05a6.05 6.05 0 1 0 0-12.1 6.05 6.05 0 0 0 0 12.1m2.47-6.37a.55.55 0 0 1-.778 0l-1.14-1.141v4.252a.55.55 0 0 1-1.1 0V6.538L6.31 7.678a.55.55 0 0 1-.778-.777l2.08-2.08a.55.55 0 0 1 .778 0l2.08 2.08a.55.55 0 0 1 0 .778",clipRule:"evenodd"})},o=(0,n(340498).wt)("arrowInCircleUpFillSmall",i)},696384:(e,t,n)=>{n.d(t,{V:()=>s,h:()=>o});var i=()=>n(91669);function o(){i().z.setState({isOpen:!0})}function s(){i().z.setState({isOpen:!1})}},701545:(e,t,n)=>{n.d(t,{p:()=>o});n(296540);var i=n(474848);const o=(0,n(340498).wt)("checkMarkLine",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M6.79297 13.2871C6.48047 13.2871 6.21484 13.1523 5.99609 12.8828L2.96094 9.14453C2.875 9.04297 2.8125 8.94336 2.77344 8.8457C2.73828 8.74805 2.7207 8.64648 2.7207 8.54102C2.7207 8.30664 2.79883 8.11328 2.95508 7.96094C3.11133 7.80859 3.30859 7.73242 3.54688 7.73242C3.81641 7.73242 4.04297 7.84766 4.22656 8.07812L6.76953 11.3008L11.7324 3.4375C11.834 3.28125 11.9395 3.17188 12.0488 3.10938C12.1582 3.04297 12.2949 3.00977 12.459 3.00977C12.6973 3.00977 12.8926 3.08398 13.0449 3.23242C13.1973 3.38086 13.2734 3.57031 13.2734 3.80078C13.2734 3.89453 13.2578 3.98828 13.2266 4.08203C13.1953 4.17578 13.1465 4.27344 13.0801 4.375L7.5957 12.8594C7.4082 13.1445 7.14062 13.2871 6.79297 13.2871Z"})})},703875:(e,t,n)=>{n.d(t,{N:()=>s,V:()=>o});var i=()=>n(314529);function o(e){(0,i().DO_NOT_USE_trackLegacy)(e,"view_public_site_click")}function s(e,t){(0,i().DO_NOT_USE_trackLegacy)(e,"share_menu_tab_click",t)}},709906:(e,t,n)=>{n.d(t,{aj:()=>U,pJ:()=>V,B2:()=>K,Sg:()=>W,_4:()=>q,X:()=>_});n(296540);var i=()=>n(584262),o=()=>n(75756),s=n(474848);const a={viewBox:"0 0 20 20",fittedViewBox:"2.87 2.37 13 15.25",directional:!0,svg:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{d:"M6.25 2.375A2.125 2.125 0 0 0 4.125 4.5v3.625h1.25V4.5c0-.483.392-.875.875-.875h7.5c.483 0 .875.392.875.875v11a.875.875 0 0 1-.875.875h-7.5a.875.875 0 0 1-.875-.875v-3.625h-1.25V15.5c0 1.174.951 2.125 2.125 2.125h7.5a2.125 2.125 0 0 0 2.125-2.125v-11a2.125 2.125 0 0 0-2.125-2.125z"}),(0,s.jsx)("path",{d:"M12.442 9.558a.625.625 0 0 1 0 .884l-2.5 2.5a.625.625 0 0 1-.884-.884l1.408-1.408H3.5a.625.625 0 0 1 0-1.25h7.016L9.058 7.942a.625.625 0 1 1 .884-.884z"})]})},r=(0,n(340498).wt)("arrowRightIntoRectangle",a);var l=()=>n(589407),d=()=>n(864896);function c(e){(0,n(314529).DO_NOT_USE_trackLegacy)(e,"public_page_topbar_menu_sign_up_log_in_click",{},{dontWait:!0}),n(242422).default.logEvent("public_page_topbar_menu_sign_up_log_in_click")}var u=()=>n(248284),p=()=>n(89924),g=()=>n(815377);n(898992),n(823215);var m=()=>n(622311);function f(e){const{environment:t}=e,i=t.RouterStore.state.route;return(0,n(651784).bh)(i)}var h=()=>n(514779),v=()=>n(775584);var y=()=>n(918871),b=()=>n(49533),S=()=>n(440902),x=()=>n(598101);n(18107),n(967357);var A=()=>n(578872);var M=()=>n(492414),w=()=>n(599364),j=()=>n(10521),k=()=>n(73926);const I=(0,n(69708).YK)({signUpOrLogInName:{id:"action.signUpOrlogIn.name",defaultMessage:"Sign up or log in"},shareLinkName:{id:"action.shareLink.name",defaultMessage:"Share link"},editPageName:{id:"action.editPage.name",defaultMessage:"Edit"},commentPageName:{id:"action.commentPage.name",defaultMessage:"Comment"},duplicatePageName:{id:"action.duplicatePage.name",defaultMessage:"Duplicate"},backtoNotionName:{id:"action.backtoNotion.name",defaultMessage:"Back to Notion"},topbarMobileMoreActionsMenu:{id:"action.topBarSiteMoreMobileActions.name",defaultMessage:"More"},search:{id:"topbar.publicPage.searchButton.label",defaultMessage:"Search"},reportFormName:{id:"action.reportForm.name",defaultMessage:"Report form"},viewOriginalPageName:{id:"action.viewOriginalPage.name",defaultMessage:"View original page"}}),C=(0,j().Ls)({key:"log in",displayName:I.signUpOrLogInName,analyticsName:I.signUpOrLogInName.defaultMessage,svg:r,validators:[(0,x().A)(h().M),function(e){const t=e.blocks.at(0);return!!t&&!A().hn(t)},(0,x().A)(f)],closeParentMenu:!0,action:async({environment:e})=>{c(e),await n(729283).VE(e,{utmContent:"sign_up_or_log_in",nextRoute:n(427704).JZ.login})}}),T=(0,j().Ls)({key:"view original page",displayName:I.viewOriginalPageName,analyticsName:I.viewOriginalPageName.defaultMessage,svg:n(47218).arrowExpandDiagonalBottomLeftToTopRightIcon,validators:[f],closeParentMenu:!0,action:({blocks:e})=>{const t=(0,M().Ay)({store:e[0],preferPublicLink:!0,pageVisitSource:i().y8.EmbedPublicPageViewOriginal,disableSlug:!0,embedded:!1});window.open(`${t}`,"_blank")}}),_=(0,j().Ls)({key:"report form",displayName:I.reportFormName,analyticsName:I.reportFormName.defaultMessage,svg:n(748054).M,validators:[m().E,n(59411).k],closeParentMenu:!0,action:({environment:e,blocks:t})=>{u().Hi(e,t[0].id)}}),P=(0,j().Ls)({key:"ios share link",displayName:I.shareLinkName,analyticsName:I.shareLinkName.defaultMessage,svg:d().Y,validators:[S().v,y().w,n(808565).u],closeParentMenu:!0,action:({blocks:e,environment:t})=>{const n=e[0],o=n.getNavigableBlockStore();if(o){const e=(0,M().Ay)({store:o,scrollToBlockId:o.id===n.id?void 0:n.id,fullyQualified:!0,pageVisitSource:i().y8.NativeShareLink,embedded:!1});t.mobileNative&&t.mobileNative.share(e)}}}),B=(0,j().Ls)({key:"web share link",displayName:I.shareLinkName,analyticsName:I.shareLinkName.defaultMessage,svg:d().Y,validators:[S().v,function({environment:{device:e}}){return e.isMobileBrowser}],closeParentMenu:!0,action:async({blocks:e})=>{const t=e[0],n=t.getNavigableBlockStore();if(n){const e=(0,M().Ay)({store:n,scrollToBlockId:n.id===t.id?void 0:t.id,fullyQualified:!0,pageVisitSource:i().y8.NativeShareLink,embedded:!1});try{await navigator.share({url:e})}catch{}}}}),D=(0,j().Ls)({key:"android share link",displayName:I.shareLinkName,analyticsName:I.shareLinkName.defaultMessage,svg:n(93460).b,validators:[S().v,y().w,n(875855).m],closeParentMenu:P.closeParentMenu,action:P.action}),R=(0,j().Fw)({key:"copy link",displayName:j().AY.copyLinkName,analyticsName:j().AY.copyLinkName.defaultMessage,svg:n(742852).linkIcon,shortcuts:["copyLinkToBlock"],validators:[h().M,S().v,(0,x().A)(y().w),(0,x().A)(b()._)],closeParentMenu:!0,track:{actionName:"copy_block_link"},action:(e,{lazyDependencies:t,environment:n,blocks:i},o)=>{const{clipboardActions:s}=t;s&&s.copyLinkToBlock({environment:n,blockStore:i[0],callback:e})}}),E=(0,j().Ls)({key:"edit page",displayName:I.editPageName,analyticsName:I.editPageName.defaultMessage,svg:n(105819).pencilLineIcon,validators:[(0,x().A)(g().JK),S().v,b()._,function(e){return!n(620149).l.state&&(!!e.blocks.every((e=>e.canEdit()))&&!!(0,m().E)(e))},(0,x().A)((function(e){return e.blocks.every((t=>{var i;return"edit"===(null===(i=n(411671).A.getMode(e.environment,t))||void 0===i?void 0:i.permission)}))})),v().F],closeParentMenu:!0,action:({environment:e,blocks:t})=>{u().T7(e,t[0].id)}}),L=(0,j().Ls)({key:"comment page",displayName:I.commentPageName,analyticsName:I.commentPageName.defaultMessage,svg:n(49621).h,validators:[(0,x().A)(g().JK),S().v,b()._,n(930545).tm,(0,x().A)(h().M),v().F],closeParentMenu:!0,action:({environment:e,blocks:t})=>{u().aL(e,t[0].id)}}),O=(0,j().Ls)({key:"fork page",displayName:I.duplicatePageName,analyticsName:I.duplicatePageName.defaultMessage,svg:n(764781).V,validators:[S().v,v().F,b()._,function(e){return e.blocks.every((e=>n(329443).K1(e)))}],closeParentMenu:!0,action:({blocks:e,originRect:t,environment:i})=>{n(394893).Ul({environment:i,store:e[0],originRect:t})}});function N(e){return(0,j().Ls)({key:"more actions menu",displayName:I.topbarMobileMoreActionsMenu,analyticsName:I.topbarMobileMoreActionsMenu.defaultMessage,svg:l().ellipsisIcon,validators:[S().v,v().F,b()._],closeParentMenu:!0,action:e})}const F=(0,j().Ls)({key:"back to my content",displayName:I.backtoNotionName,analyticsName:I.backtoNotionName.defaultMessage,svg:n(182183).notionTintableIcon,validators:[h().M,v().F],closeParentMenu:!0,action:({environment:e},t)=>{const{currentUserRootStore:o,currentUserSettingsStore:s}=n(765957).default.state;o&&s&&n(601866).t9({environment:e,userRootStore:o,userSettingsStore:s,pageVisitSource:i().y8.SwitchSpace})}}),U=(0,j().Ls)({key:"cookie settings",displayName:o().LS.cookieSettingsLabel,analyticsName:o().LS.cookieSettingsLabel.defaultMessage,validators:[(0,x().A)(n(733637).i),m().E],closeParentMenu:!1,render:e=>(0,s.jsx)(n(455215).A,{hasDismissButton:!1,renderOrigin:t=>{const{onClick:i,...a}=e;return(0,s.jsx)(n(575143).A,{...a,...t,title:n(972435).A.formatMessage(o().LS.cookieSettingsLabel),svg:n(212727).gearIcon})}}),action:()=>{}}),z=(0,j().Ls)({key:"search page",displayName:I.search,analyticsName:I.search.defaultMessage,svg:n(207207).J,validators:[S().v,v().F,b()._,function(e){const t=e.blocks.at(0);return!!t&&!A().Vg(t)}],closeParentMenu:!0,action:({environment:e})=>{n(260488)._N({environment:e,analyticsFrom:"public-page-topbar",isPublicPageSearch:!0})}});function K(e){return(0,j().gy)({key:"page",render:e=>(0,s.jsx)(p().A,{...e}),actions:[z,O,L,E,R,w().o,P,D,N(e)]})}function V(e){return(0,j().gy)({key:"page",render:e=>(0,s.jsx)(p().A,{...e}),actions:[B,P,D,N(e)]})}const q=[(0,j().gy)({key:"user",render:e=>(0,s.jsx)(p().A,{...e}),actions:[F,C,T]}),(0,j().gy)({key:"report page actions",render:e=>(0,s.jsx)(p().A,{...e}),actions:[k().H,_,U]})],W=[(0,j().gy)({key:"report page actions",render:e=>(0,s.jsx)(p().A,{...e}),actions:[k().H,U]})]},712493:(e,t,n)=>{n.r(t),n.d(t,{DummyModal:()=>d});n(296540);var i=()=>n(148307),o=()=>n(69708),s=()=>n(766676),a=n(474848);function r(e){const{messageKey:t}=e,n={id:"",key:t,type:"static",props:{}};return(0,a.jsx)(s().C,{...e,message:n})}const l=(0,o().YK)({title:{id:"dummyModal.title",defaultMessage:"Dummy Modal"},body:{id:"dummyModal.body",defaultMessage:"This is the body for the dummy modal."},primaryButton:{id:"dummyModal.primaryButton",defaultMessage:"Primary"},secondaryButton:{id:"dummyModal.secondaryButton",defaultMessage:"Secondary"},learnMore:{id:"dummyModal.learnMore",defaultMessage:"Learn More"}});function d(){const e=(0,o().tz)();return(0,a.jsx)(r,{messageKey:"dummy_modal",title:e.formatMessage(l.title),body:e.formatMessage(l.body),heroMedia:{src:i().A.images.sites.sitesLaunchModalPng,alt:"Dummy Modal",type:"image"},primary:{text:e.formatMessage(l.primaryButton)},secondary:{text:e.formatMessage(l.secondaryButton)},link:{text:e.formatMessage(l.learnMore),external:!0}})}},715011:(e,t,n)=>{n.d(t,{A:()=>r});var i=n(296540),o=()=>n(69708),s=()=>n(409268),a=n(474848);function r(e){const t=(0,i.useMemo)((()=>(0,s().s)(e.store)),[e.store]);return(0,a.jsx)(o().sA,{id:"pageWordCount.wordCount",defaultMessage:"{count, plural, one {# word} other {# words}}",values:{count:t}})}},730580:(e,t,n)=>{n.d(t,{V:()=>a});n(898992),n(823215);var i=()=>n(329443),o=()=>n(620149),s=()=>n(449195);function a(e){return!o().l.state&&e.blocks.every((t=>{if(i().QT(e.publicEditMode))return!1;const n=s().SE();return n?n.canEditCollection():t.canEdit()}))}},731120:(e,t,n)=>{n.d(t,{A:()=>i});class i extends(()=>n(757695))().Store{getInitialState(){return{isOpen:!1}}}},735790:(e,t,n)=>{n.d(t,{M:()=>s});n(296540);var i=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"2.37 4.25 15.25 11.5",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M3 7.375h6.829a2.501 2.501 0 0 0 4.842 0H17a.625.625 0 1 0 0-1.25h-2.329a2.501 2.501 0 0 0-4.842 0H3a.625.625 0 1 0 0 1.25M12.25 5.5a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5"}),(0,i.jsx)("path",{fillRule:"evenodd",d:"M7.75 15.75a2.5 2.5 0 0 0 2.421-1.875H17a.625.625 0 1 0 0-1.25h-6.829a2.5 2.5 0 0 0-4.842 0H3a.625.625 0 1 0 0 1.25h2.329A2.5 2.5 0 0 0 7.75 15.75m0-1.25a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5",clipRule:"evenodd"})]})},s=(0,n(340498).wt)("sliders",o)},736026:(e,t,n)=>{n.d(t,{A:()=>o});class i extends(()=>n(757695))().Store{getInitialState(){return{open:!1}}}const o=new i},736378:(e,t,n)=>{n.d(t,{T:()=>R});n(296540);var i=()=>n(401497),o=()=>n(252291),s=()=>n(970236),a=()=>n(396896),r=()=>n(406094),l=()=>n(631524),d=()=>n(160432),c=()=>n(493552),u=()=>n(218275),p=n(474848);const g=852,m=1,f=480,h=20;function v(e){const{heroMedia:t,heroElement:n}=e,o=(0,i().IS)((e=>({heroContainer:{width:f,aspectRatio:m,flexShrink:0,borderRadius:6,overflow:"hidden",...t?{position:"relative"}:{}}})),[t]);return(0,p.jsx)("div",{style:o.heroContainer,children:t?(0,p.jsx)(y,{src:t.src,alt:t.alt,type:t.type}):n})}function y(e){const{alt:t,src:n,type:o}=e,s=(0,i().IS)((()=>({media:{width:"100%",height:"100%",position:"absolute",objectFit:"cover",objectPosition:"top center"}})),[]);return"image"===o?(0,p.jsx)("img",{src:n,style:s.media,alt:t}):(0,p.jsx)("video",{title:t,src:n,style:s.media,autoPlay:!0,playsInline:!0,muted:!0,loop:!0,controls:!1})}function b(e){const{title:t,subtitle:n,eyebrow:r,badge:l}=e,d=(0,i().IS)((()=>({title:{textWrap:"pretty"},badge:{margin:0,alignSelf:"start"},badgeInline:{display:"inline-flex",verticalAlign:"middle",marginTop:-4,marginInlineEnd:0,marginBottom:0,marginInlineStart:8}})),[]);return(0,p.jsxs)(a().VP,{gap:4,grow:1,children:[null!=r&&r.text?(0,p.jsxs)(a().fI,{alignItems:"center",gap:4,children:[r.icon?(0,p.jsx)(o().I,{icon:r.icon,colorPalette:null==r?void 0:r.colorPalette,colorVariant:null==r?void 0:r.iconColorVariant}):void 0,(0,p.jsx)(c().D,{styleKey:"Body/Regular",colorPalette:null==r?void 0:r.colorPalette,colorVariant:(null==r?void 0:r.colorVariant)??"primary",children:r.text})]}):null!=l&&l.text?(0,p.jsx)(s().E,{content:l.text,color:l.color,style:d.badge}):void 0,(0,p.jsxs)(c().D,{styleKey:"Title-xl/Bold",colorVariant:"primary",style:d.title,children:[t,null!=r&&r.text&&null!=l&&l.text?(0,p.jsx)(s().E,{content:l.text,color:l.color,style:d.badgeInline}):void 0]}),n?(0,p.jsx)(c().D,{styleKey:"Body/Regular",colorVariant:"secondary",children:n}):void 0]})}function S(e){const{title:t,subtitle:n,body:i,badge:o,eyebrow:s}=e;return(0,p.jsxs)(a().VP,{gap:20,children:[(0,p.jsx)(b,{title:t,subtitle:n,eyebrow:s,badge:o}),i]})}function x(e){const{link:t,secondary:n,primary:o}=e,s=(0,i().IS)((()=>({link:{justifyContent:"center",whiteSpace:"wrap",height:"auto",gap:4,paddingBlock:6}})),[]);return(0,p.jsxs)(a().VP,{gap:8,children:[o?(0,p.jsx)(d().A,{colorPalette:"blue",size:"xl",onClick:o.onClick,autoFocus:!0,iconLeading:o.icon??void 0,children:o.text}):void 0,n?(0,p.jsx)(r().A,{size:"xl",onClick:n.onClick,children:n.text}):void 0,t?(0,p.jsx)(l().p,{colorPalette:"gray",iconTrailing:t.external?{icon:u().arrowUpRightSquareSmallIcon,size:"sm"}:void 0,onClick:t.onClick,style:s.link,children:t.text}):void 0]})}function A(e){const{badge:t,body:n,eyebrow:o,heroElement:s,heroMedia:r,link:l,primary:d,secondary:c,subtitle:u,title:m}=e,f=(0,i().IS)((e=>({container:{width:g,padding:h,background:e.background.elevated}})),[]);return(0,p.jsx)("div",{style:f.container,children:(0,p.jsxs)(a().fI,{gap:24,justifyContent:"space-between",children:[(0,p.jsxs)(a().VP,{gap:24,justifyContent:"space-between",grow:1,children:[(0,p.jsx)(S,{title:m,subtitle:u,body:n,badge:t,eyebrow:o}),(0,p.jsx)(x,{primary:d,secondary:c,link:l})]}),r||s?(0,p.jsx)(v,{heroMedia:r,heroElement:s}):void 0]})})}var M=()=>n(699143),w=()=>n(313633),j=()=>n(296798);const k=480,I=16/9,C=20;function T(e){const{heroMedia:t,heroElement:n}=e,o=(0,i().IS)((()=>({heroContainer:{width:k,marginInlineStart:-C,marginTop:-C,...t?{position:"relative",aspectRatio:I,overflow:"hidden"}:{}}})),[t]);return(0,p.jsx)("div",{style:o.heroContainer,children:t?(0,p.jsx)(_,{src:t.src,alt:t.alt,type:t.type}):n})}function _(e){const{alt:t,src:n,type:o}=e,s=(0,i().IS)((()=>({media:{width:"100%",height:"100%",position:"absolute",objectFit:"cover",objectPosition:"top center"}})),[]);return"image"===o?(0,p.jsx)("img",{src:n,style:s.media,alt:t}):(0,p.jsx)("video",{title:t,src:n,style:s.media,autoPlay:!0,playsInline:!0,muted:!0,loop:!0,controls:!1})}function P(e){const{title:t,body:n,badge:a,eyebrow:r}=e,l=(0,i().IS)((()=>({container:{paddingInlineEnd:4,paddingBottom:12,paddingInlineStart:4,paddingTop:24},title:{textWrap:"pretty"},badge:{margin:0,alignSelf:"start"},badgeInline:{display:"inline-flex",verticalAlign:"middle",marginTop:-4,marginInlineEnd:0,marginBottom:0,marginInlineStart:8}})),[]);return(0,p.jsxs)(M().Y1,{style:l.container,gap:4,children:[null!=r&&r.text?(0,p.jsxs)(M().Y1,{direction:"horizontal",align:"center-left",width:"hug",gap:4,children:[r.icon?(0,p.jsx)(o().I,{icon:r.icon,colorPalette:null==r?void 0:r.colorPalette,colorVariant:null==r?void 0:r.iconColorVariant}):void 0,(0,p.jsx)(c().D,{styleKey:"Body/Regular",colorPalette:null==r?void 0:r.colorPalette,colorVariant:(null==r?void 0:r.colorVariant)??"primary",children:r.text})]}):null!=a&&a.text?(0,p.jsx)(s().E,{content:a.text,color:a.color,style:l.badge}):void 0,(0,p.jsxs)(c().D,{styleKey:"Title-xl/Bold",colorVariant:"primary",style:l.title,children:[t,null!=r&&r.text&&null!=a&&a.text?(0,p.jsx)(s().E,{content:a.text,color:a.color,style:l.badgeInline}):void 0]}),(0,p.jsx)(c().D,{styleKey:"Body/Regular",colorVariant:"secondary",children:n})]})}function B(e){const{link:t,secondary:n,primary:s}=e,a=(0,i().IS)((e=>({container:{marginTop:16},primary:{...null!=s&&s.isFullWidth?{width:"100%"}:{},...null!=s&&s.icon?{gap:4}:{}},link:{color:e.text.secondary,borderRadius:6,padding:"4px 8px",marginInlineStart:-4},linkIcon:{display:"inline-block",verticalAlign:"text-bottom",marginInlineStart:4},secondary:{color:e.text.secondary,padding:"0 12px",borderRadius:6,height:32,display:"flex",alignItems:"center"}})),[s]),r=s?(0,p.jsxs)(d().A,{size:s.isFullWidth?"xl":"lg",onClick:s.onClick,style:a.primary,autoFocus:!0,children:[s.icon?(0,p.jsx)(o().I,{icon:s.icon}):void 0,s.text]}):void 0;if(null!=s&&s.isFullWidth)return(0,p.jsx)("div",{style:a.container,children:r});let g=(0,p.jsx)("div",{});t&&(g=(0,p.jsx)(j().A,{onClick:t.onClick,style:a.link,external:t.external,children:(0,p.jsxs)(c().D,{styleKey:"Body/Regular",colorVariant:"secondary",children:[t.text,t.external?(0,p.jsx)(o().I,{icon:u().arrowUpRightSquareSmallIcon,size:"sm",colorVariant:"secondary",style:a.linkIcon}):void 0]})}));const m=n?(0,p.jsx)(l().p,{onClick:n.onClick,style:a.secondary,external:n.external,children:n.text}):void 0;return(0,p.jsxs)(M().Y1,{style:a.container,direction:"horizontal",align:"center",gap:"auto",children:[g,(0,p.jsxs)(M().Y1,{direction:"horizontal",gap:8,align:"center",width:"hug",children:[m,r]})]})}function D(e){const{title:t,body:n,badge:o,eyebrow:s,heroMedia:a,heroElement:r,primary:l,secondary:d,link:c,onDismiss:u,hideCloseButton:g}=e,m=(0,i().IS)((e=>({container:{width:k,padding:C,position:"relative",backgroundColor:e.background.elevated}})),[]);return(0,p.jsxs)(M().Y1,{style:m.container,direction:"vertical",children:[a||r?(0,p.jsx)(T,{heroMedia:a,heroElement:r}):void 0,(0,p.jsx)(P,{title:t,body:n,badge:o,eyebrow:s}),(0,p.jsx)(B,{primary:l,secondary:d,link:c}),g?void 0:(0,p.jsx)(w().A,{onClick:u})]})}function R(e){const{layout:t,...n}=e;return"horizontal"===t?(0,p.jsx)(A,{...n}):(0,p.jsx)(D,{...n})}},737350:(e,t,n)=>{n.d(t,{Z:()=>b});var i=n(296540),o=()=>n(591779),s=()=>n(69708),a=()=>n(10521),r=()=>n(574036),l=()=>n(859428),d=()=>n(598101),c=()=>n(553965),u=()=>n(968913),p=()=>n(959462),g=()=>n(12314),m=n(474848);const f=(0,s().YK)({name:{id:"action.availableOffline.name",defaultMessage:"Available offline"}});function h(e){return(0,u().DJ)(e)&&(0,u().Bd)(e)?n(671089).checkmarkCircleIcon:(0,u().DJ)(e)&&(0,u().SS)(e)?n(129852).exclamationMarkCircleIcon:n(973238).arrowInCircleDownIcon}function v(e){return(0,u().DJ)(e)}function y(e){return(0,u().Bd)(e)&&!v(e)}const b=(0,a().Ls)({key:"available offline",action:({analyticsFrom:e,blocks:t,environment:i})=>n(231297).createAndCommit({userAction:"actionRegistry.createToggleAction",environment:i,canUndo:!0,perform:()=>{const o=t[0];n(459040).lX({store:o,environment:i,analyticsFrom:e}).catch((()=>{}))}}),analyticsName:f.name.defaultMessage,closeParentMenu:!1,displayName:f.name,render:(e,t)=>{const i=t.blocks[0];return(0,m.jsx)(S,{icon:h(i.id),isChecked:v(i.id),isLoading:(o=i.id,void 0===p().A.state.offlinePages||(0,u().B1)(o)&&p().A.state.isSlowWrite),isOffline:!n(929219).A.state.online,listItemProps:e,showAutosyncTooltip:y(i.id)});var o},validators:[(0,n(963335).S)("download_for_offline"),(0,n(422155).or)([n(929084).b,n(918871).w]),n(514779).M,(0,d().A)(n(333344).P),(0,d().A)(n(9402).P),(0,d().A)(n(340814).v),(0,d().A)(n(234347)._),(0,d().A)(n(395763).i)]});function S(e){const{icon:t,isChecked:d,isLoading:u,isOffline:p,listItemProps:h,showAutosyncTooltip:v}=e,y=(0,n(810312).EW)(),b=(0,i.useRef)(null),S=(0,g().pO)(),x=(0,n(56366).K8)((()=>"unavailable"===(null==y?void 0:y.type)&&!d),[null==y?void 0:y.type,d]),A=(0,o().lW)(v,200,((e,t)=>e===t)),M=(0,o().lW)(x,200,((e,t)=>e===t)),w=(0,o().lW)(u,n(645873)._M,((e,t)=>e===t)),j=({toggleIsDisabled:e})=>({disabled:e,disabledFeedback:e,icon:(0,m.jsx)(a().u5,{icon:t,isLoading:w}),on:d,title:(0,m.jsx)(s().sA,{...f.name})}),k=({toggleIsDisabled:e})=>(0,m.jsx)(l().A,{disableTooltip:!A,placement:"right",render:t=>(0,m.jsx)(r().A,{...(0,c().A)(h,t),...j({toggleIsDisabled:e})}),renderTooltip:()=>(0,m.jsx)(s().sA,{...a().AY.autoSyncedOfflinePageTooltip})});return p?k({toggleIsDisabled:!0}):S?(0,m.jsxs)("div",{ref:b,children:[(0,m.jsx)(r().A,{...h,...j({toggleIsDisabled:!1})}),(0,m.jsx)(g().qo,{originRef:b})]}):M?(0,m.jsx)(l().A,{placement:"right",render:e=>(0,m.jsx)(r().A,{...(0,c().A)(h,e),...j({toggleIsDisabled:!0})}),renderTooltip:()=>(0,m.jsx)(s().sA,{id:"action.availableOffline.abuseCapTooltip",defaultMessage:"Youâ€™ve hit your offline page limit. Remove one to download this page."})}):k({toggleIsDisabled:x})}},748868:(e,t,n)=>{n.d(t,{A:()=>l});n(296540);var i=()=>n(401497),o=()=>n(69708),s=()=>n(939740),a=()=>n(89924),r=n(474848);const l=function(e){const{importListItems:t}=e,l=(0,n(56366).uB)(void 0,n(970585).A),d=(0,i().IS)((e=>({InviteDropdownMenu:{background:e.background.elevated,width:265,borderRadius:8},helpSection:{width:"100%"}})),[]),c={key:"all_import_sections",render:e=>(0,r.jsx)(a().A,{...e,title:(0,r.jsx)(o().sA,{id:"spacePermissionsSettings.inviteLinkRefreshModal.inviteDropdownMenu.title",defaultMessage:"Import from"})}),items:t},u={key:"help_section",render:e=>(0,r.jsx)(a().A,{...e,topBorder:!0}),items:[{key:"help_section",render:e=>p,action:()=>{}}]},p=(0,r.jsx)(n(97294).N,{style:{display:"flex",padding:"0 4px"},className:"notion-print-ignore",href:(0,n(232930).x)("guides.publicAPI"),external:!0,children:(0,r.jsx)(n(631524).p,{iconLeading:{icon:n(721479).questionMarkCircleSmallIcon,size:"sm"},colorPalette:"gray",style:d.helpSection,children:(0,r.jsx)(o().sA,{id:"spacePermissionsSettings.inviteLinkRefreshModal.inviteDropdownMenu.learnMore",defaultMessage:"Learn more"})})});return(0,r.jsx)(n(404277).A,{menuType:n(722872).gu.Popup,children:(0,r.jsx)(s().Ay,{type:s().Oh.Vertical,store:l,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,sections:[c,u],style:d.InviteDropdownMenu})})}},751348:(e,t,n)=>{n.d(t,{n:()=>s});var i=()=>n(56366),o=()=>n(303742);function s(e){return(0,i().K8)((()=>(0,o().o)(e)),[e])}},755170:(e,t,n)=>{n.d(t,{A:()=>h});var i=n(296540),o=()=>n(484714),s=()=>n(56366),a=()=>n(401497),r=()=>n(340498),l=()=>n(284371),d=()=>n(859428),c=()=>n(115512),u=()=>n(665579),p=()=>n(534177),g=n(474848);const m=function({additionalStyles:e,transitionMs:t,force:i,children:o}){const s=(0,n(827912).j)(),r=(0,a().IS)((()=>{let n;switch(i){case"forceShow":n=1;break;case"forceHide":n=0;break;case void 0:n=s?1:0;break;default:(0,p().HB)(i)}return{hoverStyle:{opacity:n,transition:`opacity ${(0,p().O9)(t)?t:200}ms ease-in`,...e}}}),[e,i,s,t]);return(0,g.jsx)("div",{style:r.hoverStyle,children:o})};function f({icon:e,title:t,tooltip:n,hasRightElement:i,iconContainerStyle:s}){const u=(0,o().v3)(),p=(0,a().IS)((e=>({panelTitleAndIcon:{display:"flex",alignItems:"center",fontSize:(0,c().ny)(u,"UISmall"),fontWeight:l().Wy.medium,color:e.text.secondary,fill:e.icon.secondary,flexShrink:0,maxWidth:i?200:"100%"},title:{...l().RC},panelIconContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:r().Ev.sm,height:r().Ev.sm,marginInlineEnd:8,marginTop:1,...s}})),[u,s,i]);return t?(0,g.jsx)(d().A,{renderTooltip:()=>n,disableTooltip:!n,placement:"top",alignment:"start",render:n=>(0,g.jsxs)("div",{style:p.panelTitleAndIcon,...n,children:[(0,g.jsx)("div",{style:p.panelIconContainer,children:e}),(0,g.jsx)("span",{style:p.title,children:t})]})}):null}const h=function({children:e,title:t,icon:r,tooltip:l,iconContainerStyle:d,panelStyle:c,headerStyle:p,rightStyle:h,actions:v,right:y,disableRightFadeIn:b,disableActionsFadeIn:S,hideWrapStyle:x,actionsGap:A,userSelectOverride:M}){const w=(0,o().WS)(),j=Boolean(t),k=Boolean(y),I=(0,s().uB)(void 0,n(620090).B),C=(0,s().uB)(void 0,n(1248)._),T=(0,i.useMemo)((()=>({isHoveredOnPanelStore:I,sizeStore:C})),[I,C]),_=(0,i.useCallback)((()=>I.setState(!0)),[I]),P=(0,i.useCallback)((()=>I.setState(!1)),[I]),B=(0,i.useCallback)((e=>{e.width<u().Xy?C.setState("narrow"):C.setState("wide")}),[C]),D=(0,a().IS)((e=>({tile:{userSelect:M??"none",WebkitUserSelect:M??"none"},panel:x?{}:{paddingInlineStart:12,paddingInlineEnd:12,...(0,u().V$)({isPhone:w,theme:e}),...c},headerContainer:{flexShrink:0,display:"flex",justifyContent:"space-between",alignItems:"center",height:32,paddingBottom:14,marginInlineStart:u().Fq,...p},rightActions:{display:"flex",flexDirection:"row",alignItems:"center"},actions:{display:"flex",alignItems:"center",gap:A??6,paddingInlineStart:6}})),[w,x,c,p,A,M]),R=(j||k)&&(0,g.jsxs)("div",{style:D.headerContainer,children:[(0,g.jsx)(f,{title:t,icon:r,tooltip:l,hasRightElement:k,iconContainerStyle:d}),k||v?(0,g.jsxs)("div",{style:D.rightActions,children:[k?(0,g.jsx)(m,{force:b?"forceShow":void 0,additionalStyles:h,children:y}):void 0,v?(0,g.jsx)(m,{force:S?"forceShow":void 0,additionalStyles:D.actions,children:v}):void 0]}):void 0]});return(0,g.jsx)(n(273923).R.Provider,{value:T,children:(0,g.jsxs)("div",{style:D.tile,onMouseEnter:_,onMouseLeave:P,children:[R,(0,g.jsx)(n(828634).EE,{onSizeChange:B,children:(0,g.jsx)("div",{style:D.panel,children:e})})]})})}},757754:(e,t,n)=>{n.d(t,{AR:()=>N,q8:()=>z});var i=n(296540),o=()=>n(564884),s=()=>n(484714),a=()=>n(56366),r=()=>n(401497),l=()=>n(252291),d=()=>n(631524),c=()=>n(651124),u=()=>n(390066),p=()=>n(142015),g=()=>n(49621),m=()=>n(642557),f=n(474848);const h={viewBox:"0 0 16 16",fittedViewBox:"3.17 1.59 11.88 12.45",svg:(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("path",{d:"M8 8.1a1.125 1.125 0 0 0-.575 2.092v.958a.575.575 0 0 0 1.15 0v-.958A1.125 1.125 0 0 0 8 8.1"}),(0,f.jsx)("path",{d:"M12.2 1.6a2.846 2.846 0 0 0-2.846 2.846V5.8H5.2a2.025 2.025 0 0 0-2.025 2.025v4.2c0 1.118.907 2.025 2.025 2.025h5.6a2.025 2.025 0 0 0 2.025-2.025v-4.2A2.025 2.025 0 0 0 10.8 5.8h-.196V4.446a1.596 1.596 0 1 1 3.192 0v1.63a.625.625 0 1 0 1.25 0v-1.63A2.846 2.846 0 0 0 12.2 1.6M4.425 7.825c0-.428.347-.775.775-.775h5.6c.428 0 .775.347.775.775v4.2a.775.775 0 0 1-.775.775H5.2a.775.775 0 0 1-.775-.775z"})]})},v=(0,n(340498).wt)("lockOpenSmall",h);var y=()=>n(358359),b=()=>n(728396),S=()=>n(69708),x=()=>n(284371),A=()=>n(334261),M=()=>n(384944),w=()=>n(231297),j=()=>n(449195),k=()=>n(722872),I=()=>n(600871),C=()=>n(970176),T=()=>n(557198),_=()=>n(455425),P=()=>n(148832),B=()=>n(404277),D=()=>n(678553),R=()=>n(45552),E=()=>n(89924),L=()=>n(581369),O=()=>n(867159);function N({blockStore:e,useBottomSheetStyling:t}){const n=(0,s().v3)(),o=(0,S().tz)(),{device:r}=n,l=(0,a().K8)((()=>e.isLockedForAllUsers()),[e]),d=(0,a().K8)((()=>_().$.isTemporarilyUnlocked({userId:e.userId,blockId:e.id})),[e.id,e.userId]),c=(0,a().K8)((()=>e.isLocked()),[e]),u=(0,a().K8)((()=>e.isExternalObjectInstancePageBlockStore()),[e]);let p;p=r.isMobile?{menuType:k().gu.Modal,right:t?void 0:(0,f.jsx)(R().DoneMenuText,{}),onClickRight:A().VN,title:o.formatMessage({id:"customizePageMenu.mobileHeader.label",defaultMessage:"Customize page"})}:{menuType:k().gu.Popup,minWidth:300};const g=(0,i.useCallback)((()=>{d?_().$.relockBlock({userId:e.userId,blockId:e.id}):_().$.temporarilyUnlockBlock({userId:e.userId,blockId:e.id})}),[e.id,e.userId,d]);return(0,f.jsxs)(B().A,{...p,children:[l?(0,f.jsx)(W,{isTemporarilyUnlocked:d,onToggleLock:g}):void 0,(0,f.jsx)(U,{blockStore:e,locked:c,isSyncedCollection:u,device:r})]})}function F(e,t){const n=e.getFormat();if(!t)return{};return(0,u().L)(n,t,void 0,c().jf.Collection)}function U({isSyncedCollection:e,blockStore:t,locked:n,device:i}){const o=(0,a().K8)((()=>t.getSchema()),[t]),{store:s,format:r}=(0,a().K8)((()=>{const e=t.getAssociatedCollectionStore();if(!e)return{store:t,format:F(t,t.getSchema())};const n=e.getFormat(),i=e.getSchema();return{store:e,format:(0,u().L)(n,i,void 0,c().jf.Collection)}}),[t]),l=(0,a().K8)((()=>(0,j().vk)(r.page_section_visibility)),[r]),d=(0,a().K8)((()=>t.isCollectionView()),[t]),p=!(0,I().D1)(i),g=!i.isMobile&&!d;if(!o||!s)return null;const m=!e,h=p,v=g,y=!e,b={locked:n,store:s,format:r},S=(0,f.jsxs)(f.Fragment,{children:[h?(0,f.jsx)(K,{...b}):void 0,m?(0,f.jsx)(z,{shouldShowIconAndMargin:!0,...b}):void 0,v?(0,f.jsx)(V,{locked:n,blockStore:t}):void 0,y?(0,f.jsx)(q,{marginCommentsVisibility:l,...b}):void 0]});return(0,f.jsx)(E().A,{style:{opacity:n?.5:1},children:(0,f.jsx)("div",{style:{marginInlineStart:2},children:S})})}function z({locked:e,store:t,format:n,shouldShowIconAndMargin:o}){const d=(0,s().v3)(),c=(0,a().K8)((()=>t instanceof P().B?t.getAssociatedLayoutStore():t.getLayoutStore()),[t]),u=(0,a().K8)((()=>null==c?void 0:c.getLayoutType()),[c]),p=(0,j().z5)(n.page_section_visibility),m="section_show"===p,h=(0,i.useCallback)((()=>{const e="section_show"===p?"section_hide":"section_show";c&&u&&(0,b().U2)(u)&&(0,C().z)({layoutStore:c,moduleId:"discussions",environment:d}),A().OD({environment:d,pageSection:"comments",visibility:e,store:t,format:n})}),[d,n,p,t,c,u]),v=(0,r().IS)((()=>({switcherButtonContainer:{marginInlineEnd:o?4:0},menuItemLabel:{cursor:"pointer"}})),[o]);return(0,f.jsx)(D().Ay,{title:(0,f.jsx)("label",{htmlFor:"page-discussions-switcher",style:v.menuItemLabel,children:(0,f.jsx)(S().sA,{id:"customizePageMenu.pageSections.pageCommentsSwitcherTitle",defaultMessage:"Page discussions"})}),icon:o?(0,f.jsx)(l().I,{icon:g().h}):void 0,right:(0,f.jsx)(L().A,{disabled:e,on:m,onClick:h,inputId:"page-discussions-switcher"}),rightStyle:v.switcherButtonContainer})}function K({locked:e,store:t,format:n}){const{backlinksVisibility:i,updateBacklinksVisibility:o}=(0,T().Ap)({store:t,format:n});return(0,f.jsx)(D().Ay,{title:(0,f.jsx)(S().sA,{id:"customizePageMenu.pageSections.backlinksSwitcherTitle",defaultMessage:"Backlinks"}),icon:(0,f.jsx)(l().I,{icon:p().D}),right:(0,f.jsx)(O().p7,{currentVisibility:i,onSelect:o,disabled:e})})}function V({locked:e,blockStore:t}){const n=(0,r().IS)((()=>({switcherButtonContainer:{marginInlineEnd:4}})),[]),d=(0,s().v3)(),c=(0,a().K8)((()=>{var e;return"off"!==(null===(e=t.getModel())||void 0===e?void 0:e.getFloatingTableOfContentsState())}),[t]),u=(0,i.useCallback)((()=>{w().createAndCommit({userAction:"CustomizePageMenu.handleToggleLockClick",environment:d,canUndo:!0,perform:e=>{M().zv({store:t.getFormatStore(),data:{page_floating_table_of_contents:{state:c?"off":"minimal"}},transaction:e})}}),(0,o().u)({environment:d,event:{eventName:"edit_page_table_of_contents_toggle",eventProperties:{is_table_of_contents_on:!c}}})}),[t,d,c]);return(0,f.jsx)(D().Ay,{title:(0,f.jsx)(S().sA,{id:"action.floatingTableOfContents.name",defaultMessage:"Table of contents"}),icon:(0,f.jsx)(l().I,{icon:y().L}),right:(0,f.jsx)("div",{style:n.switcherButtonContainer,children:(0,f.jsx)(L().A,{disabled:e,on:c,onClick:u})})})}function q({marginCommentsVisibility:e,locked:t,store:n,format:i}){const o=(0,s().v3)();return(0,f.jsx)(D().Ay,{title:(0,f.jsx)(S().sA,{id:"customizePageMenu.pageSections.inlineCommentsTitle",defaultMessage:"Inline comments"}),icon:(0,f.jsx)(l().I,{icon:g().h}),right:(0,f.jsx)(O().J8,{currentVisibility:e,disabled:t,onSelect:e=>{A().OD({environment:o,pageSection:"margin_comments",visibility:e,store:n,format:i})}})})}function W({isTemporarilyUnlocked:e,onToggleLock:t}){const n=(0,r().DP)();return(0,f.jsxs)("div",{style:{fontSize:12,display:"flex",justifyContent:"center",alignItems:"center",borderTop:`1px solid ${n.regularDividerColor}`,borderBottom:`1px solid ${n.regularDividerColor}`,background:n.background.secondary,color:n.text.secondary,paddingTop:6,paddingBottom:6},children:[(0,f.jsx)("span",{style:{display:"inline-block",verticalAlign:"middle",paddingInlineEnd:6},children:e?(0,f.jsx)(l().I,{icon:v,size:"sm",colorVariant:"secondary"}):(0,f.jsx)(l().I,{icon:m().O,size:"sm",colorVariant:"secondary"})}),(0,f.jsx)(S().sA,{id:"customizePageMenu.locked.header",defaultMessage:"Page is locked."}),(0,f.jsx)(d().p,{style:{fontSize:12,color:n.text.secondary,fontWeight:x().Wy.semibold,marginInlineStart:2,paddingInlineStart:4,paddingInlineEnd:4,height:20},onClick:t,children:e?(0,f.jsx)(S().sA,{id:"customizePageMenu.lock.label",defaultMessage:"Re-lock"}):(0,f.jsx)(S().sA,{id:"customizePageMenu.unlock.label",defaultMessage:"Unlock for me"})})]})}},761660:(e,t,n)=>{n.d(t,{J:()=>Q});n(16280),n(581454);var i=n(296540),o=()=>n(59226),s=()=>n(484714),a=()=>n(56366),r=()=>n(401497),l=()=>n(728396),d=()=>n(251822),c=()=>n(800065),u=()=>n(145214),p=()=>n(439264),g=()=>n(218557),m=()=>n(953418),f=()=>n(170253),h=()=>n(978846),v=()=>n(936587),y=()=>n(970176),b=()=>n(316397),S=()=>n(933951),x=(n(18107),n(967357),n(898992),n(354520),()=>n(72645)),A=()=>n(155185),M=()=>n(69708),w=()=>n(285790),j=()=>n(859428),k=()=>n(38337),I=()=>n(104129),C=()=>n(160241),T=()=>n(3197),_=()=>n(937199),P=n(474848);const B=(0,M().YK)({formLayoutAddModule:{id:"addModuleHoverMenu.formLayout.add",defaultMessage:"Add question"},pageLayoutAddModule:{id:"addModuleHoverMenu.pageLayout.add",defaultMessage:"Add"}}),D=32;function R(e){if("views_main_tab_modules"===e.area)throw new Error("[ViewsMain Not Implemented] AddModuleHoverMenu not implemented for views_main_tab_modules");const t=(0,M().tz)(),{layoutStore:n,addModuleHoverMenuStore:i,currentModuleSelection:s}=(0,_().LH)(),l=(0,a().K8)((()=>{if(i.state.isOpen)return i.state.moduleId}),[i]),d=(0,a().K8)((()=>{if(!l)return;const e=I().A.findModuleContainer({layoutStore:n,moduleId:l});return e?e.getNode():void 0}),[l,n]),c=(0,a().K8)((()=>{if(!s||"new_module"===s.type)return!1;const e=n.getModuleById(s.moduleId);return"placeholder"===(null==e?void 0:e.type)}),[s,n]),p=(0,o().X)("bottom_page_discussions_enabled"),g=(0,a().K8)((()=>i.state.isOpen),[i]),m=(0,a().K8)((()=>{var t;if("views_main_tab_modules"===e.area)throw new Error("[ViewsMain Not Implemented] AddModuleHoverMenu not implemented for views_main_tab_modules");if("form_conditional_modules"===e.area)return!1;const i=n.getModules()[e.area],o=(null==i?void 0:i.filter((e=>(0,A()._)(e,p))))??[],s=0===o.length||(null===(t=o.at(-1))||void 0===t?void 0:t.id)===l;return g&&!c&&!s}),[g,l,p,c,n,e.area]),f=(0,T().t)({area:e.area,afterModuleId:l}),h=(0,C().d)(),v=(0,r().IS)((e=>({bigRoundButton:{...h.button,width:D,height:D,borderStartStartRadius:"100%",borderStartEndRadius:"100%",borderEndStartRadius:"100%",transform:"rotate(-45deg)"},bigRoundButtonHovered:{...h.buttonHovered},bigRoundButtonPressed:{...h.buttonPressed}})),[h]),y="form"===(0,a().K8)((()=>{var e;return null===(e=n.getModel())||void 0===e?void 0:e.getLayoutType()}),[n])?t.formatMessage(B.formLayoutAddModule):t.formatMessage(B.pageLayoutAddModule),b=d?d.offsetLeft-40:void 0,S=d?d.offsetTop+d.offsetHeight-4:void 0;return void 0===b||void 0===S?null:(0,P.jsx)(u().A,{visible:m,animate:{opacity:1,scale:1,transformOrigin:"center right"},initial:{opacity:0,scale:.3,transformOrigin:"center right"},exit:{opacity:0,scale:.3,transformOrigin:"center right"},style:{position:"absolute",insetInlineStart:b,top:S},children:(0,P.jsx)(j().A,{placement:"left",renderTooltip:()=>y,render:e=>(0,P.jsx)(w().A,{...e,style:v.bigRoundButton,hoveredStyle:v.bigRoundButtonHovered,className:k().kew,pressedStyle:v.bigRoundButtonPressed,onClick:f,icon:x().b,iconStyle:{width:16,height:16,transform:"rotate(45deg)"},colorPalette:"blue",colorVariant:"accentPrimary",ariaLabel:y})})})}var E=()=>n(21140),L=()=>n(612900),O=()=>n(645873);const N={BuilderAddModuleButtonEducationTooltip:new(O().O2)("BuilderAddModuleButtonEducationTooltip",(()=>n.e(63538).then(n.bind(n,889989))))},F=(0,O()._h)(N.BuilderAddModuleButtonEducationTooltip,(e=>e.default));var U=()=>n(817942);const z=(0,M().YK)({addPageModule:{id:"pageLayout.builder.addModuleToPage.button.ariaLabel",defaultMessage:"Add page module"},addQuestionModuleTooltip:{id:"pageLayout.builder.addModuleToPage.button.addQuestionModuleTooltip",defaultMessage:"Add question"},addModuleToPanelButton:{id:"pageLayout.builder.addModuleToPanel.button.label",defaultMessage:"Add to panel"}}),K=i.forwardRef((function(e,t){const{area:i}=e,{layoutStore:o}=(0,_().LH)(),s=(0,a().K8)((()=>o.getLayoutType()),[o]),l=(0,M().tz)(),d=(0,C().d)(),c=(0,r().IS)((e=>({bigRoundButton:{...d.button,width:32,height:32,borderRadius:"100%"},bigRoundButtonHovered:{...d.buttonHovered},bigRoundButtonPressed:{...d.buttonPressed},emptyModuleAreaAddButton:{cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",paddingTop:8,paddingInlineEnd:16,paddingBottom:8,paddingInlineStart:12,fontSize:14,lineHeight:"20px",fontWeight:500,background:"light"===e.mode?e.palette.uiBlue[100]:e.palette.uiBlue[200],color:e.palette.uiBlue[600],borderRadius:28,transition:"background 0.2s"},emptyModuleAreaAddButtonHover:{...d.buttonHovered},emptyModuleAreaAddButtonPressed:{...d.buttonPressed}})),[d]),u=(0,T().t)("views_main_tab_modules"===i?{area:i,viewsMainTabId:e.viewsMainTabId}:{area:i});if("form_conditional_modules"===i)throw new Error("[Forms Conditional Logic Not Implemented] AddPageLayoutModuleButton not implemented for form_conditional_modules yet.");const p=(0,a().K8)((()=>{var t;const n=o.getModules();return("views_main_tab_modules"===i?(null===(t=n[i])||void 0===t?void 0:t[e.viewsMainTabId])||[]:n[i]??[]).length>0}),[o,i,e.viewsMainTabId]);return"page_details"!==i||p?(0,P.jsx)(j().A,{renderTooltip:()=>l.formatMessage(z.addQuestionModuleTooltip),disableTooltip:"form"!==s,placement:"bottom",render:e=>(0,P.jsx)(w().A,{style:c.bigRoundButton,hoveredStyle:c.bigRoundButtonHovered,pressedStyle:c.bigRoundButtonPressed,onClick:u,icon:x().b,iconStyle:{width:16,height:16},colorPalette:"blue",colorVariant:"accentPrimary",className:k().kew,ariaLabel:l.formatMessage(z.addPageModule),ref:t,...e})}):(0,P.jsxs)(n(718827).Ay,{style:c.emptyModuleAreaAddButton,onClick:u,hoveredStyle:c.emptyModuleAreaAddButtonHover,pressedStyle:c.emptyModuleAreaAddButtonPressed,ref:t,children:[(0,n(464699).b)({width:12,marginInlineEnd:4}),(0,P.jsx)(M().sA,{...z.addModuleToPanelButton})]})})),V=i.memo((function(e){var t;const{shouldShowTooltip:o}=(0,n(384130).J)(),{area:s}=e,r=o&&"page_main"===s,l=o&&"form_layout_schema"!==s,d=i.useRef(null),{currentModuleSelection:c,layoutStore:u,setModuleSelection:p,isPropertyTypeSearchInputDirtyStore:g}=(0,_().LH)(),m=(0,a().K8)((()=>"existing_module"===(null==c?void 0:c.type)?u.getModuleById(c.moduleId):void 0),[c,u]),f=(0,a().K8)((()=>{var t;if("form_conditional_modules"===s)throw new Error("[Forms Conditional Logic Not Implemented] AddPageLayoutModuleButton not implemented for form_conditional_modules yet.");const n=u.getModules();return("views_main_tab_modules"===s?(null===(t=n[s])||void 0===t?void 0:t[e.viewsMainTabId])||[]:n[s]??[]).length>0}),[u,s,e.viewsMainTabId]),[h,v]=i.useState(!1),y=i.useCallback((()=>{g.state||p(void 0)}),[g,p]);return"new_module"===(null==c?void 0:c.type)&&c.area===e.area?(0,P.jsx)(n(998531).N,{onUndo:y,capture:!0,priority:1,debugName:"AddPageLayoutModuleButton",children:(0,P.jsx)(q,{})}):"placeholder"===(null==m?void 0:m.type)?null:r||l?(0,P.jsxs)(E().Ye,{justifyContent:"center",style:null===(b=e.styles)||void 0===b?void 0:b.buttonContainer,className:U().hg,children:[(0,P.jsx)(L().u,{shape:"page_main"===e.area?"circle":"pill",size:"page_main"===e.area||f?32:34,onDependencyLoaded:()=>v(!0),children:(0,P.jsx)(K,{isEducationCalloutVisible:r,...e,ref:d})}),r&&h?(0,P.jsx)(F,{buttonRef:d}):void 0]}):(0,P.jsx)(E().Ye,{justifyContent:"center",style:null===(t=e.styles)||void 0===t?void 0:t.buttonContainer,className:U().hg,children:(0,P.jsx)(K,{isEducationCalloutVisible:!1,ref:d,...e})});var b}));function q(){const e=(0,r().IS)((e=>({ghostPageModuleContainer:{paddingBottom:12},ghostPageModule:{width:"100%",height:160,background:e.palette.uiBlue[75],borderRadius:12,boxShadow:`0px 0px 0px 0px ${e.blue.border.strong}, inset 0px 0px 0px 1px ${e.blue.border.strong}`}})),[]);return(0,P.jsx)("div",{style:e.ghostPageModuleContainer,className:U().hg,children:(0,P.jsx)(L().u,{shape:"square",borderRadius:e.ghostPageModule.borderRadius,width:e.ghostPageModule.width,height:e.ghostPageModule.height,children:(0,P.jsx)("div",{style:e.ghostPageModule})})})}var W=()=>n(496603);const G=12;function H(){const{addModuleHoverMenuStore:e}=(0,_().LH)(),t=(0,b().z)(),n=(0,i.useCallback)((n=>{const i=I().A.getMembersByDOMOrder({filter:e=>"cover"!==e.moduleType&&"form_conditional_modules"!==e.area});let o=null;for(const e of i){const i=e.getNode();if(!i)continue;const s=i.getBoundingClientRect();if(n.clientX>s.right||n.clientX<s.left&&s.left-n.clientX>300)continue;if(n.clientY<=s.bottom&&s.bottom-n.clientY<G||n.clientY>s.bottom&&n.clientY-s.bottom<G+t){o=e;break}}if(o)e.setState({isOpen:!0,moduleId:o.moduleId,menuIsOpen:!1});else{const t=e.getState();t.isOpen&&!t.menuIsOpen&&e.setState({isOpen:!1})}}),[e,t]),o=W().nF(n,30);return(0,i.useEffect)((()=>(window.addEventListener("mousemove",o),()=>{window.removeEventListener("mousemove",o)})),[o]),null}var Y=()=>n(952273);const $={display:void 0};function Q(e){const{area:t}=e;if("form_conditional_modules"===t)throw new Error("[Forms Conditional Logic] Can't render builder layout modules for nested form_conditional_modules directly.");const n=(0,s().v3)(),{sessionId:x,layoutStore:A,currentModuleSelection:M,setModuleSelection:w,canEditLayout:j,layoutBuilderModuleSelectionStore:k}=(0,_().LH)(),I=(0,i.useRef)(null),C=(0,S().ub)({layoutStore:A,pageStoreId:void 0}),T=(0,a().K8)((()=>A.isTabbedPageLayout()),[A]),B=(0,o().X)("bottom_page_discussions_enabled"),D=(0,b().z)(),E=(0,a().K8)((()=>{var n;const i="views_main_tab_modules"===t?(null===(n=C[t])||void 0===n?void 0:n[null==e?void 0:e.viewsMainTabId])||[]:C[t]??[];return(0,d().jS)(t,i,B)}),[t,C,null==e?void 0:e.viewsMainTabId,B],{useDeepEqual:!0}),L=E.nonMoveableHeaderModules,O=(0,i.useMemo)((()=>"moveableCenterModules"in E?E.moveableCenterModules:[]),[E]),N=(0,i.useMemo)((()=>"moveableFooterModules"in E?E.moveableFooterModules:[]),[E]),F=E.nonMoveableFooterModules,z=E.moveableModules,K=(0,a().K8)((()=>{const e=k.state;if(null!=e&&e.isDragging){const n=e.draggingModuleInitialArea,i=e.draggingModuleFinalArea;return{isDraggingIntoThisArea:n.area!==t&&i.area===t,isDraggingFromThisAreaToOtherArea:n.area===t&&i.area!==t,isDraggingAnyModuleList:!0,dragArea:i}}return{isDraggingIntoThisArea:!1,isDraggingFromThisAreaToOtherArea:!1,isDraggingAnyModuleList:!1,dragArea:void 0}}),[t,k]),q=(0,i.useMemo)((()=>z.map((e=>{const n="form_layout_schema"!==t||"placeholder"!==e.type;return{key:e.id,draggable:n}}))),[t,z]),W=(0,i.useMemo)((()=>O.map((e=>{const n="form_layout_schema"!==t||"placeholder"!==e.type;return{key:e.id,draggable:n}}))),[t,O]),G=(0,a().K8)((()=>A.getCollectionFormat()),[A]),Q=(0,i.useMemo)((()=>(0,v().c)(N,G).map((e=>({key:e.id,draggable:!0})))),[N,G]),Z=(0,i.useMemo)((()=>new(f().A)),[]),J=(0,i.useMemo)((()=>new(f().A)),[]),X=(0,i.useMemo)((()=>new(f().A)),[]),ee=(0,a().K8)((()=>Z.state.isDragging),[Z]),te=(0,a().K8)((()=>J.state.isDragging),[J]),ne=(0,a().K8)((()=>X.state.isDragging),[X]),ie=(0,a().K8)((()=>{var e;return null===(e=A.getModel())||void 0===e?void 0:e.getLayoutType()}),[A]);(0,i.useEffect)((()=>{I.current&&K.isDraggingIntoThisArea&&(0,m().$v)({element:I.current,environment:n,additionalPadding:{top:200,bottom:200}})}),[K.isDraggingIntoThisArea,n]);const oe=(0,i.useCallback)((n=>{const i="views_main_tab_modules"===t?{area:"views_main_tab_modules",viewsMainTabId:e.viewsMainTabId}:{area:t};w({type:"existing_module",moduleId:n,isDragging:!0,draggingModuleInitialArea:i,draggingModuleFinalArea:i})}),[t,e.viewsMainTabId,w]),se=(0,i.useCallback)((e=>{e&&w({type:"existing_module",moduleId:e,isDragging:!1})}),[w]),ae=(0,i.useCallback)((()=>{const e=k.state,t=A.getLayoutType();t&&(0,l().Hc)(t)?w(void 0):null!=e&&e.isDragging&&k.setState({...e,isDragging:!1,draggingModuleInitialArea:void 0,draggingModuleFinalArea:void 0})}),[k,w,A]),re=(0,i.useCallback)((e=>{const i=k.state,o=null!=i&&i.isDragging?i.draggingModuleFinalArea:void 0;"form_conditional_modules"!==(null==o?void 0:o.area)&&(null!=e&&e.key&&o&&o.area!==t&&((0,h().E)({environment:n,position:{type:"area_relative",location:"end_moveable",..."views_main_tab_modules"===o.area?{area:o.area,viewId:o.viewsMainTabId}:{area:o.area}},moduleId:e.key,layoutStore:A,sessionId:x}),(0,y().z)({moduleId:e.key,layoutStore:A,environment:n})),ae())}),[k,t,ae,n,A,x]),le=(0,i.useCallback)(((i,{key:o,endPosition:s,startPosition:a})=>{if(K.isDraggingFromThisAreaToOtherArea)return;const r=c().PF.includes(o),l=B&&r?L.length+O.length:L.length,d="views_main_tab_modules"===t?{area:"views_main_tab_modules",viewId:e.viewsMainTabId}:{area:t};(0,h().E)({environment:n,layoutStore:A,position:{type:"absolute",index:l+s,...d},moduleId:o,sessionId:x}),(0,y().z)({moduleId:o,layoutStore:A,environment:n})}),[K.isDraggingFromThisAreaToOtherArea,L.length,O.length,t,e.viewsMainTabId,n,A,x,B]),de=(0,r().IS)((e=>({draggableList:{display:"flex",flexDirection:"column",gap:D,marginBottom:D},addButtonContainer:{paddingTop:"page_in_collection"===ie?8:0,marginBottom:"form"===ie?0:12,width:"100%"},dropzoneHalo:{background:g().to,height:g().NZ,marginTop:-g().NZ},hiddenModuleStyle:{display:"none"}})),[D,ie]),ce=(0,i.useCallback)((e=>{const n="existing_module"===(null==M?void 0:M.type)&&M.moduleId===e,i=n&&(ee||te||ne);return(0,P.jsx)(Y().n,{active:n,pageModuleId:e,isDragging:i,area:t,style:i&&K.isDraggingFromThisAreaToOtherArea?de.hiddenModuleStyle:void 0},e)}),[K.isDraggingFromThisAreaToOtherArea,M,de.hiddenModuleStyle,t,ee,te,ne]),ue=(0,i.useMemo)((()=>L.length?L.map((e=>ce(e.id))):null),[L,ce]),pe=(0,i.useMemo)((()=>F.length?F.map((e=>ce(e.id))):null),[F,ce]),ge=(0,i.useMemo)((()=>({enter:{opacity:0},animate:{opacity:1},exit:{opacity:0}})),[]),me=(0,i.useMemo)((()=>({buttonContainer:de.addButtonContainer})),[de.addButtonContainer]);if(!A)return null;let fe;return fe=!!j&&(!T||("views_main_tab_modules"===t||"page_details"===t)),(0,P.jsxs)(P.Fragment,{children:[ue,!B&&Boolean(q.length)?(0,P.jsx)(p().Ay,{forceDragKeyIndex:K.isDraggingFromThisAreaToOtherArea?q.length-1:void 0,className:U().hg,store:Z,keys:q,direction:"vertical",onDraggingKeyChanged:oe,onDrop:le,onDragCancel:ae,onDragEnd:re,onClick:se,style:de.draggableList,draggingStyle:$,draggingStyleForNonDraggedItems:$,renderKey:ce,disabled:!j,...T?{}:{hoverCursorStyleOverride:K.isDraggingAnyModuleList?"grabbing":void 0}}):void 0,B&&Boolean(W.length)?(0,P.jsx)(p().Ay,{forceDragKeyIndex:K.isDraggingFromThisAreaToOtherArea?W.length-1:void 0,className:U().hg,store:J,keys:W,direction:"vertical",onDraggingKeyChanged:oe,onDrop:le,onDragCancel:ae,onDragEnd:re,onClick:se,style:de.draggableList,draggingStyle:$,draggingStyleForNonDraggedItems:$,renderKey:ce,disabled:!j,...T?{}:{hoverCursorStyleOverride:K.isDraggingAnyModuleList?"grabbing":void 0}}):void 0,(0,P.jsx)(u().A,{visible:K.isDraggingIntoThisArea,initial:ge.enter,animate:ge.animate,exit:ge.exit,skip:!K.isDraggingAnyModuleList,className:"layout-content",ref:I,style:de.dropzoneHalo}),fe?(0,P.jsx)(V,{...e,styles:me}):void 0,"form"===ie&&j?(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(H,{}),(0,P.jsx)(R,{area:t})]}):void 0,B&&Boolean(Q.length)?(0,P.jsx)(p().Ay,{forceDragKeyIndex:K.isDraggingFromThisAreaToOtherArea?Q.length-1:void 0,className:U().hg,store:X,keys:Q,direction:"vertical",onDraggingKeyChanged:oe,onDrop:le,onDragCancel:ae,onDragEnd:re,onClick:se,style:de.draggableList,draggingStyle:$,draggingStyleForNonDraggedItems:$,renderKey:ce,disabled:!j,...T?{}:{hoverCursorStyleOverride:K.isDraggingAnyModuleList?"grabbing":void 0}}):void 0,pe]})}},766676:(e,t,n)=>{n.d(t,{C:()=>f});var i=n(296540),o=()=>n(484714),s=()=>n(56366),a=()=>n(543906),r=()=>n(297872),l=()=>n(676007),d=()=>n(404141),c=()=>n(300789),u=()=>n(51367),p=()=>n(131448),g=()=>n(736378),m=n(474848);function f(e){const{message:t}=e,n=(0,o().v3)(),f=(0,s().K8)((()=>!d().A.state.open&&!n.device.isMobile),[n]),h=(0,s().K8)((()=>f&&p().default.isVisible(t.key)),[t,f]);(0,a().A)((()=>{u().DL(n,{callout_key:t.key,placement_key:"Modal"})}),h);const v=(0,i.useCallback)((()=>{u().Sq(n,{callout_key:t.key,dismiss_type:"modal_dismiss_clicked",placement_key:"Modal"}),c().OX(n,t)}),[n,t]),y=(0,i.useCallback)(((e,i)=>()=>{u().Y5(n,{callout_key:t.key,click_type:e,placement_key:"Modal"}),null==i||i()}),[n,t]);let b;var S;e.primary&&(b={...e.primary,onClick:y("primary_cta",null===(S=e.primary)||void 0===S?void 0:S.onClick)});let x;var A;e.secondary&&(x={...e.secondary,onClick:y("secondary_cta",null===(A=e.secondary)||void 0===A?void 0:A.onClick)});let M;var w;e.link&&(M={...e.link,onClick:y("learn_more",null===(w=e.link)||void 0===w?void 0:w.onClick)});return h?(0,m.jsx)(l().a,{open:!0,preventHideChildrenWhileOpening:!0,onDismiss:v,render:()=>(0,m.jsx)(r().A,{capture:!0,allowEsc:!0,render:()=>(0,m.jsx)(g().T,{...e,onDismiss:v,primary:b,secondary:x,link:M})})}):null}},773706:(e,t,n)=>{n.d(t,{T:()=>o});const i="ShowMentionInvite";function o(e){return`${i}-${e}`}},781016:(e,t,n)=>{n.r(t),n.d(t,{clockFillIcon:()=>o,iconDefinition:()=>i});n(296540);const i={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.26 15.25",svg:(0,n(474848).jsx)("path",{d:"M2.375 10a7.625 7.625 0 1 1 15.25 0 7.625 7.625 0 0 1-15.25 0m8.25-4.275a.625.625 0 1 0-1.25 0v3.65H6.4a.625.625 0 1 0 0 1.25H10c.345 0 .625-.28.625-.625z"})},o=(0,n(340498).wt)("clockFill",i)},787766:(e,t,n)=>{n.d(t,{Hc:()=>d,Io:()=>u,Mg:()=>g,S3:()=>r,X3:()=>l,dE:()=>p,iO:()=>c,vC:()=>m,vG:()=>a});n(944114),n(898992),n(803949);var i=()=>n(401497),o=()=>n(100622),s=()=>n(284371);function a(e){const{focus:t}=e;return(0,i().IS)((e=>({searchBar:{padding:16},inputStyle:{minWidth:60,width:"auto",borderStartStartRadius:4,borderStartEndRadius:4,fontSize:14,fontWeight:s().Wy.regular},inputOuterStyle:{padding:6,borderRadius:6,height:20,alignItems:"center",minHeight:32,background:e.palette.gray[30],...t&&{background:"none"}}})),[t])}function r(){return(0,i().IS)((e=>({selectAllSectionStyle:{display:"flex",flexDirection:"column",gap:2,paddingTop:8,paddingInlineEnd:0,paddingBottom:16,paddingInlineStart:0},sectionMenuItem:{paddingTop:12,paddingInlineEnd:0,paddingBottom:0,paddingInlineStart:2,display:"flex",flexDirection:"column",gap:2},dividerStyle:{margin:"0px 16px"},dividerInnerStyle:{borderBottom:`1px solid ${e.border.secondary}`},selectAllStyle:{display:"flex",fontSize:14,color:e.text.primary},totalCountsStyle:{paddingInlineStart:3,fontSize:14,color:e.text.tertiary}})),[])}function l(){return(0,i().IS)((e=>({footerStyle:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:60,paddingTop:12,paddingInlineEnd:16,paddingBottom:16,paddingInlineStart:16,borderTop:`1px solid ${e.border.secondary}`}})),[])}function d(){return(0,i().IS)((e=>({labelContainer:{display:"flex",alignItems:"center",color:o().Tj.uiLightBlack,size:14,gap:6},importListButton:{height:28,borderRadius:4,border:void 0,width:"100%"},importListButtonContainer:{padding:"0 6px",alignItems:"center"}})),[])}function c(){return(0,i().IS)((e=>({topContainer:{display:"flex",alignItems:"center",width:"100%",height:40,padding:"0 16px",borderBottom:`1px solid ${e.border.secondary}`},sendInviteLabel:{color:e.text.primary,fontSize:14,fontWeight:s().Wy.medium,textAlign:"start",verticalAlign:"top"}})),[])}function u(e,t){return(0,i().IS)((n=>({buttonContainer:{padding:"0 8px",...t},button:{height:32,borderRadius:4,border:`1px solid ${n.border.primary}`,...e}})),[e,t])}function p(e){const{filteredImportedContacts:t,inviteTargetsStore:n}=e,i=n.state.inviteTargets.length;return 0!==i&&i===t.length}function g(e){const{filteredImportedContacts:t}=e,n={};return t.forEach(((e,t)=>{const i=e.value.email[0].toUpperCase(),o=/^[A-Za-z]$/.test(i)?i:"#";n[o]||(n[o]=[]),n[o].push(e)})),n}function m(e){const{canEditPermission:t,isMobile:n,isEnterprise:i}=e;return!(n||i||!t)}},788060:(e,t,n)=>{n.d(t,{$:()=>o,J:()=>i});function i(e){return void 0===e.value&&"string"!==e.rootType}const o={type:"config",config:{},isAvailable:({experimentService:e,userId:t,spaceId:i})=>e.checkGate({gateName:"workflows_config_module_available",actor:t?{table:"notion_user",id:t}:n(715256).S3,customIDs:{spaceId:i}}),latestVersion:"1.0.0",triggers:{},effects:{},stateDuplicator:({original:e})=>e,getModuleConfigurationStatus:(e,t)=>{if(!t)return"invalid";const{modules:o}=t;if(!o)return"ready";for(const s of o){const e=(0,n(342967).v)(t,s.id);for(const t of Object.values(e))if(i(t))return"invalid"}return"ready"},getDescription:e=>e.formatMessage({id:"workflows.modules.config.description",defaultMessage:"Access configuration values"}),getName:e=>e.formatMessage({id:"workflows.modules.config.name",defaultMessage:"Configuration variables"}),getMessageIfNotValid:void 0,getModuleConfigSection:()=>"connections",getIcon:()=>n(735790).M}},794831:(e,t,n)=>{n.r(t),n.d(t,{GenerateSocialMediaPreviewImageWrapper:()=>u});var i=n(296540),o=()=>n(242422),s=()=>n(484714),a=()=>n(56366),r=()=>n(201980),l=()=>n(496603),d=()=>n(6027),c=()=>n(693202);function u(e){const{store:t}=e;return function(e){const t=(0,s().v3)(),[n,u]=(0,i.useState)("uninitialized"),[p,g,m,f,h]=(0,a().K8)((()=>{var n,i;return e.pathIsDead()||"on"!==o().default.getEligibleGroup({experimentId:"dynamic_social_preview_image",defaultGroup:"unassigned"})||e.inMemoryRecordCache.recordHasOverride({pointer:e.pointer,userId:t.currentUser.id})?[!1]:[e.isReady(),r().q4_(e.getTitleValue()),null===(n=e.getIcon())||void 0===n?void 0:n.icon,null===(i=e.getCover())||void 0===i?void 0:i.cover,e.getFormat().page_font]}),[t.currentUser.id,e]);(0,i.useEffect)((()=>{"storeReady"===n?u("generateImage"):p&&u("storeReady")}),[p,g,m,f,h]);const v=(0,i.useMemo)((()=>(0,l().sg)((()=>{u("storeReady"),d().F({environment:t,store:e})}),5e3)),[t,e]);(0,a().K8)((()=>{"generateImage"===n&&(c().default.state,v())}),[n,v])}(t),null}},803557:(e,t,n)=>{n.d(t,{KG:()=>a,PX:()=>r,Xx:()=>s});var i=()=>n(645873);const o={SlackImportContactsButton:new(i().O2)("SlackImportContactsButton",(()=>n.e(55901).then(n.bind(n,659126)))),GoogleImportContactsButton:new(i().O2)("GoogleImportContactsButton",(()=>n.e(37398).then(n.bind(n,97509)))),MicrosoftImportContactsButton:new(i().O2)("MicrosoftImportContactsButton",(()=>n.e(93629).then(n.bind(n,447078))))},s=(0,i()._h)(o.SlackImportContactsButton,(e=>e.default)),a=(0,i()._h)(o.GoogleImportContactsButton,(e=>e.GoogleImportContactsButton)),r=(0,i()._h)(o.MicrosoftImportContactsButton,(e=>e.MicrosoftImportContactsButton))},804643:(e,t,n)=>{n.d(t,{dl:()=>w,LV:()=>C});n(18107),n(944114),n(967357),n(898992),n(672577),n(296540);var i=()=>n(584262),o=()=>n(818044),s=()=>n(236262),a=()=>n(69708),r=()=>n(857783),l=()=>n(231297),d=()=>n(89924);var c=()=>n(49533);var u=()=>n(364859),p=()=>n(598101),g=()=>n(765957);n(823215);n(581454);async function m(e){const{blocks:t,transaction:i,environment:o}=e,{sidebarSpaceViewStore:s}=g().default.state;if(s)for(const a of t)n(722101).TF({parentStore:s.getSharedPagesStore(),childToRemoveStore:a,transaction:i});(0,n(961606).V)({environment:o,blocks:t}),await Promise.all(t.map((e=>n(559506).callApi({eventName:"leaveBlock",environment:o,data:{block:{id:e.id,spaceId:(0,n(161479).e)(e.pointer.spaceId)}}}))))}n(354520);function f({blockId:e,transaction:t,spaceViewStore:i}){const o=((null==i?void 0:i.getPublicShareLinkPages())??[]).filter((t=>t!==e)),s=null==i?void 0:i.getBookmarkedPageIds().filter((t=>t!==e));n(384944).zv({store:i,data:{public_share_link_pages:o,bookmarked_pages:s},transaction:t})}var h=()=>n(21727),v=()=>n(599364),y=()=>n(774411),b=()=>n(10521),S=()=>n(498002),x=n(474848);const A=(0,a().YK)({unpinName:{id:"action.unpin.name",defaultMessage:"Remove from sidebar"},leaveName:{id:"action.leave.name",defaultMessage:"Leave"},duplicateToName:{id:"action.duplicateTo.name",defaultMessage:"Duplicate to"},editFormName:{id:"action.editForm.name",defaultMessage:"Edit form"}}),M=(0,b().Ls)({key:"edit form",displayName:A.editFormName,analyticsName:A.editFormName.defaultMessage,svg:n(173019).r,validators:[n(59411).k,function(e){var t;const{environment:n}=e,i=e.blocks.at(0);return!(!i||!i.isFormBlock())&&(n.currentUser.id===i.getCreatedById()&&Boolean(null===(t=i.getFormBlockParentBlockStore())||void 0===t?void 0:t.canEditCollection()))}],closeParentMenu:!0,action:({blocks:e,environment:t})=>{const n=e[0],o=n.getFormBlockParentBlockStore();var s;o&&r().uK({environment:t,store:o,collectionViewId:null===(s=n.getParentStore())||void 0===s?void 0:s.id,pageVisitSource:i().y8.FormInternalPage})}}),w=(0,b().Ls)({key:"delete block without shortcuts",displayName:b().AY.moveToTrashName,analyticsName:b().AY.moveToTrashName.defaultMessage,svg:s().trashIcon,isRed:!0,validators:[(0,n(422155).or)([c()._,function(e){const t=e.blocks.at(0);return Boolean((null==t?void 0:t.isType("copy_indicator"))&&Date.now()-t.getCreatedTime()>n(720665).nD)},n(416433).I]),n(929409).S,(0,p().A)(n(776594).x),(0,p().A)((0,n(419286).X)(n(700500).xd.externalObjectInstancePage)),(0,p().A)(n(467294).P),n(73330).z,(0,p().A)(n(339425).o),(0,p().A)(n(411960).P)],closeParentMenu:!0,track:{actionName:"move_to_trash"},render:(e,t,i)=>{const o=(0,n(609256).d)(t.blocks.at(0));return(0,x.jsx)(n(859428).A,{renderTooltip:()=>(0,x.jsx)("div",{style:{maxWidth:400,whiteSpace:"pre-wrap"},children:(0,x.jsx)(a().sA,{...b().AY.cannotDeleteBlockTooltip})}),render:()=>(0,x.jsx)(n(575143).A,{...e,title:(0,x.jsx)(a().sA,{...b().AY.moveToTrashName}),svg:s().trashIcon,isRed:!0,disabled:o,disabledFeedback:o,tooltipText:o?(0,x.jsx)(a().sA,{...b().AY.cannotDeleteBlockTooltip}):void 0})})},action:async(e,{blocks:t,environment:i},o)=>{await n(391214).Af({environment:i,blocks:t,shouldCheckSuggestEdit:!1,callback:e})}}),j=(0,b().Ls)({key:"leave shared page",displayName:A.leaveName,analyticsName:A.leaveName.defaultMessage,svg:o().k,validators:[n(467276).p,function(e){const{id:t}=e.environment.currentUser;return!!t&&e.blocks.every((e=>{const i=e.getPermissionItems();return(0,n(433847).lI)(i,t)}))},(0,p().A)(u().q)],closeParentMenu:!0,action:({blocks:e,environment:t})=>{l().createAndCommit({userAction:"actionRegistry.leaveSharedPage",environment:t,canUndo:!0,perform:n=>{m({environment:t,blocks:e,transaction:n})}})}}),k=(0,b().Ls)({key:"leave public share link shared page",displayName:A.leaveName,analyticsName:A.leaveName.defaultMessage,svg:o().k,validators:[u().q],closeParentMenu:!0,action:({blocks:e,environment:t})=>{var o,s,a;const{sidebarSpaceViewStore:d,currentUserSettingsStore:c,sidebarSpaceStore:u,mainEditorCurrentBlockStore:p}=g().default.state;if(!d||!c||!u)return;const m=null===(o=d.getSpaceStore())||void 0===o?void 0:o.id;if(!m)return;const h=n(90873).A.getSharedPagesState({spaceId:m,userId:c.id}),v=d.getPublicShareLinkPageStores().find((t=>t.id!==e[0].id)),y=null!=h&&null!==(s=h.currentPageIds)&&void 0!==s&&s[0]?n(148832).B.createChildStore(u.getPagesStore(),{table:n(179034).ev,id:null==h||null===(a=h.currentPageIds)||void 0===a?void 0:a[0],spaceId:u.id}):void 0;l().createAndCommit({userAction:"actionRegistry.leavePublicShareLinkSharedPage",environment:t,canUndo:!0,perform:t=>{f({blockId:e[0].id,transaction:t,spaceViewStore:d})}});(null==p?void 0:p.id)===e[0].id&&(v?r().uK({environment:t,store:v,pageVisitSource:i().y8.LeaveOrRemove}):y?r().uK({environment:t,store:y,pageVisitSource:i().y8.LeaveOrRemove}):(0,n(718387).k)(t))}}),I=(0,n(12956).u)({key:"duplicate to workspace",displayName:A.duplicateToName,analyticsName:A.duplicateToName.defaultMessage,svg:n(212439).V,validators:[c()._,n(333344).P,n(77295).K,(0,p().A)(n(116057).M),function(){const{sidebarSpaceStore:e}=g().default.state;return!!e&&!e.getDisableMoveToSpace()}],subActions:({blocks:e,environment:t})=>{const{currentUserRootStore:o}=g().default.state;if(!o)return[];const s=(0,n(135337).j)(o),a=[];for(const l of s){const o=l.getSpaceStore();if(o){const s=(0,n(665381).G)(t,o),d=(0,n(625247).c)(t,o);a.push({key:l.id,displayName:s||"",analyticsName:"Duplicate to workspace",searchName:s||"",closeParentMenu:!0,action:async()=>{await(0,n(213477).hh)({environment:t,sourceBlocks:e,destination:{type:"space",parent:(0,n(96689).n2)(o.id)},from:"fork_page",options:{addCopyName:!1,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0},skipUserFacingMessages:!1,useDuplicateSubtreeFlow:!0,listener:e=>{"page_navigable"===e.type&&r().uK({environment:t,store:e.navigableBlockStore,visitType:n(211716).ig.Default,pageVisitSource:i().y8.Duplicate})}})},render:(e,{environment:t})=>(0,x.jsx)(n(760217).A,{title:s,icon:(0,x.jsx)(n(187820).B6,{icon:d,isEmptyPage:!1,title:s,size:n(726637).A.isMobile?24:20,disabled:!0,iconRecordCategory:"workspace"}),...e})})}}return[(0,b().gy)({key:"duplicate-to",render:e=>(0,x.jsx)(d().A,{...e}),actions:a})]}}),C=[n(354406).LQ,{key:"outliner organization actions",render:e=>(0,x.jsx)(d().A,{...e}),actions:[h()._J,h().wy,j,k]},{key:"outliner available offline action",render:e=>(0,x.jsx)(d().A,{...e}),actions:[n(737350).Z]},{key:"outliner primary actions",render:e=>(0,x.jsx)(d().A,{...e}),actions:[v().k,v().o,h().O5,h().tA,y().As,y().nK,y().J8,y().lb,I,M,n(22913).U,n(37689).tw,w]},{key:"turn page into",render:e=>(0,x.jsx)(d().A,{...e}),actions:[S().zk,S().wm,S().Js]},{key:"outliner navigation",render:e=>(0,x.jsx)(d().A,{...e}),actions:n(426928).YO}]},807926:(e,t,n)=>{n.d(t,{A:()=>o});class i extends(()=>n(757695))().Store{getInitialState(){return{open:!1}}}const o=new i},808565:(e,t,n)=>{function i({environment:{device:e}}){return e.isIOS}n.d(t,{u:()=>i})},809125:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});n(296540);var i=()=>n(56366),o=()=>n(30537),s=()=>n(765957),a=()=>n(796249),r=()=>n(712505),l=()=>n(757754),d=n(474848);const c=function(){const e=(0,n(484714).v3)(),{device:t}=e,s=(0,i().O$)(a().A);return(0,d.jsx)(n(417392).Ay,{popupType:t.isMobile?o().n.BottomSheet:o().n.Popup,bottomSheetInitialState:"half",alignmentToOrigin:"center",open:s.isOpen,render:()=>(0,d.jsx)(u,{useBottomSheetStyling:t.isMobile}),originRect:s.isOpen?s.rect:void 0,onDismiss:()=>n(334261).VN(),trapFocus:!0})};function u({useBottomSheetStyling:e}){const t=(0,i().K8)((()=>a().A.state.isOpen),[]),n=(0,i().K8)((()=>r().default.state.open&&r().default.state.targetStore||s().default.state.mainEditorCurrentBlockStore),[]);return t&&n?(0,d.jsx)(l().AR,{blockStore:n,useBottomSheetStyling:e}):null}},817148:(e,t,n)=>{n.d(t,{A:()=>v});var i=n(296540),o=()=>n(56366),s=()=>n(433847),a=()=>n(69708),r=()=>n(901389),l=()=>n(579627),d=()=>n(247123),c=()=>n(574357);n(898992),n(823215);function u(e){return e.blocks.every((e=>e.isRestricted()))}var p=()=>n(598101),g=()=>n(330582),m=()=>n(569028),f=()=>n(125565),h=n(474848);const v=function({store:e}){const t=(0,n(401497).DP)(),v=(0,n(484714).v3)(),y=(0,i.useMemo)((()=>({environment:v,blocks:[e],publicEditMode:void 0})),[v,e]),b=(0,o().K8)((()=>(0,c().U)([u,(0,p().A)(n(158658).p)])(y)),[y]),S=(0,o().K8)((()=>(0,c().U)([n(267)._,(0,p().A)(n(77295).K)])(y)),[y]);if(b){const{device:i}=v;return(0,h.jsx)("div",{style:{backgroundColor:t.sidebarSecondaryBackground,boxShadow:`0 -1px 0 ${t.regularDividerColor}`,marginTop:i.isMobile?28:1},children:(0,h.jsxs)(n(718827).Ay,{disabled:!S,style:{padding:12},onClick:()=>async function(e,t){if(!e.isDefined())return;const n=e.getPermissionItems(),i=(0,g().K)(e),o=i?s().wD((0,m().E)(i)):[],c=s().Cd(e.getModel(),n,o),u={type:"restore",permissionChanges:c},{accept:p}=await r().Gh({message:(0,d().r6)(u),acceptLabel:(0,d().QU)(u),cancelLabel:(0,h.jsx)(a().sA,{id:"restrictedPermissionConfirmationModal.actionButton.close",defaultMessage:"Close"}),description:(0,h.jsx)(d().f2,{openState:u})});p&&l().YD({environment:t,store:e})}(e,v),children:[(0,h.jsx)(f().A,{isMultiline:!0,isSmall:!0,children:(0,h.jsx)(a().sA,{id:"blockMenuRestrictedMessage.label",defaultMessage:"You donâ€™t have permission to edit this block because it is restricted."})}),S?(0,h.jsx)(f().A,{style:{marginTop:6,fontWeight:n(284371).Wy.semibold},children:(0,h.jsx)(a().sA,{id:"blockMenuRestrictedMessage.adminRestoreAction.label",defaultMessage:"Restore permissions"})}):void 0]})})}return null}},818044:(e,t,n)=>{n.d(t,{k:()=>o});n(296540);var i=n(474848);const o=(0,n(340498).wt)("logout",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M17,24l9-9l-9-9l-1.406,1.406L22.188,14H8v2h14.188l-6.594,6.594L17,24z M6,4h16V2H4v26h18v-2H6V4z"})})},818541:(e,t,n)=>{n.d(t,{V:()=>o});n(296540);const i={viewBox:"0 0 20 20",fittedViewBox:"3.87 2.62 12.26 14.76",svg:(0,n(474848).jsx)("path",{d:"M3.875 3.25c0-.345.28-.625.625-.625h4c.345 0 .625.28.625.625v4c0 .345-.28.625-.625.625H7.125v.596c0 .179.126.333.302.368l5.39 1.075c.76.152 1.308.819 1.308 1.594v.617H15.5c.345 0 .625.28.625.625v4c0 .345-.28.625-.625.625h-4a.625.625 0 0 1-.625-.625v-4c0-.345.28-.625.625-.625h1.375v-.617a.375.375 0 0 0-.302-.368l-5.39-1.076a1.625 1.625 0 0 1-1.308-1.593v-.596H4.5a.625.625 0 0 1-.625-.625zm4 3.375v-2.75h-2.75v2.75zm4.25 6.75v2.75h2.75v-2.75z"})},o=(0,n(340498).wt)("connections",i)},819493:(e,t,n)=>{n.d(t,{$:()=>A,b:()=>M});n(898992),n(908872),n(296540);var i=()=>n(59226),o=()=>n(662303),s=()=>n(484714),a=()=>n(56366),r=()=>n(401497),l=()=>n(764880),d=()=>n(869190),c=()=>n(69708),u=()=>n(921855),p=()=>n(972435),g=()=>n(311337),m=()=>n(448291),f=()=>n(706965),h=()=>n(678553),v=()=>n(89924),y=()=>n(859428),b=()=>n(125565),S=()=>n(715011),x=n(474848);function A({isPageMoreButton:e,hideTopBorder:t,store:n,wordCountStores:i,showWordCount:o}){const d=(0,a().K8)((()=>M(n)),[n]),{device:u}=(0,s().v3)(),m=(0,a().K8)((()=>u.isPhone),[u]),A=p().A.getIntl(),j=(0,s().v3)(),k=(0,r().IS)((()=>({menuItem:{paddingTop:m?8:t?0:6,paddingBottom:m?8:16}})),[t,m]);return(0,a().K8)((()=>(0,g().y)(j)),[j])||d&&!d.canAccess?null:(0,x.jsx)(v().A,{topBorder:!e&&!t,style:{paddingTop:e?0:8,paddingBottom:e?0:8},children:(0,x.jsx)(h().Ay,{style:d?void 0:k.menuItem,shouldWrapTitle:!0,title:d?(0,x.jsx)(y().A,{placement:"right",render:e=>(0,x.jsxs)("div",{...e,children:[o?(0,x.jsx)(b().A,{isSmall:!0,isSecondaryColor:!0,isMobile:u.isPhone,isMultiline:!0,style:{marginBottom:4,marginTop:8},children:(0,x.jsx)(c().sA,{id:"pageMoreButton.wordCount.caption",defaultMessage:"Word count: {count}",values:{count:(0,x.jsx)(S().A,{store:n})}})}):void 0,i?(0,x.jsx)(w,{stores:i}):void 0,(0,x.jsx)(b().A,{isSmall:!0,isSecondaryColor:!0,isMobile:u.isPhone,isMultiline:!0,style:{marginBottom:4},children:(0,x.jsx)(c().sA,{id:"blockAuthorInfo.label",defaultMessage:"Last edited by {author}",values:{author:d.lastEditedBy.asActor?(0,l().lR)(A,d.lastEditedBy):void 0}})}),(0,x.jsx)(b().A,{isSmall:!0,isSecondaryColor:!0,isMobile:u.isPhone,style:{marginBottom:o?8:0},children:d.lastEditedTime})]}),renderTooltip:()=>(0,x.jsx)(f().A,{store:n,compactFormat:!0})}):void 0,loading:!d})})}function M(e){const t=e.getCreatedByPointer(),n=e.getCreatedTime(),i=e.getLastEditedByPointer(),s=e.getLastEditedTime(),a=p().A.getIntl();if(!e.canRead())return{canAccess:!1};if(t&&n&&s&&i){const r=(0,m().vt)({parentStore:e,pointer:t}),l=(0,d().jE)(n,o().locale,a),c=(0,m().vt)({parentStore:e,pointer:i}),u=(0,d().jE)(s,o().locale,a);if(!c)return;return{canAccess:!0,createdBy:r,createdTime:l,lastEditedBy:c,lastEditedTime:u}}}function w(e){const{stores:t}=e,n=(0,i().X)("selectable_word_count"),o=(0,a().K8)((()=>n?j(t):0),[n,t]);return n?(0,x.jsx)(b().A,{isSmall:!0,isSecondaryColor:!0,style:{marginBottom:4},children:(0,x.jsx)(c().sA,{id:"blockMetadataMenuItem.wordCount",defaultMessage:"{count, plural, one {# word} other {# words}}",values:{count:o}})}):null}function j(e){return e.reduce(((e,t)=>{const n=(0,u().r4)(t.getTitleValue(),t);return e+(0,u().sQ)(n)+j(t.getContentStores())}),0)}},820423:(e,t,n)=>{n.d(t,{N:()=>o});class i extends(()=>n(757695))().Store{getInitialState(){return{open:!1}}}const o=new i;(0,n(852832).exposeDebugValue)("researchModeModalStore",o)},822295:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>i,presentIcon:()=>o});n(296540);const i={viewBox:"0 0 20 20",fittedViewBox:"2.72 1.77 14.55 15.51",svg:(0,n(474848).jsx)("path",{d:"M4.625 4.535a2.765 2.765 0 0 1 3.307-2.711l.07.014a3.26 3.26 0 0 1 2.01 1.297c.481-.66 1.2-1.14 2.044-1.309 1.706-.34 3.319.96 3.319 2.71 0 .558-.166 1.079-.451 1.514h.776c.87 0 1.575.705 1.575 1.575v1.9c0 .613-.35 1.144-.86 1.404V15.7c0 .87-.706 1.575-1.576 1.575H5.161c-.87 0-1.575-.705-1.575-1.575v-4.77a1.58 1.58 0 0 1-.861-1.405v-1.9c0-.87.705-1.575 1.575-1.575h.777a2.75 2.75 0 0 1-.452-1.515m6 2.765v2.55H15.7c.18 0 .325-.145.325-.325v-1.9A.325.325 0 0 0 15.7 7.3zm-1.25 0H4.3a.325.325 0 0 0-.325.325v1.9c0 .18.145.325.325.325h5.075zm0-1.25V5.038c0-.96-.677-1.786-1.618-1.974l-.07-.014a1.515 1.515 0 1 0-.297 3zm3.25 0c.83-.008 1.5-.683 1.5-1.515 0-.95-.882-1.671-1.824-1.483a2.084 2.084 0 0 0-1.676 2.035v.963zm-2 5.05v4.925h4.214c.18 0 .325-.145.325-.325v-4.6zm-1.25 0h-4.54v4.6c0 .18.146.325.326.325h4.214z"})},o=(0,n(340498).wt)("present",i)},825899:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Ee});n(296540);var i=()=>n(484714),o=()=>n(56366),s=()=>n(998531),a=()=>n(30537),r=()=>n(854150),l=()=>n(69708),d=()=>n(496603),c=()=>n(534177),u=()=>n(21727),p=()=>n(89924),g=n(474848);const m=[{key:"block in comment menu primary",render:e=>(0,g.jsx)(p().A,{...e}),actions:[n(410767).z,u().b2,u().qI]}];var f=()=>n(804643),h=()=>n(599364);const v=[{key:"page mention context menu primary",render:e=>(0,g.jsx)(p().A,{...e}),actions:[...n(426928).YO,h().o,h().k]}];var y=()=>n(741496),b=()=>n(901265),S=()=>n(635462),x=()=>n(476492),A=()=>n(722872),M=()=>n(232930),w=()=>n(494043),j=()=>n(857437),k=()=>n(691298),I=()=>n(696746),C=(n(581454),()=>n(933152)),T=()=>n(764781),_=()=>n(236262),P=()=>n(637433),B=()=>n(100622),D=()=>n(12956),R=()=>n(10521),E=()=>n(896628),L=()=>n(231297),O=()=>n(491073),N=()=>n(575143),F=()=>n(158658),U=()=>n(404715),z=()=>n(709219);function K(e){const t=z().A.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:i}=t,o=0===i.start.row&&i.end.row===(0,U().yv)(n)-1,s=0<=i.start.col&&i.start.col<=i.end.col&&i.start.col<=(0,U().MW)(n)-1;return"column"===i.type&&s&&o}function V(e){const t=z().A.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:i}=t,o=0===i.start.col&&i.end.col===U().MW(n)-1,s=0<=i.start.row&&i.start.row<=i.end.row&&i.start.row<=U().yv(n)-1;return"row"===i.type&&s&&o}n(18107),n(967357);function q(e){const t=z().A.state;return t.isActive&&1===e.blocks.length&&e.blocks.at(0)===t.simpleTableStore}var W=()=>n(964179),G=()=>n(375308),H=()=>n(598101),Y=()=>n(27178),$=()=>n(972435),Q=()=>n(919878),Z=()=>n(875827),J=()=>n(934260),X=()=>n(857048);const ee=(0,l().YK)({simpleTableHeaderColumn:{id:"action.rowHeader.title",defaultMessage:"Header column"},simpleTableHeaderRow:{id:"action.columnHeader.title",defaultMessage:"Header row"},simpleTableInsertColumnLeft:{id:"action.insertColumnLeft.title",defaultMessage:"Insert left"},simpleTableInsertColumnRight:{id:"action.insertColumnRight.title",defaultMessage:"Insert right"},simpleTableClearContents:{id:"action.clearContents.title",defaultMessage:"Clear contents"},simpleTableInsertRowAbove:{id:"action.insertRowAbove.title",defaultMessage:"Insert above"},simpleTableInsertRowBelow:{id:"action.insertRowBelow.title",defaultMessage:"Insert below"},textColorSection:{id:"action.section.textColor",defaultMessage:"Text color"},backgroundColorSection:{id:"action.section.backgroundColor",defaultMessage:"Background color"}}),te=(0,R().fi)({key:"simple table header column",displayName:ee.simpleTableHeaderColumn,label:$().A.formatMessage(ee.simpleTableHeaderColumn),getSvgIcon:()=>n(696575).X,validators:[F().p,(0,H().A)(W().w),q,function(e){const t=z().A.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:i}=t,o=0===i.start.row&&i.end.row===(0,U().yv)(n)-1,s=0===i.start.col&&0===i.end.col;return"column"===i.type&&s&&o}],isChecked:e=>Boolean(e.getFormat().table_block_row_header),action:(e,t,n)=>E().zA({stores:[t],update:{table_block_row_header:!t.getFormat().table_block_row_header},transaction:n})}),ne=(0,R().fi)({key:"simple table header row",displayName:ee.simpleTableHeaderRow,label:$().A.formatMessage(ee.simpleTableHeaderRow),getSvgIcon:()=>n(464291).p,validators:[F().p,(0,H().A)(W().w),function(e){const t=z().A.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:i}=t,o=0===i.start.col&&i.end.col===(0,U().MW)(n)-1,s=0===i.start.row&&0===i.end.row;return"row"===i.type&&s&&o}],isChecked:e=>{const t=e.getParentBlockStore();return!(null==t||!t.isType("table"))&&Boolean(t.getFormat().table_block_column_header)},action:(e,t,n)=>{const i=t.getParentBlockStore();null!=i&&i.isType("table")&&E().zA({stores:[i],update:{table_block_column_header:!i.getFormat().table_block_column_header},transaction:n})}}),ie=(0,R().Ls)({key:"insert column left",displayName:ee.simpleTableInsertColumnLeft,analyticsName:ee.simpleTableInsertColumnLeft.defaultMessage,svg:n(526278).w,validators:[F().p,(0,H().A)(G().v),q,K],closeParentMenu:!0,action:({environment:e})=>{L().createAndCommit({userAction:"actionRegistry.insertColumnLeft",environment:e,canUndo:!0,perform:t=>{Q().T4({environment:e,transaction:t})}})}}),oe=(0,R().Ls)({key:"insert column right",displayName:ee.simpleTableInsertColumnRight,analyticsName:ee.simpleTableInsertColumnRight.defaultMessage,svg:n(940563).arrowStraightRightIcon,validators:[F().p,(0,H().A)(G().v),q,K],closeParentMenu:!0,action:({environment:e})=>{L().createAndCommit({userAction:"actionRegistry.insertColumnRight",environment:e,canUndo:!0,perform:t=>{Q().sf({environment:e,transaction:t})}})}}),se=(0,R().Fw)({key:"duplicate columns",displayName:R().AY.duplicateName,analyticsName:R().AY.duplicateName.defaultMessage,svg:T().V,validators:[F().p,(0,H().A)(G().v),q,K],shortcuts:["duplicate"],closeParentMenu:!0,action:({environment:e})=>{L().createAndCommit({userAction:"actionRegistry.duplicateColumns",environment:e,canUndo:!0,perform:e=>{Q().V0({transaction:e})}})}}),ae=(0,R().Fw)({key:"delete columns",displayName:R().AY.deleteName,analyticsName:R().AY.deleteName.defaultMessage,svg:_().trashIcon,validators:[F().p,(0,H().A)(G().v),q,function(e){const t=z().A.state;if(!t.isActive)return!1;const{simpleTableStore:n}=t;return(0,U().MW)(n)>1},K],shortcuts:["delete","backspace"],closeParentMenu:!0,render:e=>(0,g.jsx)(N().A,{...e,isRed:!0,svg:_().trashIcon,title:(0,g.jsx)(l().sA,{...R().AY.deleteName})}),action:({environment:e})=>{L().createAndCommit({userAction:"actionRegistry.deleteColumns",environment:e,canUndo:!0,perform:t=>{J().LL({environment:e,transaction:t})}})}}),re=(0,R().Ls)({key:"clear column contents",displayName:ee.simpleTableClearContents,analyticsName:ee.simpleTableClearContents.defaultMessage,svg:P().xMarkCircleFillIcon,validators:[F().p,(0,H().A)(G().v),q,K],closeParentMenu:!0,action:({environment:e})=>{L().createAndCommit({userAction:"actionRegistry.clearColumnContents",environment:e,canUndo:!0,perform:t=>{Z()._({environment:e,transaction:t})}}),X().wr()}}),le=(0,R().Ls)({key:"insert row above",displayName:ee.simpleTableInsertRowAbove,analyticsName:ee.simpleTableInsertRowAbove.defaultMessage,svg:n(112282).arrowStraightUpIcon,validators:[F().p,(0,H().A)(G().v),V],closeParentMenu:!0,action:({environment:e})=>{L().createAndCommit({userAction:"actionRegistry.insertRowAbove",environment:e,canUndo:!0,perform:t=>{Q().pW({environment:e,transaction:t})}})}}),de=(0,R().Ls)({key:"insert row below",displayName:ee.simpleTableInsertRowBelow,analyticsName:ee.simpleTableInsertRowBelow.defaultMessage,svg:n(655923).arrowStraightDownIcon,validators:[F().p,(0,H().A)(G().v),V],closeParentMenu:!0,action:({environment:e})=>{L().createAndCommit({userAction:"actionRegistry.insertRowBelow",environment:e,canUndo:!0,perform:t=>{Q().pc({environment:e,transaction:t})}})}}),ce=(0,R().Fw)({key:"duplicate rows",displayName:R().AY.duplicateName,analyticsName:R().AY.duplicateName.defaultMessage,svg:T().V,validators:[F().p,(0,H().A)(G().v),V],shortcuts:["duplicate"],closeParentMenu:!0,action:({environment:e})=>{Q().n2({environment:e})}}),ue=(0,R().Fw)({key:"delete rows",displayName:R().AY.deleteName,analyticsName:R().AY.deleteName.defaultMessage,svg:_().trashIcon,validators:[F().p,(0,H().A)(G().v),function(e){const t=z().A.state;if(!t.isActive)return!1;const{simpleTableStore:n}=t;return(0,U().yv)(n)>1},V],shortcuts:["delete","backspace"],closeParentMenu:!0,render:e=>(0,g.jsx)(N().A,{...e,isRed:!0,svg:_().trashIcon,title:(0,g.jsx)(l().sA,{...R().AY.deleteName})}),action:({environment:e})=>{L().createAndCommit({userAction:"actionRegistry.deleteRows",environment:e,canUndo:!0,perform:t=>{J().pf({environment:e,transaction:t})}})}}),pe=(0,R().Ls)({key:"clear row contents",displayName:ee.simpleTableClearContents,analyticsName:ee.simpleTableClearContents.defaultMessage,svg:P().xMarkCircleFillIcon,validators:[F().p,(0,H().A)(G().v),V],closeParentMenu:!0,action:({environment:e})=>{L().createAndCommit({userAction:"actionRegistry.clearRowContents",environment:e,canUndo:!0,perform:t=>{Z()._({environment:e,transaction:t})}}),X().wr()}}),ge=[F().p,(0,H().A)(G().v),q,K],me=[F().p,(0,H().A)(G().v),V],fe=[F().p,(0,H().A)(G().v),q,function(e){const t=z().A.state;if(!t.isActive)return!1;const{selection:n}=t;return"cell"===n.type}],he=(0,R().Ls)({key:"clear cell contents",displayName:ee.simpleTableClearContents,analyticsName:ee.simpleTableClearContents.defaultMessage,svg:n(378409).xMarkCircleIcon,validators:fe,closeParentMenu:!0,action:({environment:e})=>{L().createAndCommit({userAction:"actionRegistry.clearCellContents",environment:e,canUndo:!0,perform:t=>{Z()._({environment:e,transaction:t})}}),X().wr()}});function ve(e){return"column"===e?ge:"row"===e?me:"cell"===e?fe:void(0,c().HB)(e)}function ye(e){const{textColorActions:t,backgroundColorActions:n}=function(e){return{textColorActions:(0,R().gy)({key:`simple table ${e} text color actions`,title:R().AY.colorSection,overrideSearchTitle:R().AY.colorSection,render:e=>(0,g.jsx)(p().A,{...e}),actions:[...B().N.map((t=>be(t,e)))]}),backgroundColorActions:(0,R().gy)({key:`simple table ${e} background color actions`,title:R().AY.backgroundSection,overrideSearchTitle:R().AY.backgroundSectionKeywords,render:e=>(0,g.jsx)(p().A,{...e}),actions:[...B().AQ.map((t=>be(t,e)))]})}}(e);return[(0,R().gy)({key:"text-color-section",title:ee.textColorSection,render:e=>(0,g.jsx)(p().A,{...e}),actions:t.actions}),(0,R().gy)({key:"background-color-section",title:ee.backgroundColorSection,render:e=>(0,g.jsx)(p().A,{...e}),actions:n.actions})]}function be(e,t,n,i){const o=i||(0,Y().qo)(e),s=(0,R().Ls)({key:`color ${n||e}`,displayName:o,analyticsName:o.defaultMessage,fuzzySearchKeywords:(0,R().Mf)(e),validators:ve(t),action:({blocks:t,environment:n})=>{L().createAndCommit({userAction:"actionRegistry.createSimpleTableColorAction",environment:n,canUndo:!0,perform:t=>{Q().wW(n,e,t)}})},closeParentMenu:!0,render:t=>(0,g.jsx)(O().Ay,{...t,color:e,overrideDisplayName:s.displayName}),nativeImageReference:({environment:t})=>(0,R().Kg)(t,e,n)});return s}const Se=(0,D().u)({key:"set column color",displayName:R().AY.colorName,analyticsName:R().AY.colorName.defaultMessage,svg:C().M,validators:ve("column"),subActions:()=>ye("column")}),xe=(0,D().u)({key:"set row color",displayName:R().AY.colorName,analyticsName:R().AY.colorName.defaultMessage,svg:C().M,validators:ve("row"),subActions:()=>ye("row")}),Ae=(0,D().u)({key:"set cell color",displayName:R().AY.colorName,analyticsName:R().AY.colorName.defaultMessage,svg:C().M,validators:ve("cell"),subActions:()=>ye("cell")}),Me=[(0,R().gy)({key:"cell section",render:e=>(0,g.jsx)(p().A,{...e}),actions:[Ae,he]}),(0,R().gy)({key:"column section",render:e=>(0,g.jsx)(p().A,{...e}),actions:[te,Se,ie,oe,se,re,ae]}),(0,R().gy)({key:"row section",render:e=>(0,g.jsx)(p().A,{...e}),actions:[ne,xe,le,de,ce,pe,ue]})];var we=()=>n(407054),je=()=>n(95758),ke=()=>n(502438),Ie=()=>n(817148),Ce=()=>n(819493),Te=()=>n(452558),_e=()=>n(419357),Pe=()=>n(404277),Be=()=>n(45552),De=()=>n(417392),Re=()=>n(962036);function Ee(){const e=(0,i().Y0)();return e.isMobileNative&&e.isIOS&&e.isPhone?(0,g.jsx)(Le,{}):(0,g.jsx)(Oe,{})}function Le(){const e=(0,o().O$)(we().A);return(0,k().A)({shouldPreserveTextSelection:e.isActive,shouldPreserveBlockSelection:!1,shouldRestoreSelection:!0}),(0,g.jsx)(Oe,{})}function Oe(){const e=(0,i().Y0)(),t=(0,o().O$)(we().A);return(0,g.jsx)(De().Ay,{popupType:e.isPhone?a().n.BottomSheet:a().n.Popup,bottomSheetInitialState:t.isActive?t.bottomSheetInitialState:void 0,open:t.isActive,originRect:t.isActive?t.originBlockRect:void 0,onDismiss:Ke,placementToOrigin:"bottom",alignmentToOrigin:"start",originGap:0,preventScaleTransition:!0,render:()=>(0,g.jsx)(Ne,{}),preventBlockRenderQueueOnEnter:e.isMobile,trapFocus:!0})}function Ne(){var e;const t=(0,i().v3)(),n=(0,i().WS)(),a=(0,A().Tf)(),p=(0,o().O$)(we().A),h=null===(e=p.stores)||void 0===e?void 0:e[0],S=(0,o().K8)((()=>null==h?void 0:h.isCollectionView()),[h]),M=(0,o().K8)((()=>p.isActive?function(e){switch(e){case"default":return u().JS;case"simple_table":case"simple_table_cell":return Me;case"page_mention":return v;case"sidebar_outliner":return f().LV;case"comment_media":return m;case"block_in_collection_timeline_view":return u().bH;case"block_in_collection":return u().SH;default:(0,c().HB)(e)}}(null==p?void 0:p.actionSectionGroupKey):[]),[p]),k=(0,o().K8)((()=>p.isActive&&!p.hideTitle),[p]),[I,C]=(0,j().$)();if(!p.isActive||!h)return null;const{originBlockRect:T,inputValue:_,publicEditMode:P}=p||{},B={environment:t,blocks:p.stores,originRect:T,publicEditMode:P,analyticsFrom:p.analyticsFrom},D=p.showInput&&(0,g.jsx)(ze,{inputComboboxProps:I}),R=n?{menuType:A().gu.Modal,title:(0,g.jsx)(l().sA,{defaultMessage:"Actions",id:"blockMenu.actionButton.label"}),right:a?void 0:(0,g.jsx)(Be().DoneMenuText,{}),onClickRight:a?void 0:Ke,header:D}:{menuType:A().gu.Popup,width:265,header:D};return(0,g.jsx)(s().N,{debugName:"BlockMenu",capture:!0,onBackspace:d().D_,children:(0,g.jsxs)(Pe().A,{...R,children:[(0,g.jsx)(Te().A,{filter:_,context:B,sections:M,onAccept:e=>function(e,t){const n=we().A.state;if(!n.isActive)return;const{stores:i}=ke().default.state,{analyticsFrom:o,collectionContextStore:s}=n,a=i[0];if(a){const n=a.getParentTable(),i=a.getType();if(i&&n){let l;if(n===r().yK){const e=a.getParentId(),t=a.getSpaceStore();t&&void 0!==e&&(l=je().h.createChildStore(t,{table:r().yK,id:e}))}const d=(0,x().sl)(s)||{};(0,y().N)(t,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:o,block_id:a.id,block_type:i,parentTeamStore:l,is_toggleable:(0,w().Yt)(i,a.getFormat()),parent_collection_id:a.getParentCollectionIdUpToTwoLevels(),...d})}}e.closeParentMenu&&b().VN()}(e,t),initialFocus:_?0:void 0,comboboxProps:p.showInput?C:void 0,shouldShowBlockTypeTitle:k}),_||p.hideMetadata?void 0:(0,g.jsx)(Ue,{}),_?void 0:(0,g.jsx)(Ie().A,{store:h}),!_&&S?(0,g.jsx)(Fe,{}):void 0]})})}function Fe(){const[e,t]=(0,o().K8)((()=>{const e=we().A.state;if(!e.isActive)return[!1,!1];const t=e.stores[0];return[!0,(0,S().s)(t.id)]}),[]);return e?t?(0,g.jsx)(p().A,{topBorder:!0,children:(0,g.jsx)(Re().g,{title:(0,g.jsx)(l().sA,{defaultMessage:"Learn about tasks",id:"myTasks.helpTooltip.title"}),href:I().hI,analyticsFrom:"block_menu"})}):(0,g.jsx)(p().A,{topBorder:!0,children:(0,g.jsx)(Re().g,{title:(0,g.jsx)(l().sA,{defaultMessage:"Learn about databases",id:"blocks.blockMenu.collectionHelpButton"}),href:(0,M().x)("guides.database"),analyticsFrom:"block_menu"})}):null}function Ue(){const e=(0,i().v3)(),t=(0,o().K8)((()=>e.currentUser.isLoggedIn()),[e]),n=(0,o().K8)((()=>{if(!we().A.state.isActive)return;if(1!==we().A.state.stores.length)return;const e=we().A.state.stores[0];return!(0,S().s)(e.id)&&e.canEdit()?e:void 0}),[]);return t&&n?(0,g.jsx)(Ce().$,{store:n,isPageMoreButton:!1}):null}function ze(e){const t=(0,l().tz)(),n=(0,i().WS)(),s=(0,o().O$)(we().A);if(!s.isActive||n)return null;const{inputValue:a}=s;return(0,g.jsx)(p().A,{isInput:!0,children:(0,g.jsx)(_e().Ay,{value:a,onChange:Ve,focus:!0,focusAfterAnimation:!0,placeholder:t.formatMessage({defaultMessage:"Search actionsâ€¦",id:"blockMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0,preventCaptureSpacebarWhenEmpty:!0,...e.inputComboboxProps})})}function Ke(){b().VN()}function Ve(e){we().A.state.isActive&&we().A.setState({...we().A.state,inputValue:e.target.value})}},853306:(e,t,n)=>{n.d(t,{A:()=>M});n(581454);var i=n(296540),o=()=>n(662303),s=()=>n(56366),a=()=>n(401497),r=()=>n(718827),l=()=>n(406094),d=()=>n(160432),c=()=>n(66913),u=()=>n(340498),p=()=>n(284371),g=()=>n(115512),m=()=>n(141333),f=()=>n(265665),h=()=>n(484595),v=()=>n(125565),y=n(474848);const b=20;function S({icon:e,iconStyle:t,title:r,subtitle:c,confirmText:f,confirmTextStyle:h="blue",radioButtonStyle:S="blue",confirmTextPerRadioOption:M,cancelText:w,hideCancelButton:j=!1,radioOptions:k,defaultSelectedRadioOption:I,onDismiss:C,onSelectRadio:T,onConfirm:_,width:P,footer:B}){var D;const R=(0,n(484714).v3)(),[E,L]=(0,i.useState)(I??(null===(D=k[0])||void 0===D?void 0:D.key)),O=(0,s().uB)(void 0,n(150669).A),N=(0,s().K8)((()=>null==O?void 0:O.state.elementRef),[O]),F=(0,m().CR)(N),U=(0,m().yE)(N),z=(0,m().o7)(N),K=U>0,V=Math.ceil(U+z)<Math.floor(F),q=(0,i.useCallback)((e=>{e!==E&&(L(e),null==T||T(e))}),[T,E]),W=(0,i.useCallback)((()=>{_(E)}),[_,E]),G=(0,a().IS)((e=>{const n={marginInlineStart:-20,marginInlineEnd:-20,height:1,borderTop:`1px solid ${e.regularDividerColor}`,transition:"opacity 200ms"};return{container:{display:"flex",position:"relative",flexDirection:"column",justifyContent:"center",overflow:"hidden",width:`min(${P??400}px, calc(100vw - 40px))`,maxHeight:"80vh",padding:b,borderRadius:6,alignItems:"stretch"},icon:{width:u().Ev.xl,height:u().Ev.xl,fill:e.icon.secondary,marginBottom:10,...t},iconContainer:{width:"100%",display:"flex",justifyContent:"center"},title:{fontFamily:p().vc(o().locale).sans,fontSize:17,lineHeight:"22px",fontWeight:p().Wy.medium,textAlign:"center",marginBottom:14},subtitle:{fontFamily:p().vc(o().locale).sans,fontSize:(0,g().ny)(R,"UIRegular"),lineHeight:(0,g().ks)(R,"UIRegular"),fontWeight:p().Wy.regular,marginTop:6,marginBottom:6,textAlign:"center"},radioContainer:{display:"flex",flexDirection:"column",gap:8},topDivider:{...n,opacity:K?1:0},bottomDivider:{...n,opacity:V?1:0},scroller:{marginInlineStart:-20,marginInlineEnd:-20,paddingInlineStart:b,paddingInlineEnd:b},actionButtonsContainer:{display:"flex",flexDirection:"column",marginTop:20},cancelButton:{marginTop:8,justifyContent:"center"},dismissButton:{position:"absolute",top:10,insetInlineEnd:10,zIndex:1}}}),[R,t,V,K,P]),H=(null==M?void 0:M[E])??f;return(0,y.jsxs)("div",{style:G.container,children:[(0,y.jsx)("div",{style:G.dismissButton,children:(0,y.jsx)(x,{onClick:C})}),e?(0,y.jsx)("div",{style:G.iconContainer,children:e(G.icon)}):void 0,(0,y.jsx)(v().A,{isMultiline:!0,style:G.title,children:r}),c?(0,y.jsx)(v().A,{isSmall:!0,style:G.subtitle,isMultiline:!0,children:c}):void 0,k.length>0?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{style:G.topDivider}),(0,y.jsx)(n(2143).H,{type:n(611648).A.Y,style:G.scroller,store:O,children:(0,y.jsx)("div",{style:G.radioContainer,children:k.map((e=>(0,y.jsx)(A,{radioItem:e,radioButtonStyle:S,isSelected:e.key===E,onSelectRadio:q,left:e.left},e.key)))})}),(0,y.jsx)("div",{style:G.bottomDivider})]}):void 0,(0,y.jsxs)("div",{style:G.actionButtonsContainer,children:["blue"===h?(0,y.jsx)(d().A,{colorPalette:"blue",size:"lg",onClick:W,children:H}):"red"===h?(0,y.jsx)(d().A,{size:"lg",onClick:W,colorPalette:"red",children:H}):(0,y.jsx)(l().A,{size:"lg",onClick:W,children:H}),j?void 0:(0,y.jsx)(l().A,{size:"lg",onClick:C,style:G.cancelButton,children:w??(0,y.jsx)(n(69708).sA,{id:"radioModal.cancel",defaultMessage:"Cancel"})})]}),B]})}function x({onClick:e}){const t=(0,a().IS)((e=>({button:{display:"flex",justifyContent:"center",alignItems:"center",width:24,height:24,borderRadius:"100%",background:e.lightGrayButtonBackground},buttonHovered:{background:e.lightGrayButtonHoveredBackground},buttonPressed:{background:e.lightGrayButtonPressedBackground},closeIcon:{width:16,height:16,fill:e.icon.secondary}})),[]);return(0,y.jsx)(r().Ay,{style:t.button,hoveredStyle:t.buttonHovered,pressedStyle:t.buttonPressed,onClick:e,children:(0,c().V)(t.closeIcon)})}function A({radioItem:e,isSelected:t,onSelectRadio:n,radioButtonStyle:i="blue",left:o}){const s=(0,a().IS)((e=>({button:{display:"flex",justifyContent:"space-between",gap:10,height:"auto",minHeight:70,borderRadius:8,paddingTop:12,paddingBottom:12,paddingInlineStart:14,paddingInlineEnd:14-h().p,border:void 0,boxShadow:t?`inset 0 0 0 1px ${"blue"===i?e.blue.icon.accentPrimary:e.red.icon.accentPrimary}`:`inset 0 0 0 1px ${e.border.primary}`},buttonText:{display:"flex",flexDirection:"column",gap:2,...p().RC},optionTitle:{fontWeight:p().Wy.medium},optionSubtitle:{whiteSpace:"break-spaces"},left:{display:"flex",alignItems:"center",justifyContent:"center"}})),[t,i]);return(0,y.jsxs)(l().A,{size:"lg",onClick:()=>n(e.key),style:s.button,children:[o?(0,y.jsx)("div",{style:s.left,children:o}):void 0,(0,y.jsxs)("div",{style:s.buttonText,children:[(0,y.jsx)(v().A,{style:s.optionTitle,children:(0,y.jsx)(f().j,{children:e.title})}),e.subtitle?(0,y.jsx)(v().A,{isSmall:!0,isMultiline:!0,style:s.optionSubtitle,children:e.subtitle}):void 0]}),(0,y.jsx)(h().A,{isSelected:t,radioButtonColor:i})]})}const M=i.memo(S)},867159:(e,t,n)=>{n.d(t,{J8:()=>g,p7:()=>p});n(296540);var i=()=>n(484714),o=()=>n(401497),s=()=>n(631524),a=()=>n(668725),r=()=>n(69708),l=()=>n(406699),d=()=>n(74263),c=()=>n(26517),u=n(474848);function p(e){const{buttonPopupStore:t,disabled:n,currentVisibility:i}=e,o=(0,u.jsx)(r().sA,{...d().vG[i]});return(0,u.jsx)(m,{disabled:n,buttonPopupStore:t,currentVisibilityLabel:o,renderVisibilityLevelsMenu:t=>(0,u.jsx)(c().aj,{...e,onClose:()=>{var n;null===(n=e.onClose)||void 0===n||n.call(e),t.close()}})})}function g(e){const{buttonPopupStore:t,disabled:n,currentVisibility:i}=e,o=(0,u.jsx)(r().sA,{...d().PP[i]});return(0,u.jsx)(m,{disabled:n,buttonPopupStore:t,currentVisibilityLabel:o,renderVisibilityLevelsMenu:t=>(0,u.jsx)(c().f3,{...e,onClose:()=>{var n;null===(n=e.onClose)||void 0===n||n.call(e),t.close()}})})}function m(e){const t=(0,i().Y0)(),{buttonPopupStore:n,currentVisibilityLabel:r,renderVisibilityLevelsMenu:d,disabled:c}=e,p=(0,o().IS)((e=>({chevronDownIcon:{width:10,marginInlineStart:4,marginInlineEnd:4,fill:e.icon.tertiary},currentVisibilityLabel:{color:e.text.secondary,paddingInlineEnd:4,height:t.isMobile?32:22}})),[t.isMobile]);return(0,u.jsx)(l().A,{popupType:l().z.Popup,buttonPopupStore:n,renderOrigin:e=>(0,u.jsxs)(s().p,{style:p.currentVisibilityLabel,disabled:c,...e,children:[r,(0,a().b)(p.chevronDownIcon)]}),render:d})}},877263:(e,t,n)=>{n.r(t),n.d(t,{ImportIntoNewPageModal:()=>f,default:()=>h});n(296540);var i=()=>n(484714),o=()=>n(56366);const s=(0,n(340498).xh)("docBadgePlus",{default:{loader:()=>n.e(94802).then(n.bind(n,758105))},small:{loader:()=>n.e(94802).then(n.bind(n,424451))},fill:{loader:()=>n.e(94802).then(n.bind(n,528265))},fillSmall:{loader:()=>n.e(94802).then(n.bind(n,301136))}},["IPR","initial page render","recent document","recent page","recents","page history"]);var a=()=>n(69708),r=()=>n(559926),l=()=>n(41432),d=()=>n(522094),c=()=>n(404141),u=()=>n(347063),p=()=>n(107683),g=n(474848);function m(){l().A.setState({open:!1})}function f(){const e=(0,i().v3)(),t=(0,o().K8)((()=>l().A.state.open),[]);return(0,g.jsx)(p().s,{isOpen:t,onDismiss:m,onClosed:m,areaConstraint:{width:{type:"fixed",length:300}},render:()=>(0,g.jsx)(u().tf,{header:(0,g.jsx)(u().YA,{iconAndTitle:(0,g.jsx)(u().ZQ,{iconGroup:s,title:(0,g.jsx)(a().sA,{defaultMessage:"Import into new page?",id:"importIntoNewPageModal.title"})}),description:(0,g.jsx)(a().sA,{id:"importIntoNewPageModal.description",defaultMessage:"Since this page already has content, weâ€™ll need to create a new page for you and import contents there."})}),footer:(0,g.jsx)(u().aO,{layout:"vertical",primaryButtons:[{buttonType:"primary",label:(0,g.jsx)(a().sA,{defaultMessage:"Yes, continue",id:"importIntoNewPageModal.importButton"}),onClick:()=>{c().A.setState({open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0,openedFrom:"collection"}),r().kY(e,{from:"topbar",flowId:d().A.createFlowId()}),m()}}],secondaryButtons:[{buttonType:"secondary",label:"Cancel",onClick:m}]})})})}const h=f},885067:(e,t,n)=>{n.d(t,{y:()=>a});n(296540);var i=()=>n(581369),o=()=>n(125565),s=n(474848);function a({title:e,description:t,disabled:n=!1,selected:a,onChange:r=(()=>{})}){return(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>!n&&r(!a),children:[(0,s.jsxs)("div",{style:{fontSize:14,marginInlineEnd:8,flexGrow:1},children:[e,t?(0,s.jsx)(o().A,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:t}):void 0]}),(0,s.jsx)("div",{style:{marginTop:5},children:(0,s.jsx)(i().A,{on:a,disabled:n})})]})}},887480:(e,t,n)=>{n.d(t,{Ay:()=>o().A,yQ:()=>a});var i=()=>n(645873),o=()=>n(853306);const s=new(i().O2)("radioModalRenderer",(()=>n.e(35818).then(n.bind(n,415995)))),a=(0,i()._h)(s,(e=>e.default))},889154:(e,t,n)=>{n.d(t,{G:()=>o});n(296540);var i=n(474848);const o=(0,n(340498).wt)("personBadgeExclamationMark",{viewBox:"0 0 24 22",svg:(0,i.jsx)("path",{d:"M14 20.91c1.36 0 2.64-.26 3.838-.781a10.166 10.166 0 003.183-2.158 10.198 10.198 0 002.159-3.174 9.59 9.59 0 00.78-3.848c0-1.36-.263-2.64-.79-3.838a10.165 10.165 0 00-2.158-3.183 10.165 10.165 0 00-3.184-2.158A9.52 9.52 0 0013.99.988c-1.27 0-2.47.228-3.603.684A10.24 10.24 0 007.34 3.566 10.179 10.179 0 005.152 6.39a9.75 9.75 0 00-1.045 3.466c.235-.045.508-.074.82-.087.32-.02.61-.013.87.02.137-1.01.44-1.948.908-2.813A8.088 8.088 0 018.512 4.7a8.261 8.261 0 012.5-1.504 8.095 8.095 0 012.978-.547c1.153 0 2.23.215 3.233.645a8.233 8.233 0 012.646 1.777 8.365 8.365 0 011.787 2.647 8.11 8.11 0 01.645 3.232 8.15 8.15 0 01-2.139 5.557c-.319-.378-.775-.736-1.367-1.074-.593-.345-1.296-.625-2.11-.84-.813-.215-1.712-.322-2.695-.322-.469 0-.918.029-1.347.087-.43.053-.837.124-1.221.215.117.469.176.96.176 1.475 0 .762-.134 1.488-.4 2.178a6.308 6.308 0 01-1.095 1.865c.6.26 1.228.462 1.885.605A9.426 9.426 0 0014 20.91zm-.01-8.3a3.02 3.02 0 001.69-.47 3.53 3.53 0 001.21-1.318c.3-.56.45-1.191.45-1.894 0-.658-.15-1.26-.45-1.807a3.55 3.55 0 00-1.21-1.309 3.035 3.035 0 00-1.69-.488c-.625 0-1.191.163-1.699.489a3.622 3.622 0 00-1.65 3.115c0 .696.15 1.321.449 1.875.3.553.7.993 1.201 1.318a3.194 3.194 0 001.7.488zM5.3 21.017c.67 0 1.305-.13 1.904-.391a5.082 5.082 0 001.582-1.074A5 5 0 009.87 17.97c.26-.6.39-1.237.39-1.914 0-.684-.13-1.325-.39-1.924a4.945 4.945 0 00-1.064-1.582 4.946 4.946 0 00-1.582-1.065 4.772 4.772 0 00-1.924-.39c-.677 0-1.315.13-1.914.39a4.87 4.87 0 00-1.582 1.074A5.082 5.082 0 00.73 14.142a4.707 4.707 0 00-.391 1.914c0 .683.13 1.325.39 1.924a5.07 5.07 0 001.075 1.581c.455.456.983.811 1.582 1.065.599.26 1.237.39 1.914.39zm-.01-1.797a.788.788 0 01-.576-.244.768.768 0 01-.244-.577c0-.227.081-.423.244-.585a.788.788 0 01.576-.245c.234 0 .43.085.586.254a.788.788 0 01.244.576.77.77 0 01-.244.577.8.8 0 01-.586.244zm.01-2.325a.601.601 0 01-.43-.156.613.613 0 01-.166-.41l-.078-2.793a.63.63 0 01.176-.488.673.673 0 01.498-.186.66.66 0 01.488.186.63.63 0 01.176.488l-.078 2.793a.592.592 0 01-.176.41.554.554 0 01-.41.157z"})})},898615:(e,t,n)=>{n.d(t,{F:()=>s});n(296540);var i=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"2.37 3.13 15.26 14.86",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M9.533 5.813a.625.625 0 0 1 .884 0l2.5 2.5a.625.625 0 1 1-.884.884l-1.408-1.408v3.966a.625.625 0 1 1-1.25 0V7.739L7.917 9.197a.625.625 0 0 1-.884-.884z"}),(0,i.jsx)("path",{d:"M15.5 3.13c1.174 0 2.125.951 2.125 2.125v7.5A2.125 2.125 0 0 1 15.5 14.88h-4.935l-3.871 2.978a.625.625 0 0 1-1.006-.496V14.88H4.5a2.125 2.125 0 0 1-2.125-2.125v-7.5c0-1.174.951-2.125 2.125-2.125zm.875 2.125a.875.875 0 0 0-.875-.875h-11a.875.875 0 0 0-.875.875v7.5c0 .483.392.875.875.875h1.813c.345 0 .625.28.625.625v1.838l3.033-2.334a.63.63 0 0 1 .381-.13H15.5a.875.875 0 0 0 .875-.874z"})]})},s=(0,n(340498).wt)("commentArrowUp",o)},913687:(e,t,n)=>{n.d(t,{A:()=>i});const i=(0,n(69708).YK)({inputPlaceholder:{defaultMessage:"Property name",id:"database.viewSettings.propertyTab.propertyName"},autofillOffLabel:{defaultMessage:"Off",id:"database.viewSettings.propertyTab.autofillOffLabel"},autofillOnLabel:{defaultMessage:"On",id:"database.viewSettings.propertyTab.autofillOnLabel"},keptUpToDateWithNotionAITooltip:{defaultMessage:"Auto-updated by AI",id:"database.tableHeaderCell.tooltipAiAutofillDescription"},buttonPropertyErrorTooltip:{defaultMessage:"Button property has an error",id:"database.tableHeaderCell.tooltipButtonPropertyError"},offlineWarningFormula:{id:"database.tableHeaderCell.offlineWarning.formula",defaultMessage:"Formula results may not be accurate when offline"},offlineWarningAutoUpdate:{id:"database.tableHeaderCell.offlineWarning.autoUpdate",defaultMessage:"Content will not auto-update when offline"},usersAndGroups:{defaultMessage:"Users and groups",id:"database.personProperty.notifications.usersAndGroups"},usersOnly:{defaultMessage:"Users only",id:"database.personProperty.notifications.usersOnly"},none:{defaultMessage:"None",id:"database.personProperty.notifications.none"}})},936529:(e,t,n)=>{n.r(t),n.d(t,{default:()=>V});var i=n(296540),o=()=>n(726637),s=()=>n(484714),a=()=>n(56366),r=()=>n(401497),l=()=>n(929219),d=()=>n(252291),c=()=>n(406094),u=()=>n(15936),p=()=>n(69708);const g=["dmca_no_action"],m=(0,p().YK)({phishing_or_spam:{id:"reportPage.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"},inappropriate_content:{id:"reportPage.reportReasons.inappropriate_content",defaultMessage:"Inappropriate content"},other_content_policy_violation:{id:"reportPage.reportReasons.other_content_policy_violation",defaultMessage:"Other"},dmca_no_action:{id:"reportPage.reportReasons.dmca_no_action",defaultMessage:"DMCA takedown request"}});var f=()=>n(100622),h=()=>n(496603),v=()=>n(284371),y=()=>n(559506),b=()=>n(901389),S=()=>n(201170),x=()=>n(161479),A=()=>n(765957);var M=()=>n(135552),w=()=>n(972435),j=()=>n(722872),k=()=>n(232930),I=()=>n(736026),C=()=>n(716583),T=()=>n(297872),_=()=>n(623580),P=()=>n(404277),B=()=>n(678553),D=()=>n(939740),R=()=>n(819121),E=()=>n(484595),L=n(474848);function O({name:e,title:t,caption:n,isSelected:o,onClick:a,disabled:l}){const[d,c]=(0,R().A)(),u=(0,s().Y0)(),p=(0,r().IS)((e=>({root:{position:"relative",display:"flex",alignItems:"center",flex:1,fontSize:14,marginBottom:8,cursor:"pointer",opacity:l?.4:1,...c&&{boxShadow:e.buttonBlueFocusRing}},caption:{color:e.text.secondary,marginInlineStart:8},input:{position:"absolute",top:0,insetInlineStart:0,width:"100%",height:"100%",opacity:0}})),[l,c]),g=(0,i.useCallback)((()=>{l||a()}),[l,a]);return u.isMobile?(0,L.jsx)(B().Ay,{title:t,right:(0,L.jsx)(E().A,{isSelected:o}),onClick:g}):(0,L.jsxs)("label",{style:p.root,children:[(0,L.jsx)(E().A,{isSelected:o}),(0,L.jsx)("div",{children:t}),n?(0,L.jsx)("div",{style:p.caption,children:n}):void 0,(0,L.jsx)("input",{type:"radio",checked:o,disabled:l,name:e,onClick:g,style:p.input,ref:d})]})}var N=()=>n(89924),F=()=>n(690197),U=()=>n(719147),z=()=>n(327165);const K=(0,p().YK)({additionalInformationPlaceholder:{id:"reportPage.additionalInformation.placeholder",defaultMessage:"Please describe how this content violates our Content & Use Policy ({otherSelected, select, true {required} other {optional}})"},dialogLabel:{id:"reportPage.dialogLabel",defaultMessage:"Report page"}});const V=function(){const e=(0,a().K8)((()=>I().A.state.open),[]);return(0,L.jsx)(n(641514).A,{ariaLabel:w().A.formatMessage(K.dialogLabel),onDismiss:X,render:()=>(0,L.jsx)(ie,{}),isOpen:e})};function q(e){const{reason:t,additionalInformation:n}=e;return void 0!==t&&(!g.includes(t)&&!("other_content_policy_violation"===t&&!n))}function W(){const{state:e}=I().A;if(e.open){const{reason:t,additionalInformation:n}=e;return q({reason:t,additionalInformation:n})}return!1}function G({modalState:e}){const{reason:t}=e;return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(O,{title:(0,L.jsx)(p().sA,{id:"reportPageModal.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"}),isSelected:"phishing_or_spam"===t,onClick:()=>I().A.setState({...e,reason:"phishing_or_spam"}),name:"report-page-modal"},"phishing_or_spam"),(0,L.jsx)(O,{title:w().A.formatMessage(m.inappropriate_content),isSelected:"inappropriate_content"===t,onClick:()=>I().A.setState({...e,reason:"inappropriate_content"}),name:"report-page-modal"},"inappropriate_content"),(0,L.jsx)(O,{title:w().A.formatMessage(m.dmca_no_action),isSelected:"dmca_no_action"===t,onClick:()=>I().A.setState({...e,reason:"dmca_no_action"}),name:"report-page-modal"},"dmca_no_action"),(0,L.jsx)(O,{title:(0,L.jsx)(p().sA,{id:"reportPageModal.reportReasons.other_content_policy_violation",defaultMessage:"Other"}),isSelected:"other_content_policy_violation"===t,onClick:()=>I().A.setState({...e,reason:"other_content_policy_violation"}),name:"report-page-modal"},"other_content_policy_violation")]})}async function H(e){const t=I().A.getState();if(!t.open)return;const{additionalInformation:n,reason:i}=t,o=function(){if(A().default.state.mainEditorCurrentBlockStore)return{id:A().default.state.mainEditorCurrentBlockStore.id,spaceId:(0,x().e)(A().default.state.mainEditorCurrentBlockStore.pointer.spaceId)}}();if(null==o||!o.id||!i||!q({reason:i,additionalInformation:n}))return void b().f1((0,L.jsx)(p().sA,{defaultMessage:"Something went wrong.",id:"reportPageModal.somethingWentWrong.label"}));const s=await y().callApi({eventName:"reportPage",environment:e,data:{reason:i,page:o,additionalInformation:n}});"failed"===s.type?b().Qg(s):(I().A.setState({open:!1}),b().rG({message:(0,L.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,L.jsx)(d().I,{icon:u().checkmarkShieldIcon,size:"xl"}),(0,L.jsx)("div",{style:{paddingTop:12,paddingBottom:8,textAlign:"center"},children:(0,L.jsx)(p().sA,{id:"reportPageModal.thanksForReporting",defaultMessage:"Thanks for reporting this page, our team will take a look."})})]})}))}function Y(e){return{width:360,padding:24,fontSize:14,color:e.text.secondary}}function $(e,t){return{width:"100%",background:t.popoverBackground,display:"block",padding:o().A.isMobile?16:"10px 12px",height:o().A.isMobile?150:130,marginTop:17,marginBottom:17,fontSize:o().A.isMobile?16:14}}function Q({isMobile:e=!1}){return(0,L.jsx)(p().sA,{defaultMessage:"This page is hosted by Notion. Use this form to submit a report if you believe this page violates <contentpolicylink>Notionâ€™s content policy</contentpolicylink>.{br}{br}<clarification>This is not a contact form for the person or organization that authored this page</clarification>.",id:"reportPageModal.reportButton.description",values:{br:(0,L.jsx)("br",{}),contentpolicylink:(...t)=>(0,L.jsx)(F().A,{title:t,href:(0,k().x)("contentPolicy"),analyticsFrom:"report_page",style:{display:"inline",marginInlineStart:void 0},buttonStyle:{alignItems:"baseline",height:e?v().K_.UISmall.mobile:v().K_.UISmall.desktop,paddingInlineStart:"3px",paddingInlineEnd:"2px"},textSize:"small",isMobile:e}),clarification:(...e)=>(0,L.jsx)("i",{children:e})}})}function Z(){return(0,L.jsx)(p().sA,{defaultMessage:"To submit a formal DMCA takedown request, please follow the instructions detailed in <dmcapolicylink>Notionâ€™s official DMCA policy</dmcapolicylink>.",id:"reportPageModal.reportButton.dmcaInstructions",values:{dmcapolicylink:(...e)=>(0,L.jsx)(U().A,{external:!0,href:"https://www.notion.so/notion/DMCA-Policy-69d880bd37fe496a9b7c64ccc65e024d",children:e})}})}function J(){const e=(0,r().DP)();return(0,L.jsx)("div",{style:Y(e),children:(0,L.jsx)(p().sA,{defaultMessage:"Please go online to make a report.",id:"reportPageModal.offlineMessage.description"})})}function X(){S().lR()}function ee(){return(0,r().IS)((e=>({reportPageExplanation:{color:e.text.tertiary,background:e.background.primary,border:`1px solid ${e.border.strong}`},reportPageBanner:{justifyContent:void 0,whiteSpace:"normal",display:"block",paddingTop:"7px",paddingBottom:"7px",marginBottom:"15px"},mobileDescription:{color:e.text.secondary,padding:"5px",fontSize:v().J.UISmall.mobile},modalTitle:{fontSize:16,marginBottom:12,fontWeight:v().Wy.medium}})),[])}function te({modalState:e}){const t=(0,r().DP)(),n=(0,s().v3)(),i=ee();if(!e.open)return null;const{reason:o}=e,a={menuType:j().gu.Modal,title:(0,L.jsx)(p().sA,{id:"reportPageModal.mobile.title",defaultMessage:"Report page"}),right:(0,L.jsx)(p().sA,{id:"reportPageModal.closeButton.label",defaultMessage:"Close"}),onClickRight:X};return(0,L.jsx)(P().A,{...a,children:(0,L.jsx)(D().Ay,{type:D().Oh.Vertical,initialFocus:void 0,sections:h().oE([{key:"help",render:({children:e,...t})=>(0,L.jsx)(N().A,{...t,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:e}),items:[{key:"help",render:()=>(0,L.jsx)(B().Ay,{title:(0,L.jsx)(Q,{isMobile:!0}),textWrapperStyle:i.mobileDescription,shouldWrapTitle:!0,right:(0,L.jsx)(L.Fragment,{}),onClick:()=>{}}),action:()=>{}}]},{key:"reportOptions",render:({children:e,...t})=>(0,L.jsx)(N().A,{...t,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:e}),items:[{key:"options",render:()=>(0,L.jsx)(G,{modalState:e}),action:()=>{}},{key:"additionalInfo",render:()=>o&&!g.includes(o)&&(0,L.jsx)(_().A,{textarea:!0,style:$(0,t),focus:Boolean(e.reason),value:e.additionalInformation,placeholder:w().A.formatMessage(K.additionalInformationPlaceholder,{otherSelected:"other_content_policy_violation"===o}),onChange:t=>{I().A.setState({...e,additionalInformation:t.target.value})}}),action:()=>{}}]},"dmca_no_action"===o?{key:"explain_dmca",render:({children:e,...t})=>(0,L.jsx)(N().A,{...t,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:e}),items:[{key:"explain_dmca",render:()=>"dmca_no_action"===o&&(0,L.jsx)(B().Ay,{title:(0,L.jsx)(Z,{}),textWrapperStyle:{...i.mobileDescription,background:t.palette.yellow[100],color:t.palette.yellow[600],margin:"0px",padding:"10px 20px"},style:{display:"block"},shouldWrapTitle:!0,right:(0,L.jsx)(L.Fragment,{}),onClick:()=>{}}),action:()=>{}}]}:void 0,{key:"actions",render:({children:e,...t})=>(0,L.jsx)(N().A,{...t,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:e}),items:[{key:"submit",render:e=>{const{onClick:t,...n}=e,i=W();return(0,L.jsx)(z().A,{...n,disabled:!i,title:(0,L.jsx)("div",{style:{color:i?f().Tj.red:f().Tj.uiGray},children:(0,L.jsx)(p().sA,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})}),onClick:t||H})},action:()=>H(n)}]}])},"main list")})}function ne({modalState:e}){const t=(0,r().DP)(),n=(0,s().v3)(),i=ee();if(!e.open)return null;const{reason:o}=e,a="dmca_no_action"===o;return(0,L.jsx)(T().A,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:()=>(0,L.jsxs)("div",{style:{width:360,padding:24,fontSize:14},children:[(0,L.jsx)("div",{style:i.modalTitle,children:(0,L.jsx)(p().sA,{id:"reportPageModal.title",defaultMessage:"Why are you reporting this page?"})}),(0,L.jsx)(C().A,{isMobile:!1,textSize:"small",styleKey:M().q.Yellow,style:a?i.reportPageBanner:{...i.reportPageExplanation,...i.reportPageBanner},children:a?(0,L.jsx)(Z,{}):(0,L.jsx)(Q,{})}),(0,L.jsx)("div",{children:(0,L.jsx)(G,{modalState:e})}),o&&!g.includes(o)?(0,L.jsx)(_().A,{textarea:!0,style:$(0,t),focus:Boolean(e.reason),value:e.additionalInformation,placeholder:w().A.formatMessage(K.additionalInformationPlaceholder,{otherSelected:"other_content_policy_violation"===o}),onChange:t=>{I().A.setState({...e,additionalInformation:t.target.value})}}):void 0,(0,L.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18},children:[(0,L.jsx)(c().A,{size:"lg",onClick:X,style:{marginInlineEnd:12},children:(0,L.jsx)(p().sA,{id:"reportPageModal.cancelButton.label",defaultMessage:"Cancel"})}),(0,L.jsx)(c().A,{colorPalette:"red",size:"lg",onClick:()=>H(n),disabled:!W(),disabledFeedback:!0,children:(0,L.jsx)(p().sA,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})})]})]})})}function ie(){const e=(0,a().O$)(l().e),t=(0,a().O$)(I().A);return e?t.open?o().A.isMobile?(0,L.jsx)(te,{modalState:t}):(0,L.jsx)(ne,{modalState:t}):null:(0,L.jsx)(J,{})}},942292:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>i,trashFillIcon:()=>o});n(296540);const i={viewBox:"0 0 20 20",fittedViewBox:"2.89 2.4 14.21 15.21",svg:(0,n(474848).jsx)("path",{d:"M6.386 3.925v1.464H3.523a.625.625 0 1 0 0 1.25h.897l.393 8.646A2.425 2.425 0 0 0 7.236 17.6h5.528a2.425 2.425 0 0 0 2.422-2.315l.393-8.646h.898a.625.625 0 1 0 0-1.25h-2.863V3.925c0-.842-.683-1.525-1.525-1.525H7.91c-.842 0-1.524.683-1.524 1.525M7.91 3.65h4.18c.15 0 .274.123.274.275v1.464H7.636V3.925c0-.152.123-.275.274-.275m.896 4.855v5.979a.55.55 0 1 1-1.1 0V8.505a.55.55 0 0 1 1.1 0m3.488 0v5.979a.55.55 0 0 1-1.1 0V8.505a.55.55 0 1 1 1.1 0"})},o=(0,n(340498).wt)("trashFill",i)},942906:(e,t,n)=>{n.d(t,{Lj:()=>r,W2:()=>l,xw:()=>a});var i=()=>n(416504),o=()=>n(231297),s=()=>n(755199);function a(e){const{environment:t,userSettingsStore:n}=e,o=n.getSettings(),s=null==o?void 0:o.time_zone,a=(0,i().P)();s!==a&&r({environment:t,userSettingsStore:n,timeZone:a})}function r(e){const{environment:t,userSettingsStore:n,timeZone:i}=e;o().createAndCommit({userAction:"checkUserTimeZoneAction.updateTimeZone",environment:t,canUndo:!0,perform:e=>{s().mJ({userSettingsStore:n,transaction:e,data:{time_zone:i}})},userId:n.id})}function l(e){const{environment:t,userSettingsStore:n,disableAutoSetTimezone:i}=e;o().createAndCommit({userAction:"checkUserTimeZoneAction.updateDisableAutoSetTimezone",environment:t,canUndo:!0,perform:e=>{s().mJ({userSettingsStore:n,transaction:e,data:{disable_auto_set_timezone:i}})},userId:n.id})}},946576:(e,t,n)=>{n.r(t),n.d(t,{default:()=>x});var i=n(296540),o=()=>n(484714),s=()=>n(401497),a=()=>n(631524),r=()=>n(160432),l=()=>n(75756),d=()=>n(69708),c=()=>n(284371),u=()=>n(204077),p=()=>n(991385),g=()=>n(799089),m=()=>n(455215),f=n(474848);function h(){const e=(0,o().v3)().currentUser.id;(0,i.useEffect)((()=>{if(!e)return;(0,p().S)(e);const t=window.setInterval((()=>{(0,p().S)(e)}),n(720665).nD);return()=>{window.clearInterval(t)}}),[e]);const t=(0,n(56366).K8)((()=>g().A.state.open),[]),s=S();return(0,f.jsx)(n(641514).A,{onDismiss:n(496603).lQ,render:()=>(0,f.jsx)("div",{style:s.modal,children:(0,f.jsxs)(n(21140).Ye,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,f.jsx)("img",{style:s.image,src:n(148307).A.images.feedbackThankYouPng}),(0,f.jsx)("div",{style:s.title,children:(0,f.jsx)(d().sA,{id:"cookieModal.requestConsent.title",defaultMessage:"Set your cookie preferences"})}),(0,f.jsx)("div",{style:s.description,children:(0,l().Qq)(n(74464).i,"banner")}),(0,f.jsx)(v,{}),(0,f.jsx)(y,{}),(0,f.jsx)(b,{})]})}),isOpen:t})}function v(){const e=S(),t=(0,o().v3)();return(0,f.jsx)(r().A,{colorPalette:"blue",size:"lg",style:e.acceptAllButton,onClick:()=>{u().Vg(t,{necessary:!0,preference:!0,performance:!0,targeting:!0}),g().A.setState({open:!1}),u().wB()},children:(0,f.jsx)(d().sA,{...l().LS.acceptAllButtonLabel})})}function y(){const e=S(),t=(0,o().v3)();return(0,f.jsx)(a().p,{size:"lg",colorPalette:"gray",style:e.moreOptionsButton,onClick:()=>{u().Vg(t,{necessary:!0,preference:!1,performance:!1,targeting:!1}),g().A.setState({open:!1}),u().wB()},children:(0,f.jsx)(d().sA,{...l().LS.rejectAllButtonLabel})})}function b(){const e=S();return(0,f.jsx)(m().A,{hasDismissButton:!0,onDismiss:()=>{g().A.setState({open:!1})},renderOrigin:t=>(0,f.jsx)(a().p,{...t,size:"lg",colorPalette:"gray",style:e.moreOptionsButton,children:(0,f.jsx)(d().sA,{...l().LS.moreOptionsButtonLabel})})})}function S(){return(0,s().IS)((e=>({modal:{maxWidth:400,padding:24},image:{height:100},title:{marginTop:8,color:e.text.primary,fontWeight:c().Wy.semibold,fontSize:18},description:{color:e.text.secondary,textAlign:"center",fontSize:14,marginTop:8,marginBottom:18},acceptAllButton:{width:"100%",marginBottom:6},moreOptionsButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}})),[])}const x=i.memo(h)},952305:(e,t,n)=>{n.r(t),n.d(t,{default:()=>g});n(296540);var i=()=>n(484714),o=()=>n(56366),s=()=>n(493552),a=()=>n(69708),r=()=>n(209660),l=()=>n(931432),d=()=>n(347063),c=()=>n(107683),u=()=>n(42648),p=n(474848);function g(){const e=(0,i().Y0)(),t=(0,o().K8)((()=>l().A.state.open),[]),n=()=>{l().A.state.open&&l().A.state.onDecline&&l().A.state.onDecline(),l().A.setState({open:!1})},g=()=>{l().A.state.open&&l().A.state.onConfirm(),l().A.setState({open:!1})},m=()=>{n(),r().Ow({currentTab:"connected_apps"})};return(0,p.jsx)(c().s,{areaConstraint:{width:{type:"range",min:300,max:400},height:{type:"unlimited",scroll:"allow"}},isOpen:t,onDismiss:n,animateSizeTransition:!0,render:()=>(0,p.jsx)(d().tf,{header:(0,p.jsx)(d().YA,{iconAndTitle:(0,p.jsx)(d().ZQ,{iconGroup:u().sK,title:(0,p.jsx)(a().sA,{defaultMessage:"Notion cannot access the Google Drive file you are trying to embed.",id:"googleAuthPromptModal.noAccessFile.errorMessage"})})}),footer:(0,p.jsx)(d().aO,{layout:"vertical",primaryButtons:e.isMobileNative?[]:[{buttonType:"primary",label:(0,p.jsx)(a().sA,{defaultMessage:"Connect to Google",id:"googleAuthPromptModal.connectToGoogleButton.label"}),onClick:g}],secondaryButtons:e.isMobile?[]:[{buttonType:"outline",label:(0,p.jsx)(a().sA,{defaultMessage:"See my connected accounts",id:"googleAuthPromptModal.seeConnectedAccountsButton.label"}),onClick:m}]}),children:e.isMobileNative?(0,p.jsx)(s().D,{styleKey:"Body/Medium",colorVariant:"secondary",style:{textAlign:"center"},children:(0,p.jsx)(a().sA,{defaultMessage:"Please use Notion on desktop to connect a new account.",id:"googleAuthPromptModal.mobileUseDesktopPrompt.errorMessage"})}):null})})}},954845:(e,t,n)=>{n.d(t,{J:()=>o});n(296540);var i=n(474848);const o=(0,n(340498).wt)("blueCircleDot",{viewBox:"0 0 16 16",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("circle",{cx:"8",cy:"8",r:"8",fill:"none",stroke:"#2383E2",children:[(0,i.jsx)("animate",{attributeName:"r",from:"3",to:"8",dur:"1s",begin:"0s",repeatCount:"indefinite"}),(0,i.jsx)("animate",{attributeName:"opacity",from:"1",to:"0",dur:"1s",begin:"0s",repeatCount:"indefinite"})]}),(0,i.jsx)("circle",{cx:"8",cy:"8",r:"3",fill:"#2383E2"})]})})},955450:(e,t,n)=>{n.d(t,{K:()=>d});var i=()=>n(59226),o=()=>n(484714),s=()=>n(56366),a=()=>n(106412),r=()=>n(765957),l=()=>n(583238);function d(e){const{collectionContextStore:t}=e,n=(0,o().v3)(),d=(0,a().Zp)(),c=(0,s().O$)(t.normalizedSchemaStore),u=(0,s().K8)((()=>t.collectionViewStore()),[t]),p=(0,s().K8)((()=>null==u?void 0:u.getType()),[u]),g=(0,i().X)("notion_calendar_db_integration_non_time_views"),m=(0,s().K8)((()=>(0,l().JF)({environment:n,spaceStore:r().default.state.sidebarSpaceStore,schema:c,collectionContextType:t.contextType,collectionViewType:p,enableForNonTimeBasedViews:g})),[n,c,t,p,g]);return Boolean(m)&&!(null!=d&&d.disablePageLinks)}},965142:(e,t,n)=>{n.d(t,{V:()=>o});class i extends(()=>n(757695))().Store{getInitialState(){return{isKeyboardShortcutsOpen:!1,toggleSource:void 0,openCount:0}}}const o=new i;(0,n(852832).exposeDebugValue)("keyboardShortcutsModalStore",o)},965731:(e,t,n)=>{n.r(t),n.d(t,{ConfigureViewsMainModuleAddViewButton:()=>h});n(898992),n(354520),n(581454);var i=n(296540),o=()=>n(484714),s=()=>n(56366),a=()=>n(30537),r=()=>n(898244),l=()=>n(69708),d=()=>n(147503),c=()=>n(760217),u=()=>n(939740),p=()=>n(89924),g=()=>n(937199),m=n(474848);const f=(0,l().YK)({relatedToDatabase:{defaultMessage:"Related to {database}",id:"pageLayout.configureViews.relatedToDatabase"},linkExistingDataSource:{defaultMessage:"Link existing data source",id:"pageLayout.configureViews.linkAnExistingDataSource"}}),h=i.memo((function(e){const{renderOrigin:t,onClose:l}=e,c=(0,o().v3)(),[u,p]=(0,i.useState)(!1),f=(0,i.useRef)(null),{layoutStore:h}=(0,g().LH)(),b=(0,i.useContext)(g().sf),S=null==b?void 0:b.moduleStateByIdStore,x=(0,s().K8)((()=>{var e;const t=h.getModuleByType("viewsMain");if(t)return null==S||null===(e=S.get(t.id))||void 0===e?void 0:e.collectionContextStore}),[h,S]),A=(0,i.useCallback)(((e,t)=>{x&&((0,n(180762).t)({environment:c,collectionContextStore:x,collectionViewId:e.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1}),(0,n(447453).O)({collectionContextStore:x,collectionSettingsStore:x.settingsStore,closeOnEscape:!1}))}),[c,x]),M=(0,s().K8)((()=>{var e;const t=null===(e=h.getParentStore())||void 0===e?void 0:e.getModel();if((null==t?void 0:t.table)===n(519831).Vl)return t}),[h]),w=(0,s().K8)((()=>{const e=null==M?void 0:M.getNormalizedSchema();return Object.entries(e??{}).filter((([e,t])=>(0,n(534177).O9)(t)&&(0,r().nC)(t)&&t.property))}),[M]),j=(0,i.useCallback)((()=>{p(!1),null==l||l()}),[l]),k=(0,i.useCallback)((()=>{p(!0)}),[p]),I=(0,i.useMemo)((()=>n(757695).Store.createValue({open:!1,stack:[]},{name:"newViewsCreationMenuCollectionSettingsStore"})),[]),C=(0,i.useCallback)((()=>{const e=null==x?void 0:x.viewsModuleContextStore.getViewsModule();e&&d().R8({collectionSettingsStore:I,item:{type:"selectViewsModuleSource",module:e,onClose:l}})}),[null==x?void 0:x.viewsModuleContextStore,I,l]),T=(0,i.useCallback)((()=>{d().os({collectionSettingsStore:I})}),[I]),_=(0,i.useCallback)((()=>(0,m.jsx)(v,{setIsOpen:p,onClose:l,relations:w,setCurrentViewPointer:A,collectionModel:M,viewsMainModuleCollectionContextStore:x,openViewsCreationPopup:C})),[l,w,A,M,x,C]),P=(0,i.useCallback)((e=>t(e)),[t]);return x&&M?(0,m.jsxs)("div",{ref:f,children:[(0,m.jsx)(n(406699).A,{alignmentToOrigin:"center",popupType:a().n.Popup,onClose:j,onClick:k,open:u,render:_,renderOrigin:P,disablePopup:!0}),(0,m.jsx)(y,{buttonRef:f,viewsMainModuleCollectionContextStore:x,viewsCreationMenuCollectionSettingsStore:I,openViewsCreationPopup:C,closeViewsCreationPopup:T})]}):null})),v=i.memo((function(e){const{setIsOpen:t,onClose:s,relations:a,setCurrentViewPointer:d,collectionModel:h,viewsMainModuleCollectionContextStore:v,openViewsCreationPopup:y}=e,b=(0,o().v3)(),S=(0,n(401497).DP)(),{layoutStore:x,setModuleSelection:A}=(0,g().LH)(),M=(0,i.useMemo)((()=>{if(0!==a.length)return{key:0,items:[],render:e=>(0,m.jsx)(p().A,{...e,title:(0,m.jsx)(l().sA,{...f.relatedToDatabase,values:{database:null==h?void 0:h.getName()}}),children:a.map((([e,t])=>(0,m.jsx)(c().A,{title:null==t?void 0:t.name,icon:(0,m.jsx)(n(852424).zB,{size:n(340498).Ev.sm,theme:S,icon:null==t?void 0:t.icon,type:"relation"}),focused:!1,onClick:()=>{if(!v)return;const{viewsMainModule:i,collectionViewPointer:o}=(0,n(626318).ZX)({environment:b,layoutStore:x,relationPropertyId:(null==t?void 0:t.property)??e,targetCollectionPointer:(0,r().Nv)(t)??(null==h?void 0:h.pointer),viewName:null==t?void 0:t.name,viewIcon:null==t?void 0:t.icon});i&&A({type:"existing_module",moduleId:i.id,isDragging:!1}),o&&(n(908006).default.afterNextFlush((()=>{d(o,null==i?void 0:i.id),null==s||s()})),v&&(0,n(154017).b)({environment:b,view_type:"table",collectionContextStore:v,from:"viewsMain"}))}},e)))})}}),[v,h,b,x,s,a,d,A,S]),w=(0,i.useMemo)((()=>{const e=a.length>0;return{key:1,items:[],render:t=>(0,m.jsx)(p().A,{...t,topBorder:e,children:(0,m.jsx)(c().A,{title:(0,m.jsx)(l().sA,{...f.linkExistingDataSource}),icon:(0,m.jsx)(n(745266).h,{color:"regular",viewType:"table"}),onClick:y,focused:!1},"link_existing_database")})}}),[y,a.length]);return(0,m.jsx)(n(404277).A,{menuType:n(722872).gu.Popup,onClick:()=>t(!1),width:270,paddingBottom:2,children:(0,m.jsx)(u().Ay,{initialFocus:void 0,sections:[M,w].filter((e=>void 0!==e)),type:u().Oh.Vertical})})})),y=i.memo((function(e){var t;const{buttonRef:o,viewsMainModuleCollectionContextStore:r,viewsCreationMenuCollectionSettingsStore:l,closeViewsCreationPopup:d}=e,c=(0,s().K8)((()=>l.state.open),[l]),u=(0,i.useCallback)((()=>{d()}),[d]),p=(0,i.useCallback)((()=>(0,m.jsx)(n(434267)._,{context:n(527438).Bd.TopbarFilterPopup,collectionContextStore:r,collectionSettingsStore:l,hideDesktopHeader:!0})),[l,r]);return(0,m.jsx)(n(417392).Ay,{open:c,trapFocus:!0,popupType:a().n.Popup,render:p,originRect:null===(t=o.current)||void 0===t?void 0:t.getBoundingClientRect(),alignmentToOrigin:"center",placementToOrigin:"bottom",enableOutsideClickDismiss:!0,originGap:4,onDismiss:u})}))},971320:(e,t,n)=>{n.d(t,{A:()=>o});class i extends(()=>n(757695))().Store{getInitialState(){return{open:!1}}}const o=new i},973618:(e,t,n)=>{n.r(t),n.d(t,{AiAssistantIntroModal:()=>G,useAssistantIntroModalStyles:()=>Y,useIdleFaceAsset:()=>Q,useSetLastExposedToQnaAtTimestamp:()=>ie});n(581454);var i=n(296540),o=()=>n(484714),s=()=>n(852507),a=()=>n(56366),r=()=>n(401497),l=()=>n(699143),d=()=>n(160432),c=()=>n(218275),u=()=>n(471095),p=()=>n(340498),g=()=>n(69708),m=()=>n(534177),f=()=>n(284371),h=()=>n(352097),v=()=>n(384944),y=()=>n(201938),b=()=>n(577142),S=()=>n(231297),x=()=>n(576590),A=()=>n(140022),M=()=>n(571851),w=()=>n(146535),j=()=>n(737497),k=()=>n(656633);var I=()=>n(581495),C=()=>n(614415),T=()=>n(645873),_=()=>n(300789),P=()=>n(218429),B=()=>n(765957),D=()=>n(430483),R=()=>n(46986),E=()=>n(296798),L=()=>n(509657),O=()=>n(125565),N=()=>n(719147),F=n(474848);const U=24,z=254,K=170,V=(0,g().YK)({shareDataTitle:{defaultMessage:"Youâ€™re in control of your data",id:"AiAssistantWelcomeModal.intro.titleShareData"},shareDataHeader:{defaultMessage:"By default, Notion does not train on your content",id:"AiAssistantWelcomeModal.intro.shareDataHeader"},shareDataDescription:{defaultMessage:"But, if youâ€™d like to help improve our models and features, please opt-in below:",id:"AiAssistantWelcomeModal.intro.shareDataDescription"},welcomeTitle:{defaultMessage:"Meet the new Notion AI",id:"AiAssistantWelcomeModal.intro.title"},subtitle:{defaultMessage:"One AI tool that does it all. Search, generate, analyze, and chatâ€”right inside Notion.",id:"AiAssistantWelcomeModal.intro.subtitle"},findInSlack:{defaultMessage:"Find in Slack",id:"AiAssistantIntroModal.findInSlack"},findInGoogleDrive:{defaultMessage:"Find in Google Drive",id:"AiAssistantIntroModal.findInGoogleDrive"},attachFile:{defaultMessage:"Analyze PDF",id:"AiAssistantIntroModal.attachPDF"}}),q=[{id:h().Fi.searchQnA.id,label:h().Fi.searchQnA,icon:n(207207).J,color:"blue"},{id:h().Fi.chatKeyPoints.id,label:h().Fi.chatKeyPoints,icon:n(202017).n,color:"green"},{id:h().Fi.brainstormIdeas.id,label:h().Fi.brainstormIdeas,icon:n(123411).X,color:"green"},{id:h().Fi.writeCode.id,label:h().Fi.writeCode,icon:n(481721).codeIcon,color:"green"},{id:h().Fi.draftDiagram.id,label:h().Fi.draftDiagram,icon:n(413364).E,color:"purple"},{id:"attachment",label:V.attachFile,icon:n(609616).o},{id:h().Fi.draftTable.id,label:h().Fi.draftTable,icon:n(421559).T,color:"purple"},{id:h().Fi.draftMeetingAgenda.id,label:h().Fi.draftMeetingAgenda,icon:n(105819).pencilLineIcon,color:"purple"},{id:h().Fi.translate.id,label:h().Fi.translate,icon:n(877235).textTranslateIcon,color:"green"},{id:h().Fi.improveWriting.id,label:h().Fi.improveWriting,icon:n(116089).x,color:"purple"},{id:"findInGoogleDrive",label:V.findInGoogleDrive,icon:n(74007).googleDriveIcon},{id:"findInSlack",label:V.findInSlack,icon:n(888382).slackIcon}],W=q.concat(q).concat(q);function G(){const e=(0,o().v3)(),t=(0,i.useCallback)((({source:t})=>{const{currentUserSettingsStore:n}=B().default.state;n&&((0,A().trackAssistantIntroModalClose)(e,{source:t}),(0,x().setAssistantOnboardingPhase)(e,{phase:"tooltip",transactionUserAction:"AiAssistantIntroModal.dismissModal",userSettingsStore:n}),_().a(e,"ai_assistant_announcement"))}),[e]);return ie(),(0,F.jsx)(P().l,{messageKey:"ai_assistant_announcement",desktopRenderInner:()=>(0,F.jsx)(X,{onDismiss:t}),phoneRenderInner:()=>null})}function H(){const e=Y();return(0,F.jsxs)("div",{style:e.rowItemWrapper,children:[(0,F.jsx)("div",{style:e.rowItemIconWrapper,children:(0,u().i)(e.rowItemIcon)}),(0,F.jsxs)("div",{style:e.textWrapper,children:[(0,F.jsx)("div",{style:e.sharedataTitle,children:(0,F.jsx)(g().sA,{...V.shareDataHeader})}),(0,F.jsx)(O().A,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,F.jsx)(g().sA,{...V.shareDataDescription})})]})]})}function Y(){const e=oe();return(0,r().IS)((t=>({...e,rowItemWrapper:{display:"flex",alignItems:"start",marginBottom:12},rowItemIconWrapper:{color:t.palette.uiBlue[600],background:t.palette.uiBlue[100],display:"flex",alignItems:"center",justifyContent:"center",borderRadius:100,marginInlineEnd:8},rowItemIcon:{height:30,width:30,padding:8},sharedataTitle:{fontWeight:f().Wy.medium,fontSize:14,marginBottom:4},textWrapper:{display:"flex",flexDirection:"column",maxWidth:"100%"},icon:{width:16,height:16,marginTop:2},sparklesIcon:{fill:t.palette.translucentGray[800],width:14},contentWrapper:{paddingInlineStart:24,paddingInlineEnd:26,width:424},assistantIntroHeaderWrapper:{height:200},title:{fontSize:25,fontWeight:700,paddingBottom:8},subtitle:{fontSize:f().J.UIRegular.desktop,fontWeight:f().Wy.regular,color:t.text.secondary},body:{fontWeight:400,fontSize:14,color:t.text.secondary},faceImg:{pointerEvents:"none",width:72,height:72,boxShadow:t.shadowSM,borderRadius:100,flexGrow:0},imgWrap:{display:"flex",alignItems:"center",paddingTop:40,paddingBottom:30,paddingInlineStart:24},spacer:{marginTop:20,marginBottom:20},footer:{paddingTop:8,paddingBottom:24,marginTop:20},simpleFooter:{paddingBottom:24},helpTitle:{fontSize:14,fontWeight:600},consentButton:{fontWeight:600,height:"36px"},firstSelector:{fontWeight:400,border:"none"},lastSelector:{fontWeight:400,border:"none"},introAnimationWrapper:{height:294,overflowY:"hidden",maskImage:"linear-gradient(to bottom, rgba(0, 0, 0,0) 24px, rgba(0, 0, 0) 50%, rgba(0,0,0,0) 265px"},introAnimationWrapperLeapStep:{height:140,marginTop:8},faceWrapper:{alignContent:"center",paddingInlineStart:2},faceWrapperLeapStep:{height:"100%",alignContent:"center",paddingInlineStart:2,paddingTop:40,paddingBottom:30},skillListWrapper:{display:"flex",flexDirection:"column",gap:8,marginInlineStart:24,overflowY:"hidden"},pillWrapper:{display:"flex",alignItems:"start",paddingTop:8,paddingInlineEnd:16,paddingBottom:8,paddingInlineStart:12,borderRadius:18,backgroundColor:t.background.tertiaryTranslucent,color:t.text.primary,fontSize:14,flexWrap:"nowrap",fontWeight:f().Wy.medium,gap:8,width:"fit-content"},blue:{color:t.palette.uiBlue[500]},green:{color:t.palette.green[500]},purple:{color:t.palette.purple[500]}})),[e])}function $(e){const{label:t,icon:n,color:i}=e,o=Y(),s=i?o[i]:{},{value:a}=(0,T().fJ)(C().fM);if(!a)return null;const{motion:r}=a;return(0,F.jsxs)(r.div,{style:o.pillWrapper,children:[n({...o.icon,...s}),(0,F.jsx)(g().sA,{...t})]})}function Q(){const e=(0,r().eP)();return(0,i.useMemo)((()=>"dark"===e?w():j()),[e])}function Z(e){const t=Y(),{phase:n}=e,i="welcome"===n,o=Q(),{value:s}=(0,T().fJ)(C().fM);if(!s)return null;const{motion:a}=s;return(0,F.jsx)("div",{style:i?t.introAnimationWrapper:t.introAnimationWrapperLeapStep,children:(0,F.jsxs)(l().Y1,{gap:0,direction:"horizontal",height:"fill",align:i?"center":"center-left",children:[(0,F.jsx)(a.div,{layoutId:"face",style:t.faceWrapper,children:(0,F.jsx)("img",{style:t.faceImg,src:o,alt:"Notion AI logo"})}),(0,F.jsx)(a.div,{initial:{y:45},animate:{y:-45*(q.length-1)},transition:{repeat:1/0,duration:22,ease:"linear"},style:{...t.skillListWrapper,opacity:i?1:0},children:W.map(((e,t)=>(0,F.jsx)($,{label:e.label,icon:e.icon,color:e.color},e.id+t)))})]})})}function J(e){const{environment:t,isAgentEnabled:n}=e,i=D().zD.getNavigationTargetForTryAssistantNowButton();switch(i){case"fullPage":(0,b().navigate)({environment:t,url:"/chat"});break;case"corner":n&&M().agentActions.openNewAgentSidebarFromMainBlock({environment:t,primeTextInput:"Ask me anything"});break;case"writer":y().f({environment:t,prefill:void 0});break;default:(0,m().HB)(i)}}function X(e){const{onDismiss:t}=e,n=(0,o().v3)(),[s,r]=(0,i.useState)("welcome"),c=(0,a().K8)((()=>{const e=B().default.state.sidebarSpaceStore,t=B().default.state.sidebarSpaceViewStore;return!(!e||!t)&&function(e){var t;const{environment:n,assistantFeatureGateStore:i,currentSpaceViewStore:o,currentSpaceStore:s}=e;return!(!o||!s)&&!!s.canAdmin()&&!(0,k().vp)(n,s.id)&&!Boolean(null===(t=o.getSettings())||void 0===t?void 0:t.has_user_seen_leap_modal)&&!Boolean(s.getSettings().enable_ai_training)&&i.isWorkspaceLeapEligible()}({environment:n,assistantFeatureGateStore:D().zD,currentSpaceStore:e,currentSpaceViewStore:t})}),[n]),u=(0,R().i7)(),p=(0,i.useCallback)((()=>{c?r("leap"):((0,A().trackAssistantIntroModalTryNow)(n,{}),t({source:"tryNow"}),J({environment:n,isAgentEnabled:u}))}),[c,n,t,u]),m=(0,i.useCallback)((()=>{if(t({source:"closeButton"}),c){const e=B().default.state.sidebarSpaceViewStore;if(!e)return;S().createAndCommit({userAction:"AiAssistantIntroModal.updateLeapModalSeen",environment:n,canUndo:!0,perform:t=>{S().applyOperation({store:e,operation:{pointer:e.pointer,path:["settings"],command:"update",args:{...e.getSettings(),has_user_seen_leap_modal:!0}},transaction:t})}})}}),[t,c,n]),f=(0,i.useCallback)((()=>{M().assistantAnalyticsActions.trackLeapDismissed(n),m()}),[n,m]);(0,i.useEffect)((()=>{const e=Date.now();return()=>{const t=Date.now();(0,A().trackAssistantIntroModalRead)(n,{reading_time:t-e})}}),[]);const h=Y(),v=(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(Z,{phase:"welcome"}),(0,F.jsx)("div",{style:h.title,children:(0,F.jsx)(g().sA,{...V.welcomeTitle})}),(0,F.jsx)("div",{style:h.subtitle,children:(0,F.jsx)(g().sA,{...V.subtitle})}),(0,F.jsxs)(l().Y1,{align:"center",direction:"horizontal",gap:"auto",style:h.footer,children:[(0,F.jsx)(ne,{}),(0,F.jsx)(l().Y1,{align:"center-right",direction:"horizontal",gap:12,width:"hug",children:(0,F.jsx)(d().A,{size:"xl",onClick:p,children:(0,F.jsx)(g().sA,{defaultMessage:"Try it",id:"AssistantIntroMessage.intro.signup.nextMessage"})})})]})]});return(0,F.jsxs)("div",{children:[(0,F.jsx)(I().Rz,{onDismiss:m}),(0,F.jsx)(l().Y1,{gap:0,children:(0,F.jsx)("div",{style:h.contentWrapper,children:"leap"===s?(0,F.jsx)(ee,{onDismiss:f}):v})})]})}function ee(e){const{onDismiss:t}=e,[n,a]=(0,i.useState)(),c=void 0===n,u=(0,o().v3)(),p=(0,i.useCallback)((e=>{a(e),M().assistantAnalyticsActions.trackLeapPreferenceSelect(u,{will_share:e})}),[u]),f=(0,i.useCallback)((e=>{const t=B().default.state.sidebarSpaceStore;t&&S().createAndCommit({userAction:"AiAssistantIntroModal.updateWorkspaceShouldTrain",environment:u,canUndo:!0,perform:n=>{v().zv({store:t,data:{settings:{...t.getSettings(),enable_ai_training:e}},transaction:n})}})}),[u]),h=(0,R().i7)(),y=(0,i.useCallback)((()=>{(0,m().O9)(n)&&(f(n),M().assistantAnalyticsActions.trackLeapSubmit(u,{will_share:n})),t(),J({environment:u,isAgentEnabled:h})}),[u,t,n,f,h]);(0,s().l)((()=>{M().assistantAnalyticsActions.trackLeapPresented(u)}));const b=Y(),x=(0,r().IS)((()=>({...b,titleLeap:{marginBottom:12}})),[b]);return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(Z,{phase:"leap"}),(0,F.jsx)("div",{style:{...x.title,...x.titleLeap},children:(0,F.jsx)(g().sA,{...V.shareDataTitle})}),(0,F.jsx)(H,{}),(0,F.jsxs)(l().Y1,{direction:"vertical",children:[(0,F.jsx)(L().a,{style:x.firstSelector,label:(0,F.jsx)(g().sA,{defaultMessage:"Share data to help improve Notion AI",id:"AiAssistantWelcomeModal.admin.shareData"}),onChange:()=>{},isSelected:!0===n,onClick:()=>p(!0),value:"share_data",selectType:"radio"}),(0,F.jsx)(L().a,{style:x.lastSelector,label:(0,F.jsx)(g().sA,{defaultMessage:"Do not share data",id:"AiAssistantWelcomeModal.admin.doNotShareData"}),onChange:()=>{},selectType:"radio",isSelected:!1===n,onClick:()=>p(!1),value:"do_not_share_data"})]}),(0,F.jsxs)(l().Y1,{align:"center",direction:"horizontal",gap:"auto",style:x.footer,children:[(0,F.jsx)(te,{}),(0,F.jsx)(l().Y1,{align:"center-right",direction:"horizontal",gap:12,width:"hug",children:(0,F.jsx)(d().A,{size:"xl",onClick:y,disabled:c,children:(0,F.jsx)(g().sA,{defaultMessage:"Confirm",id:"AssistantIntroMessage.intro.signup.confirmMessage"})})})]})]})}function te(){const e=(0,r().DP)(),t=(0,o().v3)(),n=(0,i.useCallback)((e=>{M().assistantAnalyticsActions.trackLeapLinkClick(t,{link:e})}),[t]);return(0,F.jsx)("div",{style:{color:e.text.secondary,fontSize:12,width:256},children:(0,F.jsx)("div",{children:(0,F.jsx)(g().sA,{defaultMessage:"If you choose to share data, you are agreeing to these <terms>Terms</terms>. <learnmore>Learn more</learnmore>",id:"AiAssistantIntroModal.AdminAgreeToTerms",values:{terms:e=>(0,F.jsx)(N().A,{onClick:()=>n("terms"),external:!0,href:"https://www.notion.so/notion/Notion-AI-Learning-and-Early-Access-Program-Terms-0c55d702d0154a788d9e70c4ee396399",children:e}),learnmore:e=>(0,F.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:"2px"},children:[(0,F.jsx)(N().A,{onClick:()=>n("faq"),external:!0,href:"https://www.notion.so/help/notion-ai-leap-program-faqs",children:e}),(0,c().arrowUpRightSquareSmallIcon)({width:p().Ev.sm,height:p().Ev.sm})]})}})})})}function ne(){const e=oe(),t=(0,o().v3)(),n=(0,i.useCallback)((()=>{(0,A().trackLearnMoreAboutAssistantClicked)(t,{})}),[t]);return(0,F.jsx)("div",{style:e.learnMoreCopy,children:(0,F.jsxs)(E().A,{onClick:n,style:e.learnMoreLink,innerStyle:e.learnMoreLinkInner,href:"https://www.notion.so/help/guides/everything-you-can-do-with-notion-ai",external:!0,children:[(0,F.jsx)(g().sA,{defaultMessage:"Learn more",id:"AiAssistantIntroModal.LearnMoreAboutAssistantButton"}),(0,c().arrowUpRightSquareSmallIcon)({width:p().Ev.sm,height:p().Ev.sm,marginTop:2,marginInlineStart:4})]})})}function ie(){const e=(0,i.useRef)(!1),t=(0,o().v3)();(0,a().K8)((()=>{const{currentUserSettingsStore:n}=B().default.state;if(!n||!n.isReady())return;if(!D().zD.showRemindersToUseQnA())return;const i=n.getSettingsStore().getKeyStore("last_exposed_to_ai_qna_at").getValue();(0,m().O9)(i)||e.current||(e.current=!0,(0,x().setLastExposedToQnaAtToCurrentTimestamp)(t,{userSettingsStore:n}))}),[t])}function oe(){return(0,r().IS)((e=>({betaBadge:{borderRadius:4,display:"inline-block",fontSize:11,fontWeight:500,padding:"1px 4px"},importDisclaimerWrap:{marginTop:10,display:"flex",alignItems:"center",gap:2},clockIcon:{width:14,height:14,color:e.text.secondary},footer:{borderTop:`1px solid ${e.tableLightDividerColor}`},introCopyArea:{paddingInlineStart:U,paddingInlineEnd:U},introTitle:{fontWeight:f().Wy.bold,fontSize:25,display:"flex"},learnMoreCopy:{color:e.text.secondary,fontSize:12,textDecoration:"underline"},learnMoreLink:{width:"max-content",marginInlineStart:-4},learnMoreLinkInner:{display:"flex",alignItems:"center",paddingInlineStart:4,paddingInlineEnd:4},mainCopyText:{width:350},notionAiText:{marginTop:2,paddingInlineStart:4,color:e.palette.gray[900],fontWeight:f().Wy.medium},sparklesIcon:{width:14},stubPng:{width:"100%",height:z},smallVariantVideoStubPng:{width:"100%",height:K}})),[])}},976644:(e,t,n)=>{n.d(t,{o:()=>B});n(581454);var i=n(296540),o=()=>n(484714),s=()=>n(56366),a=()=>n(401497),r=()=>n(729108),l=()=>n(858141),d=()=>n(69708),c=()=>n(496603),u=()=>n(10521),p=()=>n(575143),g=()=>n(187820),m=()=>n(89924),f=()=>n(21140),h=()=>n(625247),v=()=>n(665381),y=(n(898992),n(354520),()=>n(564884)),b=()=>n(482083),S=()=>n(72234),x=()=>n(231297),A=()=>n(755199),M=()=>n(272509),w=()=>n(765957),j=(n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(803949),()=>n(977863)),k=()=>n(802059);function I(e){const{environment:t,previousOrder:n,currentFilterState:i,currentUserSettingsStore:o}=e,s=function(e){const{environment:t,spaceIds:n,userSettingsStore:i}=e,o=(0,k().B)(),s=n?o.filter((e=>n.includes(e.getSpaceId()))):o,a=new Map;return s.forEach((e=>{const n=e.getSpaceId();(0,j().c)(t,e,i).forEach((e=>{a.set(e.id,n)}))})),a}({environment:t,spaceIds:"all"===i.type?void 0:i.space_pointers,userSettingsStore:o}),a=new Set(s.keys());if(!n||0===n.length)return Array.from(a);const r=n.filter((e=>a.has(e))),l=new Set(r),d=Array.from(a).filter((e=>!l.has(e)));return[...r,...d]}function C(e){const{environment:t,currentState:n}=e,{currentUserSettingsStore:i,sidebarSpaceViewStore:o,sidebarSpaceStore:s}=w().default.state,a=(0,M().I)(s);let r;var l;if(a&&i)r=null===(l=i.getSettings())||void 0===l||null===(l=l.external_pages_settings)||void 0===l?void 0:l.manual_sort_order;else if(o){var d;r=null===(d=o.getSettings())||void 0===d||null===(d=d.external_pages_settings)||void 0===d?void 0:d.manual_sort_order}const c=I({environment:t,previousOrder:r,currentFilterState:n,currentUserSettingsStore:i});x().createAndCommit({userAction:"workspaceFilterActions.handleUpdateWorkspaceFilter",environment:t,canUndo:!0,perform:e=>{const t={external_pages_settings:{last_filter_state:n,last_updated_at:Date.now(),manual_sort_order:c}};var o;a&&i?A().mJ({transaction:e,userSettingsStore:i,data:{external_pages_settings:{...t.external_pages_settings,shared_sidebar_section_menu_config:{...b().t,...(null===(o=i.getSettings())||void 0===o||null===(o=o.external_pages_settings)||void 0===o?void 0:o.shared_sidebar_section_menu_config)??{}}}}}):w().default.state.sidebarSpaceViewStore&&S().AG(w().default.state.sidebarSpaceViewStore,e,t)}}),(0,y().u)({event:{eventName:"cross_workspace_filter_updated",eventProperties:{space_id:null==s?void 0:s.getSpaceId()}},environment:t})}var T=()=>n(172339),_=n(474848);const P=(0,d().YK)({filterWorkspace:{id:"secondarySidebar.workspaceFilterMenu.checkboxLabel",defaultMessage:"Filter workspace"}});function B(){const e=(0,o().v3)(),t=(0,T().g)(),n=(0,s().K8)((()=>!t||"all"===t.type),[t]),r=(0,s().K8)((()=>(0,k().B)()),[]),g=(0,i.useCallback)((()=>{!function(e){const{state:t,environment:n,spaceViewStores:i}=e,o=t?{...t}:void 0,s="all"!==(null==o?void 0:o.type);C({environment:n,currentState:{type:s?"all":"selection",space_pointers:s?i.map((e=>e.getSpaceId())):[]}})}({state:t,environment:e,spaceViewStores:r})}),[e,t,r]),f=(0,i.useCallback)((n=>{!function(e){const{state:t,environment:n,spaceId:i,spaceViewStores:o}=e,s=t?{...t}:void 0,a=s&&"all"!==s.type?s.space_pointers:o.map((e=>e.getSpaceId()));let r=[];r=null!=a&&a.includes(i)?a.filter((e=>e!==i)):[...a??[],i],C({environment:n,currentState:{type:r.length===o.length?"all":"selection",space_pointers:r}})}({state:t,environment:e,spaceId:n,spaceViewStores:r})}),[e,t,r]),y=(0,a().IS)((e=>({gridIcon:{height:20,width:20,color:e.icon.secondary},item:{height:28,marginTop:2,marginBottom:2}})),[]),b=(0,u().Ls)({key:"all-spaces",displayName:void 0,analyticsName:"all-spaces",validators:[],closeParentMenu:!0,action:async()=>{},render:e=>(0,_.jsx)(p().A,{...e,style:y.item,left:(0,_.jsx)(D,{icon:(0,l().squareGrid2X2Icon)(y.gridIcon),spaceName:void 0,spaceIcon:void 0,checked:n,onClick:e=>{e.stopPropagation(),g()}}),title:(0,_.jsx)(d().sA,{id:"secondarySidebar.workspaceFilterMenu.allSpaces",defaultMessage:"All workspaces"}),onClick:e=>{e.stopPropagation(),g()}})}),S=(0,s().K8)((()=>{const i=(null==t?void 0:t.space_pointers)??[];return(0,c().oE)(r.map((t=>{const o=t.getSpaceStore();if(!o)return;const s=o.id,a=(0,v().G)(e,o),r=(0,h().c)(e,o),l=i.includes(s)||n;return(0,u().Ls)({key:s,displayName:void 0,analyticsName:s,validators:[],closeParentMenu:!0,action:async()=>{},render:e=>(0,_.jsx)(p().A,{...e,style:y.item,left:(0,_.jsx)(D,{icon:void 0,spaceName:a,spaceIcon:r,checked:l,onClick:e=>{e.stopPropagation(),f(s)}}),title:a,onClick:e=>{e.stopPropagation(),f(s)}})})})))}),[e,r,f,t,n,y.item]);return[(0,u().gy)({key:"workspaceFilterAll",render:e=>(0,_.jsx)(m().A,{...e}),actions:[b]}),(0,u().gy)({key:"workspaceFilterSpaces",render:e=>(0,_.jsx)(m().A,{...e}),actions:S})]}function D(e){const{icon:t,spaceName:n,spaceIcon:i,checked:o,onClick:s}=e,a=(0,d().tz)();return(0,_.jsxs)(f().Ye,{alignItems:"center",justifyContent:"center",gap:8,children:[(0,_.jsx)(r().S,{checked:o,size:14,onClick:s,"aria-label":a.formatMessage(P.filterWorkspace)}),t||(0,_.jsx)(g().B6,{icon:i,isEmptyPage:!1,title:n,size:22,disabled:!0})]})}},978578:(e,t,n)=>{n.d(t,{MS:()=>r,aD:()=>a,bu:()=>s,uO:()=>o,uZ:()=>l});var i=()=>n(911988);function o(e=!0,t=!1){return{flex:1,marginInlineStart:e?0:8,overflow:"hidden",marginInlineEnd:t?16:8,whiteSpace:"nowrap",height:"100%",minWidth:0,maxWidth:"100%",textOverflow:"ellipsis"}}const s=36;function a(e){return{iconStyle:{height:26,width:26,fill:e.icon.primary},iconContainer:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",marginInlineEnd:14,color:e.icon.secondary,width:26},redesignedIconStyle:{height:24,width:24,fill:e.icon.primary},redesignedCircleIconContainer:{background:e.background.primary,color:e.icon.primary,display:"inline-flex",justifyContent:"center",alignItems:"center",borderRadius:18,width:s,height:s},redesignedCoverPhotoIconContainer:{background:e.background.primary,color:e.icon.primary,display:"inline-flex",justifyContent:"center",alignItems:"center",borderRadius:18,width:s,height:s,boxShadow:"0px 2px 4px -1px rgba(0, 0, 0, 0.06), 0px 14px 28px -6px rgba(0, 0, 0, 0.10)"}}}function r(e){const{WindowSizeStore:t}=e;return{marginTop:t.state.paddingTop,paddingInlineStart:t.getSafePaddingLeftPx(0),paddingInlineEnd:t.getSafePaddingRightPx(0)}}function l(e,t=i().s1,n=!0){const o=1/(window.devicePixelRatio||1);return{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",maxWidth:"100%",height:t,boxShadow:n?`0 ${o}px 0 ${e.regularDividerColor}`:"none",background:e.background.primary,transition:"box-shadow 300ms",WebkitUserSelect:"none",cursor:"pointer"}}},980427:(e,t,n)=>{n.d(t,{V:()=>s});var i=()=>n(564884),o=()=>n(242422);function s(e,t){(0,i().u)({environment:e,event:{eventName:"open_import_contacts_dropdown",eventProperties:{source:t.source}}}),o().default.logEvent("open_import_contacts_dropdown",void 0,{metadata:t})}},989184:(e,t,n)=>{n.d(t,{Z:()=>o});n(296540);const i={viewBox:"0 0 16 16",fittedViewBox:"2.85 1.57 9.98 12.06",directional:!0,svg:(0,n(474848).jsx)("path",{d:"M7.442 1.758a.625.625 0 0 0-.884 0l-3.52 3.52a.625.625 0 1 0 .884.884l2.453-2.453V11.8c0 1.008.817 1.825 1.825 1.825h4a.625.625 0 1 0 0-1.25h-4a.575.575 0 0 1-.575-.575V3.709l2.453 2.453a.625.625 0 0 0 .884-.884z"})},o=(0,n(340498).wt)("arrowTurnLeftUpSmall",i)},992757:(e,t,n)=>{n.r(t),n.d(t,{default:()=>D});var i=n(296540),o=()=>n(312788),s=()=>n(484714),a=()=>n(56366),r=()=>n(401497),l=()=>n(729108),d=()=>n(97294),c=()=>n(631524),u=()=>n(160432),p=()=>n(591779),g=()=>n(340498),m=n(474848);const f={viewBox:"0 0 16 16",fittedViewBox:"1.07 2.82 13.83 10.36",svg:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("path",{d:"M8.18 5.25a.5.5 0 0 1 .5.5v3.623l1.127-1.127a.5.5 0 0 1 .707.707l-2 2a.5.5 0 0 1-.63.065l-.077-.065-2-2a.5.5 0 0 1 .707-.707L7.68 9.412V5.75a.5.5 0 0 1 .5-.5"}),(0,m.jsx)("path",{d:"M8.35 2.825a5.173 5.173 0 0 1 5.172 5.051 2.856 2.856 0 0 1-1.477 5.299l-.032-.001H4.018a.8.8 0 0 1-.189-.025 3.134 3.134 0 0 1-.566-6.098A5.176 5.176 0 0 1 8.35 2.826m3.85 10.318.005-.001.012-.005zm-.379-1.19-.039.012.031-.01.034-.01zm-3.47-7.878a3.926 3.926 0 0 0-3.908 3.543l-.047.484-.478.074a1.886 1.886 0 0 0 .1 3.739l.086.009h7.88l.018-.001h.05a1.605 1.605 0 0 0 1.59-1.44l.008-.164c0-.67-.41-1.245-.995-1.486l-.41-.169.024-.443q.006-.115.006-.221c0-2.1-1.649-3.814-3.722-3.92z"})]})},h=(0,g().wt)("cloudArrowDownSmall",f);var v=()=>n(995847),y=()=>n(651784),b=()=>n(69708),S=()=>n(284371),x=()=>n(579631),A=()=>n(767877),M=()=>n(778450),w=()=>n(597755),j=()=>n(112799),k=()=>n(346),I=()=>n(567121),C=()=>n(765957),T=()=>n(927080),_=()=>n(285790),P=()=>n(417392),B=()=>n(125565);function D(){const{navigate:e}=(0,i.useContext)(o().E),t=(0,s().v3)(),n=(0,b().tz)(),[f,D]=(0,i.useState)(!0),{isDesktopBrowser:R,os:E}=(0,s().Y0)(),L=(0,a().K8)((()=>t.RouterStore.state.route.name in y().b1),[t]),O=(0,a().K8)((()=>C().default.state.inAppCalloutStore),[]),N=(0,a().K8)((()=>O.getCalloutVisibility("desktop_preference_popup").canShow),[O]),F=t.currentUser.isLoggedIn(),U=(0,a().O$)(T().A),[z,K]=(0,i.useState)(!1),V=(0,a().K8)((()=>T().A.canPersistToLocalStorage()),[]),q=!z&&F&&void 0===U&&R&&("mac"===E||"windows"===E)&&L&&V&&N,[W,G]=(0,i.useState)(!1),H=q&&W,Y=(0,i.useRef)(!1);(0,i.useEffect)((()=>{q&&!Y.current&&((0,M().e)(t).then((e=>{G(e)})),Y.current=!0)}),[q,G,t,E]);const $=(0,p().ZC)(H);(0,i.useEffect)((()=>{H&&!$&&(x()._g(t),O.updateCalloutStatus({calloutId:"desktop_preference_popup",visible:!0,validateCanShow:!0}))}),[H,$,t,O]);const Q=(0,k().n_)(),Z=(0,j().E)(),J=(0,r().IS)((()=>({origin:{position:"fixed",insetInlineStart:"50%",top:"100%"},container:{bottom:20,padding:"8px 12px 12px",minWidth:300},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},headerText:{fontSize:14,fontWeight:S().Wy.medium},appDownloadButton:{marginInlineStart:-5},actions:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:6},alwaysOpenLinks:{display:"flex",alignItems:"center"},alwaysOpenLinksLabel:{marginInlineStart:6},alwaysOpenLinksButton:{paddingInlineStart:12,paddingInlineEnd:12,height:34,marginInlineStart:12}})),[]);return(0,m.jsx)(P().Ay,{popupType:P().nl.Popup,placementToOrigin:"bottom",alignmentToOrigin:"center",origin:(0,m.jsx)("div",{style:J.origin}),originGap:Q?-I().ls/2:0,disableMouseCapture:!0,open:H,style:J.container,render:()=>(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{style:J.header,children:[(0,m.jsx)(B().A,{style:J.headerText,children:(0,m.jsx)(b().sA,{id:"openInDesktopAppPopup.header",defaultMessage:"Open in Notionâ€™s desktop app?"})}),(0,m.jsx)(_().A,{ariaLabel:n.formatMessage({id:"openInDesktopAppPopup.closeButton",defaultMessage:"Dismiss"}),icon:v().xMarkSmallIcon,iconStyle:{width:g().Ev.sm,height:g().Ev.sm},onClick:()=>{T().A.setState("never"),K(!0),x().e1(t)}})]}),(0,m.jsx)(d().N,{external:!0,onClick:()=>{Z.current&&(e({environment:t,url:Z.current,openInNew:"tab"}),x().co(t))},children:(0,m.jsx)(c().p,{colorPalette:"gray",size:"sm",style:J.appDownloadButton,iconLeading:h,children:(0,m.jsx)("span",{children:(0,m.jsx)(b().sA,{id:"openInDesktopAppPopup.appDownloadButton",defaultMessage:"Donâ€™t have the app? Download"})})})}),(0,m.jsxs)("div",{style:J.actions,children:[(0,m.jsxs)("div",{style:J.alwaysOpenLinks,children:[(0,m.jsx)(l().S,{checked:f,size:16,onClick:()=>{D(!f)}}),(0,m.jsx)(B().A,{isInline:!0,style:J.alwaysOpenLinksLabel,children:(0,m.jsx)(b().sA,{id:"openInDesktopAppPopup.alwaysOpenLinksLabel",defaultMessage:"Always open in app",values:{strongtext:e=>(0,m.jsx)("strong",{children:e})}})})]}),(0,m.jsx)(u().A,{colorPalette:"blue",style:J.alwaysOpenLinksButton,onClick:()=>{T().A.setState(f?"always":"never"),K(!0),(0,A().e)({url:(0,w().P)(window.location.href),environment:t}),x().SS(t,{always_open_in_app:f})},children:(0,m.jsx)(b().sA,{id:"openInDesktopAppPopup.openInAppButton",defaultMessage:"Open in app",values:{strongtext:e=>(0,m.jsx)("strong",{children:e})}})})]})]}),onClosed:()=>{O.updateCalloutStatus({calloutId:"desktop_preference_popup",visible:!1})}})}},996594:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M,getSpaceViewMenuItems:()=>w});n(944114),n(296540);var i=()=>n(484714),o=()=>n(56366),s=()=>n(30537),a=()=>n(69708),r=()=>n(394893),l=(n(898992),n(354520),()=>n(496603));var d=()=>n(722872),c=()=>n(625247),u=()=>n(665381),p=()=>n(181405),g=()=>n(765957),m=()=>n(520257),f=()=>n(405269),h=()=>n(760217),v=()=>n(404277),y=()=>n(939740),b=()=>n(45552),S=()=>n(187820),x=()=>n(89924),A=n(474848);const M=function(){const e=(0,i().v3)(),{device:t}=e,a=(0,o().O$)(m().A);return(0,A.jsx)(n(417392).Ay,{popupType:t.isMobile?s().n.SlideUp:s().n.Popup,open:a.open,render:()=>(0,A.jsx)(j,{}),originGap:8,onDismiss:r().Ew,originRect:a.originRect,enableRounding:!0})};function w(e,t){const{device:n}=e,{currentUserRootStore:i}=g().default.state;if(!i)return[];const{editableStores:o}=function(e){const t=l().hS(e.getSpaceViewStores(),(e=>e.getSpaceId())),n=t.filter((e=>{const t=e.getSpaceStore();return e.isReady()&&(null==t?void 0:t.isReady())})),i=n.filter((e=>{const t=e.getSpaceStore();return e.isReady()&&(null==t?void 0:t.isReady())&&t.canEdit()}));return{total:t.length,loaded:n.length,editable:i.length,editableStores:i}}(i),s=[];for(const a of o){const i=a.getSpaceStore();if(null!=i&&i.isReady()&&i.canEdit()){const o=(0,u().G)(e,i),r=(0,c().c)(e,i);s.push({key:a.id,action:async()=>{await(0,f().CI)({environment:e,blockStore:t,spaceStore:i,spaceViewStore:a})},render:e=>(0,A.jsx)(h().A,{title:o,icon:(0,A.jsx)(S().B6,{icon:r,iconRecordCategory:"workspace",isEmptyPage:!1,title:o,size:n.isMobile?24:20,disabled:!0}),...e})})}}return s}function j(){const e=(0,i().v3)(),{device:t}=e,n=(0,o().O$)(m().A),s=(0,o().K8)((()=>g().default.state.currentUserRootStore),[]),l=(0,o().K8)((()=>n.store?w(e,n.store):[]),[e,n]);if(!n.open||!s)return null;const c=[{key:"spaces",render:e=>(0,A.jsx)(x().A,{title:t.isMobile?void 0:(0,A.jsx)(a().sA,{defaultMessage:"Choose a workspace",id:"duplicatePagePopup.chooseWorkspace.menuItem.title"}),...e}),items:l},{key:"logout",render:e=>(0,A.jsx)(x().A,{...e,topBorder:!0}),items:[{key:"logout",action:()=>p().ri(e),render:e=>(0,A.jsx)(k,{...e})}]}];let u;return u=t.isMobile?{menuType:d().gu.Modal,title:(0,A.jsx)(a().sA,{defaultMessage:"Choose a workspace",id:"duplicatePagePopup.choooseWorkspaceMobileMenu.title"}),right:(0,A.jsx)(b().CancelMenuText,{}),onClickRight:r().Ew}:{menuType:d().gu.Popup},(0,A.jsx)(v().A,{...u,children:(0,A.jsx)(y().Ay,{type:y().Oh.Vertical,sections:c,initialFocus:1})})}function k(e){const t=(0,o().K8)((()=>{const{currentUserStore:e}=g().default.state;return(null==e?void 0:e.getEmail())||""}),[]);return(0,A.jsx)(h().A,{caption:(0,A.jsx)(a().sA,{defaultMessage:"Log out ({email})",id:"duplicatePagePopup.buttonMenuItem.logoutButton.label",values:{email:t}}),...e})}}}]);