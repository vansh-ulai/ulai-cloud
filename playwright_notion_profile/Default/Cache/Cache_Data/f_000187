"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[34974,63717],{94522:(e,t,i)=>{i.d(t,{Cq:()=>r,dh:()=>o});i(16280),i(898992),i(354520);var n=()=>i(915671);function o(e){var t;return(null===(t=e.getModel())||void 0===t?void 0:t.getData())||(0,n().bZ)()}function r(e){const{workflowPointer:t,threadPointer:i}=e,n=t??i;if(!n)throw new Error("No workflow definition pointer found");return n}},158244:(e,t,i)=>{i.r(t),i.d(t,{collectMentionUserIds:()=>f,fetchExtendedUserProfile:()=>m,prefetchExtendedUserProfiles:()=>g,prefetchMentionedUserProfiles:()=>h});i(944114),i(517642),i(658004),i(733853),i(845876),i(432475),i(515024),i(731698),i(898992),i(354520),i(672577);var n=()=>i(929219),o=()=>i(351776),r=()=>i(798880),s=()=>i(201980),a=()=>i(496603),l=()=>i(498212),d=()=>i(559506),c=()=>i(646736),u=()=>i(683e3);const p=10;async function m(e){const{viewedUserId:t,actorUserId:i,spaceStore:n,store:r,environment:s}=e;if(!r.isRefetchThrottleReady())return;const l=(0,c().dp)(n,t),p=(0,c().dp)(n,i);if(!(0,o().$)(l.getMembershipType())||!(0,o().n)(p.getMembershipType()))return;const m=await d().callApi({eventName:"getExtendedUserProfiles",environment:s,data:{userIds:[t],spaceId:n.id}});if("failed"===m.type)throw m.error;m.type;const g=(0,u().ed)(m.data).find((e=>e.userId===t));g&&((0,a().n4)(g,r.state)||r.setState(g))}const g=(0,i(782007).S)((async function(e,t){const{spaceStore:i,actorUserId:n}=e,r=i.id,s=e.viewedUserIds.filter((e=>!(0,u().Of)({spaceId:r,actorUserId:n,viewedUserId:e})));if(0===s.length)return;const l=(0,c().dp)(i,n);if(!(0,o().n)(l.getMembershipType()))return;const p=await d().callApi({environment:t,eventName:"getExtendedUserProfiles",data:{spaceId:r,userIds:s}});if("failed"===p.type)return;for(const o of(0,u().ed)(p.data)){const e=(0,u().e9)({spaceId:r,actorUserId:n,viewedUserId:o.userId});(0,a().n4)(o,e.state)||e.setState(o)}}),(([e,t],[n,o])=>{if(e.spaceStore.id!==n.spaceStore.id||e.actorUserId!==n.actorUserId||!Object.is(t,o))return!1;return[{...e,viewedUserIds:(0,i(806080).sb)([...e.viewedUserIds,...n.viewedUserIds]).slice(0,i(571595).sD)},o]}),1e3,{maxWait:3e3});function f(e,t){const i=new Set,n=[e];function o(e){l().w7.includes(e)||i.add(e)}function a(e){e.table===r().oo&&o(e.id)}let d=0;e:for(;n.length>0&&i.size<t&&d<100;){d+=1;const r=n.pop();if(!r.isDefined())continue;for(const e of(0,s().Fbh)(r.getTitleValue()))if(o(e),i.size>=t)break e;if(r===e){const e=r.getCreatedByPointer();if(e&&a(e),i.size>=t)break e;const n=r.getLastEditedByPointer();if(n&&a(n),i.size>=t)break e}const l=r.getProperties();for(const e of Object.keys(l)){const n=l[e];if(n)for(const e of(0,s().Fbh)(n))if(o(e),i.size>=t)break e}for(const e of r.getDiscussionStores())for(const n of e.getCommentStores()){const e=n.getCreatedByPointer();if(e&&a(e),i.size>=t)break e;for(const r of(0,s().Fbh)(n.getText()))if(o(r),i.size>=t)break e}const c=r.getRenderableContentStores();for(let e=c.length-1;e>=0;e--){const t=c[e];t.isNavigableBlock()||n.push(t)}}return Array.from(i)}function h(e,t){if(!n().e.state)return;const i=e.getSpaceStore();if(!i||!i.id||!i.userId)return;const o=f(e,p);0!==o.length&&g({spaceStore:i,actorUserId:i.userId,viewedUserIds:o},t)}},275239:(e,t,i)=>{i.d(t,{h:()=>s,l:()=>l});i(517642),i(658004),i(733853),i(845876),i(432475),i(515024),i(731698);var n=i(296540),o=()=>i(406792);const r=new Set;function s(e,t){const i=(0,n.useMemo)((()=>o().default.DO_NOT_USE_markLegacy(e)),[e]),s=(0,n.useRef)(t);(0,n.useEffect)((()=>{s.current=t}),[t]);return(0,n.useCallback)((()=>{r.has(e)&&!t.allowMultipleFiresPerSession||(r.add(e),o().default.DO_NOT_USE_measureLegacy(i,s.current))}),[i,e,t.allowMultipleFiresPerSession])}const a=new Set;function l(e,t){const i=(0,n.useRef)(t);(0,n.useEffect)((()=>{i.current=t}),[t]);return(0,n.useCallback)((()=>{a.has(e)||(a.add(e),o().default.DO_NOT_USE_measureFromPageOriginLegacy(e,i.current))}),[e])}},464412:(e,t,i)=>{i.d(t,{X:()=>l});var n=()=>i(59226),o=()=>i(56366),r=()=>i(686070),s=()=>i(583238),a=()=>i(765957);function l(){const e=(0,o().K8)((()=>(0,s().mX)()),[]),t=(0,o().K8)((()=>a().default.state.sidebarSpaceStore&&(0,r().d)({spaceStore:a().default.state.sidebarSpaceStore})),[]),i=(0,n().X)("notion_calendar_launch_modal");return e||t||!i}},487808:(e,t,i)=>{i.r(t),i.d(t,{ExternalObjectInstanceBlockMenu:()=>k});i(944114),i(898992),i(672577);var n=i(296540),o=()=>i(484714),r=()=>i(56366),s=()=>i(929219),a=()=>i(617871),l=()=>i(519143),d=()=>i(3284),c=()=>i(824862),u=()=>i(69708),p=()=>i(534177),m=()=>i(21727),g=()=>i(953448),f=()=>i(231297),h=()=>i(949237),v=()=>i(722872),y=()=>i(53137),x=()=>i(575143),S=()=>i(404277),b=()=>i(939740),j=()=>i(89924),I=i(474848);function k(e){const{titleForReloadMenuOption:t,store:i,parentBlockStore:k,onAccept:w,onDismiss:A,extraSecondaryItemKey:C,token:B}=e,M=(0,o().v3)(),T=(0,g().J)(),R=(0,n.useCallback)((e=>{const t={blocks:[i],environment:M,publicEditMode:void 0,analyticsFrom:"external_object_instance_block_menu",lazyDependencies:T};return{key:e.key,render:(i,n)=>e.render(i,t,{onAccept:w,onFocus:n.onFocus}),action:({event:i})=>e.action(t,i)}}),[i,M,T,w]),D=(0,r().K8)((()=>{const e=i.getFormat().bot_id,t=y().A.getBotsAsRecordMap();if(e&&!0===y().A.state.loaded){const i=t.getValue({table:c().GP,id:e});if(i&&i.integration_id&&i.integration_id===a().ob)return!1}if(e&&!0===y().A.state.loaded){if(!y().A.externalAuthentications.state.find((({id:t})=>e===t)))return!1}return!0}),[i]),U=[],_=!(0,r().O$)(s().e);D&&U.push({key:0,render:e=>(0,I.jsx)(j().A,{...e,style:{paddingTop:0,paddingBottom:0}}),items:[{key:"reload external instance object",render:e=>(0,I.jsx)(x().A,{...e,title:t,svg:l().D,disabled:_,style:_?{opacity:.4}:void 0,tooltipText:_?(0,I.jsx)(u().sA,{id:"externalObjectInstanceBlockMenu.reload.offlineTooltip",defaultMessage:"Unavailable while offline"}):void 0}),action:()=>{i&&(i.isExternalObjectInstanceBlockStore()||i.isExternalObjectInstancePageBlockStore())&&h().lf({environment:M,from:"page_more_menu",store:i,spaceId:i.getSpaceId()})}}]});const E=(0,r().K8)((()=>{switch(C){case"preview_to_mention":return[R(m().oq)];case"mention_to_preview":if(!i.isExternalObjectInstanceBlockStore())return[];const e={key:"turn preview into block",render:e=>(0,I.jsx)(x().A,{...e,title:(0,I.jsx)(u().sA,{id:"hoverPreviewOverlay.action.turnPreviewIntoPreview",defaultMessage:"Turn into preview"}),svg:d().arrowSquarePathUpDownIcon}),action:()=>{k&&B&&f().createAndCommit({userAction:"HoverPreviewOverlay.transformExternalObjectInstanceMentionIntoBlock",environment:M,canUndo:!0,perform:e=>{h().FQ({block:i,parentStore:k,transaction:e,token:B}),e.postSubmitCallbacks.push((e=>{e||null==A||A()}))}})}};return[e];default:(0,p().HB)(C)}}),[C,R,i,k,B,M,A]);return U.push({key:1,render:e=>(0,I.jsx)(j().A,{...e,style:{paddingTop:0,paddingBottom:0}}),items:[...E,R(m().tA)]}),(0,I.jsx)(S().A,{menuType:v().gu.Popup,children:(0,I.jsx)(b().Ay,{type:b().Oh.Vertical,initialFocus:void 0,onAccept:w,sections:U,style:{paddingTop:3,paddingBottom:3}})})}},508398:(e,t,i)=>{i.d(t,{A:()=>r});i(296540);var n=()=>i(125565),o=i(474848);const r=function(e){const{type:t,emoji:r,customEmojiStore:s,text:a,deletedText:l,subText:d}=e,c=(0,i(56366).K8)((()=>"custom"===t&&s.isDefined()&&s.getAlive()),[s,t]),u=(0,i(401497).IS)((e=>({container:{alignItems:"center"},label:{color:e.text.inversePrimary,fontWeight:i(284371).Wy.medium,textAlign:"center",overflowWrap:"anywhere"},emojiContainer:{background:"white",borderRadius:4,padding:4,display:"flex",lineHeight:1,marginTop:2}})),[]);return(0,o.jsxs)(i(21140).wt,{gap:4,style:u.container,children:["custom"===t&&c?(0,o.jsx)("div",{style:u.emojiContainer,children:(0,o.jsx)(i(448664).A,{emojiStore:s,size:40})}):"unicode"===t?(0,o.jsx)("div",{style:u.emojiContainer,children:(0,o.jsx)(i(56086).A,{size:40,char:r})}):null,(0,o.jsx)(n().A,{isSmall:!0,isMultiline:!0,style:u.label,children:"unicode"===t||c?a:l}),d?(0,o.jsx)(n().A,{isSmall:!0,isMultiline:!0,style:u.label,children:d}):void 0]})}},549169:(e,t,i)=>{i.d(t,{Z:()=>a});i(517642),i(658004),i(733853),i(845876),i(432475),i(515024),i(731698),i(898992),i(354520),i(581454);var n=()=>i(56366),o=()=>i(435761),r=()=>i(646736),s=()=>i(981342);function a(e){const{environment:t,spaceStore:i,userId:a,userPermissionGroupIds:l}=e,d=(0,n().K8)((()=>null==i?void 0:i.isReady()),[i]),{spaceUserStore:c,isSpaceUserStoreReady:u}=(0,n().K8)((()=>{const e=(0,r().sE)(i,a);return{spaceUserStore:e,isSpaceUserStoreReady:null==e?void 0:e.isReady()}}),[i,a]),{teams:p,isLoading:m}=function({environment:e,spaceStore:t,spaceUserStore:i,userId:r,userPermissionGroupIds:a}){const{teams:l,isLoading:d}=(0,o().xJ)({spaceStore:t}),c=(0,o().gc)({spaceStore:t,teams:l}),u=(0,n().K8)((()=>{const e=c.filter((e=>e.store.isMemberOrGuest(r,a||new Set,null==i?void 0:i.getModel())));return(0,s().M9)(e).map((e=>e.store))}),[c,a,r,i]);return{teams:u,isLoading:d}}({environment:t,spaceStore:i,spaceUserStore:c,userId:a,userPermissionGroupIds:l});return{teams:p,isLoading:!d||!u||m}}},568317:(e,t,i)=>{i.d(t,{_:()=>r,p:()=>s});var n=()=>i(401497),o=()=>i(284371);function r(){return(0,n().IS)((e=>({listModule:{display:"flex",flexDirection:"column",gap:4},truncationButton:{display:"flex",gap:6,alignItems:"center",padding:4,marginInlineStart:-4,flexDirection:"row",flexGrow:0,alignSelf:"flex-start"},truncationIcon:{width:20,fill:e.icon.secondary},truncationLabel:{fontWeight:400},rowContainer:{display:"flex",gap:6,alignItems:"center",padding:4,marginInlineStart:-4,flexGrow:0,alignSelf:"flex-start",maxWidth:"100%"},rowLabel:{fontWeight:400},hoveredStyle:{borderRadius:"6px"}})),[])}function s(){return(0,n().IS)((e=>({card:{maxWidth:400,minWidth:280,padding:12},bio:{display:"flex",alignItems:"center",gap:12,overflow:"hidden"},bioLink:{overflow:"hidden"},bioRight:{overflow:"hidden",width:"100%"},actionButton:{width:"100%",height:28,fontWeight:o().Wy.medium},profileTitle:{fontWeight:o().Wy.semibold},profileSubtitle:{...o().RC},loadingShimmer:{height:16,borderRadius:6,animation:"500ms ease-in fadein"}})),[])}},683e3:(e,t,i)=>{i.d(t,{Of:()=>d,e9:()=>c,ed:()=>u});i(944114),i(898992),i(430670);var n=()=>i(759303);const o=100;class r extends(()=>i(757695))().Store{constructor(...e){super(...e),this.lastFetchTimestamp=void 0}getInitialState(){}isRefetchThrottleReady(){const e=Date.now();return!(void 0!==this.lastFetchTimestamp&&e-this.lastFetchTimestamp<1e4)&&(this.lastFetchTimestamp=e,!0)}}let s;function a(){return s??=new(n().q)({max:o})}function l(e){return`${e.spaceId}:${e.actorUserId}:${e.viewedUserId}`}function d(e){const t=a().peek(l(e));return Boolean(t&&void 0!==t.state)}function c(e){const t=a(),i=l(e),n=t.get(i);if(n)return n;const o=new r;return t.set(i,o),o}function u(e){const t=e.profiles,i=e.permissionGroups,n={};for(const r of Object.keys(i))n[r]={...i[r],id:r};const o=[];for(const r of Object.keys(t)){const e=t[r],i=e.permissionGroups.flatMap((e=>n[e]??[]));o.push({userId:r,timeZone:e.timeZone,permissionGroups:i})}return o}(0,i(852832).exposeDebugGetter)("extendedUserProfileCache",a)},755023:(e,t,i)=>{i.d(t,{x:()=>a});var n=()=>i(56366),o=()=>i(792071),r=()=>i(179034),s=()=>i(519831);function a(e){const{store:t,closestNonAliveAncestorStore:i,intl:o}=e;return(0,n().K8)((()=>{const e=t.table===s().Vl&&!t.getAlive()?t:i,n=e&&(e.table===r().ev||e.table===s().Vl)&&e.getMovedToTrashTime();if(n){const t=e.getMovedToTrashStore();return{trashAuthorStore:t,trashAuthorDisplayName:l(t,o),trashTimestamp:n,isMovedToTrashMetadata:!0}}if(t.table===r().ev){const e=t.getLastEditedByStore();return{trashAuthorStore:e,trashAuthorDisplayName:l(e,o),trashTimestamp:t.getLastEditedTime(),isMovedToTrashMetadata:!1}}return{trashAuthorStore:void 0,trashAuthorDisplayName:void 0,trashTimestamp:void 0,isMovedToTrashMetadata:!1}}),[t,i,o])}function l(e,t){return(null==e?void 0:e.getDisplayName(t))||t.formatMessage(o().Fvx.messages.anonymousPlaceholder)}},782007:(e,t,i)=>{i.d(t,{S:()=>n});function n(e,t,i,n){const r=new o(e,t,i,n);return(...e)=>r.enqueue(e)}class o{constructor(e,t,i,n){this.pendingInvocations=new Map,this.fn=e,this.coalesce=t,this.waitMs=i,this.options=n}enqueue(e){for(const[i,n]of this.pendingInvocations){const t=this.coalesce(i,e);if(t)return this.pendingInvocations.delete(i),this.pendingInvocations.set(t,n),void n.dequeueDebounced(t)}const t=(0,i(496603).sg)(this.dequeue.bind(this),this.waitMs,this.options);this.pendingInvocations.set(e,{dequeueDebounced:t}),t(e)}dequeue(e){this.pendingInvocations.delete(e),this.fn.apply(null,e)}}},820635:(e,t,i)=>{i.d(t,{Q:()=>f});i(581454),i(296540);var n=()=>i(484714),o=()=>i(56366),r=()=>i(401497),s=()=>i(187174),a=()=>i(69708),l=()=>i(284371),d=()=>i(567141),c=()=>i(559506),u=()=>i(698449),p=()=>i(765957),m=()=>i(994006),g=i(474848);function f(e){const{group:t,limit:i,noMembersMessage:f,color:h,trackHover:v}=e,y=(0,r().IS)((e=>({container:{marginBottom:4,..."white_background"===h?{fontSize:l().J.UISmall.desktop,color:e.text.secondary,padding:"4px 8px"}:{}},userContainer:{display:"flex",alignContent:"flex-end",minWidth:140,width:"100%",marginTop:4},user:{flexGrow:1},moreMessage:{marginInlineStart:2,marginTop:4,..."white_background"===h?{fontSize:l().J.UISmall.desktop,color:e.text.secondary}:{color:e.text.inverseSecondary}}})),[h]),x=(0,o().O$)(p().AppStoreSidebarSpaceStore),S=(0,n().v3)();(0,o().K8)((()=>{v&&d().ZX(S,{group_id:t.group_id})}),[v,t,S]);const[{value:b}]=(0,s().Yb)((async()=>{if(!x)return;const e=await c().callApi({eventName:"getSpacePermissionGroupMembers",environment:S,data:{groupIds:[t.group_id],spaceId:x.id}});if("success"===e.type){var n;const o=null===(n=e.data.groupUsersMap[t.group_id])||void 0===n?void 0:n.userIds;return(0,u().gA)({userIds:o,limit:i,spaceStore:x})}}),[x,S,t,i]);return 0===(null==b?void 0:b.limitedUserStores.length)?(0,g.jsx)(g.Fragment,{children:f}):(0,g.jsxs)("div",{style:y.container,children:[null==b?void 0:b.limitedUserStores.map((e=>(0,g.jsx)("div",{style:y.userContainer,children:(0,g.jsx)(m().A,{style:y.user,userStore:e,avatarSize:18})},e.id))),b&&b.countRemainingUsers>0?(0,g.jsx)("div",{style:y.moreMessage,children:(0,g.jsx)(a().sA,{id:"blockPermissionsSettings.groupPermissionUsers.tooltip",defaultMessage:"{countRemainingUsers} more…",values:{countRemainingUsers:b.countRemainingUsers}})}):void 0]})}},834974:(e,t,i)=>{i.d(t,{zP:()=>li,nJ:()=>Gt});i(898992),i(354520),i(672577),i(581454),i(737550);var n=i(296540),o=()=>i(726637),r=()=>i(587682),s=()=>i(484714),a=()=>i(275144),l=()=>i(56366),d=()=>i(401497),c=()=>i(929219),u=()=>i(718827),p=()=>i(30537),m=()=>i(869190),g=()=>i(561565),f=()=>i(617871),h=()=>i(187174),v=()=>i(563884),y=()=>i(30626),x=()=>i(681873),S=()=>i(179034),b=()=>i(519831),j=()=>i(343666),I=()=>i(201980),k=()=>i(173979),w=()=>i(506391),A=()=>i(69708),C=()=>i(496603),B=()=>i(534177),M=()=>i(284371),T=()=>i(347469),R=()=>i(488923),D=()=>i(508398),U=()=>i(47373),_=()=>i(87878),E=()=>i(966080),P=()=>i(933765),O=()=>i(493208),z=()=>i(106352),K=()=>i(693689),L=()=>i(891078),W=()=>i(346923),N=()=>i(510473),H=()=>i(968913),F=()=>i(253448),V=()=>i(179266),$=()=>i(129522),Y=()=>i(765957),G=()=>i(230062),Z=()=>i(16990),J=()=>i(141465),q=()=>i(148832),X=()=>i(543665),Q=()=>i(976586),ee=()=>i(406699),te=()=>i(854672),ie=()=>i(559273),ne=()=>i(417392),oe=()=>i(187820),re=()=>i(128295),se=()=>i(16006),ae=()=>i(346436),le=()=>i(487808),de=()=>i(820635),ce=()=>i(21140),ue=()=>i(824862),pe=()=>i(564884),me=()=>i(312788),ge=()=>i(406094),fe=()=>i(584262),he=()=>i(859002),ve=()=>i(212727),ye=()=>i(743246),xe=()=>i(496703),Se=()=>i(125565),be=()=>i(865342),je=()=>i(112995),Ie=()=>i(719061),ke=()=>i(201718),we=()=>i(94522),Ae=i(474848);const Ce=(0,A().YK)({chatButton:{id:"botHoverCard.chatButton",defaultMessage:"Chat"},configureButton:{id:"botHoverCard.configureButton",defaultMessage:"Configure"}});function Be(e){const{navigate:t}=(0,n.useContext)(me().E),{botStore:i}=e,o=(0,s().v3)(),r=(0,A().tz)(),a=(0,l().O$)(Y().AppStoreSidebarSpaceStore),c=(0,d().IS)((e=>({card:{maxWidth:400,minWidth:280,padding:12},bio:{display:"flex",alignItems:"center",gap:12,overflow:"hidden"},bioRight:{overflow:"hidden",width:"100%"},icon:{flexShrink:0},profileTitle:{fontWeight:M().Wy.semibold},profileSubtitle:{...M().RC},description:{...M().RC,display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden"},actionButton:{width:"100%",height:28,fontWeight:M().Wy.medium}})),[]),u=(0,l().K8)((()=>i.getModel()),[i]),p=(0,l().K8)((()=>(null==u?void 0:u.isWorkflowBot())??!1),[u]),m=(0,l().K8)((()=>{if(u&&p)return u.getWorkflowId()}),[u,p]),g=(0,l().K8)((()=>{if(m&&a)return ke().N.createChildStore(a,{table:ye().C0,id:m,spaceId:a.id})}),[m,a]),f=(0,n.useCallback)((()=>{if(m){const e=(0,xe().L)({workflowId:m,params:{workflowViewType:"chat"},pageVisitSource:fe().y8.MentionInPage});t({environment:o,url:e})}}),[m,o,t]),h=(0,n.useCallback)((()=>{if(m){const e=(0,xe().L)({workflowId:m,params:{workflowViewType:"settings"},pageVisitSource:fe().y8.MentionInPage});t({environment:o,url:e})}}),[m,o,t]);(0,n.useEffect)((()=>{u&&a&&(0,pe().u)({environment:o,event:{eventName:"bot_hover_card_impression",eventProperties:{bot_id:i.id,workflow_id:m||void 0,space_id:a.id}}})}),[u,i.id,m,o,a]);const v=(0,l().K8)((()=>{if(g)return(0,we().dh)(g)}),[g]),y=(0,l().K8)((()=>(null==v?void 0:v.name)||(null==u?void 0:u.getName())||"Unnamed Agent"),[u,v]),x=(0,l().K8)((()=>null==v?void 0:v.description),[v]),S=(0,l().K8)((()=>null==v?void 0:v.icon),[v]),b=(0,l().K8)((()=>!!g&&g.canEdit()),[g]);return u?(0,Ae.jsx)("div",{style:c.card,children:(0,Ae.jsx)(je().K,{from:"BotHoverCard",fallback:e=>(0,Ae.jsx)(Ie().d,{...e}),children:(0,Ae.jsxs)(ce().wt,{gap:16,children:[(0,Ae.jsx)(ce().Ye,{children:(0,Ae.jsxs)("div",{style:c.bio,children:[(0,Ae.jsx)(be().Z,{icon:S,size:56}),(0,Ae.jsxs)(ce().wt,{gap:3,style:c.bioRight,children:[(0,Ae.jsx)(Se().A,{style:c.profileTitle,children:y}),(0,Ae.jsx)(Se().A,{isSmall:!0,style:c.profileSubtitle,children:(0,Ae.jsx)(A().sA,{id:"botHoverCard.agentLabel",defaultMessage:"Custom Agent"})}),x?(0,Ae.jsx)(Se().A,{isSmall:!0,isSecondaryColor:!0,style:c.description,children:x}):void 0]})]})}),p?(0,Ae.jsxs)(ce().Ye,{gap:12,children:[(0,Ae.jsx)(ge().A,{onClick:f,size:"lg",style:c.actionButton,iconLeading:he().chatIcon,children:(0,Ae.jsx)(Se().A,{children:r.formatMessage(Ce.chatButton)})}),b?(0,Ae.jsx)(ge().A,{onClick:h,size:"lg",style:c.actionButton,iconLeading:ve().gearIcon,children:(0,Ae.jsx)(Se().A,{children:r.formatMessage(Ce.configureButton)})}):void 0]}):void 0]})})}):null}var Me=()=>i(258836);function Te(e){const t=(0,l().O$)(Y().AppStoreSidebarSpaceStore),i=(0,l().K8)((()=>{if(!t)return;const[i,n]=e.state.annotation;return Me().v.createChildStore(t,{id:n,table:ue().GP})}),[e.state,t]),n=(0,l().K8)((()=>!!i&&i.isDefined()),[i]);return i&&n&&t?(0,Ae.jsx)(Be,{botStore:i}):null}var Re=()=>i(877349);function De(e){const t=I().NpB(e.state.annotation),{store:i,contentBlockStart:n}=(0,l().K8)((()=>{if("block"!==t.type||!t.blockId)return{store:void 0,contentBlockStart:void 0};const e=Y().default.state.sidebarSpaceStore;if(!e)return{store:void 0,contentBlockStart:void 0};const i=q().B.createChildStore(e,{id:t.blockId,table:"block"}),n=i.isNavigableBlock()?i:i.getNavigableBlockStore();return n?{store:n,contentBlockStart:i!==n?i:void 0}:{store:void 0,contentBlockStart:void 0}}),[t]);return"block"===t.type&&t.blockId&&i?(0,Ae.jsx)(Re().y,{store:i,contentBlocks:n?[n]:void 0,size:"tall",hideCover:!0,hideIcon:!0,hideTitle:!0}):null}var Ue=()=>i(567141),_e=()=>i(559506),Ee=()=>i(495408),Pe=()=>i(881254);function Oe(e){const{token:t,store:i}=e.state,{linkMentionAnnotationData:o}=e,r=e.onDismiss,a=(0,s().v3)(),[l,d]=(0,n.useState)(!0),{iframe_url:c,height:u,padding:p,href:m,padding_top:g}=o,f=o.hasOwnProperty("description"),v=C().Im(o),[{value:y}]=(0,h().Yb)((async()=>{var e,t;if(c)return Ue().wZ(a,{type:"iframe"}),{result:"iframePresent"};if(f)return d(!1),v?Ue().wZ(a,{type:"default"}):Ue().wZ(a,{type:"custom"}),{result:"linkMentionContainsDescription"};d(!0);const i=await _e().callApi({eventName:"getDataForLinkMention",environment:a,data:{url:m,spaceId:(null===(e=Y().default.state.sidebarSpaceStore)||void 0===e?void 0:e.id)??(null===(t=Y().default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.getSpaceId()),source:"link_mention_hover"}});return"success"===i.type?"error"in i.data?(d(!1),{result:"apiFailed"}):(Ue().wZ(a,{type:"custom"}),d(!1),{result:"gotApiResponse",resultData:i.data}):"failed"===i.type?(d(!1),{result:"apiFailed"}):(d(!1),(0,B().HB)(i))}),[c,f,a,m,v]);let x;switch(null==y?void 0:y.result){case"linkMentionContainsDescription":x=o;break;case"gotApiResponse":x=y.resultData;break;case"apiFailed":case"iframePresent":case void 0:x=void 0;break;default:(0,B().HB)(y)}return x&&!c||!x&&!c?(0,Ae.jsx)(Pe().R,{hoverData:x,href:m,showEditButton:!1,store:i,token:t,onDismiss:r,loading:l}):c?(0,Ae.jsx)(Ee().p,{hoverData:o,iframe_url:c,showEditButton:!1,height:u,padding:p,store:i,token:t,onDismiss:r,href:m,padding_top:g}):(0,Ae.jsx)(Pe().R,{hoverData:x,href:m,showEditButton:!1,store:i,token:t,onDismiss:r,loading:l})}var ze=()=>i(908006),Ke=()=>i(252291),Le=()=>i(631524),We=()=>i(493552),Ne=()=>i(921940),He=()=>i(536583),Fe=()=>i(101163),Ve=()=>i(777447),$e=()=>i(651784),Ye=()=>i(969842),Ge=()=>i(607935),Ze=()=>i(884107),Je=()=>i(501666),qe=()=>i(319975),Xe=()=>i(712030),Qe=()=>i(267419),et=()=>i(781286);function tt(e){const{onDismiss:t,state:i}=e,{store:r}=i,a=(0,s().v3)(),c=(0,d().DP)(),[u,p]=(0,n.useState)(!0),m="token"===i.type?I().cQR(i.annotation):i.hyperlink,g=(0,Ve().lX)({url:m,baseUrl:o().A.domainBaseUrl,publicDomainName:o().A.publicDomainName}),f=(0,I().HZO)({url:m,baseUrl:o().A.domainBaseUrl,publicDomainName:o().A.publicDomainName}),v=(0,n.useCallback)((async()=>{switch(t(),i.type){case"token":qe().ek({token:i.token,store:i.store,readOnly:!1}),await ze().default.afterNextFlush(),Je().fi({type:"focusOnly",focus:!0});break;case"block":et().hv({store:i.store});break;default:(0,B().HB)(i)}}),[t,i]),y=(0,n.useCallback)((async()=>{t(),await ze().default.afterNextFlush();const e=await Ze().R.clipboardActions.load(),i=e.clipboardMessages.copiedLinkToClipboard;let n=m;const s=(0,$e().parseRoute)({url:m,baseUrl:o().A.domainBaseUrl,publicDomainName:o().A.publicDomainName,isMobile:a.device.isMobile,protocol:o().A.protocol,currentUrl:window.location.href});if("page"===s.name&&s.blockId){const e=q().B.createChildStore(r,{table:S().ev,id:s.blockId});n=(0,Ne().A)({pageId:s.blockId,pageModel:e.getModel(),baseUrl:o().A.domainBaseUrl,discussionId:s.discussionId,scrollToBlockId:s.scrollToBlockId,peekViewBlockId:s.peekViewBlockId,peekMode:s.peekMode,pageVisitSource:fe().y8.CopyLink})}e.copyString({environment:a,stringValue:n,copiedMessage:i})}),[a,t,r,m]),x=(0,l().K8)((()=>(0,U().s8)()),[]),[{value:j}]=(0,h().Yb)((async()=>{var e,t;if(g||!x)return;p(!0);const i=await _e().callApi({eventName:"getDataForLinkMention",environment:a,data:{url:m,spaceId:(null===(e=Y().default.state.sidebarSpaceStore)||void 0===e?void 0:e.id)??(null===(t=Y().default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.getSpaceId()),source:"hyperlink_hover"}});if("success"===i.type)return"error"in i.data?void p(!1):(p(!1),i.data);if("failed"===i.type)throw void p(!1);return p(!1),(0,B().HB)(i)}),[a,m,g,x]),k=a.device.isSafari||a.device.isIOS,w=(0,d().IS)((e=>({wrapper:{fontSize:M().J.UISmall.desktop,flexDirection:"column"},destination:{paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:6,alignItems:"center"},button:{marginInlineEnd:2},destinationText:{paddingInlineEnd:6,maxWidth:250,...M().RC},icon:{marginInlineEnd:k?"0.4em":"0.5em"},content:{width:340,height:"100%",aspectRatio:"auto"},title:{color:e.text.primary,fontWeight:M().Wy.semibold,whiteSpace:"normal",wordBreak:"break-word",fontSize:13,padding:"4px 0",maxWidth:300},author:{color:e.text.secondary,fontSize:M().J.UISmall.desktop},description:{wordBreak:"break-word",maxWidth:300,...M().RC,color:e.text.primary,fontSize:12,lineHeight:1.45,whiteSpace:"normal",flexDirection:"column"},text:{color:e.text.primary,fontSize:12,lineHeight:1.45},buttons:{fontWeight:M().Wy.medium}})),[k]),C=(0,A().tz)(),T=(0,A().YK)({copyLink:{defaultMessage:"Copy link",id:"hoverPreviewOverlay.copyLink"}}),R=(0,l().K8)((()=>{if(g){const e=q().B.createChildStore(r,{table:S().ev,id:g});return{icon:(0,Ye().h6)({pageModel:e.getModel(),pageRole:e.getRole(),baseUrl:o().A.domainBaseUrl,getRecordModel:r.getRecordModel,emojiType:(0,Xe().FN)(a),isSafariOrIOS:k,isClient:!0,showEmojiInline:a.device.isWindows,currentUserId:a.currentUser.id,theme:c,emojiData:Qe().A.state}),title:(0,Ae.jsx)(se().A,{placeholder:`${window.location.protocol}//${window.location.host}${m}`,style:w.destinationText,store:e})}}if(f){const e=X().m.createChildStore(r,{table:b().Vl,id:f});return{icon:(0,Ge().e)({collectionPointer:e.pointer,showEmojiInline:a.device.isWindows,emojiType:(0,Xe().FN)(a),getRecordModel:r.getRecordModel,getRecordRole:r.getRecordRole,baseUrl:o().A.domainBaseUrl,theme:c,isSafariOrIOS:k,isClient:!0,currentUserId:a.currentUser.id,emojiData:Qe().A.state}),title:(0,Ae.jsx)(se().A,{placeholder:`${window.location.protocol}//${window.location.host}${m}`,style:w.destinationText,store:e})}}return{icon:(0,Ae.jsx)("span",{style:w.icon,children:(0,Ae.jsx)(Ke().I,{icon:Fe().globeSmallIcon,size:"sm",colorVariant:"secondary",fitToViewBox:"horizontal"})}),title:(0,Ae.jsx)("div",{style:w.destinationText,children:m})}}),[a,r,g,f,w,c,k,m]),D=(0,l().K8)((()=>{if(!a.device.isMobile)return j?(j.hasOwnProperty("iframe")?Ue().Av(a,{type:"iframe"}):Ue().Av(a,{type:"custom"}),j):void 0}),[a,j]);if(x&&!g){if(D&&!D.iframe||!D)return(0,Ae.jsx)(Pe().R,{hoverData:D,href:m,handleEditClick:v,showEditButton:e.isHoveredTokenEditable,store:r,loading:u});if(D&&D.iframe)return(0,Ae.jsx)(Ee().p,{hoverData:D,iframe_url:D.iframe,height:D.height,padding:D.padding,padding_top:D.padding_top,handleEditClick:v,store:r,href:m,onDismiss:t,showEditButton:e.isHoveredTokenEditable})}return(0,Ae.jsx)(ce().Ye,{style:w.wrapper,alignItems:"center",children:(0,Ae.jsxs)(ce().Ye,{style:w.destination,alignItems:"center",children:[R.icon,(0,Ae.jsx)(We().D,{styleKey:"Caption/Regular",colorVariant:"secondary",children:R.title}),(0,Ae.jsx)(Le().p,{size:"sm",onClick:y,iconLeading:{icon:He().d,size:"sm"},ariaLabel:C.formatMessage(T.copyLink)}),e.isHoveredTokenEditable?(0,Ae.jsx)("div",{style:w.button,children:(0,Ae.jsx)(Le().p,{size:"sm",onClick:v,style:w.button,children:(0,Ae.jsx)(We().D,{styleKey:"Caption/Regular",children:(0,Ae.jsx)(A().sA,{defaultMessage:"Edit",id:"hoverPreviewOverlay.editButton.label"})})})}):void 0]})})}var it=()=>i(662303),nt=()=>i(811879),ot=()=>i(755023),rt=()=>i(859428);function st(e){const{store:t,closestNonAliveAncestorStore:i,originRect:n}=e,o=(0,A().tz)(),r=(0,d().IS)((e=>({tooltipStyle:{fontSize:14},mentionPageInTrashTime:{fontWeight:M().Wy.regular,color:e.text.secondary,fontSize:14},avatarStyle:{margin:"0 6px"},placeholderStyle:{marginInlineEnd:6}})),[]),{trashAuthorStore:s,trashAuthorDisplayName:a,trashTimestamp:l,isMovedToTrashMetadata:c}=(0,ot().x)({store:t,closestNonAliveAncestorStore:i,intl:o});if(!l)return null;const u=(0,m().jE)(l,it().locale,o),p=s&&(0,Ae.jsx)(nt().E,{authorStore:s,avatarSize:18,avatarStyle:r.avatarStyle});return(0,Ae.jsx)(rt().A,{forceVisibleState:!0,originRect:n,render:()=>{},renderTooltip:()=>(0,Ae.jsxs)("div",{children:[(0,Ae.jsxs)(ce().Ye,{alignItems:"center",children:[c?(0,Ae.jsx)(A().sA,{defaultMessage:"Moved to Trash by",id:"hoverPreviewOverlay.pageInTrash.message.movedToTrashBy"}):(0,Ae.jsx)(A().sA,{defaultMessage:"Last edited by",id:"hoverPreviewOverlay.pageInTrash.message.lastEditedBy"}),p||(0,Ae.jsx)("div",{style:r.placeholderStyle}),a]}),(0,Ae.jsx)("div",{style:r.mentionPageInTrashTime,children:u})]}),placement:"bottom",alignment:"start",style:r.tooltipStyle})}var at=()=>i(798880),lt=(i(517642),i(658004),i(733853),i(845876),i(432475),i(515024),i(731698),()=>i(913886)),dt=()=>i(381553),ct=()=>i(402390),ut=()=>i(936802),pt=()=>i(296798),mt=()=>i(710149),gt=()=>i(313171),ft=()=>i(453697),ht=()=>i(249847),vt=()=>i(646736),yt=()=>i(300789),xt=()=>i(645200),St=()=>i(694498),bt=()=>i(275239),jt=()=>i(464412),It=()=>i(404141),kt=()=>i(617711),wt=()=>i(549169),At=()=>i(763824),Ct=()=>i(158244),Bt=()=>i(683e3);var Mt=()=>i(612740),Tt=()=>i(571595);var Rt=()=>i(568317),Dt=()=>i(742734),Ut=()=>i(396933);const _t=(0,A().YK)({personalPronoun:{id:"personHoverCard.personalPronoun",defaultMessage:"You"}});function Et(e,t){return e?` (${t.formatMessage(_t.personalPronoun)})`:""}function Pt({index:e}){return(0,Ae.jsx)("span",{style:{whiteSpace:"pre"},children:(0,Ae.jsx)(A().sA,{defaultMessage:", ",id:"personHoverCard.userInfo.groupSeparatorValue"})},e)}function Ot(e){switch(e.membershipType){case"none":return(0,Ae.jsx)(A().sA,{id:"personHoverCard.memberStatus.none",defaultMessage:"Deactivated"});case"page_guest":return(0,Ae.jsx)(A().sA,{id:"personHoverCard.memberStatus.guest",defaultMessage:"Guest"});case"restricted_member":return(0,Ae.jsx)(A().sA,{id:"personHoverCard.memberStatus.restricted_member",defaultMessage:"Restricted Member"});case"member":return(0,Ae.jsx)(A().sA,{id:"personHoverCard.memberStatus.member",defaultMessage:"Member"});case"membership_admin":return(0,Ae.jsx)(A().sA,{id:"personHoverCard.memberStatus.admin",defaultMessage:"Admin"});case"owner":return(0,Ae.jsx)(A().sA,{id:"personHoverCard.memberStatus.owner",defaultMessage:"Workspace Owner"});default:(0,B().HB)(e.membershipType)}}function zt(e){const{permissionGroupNames:t,membershipType:i,isExtendedUserProfileLoading:n,areTeamsLoading:o,teamspaceNames:r,scimTitle:s}=e,a=(0,Rt().p)();return n?(0,Ae.jsx)(mt().A,{style:a.loadingShimmer}):s?(0,Ae.jsx)(Se().A,{isSmall:!0,style:a.profileSubtitle,children:s}):t.length>0?(0,Ae.jsx)(Se().A,{isSmall:!0,style:a.profileSubtitle,children:(0,x().G)(t.slice(0,3),(e=>(0,Ae.jsx)(Pt,{index:e},e)))}):o?(0,Ae.jsx)(mt().A,{style:a.loadingShimmer}):r.length>0?(0,Ae.jsx)(Se().A,{isSmall:!0,style:a.profileSubtitle,children:(0,x().G)(r.slice(0,3),(e=>(0,Ae.jsx)(Pt,{index:e},e)))}):i?(0,Ae.jsx)(Se().A,{isSmall:!0,style:a.profileSubtitle,children:(0,Ae.jsx)(Ot,{membershipType:i})}):null}function Kt(e){const t=(0,A().tz)(),{isExtendedUserProfileLoading:i,timeZone:n}=e,o=(0,Rt().p)();return i?(0,Ae.jsx)(mt().A,{style:o.loadingShimmer}):n?(0,Ae.jsx)(Se().A,{isSmall:!0,isSecondaryColor:!0,style:o.profileSubtitle,children:(0,Ae.jsx)(A().sA,{id:"personHoverCard.userInfo.timeZone",defaultMessage:"{time} local time",values:{time:(new Date).toLocaleTimeString((0,ct().H)(t),{timeZone:n,hour:"2-digit",minute:"2-digit",hour12:!0})}})}):null}const Lt={timeZone:void 0,permissionGroups:[]};const Wt=56;function Nt({userStore:e}){const t=(0,A().tz)(),i=(0,s().v3)(),o=(0,bt().h)("person_hover_card_loaded",{environment:i,allowMultipleFiresPerSession:!0}),r=(0,l().O$)(Y().AppStoreSidebarSpaceStore),a=(0,l().K8)((()=>{var t;if(r)return null===(t=(0,vt().dp)(r,e.id))||void 0===t?void 0:t.getMembershipType()}),[r,e]),d=(0,l().K8)((()=>e.id),[e]),c=(0,ht().T)()===d,{value:u,isLoading:p}=function({userId:e}){const t=(0,s().v3)(),i=(0,l().O$)(Y().AppStoreSidebarSpaceStore),{store:n,refetch:o}=(0,l().K8)((()=>{if(!i||!i.userId)return{store:void 0,refetch:void 0};const n=i.userId,o=(0,Bt().e9)({spaceId:i.id,actorUserId:n,viewedUserId:e});return{store:o,refetch:async()=>{await(0,Ct().fetchExtendedUserProfile)({viewedUserId:e,actorUserId:n,spaceStore:i,store:o,environment:t})}}}),[i,t,e]),r=o??At().TA,[{status:a,error:d}]=(0,h().Yb)(r,[r]),c=(0,l().O$)(n);return void 0===i?{isLoading:!0,error:void 0,value:void 0}:{isLoading:!c&&"pending"===a,error:d,value:c}}({userId:d}),{timeZone:m,permissionGroups:g}=u??Lt,f=(0,l().K8)((()=>new Set(g.map((e=>e.id)))),[g]),v=function(e){return e.sort(((e,t)=>e.memberCount-t.memberCount)).map((e=>e.name))}(g),{teams:y,isLoading:x}=(0,wt().Z)({environment:i,spaceStore:r,userId:d,userPermissionGroupIds:f}),S=(0,l().K8)((()=>y?y.map((e=>e.getName())).filter((e=>void 0!==e)):[]),[y]),{name:b,email:j}=(0,l().K8)((()=>({name:e.getFullName(t),email:e.getEmail()})),[e,t]),I=(0,l().K8)((()=>e.isDefined()),[e]),k=(0,l().K8)((()=>(0,kt().MN)({userId:d,currentSpaceStore:r,environment:i,pageVisitSource:fe().y8.PersonHoverCard})),[d,r,i]),w=(0,Dt().E)({spaceStore:r,viewedUserId:e.id}),C="show"===(0,Ut().$)({spaceStore:r,viewedUserId:e.id}),M=(0,jt().X)(),T=(0,n.useCallback)((()=>{j&&(M?(0,xt().YQ)({environment:i,email:j,from:"peopleHoverCard"}):(St().A.setState({signupCtaAttribution:"peopleHoverCard"}),yt().UW(i,"notion_calendar_launch_promo")))}),[M,i,j]),R=(0,n.useCallback)((e=>{e.metaKey||It().A.setState({...It().A.state,open:!1})}),[]),D=(0,B().O9)(j)&&I&&w,U=p||x;(0,n.useEffect)((()=>{D&&!U&&o()}),[D,U,o]),function({environment:e,shouldRender:t,viewedUserId:i,from:o}){const r=(0,n.useRef)(!1);(0,n.useEffect)((()=>{t&&!r.current&&(r.current=!0,(0,pe().u)({environment:e,event:{eventName:"person_hover_card_impression",eventProperties:{viewed_user_id:i,from:o}}}))}),[t,e,i,o])}({environment:i,shouldRender:D,viewedUserId:d,from:"unknown"});const _=function(e){const{currentSpaceStore:t,environment:i,hoveredUserId:n,propertyId:o}=e;return(0,l().K8)((()=>{if(!t)return;const e=i.idCreator.getSpaceIdCreatorSync(t.id),r=(0,Tt().rf)({userId:n,spaceIdCreator:e});return q().B.createChildStore(t,(0,Mt().iL)({blockId:r,spaceId:t.id})).getProperties()[o]}),[t,i,n,o])}({currentSpaceStore:r,environment:i,hoveredUserId:d,propertyId:(0,ut().mW)("title")}),E=(0,Rt().p)();if(!D)return null;const P=b||j,O=(0,Ae.jsx)(Se().A,{style:E.profileTitle,children:P+Et(c,t)});return(0,Ae.jsx)("div",{style:E.card,children:(0,Ae.jsx)(je().K,{from:"PersonHoverCard",fallback:e=>(0,Ae.jsx)(Ie().d,{...e}),children:(0,Ae.jsxs)(ce().wt,{gap:16,children:[(0,Ae.jsx)(ce().Ye,{children:(0,Ae.jsxs)("div",{style:E.bio,children:[k&&C?(0,Ae.jsx)(pt().A,{href:k,onClick:R,ignoreLocalHoverState:!0,children:(0,Ae.jsx)(ft().A,{userStore:e,size:Wt})}):(0,Ae.jsx)(ft().A,{userStore:e,size:Wt}),(0,Ae.jsxs)(ce().wt,{gap:3,style:E.bioRight,children:[(0,Ae.jsxs)(ce().Ye,{gap:4,alignItems:"center",children:[k&&C?(0,Ae.jsx)(pt().A,{href:k,onClick:R,ignoreLocalHoverState:!0,style:E.bioLink,children:O}):O,"restricted_member"===a?(0,Ae.jsx)(gt().L,{}):null]}),(0,Ae.jsx)(zt,{isExtendedUserProfileLoading:p,scimTitle:_,permissionGroupNames:v,areTeamsLoading:x,teamspaceNames:S,membershipType:a}),(0,Ae.jsx)(Kt,{isExtendedUserProfileLoading:p,timeZone:m})]})]})}),c?null:(0,Ae.jsxs)(ce().Ye,{gap:12,children:[(0,Ae.jsx)(ge().A,{size:"lg",style:E.actionButton,onClick:()=>{window.open(`mailto:${j}`,"_blank")},iconLeading:{icon:lt().D,size:"sm"},children:(0,Ae.jsx)(Se().A,{children:(0,Ae.jsx)(A().sA,{id:"personHoverCard.actionButtons.email",defaultMessage:"Email"})})}),(0,Ae.jsx)(ge().A,{size:"lg",style:E.actionButton,onClick:T,iconLeading:{icon:dt().Y,size:"sm"},children:(0,Ae.jsx)(A().sA,{id:"personHoverCard.actionButtons.schedule",defaultMessage:"Schedule"})})]})]})})})}var Ht=()=>i(870092);function Ft(e){const t=(0,l().O$)(Y().AppStoreSidebarSpaceStore),i=(0,l().K8)((()=>{if(!t)return;if("user"===e.state.type)return e.state.store;const i=e.state.annotation;return Ht().L.createChildStore(t,{id:i[1],table:at().oo})}),[e.state,t]),n=(0,l().K8)((()=>!!i&&i.isDefined()),[i]);return i&&n&&t?(0,Ae.jsx)(Nt,{userStore:i}):null}var Vt=()=>i(871830),$t=()=>i(490242);function Yt(e,t){if(Object.is(e,t))return!0;if(void 0===e||void 0===t||e.type!==t.type)return!1;switch(e.type){case"token":return t.type===e.type&&e.store.id===t.store.id&&Object.is(e.annotations,t.annotations);case"block":case"user":return t.type===e.type&&e.store.id===t.store.id;case"tab":return t.type===e.type&&e.tabId===t.tabId;default:return!1}}function Gt(e){const t=(0,s().v3)(),{state:i,pinPopup:o,unpinPopup:r,hasBeenHovering:a,isPinned:d,dismissPopup:c}=function(){const[e,t]=(0,n.useState)(!1),[i]=(0,l().$y)(J().A),o=(0,W().l)(i,Yt),[r,s]=(0,n.useState)(void 0),a=Boolean(r&&!Yt(o,r));(0,n.useEffect)((()=>{if(a){const e=setTimeout((()=>{s(void 0)}),150);return()=>clearTimeout(e)}}),[a]);const d=Boolean(o&&!Yt(o,r));(0,n.useEffect)((()=>{if(o&&d){const e=setTimeout((()=>{s(o)}),400);return()=>clearTimeout(e)}}),[o,d]);const[c,u]=(0,n.useState)(void 0),p=c||(e?void 0:r),m=(0,n.useCallback)((()=>{u(p)}),[p]),g=(0,n.useCallback)((()=>{u(void 0)}),[]),f=(0,n.useCallback)((()=>{g(),t(!0)}),[g]);return(0,n.useEffect)((()=>{t(!1)}),[r]),{state:p,pinPopup:m,unpinPopup:g,hasBeenHovering:o&&o===p,isPinned:Boolean(c),dismissPopup:f}}(),u=function(e){const t=(0,s().v3)();return(0,l().K8)((()=>!!e&&(0,K().k)(t,e.store)),[e,t])}(i),m=(0,n.useMemo)((()=>Boolean(i&&function(e,t){switch(e.type){case"token":return e.annotations.some(I().sh$)||t&&e.annotations.some(I().N53)||e.annotations.some(I().rie)||e.annotations.some(I().XkZ)||e.annotations.some(I().ik2)||e.annotations.some(I().n5B);case"block":return Boolean(e.hyperlink);case"user":return!0;case"tab":return!1;default:(0,B().HB)(e)}}(i,u))),[i,u]),g=(0,n.useMemo)((()=>i&&function(e){switch(e.type){case"token":return e.token.node.getBoundingClientRect();case"block":return $().K.getRect(e.store);case"user":case"tab":return e.domRect;default:(0,B().HB)(e)}}(i)),[i]),f=g&&0===g.width&&0===g.height&&0===g.left&&0===g.top,h=(0,l().K8)((()=>{const e=G().A.state;return m?!f:Boolean(!e&&a&&!f)}),[m,f,a]),[,v]=(0,l().$y)(Z().A);(0,n.useEffect)((()=>(v({isPinned:d}),()=>v({isPinned:!1}))),[d,v]);const y=(0,n.useMemo)((()=>"token"===(null==i?void 0:i.type)&&(null==i?void 0:i.annotations.some(I().n5B))),[i]),x=!("token"!==(null==i?void 0:i.type)||null!=i&&i.annotations.some(I().N53)||null!=i&&i.annotations.some(I().jIt)||y),S=(0,n.useMemo)((()=>"token"===(null==i?void 0:i.type)&&(null==i?void 0:i.annotations.some(I().nNl))),[i]),b=(0,n.useMemo)((()=>("token"===(null==i?void 0:i.type)?null==i?void 0:i.annotations.some(I().rie):"user"===(null==i?void 0:i.type))??!1),[i]),j=(0,n.useMemo)((()=>"token"===(null==i?void 0:i.type)&&(null==i?void 0:i.annotations.some(I().XkZ))),[i]),k=(0,n.useCallback)((()=>b||j?"end":S?"center":"start"),[b,j,S]),w=(0,n.useCallback)((()=>b||j||y?"top":"bottom"),[b,j,y]),A=(0,l().O$)(t.RouterStore);return(0,n.useEffect)((()=>{c()}),[A,c]),(0,n.useEffect)((()=>{const e=C().nF((()=>{T().co(),c()}),200,{leading:!0});return(0,E().P)(window,"scroll",e,!0),()=>(0,P().O)(window,"scroll",e,!0)}),[c]),(0,Ae.jsx)(ne().Ay,{disableMouseCapture:!0,preventCaptureEsc:!0,preventPointerEvents:h&&!m,preventScaleTransition:!0,preventOpacityTransition:!0,popupType:p().n.Popup,open:h,originRect:g,originGap:6,alignmentToOrigin:k(),placementToOrigin:w(),useLightBoxShadow:x,render:()=>i&&(0,Ae.jsx)("div",{onMouseOver:o,onMouseLeave:r,children:(0,Ae.jsx)(Zt,{state:i,isHoveredTokenEditable:u,onDismiss:r,originRect:g})}),...S?{borderRadius:6}:{}})}function Zt(e){const t=(0,l().O$)(Y().AppStoreSidebarSpaceStore),i=(0,d().IS)((e=>({noMembersInGroupStyle:{fontSize:M().J.UISmall.desktop,color:e.text.secondary,padding:"4px 8px"}})),[]),n="token"===e.state.type?e.state.annotations:void 0,r=null==n?void 0:n.find(I().ik2),s=(0,l().K8)((()=>{if((0,U().YE)()&&r)return I().q1R(r)}),[r]),a=null==n?void 0:n.find(I().sh$),c=null==n?void 0:n.find(I().qsB),u=null==n?void 0:n.find(I().RaC),p=null==n?void 0:n.find(I().go0),m=n?I().MzR(n):void 0,g=null==n?void 0:n.find(I().jIt),f=null==n?void 0:n.find(I().bZo),h=null==n?void 0:n.find(I().muW),v=null==n?void 0:n.find(I().rie),y=null==n?void 0:n.find(I().XkZ),x=null==n?void 0:n.find(I().nNl),S=null==n?void 0:n.find(I().n5B),b=(0,l().K8)((()=>{if(!u)return;const e=I().FHi(u);if(!e)return;return t?(0,N().E)({groupId:null==e?void 0:e.groupId,spaceStore:t}).getModel():void 0}),[t,u]);if(null==n?void 0:n.some((e=>{if(I().JCc(e)){const t=I().FLg(e);return t&&"everyone"!==t.mentionType}return!1})))return null;if("user"===e.state.type&&!o().A.isMobile)return(0,Ae.jsx)(Ft,{...e,state:e.state,onDismiss:e.onDismiss});if("tab"===e.state.type){const t=e.state;return(0,Ae.jsx)(di,{...e,state:t,onDismiss:e.onDismiss})}if("token"!==e.state.type)return null;if(a&&e.state.store.table!==j().SN)return(0,Ae.jsx)(tt,{...e,state:{...e.state,annotation:a}});if(c)return(0,Ae.jsx)(qt,{...e,state:{...e.state,annotation:c}});if(u){if(I().FHi(u)&&b)return(0,Ae.jsx)(de().Q,{group:b,limit:10,color:"white_background",trackHover:!0,noMembersMessage:(0,Ae.jsx)(ce().Ye,{style:i.noMembersInGroupStyle,children:(0,Ae.jsx)("div",{style:M().RC,children:(0,Ae.jsx)(A().sA,{id:"groupPreview.noUsers",defaultMessage:"No users in this group"})})})})}else if(s&&!o().A.isMobile)return(0,Ae.jsx)(Oe,{state:e.state,isHoveredTokenEditable:e.isHoveredTokenEditable,linkMentionAnnotationData:s,onDismiss:e.onDismiss});return x?(0,Ae.jsx)(Jt,{...e,state:{...e.state,annotation:x},currentSpaceStore:t}):p?(0,Ae.jsx)(Xt,{...e,state:{...e.state,annotation:p}}):m&&!o().A.isMobile?(0,Ae.jsx)(li,{...e,state:{...e.state,annotation:m},onDismiss:e.onDismiss}):f&&"block"===f[1].type&&void 0!==f[1].citationNumber&&!o().A.isMobile?(0,Ae.jsx)(De,{...e,state:{...e.state,annotation:f},onDismiss:e.onDismiss}):g&&!o().A.isMobile?(0,Ae.jsx)(di,{...e,state:{...e.state,annotation:g},onDismiss:e.onDismiss}):h&&!o().A.isMobile?(0,Ae.jsx)(ci,{...e,state:{...e.state,annotation:h},onDismiss:e.onDismiss}):v?(0,Ae.jsx)(Ft,{...e,state:{...e.state,annotation:v},onDismiss:e.onDismiss}):y&&!o().A.isMobile?(0,Ae.jsx)(Te,{...e,state:{...e.state,annotation:y},onDismiss:e.onDismiss}):S?(0,Ae.jsx)(R().YY,{store:e.state.store,annotation:S,onDismiss:e.onDismiss}):null}function Jt(e){var t,i;const{store:n,annotation:o}=e.state,r=I().qS0(o),s=r&&Q().P.createChildStore(n,r),a=(0,l().K8)((()=>{if(null!=s&&s.isDefined())return null==s?void 0:s.getModel().getRenderTitle()}),[s]),c=(0,l().K8)((()=>(0,_().wA)({spaceStore:e.currentSpaceStore})),[e.currentSpaceStore]),u=(0,d().IS)((e=>({container:{backgroundColor:e.background.accentPrimary,padding:"4px 8px",maxWidth:250,width:"max-content"},text:{color:e.text.inverseSecondary}})),[]);return s?(0,Ae.jsx)("div",{style:u.container,children:(0,Ae.jsx)(D().A,{type:"custom",customEmojiStore:s,text:(0,Ae.jsx)("span",{className:"notranslate",children:a}),deletedText:(0,Ae.jsx)(A().sA,{defaultMessage:"{name} <medium>(deleted)</medium>",id:"HoverPreviewOverlay.customEmojiDeleted",values:{name:(0,Ae.jsx)("span",{className:"notranslate",children:a}),medium:e=>(0,Ae.jsx)("span",{style:u.text,children:e})}}),subText:null!==(t=e.currentSpaceStore)&&void 0!==t&&t.id&&r.spaceId!==(null===(i=e.currentSpaceStore)||void 0===i?void 0:i.id)&&c?(0,Ae.jsx)("span",{style:u.text,children:(0,Ae.jsx)(A().sA,{id:"HoverPreviewOverlay.customEmojiUpload",defaultMessage:"Right-click to add to your workspace"})}):void 0})}):null}function qt(e){const{annotation:t}=e.state,i=I().K7D(t),n=(0,d().IS)((e=>({container:{fontSize:M().J.UISmall.desktop,color:e.text.secondary,padding:"4px 8px"},icon:{height:"1em",width:"1em",marginInlineEnd:"0.25em",fill:e.icon.secondary}})),[]),o=(0,A().tz)(),r="relative"===i.date_format?"ll":"relative",s=(0,m().ZF)({value:i,date_format:r,time_format:"h:mm A",allowRelativeDates:!0,intl:o});return s===(0,m().ZF)({value:i,date_format:i.date_format,time_format:i.time_format,allowRelativeDates:!0,intl:o})?null:(0,Ae.jsxs)(ce().Ye,{style:n.container,alignItems:"center",children:[(0,v().k)(n.icon),(0,Ae.jsx)("div",{style:M().RC,children:s})]})}function Xt(e){const{annotation:t}=e.state,i=I().y0Y(t),n=(0,A().tz)(),o=(0,k().EC)(i.type,n),r=(0,d().IS)((e=>({container:{fontSize:M().J.UISmall.desktop,color:e.text.secondary,padding:"4px 8px"}})),[]);return(0,Ae.jsx)(ce().Ye,{style:r.container,alignItems:"center",children:(0,Ae.jsx)("div",{style:M().RC,children:o})})}function Qt(e){var t,i;const{renderConfig:n,store:o}=e,r=(0,s().v3)(),a=(0,d().IS)((e=>({title:{color:e.text.primary,fontWeight:M().Wy.semibold,whiteSpace:"initial",fontSize:13,padding:"4px 0",width:"100%"},header:{color:e.text.secondary,fontSize:M().J.UISmall.desktop},dictionaryKey:{color:e.text.tertiary,fontWeight:M().Wy.regular,fontSize:M().J.UISmall.desktop},dictionaryValue:{color:e.text.secondary,fontSize:M().J.UISmall.desktop,whiteSpace:"normal",wordBreak:"break-word"}})),[]),l=null===(t=n.previewImageAttribute)||void 0===t?void 0:t.values[0],c=o.pointer,[u]=(0,h().Yb)((async()=>{if(!l)return;const e={isAuthenticated:!0,url:l,permissionRecord:c};return(0,V().L)(e,r)}),[r,l,c]);return(0,Ae.jsxs)(Ae.Fragment,{children:[n.title?(0,Ae.jsx)(ce().Ye,{children:(0,Ae.jsx)(z().Ic,{...n.title,store:o,style:a.title})}):void 0,n.headerAttributes&&n.headerAttributes.length>0?(0,Ae.jsx)(ce().Ye,{alignItems:"center",style:{...a.header,marginBottom:8},children:(0,x().G)(n.headerAttributes.map(((e,t)=>(0,Ae.jsx)(z().Ic,{...e,store:o,style:{...a.header,...M().RC}},`attribute-${t}`)))||[],(e=>(0,Ae.jsxs)("span",{children:[" ","·"," "]},`dot-${e}`)))}):void 0,n.dictionaryAttributes&&n.dictionaryAttributes.length>0?(0,Ae.jsx)(ce().wt,{children:n.dictionaryAttributes.map((({key:e,value:t},i)=>{var r;return(0,Ae.jsxs)(ce().Ye,{style:{marginBottom:i!==((null===(r=n.dictionaryAttributes)||void 0===r?void 0:r.length)??0)-1?4:8},children:[(0,Ae.jsx)("div",{style:{marginInlineEnd:8,width:"30%",display:"flex",alignItems:"center"},children:(0,Ae.jsx)("span",{style:a.dictionaryKey,children:(0,Ae.jsx)(A().sA,{...e.formatter,values:{value:t.attribute.name}})})}),(0,Ae.jsxs)("div",{style:{width:"70%",display:"flex",alignItems:"center"},children:[t.icon&&(0,w().nN)(t.icon)?(0,Ae.jsx)(te().A,{type:"image_url",imageURL:t.icon.values[0],size:16,style:{marginInlineEnd:6}}):void 0,(0,Ae.jsx)(z().Ic,{...t,store:o,style:a.dictionaryValue,avatarStyle:{marginInlineEnd:6}})]})]},i)}))}):void 0,n.bodyAttribute&&!(0,w().Q7)(n.bodyAttribute)?(0,Ae.jsx)(ce().Ye,{style:((null===(i=n.dictionaryAttributes)||void 0===i?void 0:i.length)??0)>0?{marginTop:3}:{},children:(0,Ae.jsx)(z().xq,{attribute:n.bodyAttribute,store:o})}):void 0,null!=u&&u.value?(0,Ae.jsx)("div",{style:{marginTop:n.dictionaryAttributes?6:0,marginBottom:4,display:"flex",justifyContent:"center"},children:(0,Ae.jsx)("div",{children:(0,Ae.jsx)(ie().A,{src:u.value,style:{width:"100%",maxHeight:200}})})}):void 0]})}function ei(e,t){if(!e)return null;const i=e.find((e=>e.key.formatter.id===t));return i?i.value:null}function ti(e,t){if(!e)return null;return e.filter((e=>e.attribute&&t.includes(e.attribute.id)))}function ii(e,t){if(!e)return null;const i=e.find((e=>e.value.attribute.id===t));return i?i.value:null}function ni(e){var t;const{renderConfig:i,store:n,integration:o,haveInstanceAction:s,containerDivRef:l,token:c,parentBlockStore:p,onDismiss:m}=e,g=(0,d().IS)((e=>({title:{color:e.text.primary,fontWeight:M().Wy.medium,whiteSpace:"initial",fontSize:14,padding:"4px 0",width:"100%"},header:{color:e.text.secondary,fontSize:M().J.UISmall.desktop,paddingInlineStart:8,flexGrow:1,fontWeight:M().Wy.regular},dictionaryValue:{color:e.text.primary,fontSize:M().J.UISmall.desktop,whiteSpace:"normal",wordBreak:"break-word"},buttonOrigin:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24,borderRadius:4,fill:e.icon.tertiary},innerBox:{width:"fit-content",display:"flex",alignItems:"center",gap:4}})),[]),f=null===(t=ei(i.dictionaryAttributes,"unfurling.github.pullRequest"))||void 0===t?void 0:t.attribute.values[0],h=ei(i.dictionaryAttributes,"unfurling.generic.status"),v=ei(i.dictionaryAttributes,"unfurling.generic.author"),x=function(e,t){if(!e)return null;return e.find((e=>e.formatter&&t.includes(e.formatter.id)))||null}(i.headerAttributes,["unfurling.github.githubPullMerged","unfurling.github.githubPullClosed","unfurling.github.githubPullOpened"]);return(0,Ae.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:295},children:[(0,Ae.jsxs)(ce().Ye,{alignItems:"center",style:{fontSize:12},children:[(0,Ae.jsxs)(Ae.Fragment,{children:[(0,Ae.jsx)(te().A,{type:"image_url",imageURL:o.icon,size:16,style:{marginInlineEnd:4}}),(0,Ae.jsx)("div",{style:{fontWeight:M().Wy.medium},children:"GitHub"})]}),f?(0,Ae.jsx)("div",{style:g.header,children:(0,Ae.jsx)(A().sA,{id:"unfurling.github.pullRequestNo",defaultMessage:"PR {prNumber}",values:{prNumber:f}})}):void 0,s?void 0:(0,Ae.jsx)("div",{style:{position:"relative"},children:(0,Ae.jsx)(ee().A,{popupType:ee().z.Popup,placementToOrigin:"right",alignmentToOrigin:"start",originGap:4,onClose:()=>{let e=!1;const t=l.current;t&&(e=(0,r().ux)(t.getBoundingClientRect(),a().$C.x,a().$C.y)),e||null==m||m()},renderOrigin:e=>(0,Ae.jsx)(u().Ay,{style:g.buttonOrigin,...e,children:(0,y()._)({width:14})}),render:e=>(0,Ae.jsx)(le().ExternalObjectInstanceBlockMenu,{titleForReloadMenuOption:(0,Ae.jsx)(A().sA,{id:"linkMention.reload",defaultMessage:"Reload mention"}),parentBlockStore:p,store:n,token:c,onAccept:()=>e.close(),extraSecondaryItemKey:"mention_to_preview"})})})]}),i.title?(0,Ae.jsx)(ce().Ye,{children:(0,Ae.jsx)(z().Ic,{...i.title,store:n,style:g.title})}):void 0,(0,Ae.jsxs)(ce().Ye,{style:{gap:4,alignSelf:"stretch",alignItems:"center"},children:[h?(0,Ae.jsxs)("div",{style:{width:"fit-content",display:"flex",alignItems:"center"},children:[h.icon&&(0,w().nN)(h.icon)?(0,Ae.jsx)(te().A,{type:"image_url",imageURL:h.icon.values[0],size:14}):void 0,(0,Ae.jsx)(z().Ic,{...h,store:n,style:g.dictionaryValue,avatarStyle:{marginInlineEnd:6}})]}):void 0,(0,Ae.jsxs)("div",{style:{lineHeight:"16px",display:"flex",gap:4},children:[x?(0,Ae.jsx)("div",{style:g.innerBox,children:(0,Ae.jsx)(z().Ic,{attribute:x.attribute,store:n,style:g.dictionaryValue})}):void 0,v?(0,Ae.jsxs)("div",{style:g.innerBox,children:[(0,Ae.jsx)("div",{style:g.dictionaryValue,children:(0,Ae.jsx)(A().sA,{id:"unfurling.generic.by",defaultMessage:"by"})}),v.icon&&(0,w().nN)(v.icon)?(0,Ae.jsx)(te().A,{type:"image_url",imageURL:v.icon.values[0],size:16,style:{marginInlineStart:4}}):void 0,(0,Ae.jsx)(z().Ic,{...v,store:n,style:g.dictionaryValue})]}):void 0]})]})]})}function oi(e){const{renderConfig:t,store:i,integration:n,haveInstanceAction:o,containerDivRef:s,token:l,parentBlockStore:c,onDismiss:p}=e,m=(0,d().IS)((e=>({dictionaryValue:{color:e.text.primary,fontSize:M().J.UISmall.desktop,whiteSpace:"normal",wordBreak:"break-word"},buttonOrigin:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24,borderRadius:4,fill:e.icon.tertiary},actionButton:{position:"absolute",top:10,insetInlineEnd:10,zIndex:2}})),[]),g=ei(t.dictionaryAttributes,"unfurling.generic.lastModifiedBy"),f=ei(t.dictionaryAttributes,"unfurling.generic.lastModifiedAt");return(0,Ae.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:295},children:[(0,Ae.jsx)(ce().Ye,{alignItems:"center",style:{fontSize:12},children:(0,Ae.jsxs)(Ae.Fragment,{children:[(0,Ae.jsx)(te().A,{type:"image_url",imageURL:n.icon,size:16,style:{marginInlineEnd:4}}),(0,Ae.jsx)("div",{style:{fontWeight:M().Wy.medium},children:"Figma"})]})}),(0,Ae.jsxs)(ce().Ye,{style:{gap:4,alignSelf:"stretch",alignItems:"center"},children:[f?(0,Ae.jsxs)("div",{style:{width:"fit-content",display:"flex",alignItems:"center",gap:4},children:[(0,Ae.jsx)("div",{style:m.dictionaryValue,children:(0,Ae.jsx)(A().sA,{id:"unfurling.generic.editor",defaultMessage:"Edited"})}),(0,Ae.jsx)(z().Ic,{...f,store:i,style:m.dictionaryValue})]}):void 0,g?(0,Ae.jsxs)("div",{style:{width:"fit-content",display:"flex",alignItems:"center",gap:4},children:[(0,Ae.jsx)("div",{style:m.dictionaryValue,children:(0,Ae.jsx)(A().sA,{id:"unfurling.generic.from",defaultMessage:"by"})}),g.icon&&(0,w().nN)(g.icon)?(0,Ae.jsx)(te().A,{type:"image_url",imageURL:g.icon.values[0],size:16,style:{marginInlineStart:4}}):void 0,(0,Ae.jsx)(z().Ic,{...g,store:i,style:m.dictionaryValue})]}):void 0]}),t.previewImageAttribute?(0,Ae.jsx)("div",{style:{marginTop:t.dictionaryAttributes?6:0,marginBottom:4,display:"flex",justifyContent:"center"},children:(0,Ae.jsx)("div",{children:(0,Ae.jsx)(ie().A,{src:t.previewImageAttribute.values[0],style:{width:"100%",maxHeight:200}})})}):void 0,o?void 0:(0,Ae.jsx)("div",{style:m.actionButton,children:(0,Ae.jsx)(ee().A,{popupType:ee().z.Popup,placementToOrigin:"right",alignmentToOrigin:"start",originGap:4,onClose:()=>{let e=!1;const t=s.current;t&&(e=(0,r().ux)(t.getBoundingClientRect(),a().$C.x,a().$C.y)),e||null==p||p()},renderOrigin:e=>(0,Ae.jsx)(u().Ay,{style:m.buttonOrigin,...e,children:(0,y()._)({width:14})}),render:e=>(0,Ae.jsx)(le().ExternalObjectInstanceBlockMenu,{titleForReloadMenuOption:(0,Ae.jsx)(A().sA,{id:"linkMention.reload",defaultMessage:"Reload mention"}),parentBlockStore:c,store:i,token:l,onAccept:()=>e.close(),extraSecondaryItemKey:"mention_to_preview"})})})]})}function ri(e){var t;const{renderConfig:i,store:n,integration:o,haveInstanceAction:s,containerDivRef:l,token:c,parentBlockStore:p,onDismiss:m}=e,g=(0,d().IS)((e=>({dictionaryValue:{color:e.text.primary,fontSize:M().J.UISmall.desktop,whiteSpace:"normal",wordBreak:"break-word"},channelValue:{color:e.text.secondary,fontSize:M().J.UISmall.desktop,whiteSpace:"normal",wordBreak:"break-word"},buttonOrigin:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24,borderRadius:4,fill:e.icon.tertiary},author:{paddingTop:8,alignSelf:"stretch",alignItems:"center"},actionButton:{position:"absolute",top:10,insetInlineEnd:10,zIndex:2}})),[]),f=ei(i.dictionaryAttributes,"unfurling.generic.author"),h=function(e,t){if(!e)return null;return e.find((e=>e.key.formatter.id===t))||null}(i.dictionaryAttributes,"unfurling.slack.slackReplyCount"),v=ti(i.headerAttributes,["title","name"]),x=ti(i.headerAttributes,["sent_at"]),S=C().hS(i.icons||[],(e=>`${e.type}:${e.values[0].toString()}`)),b=S.length>5?5:S.length;return(0,Ae.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:295},children:[(0,Ae.jsxs)(ce().Ye,{alignItems:"center",style:{fontSize:12},children:[(0,Ae.jsxs)(Ae.Fragment,{children:[(0,Ae.jsx)(te().A,{type:"image_url",imageURL:o.icon,size:16,style:{padding:2}}),(0,Ae.jsx)("div",{style:{fontWeight:M().Wy.medium,marginInlineEnd:8},children:"Slack"})]}),v&&v.length>0?(0,Ae.jsx)(z().Ic,{attribute:v[0].attribute,store:n,style:g.channelValue,avatarStyle:{marginInlineEnd:6}}):void 0]}),(0,Ae.jsxs)(ce().Ye,{style:g.author,children:[f?(0,Ae.jsx)("div",{style:{width:"fit-content",display:"flex",alignItems:"center"},children:(0,Ae.jsx)(z().Ic,{...f,store:n,style:g.dictionaryValue})}):void 0,x?(0,Ae.jsx)("div",{style:{marginInlineStart:8},children:(0,Ae.jsx)(z().Ic,{...x[0],store:n,style:g.channelValue})}):void 0]}),(0,Ae.jsxs)(ce().wt,{style:{gap:8},children:[i.bodyAttribute&&!(0,w().Q7)(i.bodyAttribute)?(0,Ae.jsx)(ce().Ye,{style:((null===(t=i.dictionaryAttributes)||void 0===t?void 0:t.length)??0)>0?{marginTop:3}:{},children:(0,Ae.jsx)(z().xq,{attribute:i.bodyAttribute,store:n})}):void 0,(0,Ae.jsxs)(ce().Ye,{style:{alignSelf:"stretch",alignItems:"center"},children:[i.icons&&h?(0,Ae.jsx)(ai,{renderConfig:i}):void 0,h?(0,Ae.jsx)(z().Ic,{formatter:h.key.formatter,attribute:h.value.attribute,store:n,style:{...g.channelValue,transform:`translateX(-${3*(b-1)}px)`},avatarStyle:{marginInlineEnd:6}}):void 0]})]}),s?void 0:(0,Ae.jsx)("div",{style:g.actionButton,children:(0,Ae.jsx)(ee().A,{popupType:ee().z.Popup,placementToOrigin:"right",alignmentToOrigin:"start",originGap:4,onClose:()=>{let e=!1;const t=l.current;t&&(e=(0,r().ux)(t.getBoundingClientRect(),a().$C.x,a().$C.y)),e||null==m||m()},renderOrigin:e=>(0,Ae.jsx)(u().Ay,{style:g.buttonOrigin,...e,children:(0,y()._)({width:14})}),render:e=>(0,Ae.jsx)(le().ExternalObjectInstanceBlockMenu,{titleForReloadMenuOption:(0,Ae.jsx)(A().sA,{id:"linkMention.reload",defaultMessage:"Reload mention"}),parentBlockStore:p,store:n,token:c,onAccept:()=>e.close(),extraSecondaryItemKey:"mention_to_preview"})})})]})}function si(e){const{renderConfig:t,store:i,integration:n,haveInstanceAction:o,containerDivRef:s,token:l,parentBlockStore:c,onDismiss:p,fileType:m}=e,g=(0,d().IS)((e=>({dictionaryValue:{color:e.text.primary,fontSize:M().J.UISmall.desktop,whiteSpace:"normal",wordBreak:"break-word"},buttonOrigin:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24,borderRadius:4,fill:e.icon.tertiary},actionButton:{position:"absolute",top:10,insetInlineEnd:10,zIndex:2},imageBackground:{marginTop:t.dictionaryAttributes?6:0,marginBottom:4,display:"flex",justifyContent:"center",padding:"docs"===m?"14px 54px":"14px 34px",borderRadius:6,background:"doc"===m?"#4285F4":"sheet"===m?"#34A853":"#F8CB4A"}})),[m,t.dictionaryAttributes]),f=ii(t.dictionaryAttributes,"username"),h=ii(t.dictionaryAttributes,"updated_at"),v="doc"===m?"Google Docs":"sheet"===m?"Google Sheets":"Google Slides";return(0,Ae.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:288},children:[(0,Ae.jsx)(ce().Ye,{alignItems:"center",style:{fontSize:12},children:(0,Ae.jsxs)(Ae.Fragment,{children:[(0,Ae.jsx)(te().A,{type:"image_url",imageURL:n.icon,size:16,style:{marginInlineEnd:4}}),(0,Ae.jsx)("div",{style:{fontWeight:M().Wy.medium},children:v})]})}),(0,Ae.jsxs)(ce().Ye,{style:{gap:4,alignSelf:"stretch",alignItems:"center"},children:[h?(0,Ae.jsxs)("div",{style:{width:"fit-content",display:"flex",alignItems:"center",gap:4},children:[(0,Ae.jsx)("div",{style:g.dictionaryValue,children:(0,Ae.jsx)(A().sA,{id:"unfurling.generic.editor",defaultMessage:"Edited"})}),(0,Ae.jsx)(z().Ic,{...h,store:i,style:g.dictionaryValue})]}):void 0,f?(0,Ae.jsxs)("div",{style:{width:"fit-content",display:"flex",alignItems:"center",gap:4},children:[(0,Ae.jsx)("div",{style:g.dictionaryValue,children:(0,Ae.jsx)(A().sA,{id:"unfurling.generic.from",defaultMessage:"by"})}),(0,Ae.jsx)(z().Ic,{...f,store:i,style:g.dictionaryValue})]}):void 0]}),t.previewImageAttribute?(0,Ae.jsx)("div",{style:g.imageBackground,children:(0,Ae.jsx)("div",{children:(0,Ae.jsx)(ie().A,{src:t.previewImageAttribute.values[0],style:{width:"100%",maxHeight:200}})})}):void 0,o?void 0:(0,Ae.jsx)("div",{style:g.actionButton,children:(0,Ae.jsx)(ee().A,{popupType:ee().z.Popup,placementToOrigin:"right",alignmentToOrigin:"start",originGap:4,onClose:()=>{let e=!1;const t=s.current;t&&(e=(0,r().ux)(t.getBoundingClientRect(),a().$C.x,a().$C.y)),e||null==p||p()},renderOrigin:e=>(0,Ae.jsx)(u().Ay,{style:g.buttonOrigin,...e,children:(0,y()._)({width:14})}),render:e=>(0,Ae.jsx)(le().ExternalObjectInstanceBlockMenu,{titleForReloadMenuOption:(0,Ae.jsx)(A().sA,{id:"linkMention.reload",defaultMessage:"Reload mention"}),parentBlockStore:c,store:i,token:l,onAccept:()=>e.close(),extraSecondaryItemKey:"mention_to_preview"})})})]})}function ai({renderConfig:e}){const t=C().hS(e.icons||[],(e=>`${e.type}:${e.values[0].toString()}`));return t.length>=2?(0,Ae.jsx)(ce().Ye,{style:{height:16,gap:-5.333,justifyContent:"flex-end"},children:t.slice(0,5).map(((e,t)=>(0,Ae.jsx)(z().Tr,{attribute:e,isSmall:!0,isUltraSmall:!0,style:{zIndex:10-t,transform:`translateX(${-5*t}px)`,position:"relative"}},t)))}):1===t.length?(0,Ae.jsx)("div",{style:{paddingInlineEnd:4},children:(0,Ae.jsx)(z().Tr,{attribute:t[0],isSmall:!0,isUltraSmall:!0})}):null}function li(e){const{state:{annotation:t,store:i,token:o},onDismiss:p}=e,m=I().T$c(t),h=(0,s().v3)(),v=(0,d().DP)(),x=(0,n.useRef)(null),[b,j]=(0,n.useState)(!1),[k,w]=(0,n.useState)(!1),C=(0,l().K8)((()=>{const t=q().B.createChildStore(i,{table:S().ev,id:m,spaceId:i.pointer.spaceId}),n=t.canEdit(),s=(0,U().yO)(),l=(0,O().Su)({store:t,isInDarkMode:"dark"===v.mode,canEdit:n,currentUserId:h.currentUser.id,getRenderFn:e=>t=>{var i,n;return(null===(i=e.hover)||void 0===i?void 0:i.call(e,t))||(null===(n=g().u.hover)||void 0===n?void 0:n.call(g().u,t))},showAction:void 0});if(!l)return;if(!c().A.state.online)return;const{renderConfig:d,integration:b}=l,I=Boolean(l.action),k=e.isHoveredTokenEditable,C=i.recordStoreUIParentStore&&i.recordStoreUIParentStore instanceof q().B?i.recordStoreUIParentStore:void 0,B=b.id===f().Hd&&"error"===(null==l?void 0:l.action)&&428===(null==l?void 0:l.status_code),T=b.id===f().Hd&&"update"===(null==l?void 0:l.action);if(j(B),w(T),s){if(b.id===f().bh||b.id===f().ZY)return(0,Ae.jsx)(ni,{store:t,integration:b,renderConfig:d,haveInstanceAction:I,containerDivRef:x,token:o,parentBlockStore:C,onDismiss:p});if(b.id===f().e1)return(0,Ae.jsx)(oi,{store:t,integration:b,renderConfig:d,haveInstanceAction:I,containerDivRef:x,token:o,parentBlockStore:C,onDismiss:p});if(b.id===f().zG)return(0,Ae.jsx)(ri,{store:t,integration:b,renderConfig:d,haveInstanceAction:I,containerDivRef:x,token:o,parentBlockStore:C,onDismiss:p});if(b.id===f().Hd){const e=t.getFormat().uri;let i="drive";if(e&&(i=e.includes("spreadsheets")?"sheet":e.includes("document")?"doc":e.includes("presentation")?"slide":"drive"),"drive"!==i)return(0,Ae.jsx)(si,{store:t,integration:b,renderConfig:d,haveInstanceAction:I,containerDivRef:x,token:o,parentBlockStore:C,onDismiss:p,fileType:i})}}return(0,Ae.jsxs)("div",{style:{display:"flex",flexDirection:"column"},ref:x,children:[B?void 0:(0,Ae.jsxs)(ce().Ye,{alignItems:"center",style:{fontSize:12},children:[T?null:(0,Ae.jsxs)(Ae.Fragment,{children:[(0,Ae.jsx)(te().A,{type:"image_url",imageURL:b.icon,size:16,style:{margin:4}}),(0,Ae.jsx)("div",{style:{flexGrow:1,fontWeight:M().Wy.medium},children:b.name})]}),o&&!I&&k?(0,Ae.jsx)("div",{children:(0,Ae.jsx)(ee().A,{popupType:ee().z.Popup,placementToOrigin:"right",alignmentToOrigin:"start",originGap:4,onClose:()=>{let e=!1;const t=x.current;t&&(e=(0,r().ux)(t.getBoundingClientRect(),a().$C.x,a().$C.y)),e||null==p||p()},renderOrigin:e=>(0,Ae.jsx)(u().Ay,{style:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24,borderRadius:4,fill:v.icon.tertiary},...e,children:(0,y()._)({width:14})}),render:e=>(0,Ae.jsx)(le().ExternalObjectInstanceBlockMenu,{titleForReloadMenuOption:(0,Ae.jsx)(A().sA,{id:"linkMention.reload",defaultMessage:"Reload mention"}),parentBlockStore:C,store:t,token:o,onAccept:()=>e.close(),extraSecondaryItemKey:"mention_to_preview"})})}):void 0]}),I&&k?(0,Ae.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",margin:"6px 0"},children:(0,Ae.jsx)(ae().A,{canEdit:n,store:t,isHoverPreview:!0,postActionCallback:p})}):(0,Ae.jsx)(Qt,{renderConfig:d,store:t})]})}),[m,i,h,v,o,p,e.isHoveredTokenEditable,x]);return C?(0,Ae.jsx)("div",{style:{padding:k?"0px 4px":b?"0px 15px":"12px 16px",minWidth:260,maxWidth:450},children:C}):null}function di(e){const t=(0,s().v3)(),{store:i,contentBlockStart:n}=(0,l().K8)((()=>{const t=Y().default.state.sidebarSpaceStore;if(!t)return{store:void 0,contentBlockStart:void 0};const i="token"===e.state.type?e.state.annotation[1]:e.state.store.pointer.id,n=q().B.createChildStore(t,{id:i,table:"block"});if(!n.isNavigableBlock()){return{store:n.getNavigableBlockStore(),contentBlockStart:n}}return n.isDefined()?{store:n}:{store:void 0,contentBlockStart:void 0}}),[e.state]),o=(0,l().K8)((()=>!!i&&(0,H().Wi)(t,i.id)),[i,t]),r=(0,L().ME)(i);return o?null:i&&r&&e.originRect?(0,Ae.jsx)(st,{store:i,closestNonAliveAncestorStore:r,originRect:e.originRect}):(0,Ae.jsx)(Re().y,{store:i,contentBlocks:n&&[n]})}function ci(e){const t=(0,s().v3)(),{collectionStore:i,parentCollectionViewBlockStore:n}=(0,l().K8)((()=>{const t=Y().default.state.sidebarSpaceStore;if(!t)return{collectionStore:void 0,parentCollectionViewBlockStore:void 0};const i=e.state.annotation[1],n=X().m.createChildStore(t,{id:i,table:b().Vl});return{collectionStore:n,parentCollectionViewBlockStore:n.getParentCollectionViewBlockStore()}}),[e.state.annotation]),o=(0,L().ME)(n),r=(0,l().K8)((()=>!(null!=i&&i.getAlive())||Boolean(o)),[i,o]),a=(0,l().K8)((()=>!!n&&(0,H().Wi)(t,n.id)),[n,t]);return i&&n&&!a?r&&e.originRect?(0,Ae.jsx)(st,{store:i,closestNonAliveAncestorStore:o,originRect:e.originRect}):(0,Ae.jsx)(ui,{collectionStore:i,parentCollectionViewBlockStore:n}):null}function ui(e){const{collectionStore:t,parentCollectionViewBlockStore:i,events:n,size:o="regular"}=e,r=(0,Vt().d)(),s=(0,l().K8)((()=>null==t?void 0:t.getIcon()),[t]);return t&&i?(0,Ae.jsxs)("div",{style:r.wrapper,...n,children:[(0,Ae.jsx)("div",{style:r.coverContainer,children:(0,Ae.jsx)(F().d,{store:i,disabled:!0,paddingLeft:0,paddingRight:0,height:36,proxyWidth:260})}),(0,Ae.jsx)(oe().B6,{disabled:!0,icon:s,iconRecordCategory:"collection",isEmptyPage:!1,isLarge:!0,disableShrinking:!0,size:26,emojiSize:26,largeIcon:!0,style:r.pageTitleIcon}),(0,Ae.jsxs)(ce().wt,{gap:4,style:r.content,children:[(0,Ae.jsxs)(ce().wt,{gap:2,children:[(0,Ae.jsx)(re().Ay,{store:t,style:r.breadcrumb}),(0,Ae.jsx)("div",{style:r.pageTitleContainer,children:(0,Ae.jsx)(se().A,{shouldWrap:!0,maxLines:2,store:t,style:r.pageTitle})})]}),(0,Ae.jsx)($t().f,{store:i,size:o})]})]}):null}},865342:(e,t,i)=>{i.d(t,{Z:()=>d});i(296540);var n=()=>i(651124),o=()=>i(529099),r=()=>i(534177),s=()=>i(756123),a=()=>i(854672),l=i(474848);function d(e){const{icon:t,size:i=18}=e;if(!t)return(0,o().aiFaceIcon)({width:i,height:i});const d=(0,n().WO)(t);if(!d)return(0,o().aiFaceIcon)({width:i,height:i});switch(d.type){case"unicode_emoji":return(0,l.jsx)(s().A,{size:i,emoji:d.emoji.unicode,disableShrinking:!0});case"notion_icon":case"app_package_asset":return(0,l.jsx)(a().A,{type:d.type,size:i,icon:t,alt:"bot icon",isLoading:!1,progressPercent:0});case"custom_emoji":case"url":return(0,l.jsx)("img",{src:t,alt:"bot icon",style:{width:i,height:i,objectFit:"cover",borderRadius:2}});default:return(0,r().HB)(d)}}},913886:(e,t,i)=>{i.d(t,{D:()=>o});i(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"2.12 3.37 11.75 9.25",svg:(0,i(474848).jsx)("path",{d:"M4 3.375c-1.036 0-1.875.84-1.875 1.875v5.5c0 1.036.84 1.875 1.875 1.875h8c1.036 0 1.875-.84 1.875-1.875v-5.5c0-1.036-.84-1.875-1.875-1.875zm4 4.991L4.26 4.625h7.482zm-4.625 2.122v-4.98l2.49 2.49zm9.25 0-2.49-2.49 2.49-2.489zm-8.37.887 2.493-2.493.81.81c.244.244.64.244.884 0l.81-.81 2.492 2.493z"})},o=(0,i(340498).wt)("envelopeSmall",n)}}]);