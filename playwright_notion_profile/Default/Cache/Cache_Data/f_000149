"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[13297],{49650:(e,t,n)=>{n.d(t,{A:()=>o});n(898992),n(672577);class a extends(()=>n(959180))().A{findCollectionTemplatePickerItemFromStore(e){if(e)return this.find((t=>(null==t?void 0:t.templateStore)===e))}}const o=new a},89849:(e,t,n)=>{n.r(t),n.d(t,{eyeIcon:()=>i,iconDefinition:()=>o});n(296540);var a=n(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"0.96 4.19 18.07 11.62",svg:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("path",{d:"M10.17 6.694a3.307 3.307 0 0 1 3.135 3.303l-.005.17a3.305 3.305 0 0 1-3.3 3.137l-.17-.004a3.307 3.307 0 0 1-3.132-3.133l-.004-.17A3.307 3.307 0 0 1 10 6.69zm-.17 2.2a1.104 1.104 0 0 0 0 2.207 1.103 1.103 0 0 0 0-2.207"}),(0,a.jsx)("path",{d:"M10 4.194c3.878 0 7.26 2.075 8.862 5.127l.073.163c.126.333.126.7 0 1.033l-.073.163c-1.602 3.052-4.984 5.126-8.862 5.126-3.757 0-7.049-1.946-8.707-4.843l-.156-.283a1.46 1.46 0 0 1 0-1.359l.156-.283C2.95 6.141 6.243 4.194 10 4.194m0 1.251c-3.33 0-6.196 1.724-7.622 4.214l-.134.243a.21.21 0 0 0 0 .197l.134.243c1.426 2.49 4.292 4.214 7.622 4.214 3.437 0 6.38-1.837 7.756-4.457l.018-.048a.2.2 0 0 0 0-.1l-.018-.049C16.38 7.282 13.437 5.445 10 5.445"})]})},i=(0,n(340498).wt)("eye",o)},104636:(e,t,n)=>{n.d(t,{Is:()=>u,LS:()=>f,NH:()=>g,QA:()=>p,_b:()=>m});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698);var a=()=>n(906745),o=(n(296540),()=>n(390527)),i=()=>n(604995),r=()=>n(69708),s=()=>n(488887),l=()=>n(534177),c=()=>n(227894),d=n(474848);function u(e){const t=(0,c().g)(e)??[],n=[];for(const a of t){if(!("block"===a.table&&!0===a.isTemplate()&&a.getFormat().automation_id&&a.id!==e.id))continue;const t=a.getAutomationStore();if(t){if(!t.isReady())return{automationStoresReady:!1};void 0!==t.getRecurrence()&&t.isDefined()&&n.push(t.getModel())}}return{automationStoresReady:!0,...(0,o().templateAncestorsViolateRecurrenceNesting)(n)}}function m(e){switch(e){case"day":return(0,d.jsx)(r().sA,{defaultMessage:"Repeat daily",id:"database.templatePickerItem.recurrenceFrequency.daily"});case"week":return(0,d.jsx)(r().sA,{defaultMessage:"Repeat weekly",id:"database.templatePickerItem.recurrenceFrequency.weekly"});case"month":return(0,d.jsx)(r().sA,{defaultMessage:"Repeat monthly",id:"database.templatePickerItem.recurrenceFrequency.monthly"});case"year":return(0,d.jsx)(r().sA,{defaultMessage:"Repeat yearly",id:"database.templatePickerItem.recurrenceFrequency.yearly"});default:(0,l().HB)(e)}}function p(){return{start_date:a().c9.local().plus({days:1}).set({hour:0,minute:0,second:0,millisecond:0}).toMillis(),timezone:(0,i().dB)(),hour:0,minute:0,frequency:"day",interval:1}}function f(e){const{recurrence:t,intl:n,leadingPhrase:a}=e;return(0,o().rruleFromRecurrence)({..."month"===t.frequency?{...t,monthly_restriction:void 0}:t,weekdays:void 0,hour:0,minute:0,end_condition:void 0}).toText((e=>{switch(e){case"every":if(void 0===a)return"";if("every"===a)return n.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.every",defaultMessage:"every"});if("repeat every"===a)return n.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.repeatEvery",defaultMessage:"repeat every"});(0,l().HB)(a);break;case"day":return n.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.day",defaultMessage:"day"});case"days":return n.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.days",defaultMessage:"days"});case"week":{const e=(null==t?void 0:t.weekdays)||[];return 5===e.length&&(0,s()._)(new Set(e),new Set(["MO","TU","WE","TH","FR"]))?n.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.weekday",defaultMessage:"weekday"}):n.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.week",defaultMessage:"week"})}case"weeks":return n.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.weeks",defaultMessage:"weeks"});case"month":return n.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.month",defaultMessage:"month"});case"months":return n.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.months",defaultMessage:"months"});case"year":return n.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.year",defaultMessage:"year"});case"years":return n.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.years",defaultMessage:"years"});default:return e.toString()}})).trim()}function g(e){const t=e.getRecurrence();return Boolean(e.isTriggerType("recurrence")&&t&&"disabled_recurrence_ended"===e.getStatus())}},132855:(e,t,n)=>{n.r(t),n.d(t,{arrowInCircleUpFillIcon:()=>o,iconDefinition:()=>a});n(296540);const a={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.25 15.26",svg:(0,n(474848).jsx)("path",{d:"M10 17.625a7.625 7.625 0 1 0 0-15.25 7.625 7.625 0 0 0 0 15.25m3.042-8.07a.625.625 0 0 1-.884 0L10.625 8.02v5.466a.625.625 0 1 1-1.25 0V8.021L7.842 9.554a.625.625 0 1 1-.884-.883l2.6-2.6a.625.625 0 0 1 .884 0l2.6 2.6a.625.625 0 0 1 0 .883"})},o=(0,n(340498).wt)("arrowInCircleUpFill",a)},286611:(e,t,n)=>{n.d(t,{J:()=>h});var a=n(296540),o=()=>n(484714),i=()=>n(56366),r=()=>n(401497),s=()=>n(718827),l=()=>n(396896),c=n(474848);const d=(0,n(340498).wt)("repeatDisabled",{viewBox:"0 0 16 14",svg:(0,c.jsxs)("svg",{children:[(0,c.jsx)("path",{d:"M1.11621 8.32422C0.888346 8.32422 0.69694 8.24674 0.541992 8.0918C0.391602 7.93685 0.316406 7.74772 0.316406 7.52441V6.77246C0.316406 6.08431 0.469076 5.49186 0.774414 4.99512C1.08431 4.49837 1.51953 4.11784 2.08008 3.85352C2.64518 3.58464 3.31283 3.4502 4.08301 3.4502H9.23047V1.95312C9.23047 1.76628 9.28288 1.62272 9.3877 1.52246C9.49251 1.41764 9.63607 1.36523 9.81836 1.36523C9.90495 1.36523 9.9847 1.37891 10.0576 1.40625C10.1305 1.43359 10.1966 1.47233 10.2559 1.52246L13.0107 3.83301C13.1566 3.9515 13.2272 4.09277 13.2227 4.25684C13.2227 4.4209 13.152 4.56217 13.0107 4.68066L10.2559 6.99121C10.1966 7.03678 10.1305 7.07552 10.0576 7.10742C9.9847 7.13477 9.90495 7.14844 9.81836 7.14844C9.63607 7.14844 9.49251 7.09603 9.3877 6.99121C9.28288 6.88639 9.23047 6.74284 9.23047 6.56055V5.00195H3.98047C3.34245 5.00195 2.83659 5.17741 2.46289 5.52832C2.09375 5.87923 1.90918 6.35319 1.90918 6.9502V7.52441C1.90918 7.74772 1.83171 7.93685 1.67676 8.0918C1.52181 8.24674 1.33496 8.32422 1.11621 8.32422ZM14.8906 7.54492C15.1094 7.54492 15.2962 7.6224 15.4512 7.77734C15.6061 7.92773 15.6836 8.11686 15.6836 8.34473V9.09668C15.6836 9.78483 15.5286 10.3773 15.2188 10.874C14.9134 11.3708 14.4782 11.7536 13.9131 12.0225C13.348 12.2868 12.6803 12.4189 11.9102 12.4189H6.7627V13.9229C6.7627 14.1051 6.71029 14.2464 6.60547 14.3467C6.50521 14.4515 6.36393 14.5039 6.18164 14.5039C6.09505 14.5039 6.01302 14.4902 5.93555 14.4629C5.86263 14.4355 5.79655 14.3968 5.7373 14.3467L2.98242 12.0361C2.84115 11.9222 2.77051 11.7832 2.77051 11.6191C2.77051 11.4505 2.84115 11.307 2.98242 11.1885L5.7373 8.87793C5.79655 8.8278 5.86263 8.78906 5.93555 8.76172C6.01302 8.73438 6.09505 8.7207 6.18164 8.7207C6.36393 8.7207 6.50521 8.77311 6.60547 8.87793C6.71029 8.97819 6.7627 9.12174 6.7627 9.30859V10.8604H12.0127C12.6553 10.8604 13.1611 10.6872 13.5303 10.3408C13.904 9.98991 14.0908 9.51595 14.0908 8.91895V8.34473C14.0908 8.11686 14.166 7.92773 14.3164 7.77734C14.4714 7.6224 14.6628 7.54492 14.8906 7.54492Z",fill:"#C7C6C4"}),(0,c.jsx)("path",{d:"M4 2L12 14",stroke:"white",strokeWidth:"3",strokeLinecap:"round"}),(0,c.jsx)("path",{d:"M4 2L12 14",stroke:"#C7C6C4",strokeLinecap:"round"})]})});var u=()=>n(69708),m=()=>n(284371),p=()=>n(755199),f=()=>n(765957);function g(){const[e,t]=(0,a.useState)(!1),r=(0,o().v3)(),s=(0,i().O$)(f().AppStoreCurrentUserSettingsStore);return[(0,i().K8)((()=>{const t=n(242422).default.checkGate({gateName:"dictation_new_page_nux"}),a=null==s?void 0:s.getSettings(),o=Boolean(null==a?void 0:a.dismissed_dictation_new_page_nux);return t&&!o&&!e}),[s,e]),(0,a.useCallback)((()=>{s&&(t(!0),p().wG({environment:r,userSettingsStore:s,dismissed:!0}))}),[r,s,t])]}(0,n(852832).exposeDebugValue)("resetDictationTooltip",(e=>{const t=f().default.state.currentUserSettingsStore;t&&p().wG({environment:e,userSettingsStore:t,dismissed:!1})}));var y=()=>n(301948),k=()=>n(760217);const v=(0,u().YK)({horizontalNewPageDictationItemTooltip:{id:"TemplatePickerMenuItem.dictationCallout.tooltip",defaultMessage:"Use your voice to write"},dictationCalloutHeader:{id:"TemplatePickerMenuItem.dictationCallout.Header",defaultMessage:"Use your voice to write with high-quality speech-to-text"}}),h=(0,a.forwardRef)((function(e,t){const{format:n,className:a,icon:o,title:i,isDefault:r,isChecked:s,recurrence:l,recurrenceDisabled:d,right:u,focused:m,onClick:p,onMouseMove:f,onMouseEnter:g,onMouseLeave:y,locked:k,type:v}=e;return"collection-overlay"===n?(0,c.jsx)(C,{ref:t,className:a,icon:o,format:n,title:i,isDefault:r,isChecked:s,recurrence:l,recurrenceDisabled:d,right:u,focused:m,onClick:p,onMouseMove:f,onMouseEnter:g,onMouseLeave:y,locked:k,type:v}):"phone-modal"===n?(0,c.jsx)(x,{ref:t,icon:o,format:n,title:i,isDefault:r,isChecked:s,recurrence:l,focused:m,onClick:p}):"horizontal-new-page"===n?"dictation"===v?(0,c.jsx)(I,{ref:t,focused:m,onClick:p,onMouseMove:f,onMouseEnter:g,onMouseLeave:y,icon:o,title:i,type:v}):(0,c.jsx)(S,{ref:t,focused:m,onClick:p,onMouseMove:f,onMouseEnter:g,onMouseLeave:y,icon:o,title:i,type:v}):"horizontal-new-page-submenu"===n?(0,c.jsx)(w,{ref:t,focused:m,onClick:p,onMouseMove:f,onMouseEnter:g,onMouseLeave:y,icon:o,title:i}):(0,c.jsx)(b,{ref:t,focused:m,onClick:p,onMouseMove:f,onMouseEnter:g,onMouseLeave:y,icon:o,format:n,title:i,isDefault:r,isChecked:s,recurrence:l,recurrenceDisabled:d,right:u})}));function M(e){const{format:t,title:a,isDefault:o,isChecked:i,recurrenceDisabled:s}=e,l=(0,r().IS)((e=>({container:{display:"flex",justifyContent:"space-between",alignItems:"center"},text:{display:"flex",alignItems:"center",marginInlineStart:8},default:{fontSize:12,fontWeight:m().Wy.medium,color:e.text.tertiary,borderRadius:4,background:e.background.secondary,padding:"1px 6px"},icon:{width:14,height:12.25,color:n(100622).Tj.lightIconColor,marginInlineStart:8},checkmark:{width:16,height:16,color:e.text.primary,marginInlineStart:8}})),[]);return"collection-overlay"!==t?(0,c.jsx)(c.Fragment,{children:a}):(0,c.jsxs)("div",{style:l.container,children:[a,(0,c.jsxs)("span",{style:l.text,children:[o?(0,c.jsx)("span",{style:l.default,children:(0,c.jsx)(u().sA,{defaultMessage:"Default",id:"database.templatePickerMenuItem.default"})}):void 0,i?(0,n(29037).checkmarkIcon)(l.checkmark):null,s?d(l.icon):null]})]})}const C=(0,a.forwardRef)((function(e,t){const{className:n,icon:a,format:i,title:r,isDefault:s,isChecked:l,recurrence:d,recurrenceDisabled:u,right:m,focused:p,onClick:f,onMouseMove:g,onMouseEnter:y,onMouseLeave:v,locked:h,type:C}=e,{isMobile:x}=(0,o().Y0)();return(0,c.jsx)(k().A,{ref:t,className:n,icon:a,title:(0,c.jsx)(M,{format:i,title:r,isDefault:s,isChecked:l,recurrence:d,recurrenceDisabled:u}),right:m,focused:p,onClick:f,onMouseMove:g,onMouseEnter:y,onMouseLeave:v,showDragHandle:!x&&!h,dragHandleDisabled:"empty_page"===C})})),x=(0,a.forwardRef)((function(e,t){const{icon:n,format:a,title:o,isDefault:i,isChecked:s,recurrence:l,focused:d,onClick:u}=e,m=(0,r().IS)((()=>({icon:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24}})),[]);return(0,c.jsx)(k().A,{ref:t,icon:n?(0,c.jsx)("div",{style:m.icon,children:n}):null,title:(0,c.jsx)(M,{format:a,title:o,isDefault:i,isChecked:s,recurrence:l}),focused:d,onClick:u,showDragHandle:!1})})),b=(0,a.forwardRef)((function({focused:e,onClick:t,onMouseMove:a,onMouseEnter:l,onMouseLeave:d,icon:u,format:m,title:p,isDefault:f,isChecked:g,recurrence:y,recurrenceDisabled:k,right:v},h){const{isMobile:C}=(0,o().Y0)(),x=(0,n(792485).S)(),b=(0,i().K8)((()=>{const e=null==x?void 0:x.publicEditModeStore.state;return(0,n(68465).ZE)(e)}),[x]),S=(0,r().IS)((e=>({container:{...n(799954).CC,display:"flex",alignItems:"center",flexGrow:1,height:C?36:32,fontSize:16,borderRadius:4,paddingInlineStart:8,marginBottom:2,color:b?e.text.secondary:e.text.tertiary},icon:{display:"flex",alignItems:"center",width:24,height:24,marginInlineEnd:10},hovered:{background:e.buttonHoveredBackground,color:e.text.primary},pressed:{background:e.buttonPressedBackground},right:{marginInlineStart:"auto",marginInlineEnd:4}})),[b,C]);return(0,c.jsxs)(s().Ay,{style:S.container,hovered:e,onClick:t,onMouseMove:a,onMouseEnter:l,onMouseLeave:d,hoveredStyle:S.hovered,pressedStyle:S.pressed,children:[(0,c.jsx)("div",{style:S.icon,children:u}),(0,c.jsx)(M,{format:m,title:p,isDefault:f,isChecked:g,recurrence:y,recurrenceDisabled:k}),v?(0,c.jsx)("div",{style:S.right,children:v}):null]})})),S=(0,a.forwardRef)((function(e,t){const{focused:n,onClick:a,onMouseMove:o,onMouseEnter:i,onMouseLeave:d,icon:u,title:p,type:f,tooltipEvents:g}=e,y=(0,r().IS)((e=>({container:{display:"flex",alignItems:"center",paddingTop:6,paddingInlineEnd:14,paddingBottom:6,paddingInlineStart:10,background:e.background.tertiaryTranslucent,borderRadius:100,fontSize:13,fontWeight:m().Wy.medium,..."more"===f?{width:32,height:32,padding:0,justifyContent:"center"}:{},...n?{background:(0,s().i)({color:e.background.tertiaryTranslucent,mode:e.mode})}:{}}})),[n,f]);return(0,c.jsx)("div",{ref:t,onClick:a,onMouseMove:o,onMouseEnter:i,onMouseLeave:d,...g||{},style:y.container,children:(0,c.jsxs)(l().fI,{gap:4,alignItems:"center",children:[u,p]})})})),w=(0,a.forwardRef)((function(e,t){const{focused:n,onClick:a,onMouseMove:o,onMouseEnter:i,onMouseLeave:s,icon:d,title:u}=e,m=(0,r().IS)((e=>{const t={background:e.background.tertiaryTranslucent,borderRadius:6};return{container:{display:"flex",alignItems:"center",paddingTop:4,paddingInlineEnd:10,paddingBottom:4,paddingInlineStart:8,...n?t:{}}}}),[n]);return(0,c.jsx)("div",{ref:t,onClick:a,onMouseMove:o,onMouseEnter:i,onMouseLeave:s,style:m.container,children:(0,c.jsxs)(l().fI,{gap:8,alignItems:"center",children:[d,u]})})})),I=(0,a.forwardRef)((function(e,t){const o=(0,a.useRef)(null),[i,s]=g(),l=(0,r().IS)((e=>({tooltipContainer:{display:"flex",flexDirection:"row",gap:"6px",padding:"0px 0",alignItems:"center",marginInlineStart:"-4px"},tooltip:{width:200},badge:{background:e.palette.translucentGray[300],color:e.text.inverseSecondary,marginInlineStart:0,width:"fit-content"}})),[]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n(594607).B,{shouldShow:i,calloutId:"dictation_new_page_origin_element_tooltip",children:(0,c.jsx)(n(953006).k,{style:l.tooltip,pointerLength:25,pointerPosition:"50%",origin:o,placementToOrigin:"top",alignmentToOrigin:"center",header:(0,c.jsx)(y().A,{style:l.badge}),content:(0,c.jsx)(u().sA,{...v.dictationCalloutHeader}),shouldDismissUponOutsideClick:!0,onCloseClick:s})}),(0,c.jsx)(n(859428).A,{disableTooltip:i,renderTooltip:()=>(0,c.jsxs)("div",{style:l.tooltipContainer,children:[(0,c.jsx)(y().A,{style:l.badge}),(0,c.jsx)(u().sA,{...v.horizontalNewPageDictationItemTooltip})]}),originGap:6,placement:"top",render:n=>(0,c.jsx)("div",{ref:o,children:(0,c.jsx)(S,{...e,ref:t,tooltipEvents:n})})})]})}))},485894:(e,t,n)=>{n.d(t,{k:()=>o,q:()=>i});var a=()=>n(645873);const o=new(a().O2)("recurrence",(async()=>{const[e,t,{TemplateRecurrenceConfigMenu:a}]=await Promise.all([Promise.all([n.e(9773),n.e(36556),n.e(40537),n.e(92845),n.e(4422),n.e(31276),n.e(40551),n.e(29021)]).then(n.bind(n,839916)),Promise.all([n.e(9773),n.e(36556),n.e(40537),n.e(92845),n.e(4422),n.e(31276),n.e(40551),n.e(29021)]).then(n.bind(n,390527)),Promise.all([n.e(9773),n.e(36556),n.e(40537),n.e(92845),n.e(4422),n.e(31276),n.e(40551),n.e(29021)]).then(n.bind(n,31644))]);return{recurrenceActions:e,recurrenceHelpers:t,TemplateRecurrenceConfigMenu:a}})),i=(0,a().jQ)(o,(e=>e.TemplateRecurrenceConfigMenu))},488887:(e,t,n)=>{function a(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}n.d(t,{_:()=>a})},763996:(e,t,n)=>{n.d(t,{K:()=>Z});var a=n.n(n(32485)),o=n(296540),i=()=>n(314529),r=()=>n(110525),s=()=>n(484714),l=()=>n(56366),c=()=>n(401497),d=()=>n(30537),u=()=>n(584262),m=()=>n(859384),p=()=>n(764781),f=()=>n(89849),g=()=>n(748054),y=()=>n(236262),k=()=>n(69708),v=()=>n(100622),h=()=>n(496603),M=()=>n(284371),C=()=>n(160568),x=()=>n(557281),b=()=>n(901389),S=()=>n(896628),w=()=>n(577142),I=()=>n(231297),A=()=>n(813297),j=()=>n(104636),T=()=>n(908201),D=()=>n(31902),_=()=>n(485894),E=()=>n(158658),P=()=>n(38337),R=()=>n(492414),L=()=>n(972435),O=()=>n(722872),N=()=>n(765957),B=()=>n(463830),V=()=>n(575143),F=()=>n(802790),K=()=>n(404277),z=()=>n(678553),H=()=>n(939740),U=()=>n(187820),q=()=>n(16006),W=()=>n(89924),G=()=>n(719147),Y=n(474848);const Q=(0,k().YK)({emptyPageTitle:{defaultMessage:"Empty",id:"database.templatePicker.emptyPageTitle"}}),Z=o.memo(o.forwardRef((function(e,t){const{templateStore:a,isMobile:i,isOverlay:r,isDefault:d,isChecked:u,locked:m,canConfigureCollection:p,draggable:f,recurrence:g,recurrenceDisabled:y,recurrenceButtonDisabled:k,collectionStore:v,focused:M}=e,C=(0,s().Y0)(),x=(0,s().v3)(),[b,S]=(0,o.useState)(!1),w=(0,l().uB)(void 0,B().A),I=!a&&!r;(0,l().K8)((()=>{if(!a)return!1;const e=a.getAutomationPointer();return!!e&&(0,n(322931).z)(a,e)}),[a]);const A=(0,l().K8)((()=>{var e;return Boolean(null===(e=v.getParentBlockStore())||void 0===e?void 0:e.canEditContentOnly())}),[v]),j=(0,l().K8)((()=>(!m||m&&!f)&&(p||A)&&(b||w.state.open||i||r)&&!I),[m,f,p,A,b,w,i,r,I]),T=(0,l().K8)((()=>!a||a.isEmptyPage()),[a]),D=(0,l().K8)((()=>{var e;return null==a||null===(e=a.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:v.getRecordModel})}),[a,v]),E=(0,l().K8)((()=>(0,U().Te)(a)),[a]),R=(0,o.useRef)(null);(0,n(790748).b)(n(49650).A,(()=>({templateStore:a,getNode:()=>R.current})),[a]);const O=(0,c().IS)((e=>({contents:{display:"contents"},recordIcon:{...!r&&{pointerEvents:"none",marginInlineEnd:10}},pageIcon:{...!r&&{fill:e.icon.tertiary}}})),[r]),N=(0,o.useCallback)((()=>{S(!0)}),[]),V=(0,o.useCallback)((()=>{S(!1)}),[]),F=a?(0,Y.jsx)(q().A,{enableHover:!0,showTooltipWhenTruncated:!0,store:a}):L().A.formatMessage(Q.emptyPageTitle),K=(0,l().uB)(void 0,B().A),z=(0,l().K8)((()=>K.state.open),[K]),H=(g||z)&&a;return(0,Y.jsx)("div",{ref:R,style:O.contents,children:(0,Y.jsx)(n(286611).J,{ref:t,className:P().SDd,type:a?"custom_template":"empty_page",format:r?"collection-overlay":"page-menu-item",locked:m||!p||!f,icon:(0,Y.jsx)(U().B6,{disabled:!0,icon:D,iconRecordCategory:E,isEmptyPage:T,size:C.isMobile&&r?24:20,isLarge:!r,style:O.recordIcon,pageIconStyle:O.pageIcon}),title:F,onClick:e.onClick,onMouseEnter:e.onMouseEnter,right:j?(0,Y.jsxs)(n(396896).fI,{alignItems:"center",gap:2,children:[H?(0,Y.jsx)(_().q,{...h().cJ(e,["onClick"]),focused:M,disabled:k,recurrence:g,showTooltip:!0,variant:"icon",buttonPopupStore:K,onChange:async e=>{const{recurrenceActions:t}=await _().k.load();e?t.addRecurrence({environment:x,blockStore:a,recurrence:e}):t.deleteRecurrence({environment:x,blockStore:a})}}):null,(0,Y.jsx)(J,{templateStore:a,buttonPopupStore:w,isOverlay:r,canEditContentOnly:A,onCancelClick:e.onCancelClick})]}):null,onMouseMove:N,onMouseLeave:V,focused:M,isDefault:d,isChecked:u,recurrence:g,recurrenceDisabled:y})})})));function J(e){const{templateStore:t,buttonPopupStore:o,isOverlay:i,canEditContentOnly:r,onCancelClick:c}=e,u=(0,s().v3)(),{isMobile:m}=(0,s().Y0)(),p=(0,l().K8)((()=>!!t&&(0,E().p)({environment:u,blocks:[t],publicEditMode:void 0})),[t,u]);return(0,Y.jsx)(n(859428).A,{renderTooltip:()=>p?(0,Y.jsx)(k().sA,{defaultMessage:"Edit this template",id:"database.templatePickerItem.editTemplate.tooltip"}):(0,Y.jsx)(k().sA,{defaultMessage:"View this template",id:"database.templatePickerItem.viewTemplate.tooltip"}),delayThreshold:300,render:e=>(0,Y.jsx)(n(406699).A,{popupType:m?d().n.SlideUp:d().n.Popup,placementToOrigin:"right",originGap:12,buttonPopupStore:o,renderOrigin:t=>(0,Y.jsx)(n(911706).A,{className:a()(P().dn9,{[P().qGl]:m||i}),isMobile:m&&i,style:{...i?{marginInlineEnd:-4}:{marginInlineEnd:0}},...(0,n(553965).A)(e,t)}),render:e=>(0,Y.jsx)($,{templateStore:t,buttonPopupStore:o,canEditContentOnly:r,isOverlay:i,parent:e,onCancelClick:c}),onClick:()=>{C()._o(u,{template_action:"open_menu"})}})})}function $(e){const{templateStore:t,buttonPopupStore:n,canEditContentOnly:a,isOverlay:d,parent:u,onCancelClick:w}=e,P=(0,s().v3)(),R=(0,s().Y0)(),N=(0,T().ET)(),B=(0,o.useContext)(r().n),{collectionStore:U,collectionViewStore:Z}=(0,l().K8)((()=>({collectionStore:null==N?void 0:N.collectionStore(),collectionViewStore:null==N?void 0:N.collectionViewStore()})),[N]),J=(0,l().K8)((()=>!!t&&(0,E().p)({environment:P,blocks:[t],publicEditMode:void 0})),[t,P]),$=(0,l().K8)((()=>null==t?void 0:t.getAutomationStore()),[t]),te=(0,l().K8)((()=>null!=$&&$.isActive()?null==$?void 0:$.getRecurrence():void 0),[$]),ne=(0,l().K8)((()=>{if(!t)return!1;const e=(0,j().Is)(t);return!e.automationStoresReady||e.violatesConstraint}),[t]),ae=(0,l().K8)((()=>{if(t){const e=(0,j().Is)(t);if(e.automationStoresReady)return e}}),[t]),oe=(0,l().K8)((()=>Boolean(null==ae?void 0:ae.templateNestingExceedsMaxDepth)),[ae]),ie=(0,l().K8)((()=>null==ae?void 0:ae.immediateAncestorRecurrenceType),[ae]),re=(0,l().K8)((()=>Boolean(null==ae?void 0:ae.ancestorHasDailyTemplate)),[ae]),se=(le={templateNestingExceedsMaxDepth:oe,immediateAncestorRecurrenceType:ie,ancestorHasDailyTemplate:re,automationStore:$,environment:P},(0,l().K8)((()=>function(e){const{templateNestingExceedsMaxDepth:t,immediateAncestorRecurrenceType:n,ancestorHasDailyTemplate:a,automationStore:o,environment:i}=e,r="disabled_duplication"===(null==o?void 0:o.getStatus())||"disabled_inactive_space"===(null==o?void 0:o.getStatus());return r&&null!=o&&o.getAlive()?(0,Y.jsx)(k().sA,{defaultMessage:"This repeating template was turned off. <inlinelink>Turn on</inlinelink> with the same settings.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationCaptionDisabledDuringDuplication",values:{inlinelink:e=>(0,Y.jsx)(G().A,{external:!1,color:"notion-link-blue",hoverColor:"blue",onClick:()=>{!async function(e,t){if(!t)return;const{automationActions:n}=await A().QV.automations.load();I().createAndCommit({userAction:"CollectionTemplatePickerItem.setAutomationStatusToActive",environment:e,canUndo:!0,perform:a=>n.enableAutomation({automationStore:t,environment:e,transaction:a})})}(i,o)},children:e})}}):a?(0,Y.jsx)(k().sA,{defaultMessage:"It already gets created daily from another repeating template.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationCaptionNestedInDaily"}):t?(0,Y.jsx)(k().sA,{defaultMessage:"It already gets created automatically from other repeating templates.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationCaptionTooDeeplyNested"}):n?(0,Y.jsx)(k().sA,{defaultMessage:"This template is within another template that repeats every {immediateAncestorRecurrenceType}.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationCaptionNestedInTemplate",values:{immediateAncestorRecurrenceType:n}}):void 0}(le)),[le]));var le;const ce=(0,l().K8)((()=>null==$?void 0:$.isReady()),[$]),de=(0,c().IS)((()=>({nestingExplanationMenuItemTitle:{whiteSpace:"normal",fontWeight:M().Wy.medium,fontSize:M().J.UISmall.desktop},nestingExplanationMenuItemCaption:{whiteSpace:"normal",color:v().Tj.lightTextColor,fontWeight:M().Wy.regular,fontSize:M().J.UISmall.desktop}})),[]),ue=(0,o.useCallback)((e=>{if(!U||null==Z||!Z.isDefined())return;const n=null!=t&&t.id?{template_page_id:null==t?void 0:t.id}:"empty";b().ui({showCancel:!0,keepFocus:!1,message:(0,Y.jsx)(k().sA,{id:"database.collectionTemplatePickerItem.setAsDefaultDialog.message",defaultMessage:"<span>Use “{pageName}” as default template when creating new pages?</span>",values:{span:e=>(0,Y.jsx)("span",{children:e}),pageName:t?(0,Y.jsx)(q().A,{store:t,style:{display:"inline"}}):L().A.formatMessage(Q.emptyPageTitle)}}),items:[{label:(0,Y.jsx)(k().sA,{id:"database.collectionTemplatePickerItem.setAsDefaultDialog.setCollection",defaultMessage:"For all views in “{databaseName}”",values:{databaseName:(0,Y.jsx)(q().A,{store:U,style:{display:"inline"}})}}),onAccept:()=>{e.close(),I().createAndCommit({environment:P,userAction:"CollectionTemplatePickerItem.handleSetAsDefault:collection",canUndo:!0,perform:e=>{S().zA({stores:[U],update:{collection_default_template:n},transaction:e}),S().zA({stores:[Z],update:{collection_view_default_template:n},transaction:e})}})}},{label:(0,Y.jsx)(k().sA,{id:"database.collectionTemplatePickerItem.setAsDefaultDialog.setCollectionView",defaultMessage:"Only on “{viewName}” view",values:{viewName:(0,Y.jsx)(D().A,{collectionViewName:Z.getName(),collectionViewType:Z.getType()})}}),onAccept:()=>{e.close(),I().createAndCommit({environment:P,userAction:"CollectionTemplatePickerItem.handleSetAsDefault:collectionView",canUndo:!0,perform:e=>{S().zA({stores:[Z],update:{collection_view_default_template:n},transaction:e})}})}}]})}),[P,U,Z,t]);if(!U)return null;const me={key:"section",render:e=>(0,Y.jsx)(W().A,{...e}),items:h().oE([t&&J&&(!$||ce)&&!ne&&{key:"repeatControl",render:e=>t&&(0,Y.jsx)(_().q,{...e,recurrence:te,onChange:async e=>{const{recurrenceActions:n}=await _().k.load();e?n.addRecurrence({environment:P,blockStore:t,recurrence:e}):n.deleteRecurrence({environment:P,blockStore:t})}}),action:()=>function(e,t){(0,i().DO_NOT_USE_trackLegacy)(e,"recurrence_menu_open",{isConfigured:void 0!==t})}(P,te)},d&&!a&&{key:"Set default",render:e=>(0,Y.jsx)(V().A,{...e,title:(0,Y.jsx)(k().sA,{defaultMessage:"Set as default",id:"database.collectionTemplatePickerItem.actionMenu.setAsDefault"}),svg:g().M}),action:()=>ue(u)},t&&{key:"Edit",render:e=>(0,Y.jsx)(V().A,{...e,title:J?(0,Y.jsx)(k().sA,{defaultMessage:"Edit",id:"database.templatePickerItem.actionMenu.edit"}):(0,Y.jsx)(k().sA,{defaultMessage:"View",id:"database.templatePickerItem.actionMenu.view"}),svg:J?m().M:f().eyeIcon}),action:()=>function(e,t,n,a,o){if(!n)return;null==a||a(),ee(n,e,o),t.reset(),C()._o(e,{template_action:"edit"})}(P,n,t,w,B)},t&&!a&&J&&{key:"Duplicate",render:e=>(0,Y.jsx)(V().A,{...e,title:(0,Y.jsx)(k().sA,{defaultMessage:"Duplicate",id:"database.templatePickerItem.actionMenu.duplicate"}),svg:p().V}),action:e=>async function(e,t,n,a,o,i,r){if(!o)return;null==i||i();const{recurrenceActions:s}=await _().k.load(),{performResult:l}=I().createAndCommit({userAction:"CollectionTemplatePickerItem.duplicatedStore",environment:t,canUndo:!0,perform:a=>{const i=x().oZ({environment:t,event:e.event,collectionStore:n,templateStore:o,transaction:a});if(o.getAutomationId()){const e=o.getAutomationStore(),n=null==e?void 0:e.getRecurrence();e&&null!=e&&e.isActive()&&n&&s.createRecurrenceInner(a,t,i,n)}return i}});l&&ee(l,t,r);a.reset(),C()._o(t,{template_action:"duplicate"})}(e,P,U,n,t,w,B)},t&&!a&&J&&{key:"Delete",render:e=>(0,Y.jsx)(V().A,{...e,title:(0,Y.jsx)(k().sA,{defaultMessage:"Delete",id:"database.templatePickerItem.actionMenu.delete"}),svg:y().trashIcon}),action:J?()=>async function(e,t,n){if(!n)return;const{accept:a}=await b().Gh({message:(0,Y.jsx)(k().sA,{defaultMessage:"Delete this template?",id:"database.confirmDialog.templatePickerItem.deleteMessage"}),acceptLabel:(0,Y.jsx)(k().sA,{defaultMessage:"Delete",id:"database.confirmDialog.templatePickerItem.deleteButton.label"})});if(!a)return;I().createAndCommit({userAction:"CollectionTemplatePickerItem.handleDelete",environment:e,canUndo:!0,perform:e=>x().m0({collectionStore:t,templateStore:n,transaction:e})}),C()._o(e,{template_action:"delete"})}(P,U,t):()=>{}},(ne||se)&&{key:"nestedTemplateExplanation",render:e=>(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(F().A,{size:12}),(0,Y.jsx)(z().Ay,{...e,style:{padding:2},titleStyle:de.nestingExplanationMenuItemTitle,title:X({cannotAddRecurrenceToTemplate:ne}),captionStyle:de.nestingExplanationMenuItemCaption,caption:se})]}),action:()=>{}}])};let pe;return pe=R.isMobile?{menuType:O().gu.ActionSheet}:{menuType:O().gu.Popup,width:230},(0,Y.jsx)(K().A,{...pe,children:(0,Y.jsx)(H().Ay,{type:H().Oh.Vertical,initialFocus:void 0,sections:[me]})})}function X(e){const{cannotAddRecurrenceToTemplate:t}=e;return t&&(0,Y.jsx)(k().sA,{defaultMessage:"This template can’t be repeated.",id:"database.templatePickerItem.actionMenu.nestedTemplateExplanationTitle"})}function ee(e,t,n){const{mainEditorCurrentBlockStore:a}=N().default.state;!function(e,t,n){n?n(e):(0,w().navigate)({environment:t,url:e})}(a?(0,R().Ay)({store:a,peekViewBlockId:e.id,fullyQualified:!1,pageVisitSource:u().y8.PeekOpen}):(0,R().Ay)({store:e,fullyQualified:!1,pageVisitSource:u().y8.LinkInPage}),t,n)}},864779:(e,t,n)=>{n.d(t,{Me:()=>s,Vv:()=>o,Z3:()=>i,wI:()=>r});var a=()=>n(906745);function o(e){if("week"===e.frequency&&e.weekdays&&1===e.weekdays.length)return{weekday:e.weekdays[0],duration:e.interval}}function i(e){const{currentSprintEndDate:t,sprintSchedule:n}=e;return l({startDate:d({dateToAdjust:a().c9.fromISO(t),weekday:n.weekday,wrapForEqualDays:!0}),duration:n.duration})}function r(e){const{userTimeZone:t,sprintSchedule:n}=e;return l({startDate:a().c9.local({zone:t}),duration:n.duration})}function s(e){const{currentSprintStartDate:t,sprintSchedule:n}=e,o=d({dateToAdjust:a().c9.fromISO(t),weekday:n.weekday,wrapForEqualDays:!1}),{end_date:i}=l({startDate:o,duration:n.duration});let r=a().c9.fromISO(i);const s=a().c9.now().startOf("day");for(;r.diff(s,"days").days<0;)r=r.plus({weeks:1});return{type:"daterange",start_date:r.plus({days:1}).minus({weeks:n.duration}).toISODate(),end_date:r.toISODate()}}function l(e){const{startDate:t,duration:n}=e,a=t.plus({weeks:n}).minus({days:1});return{type:"daterange",start_date:t.toISODate(),end_date:a.toISODate()}}const c={SU:0,MO:1,TU:2,WE:3,TH:4,FR:5,SA:6};function d(e){const{dateToAdjust:t,weekday:n,wrapForEqualDays:a}=e,o=u({currentWeekday:t.weekday%7,nextWeekday:c[n],wrapForEqualDays:a});return t.plus({days:o})}function u(e){const{currentWeekday:t,nextWeekday:n,wrapForEqualDays:a}=e,o="number"==typeof t?t:c[t],i="number"==typeof n?n:c[n];if(o===i)return a?7:0;let r=o,s=0;for(;r!==i;)r===c.SA?r=0:r+=1,s+=1;return s}},911706:(e,t,n)=>{n.d(t,{A:()=>s});n(296540);var a=()=>n(401497),o=()=>n(718827),i=()=>n(30626),r=n(474848);function s({onClick:e,className:t,isMobile:n,style:s,onFocus:l,onBlur:c,onMouseDown:d,onMouseEnter:u,onMouseLeave:m}){const{buttonStyle:p,iconStyle:f}=(0,a().IS)((e=>({buttonStyle:{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,borderRadius:6,width:n?45:24,height:n?45:24,marginInlineEnd:n?-8:-6,...s},iconStyle:{width:n?18:14,height:n?18:14,fill:e.icon.secondary}})),[n,s]);return(0,r.jsx)(o().Ay,{onClick:e,style:p,className:t,onFocus:l,onBlur:c,onMouseDown:d,onMouseEnter:u,onMouseLeave:m,children:(0,i()._)(f)})}},950914:(e,t,n)=>{n.d(t,{AL:()=>i,Q6:()=>s,vt:()=>r});n(898992),n(672577);var a=()=>n(66689),o=()=>n(254947);const i={autoCompleteSprints:!1,actionConfig:{complete_sprint_action:"complete_sprint_and_move_incomplete_tasks_to_next_sprint"},recurrenceConfig:{interval:2,weekdays:["MO"]}};function r(e){const{eventTracker:t,properties:n}=e;t.DO_NOT_USE_commonTrackEvent({eventName:"complete_sprint_action",properties:n})}function s(e,t){var n;return null===(n=t.groups)||void 0===n||null===(n=n.find((t=>t.id===a().nl||(null==t?void 0:t.name)===o().P0||(null==t?void 0:t.name)===e.formatMessage(o().oz.statusGroupNameComplete))))||void 0===n?void 0:n.name}}}]);