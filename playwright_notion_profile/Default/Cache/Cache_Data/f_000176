"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[45732],{34423:(e,t,r)=>{r.d(t,{T:()=>y});var a=r(296540),o=()=>r(484714),n=()=>r(56366),i=()=>r(62371),s=()=>r(748054),l=()=>r(69708),u=()=>r(896628),d=()=>r(231297),c=()=>r(908201),g=()=>r(828973),p=r(474848);function y({groupBy:e}){const t=(0,o().v3)(),r=(0,c().ET)(),{viewType:y,startWeekOn:m}=(0,n().K8)((()=>{const e=r.normalizedFormatStore.state;return{viewType:r.getViewType(),startWeekOn:(null==e?void 0:e.start_week_on)??0}}),[r]),h=(0,a.useCallback)((e=>{d().createAndCommit({userAction:"CollectionSettingsViewGroup.handleStartWeekOnChange",environment:t,canUndo:!0,perform:t=>{const a=r.collectionViewStore();a&&u().zA({stores:[a],update:{start_week_on:e},transaction:t})}})}),[t,r]);if(!(0,i().Ik)(e)&&"formula"!==e.type)return null;if((0,i().Ik)(e)&&"week"!==e.groupBy)return null;if("formula"===e.type){const t=e.groupBy;if(!(0,i().Ik)(t))return null;if("week"!==t.groupBy)return null}return(0,p.jsx)(g().A,{title:(0,p.jsx)(l().sA,{id:"database.viewSettings.groupTab.startWeekOn",defaultMessage:"Start week on"}),popupStyle:{minWidth:190},selectedKey:m,onChange:h,icon:"chart"===y?s().M:void 0,options:[{key:0,type:"button",title:(0,p.jsx)(l().sA,{id:"database.viewSettings.groupTab.startWeekOn.sunday",defaultMessage:"Sunday"})},{key:1,type:"button",title:(0,p.jsx)(l().sA,{id:"database.viewSettings.groupTab.startWeekOn.monday",defaultMessage:"Monday"})}]})}},247788:(e,t,r)=>{r.d(t,{x:()=>i});var a=()=>r(56366),o=()=>r(282339),n=()=>r(537693);function i({chartConfig:e,chartError:t,collectionContextStore:r}){const i=(0,a().O$)(r.normalizedFormatStore);return(0,a().K8)((()=>{if((!t||(0,o().xG)(t))&&e)return(0,n().s)({chartConfig:e,format:i})}),[t,e,i],{useDeepEqual:!0})}},252051:(e,t,r)=>{r.d(t,{AI:()=>c,PB:()=>y,XC:()=>d,Yp:()=>o,Zz:()=>n,eq:()=>g,ev:()=>f,iq:()=>u,j2:()=>m,jQ:()=>p,jV:()=>a,kC:()=>h,o0:()=>i,p0:()=>s});const a=(0,r(69708).YK)({chart:{defaultMessage:"chart",id:"chartExport.chart"},exportChart:{defaultMessage:"Save chart as...",id:"chartExport.exportChart"},exportChartPreview:{defaultMessage:"Preview",id:"chartExport.exportChartPreview"},exportChartBackground:{defaultMessage:"Background",id:"chartExport.exportChartBackground"},copyPng:{defaultMessage:"Copy as PNG",id:"chartExport.copyAsPng"},downloadPng:{defaultMessage:"Download PNG",id:"chartExport.downloadPng"},downloadSvg:{defaultMessage:"Download SVG",id:"chartExport.downloadSVG"},madeWithNotion:{defaultMessage:"Made with Notion",id:"chartExport.madeWithNotion"}}),o=200,n=2,i=800,s=500,l=240,u=120,d=96,c=64,g=2*u,p=2*d,y=2*c;function m(e){let t={width:i,height:s};return"none"===e&&(t={width:i+g,height:s+p}),{chart:t,plotOptions:{pie:{size:l}}}}const h=20,f=8},282339:(e,t,r)=>{r.d(t,{QW:()=>m,dG:()=>p,ic:()=>y,lc:()=>g,xG:()=>h,ye:()=>c});r(517642),r(658004),r(733853),r(845876),r(432475),r(515024),r(731698);var a=()=>r(67657),o=()=>r(708685),n=()=>r(62371),i=()=>r(713998),s=()=>r(594013),l=()=>r(100594),u=()=>r(901610);const d=new Set(["groupBy_property_not_configured","groupBy_property_deleted","groupBy_property_not_groupable","groupBy_formula_not_groupable","aggregation_property_not_configured","aggregation_invalid","aggregation_deleted","stackBy_property_not_groupable","stackBy_formula_not_groupable","stackBy_property_deleted","name_property_not_configured","name_property_deleted","name_property_invalid","property_value_property_not_configured","property_value_property_deleted","property_value_property_invalid"]);function c({chartConfig:e,collectionSchema:t}){if(!e||"placeholder"===e.type)return"chart_config_not_found";if(void 0===e.dataConfig)return"data_model_invalid";if("groups_reducer"===e.dataConfig.type){const s=e.dataConfig.groupBy;if(!s)return"groupBy_property_not_configured";const d=(0,i()._g)({schema:t,property:s.property});if(!d)return"groupBy_property_deleted";const c=(0,n().Eg)(d);if("formula"===d.type&&!c)return"groupBy_formula_not_groupable";if(!c)return"groupBy_property_not_groupable";const g=e.dataConfig.aggregationConfig;if(!g)return"aggregation_property_not_configured";if("count"!==g.aggregation.aggregator){const e=g.aggregation.property,r=(0,i()._g)({schema:t,property:e});if(!r)return"aggregation_deleted";if((0,a().FM)(g.aggregation)&&r&&!(0,l().JW)(r))return"aggregation_invalid";if("formula"===(null==r?void 0:r.type)&&"unique"===g.aggregation.aggregator){const e=(0,o().getFormulaPropertySchemaResultType)(r);if(!(0,l().UK)(e))return"aggregation_invalid"}}if((0,u().m)(e)){var r;const a=null===(r=e.dataConfig.aggregationConfig.stackOptions)||void 0===r?void 0:r.groupBy.property;if(a){const e=(0,i()._g)({schema:t,property:a});if(!e)return"stackBy_property_deleted";const r=(0,n().Eg)(e);if("formula"===e.type&&!r)return"stackBy_formula_not_groupable";if(!r)return"stackBy_property_not_groupable"}}}else{if("results_reducer"!==e.dataConfig.type)return"data_model_invalid";{const r=e.dataConfig.nameProperty;if(!r)return"name_property_not_configured";const a=(0,i()._g)({schema:t,property:r});if(!a)return"name_property_deleted";if(!(0,s().tH)(a))return"name_property_invalid";const o=e.dataConfig.valueProperty;if(!o)return"property_value_property_not_configured";const n=(0,i()._g)({schema:t,property:o});if(!n)return"property_value_property_deleted";if(!(0,s().Iw)(n))return"property_value_property_invalid"}}}function g(e){return"groupBy_property_not_configured"===e||"groupBy_property_deleted"===e||"groupBy_property_not_groupable"===e||"groupBy_formula_not_groupable"===e||"name_property_not_configured"===e||"name_property_deleted"===e||"name_property_invalid"===e}function p(e){return"aggregation_property_not_configured"===e||"aggregation_deleted"===e||"aggregation_invalid"===e||"property_value_property_not_configured"===e||"property_value_property_deleted"===e||"property_value_property_invalid"===e}function y(e){return"stackBy_property_deleted"===e||"stackBy_property_not_groupable"===e||"stackBy_formula_not_groupable"===e||"stackBy_property_no_values"===e}function m(e){return d.has(e)}function h(e){return"stackBy_property_no_values"===e}},322638:(e,t,r)=>{r.d(t,{FE:()=>R,FZ:()=>G,G_:()=>C,Iq:()=>D,Le:()=>B,QJ:()=>F,Qn:()=>z,RO:()=>M,TP:()=>A,TQ:()=>j,WG:()=>T,Zr:()=>_,Zv:()=>I,b$:()=>P,bg:()=>x,k1:()=>L,pP:()=>w,uB:()=>K,v5:()=>V,zH:()=>k});r(944114);var a=()=>r(484714),o=()=>r(56366),n=()=>r(401497),i=()=>r(100594),s=()=>r(901610),l=()=>r(67657),u=()=>r(708685),d=()=>r(713998),c=()=>r(69708),g=()=>r(496603),p=()=>r(534177),y=()=>r(436696),m=()=>r(384944),h=()=>r(231297),f=()=>r(895876),v=()=>r(712257),S=()=>r(722372),b=()=>r(476492);const x=(0,c().YK)({chartType:{defaultMessage:"Chart type",id:"database.viewSettings.mainTab.chartType.title"},chartDevFeedbackLink:{defaultMessage:"Give dev feedback",id:"database.viewSettings.mainTab.chartDevFeedbackLink"},chartData:{defaultMessage:"Data",id:"database.viewSettings.mainTab.chartData.title"},chartStyle:{defaultMessage:"Style",id:"database.viewSettings.mainTab.chartStyle.title"},chartMoreStyle:{defaultMessage:"More style options",id:"database.viewSettings.mainTab.moreChartStyles.title"},chartXAxis:{defaultMessage:"X axis",id:"database.viewSettings.mainTab.axisChart.xAxis"},chartXAxisGroupByUnique:{defaultMessage:"Unique",id:"database.viewSettings.mainTab.axisChart.xAxis.groupBy.unique"},chartAggregateByValues:{defaultMessage:"Values",id:"database.viewSettings.mainTab.axisChart.aggregateByValues"},chartGroupBy:{defaultMessage:"Group by",id:"database.viewSettings.mainTab.axisChart.groupBy"},chartYAxisRange:{defaultMessage:"Range",id:"database.viewSettings.mainTab.axisChart.yAxisRange"},chartYAxisRangeMenu:{defaultMessage:"Set custom range",id:"database.viewSettings.mainTab.axisChart.yAxisRangeMenu"},chartYAxisRangeAuto:{defaultMessage:"Auto",id:"database.viewSettings.mainTab.axisChart.yAxisRangeAuto"},chartYAxisRangeCustom:{defaultMessage:"Custom",id:"database.viewSettings.mainTab.axisChart.yAxisRangeCustom"},chartYAxisRangeReset:{defaultMessage:"Reset",id:"database.viewSettings.mainTab.axisChart.yAxisRangeReset"},chartYAxisRangeMinPlaceholder:{defaultMessage:"Min",id:"database.viewSettings.mainTab.axisChart.yAxisRangeMinPlaceholder"},chartYAxisRangeMaxPlaceholder:{defaultMessage:"Max",id:"database.viewSettings.mainTab.axisChart.yAxisRangeMaxPlaceholder"},chartSortBy:{defaultMessage:"Sort by",id:"database.viewSettings.mainTab.axisChart.sortBy"},chartYAxis:{defaultMessage:"Y axis",id:"database.viewSettings.mainTab.axisChart.yAxis"},chartCumulative:{defaultMessage:"Cumulative",id:"database.viewSettings.mainTab.axisChart.cumulative"},chartHelp:{defaultMessage:"Learn about charts",id:"database.viewSettings.mainTab.charts.learnMoreButton"},chartDuplicate:{defaultMessage:"Duplicate chart",id:"database.viewSettings.mainTab.charts.duplicate"},chartReset:{defaultMessage:"Reset chart",id:"database.viewSettings.mainTab.charts.reset"},chartWhatToShow:{defaultMessage:"What to show",id:"database.viewSettings.mainTab.charts.whatToShow"},chartSliceDonutBy:{defaultMessage:"Slice donut by",id:"database.viewSettings.mainTab.charts.sliceDonutBy"},chartSliceDonutAggregation:{defaultMessage:"Each slice represents",id:"database.viewSettings.mainTab.charts.sliceDonutAggregation"},noneMenuItem:{defaultMessage:"None",id:"database.viewSettings.mainTab.charts.noneMenuItem"},noResultsMenuItem:{defaultMessage:"No results",id:"chartSettingsPropertySearchMenuItem.search.noResults.title"},chartIncludeSubitems:{defaultMessage:"Include sub-items",id:"database.viewSettings.mainTab.charts.includeSubitems"}}),_=(0,c().YK)({chartStyleTitle:{defaultMessage:"Style",id:"database.viewSettings.chartStyleTab.title"},chartColor:{defaultMessage:"Color",id:"database.viewSettings.chartStyleTab.chartColor"},chartHeight:{defaultMessage:"Height",id:"database.viewSettings.chartStyleTab.chartHeight"},chartSmoothLine:{defaultMessage:"Smooth line",id:"database.viewSettings.chartStyleTab.chartSmoothLine"},chartLineFillArea:{defaultMessage:"Gradient area",id:"database.viewSettings.chartStyleTab.chartLineFillArea"},chartWeightColorValue:{defaultMessage:"Color by value",id:"database.viewSettings.chartStyleTab.chartWeightColorValue"},chartGroupStyle:{defaultMessage:"Group style",id:"database.viewSettings.chartStyleTab.groupStyle"},chartGridLine:{defaultMessage:"Grid line",id:"database.viewSettings.chartStyleTab.chartGridLine"},chartAxisAvatarFormat:{defaultMessage:"Label style",id:"database.viewSettings.chartStyleTab.chartAxisAvatarFormat"},chartAxisName:{defaultMessage:"Axis name",id:"database.viewSettings.chartStyleTab.chartAxisName"},chartLegend:{defaultMessage:"Legend",id:"database.viewSettings.chartStyleTab.chartLegend"},chartCaption:{defaultMessage:"Caption",id:"database.viewSettings.chartStyleTab.chartCaption"},chartCaptionPlaceholder:{defaultMessage:"Caption",id:"database.viewSettings.chartStyleTab.chartCaptionPlaceholder"},chartHideEmptyGroups:{defaultMessage:"Omit zero values",id:"database.viewSettings.chartStyleTab.chartOmitZeroValues"},chartDataLabels:{defaultMessage:"Data labels",id:"database.viewSettings.chartStyleTab.chartDataLabels"},chartShowDonutValue:{defaultMessage:"Show value in center",id:"database.viewSettings.chartStyleTab.chartHideDonutValue"},chartValueLabelPlaceholder:{defaultMessage:"Value label",id:"database.viewSettings.chartStyleTab.chartValueLabelPlaceholder"}}),C=(0,c().YK)({none:{defaultMessage:"None",id:"database.viewSettings.chartStyleTab.gridOptions.none"},horizontal:{defaultMessage:"Horizontal",id:"database.viewSettings.chartStyleTab.gridOptions.horizontal"},vertical:{defaultMessage:"Vertical",id:"database.viewSettings.chartStyleTab.gridOptions.vertical"},both:{defaultMessage:"Both",id:"database.viewSettings.chartStyleTab.gridOptions.both"}}),w=(0,c().YK)({auto:{id:"database.viewSettings.chartStyleTab.colorTheme.auto",defaultMessage:"Auto"},colorful:{id:"database.viewSettings.chartStyleTab.colorTheme.colorful",defaultMessage:"Colorful"},gray:{id:"database.viewSettings.chartStyleTab.colorTheme.gray",defaultMessage:"Colorless"},blue:{id:"database.viewSettings.chartStyleTab.colorTheme.blue",defaultMessage:"Blue"},yellow:{id:"database.viewSettings.chartStyleTab.colorTheme.yellow",defaultMessage:"Yellow"},green:{id:"database.viewSettings.chartStyleTab.colorTheme.green",defaultMessage:"Green"},purple:{id:"database.viewSettings.chartStyleTab.colorTheme.purple",defaultMessage:"Purple"},teal:{id:"database.viewSettings.chartStyleTab.colorTheme.teal",defaultMessage:"Teal"},orange:{id:"database.viewSettings.chartStyleTab.colorTheme.orange",defaultMessage:"Orange"},pink:{id:"database.viewSettings.chartStyleTab.colorTheme.pink",defaultMessage:"Pink"},red:{id:"database.viewSettings.chartStyleTab.colorTheme.red",defaultMessage:"Red"}}),M=(0,c().YK)({avatar:{defaultMessage:"Avatar",id:"database.viewSettings.chartStyleTab.axisAvtarFormat.avatar"},avatar_name:{defaultMessage:"Avatar and name",id:"database.viewSettings.chartStyleTab.axisAvtarFormat.avatarName"},name:{defaultMessage:"Name",id:"database.viewSettings.chartStyleTab.axisAvtarFormat.name"}}),B=(0,c().YK)({none:{defaultMessage:"None",id:"database.viewSettings.chartStyleTab.axisLabelOptions.none"},x_axis:{defaultMessage:"X axis",id:"database.viewSettings.chartStyleTab.axisLabelOptions.xAxis"},y_axis:{defaultMessage:"Y axis",id:"database.viewSettings.chartStyleTab.axisLabelOptions.yAxis"},both:{defaultMessage:"Both",id:"database.viewSettings.chartStyleTab.axisLabelOptions.both"}}),A=(0,c().YK)({normal:{defaultMessage:"Stacked",id:"database.viewSettings.chartStyleTab.axisGroupStyleFormat.normal"},percent:{defaultMessage:"Percent",id:"database.viewSettings.chartStyleTab.axisGroupStyleFormat.percent"},side_by_side:{defaultMessage:"Not stacked",id:"database.viewSettings.chartStyleTab.axisGroupStyleFormat.side_by_side"}}),T=(0,c().YK)({small:{defaultMessage:"Small",id:"database.viewSettings.chartStyleTab.chartSettingsChartHeightFormat.small"},medium:{defaultMessage:"Medium",id:"database.viewSettings.chartStyleTab.chartSettingsChartHeightFormat.medium"},large:{defaultMessage:"Large",id:"database.viewSettings.chartStyleTab.chartSettingsChartHeightFormat.large"},extra_large:{defaultMessage:"Extra large",id:"database.viewSettings.chartStyleTab.chartSettingsChartHeightFormat.extra_large"}}),k=(0,c().YK)({none:{defaultMessage:"None",id:"database.viewSettings.chartStyleTab.donutDataLabels.none"},value:{defaultMessage:"Value (%)",id:"database.viewSettings.chartStyleTab.donutDataLabels.value"},name:{defaultMessage:"Name",id:"database.viewSettings.chartStyleTab.donutDataLabels.name"},name_and_value:{defaultMessage:"Name and value (%)",id:"database.viewSettings.chartStyleTab.donutDataLabels.nameAndValue"}}),G=(0,c().YK)({column:{id:"chartType.bar.vertical",defaultMessage:"Vertical bar"},bar:{id:"chartType.bar.horizontal",defaultMessage:"Horizontal bar"},line:{id:"chartType.line",defaultMessage:"Line"},donut:{id:"chartType.donut",defaultMessage:"Donut"}}),V=(0,c().YK)({addReferenceLine:{defaultMessage:"Add reference line",id:"database.viewSettings.chartStyleTab.referenceLine.addReferenceLine"},addMoreReferenceLines:{defaultMessage:"Add reference line",id:"database.viewSettings.chartStyleTab.referenceLine.addMoreReferenceLines"},referenceLine:{defaultMessage:"Reference line",id:"database.viewSettings.chartStyleTab.referenceLine.referenceLine"},value:{defaultMessage:"Value",id:"database.viewSettings.chartStyleTab.referenceLine.value"},deleteReferenceLine:{defaultMessage:"Delete",id:"database.viewSettings.chartStyleTab.referenceLine.deleteReferenceLine"},label:{defaultMessage:"Label",id:"database.viewSettings.chartStyleTab.referenceLine.label"},strokeStyle:{defaultMessage:"Style",id:"database.viewSettings.chartStyleTab.referenceLine.strokeStyle"},color:{defaultMessage:"Color",id:"database.viewSettings.chartStyleTab.referenceLine.color"}}),P=(0,c().YK)({Solid:{defaultMessage:"Solid",id:"database.viewSettings.chartStyleTab.referenceLine.strokeStyle.solid"},Dash:{defaultMessage:"Dash",id:"database.viewSettings.chartStyleTab.referenceLine.strokeStyle.dash"}});function j({aggregation:e,databaseType:t,intl:r}){if((0,l().Iq)(e)&&t){const e=(0,g().ZH)((0,f().$O)(t));return r.formatMessage({id:"chartYAxis.aggregate.count",defaultMessage:"{value} count"},{value:e})}if((0,l().Iq)(e))return r.formatMessage({id:"chartYAxis.aggregate.unTypedCount",defaultMessage:"Count"});if("unique"===e.aggregator)return r.formatMessage({id:"chartYAxis.aggregate.distinct",defaultMessage:"Distinct"});{const t=(0,l().V1)(e);return S().SE[t]}}function F(e,t,r,a,o,n){if("placeholder"===t.type||t.type===e)return;let l;if("donut"===e){if("donut"===t.type)return;(0,s().m)(t)?l=(0,i().YU)(t,n):(0,p().HB)(t)}else(0,s().I)(e)?(0,s().m)(t)?l=(0,i().SK)(t,e):"donut"===t.type?l=(0,i()._x)(t,e):(0,p().HB)(t):(0,p().HB)(e);h().createAndCommit({userAction:"chartSettings.setChartType",environment:r,canUndo:!0,perform:e=>{m().zv({store:a.getFormatStore().getKeyStore("chart_config"),data:l,transaction:e})}}),(0,y().X)({environment:r,collectionContextStore:o,action:"charts_update_chart_type",charts_analytics_context:(0,b().nL)(o)})}function R(e){return{fill:e.palette.orange[400]}}function D(e){const t=e.type;if("formula"===t){const t=(0,u().getFormulaPropertySchemaResultType)(e);return"text"===t||"checkbox"===t||"person"===t}return"title"===t||"text"===t||"url"===t||"email"===t||"phone_number"===t||"checkbox"===t||"person"===t||"select"===t||"multi_select"===t||"status"===t||"relation"===t||"created_by"===t||"last_edited_by"===t}function K(e,t){const r=(0,o().K8)((()=>null==e?void 0:e.dataConfig),[e]);return(0,o().K8)((()=>{let e;if("groups_reducer"===(null==r?void 0:r.type)?e=r.groupBy.property:"results_reducer"===(null==r?void 0:r.type)&&(e=r.nameProperty),e&&t)return(0,d()._g)({schema:t,property:e})}),[r,t],{useDeepEqual:!0})}function I(e,t){const r=(0,o().K8)((()=>null==e?void 0:e.dataConfig),[e]);return(0,o().K8)((()=>{let e;if("groups_reducer"===(null==r?void 0:r.type)?e=r.aggregationConfig.aggregation.property:"results_reducer"===(null==r?void 0:r.type)&&(e=r.valueProperty),e)return(0,d()._g)({schema:t,property:e})}),[r,t],{useDeepEqual:!0})}function z({environment:e,collectionContextStore:t,chartConfig:r,sort:a}){const o=[];"results_reducer"===r.dataConfig.type&&("x-ascending"===a?o.push({property:r.dataConfig.nameProperty,direction:"ascending"}):"x-descending"===a&&o.push({property:r.dataConfig.nameProperty,direction:"descending"})),v().IU({environment:e,collectionContextStore:t,temporaryState:{...t.temporaryStateStore.state,sorts:{value:o}}})}function L(){const e=250,t=(0,a().Y0)();return(0,n().IS)((()=>({whatToShowRightText:{maxWidth:t.isMobile?e:125},sortByRightText:{maxWidth:t.isMobile?e:163},groupByRightText:{maxWidth:t.isMobile?e:151},donutSliceRightText:{maxWidth:t.isMobile?e:124},donutSliceValueRightText:{maxWidth:t.isMobile?e:95},avatarStyle:{maxWidth:t.isMobile?e:110},donutDataLabelsRightText:{maxWidth:t.isMobile?e:90}})),[t.isMobile])}},352377:(e,t,r)=>{r.d(t,{L:()=>x});r(581454);var a=r(296540),o=()=>r(484714),n=()=>r(56366),i=()=>r(401497),s=()=>r(452706),l=()=>r(187881),u=()=>r(176412),d=()=>r(230979),c=()=>r(68207),g=()=>r(69708),p=()=>r(934201),y=()=>r(285790),m=()=>r(678553),h=()=>r(89924),f=()=>r(859428),v=()=>r(553965),S=r(474848);function b(e){const t=(0,o().Y0)(),a=(0,i().IS)((r=>{let a,o=t.isMobile?r.popoverBackground:r.background.secondary;return"yellow"===e.color&&(o=r.yellow.background.secondary,a=r.yellow.text.secondary),{container:{display:"flex",width:"100%",position:"relative",borderRadius:6,padding:t.isPhone?16:12,backgroundColor:o},icon:{width:14,height:14,marginTop:2},messageContainer:{display:"flex",flexDirection:"column",fontSize:t.isPhone?14:12},title:{fontWeight:500,color:e.color?a:void 0},caption:{color:e.color?a:r.text.secondary}}}),[t,e.color]);return(0,S.jsx)(h().A,{topBorder:!0,shouldShowBottomDivider:t.isMobile,style:{padding:12},children:(0,S.jsxs)("div",{style:a.container,children:[e.icon?(0,S.jsxs)(S.Fragment,{children:[t.isPhone?void 0:e.icon(a.icon),(0,S.jsx)(r(132389).A,{size:8})]}):void 0,(0,S.jsxs)("div",{style:a.messageContainer,children:[(0,S.jsx)("div",{style:a.title,children:e.title}),(0,S.jsx)("div",{style:a.caption,children:e.caption})]})]})})}const x=a.memo((function(e){const{groupBy:t,groupByKey:i,groupsFormatKey:l,collectionContextStore:u,groupsDisplayState:d,disableReorder:c}=e,y=(0,o().v3)(),f=r(726637).A.isMobile,v=(0,n().O$)(u.normalizedSchemaStore),x=(0,n().O$)(u.normalizedFormatStore),C=(0,n().O$)(u.canConfigureBlockStore),w=0===(null==d?void 0:d.visibleGroups.length)&&(null==d?void 0:d.hiddenGroups.length)>0,M=(0,n().K8)((()=>(0,p().Z3)({disableReorder:Boolean(c),groupByKey:i,format:x,canConfigureBlock:C,isMobile:Boolean(f)})),[c,i,x,C,f]),B=(0,n().K8)((()=>!!d&&(d.currentGroups.length>s().O3&&d.hasMore)),[d]),A=(0,a.useCallback)((()=>{if(!C)return;let e=[];e=w?(null==d?void 0:d.hiddenGroups.map((e=>({...e,hidden:void 0,emptyHidden:void 0}))))??[]:(null==d?void 0:d.currentGroups.map((e=>({...e,hidden:!0,emptyHidden:void 0}))))??[];const t=(0,r(45941).u8)({isLowerMobileGroupsLimitEnabled:Boolean(f)&&r(242422).default.checkGate({gateName:"collection_lower_load_limits_on_mobile"})});u.groupsLimitStore.setState(t),r(231297).createAndCommit({userAction:"CollectionSettingsViewGroup.handleHideAllClick",environment:y,canUndo:!0,perform:t=>{(0,r(800002).o)({collectionContextStore:u,newGroups:e,groupsFormatKey:l,transaction:t})}}),(0,r(436696).X)({environment:y,collectionContextStore:u,action:"click_groups_hide_all"})}),[C,w,u,y,null==d?void 0:d.hiddenGroups,null==d?void 0:d.currentGroups,l,f]),T=(0,a.useMemo)((()=>({topBorder:!0,disableMobileBorders:!0,noTextOverflow:!0,title:(0,S.jsx)(g().sA,{...p().K0.groups}),desktopTitleStyle:{paddingTop:4,marginBottom:8}})),[]);if(!d)return(0,S.jsx)(h().A,{...T,children:(0,S.jsx)(r(98126).A,{style:{alignSelf:"center",marginBottom:12}})});if(0===d.currentGroups.length)return(0,S.jsx)(h().A,{...T,children:(0,S.jsx)(m().Ay,{title:(0,S.jsx)(g().sA,{...p().K0.noGroups})})});const k=d.currentGroups.map((e=>(0,r(62371).Ix)(e)));return(0,S.jsxs)(S.Fragment,{children:[B?(0,S.jsx)(b,{title:(0,S.jsx)(g().sA,{...p().K0.groupLimitReachedTitle}),caption:(0,S.jsx)(g().sA,{...p().K0.groupLimitReachedCaption}),color:"yellow"}):void 0,(0,S.jsx)(h().A,{topBorder:!B,title:(0,S.jsx)(g().sA,{...p().K0.groups}),desktopStyle:B?{position:"relative",top:-12}:void 0,right:(0,S.jsx)(r(631524).p,{size:"sm",shouldShrink:!0,colorPalette:"blue",disabled:!C,onClick:A,style:{fontSize:12},children:w?(0,S.jsx)(g().sA,{id:"database.groupMenu.showAllGroups",defaultMessage:"Show all"}):(0,S.jsx)(g().sA,{id:"database.groupMenu.hideAllGroups",defaultMessage:"Hide all"})}),children:(0,S.jsx)(r(2143).H,{type:r(611648).A.Y,style:{maxHeight:400},children:(0,S.jsx)(r(439264).Ay,{direction:"vertical",keys:k,disabled:!M,renderKey:(e,r)=>{const a=d.currentGroups[r];return(0,S.jsx)(_,{collectionContextStore:u,schema:v,groupsDisplayState:d,groupBy:t,groupFormat:a,groupsFormatKey:l,canReorder:M})},onDrop:e=>{d&&(0,r(864403).r)({environment:y,collectionContextStore:u,groupsFormatKey:l,groupByKey:i,currentGroups:d.currentGroups,newGroupIds:e,containsAllGroups:!0})}})})})]})}),r(821062).A),_=a.memo((function(e){const{collectionContextStore:t,schema:h,groupsDisplayState:b,groupBy:x,groupFormat:_,groupsFormatKey:C,canReorder:w}=e,M=(0,o().v3)(),B=(0,o().Y0)(),A=(0,g().tz)(),[T,k]=(0,a.useState)(!1),[G,V]=(0,a.useState)(!1),P=(0,n().O$)(t.canConfigureBlockStore),j=(0,a.useCallback)((e=>{(0,r(604656).m)({environment:M,collectionContextStore:t,currentGroups:b.currentGroups,groupsFormatKey:C,groupFormat:_,action:e})}),[C,M,t,b.currentGroups,_]),F=()=>{j("toggle_group_visibility")},R=()=>{j("toggle_group_pin")},D={onMouseEnter:()=>{V(!0)},onMouseLeave:()=>{V(!1)}},K={onMouseEnter:()=>{k(!0)},onMouseLeave:()=>{k(!1)}},I=(0,i().IS)((()=>({icon:B.isMobile?{width:18,height:18}:{width:16,height:16},title:{marginInlineStart:-2,opacity:_.hidden?.4:1}})),[B.isMobile,_.hidden]);return(0,S.jsx)(m().Ay,{left:w?(0,S.jsx)(r(57232).A,{iconSize:12}):void 0,title:(0,S.jsx)(r(330918).d,{groupBy:x,groupFormat:_,currentGroups:b.currentGroups,schema:h,disabled:!0,isHiddenGroup:!1,collectionContextStore:t,source:"collection_settings"}),titleStyle:I.title,right:(0,S.jsxs)(S.Fragment,{children:["board_columns"===C?(0,S.jsx)(f().A,{renderTooltip:e=>(0,S.jsx)(g().sA,{...e,..._.pinned?p().K0.unpinGroup:p().K0.pinGroup}),render:e=>{const t=T&&P;return _.pinned?(0,S.jsx)(y().A,{...(0,v().A)(e,K),icon:t?d().N:c().S,iconStyle:I.icon,colorVariant:"primary",ariaLabel:A.formatMessage(p().K0.unpinGroup),onClick:R,disabled:!P}):P?(0,S.jsx)(y().A,{...(0,v().A)(e,K),icon:t?c().S:d().N,iconStyle:I.icon,ariaLabel:A.formatMessage(p().K0.pinGroup),onClick:R,disabled:b.pinnedGroups.groups.length>=s().U5}):null}}):void 0,(0,S.jsx)(f().A,{renderTooltip:e=>(0,S.jsx)(g().sA,{...e,..._.hidden?p().K0.showGroup:p().K0.hideGroup}),render:e=>{const t=G&&P;let r=t?u().L:l().eyeFillIcon,a=!t;return _.hidden&&(r=t?l().eyeFillIcon:u().L,a=t),(0,S.jsx)(y().A,{...(0,v().A)(e,D),icon:r,iconStyle:I.icon,colorVariant:a?"primary":"secondary",ariaLabel:_.hidden?A.formatMessage(p().K0.showGroup):A.formatMessage(p().K0.hideGroup),onClick:F,disabled:!P})}})]})})}))},537693:(e,t,r)=>{r.d(t,{s:()=>s});var a=()=>r(62371),o=()=>r(452706),n=()=>r(790063),i=()=>r(901610);function s({chartConfig:e,format:t}){var r,s,l;if("placeholder"===e.type||"groups_reducer"!==(null===(r=e.dataConfig)||void 0===r?void 0:r.type))return;const u=t.collection_groups||[],d=t.chart_subgroups||[],c=e.dataConfig.groupBy,g=(0,i().m)(e)?null===(s=e.dataConfig.aggregationConfig.stackOptions)||void 0===s?void 0:s.groupBy:void 0,p=(0,n().p)(e);if(!p)return;const y=null===(l=e.chartFormat)||void 0===l?void 0:l.axisHideEmptyGroups,m=(0,a().w9)(c,t);return{version:"v2",type:"groups",omitZeroAggregationGroups:Boolean(y),groupBy:m,limit:o().y5,groupSortPreference:u,aggregation:g?{type:"intersection_and_independent",intersectionAggregation:p,groupAggregation:p,subGroupAggregation:p}:{type:"independent",groupAggregation:p},subGroup:g?{groupBy:(0,a().w9)(g,t),limit:o().av,groupSortPreference:d}:void 0}}},620586:(e,t,r)=>{r.d(t,{BV:()=>d,FI:()=>p,HH:()=>y,LF:()=>u,NF:()=>S,Pi:()=>c,Q1:()=>h,nH:()=>v,tm:()=>m,wW:()=>g});var a=()=>r(100594),o=()=>r(898244),n=()=>r(751735),i=()=>r(406944),s=()=>r(534177),l=()=>r(934201);function u(e){return void 0!==e&&"auto"!==e&&"colorful"!==e}function d(e,t){if("auto"===e);else{if("colorful"===e)return i().O.colorful.slice(0,6);if(c(e)){const r="gray"===e?"dark"===t?"white":"black":e;return i().O[r]}(0,s().HB)(e)}}function c(e){return a().VY.includes(e)}function g(e,t,r){const a=function(e,t,r){if("auto"===e)return;let a;a="gray"===e?"dark"===r.mode?"white":"black":e;const o=i().O[a];return t&&c(e)?[o[0],o[3]]:o}(e,t,r);if(a)return c(e)&&t?{colorAxis:{minColor:a[1],maxColor:a[0],showInLegend:!1},colors:a}:{colorAxis:void 0,colors:a}}function p(e){const t=i().O[e];return t&&0!==t.length?t[0]:i().O.gray[0]}function y({collectionContextStore:e,groupValue:t,index:r,groupBy:a,theme:n,environment:s}){var u,d;const c=e.normalizedSchemaStore.state,p=e.normalizedFormatStore.state;if("placeholder"===(null===(u=p.chart_config)||void 0===u?void 0:u.type)||void 0===t.value)return"light"===n.mode?i().O.translucentGray[0]:i().O.translucentGray[1];const y=c[a.property],m=y&&((0,o().lx)(y)||(0,o().DD)(y)),h=(null===(d=p.chart_config)||void 0===d||null===(d=d.chartFormat)||void 0===d?void 0:d.colorTheme)||"auto";if("auto"===h&&m){const e=(0,l().$e)({environment:s,groupFormat:{property:a.property,value:t},schema:c,format:p,theme:n,ignoreDisableColorColumns:!0});if(e)return e.chartColor}const f=g("auto"===h?"colorful":h,!1,n),v=(null==f?void 0:f.colors)||i().O.colorful;return v[r%v.length]}function m(e,t){return t?{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[[0,"rgba(0, 0, 0, 0)"],[1,"rgba(0, 0, 0, 0)"]]}:{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[[0,(0,n().X4)(e,.1)],[1,(0,n().X4)(e,0)]]}}const h=["gradient","blue","red","yellow","grey","none"],f=(0,r(69708).YK)({gradient:{defaultMessage:"Gradient",id:"chart.export.background.gradient"},blue:{defaultMessage:"Blue",id:"chart.export.background.blue"},red:{defaultMessage:"Red",id:"chart.export.background.red"},yellow:{defaultMessage:"Yellow",id:"chart.export.background.yellow"},grey:{defaultMessage:"Grey",id:"chart.export.background.grey"},none:{defaultMessage:"None",id:"chart.export.background.none"}});function v(e){return f[e]}function S(e,t,r){const a="light"===e.mode?r?100:50:r?600:500;switch(t){case"blue":return e.palette.blue[a];case"red":return e.palette.red[a];case"yellow":return e.palette.yellow[a];case"grey":return e.palette.gray[a];case"none":const o=r?e.buttonHoveredBackground:e.popoverBackground;return`linear-gradient(to top right, ${o} calc(50% - 1px), ${e.regularDividerColor}, ${o} calc(50% + 1px) )`;case"gradient":return`${r?`linear-gradient(${e.buttonHoveredBackground}, ${e.buttonHoveredBackground}), `:""}${"dark"===e.mode?"linear-gradient(123deg, #3C3F41 40.15%, #4A2F27 89.33%)":"linear-gradient(123deg, #FEF5E9 40.15%, #FEE9E9 89.33%)"}`;default:(0,s().HB)(t)}}},622281:(e,t,r)=>{r.d(t,{AY:()=>L,CL:()=>q,CS:()=>$,Tm:()=>R,UX:()=>z,cN:()=>D,hu:()=>U,p4:()=>E});r(944114),r(898992),r(803949),r(581454);var a=()=>r(906745),o=()=>r(242422),n=()=>r(764880),i=()=>r(66689),s=()=>r(100594),l=()=>r(499755),u=()=>r(901610),d=()=>r(302322),c=()=>r(708685),g=()=>r(62371),p=()=>r(898244),y=()=>r(713998),m=()=>r(254947),h=()=>r(80979),f=()=>r(799829),v=()=>r(450648),S=()=>r(179034),b=()=>r(437607),x=()=>r(406944),_=()=>r(496603),C=()=>r(534177),w=()=>r(895876),M=()=>r(934201),B=()=>r(148832),A=()=>r(972435),T=()=>r(71304),k=()=>r(685889),G=()=>r(698449),V=()=>r(909470),P=()=>r(23815),j=()=>r(620586),F=()=>r(831030);function R(e){var t,r;const{collectionContextStore:a,groupedDataConfig:o,xAxisType:n,aggregationResults:i,subGroupResults:u,timezone:d,theme:c,environment:p,intl:m,groupTotals:h}=e;let{groupResults:f}=e;const v=null===(t=a.collectionViewStore())||void 0===t?void 0:t.getChartConfig();if(!v||"placeholder"===v.type)return;const S=o.groupBy;if(!S)return;if(!(0,g().rj)(S.type))return;const b=o.aggregationConfig;if(!b)return;if(!i)return;const C=a.normalizedSchemaStore.state,w=(0,y()._g)({schema:C,property:S.property});if(!w)return;const M=null==v?void 0:v.chartFormat,B=null==M?void 0:M.weightColorValue,A=null==M?void 0:M.mainSort,T=null==M?void 0:M.smoothLine,k=Boolean(null==M?void 0:M.axisHideEmptyGroups),G="datetime"===n||"linear"===n;"formula"!==S.type&&"descending"===S.sort.type&&G&&(f=f.reverse());const V=!G,P=G;let F=0,R=0,D=[],z=[];const L=b.seriesFormat.displayType,E=null===(r=b.stackOptions)||void 0===r?void 0:r.groupBy;if(u&&E){if(!(0,y()._g)({schema:C,property:E.property}))return;const e=new Map,t=null==M?void 0:M.axisCumulative;let r=0;u.forEach((e=>{const o=e.value,n=O({collectionContextStore:a,groupBy:E,groupValue:o,removeUncategorizedDateOrNumber:!1,environment:p,intl:m,timezone:d});if(!n)return;const l=(0,g().AC)(o),u=i[l],y=u?H(u):void 0;if(k&&!y)return;const b=K(n.stringValue,L,T),{maxGroupValue:x,minGroupValue:_,dataPoints:C}=I({collectionContextStore:a,subGroupKey:l,groupBy:S,hideEmptyGroups:k,groupResults:f,aggregationResults:i,groupTotals:h,timezone:d,environment:p,shouldSetDataPointColor:"line"!==L&&!B,theme:c,intl:m,useIndexAsX:V,removeUncategorizedDateOrNumber:P,seriesDisplayType:L});var w;(b.color=(0,j().HH)({collectionContextStore:a,groupValue:o,index:r,groupBy:E,theme:c,environment:p}),"line"===L)&&(b.fillColor=(0,j().tm)(b.color,Boolean(null===(w=v.chartFormat)||void 0===w?void 0:w.hideLineFillArea)));if(t&&$(v)){const{maxDataPoint:e,minDataPoint:t,cumulatedDataPoints:r}=X(C);b.data=r,"line"===L&&M.axisGroupStyle===s().PC.side_by_side?(e>F&&(F=e),t<R&&(R=t)):(F+=e,R+=t)}else b.data=C,F=Math.max(x,F),R=Math.min(_,R);D.push(b),r+=1})),"y-ascending"!==A&&"y-descending"!==A||(D=function(e,t){const r=(0,_().mg)(e);return r.forEach((e=>{const r=e.data.sort(((e,r)=>"y-ascending"===t?(e.total?e.total:0)-(r.total?r.total:0):(r.total?r.total:0)-(e.total?e.total:0)));r.forEach(((e,t)=>{e.x=t})),e.data=r})),r}(D,A));for(const a of D)for(const t of a.data)e.set(t.x,t);z=Array.from(e).sort(((e,t)=>e[0]-t[0])).map((([e,t])=>t))}else{var W;const e=w.name,{maxGroupValue:t,minGroupValue:r,dataPoints:o}=I({collectionContextStore:a,subGroupKey:void 0,groupBy:S,hideEmptyGroups:k,groupResults:f,aggregationResults:i,groupTotals:h,timezone:d,environment:p,shouldSetDataPointColor:"line"!==L&&!(0,j().LF)(null==M?void 0:M.colorTheme)&&!B,theme:c,intl:m,useIndexAsX:V,removeUncategorizedDateOrNumber:P,seriesDisplayType:L}),n=K(e.toString(),L,T);if("line"===L){var Y,U,q;const e=(null===(Y=(0,j().wW)((null===(U=v.chartFormat)||void 0===U?void 0:U.colorTheme)||"colorful",!1,c))||void 0===Y||null===(Y=Y.colors)||void 0===Y?void 0:Y[0])||x().O.colorful[0];n.fillColor=(0,j().tm)(e,Boolean(null===(q=v.chartFormat)||void 0===q?void 0:q.hideLineFillArea))}if((null==M?void 0:M.axisCumulative)&&$(v)){const{maxDataPoint:e,minDataPoint:t,cumulatedDataPoints:r}=X(o);n.data=r,F+=e,R+=t}else n.data=o,F=Math.max(t,F),R=Math.min(r,R);const s=null===(W=v.chartFormat)||void 0===W?void 0:W.mainSort;s!==l().S0.yAscending&&s!==l().S0.yDescending||(n.data=N(n.data,s)),z=n.data,D.push(n)}return{seriesData:D,maxValue:F,minValue:R,dataPointsForXAxisLabels:z}}function D(e){var t,r,a;const{groupedDataConfig:o,collectionContextStore:n,groupResults:i,aggregationResults:s,timezone:u,environment:d,theme:c,intl:g,groupTotals:p}=e,m=null===(t=n.collectionViewStore())||void 0===t?void 0:t.getChartConfig();if(!m||"placeholder"===m.type)return;const h=n.normalizedSchemaStore.state,f=o.groupBy,v=(0,y()._g)({schema:h,property:f.property});if(!v)return;const S=v.name,{dataPoints:b}=I({collectionContextStore:n,subGroupKey:void 0,groupBy:f,groupResults:i,aggregationResults:s,groupTotals:p,timezone:u,environment:d,shouldSetDataPointColor:!Boolean(null===(r=m.chartFormat)||void 0===r?void 0:r.weightColorValue),theme:c,intl:g,hideEmptyGroups:!0,useIndexAsX:!0,removeUncategorizedDateOrNumber:!1}),x=null===(a=m.chartFormat)||void 0===a?void 0:a.mainSort;return x===l().S0.yAscending||x===l().S0.yDescending?[{name:S,data:N(b,x)}]:[{name:S,data:b}]}function K(e,t,r){let a;return a="line"===t?r?"areaspline":"area":t,{name:e,type:a,data:[]}}function I({collectionContextStore:e,subGroupKey:t,groupBy:r,hideEmptyGroups:a,groupResults:o,aggregationResults:n,groupTotals:i,timezone:l,environment:u,shouldSetDataPointColor:d,theme:c,intl:p,useIndexAsX:y,removeUncategorizedDateOrNumber:m,seriesDisplayType:h}){var f;let v=0,S=0;const b=[],x=null===(f=e.collectionViewStore())||void 0===f?void 0:f.getChartConfig();if(!x||"placeholder"===x.type)return{maxGroupValue:v,minGroupValue:S,dataPoints:b};let _=0;return o.forEach(((o,f)=>{var C,w,M,B,A;const T=o.value,k=(0,g().AC)(T),G=t?(0,g().A)([t,k]):k,V=n[G],P=n[k];if(!V||!P)return;const F=O({collectionContextStore:e,groupBy:r,removeUncategorizedDateOrNumber:m,groupValue:T,environment:u,intl:p,timezone:l}),R=H(V),D=(null===(C=i.get(k))||void 0===C?void 0:C.max)||0,K=(null===(w=i.get(k))||void 0===w?void 0:w.min)||0,I=(null===(M=i.get(k))||void 0===M?void 0:M.total)||0,z=d&&!t?(0,j().HH)({collectionContextStore:e,groupValue:T,index:_,groupBy:r,theme:c,environment:u}):void 0;if(void 0===F||void 0===R||void 0===D||void 0===K)return;if(a&&0===I)return;const L=a&&"side_by_side"===(null===(B=x.chartFormat)||void 0===B?void 0:B.axisGroupStyle)&&0===R,E=null===(A=x.chartFormat)||void 0===A?void 0:A.axisGroupStyle;let W;E===s().PC.side_by_side?(R>v&&(v=R),R<S&&(S=R)):"line"===h&&E===s().PC.normal?(v=Math.max(v,I),S=Math.min(S,I)):(v=Math.max(v,D),S=Math.min(S,K)),y?(W={x:t?f:_,y:R,name:F.stringValue,total:I},F.actorPointer&&(W.actorPointer=F.actorPointer),L&&(W.visible=!1)):(W={x:F.numberValue,y:R,name:F.stringValue,total:I},L&&(W.visible=!1)),z&&(W.color=z),W.groupFormat=o,b.push(W),_+=1})),{maxGroupValue:v,minGroupValue:S,dataPoints:b}}function z({collectionContextStore:e,resultsDataConfig:t,resultsChartReducerResults:r,chartType:a,timezone:n,theme:i,intl:s,environment:u}){var g,p;const m=null===(g=e.collectionViewStore())||void 0===g?void 0:g.getChartConfig();if(!m||"placeholder"===m.type)return;const f=null==m?void 0:m.chartFormat,S=null==f?void 0:f.weightColorValue,b=null==f?void 0:f.smoothLine,_=e.normalizedSchemaStore.state,C=(0,y()._g)({schema:_,property:t.valueProperty});if(!C)return;const w=Boolean(null===(p=m.chartFormat)||void 0===p?void 0:p.axisHideEmptyGroups),M=[],A=C.name,T="axis"===a?t.valueSeriesFormat.displayType:"column",{maxDataPoint:k,minDataPoint:G,dataPoints:P}=function({collectionContextStore:e,hideEmptyGroups:t,resultsDataConfig:r,resultsChartReducerResults:a,shouldSetDataPointColor:n,theme:i,useIndexAsX:s,timezone:u,intl:g,environment:p}){var m,f,S;let b=0,x=0;const _=[],C=e.normalizedFormatStore.state.chart_config,w=e.collectionStore();if(!w||!C||"placeholder"===C.type||!a)return{maxDataPoint:b,minDataPoint:x,dataPoints:_};let M=0;const A=(null===(m=C.chartFormat)||void 0===m?void 0:m.colorTheme)||"auto",T=(0,j().wW)("auto"===A?"colorful":A,!1,i),k=e.normalizedSchemaStore.state,G=(0,y()._g)({schema:k,property:r.nameProperty}),P=(0,y()._g)({schema:k,property:r.valueProperty}),R=new Map,D=new Map,K=new Map;if(a.blockIds.forEach((e=>{const a=B().B.createChildStore(w,{table:"block",id:e,spaceId:w.getSpaceId()}),i=a.getModel(),l=(()=>{if("formula"===(null==G?void 0:G.type)){if("text"!==(0,c().getFormulaPropertySchemaResultType)(G)||!i)return;return(0,h().primitiveFormulaValueFromPropertySchema)({schema:k,property:r.nameProperty,blockModel:i,getRecordModel:a.getRecordModel,intl:g,userTimeZone:u,depth:0,resultCache:R,regExpCache:D,formatDateCache:K,experimentService:o().default,collectionFeatureGates:(0,V().i)(),spaceIdCreator:p.idCreator.getSpaceIdCreatorSync(i.space_id)})??""}const e=a.getPropertyValue(r.nameProperty),t=(0,v().r4)({textValue:e,getRecordModel:a.getRecordModel,userTimeZone:u,intl:g});return"title"===(null==G?void 0:G.type)?t||g.formatMessage(F().$k.titlePlaceholder):t})(),y=(()=>{if("formula"===(null==P?void 0:P.type)){if("number"!==(0,c().getFormulaPropertySchemaResultType)(P)||!i)return;const e=(0,h().primitiveFormulaValueFromPropertySchema)({schema:k,property:r.valueProperty,blockModel:i,getRecordModel:a.getRecordModel,intl:g,userTimeZone:u,depth:0,resultCache:R,regExpCache:D,formatDateCache:K,experimentService:o().default,collectionFeatureGates:(0,V().i)(),spaceIdCreator:p.idCreator.getSpaceIdCreatorSync(i.space_id)});if("number"!=typeof e)return;return e}const e=a.getPropertyValue(r.valueProperty);return(0,d().M)(e)})();if(t&&void 0===y)return;let m;y&&y>b&&(b=y),y&&y<x&&(x=y);const f=null==T?void 0:T.colors;if(f&&n&&(m=f[M%f.length]),s){const e={x:M,y,name:l,color:m};"title"===(null==G?void 0:G.type)&&i&&(e.pagePointer=i.pointer),_.push(e)}M+=1})),(null==C||null===(f=C.chartFormat)||void 0===f?void 0:f.axisCumulative)&&$(C)){const{maxDataPoint:e,minDataPoint:t,cumulatedDataPoints:r}=X(_);return{maxDataPoint:e,minDataPoint:t,dataPoints:r}}const I=null===(S=C.chartFormat)||void 0===S?void 0:S.mainSort;if(I===l().S0.yAscending||I===l().S0.yDescending){const e=N(_,I);return{maxDataPoint:b,minDataPoint:x,dataPoints:e}}return{maxDataPoint:b,minDataPoint:x,dataPoints:_}}({collectionContextStore:e,hideEmptyGroups:w,resultsDataConfig:t,resultsChartReducerResults:r,shouldSetDataPointColor:"line"!==T&&!S,theme:i,useIndexAsX:!0,timezone:n,intl:s,environment:u}),R=K(A.toString(),T,b);if("line"===T){var D,I,z;const e=(null===(D=(0,j().wW)((null===(I=m.chartFormat)||void 0===I?void 0:I.colorTheme)||"colorful",!1,i))||void 0===D||null===(D=D.colors)||void 0===D?void 0:D[0])||x().O.colorful[0];R.fillColor=(0,j().tm)(e,Boolean(null===(z=m.chartFormat)||void 0===z?void 0:z.hideLineFillArea))}return R.data=P,M.push(R),{maxValue:k,minValue:G,seriesData:M}}function L({groupedDataConfig:e,hideEmptyGroups:t,mainSort:r}){if(t||"y-ascending"===r||"y-descending"===r)return"category";const{type:a}=e.groupBy;return(0,g().Ik)(e.groupBy)&&"relative"!==e.groupBy.groupBy?"datetime":"number"===a?"linear":"category"}function E({mainSort:e,xAxisType:t}){return"datetime"===t&&"x-descending"===e||"linear"===t&&"x-descending"===e}function O({collectionContextStore:e,groupBy:t,groupValue:r,removeUncategorizedDateOrNumber:o,environment:i,intl:s,timezone:l}){const d=e.collectionViewBlockStore();if(!d)return;const c=e.normalizedSchemaStore.state,h=(0,y()._g)({schema:c,property:t.property});if(!h)return;const v=h.name;if(!r.value){if(o&&("number"===r.type&&"number"===(null==h?void 0:h.type)||(0,g().DH)(r)))return;if((0,g().D1)(r)&&(0,p().nC)(h)){const e=d.getAssociatedCollectionStore();return{stringValue:Y(v,!!e&&(0,P().Vu)({collectionStore:e,property:t.property,propertySchema:h,parentStore:e}))}}return{stringValue:Y(v)}}if((0,g().DH)(r)){const e=(0,M().nc)({intl:s,value:r.value}),o="formula"===t.type?t.groupBy:t;if((0,g().Ik)(o)&&"relative"===o.groupBy)return{stringValue:e};if("day"===r.value.type||"month"===r.value.type||"week"===r.value.type||"year"===r.value.type){const e=a().c9.fromISO(r.value.range.start_date,{zone:l}).startOf("day").toMillis();return{stringValue:e.toString(),numberValue:e}}return{stringValue:e}}if((0,g().D1)(r)&&(0,p().nC)(h)){const e=r.value;if((0,g().WO)(e)){const t=e.id,r=B().B.createChildStore(d,{id:t,table:S().ev});return{stringValue:(0,T().tS)({environment:i,intl:s,store:r})}}if((0,g().zx)(e)){var x;const t=(0,k().LQ)(h,d);if(!t)return;const r=null===(x=f().n$[t])||void 0===x||null===(x=x[e.value.variable])||void 0===x?void 0:x.messageDescriptor;return r?{stringValue:s.formatMessage(r)}:void 0}}else if((0,g().rM)(r)){const e=r.value,t=null==e?void 0:e.type;if("by_group"===t&&null!=e&&e.group)return(0,m().wC)(e.group)?{stringValue:s.formatMessage((0,m().gh)(e.group))}:{stringValue:e.group};if("by_option"===t&&null!=e&&e.option)return{stringValue:null==e?void 0:e.option}}else{if("select"===r.type||"multi_select"===r.type)return{stringValue:r.value};if("number"===r.type){var _;const t=r.value,a=t.type;let o;const n=null===(_=e.collectionViewStore())||void 0===_?void 0:_.getChartConfig();var w;if(n&&(0,u().m)(n))o=null===(w=n.chartFormat)||void 0===w?void 0:w.numberPrecisionOverride;const i=(0,F().ck)({propertySchema:h,aggregation:void 0,intl:s,numberPrecisionOverride:o});if(!i)return;if("range"===a)return{stringValue:i(t.start),numberValue:t.start};if("unique"===a)return{stringValue:i(t.value),numberValue:t.value};"out_of_range"===a||(0,C().HB)(a)}else{if((0,g().GG)(r)){const e=r.value;if((0,b().I6)(e)){const t=(0,b().S4)({spacePermissionGroupId:e.id,spaceId:e.spaceId}),r=d.getRecordModel(t);if(!r)return;return{stringValue:(0,G().Pf)({intl:s,groupName:r.name}),actorPointer:e}}const t=(0,n().xC)({pointer:e,getRecordModel:d.getRecordModel});if(!t)return;return{stringValue:(0,n().lR)(s,t),actorPointer:e}}if("checkbox"===r.type)return{stringValue:h.name};if("title"===r.type){if("exact"===r.value.type)return{stringValue:r.value.value||s.formatMessage(F().$k.titlePlaceholder)}}else if((0,g().kO)(r)){if("exact"===r.value.type)return{stringValue:r.value.value}}else if("formula"===r.type&&"formula"===t.type){return O({collectionContextStore:e,groupBy:t,groupValue:r.value,removeUncategorizedDateOrNumber:o,environment:i,intl:s,timezone:l})}}}}function H(e){if(!e)return;const t=e.aggregationResult;return"number"===t.type?t.value:void 0}const W=(0,r(69708).YK)({chartUncategorizedGroup:{defaultMessage:"No {name}",id:"database.chartView.uncategorizedGroupLabel"}});function Y(e,t){return t?A().A.formatMessage(P().zX.sprintUncategorizedGroup,{name:e??A().A.formatMessage(i().TZ.sprint_plural)}):A().A.formatMessage(W.chartUncategorizedGroup,{name:e??(0,w().oj)(void 0)})}function U(e){if("column"!==e.type&&"bar"!==e.type)return!1;{const r=e.dataConfig.type;var t;if("groups_reducer"===r)return void 0===(null===(t=e.dataConfig.aggregationConfig.stackOptions)||void 0===t?void 0:t.groupBy);if("results_reducer"===r)return!0;(0,C().HB)(r)}}function N(e,t){const r=(0,_().mg)(e).sort(((e,r)=>{const a=void 0===e.y?-1/0:e.y,o=void 0===r.y?-1/0:r.y;return t===l().S0.yDescending?o-a:a-o}));return r.forEach(((e,t)=>{e.x=t})),r}function $(e){var t;const r=(0,u().m)(e),a="groups_reducer"===e.dataConfig.type?e.dataConfig.aggregationConfig.aggregation.aggregator:"count",o="count"===a||"sum"===a,n=null===(t=e.chartFormat)||void 0===t?void 0:t.mainSort;return r&&o&&"x-ascending"===n}function X(e){let t=0,r=0;const a=[];let o=0;for(const n of e){const e=n.y||0,i={...n,y:e+o};a.push(i),o+=e,o>r&&(r=o),o<t&&(t=o)}return{maxDataPoint:r,minDataPoint:t,cumulatedDataPoints:a}}function q({groupedChartReducerResults:e,chartConfig:t,sortType:r}){const a=null==e?void 0:e.aggregationResults;if(!a)return;const o=t.chartFormat,n=null==o?void 0:o.mainSort;let i;"main"!==r||"y-ascending"!==n&&"y-descending"!==n||(i="y-ascending"===n?"asc":"desc");const s=null==o?void 0:o.axisHideEmptyGroups,l=function(e){const{groupResults:t,aggregationResults:r,subGroupResults:a}=e,o=new Map;return t.forEach((e=>{const t=e.value,n=(0,g().AC)(t);let i=0,s=0;if(a)a.forEach((e=>{const t=e.value,a=(0,g().AC)(t),o=(0,g().A)([a,n]),l=H(r[o])||0;l>0&&(i+=l),l<0&&(s+=l)}));else{const e=H(r[n])||0;e>i&&(i=e),e<s&&(s=e)}o.set(n,{min:s,max:i,total:s+i})})),o}({aggregationResults:a,groupResults:e.results,subGroupResults:e.subGroupResults});return{aggregationResults:a,yAxisSortOrder:i,hideZeroAggregations:s||"donut"===t.type,groupTotals:l}}},656881:(e,t,r)=>{r.d(t,{b:()=>o,y:()=>n});var a=()=>r(972435);const o=(0,r(69708).YK)({noData:{defaultMessage:"No data",id:"chartError.noData"},badYAxisRange:{defaultMessage:"No data due to axis range",id:"chartError.badYAxisRange"},unconfiguredProperty:{id:"chartError.unconfiguredProperty",defaultMessage:"Property is not configured. Please make another selection."},unsupportedProperty:{id:"chartError.unsupportedProperty",defaultMessage:"This property type is not supported. Please select another property"},unsupportedFormula:{id:"chartError.unsupportedFormula",defaultMessage:"This formula is not supported. Please select another property or adjust your formula."},deletedProperty:{id:"chartError.deletedProperty",defaultMessage:"This property has been deleted. Please select another property."},invalidAggregation:{id:"chartError.invalidAggregation",defaultMessage:"Previously selected property is no longer valid with the current aggregation. Please make another selection."},invalidPropertyValueChart:{id:"chartError.invalidPropertyValueChart",defaultMessage:"Selected property is no longer valid with the previous configured chart. Please make another selection."},noValues:{id:"chartError.noValues",defaultMessage:"This property has no values. Please add some values or select another property."}});function n(e){switch(e){case"groupBy_property_not_configured":case"aggregation_property_not_configured":case"name_property_not_configured":case"property_value_property_not_configured":return a().A.formatMessage(o.unconfiguredProperty);case"groupBy_property_not_groupable":case"stackBy_property_not_groupable":return a().A.formatMessage(o.unsupportedProperty);case"groupBy_formula_not_groupable":case"stackBy_formula_not_groupable":return a().A.formatMessage(o.unsupportedFormula);case"groupBy_property_deleted":case"stackBy_property_deleted":case"aggregation_deleted":case"name_property_deleted":case"property_value_property_deleted":return a().A.formatMessage(o.deletedProperty);case"aggregation_invalid":return a().A.formatMessage(o.invalidAggregation);case"stackBy_property_no_values":return a().A.formatMessage(o.noValues);case"name_property_invalid":case"property_value_property_invalid":return a().A.formatMessage(o.invalidPropertyValueChart)}}},714185:(e,t,r)=>{r.d(t,{f:()=>y});var a=()=>r(484714),o=()=>r(56366),n=()=>r(187174),i=()=>r(869558),s=()=>r(96689),l=()=>r(369955),u=()=>r(792415);const d=new(r(848776).U)(((e,{spaceId:t,collectionViewId:r})=>`${e.currentUser.id}|${t}|${r}`),(async(e,{spaceId:t,collectionViewId:a})=>{if(!t||!a)return{canViewChart:!1,canViewChartError:"paywall_error"};const o=await Promise.resolve().then(r.bind(r,559506)),n=await o.callApi({eventName:"canViewChart",environment:e,data:{spaceId:t,collectionViewId:a}});return"success"!==n.type?{canViewChart:!1,canViewChartError:"paywall_error"}:{canViewChart:n.data.can_view_chart,canViewChartError:void 0}}));r(852832).exposeDebugValue("CollectionViewCanViewChartStore",d);const c=d;var g=()=>r(589994),p=()=>r(329304);function y({collectionContextStore:e}){const t=(0,a().v3)(),r=(0,l().L)(),d=t.currentUser.id,y=null==r?void 0:r.id,m=(0,o().K8)((()=>{var e;return(null==r?void 0:r.id)===s().Zz||(null===(e=u().A.state.publicPageData)||void 0===e?void 0:e.spaceId)===s().Zz}),[r]),{collectionViewStore:h,collectionViewBlockStore:f}=(0,o().K8)((()=>({collectionViewStore:e.collectionViewStore(),collectionViewBlockStore:e.collectionViewBlockStore()})),[e]),v=(0,o().K8)((()=>{const t=null==h?void 0:h.id,r=e.updateFreeChartsResultStore.state;if(t&&r&&r.has(t))return r.get(t)}),[e.updateFreeChartsResultStore,h]),S=(0,p().P9)({name:"view_chart",spaceId:y,userId:d,amount:"unknown"}),[{value:b}]=(0,n().Yb)((async()=>{const e=null==h?void 0:h.id,r=null==h?void 0:h.getSpaceId();if(!e||!r)return{canViewChart:!1,canViewChartError:"paywall_error"};if(S||m)return{canViewChart:!0,canViewChartError:void 0};if(await g().transactionQueue.awaitRecordTransaction({table:i().Gy,id:e}),null!=v&&v.isPending)return{canViewChart:void 0,canViewChartError:void 0};if(null==f?void 0:f.pathIsAccessibleAndAlive())return void 0!==(null==v?void 0:v.value)?{canViewChart:v.value,canViewChartError:void 0}:await c.awaitData(t,{spaceId:r,collectionViewId:e});{const a=await c.awaitData(t,{spaceId:r,collectionViewId:e});return await c.awaitData(t,{spaceId:r,collectionViewId:e},Boolean(a))}}),[h,f,t,S,v,m]),{canViewChart:x,canViewChartError:_}=b??{canViewChart:void 0,canViewChartError:void 0};return{canViewChart:x,canViewChartError:_}}},790063:(e,t,r)=>{function a(e){if("placeholder"!==e.type&&"groups_reducer"===e.dataConfig.type)return e.dataConfig.aggregationConfig.aggregation}r.d(t,{p:()=>a})},812480:(e,t,r)=>{r.d(t,{WK:()=>q,bO:()=>N,cS:()=>Z,dU:()=>E,eD:()=>X,hC:()=>W,oz:()=>L,rq:()=>O});r(16280),r(581454);var a=r(296540),o=()=>r(484714),n=()=>r(56366),i=()=>r(401497),s=()=>r(956675),l=()=>r(708685),u=()=>r(62371),d=()=>r(898244),c=()=>r(452706),g=()=>r(236262),p=()=>r(69708),y=()=>r(496603),m=()=>r(534177),h=()=>r(436696),f=()=>r(896628),v=()=>r(231297),S=()=>r(278094),b=()=>r(800002),x=()=>r(934201),_=()=>r(101981),C=()=>r(89924),w=()=>r(574036),M=()=>r(398217),B=()=>r(972435),A=()=>r(232930),T=()=>r(396671),k=()=>r(147503),G=()=>r(701311),V=()=>r(261503),P=()=>r(352377),j=()=>r(95441),F=()=>r(735695),R=()=>r(497222),D=()=>r(828973),K=()=>r(34423),I=r(474848);const z=r(757695).Store.createClass(void 0,{name:"ReducerResultStore"});function L(e){const{collectionContextStore:t,groupsFormatKey:r,groupByKey:a,collectionSettingsStore:i}=e,s=(0,o().v3)(),l=(0,n().uB)(void 0,z),c=(0,n().O$)(t.normalizedSchemaStore),y=(0,n().O$)(l),m=(0,n().K8)((()=>(0,u().H2)(t.normalizedFormatStore.state,a,r)),[t,a,r]),S=(0,T().d)({groupBy:m,reducerResult:y}),b=(0,n().K8)((()=>function(e,t){return te(e)&&(0,x().Qt)({viewType:ee(e),groupByKey:t})}(t,a)),[t,a]),_=m&&"board_columns_by"===a&&(0,d().us)(m.type);return(0,I.jsxs)(F().Ay,{collectionSettingsStore:i,title:(0,I.jsx)(re,{collectionSettingsStore:i,collectionContextStore:t}),children:[(0,I.jsxs)(C().A,{children:[(0,I.jsx)(ae,{collectionContextStore:t,collectionSettingsStore:i,groupByKey:a,groupsFormatKey:r,groupBy:m}),m&&H({groupBy:m,schema:c})?(0,I.jsx)(ne,{collectionContextStore:t,collectionSettingsStore:i,groupByKey:a,groupsFormatKey:r,groupBy:m}):void 0,m?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(K().T,{groupBy:m}),(0,I.jsx)(ie,{collectionContextStore:t,groupByKey:a,groupBy:m,groupsFormatKey:r}),(0,I.jsx)(se,{groupByKey:a,collectionContextStore:t,groupsFormatKey:r,groupsDisplayState:S,groupBy:m})]}):void 0,_?(0,I.jsx)(oe,{collectionContextStore:t}):void 0]}),m?(0,I.jsx)(le,{groupsFormatKey:r,collectionContextStore:t,groupByKey:a,reducerResultStore:l,groupsDisplayState:S}):void 0,(0,I.jsxs)(C().A,{topBorder:!0,children:[m&&b?(0,I.jsx)(R().A,{isGray:!0,icon:g().trashIcon,title:(0,I.jsx)(p().sA,{defaultMessage:"Remove grouping",id:"database.viewSettings.groupTab.removeButton.title"}),onClick:()=>function(e,t,r,a){const o=t.collectionViewStore();if(!o)return;v().createAndCommit({userAction:"CollectionSettingsViewGroup.handleRemoveClick",environment:e,canUndo:!0,perform:e=>{f().zA({stores:[o],update:{[r]:void 0,[a]:void 0},transaction:e})}}),(0,h().X)({environment:e,collectionContextStore:t,action:"click_remove_grouping"})}(s,t,a,r),isRed:!0}):void 0,(0,I.jsx)(j().A,{href:(0,A().x)("guides.databaseGroup"),title:(0,I.jsx)(p().sA,{defaultMessage:"Learn about grouping",id:"database.viewSettings.groupTab.learnMoreButton.title"}),analyticsFrom:"view_settings_group"})]})]})}function E(e){const{groupByPropertySchema:t}=e,r=(0,i().IS)((()=>({property:{maxWidth:"clamp(100px, 40vw, 150px)"}})),[]);return t?(0,I.jsx)(M().mA,{propertySchema:t,showIcon:!1,style:r.property}):null}function O(e,t){return"collection_group_by"===e&&"board"===t?(0,I.jsx)(p().sA,{defaultMessage:"Sub-group by",id:"database.viewSettings.groupTab.subGroupProperty"}):(0,I.jsx)(p().sA,{defaultMessage:"Group by",id:"database.viewSettings.groupTab.groupProperty"})}function H(e){const{groupBy:t,schema:r}=e,a=r[t.property];if(!a||!(0,u().Eg)(a))return;let o;if("formula"===a.type){const e=(0,l().getFormulaPropertySchemaResultType)(a);if("unknown"===e||"array"===e)return;o="block"===e?"relation":e}else o=a.type;return(0,u()._o)(o)||(0,u().Vs)(o)||"number"===o||"status"===o?o:void 0}function W(e){const t=H(e);if(t)return(0,u()._o)(t)?(0,I.jsx)(p().sA,{defaultMessage:"Date by",id:"database.viewSettings.groupByTypeTab.dateBy"}):(0,u().Vs)(t)?(0,I.jsx)(p().sA,{defaultMessage:"Text by",id:"database.viewSettings.groupByTypeTab.textBy"}):"number"===t?(0,I.jsx)(p().sA,{defaultMessage:"Number by",id:"database.viewSettings.groupByTypeTab.numberBy"}):"status"===t?(0,I.jsx)(p().sA,{defaultMessage:"Status by",id:"database.viewSettings.groupByTypeTab.statusBy"}):void 0}function Y(e){return(0,u().Ik)(e)?e:"formula"===e.type&&"date"===e.groupBy.type?e.groupBy:void 0}function U(e){return(0,u().Vh)(e)?e:"formula"===e.type&&"text"===e.groupBy.type?e.groupBy:void 0}function N(e){return"number"===e.type?e:"formula"===e.type&&"number"===e.groupBy.type?{...e.groupBy,property:e.property}:void 0}function $(e){const{groupBy:t}=e,r=H(e);if(r)if((0,u()._o)(r)){const e=Y(t);if(e)return Q(e.groupBy)}else if((0,u().Vs)(r)){const e=U(t);if(e)return J(e.groupBy)}else if("number"===r){const e=N(t);if(e)return(0,I.jsx)(p().sA,{defaultMessage:"{start} to {end}",id:"database.groupMenu.numberGroupBy.range",values:{start:e.start,end:e.end}})}}const X=(0,p().YK)({group:{defaultMessage:"Group",id:"database.groupMenu.statusGroupBy.group"},option:{defaultMessage:"Option",id:"database.groupMenu.statusGroupBy.option"}});const q=(0,p().YK)({relative:{defaultMessage:"Relative",id:"database.groupMenu.dateGroupBy.relative"},day:{defaultMessage:"Day",id:"database.groupMenu.dateGroupBy.day"},week:{defaultMessage:"Week",id:"database.groupMenu.dateGroupBy.week"},month:{defaultMessage:"Month",id:"database.groupMenu.dateGroupBy.month"},year:{defaultMessage:"Year",id:"database.groupMenu.dateGroupBy.year"}}),Z=(0,p().YK)({relative:{defaultMessage:"Relative",id:"database.groupMenu.dateGroupBy.relative"},day:{defaultMessage:"Days",id:"database.groupMenu.dateGroupBy.days"},week:{defaultMessage:"Weeks",id:"database.groupMenu.dateGroupBy.weeks"},month:{defaultMessage:"Months",id:"database.groupMenu.dateGroupBy.months"},year:{defaultMessage:"Years",id:"database.groupMenu.dateGroupBy.years"}});function Q(e){return"relative"===e?(0,I.jsx)(p().sA,{...q.relative}):"day"===e?(0,I.jsx)(p().sA,{...q.day}):"week"===e?(0,I.jsx)(p().sA,{...q.week}):"month"===e?(0,I.jsx)(p().sA,{...q.month}):"year"===e?(0,I.jsx)(p().sA,{...q.year}):void(0,m().HB)(e)}function J(e){return"exact"===e?(0,I.jsx)(p().sA,{defaultMessage:"Exact",id:"database.groupMenu.textGroupBy.exact"}):"alphabet_prefix"===e?(0,I.jsx)(p().sA,{defaultMessage:"Alphabetical",id:"database.groupMenu.textGroupBy.alphabetical"}):void(0,m().HB)(e)}function ee(e){var t;const r=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!r)throw new Error("View type was not defined.");return r}function te(e){return e.permissionScopesStore.state.canConfigureBlock}function re({collectionSettingsStore:e,collectionContextStore:t}){const r=(0,n().K8)((()=>(0,V().S)(e)),[e]),a=(0,n().K8)((()=>ee(t)),[t]);return r&&"group"===r.type?"collection_group_by"===r.groupByKey&&"board"===a?(0,I.jsx)(p().sA,{defaultMessage:"Sub-group",id:"database.viewSettings.groupTab.subGroup.title"}):(0,I.jsx)(p().sA,{defaultMessage:"Group",id:"database.viewSettings.groupTab.group.title"}):null}function ae({groupBy:e,collectionContextStore:t,collectionSettingsStore:r,groupByKey:a,groupsFormatKey:i}){const s=(0,o().v3)(),l=(0,n().O$)(t.normalizedSchemaStore),u=e?l[e.property]:void 0,d=(0,n().K8)((()=>te(t)),[t]),c=(0,n().K8)((()=>ee(t)),[t]);return(0,I.jsx)(R().A,{title:O(a,c),showChevron:!0,right:(0,I.jsx)(E,{groupByPropertySchema:u}),onClick:()=>{(0,h().X)({environment:s,collectionContextStore:t,action:"click_group_by_property",original_view_type:void 0,property_type:null==u?void 0:u.type}),k().a2({collectionSettingsStore:r,item:{type:"groupByProperty",groupByKey:a,groupsFormatKey:i}})},disabled:!d})}function oe(e){const{collectionContextStore:t}=e,r=(0,o().v3)(),s=(0,n().O$)(t.canConfigureBlockStore),l=(0,n().O$)(t.normalizedFormatStore),u=(0,n().K8)((()=>(0,x().FS)(l)),[l]),d=(0,a.useCallback)((()=>{k().ut({environment:r,collectionContextStore:t})}),[r,t]),c=(0,i().IS)((()=>({textWrapper:{opacity:1}})),[]);return(0,I.jsx)(w().A,{title:(0,I.jsx)(p().sA,{id:"database.viewSettings.groupTab.colorColumns",defaultMessage:"Color columns"}),on:!u,focused:!1,onClick:d,disabled:!s,textWrapperStyle:c.textWrapper})}function ne({groupBy:e,collectionContextStore:t,collectionSettingsStore:r,groupByKey:a,groupsFormatKey:i}){const s=(0,o().v3)(),l=(0,n().O$)(t.normalizedSchemaStore),d=(0,n().K8)((()=>te(t)),[t]),c="formula"===e.type?{...e.groupBy,property:e.property}:e;return(0,u().Ik)(c)?(0,I.jsx)(D().A,{title:W({groupBy:c,schema:l}),popupStyle:{minWidth:190},selectedKey:c.groupBy,options:u().BI.map((e=>({key:e,type:"button",title:Q(e)}))),onChange:e=>function(e,t,r,a,o){const n=(0,u().H2)(r.normalizedFormatStore.state,a,o),i=r.collectionViewStore();if(!n||!i)return;const s=Y(n);if(s){if((0,u().Ik)(n))v().createAndCommit({userAction:"CollectionSettingsViewGroup.handleDateGroupByTypeChange",environment:t,canUndo:!0,perform:t=>{f().zA({stores:[i],update:{[a]:{...n,groupBy:e},[o]:void 0},transaction:t}),"week"===e&&f().Jo(i,t)}});else if("formula"===n.type){const r={...y().cJ(s,"property"),type:"date",groupBy:e},l={...n,groupBy:r};v().createAndCommit({userAction:"CollectionSettingsViewGroup.handleDateGroupByTypeChange",environment:t,canUndo:!0,perform:t=>{f().zA({stores:[i],update:{[a]:l,[o]:void 0},transaction:t}),"week"===e&&f().Jo(i,t)}})}(0,h().X)({environment:t,collectionContextStore:r,action:"update_date_group_by"})}}(e,s,t,a,i),disabled:!d}):(0,u().Vh)(c)?(0,I.jsx)(D().A,{title:W({groupBy:c,schema:l}),popupStyle:{minWidth:190},selectedKey:c.groupBy,options:u().ah.map((e=>({key:e,type:"button",title:J(e)}))),onChange:e=>function(e,t,r,a,o){const n=(0,u().H2)(r.normalizedFormatStore.state,a,o),i=r.collectionViewStore();if(!n||!i)return;const s=U(n);if(s){if((0,u().Vh)(n))v().createAndCommit({userAction:"CollectionSettingsViewGroup.handleTextGroupByTypeChange",environment:t,canUndo:!0,perform:t=>{f().zA({stores:[i],update:{[a]:{...n,groupBy:e},[o]:void 0},transaction:t})}});else if("formula"===n.type){const r={...y().cJ(s,"property"),groupBy:e},l={...n,groupBy:r};v().createAndCommit({userAction:"CollectionSettingsViewGroup.handleTextGroupByTypeChange",environment:t,canUndo:!0,perform:e=>{f().zA({stores:[i],update:{[a]:l,[o]:void 0},transaction:e})}})}(0,h().X)({environment:t,collectionContextStore:r,action:"update_text_group_by"})}}(e,s,t,a,i),disabled:!d}):"number"===c.type?(0,I.jsx)(R().A,{title:W({groupBy:c,schema:l}),showChevron:!0,right:$({groupBy:c,schema:l}),onClick:()=>{k().a2({collectionSettingsStore:r,item:{type:"groupByNumber",groupByKey:a,groupsFormatKey:i}})},disabled:!d}):"status"===c.type?(0,I.jsx)(D().A,{title:W({groupBy:c,schema:l}),popupStyle:{minWidth:190},selectedKey:c.groupBy,options:u().PC.map((e=>{return{key:e,type:"button",title:(t=e,"group"===t?(0,I.jsx)(p().sA,{...X.group}):"option"===t?(0,I.jsx)(p().sA,{...X.option}):void(0,m().HB)(t))};var t})),onChange:e=>function(e,t,r,a,o){const n=(0,u().H2)(r.normalizedFormatStore.state,a,o),i=r.collectionViewStore();n&&i&&"status"===(null==n?void 0:n.type)&&(v().createAndCommit({userAction:"CollectionSettingsViewGroup.handleStatusGroupByTypeChange",environment:t,canUndo:!0,perform:t=>{f().zA({stores:[i],update:{[a]:{...n,groupBy:e},[o]:void 0},transaction:t})}}),(0,h().X)({environment:t,collectionContextStore:r,action:"update_status_group_by"}))}(e,s,t,a,i),disabled:!d}):null}function ie({groupBy:e,collectionContextStore:t,groupByKey:r,groupsFormatKey:a}){const i=(0,o().v3)(),s=(0,n().K8)((()=>(0,u().Nf)(e)),[e]),l=(0,n().K8)((()=>te(t)),[t]);if(s.length<=1)return null;const d=(0,u().Kq)(e);return(0,I.jsx)(D().A,{title:(0,I.jsx)(p().sA,{defaultMessage:"Sort",id:"database.viewSettings.groupTab.sort"}),popupStyle:{minWidth:190},selectedKey:d.type,options:s.map((t=>({key:t,type:"button",title:B().A.formatMessage((0,x().rA)(e,t))}))),onChange:e=>{v().createAndCommit({userAction:"CollectionSettingsViewGroup.handleSortTypeChange",environment:i,canUndo:!0,perform:o=>{(0,S().y)({sortType:e,environment:i,collectionContextStore:t,groupByKey:r,groupsFormatKey:a,transaction:o})}})},disabled:!l})}function se({groupBy:e,groupByKey:t,collectionContextStore:r,groupsFormatKey:i,groupsDisplayState:s}){const l=(0,o().v3)(),d=(0,a.useCallback)((()=>function(e,t,r,a,o){const n=(0,u().H2)(r.normalizedFormatStore.state,t,a);if(!o)return;const{currentGroups:i}=o,s=r.collectionViewStore();if(!n||!s)return;const l=!n.hideEmptyGroups;v().createAndCommit({userAction:"CollectionSettingsViewGroup.handleHideEmptyGroupsClick",environment:e,canUndo:!0,perform:e=>{if(l){const t=i.map((e=>!1===e.hidden?{...e,hidden:void 0}:e));(0,b().o)({collectionContextStore:r,newGroups:t,groupsFormatKey:a,transaction:e})}f().zA({stores:[s],update:{[t]:{...n,hideEmptyGroups:l}},transaction:e})}}),(0,h().X)({environment:e,collectionContextStore:r,action:"toggle_hide_empty_groups"})}(l,t,r,i,s)),[l,t,r,i,s]),c=(0,n().K8)((()=>te(r)),[r]);return(0,I.jsx)(w().A,{title:(0,I.jsx)(p().sA,{defaultMessage:"Hide empty groups",id:"database.viewSettings.groupTab.hideEmptyGroups"}),on:Boolean(e.hideEmptyGroups),focused:!1,onClick:d,disabled:!c,textWrapperStyle:{opacity:1}})}function le({groupsFormatKey:e,collectionContextStore:t,groupByKey:r,reducerResultStore:a,groupsDisplayState:o}){const i=(0,n().O$)(t.normalizedSchemaStore),l=(0,n().K8)((()=>(0,u().H2)(t.normalizedFormatStore.state,r,e)),[t,r,e]),d=(0,n().K8)((()=>{if(!l)return;const a=t.normalizedFormatStore.state;return(0,s().p)({groupBy:l,schema:i,format:a,groupsFormatKey:e,limit:c().O3,returnHiddenGroups:!0,returnPinnedGroups:"board_columns_by"===r,aggregation:void 0})}),[l,t.normalizedFormatStore,i,e,r]);return l?d?(0,I.jsx)(_().A,{id:(0,G().Q)(e),reducer:d,collectionContextStore:t,resultStore:a,render:()=>(0,I.jsx)(P().L,{collectionContextStore:t,groupBy:l,groupByKey:r,groupsFormatKey:e,groupsDisplayState:o})}):(0,I.jsx)(P().L,{collectionContextStore:t,groupBy:l,groupByKey:r,groupsFormatKey:e,groupsDisplayState:o}):null}},818367:(e,t,r)=>{r.d(t,{x:()=>o});var a=()=>r(242422);function o(){return a().default.getConfigKey("collection_reducer_request_settings","chart").debounce_wait_ms}},831030:(e,t,r)=>{r.d(t,{_G:()=>X,$k:()=>K,w$:()=>U,H$:()=>O,l9:()=>q,NH:()=>Y,jY:()=>E,JI:()=>H,ck:()=>L,i5:()=>W,EN:()=>Z,gc:()=>I,wK:()=>z});var a=()=>r(906745),o=r(296540),n=()=>r(726637),i=()=>r(401497),s=()=>r(764880),l=()=>r(100594),u=()=>r(901610),d=()=>r(62371),c=()=>r(713998),g=()=>r(534177),p=()=>r(825237),y=()=>r(651124),m=()=>r(792071),h=r(474848);const f=o.memo((function(e){const{size:t,style:r,icon:a,baseUrl:o,getRecordModel:n}=e;return(0,h.jsx)("div",{style:{height:t,width:t,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,verticalAlign:"top",marginTop:1,...r},children:(0,h.jsx)(b,{icon:a,size:t,baseUrl:o,getRecordModel:n})})}));function v(e){return.9*e}function S(e){return.888*e}function b({icon:e,size:t,baseUrl:r,getRecordModel:a}){if(!e)return null;const o=(e,a)=>{const o=p().wY({url:e,baseUrl:r,fullyQualified:!0,permissionRecord:a,width:S(t),userId:void 0});return(0,h.jsx)("img",{alt:"icon",src:o,style:{width:S(t),height:S(t),objectFit:"cover",borderRadius:4,marginTop:1}})},n=(0,y().WO)(e.icon);switch(n.type){case"unicode_emoji":return(0,h.jsx)("div",{style:{fontSize:v(t)},children:n.emoji.unicode});case"custom_emoji":const r=m().xm7.resolveCustomEmojiIcon(e,a);return r?o(r.icon,r.pointer):null;case"app_package_asset":case"notion_icon":case"url":return o(e.icon,e.pointer);default:(0,g().HB)(n)}}var x=()=>r(522419),_=()=>r(216519);const C=function(e){const{botValue:t,avatarSize:r,baseUrl:a,theme:o,style:n}=e;if(null!=t&&t.icon){const i=x().GM(t.icon)?p().x8({url:t.icon,width:e.avatarSize,fullyQualified:!0,stripGoogleIconQuery:!0,baseUrl:a,userId:void 0}):t.icon;return(0,h.jsx)("div",{style:{...(0,_().fo)({theme:o,avatarSize:r}),...n},children:(0,h.jsx)("img",{src:i,style:{display:"block",width:"100%",height:"100%",objectFit:"cover"}})})}if(null!=t&&t.name){const e=t.name[0];return(0,h.jsx)("div",{children:(0,h.jsx)("div",{style:{...(0,_().ws)({theme:o,avatarSize:r}),...n},children:(0,h.jsx)("div",{children:e})})})}return(0,h.jsx)("span",{children:""})};var w=()=>r(658985),M=()=>r(437607);function B(e){const{group:t,getRecordModel:r,size:a=20,baseUrl:o,theme:n,groupIconStyles:i}=e,s={...(0,_().fo)({theme:n,avatarSize:a}),...e.avatarBackground};if(null!=t&&t.icon){const e=(0,y().WO)(t.icon);switch(e.type){case"unicode_emoji":return(0,h.jsx)("div",{style:s,children:(0,h.jsx)("div",{style:{fontSize:.9*a},children:e.emoji.unicode})});case"custom_emoji":const n=(0,M().S4)({spacePermissionGroupId:t.id,spaceId:t.space_id}),l=m().xm7.resolveCustomEmojiIcon({pointer:n,icon:t.icon},r);if(!l)return(0,h.jsx)(A,{groupIconStyles:i});const u=p().wY({url:l.icon,baseUrl:o,fullyQualified:!0,permissionRecord:l.pointer,width:a,userId:void 0});return(0,h.jsx)("div",{style:s,children:(0,h.jsx)("img",{src:u,alt:t.name,style:{display:"block",width:"100%",height:"100%",objectFit:"cover"}})});case"app_package_asset":case"notion_icon":case"url":const d=x().GM(t.icon)?p().x8({url:t.icon,width:a,fullyQualified:!0,stripGoogleIconQuery:!0,baseUrl:o,userId:void 0}):t.icon;return(0,h.jsx)("div",{style:s,children:(0,h.jsx)("img",{src:d,alt:t.name,style:{display:"block",width:"100%",height:"100%",objectFit:"cover"}})});default:(0,g().HB)(e)}}return(0,h.jsx)(A,{groupIconStyles:i})}function A(e){const{groupIconStyles:t}=e;return(0,h.jsx)("div",{style:null==t?void 0:t.iconContainer,children:(0,w().$)(null==t?void 0:t.icon)})}var T=()=>r(597777),k=()=>r(869190),G=()=>r(72135),V=()=>r(379632),P=()=>r(100622),j=()=>r(284371),F=()=>r(934201),R=()=>r(903047),D=()=>r(698449);const K=(0,r(69708).YK)({titlePlaceholder:{defaultMessage:"Untitled",id:"chartLabelFormatHelpers.untitledBlock"}});function I(e,t,r){const a=r?16:20,l=(0,i().IS)((e=>({wrapper:{display:"flex",alignItems:"center",gap:6,minWidth:0},initialStyle:{backgroundColor:e.background.elevated,border:`1px solid ${e.border.primary}`,color:e.text.secondary},avatarStyle:{background:"none"},botStyle:{backgroundColor:e.background.elevated,border:`1px solid ${e.border.primary}`,color:e.text.secondary,fontSize:r?8:10},avatarWrapper:{flexShrink:0},nameWrapper:{minWidth:0,...j().RC}})),[r]),u=(0,R().E)({size:a});return(0,o.useCallback)(((o,i)=>{var d;if(!i)return o.toString();let c,g,p;if(i.actorPointer&&e)if((0,M().I6)(i.actorPointer)){var y;const r=(0,M().S4)({spacePermissionGroupId:i.actorPointer.id,spaceId:i.actorPointer.spaceId});g=e(r),p=(0,D().Pf)({intl:t,groupName:null===(y=g)||void 0===y?void 0:y.name})}else{var f;const r=(0,s().xC)({pointer:i.actorPointer,getRecordModel:e});g=null==r?void 0:r.asActor,p=null===(f=g)||void 0===f?void 0:f.getDisplayName(t)}return p||(p=o||t.formatMessage(m().Fvx.messages.anonymousPlaceholder)),c="space_permission_group"===(null===(d=g)||void 0===d?void 0:d.table)&&e&&g instanceof m().G1c?(0,h.jsx)(B,{group:g,getRecordModel:e,size:a,baseUrl:n().A.domainBaseUrl,theme:(0,P().x0)(),avatarBackground:l.avatarStyle,groupIconStyles:u}):g instanceof m().Fvx&&g.isUser()?(0,h.jsx)(_().Ay,{userValue:g,avatarSize:a,baseUrl:n().A.domainBaseUrl,theme:(0,P().x0)(),fontSize:r?8:10,initialStyle:l.initialStyle,avatarStyle:l.avatarStyle}):g instanceof m().HaY&&g.isBot()?(0,h.jsx)(C,{botValue:g,avatarSize:a,baseUrl:n().A.domainBaseUrl,theme:(0,P().x0)(),style:l.botStyle}):(0,h.jsx)(_().Ay,{userValue:{name:"?"},avatarSize:a,baseUrl:n().A.domainBaseUrl,theme:(0,P().x0)(),fontSize:r?8:10,initialStyle:l.initialStyle,avatarStyle:l.avatarStyle}),V().A.renderToStaticMarkup((0,h.jsxs)("div",{style:l.wrapper,children:[(0,h.jsx)("div",{style:l.avatarWrapper,children:c}),r?(0,h.jsx)("div",{style:l.nameWrapper,children:p}):null]}))}),[e,t,r,l,u,a])}function z(e,t,r){const a=(0,i().IS)((()=>({wrapper:{display:"flex",alignItems:"center",gap:6,minWidth:0},avatarWrapper:{flexShrink:0},titleWrapper:{minWidth:0,...j().RC}})),[]),s=t.formatMessage(K.titlePlaceholder);return(0,o.useCallback)(((o,i)=>{if(!i||!e)return o.toString()||s;let l;if(i.pagePointer&&e&&(l=e(i.pagePointer)),!l)return o.toString()||s;const u=l.getRenderTitleWithPlaceholder({getRecordModel:e,userTimeZone:r,intl:t}),d=l.getRenderIcon({getRecordModel:e});return V().A.renderToStaticMarkup((0,h.jsxs)("div",{style:a.wrapper,children:[d?(0,h.jsx)("div",{style:a.avatarWrapper,children:(0,h.jsx)(f,{getRecordModel:e,icon:d,size:16,baseUrl:n().A.domainBaseUrl})}):void 0,(0,h.jsx)("div",{style:a.titleWrapper,children:u})]}))}),[e,r,t,s,a.wrapper,a.avatarWrapper,a.titleWrapper])}function L(e){var t,r,a,o;const n="count"===(null===(t=e.aggregation)||void 0===t?void 0:t.aggregator)||"unique"===(null===(r=e.aggregation)||void 0===r?void 0:r.aggregator)?"number":H(e.propertySchema);let i;return i="count"===(null===(a=e.aggregation)||void 0===a?void 0:a.aggregator)||"unique"===(null===(o=e.aggregation)||void 0===o?void 0:o.aggregator)?"precision_0":"precision_from_number_property"===e.numberPrecisionOverride?W(e.propertySchema):e.numberPrecisionOverride,t=>"string"==typeof t?t:i&&"precision_uncapped"!==i?(0,G().ZV)(t,n,e.intl,"compact",i):(0,G().ZV)(Z(t,2),n,e.intl,"compact",void 0)}function E({groupBy:e,dateFormat:t,intl:r}){return(a,o)=>{let n;return n=o?o.name:"string"==typeof a?a:a.toString(),O({dateString:n,dateFormat:t,groupBy:e,intl:r})}}function O({dateString:e,dateFormat:t,groupBy:r,intl:o}){const n=parseInt(e,10);if(isNaN(n))return e;switch(r){case"relative":default:return e;case"day":return(0,k().ZF)({value:{type:"date",start_date:a().c9.fromMillis(n).toISODate()},date_format:t||T().vz,allowRelativeDates:!0,intl:o});case"week":case"month":case"year":const i=a().c9.fromMillis(n),s={type:r,range:{type:"daterange",start_date:i.toISODate(),end_date:i.plus({[`${r}s`]:1}).minus({days:1}).toISODate()}};return(0,F().nc)({value:s,intl:o})}}function H(e){let t;return("number"===e.type||"formula"===e.type)&&(t=e.number_format),t}function W(e){return"number"===e.type||"formula"===e.type?e.number_precision:void 0}function Y({chartConfig:e,schema:t,highChartsLabel:r,highChartsValue:a,isMultiSeries:o,intl:n,numberPrecisionOverride:i}){let s=r,d=a;if(!e)return{label:s,value:d};const g=e.dataConfig;let p,y,m,h;if(o){if((0,u().m)(e)&&"groups_reducer"===e.dataConfig.type){var f;const r=e.dataConfig;if(p=null===(f=r.aggregationConfig.stackOptions)||void 0===f?void 0:f.groupBy,p){const e=(0,c()._g)({schema:t,property:p.property});e&&(0,l().zn)(e)&&(y=e)}h=r.aggregationConfig.aggregation,"count"!==h.aggregator&&(m=(0,c()._g)({schema:t,property:h.property}))}}else"groups_reducer"===g.type?(p=g.groupBy,y=(0,c()._g)({schema:t,property:g.groupBy.property}),h=g.aggregationConfig.aggregation,"count"!==h.aggregator&&(m=(0,c()._g)({schema:t,property:h.property}))):m=(0,c()._g)({schema:t,property:g.valueProperty});if(s=y?U({propertySchema:y,groupByFormat:p,aggregation:void 0,highChartsLabel:r,intl:n}):s,d&&"number"==typeof d&&m&&(0,l().JW)(m)){var v,S,b,x;const e="count"===(null===(v=h)||void 0===v?void 0:v.aggregator)||"unique"===(null===(S=h)||void 0===S?void 0:S.aggregator)?"number":H(m),t="count"===(null===(b=h)||void 0===b?void 0:b.aggregator)||"unique"===(null===(x=h)||void 0===x?void 0:x.aggregator)?"precision_0":i??W(m);d=t&&"precision_uncapped"!==t?(0,G().ZV)(d,e,n,"compact",t):(0,G().ZV)(Z(d,2),e,n,"compact")}return{label:s,value:d}}function U(e){const{propertySchema:t,groupByFormat:r,aggregation:a,highChartsLabel:o,intl:n}=e;if(t&&(0,l().JW)(t)){const e="count"===(null==a?void 0:a.aggregator)||"unique"===(null==a?void 0:a.aggregator)?"number":H(t),r=parseInt(o,10);return isNaN(r)||"percent"===e?o:(0,G().ZV)(r,e,n,"compact")}const i="formula"===(null==r?void 0:r.type)?r.groupBy:r;return t&&(0,l().i8)(t)&&i&&(0,d().Ik)(i)?O({dateString:o,dateFormat:t.date_format,groupBy:i.groupBy,intl:n}):o}const N=1.2,$=2;function X(e){var t,r,a,o;if("count"===(null===(t=e.aggregation)||void 0===t?void 0:t.aggregator)||"unique"===(null===(r=e.aggregation)||void 0===r?void 0:r.aggregator))return!1;return"percent"===H(e.propertySchema)||(void 0!==e.userYAxisMax&&void 0!==e.userYAxisMin&&Math.abs(e.userYAxisMax-e.userYAxisMin)<$||(!!(null!==(a=e.userYAxisMax)&&void 0!==a&&a.toString().includes(".")||null!==(o=e.userYAxisMin)&&void 0!==o&&o.toString().includes("."))||Math.abs(e.dataYAxisMax)<N&&Math.abs(e.dataYAxisMin)<N))}function q(e){return e%1==0?e:e.toFixed(1)}function Z(e,t){const r=Math.pow(10,t);return Math.round(e*r)/r}}}]);