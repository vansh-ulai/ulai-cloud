"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[37125,96772],{29037:(e,t,o)=>{o.r(t),o.d(t,{checkmarkIcon:()=>i,iconDefinition:()=>n});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"3.92 3.91 12.17 12.18",svg:(0,o(474848).jsx)("path",{d:"M15.784 4.002a.625.625 0 0 1 .214.857L9.445 15.784a.625.625 0 0 1-1.01.085l-4.37-5.098a.625.625 0 0 1 .948-.814l3.806 4.44 6.109-10.181a.625.625 0 0 1 .857-.214"})},i=(0,o(340498).wt)("checkmark",n)},53436:(e,t,o)=>{o.d(t,{E:()=>l});o(296540);var n=()=>o(59226),i=()=>o(401497),s=()=>o(209199),r=()=>o(993949),a=o(474848);function l(e){const{children:t,size:o="sm",...l}=e,c=(0,n().X)("client_rtl_support"),d=(0,i().IS)((e=>({wrapper:{display:"flex",alignItems:"center",gap:"lg"===o?2:void 0,background:e.background.elevated,boxShadow:e.shadowSM,borderRadius:6,width:"fit-content",padding:2}})),[o]);return(0,a.jsx)("div",{...l,dir:c&&(0,s().A1)()?"rtl":"ltr",style:d.wrapper,children:(0,a.jsx)(r().J.Provider,{value:{size:o},children:t})})}},65767:(e,t,o)=>{o.d(t,{l:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("closeThick",{viewBox:"0 0 8 8",svg:(0,n.jsx)("polygon",{points:"8 1.01818182 6.98181818 0 4 2.98181818 1.01818182 0 0 1.01818182 2.98181818 4 0 6.98181818 1.01818182 8 4 5.01818182 6.98181818 8 8 6.98181818 5.01818182 4"})})},77126:(e,t,o)=>{o.d(t,{j:()=>i});class n extends(()=>o(959180))().A{}const i=new n},102777:(e,t,o)=>{o.d(t,{b:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("sendArrow",{viewBox:"0 0 20 20",svg:(0,n.jsx)("path",{d:"M9.79883 18.5894C14.6216 18.5894 18.5894 14.6216 18.5894 9.79883C18.5894 4.96777 14.6216 1 9.79053 1C4.95947 1 1 4.96777 1 9.79883C1 14.6216 4.96777 18.5894 9.79883 18.5894ZM9.79883 14.3062C9.20947 14.3062 8.76953 13.9077 8.76953 13.3433V9.69922L8.86914 8.00586L8.25488 8.84424L7.3916 9.81543C7.23389 10.0063 6.98486 10.1143 6.72754 10.1143C6.21289 10.1143 5.84766 9.75732 5.84766 9.25928C5.84766 8.99365 5.92236 8.79443 6.12158 8.58691L8.96045 5.61523C9.19287 5.35791 9.4585 5.2417 9.79883 5.2417C10.1309 5.2417 10.4048 5.36621 10.6372 5.61523L13.4761 8.58691C13.667 8.79443 13.75 8.99365 13.75 9.25928C13.75 9.75732 13.3848 10.1143 12.8618 10.1143C12.6128 10.1143 12.3638 10.0063 12.2061 9.81543L11.3428 8.86914L10.7202 7.99756L10.8281 9.69922V13.3433C10.8281 13.9077 10.3799 14.3062 9.79883 14.3062Z"})})},147294:(e,t,o)=>{o.d(t,{Ee:()=>h,J1:()=>u,oG:()=>m});o(296540);var n=()=>o(59226),i=()=>o(56366),s=()=>o(401497),r=()=>o(970236),a=()=>o(69708),l=()=>o(765957),c=o(474848);const d={define_variables_automation_action:{launchDateMs:17277408e5,expiryDateMs:1738368e6},passkey_setting:{launchDateMs:1729101727e3,expiryDateMs:1738432882e3},http_request_automation_action:{launchDateMs:173324302e4,expiryDateMs:1738368e6},publish_site_settings_embed_page:{launchDateMs:1736208e6,expiryDateMs:1743984e6},generalized_recurrence_automations:{launchDateMs:17365536e5,expiryDateMs:17460576e5},ai_page_translation_topbar_more_action:{launchDateMs:1740451280830,expiryDateMs:17434656e5},verification:{launchDateMs:1740096e6,expiryDateMs:174375e7},notion_ai_workspace_settings:{launchDateMs:17424288e5,expiryDateMs:17550432e5},notion_mail_launch_modal:{launchDateMs:17446752e5,expiryDateMs:17525376e5},notion_mail_launch_modal_2:{launchDateMs:17446752e5,expiryDateMs:17578944e5},ui_doc_example:{launchDateMs:19249056e5,expiryDateMs:19249056e5},collection_property_permissions:{launchDateMs:17433792e5,expiryDateMs:17671392e5},salesforce_sync_unfurling_option:{launchDateMs:17443296e5,expiryDateMs:17538336e5},personal_home_sidebar_item:{launchDateMs:17470944e5,expiryDateMs:175392e7},collection_property_reminder:{launchDateMs:1751958e6,expiryDateMs:17552628e5},get_notified_onboarding_tooltip:{launchDateMs:17520228e5,expiryDateMs:17591904e5},conditional_color_feature:{launchDateMs:17537472e5,expiryDateMs:17563392e5},web_clipper_new_tab_settings:{launchDateMs:17471808e5,expiryDateMs:18149184e5},my_meetings:{launchDateMs:17578944e5,expiryDateMs:17657568e5}};function u({style:e}){const t=(0,s().IS)((()=>({badge:{letterSpacing:0,whiteSpace:"nowrap",width:"fit-content",...e}})),[e]);return(0,c.jsx)(r().E,{color:"blue",style:t.badge,content:(0,c.jsx)(a().sA,{id:"newBadgeComponent.label",defaultMessage:"New"})})}function m(e){return(0,i().K8)((()=>{const{launchDateMs:t,expiryDateMs:o}=d[e],{currentUserSettingsStore:n}=l().default.state;if(n&&n.isReady()){var i;const e=null===(i=n.getSettings())||void 0===i?void 0:i.signup_time;if(e&&e>t)return!1}return Date.now()<=o}),[e])}function p({style:e,newBadgeKey:t}){return m(t)?(0,c.jsx)(u,{style:e}):null}function g({style:e,newBadgeKey:t}){return(0,n().X)(t)?(0,c.jsx)(u,{style:e}):null}function h(e){return e.didUserEngage?null:"feature_gate"===e.keyType?(0,c.jsx)(g,{...e}):(0,c.jsx)(p,{...e})}},162402:(e,t,o)=>{o.d(t,{q:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("circleCheckFilled",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M8 16c4.377 0 8-3.631 8-8 0-4.376-3.631-8-8.008-8C3.624 0 0 3.624 0 8c0 4.369 3.631 8 8 8zm-.886-4.165c-.267 0-.487-.11-.69-.384l-1.97-2.416a.852.852 0 01-.187-.51c0-.352.274-.643.627-.643.228 0 .4.07.596.33l1.592 2.055 3.35-5.38c.148-.236.352-.362.556-.362.345 0 .667.236.667.604 0 .173-.102.353-.196.518l-3.686 5.804c-.165.259-.393.384-.66.384z"})})},173783:(e,t,o)=>{o.d(t,{A:()=>r});o(296540);var n=()=>o(658985),i=()=>o(903047),s=o(474848);function r(e){const t=(0,i().E)(e),o=(0,n().$)(t.icon);return(0,s.jsx)("div",{style:t.iconContainer,children:o})}},182034:(e,t,o)=>{o.d(t,{O:()=>u,e:()=>d});o(898992),o(672577);var n=()=>o(908006),i=()=>o(878523),s=()=>o(190033),r=()=>o(892632),a=()=>o(299545),l=()=>o(77126),c=()=>o(489348);function d(e,t){const o=a().dd(t),n=r().xh(o);e.setState({...e.state,files:n})}async function u(e){const{blockStore:t,pageViewBlockStore:o,environment:r}=e;o?o.setState({...o.state,forceDiscussionOpen:!0}):c().A.openNewPageDiscussionInput(t),i().o2(r,{from:"page_comments"}),await n().default.afterNextFlush();const a=l().j.find((e=>e.getBlockStore().id===t.id)),d=null==a?void 0:a.getInputStore();d&&(0,s().z)({store:d.state.textStore})}},203901:(e,t,o)=>{o.d(t,{F:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"3.37 1.37 13.26 16.26",svg:(0,o(474848).jsx)("path",{d:"M10.809 1.478a.625.625 0 0 0-.864.867l.08.099 1.942 1.932H10A6.625 6.625 0 1 0 16.625 11a.625.625 0 1 0-1.25 0A5.375 5.375 0 1 1 10 5.626h1.963L10.038 7.56l-.08.098a.626.626 0 0 0 .966.783l2.993-3.007.077-.096a.625.625 0 0 0-.08-.788l-3.007-2.993z"})},i=(0,o(340498).wt)("arrowCircleSpinClockwise",n)},253448:(e,t,o)=>{o.d(t,{d:()=>E});var n=o(296540),i=()=>o(59226),s=()=>o(726637),r=()=>o(484714),a=()=>o(56366),l=()=>o(929219),c=()=>o(718827),d=()=>o(98126),u=()=>o(69708),m=()=>o(896628),p=()=>o(231297),g=()=>o(608581),h=()=>o(145214),f=()=>o(559273),v=()=>o(401497),S=()=>o(534177),x=o(474848);function b({src:e,placeholderSrc:t,placeholderBehavior:o,imageStyle:i,containerStyle:s,onLoadComplete:r,testId:a}){const[l,c]=(0,n.useState)(!0);let d;switch(o){case"force-show-placeholder":d=!0;break;case"force-show-src":d=!1;break;case"show-placeholder-if-loading-src":d=!!t&&(l||void 0===e);break;default:(0,S().HB)(o)}const u=(0,v().IS)((()=>{const e={gridColumn:1,gridRow:1};return{container:{display:"grid",...s},srcWrapper:{...d&&{display:"none"},...e},placeholderWrapper:{pointerEvents:"none",...e}}}),[s,d]);(0,n.useEffect)((()=>{void 0!==e&&c(!0)}),[e]);const m=(0,n.useCallback)((e=>{c(!1),null==r||r()}),[r]);return(0,x.jsxs)("div",{style:u.container,children:[(0,x.jsx)(f().A,{src:e,onLoad:m,style:i,placeholderStyle:u.srcWrapper,placeholderLoadedStyle:u.srcWrapper,testId:a}),t?(0,x.jsx)(f().A,{src:t,style:i,placeholderStyle:u.placeholderWrapper,placeholderLoadedStyle:u.placeholderWrapper}):void 0]})}var y=()=>o(773382),C=()=>o(360083),k=()=>o(801678),A=()=>o(454305),w=()=>o(600871),M=()=>o(393686),I=()=>o(568365),j=()=>o(77246),L=()=>o(867772),D=()=>o(478726);var B=()=>o(645873);const R=new(B().O2)("AnimatedCoverImageActionBar",(async()=>o.e(40454).then(o.bind(o,166913)))),_=(0,B()._h)(R,(e=>e.AnimatedCoverImageActionBar)),T=280,P={display:"flex",alignItems:"center",justifyContent:"center",padding:"4px 6px",borderInlineEnd:`1px solid ${o(100622).IF.whiteWithAlpha(.2)}`};function E(e){const{store:t,disabled:o,paddingRight:s,paddingLeft:l,height:c,proxyWidth:u}=e,g=(0,i().X)("action_bar_reskin"),h=(0,r().v3)(),v=(0,r().Y0)(),S=(0,a().uB)(void 0,A().A),M=(0,a().K8)((()=>o||"suggest"===j().Uv.getMode(t)||(0,w().aD)(v)),[o,t,v]),D=(0,a().K8)((()=>t.getCover()),[t]),B=(0,a().O$)(I().M),[R,P]=(0,n.useState)(void 0);if(!D)return null;const E=B.loadingMode!==L().pF&&B.loadingMode!==L().Wc;return(0,x.jsx)(k().A,{mouseStore:S,onFlushTemporaryPosition:e=>function(e,t,o){const{imagePosition:n,reset:i}=e;p().createAndCommit({userAction:"PageCover.handleFlushTemporaryPosition",environment:o,canUndo:!0,perform:e=>{m().yY({store:t,coverPosition:n,transaction:e}),i()}})}(e,t,h),renderControl:({handleRepositionClick:e,handleSavePositionClick:o,handleCancelClick:n,isVisible:i,isRepositioning:r})=>g?M?null:(0,x.jsx)(_,{store:t,mouseStore:S,imageUrl:R,handleRepositionClick:e,handleSavePositionClick:o,handleCancelClick:n,visible:i,isRepositioning:r,paddingLeft:l,paddingRight:s}):(0,x.jsx)(F,{handleRepositionClick:e,handleSavePositionClick:o,handleCancelClick:n,isVisible:i,isRepositioning:r,lastProxiedUrl:R,store:t,disabled:M,paddingRight:s,paddingLeft:l,mouseStore:S}),source:"page",store:t,style:{display:"flex",flexDirection:"column",alignItems:"center",height:c,maxHeight:T,cursor:"default"},preventClickPropagation:!0,render:e=>(0,x.jsxs)(n.Fragment,{children:[(0,x.jsx)(C().A,{url:D.cover,isAuthenticated:!0,permissionRecord:D.pointer,width:u,onFinishedLoadingProxyUrl:P,render:(t,o)=>{const n={width:"100%",height:c,maxHeight:T,objectFit:"cover",opacity:E?.5:1,objectPosition:`center ${100*(1-(e.imagePosition||0))}%`,borderRadius:0},i={width:"100%",height:c,maxHeight:T};return(0,x.jsx)(b,{src:o,placeholderSrc:E?B.dataURL:void 0,placeholderBehavior:E?"force-show-placeholder":"show-placeholder-if-loading-src",containerStyle:i,imageStyle:n,onLoadComplete:U,testId:"pageCover"})}},D.pointer.id),E?(0,x.jsxs)("div",{style:f().f,children:[(0,x.jsx)(d().A,{size:"md",style:{marginInlineEnd:4}}),(0,x.jsx)("div",{style:{minWidth:30,textAlign:"end"},children:void 0!==B.uploadProgress?(0,x.jsx)(y().A,{percentage:B.uploadProgress}):B.progressText?(0,x.jsx)("span",{children:B.progressText}):null})]}):void 0]})})}function U(){I().M.reset()}function F({isVisible:e,isRepositioning:t,handleCancelClick:o,handleRepositionClick:i,handleSavePositionClick:d,lastProxiedUrl:m,store:p,disabled:f,paddingRight:v,paddingLeft:S,mouseStore:b}){const y=(0,r().v3)(),C=(0,u().tz)(),k=(0,n.useCallback)((e=>function(e,t,o,n,i){i.reset();const s=e.target.getBoundingClientRect();M().W({environment:t,intl:o,store:n,rect:s,from:"cover_actions"})}(e,y,C,p,b)),[y,C,p,b]),A=(0,a().K8)((()=>I().M.state.loadingMode),[]),w=(0,a().K8)((()=>function(e){return e.isFullWidth()?"100%":D().x6}(p)),[p]),j=(0,a().O$)(l().e);return f||A!==L().pF||!j?null:(0,x.jsx)(h().A,{animate:{width:w,opacity:e?1:0},style:{position:"absolute",pointerEvents:e?"auto":"none",maxWidth:"100%",top:48},children:(0,x.jsxs)(g().A,{isVisible:e,position:"bottom",style:{marginInlineEnd:v,marginInlineStart:S},children:[t?void 0:(0,x.jsx)(c().Ay,{style:{borderInlineEnd:s().A.isMobile?"none":void 0,...P},onClick:k,children:(0,x.jsx)(u().sA,{defaultMessage:"Change cover",id:"pageCover.changeCover.text"})}),t||s().A.isMobile?void 0:(0,x.jsx)(c().Ay,{style:{...P,borderInlineEnd:"none"},onClick:e=>i(e,m),children:(0,x.jsx)(u().sA,{defaultMessage:"Reposition",id:"pageCover.reposition.text"})}),t&&!s().A.isMobile?(0,x.jsx)(c().Ay,{style:P,onClick:d,children:(0,x.jsx)(u().sA,{defaultMessage:"Save position",id:"pageCover.savePosition.text"})}):void 0,t&&!s().A.isMobile?(0,x.jsx)(c().Ay,{style:{...P,borderInlineEnd:"none"},onClick:o,children:(0,x.jsx)(u().sA,{defaultMessage:"Cancel",id:"pageCover.reposition.cancelText"})}):void 0]})})}},256863:(e,t,o)=>{o.d(t,{A:()=>r});o(296540);var n=()=>o(56366),i=()=>o(824862),s=o(474848);const r=function(e){const{botValue:t,botStore:r,showActiveDot:a,style:l,size:c}=e,d=(0,o(69708).tz)(),u=(0,n().K8)((()=>{if(r){const e=r.getIcon();if(e)return{pointer:{table:i().GP,id:r.id,spaceId:r.getSpaceId()},icon:e}}else if(null!=t&&t.icon)return{pointer:{table:i().GP,id:t.id,spaceId:t.space_id},icon:t.icon}}),[r,t]),m=(0,n().K8)((()=>(null==r?void 0:r.getDisplayName(d))??(0,o(799288).Hg)(t)),[r,t,d]),{activeDotStyle:p}=(0,o(401497).IS)((e=>({activeDotStyle:{height:10,width:10,backgroundColor:e.palette.green[400],border:"2px solid white",borderRadius:"50%",position:"absolute",insetInlineStart:11,top:11}})),[]);return(0,s.jsxs)("div",{style:l,children:[(0,s.jsx)(o(187820).B6,{icon:u,title:m,size:c||18,disabled:!0,isEmptyPage:!1,useInvertedColors:!0}),a?(0,s.jsx)("div",{style:p}):void 0]})}},265665:(e,t,o)=>{o.d(t,{j:()=>c});var n=o(296540),i=()=>o(484714),s=()=>o(401497),r=()=>o(284371),a=()=>o(859428);var l=o(474848);function c({children:e,style:t,tooltipStyle:o,placement:c="bottom"}){const{isSafari:d}=(0,i().Y0)(),u=(0,n.useRef)(null),m=function(e){const[t,o]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{const{current:t}=e;if(!t)return void o(!1);const n="ResizeObserver"in window?new ResizeObserver((([e])=>{o(e.target.scrollWidth>e.target.clientWidth)})):void 0;return null==n||n.observe(t),()=>null==n?void 0:n.unobserve(t)}),[]),t}(u),p=(0,s().IS)((()=>({overflowText:{...r().RC,...t}})),[t]);return(0,l.jsx)(a().A,{delayThreshold:500,placement:c,textWrap:!0,style:o,forceVisibleState:!(d||!m)&&void 0,renderTooltip:()=>m?e:void 0,render:t=>(0,l.jsx)("div",{ref:u,style:p.overflowText,...t,children:e})})}},326496:(e,t,o)=>{o.d(t,{e:()=>s});var n=o(296540),i=o(474848);const s=(0,n.forwardRef)((function(e,t){const{children:s,relative:r,tooltip:a,tooltipPlacement:l="top",iconLeading:c,iconTrailing:d,...u}=e,{size:m}=(0,o(993949).M)(),p=(0,n.useMemo)((()=>c&&"sm"!==m?{size:"default",icon:c}:c),[c,m]),g=(0,n.useMemo)((()=>d&&"sm"!==m?{size:"default",icon:d}:d),[d,m]),h=(0,o(401497).IS)((()=>({button:{borderRadius:o(150161).VJ.xs,position:r?"relative":void 0}})),[r]),f=e=>(0,i.jsx)(o(631524).p,{ref:t,colorPalette:"gray",size:"sm",iconLeading:p,iconTrailing:g,external:!0,style:h.button,...(0,o(553965).A)(u,e),children:s?(0,i.jsx)(o(493552).D,{styleKey:"Caption/Regular",children:s}):void 0});return a?(0,i.jsx)(o(859428).A,{renderTooltip:()=>a,placement:l,alignment:"center",render:f}):f()}))},393686:(e,t,o)=>{o.d(t,{W:()=>h});var n=()=>o(726637),i=()=>o(901389),s=()=>o(896628),r=()=>o(383594),a=()=>o(675925),l=()=>o(231297),c=()=>o(892632),d=()=>o(972435),u=()=>o(867772),m=()=>o(568365);const p=1500,g=(0,o(69708).YK)({pageCover:{defaultMessage:"Page cover",id:"pageCover.title"},fileTypeCaption:{defaultMessage:"Images wider than {idealImageWidth} pixels work best.",id:"pageCover.fileType.caption"},uploadFailed:{defaultMessage:"Upload failed",id:"pageCover.errorDialogMessage.uploadFailed"},preparing:{defaultMessage:"Preparing...",id:"pageCover.status.preparing"},downloading:{defaultMessage:"Downloading...",id:"pageCover.status.downloading"},embedTitle:{defaultMessage:"Link",id:"pageCover.embedType.title"},embedPlaceholder:{defaultMessage:"Paste an image linkâ€¦",id:"pageCover.embedType.placeholder"},embedCaption:{defaultMessage:"Works with any image from the web.",id:"pageCover.embedType.caption"},embedSubmit:{defaultMessage:"Submit",id:"pageCover.embedType.buttonText"}});function h({environment:e,intl:t,store:o,rect:n,from:d}){r().W(e,{originGap:8,originRect:n,isSmallWidth:!1,popupWidth:540,maxHeight:485,title:t.formatMessage(g.pageCover),onDelete:()=>{!function({environment:e,store:t}){r().I(),l().createAndCommit({userAction:"PageCover.handleDelete",environment:e,canUndo:!0,perform:e=>{s().PT({store:t,transaction:e})}})}({environment:e,store:o})},currentTab:"gallery",tabs:[{type:"gallery",onChange:({url:t,position:n})=>{(0,a().o)(e,{action:"edit_cover",block_type:"page",from:d},(i=>{v({environment:e,store:o,url:{originUrl:t},position:n,callback:i})}))}},{type:"file",fileUpload:!1,imageUpload:!0,videoUpload:!1,caption:t.formatMessage(g.fileTypeCaption,{idealImageWidth:p}),onUpload:n=>{(0,a().o)(e,{action:"edit_cover",block_type:"page",from:d},(s=>{var a;r().I(),c().QM({environment:e,file:n[0],bucket:"secure",record:(null===(a=o.getCoverStore())||void 0===a?void 0:a.pointer)??o.pointer,isFileBlock:!1,reportRichUploadMetrics:!0,onStart:S,onProgress:x,onComplete:t=>{var n;n={environment:e,store:o,url:{originUrl:t},callback:s},f({...n,position:.5})},onError:()=>{i().f1(t.formatMessage(g.uploadFailed))}})}))}},{type:"embed",title:t.formatMessage(g.embedTitle),inputPlaceholder:t.formatMessage(g.embedPlaceholder),caption:t.formatMessage(g.embedCaption),buttonText:t.formatMessage(g.embedSubmit),onChange:t=>{(0,a().o)(e,{action:"edit_cover",block_type:"page",from:d},(n=>{var i;i={environment:e,store:o,url:t,callback:n},f({...i,position:.5}),r().I()}))}},{type:"unsplash",onChange:({url:t,position:n})=>{(0,a().o)(e,{action:"edit_cover",block_type:"page",from:d},(i=>{v({environment:e,store:o,url:{originUrl:t},position:n,callback:i})}))}}]})}async function f(e){const{environment:t,store:o,url:n,position:i,callback:r}=e,{serverCommitResult:a}=l().createAndCommit({userAction:"PageCover.updatePageCover",environment:t,canUndo:!0,perform:e=>{s().fg({store:o,url:n,position:i||.5,transaction:e})}});await a,r(),m().M.state.loadingMode===u().vS&&m().M.setState({loadingMode:u().Gi,dataURL:m().M.state.dataURL,uploadProgress:t.device.isMobileNative?void 0:100,progressText:d().A.formatMessage(g.downloading)})}function v(e){f(e),n().A.isMobile&&r().I()}function S(e){const{file:t,name:o,size:n}=e;if(r().I(),m().M.setState({loadingMode:u().Wc,file:t,name:o,size:n}),t.type.indexOf("image")>=0)if(t instanceof File){const e=new FileReader;e.onload=e=>{var t;const o=(null===(t=e.target)||void 0===t?void 0:t.result)??void 0;o&&"string"!=typeof o||m().M.state.loadingMode!==u().Wc||m().M.setState({...m().M.state,loadingMode:u().vS,uploadProgress:0,dataURL:o})},e.readAsDataURL(t)}else m().M.state.loadingMode===u().Wc&&m().M.setState({...m().M.state,loadingMode:u().vS,dataURL:t.dataURL,progressText:d().A.formatMessage(g.preparing)});else m().M.state.loadingMode===u().Wc&&m().M.setState({...m().M.state,loadingMode:u().vS,progressText:d().A.formatMessage(g.preparing)})}function x(e){const{progressPercent:t,progressText:o}=e;m().M.state.loadingMode===u().vS&&m().M.setState({...m().M.state,uploadProgress:t,progressText:o})}},398217:(e,t,o)=>{o.d(t,{Jv:()=>g,Rl:()=>h,mA:()=>p});var n=o(296540),i=()=>o(726637),s=()=>o(56366),r=()=>o(401497),a=()=>o(898244),l=()=>o(852424),c=()=>o(68465),d=()=>o(159588),u=o(474848);const m=function(){return(0,u.jsx)(o(970236).E,{color:"purple",style:{marginInlineStart:6,padding:"1px 4px",display:"inline-flex",flexDirection:"row",alignItems:"center",gap:4,marginTop:1},content:(0,u.jsx)(o(69708).sA,{defaultMessage:"AI",id:"database.property.aiAutofillEnabledIndicator"})})};const p=n.memo((function(e){const{badge:t,className:n,dragHandleStyle:s,hideName:a,iconSize:l,iconStyle:c,labelSizeVariant:m,propertySchema:p,showDragIcon:g,showIcon:f,style:v,textRef:S}=e,x=(0,r().IS)((t=>({container:{display:"flex",alignItems:"center",lineHeight:"120%",minWidth:0,fontSize:i().A.isMobile?16:14,...v},iconWrapper:{display:"grid",justifyContent:"center",alignItems:"center",position:e.showIntegrationIconOverlay?"relative":void 0,marginInlineEnd:a?void 0:"small"===m||g?4:i().A.isMobile?9:6,...c},dragHandle:{gridColumn:1,gridRow:1,opacity:g?1:0,transition:`opacity ${d().bM}`},itemIcon:{gridColumn:1,gridRow:1,opacity:g?0:1,transition:`opacity ${d().bM}`},dragIcon:{fill:t.icon.secondary},integrationIconOverlay:{position:"absolute",bottom:0,insetInlineStart:8,width:12,height:12,borderRadius:12,background:"transparent",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1}})),[a,c,m,g,v,e.showIntegrationIconOverlay]);return(0,u.jsxs)("div",{className:n,style:x.container,children:[f?(0,u.jsxs)("div",{style:x.iconWrapper,children:[(0,u.jsx)("div",{style:x.itemIcon,children:(0,u.jsx)(h,{propertySchema:p,iconSize:l,iconStyle:c})}),e.showIntegrationIconOverlay?(0,u.jsx)("div",{style:x.integrationIconOverlay,children:e.showIntegrationIconOverlay}):void 0,(0,u.jsx)("div",{style:x.dragHandle,children:(0,u.jsx)(o(57232).A,{style:s,iconSize:12,iconStyle:x.dragIcon})})]}):void 0,a?void 0:(0,u.jsx)("div",{ref:S,style:o(284371).RC,children:p.name}),t]})}));function g(e){const{propertySchema:t}=e;return(0,s().K8)((()=>(0,c().O0)()&&a().$M(t)&&a().om(t)),[t])?(0,u.jsx)(m,{}):null}function h(e){const{propertySchema:t,iconSize:o,iconStyle:n}=e,s=(0,r().DP)(),a=i().A.isMobile?18:16;return(0,u.jsx)(l().zB,{type:t.type,icon:t.icon,size:o||a,theme:s,style:n})}},412532:(e,t,o)=>{o.d(t,{l:()=>i});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"2.03 2.29 11.93 10.46",svg:(0,o(474848).jsx)("path",{d:"M13.165 12.75a.8.8 0 0 0 .69-1.203L8.692 2.693a.8.8 0 0 0-1.382 0l-5.165 8.854a.8.8 0 0 0 .691 1.203z"})},i=(0,o(340498).wt)("arrowCaretUpFillSmall",n)},427636:(e,t,o)=>{o.d(t,{A:()=>i});o(296540);var n=o(474848);const i=function(e){const{botStore:t,avatarSize:i,shouldShowBadge:s,style:r,inline:a}=e,l=(0,o(69708).tz)(),c=(0,o(484714).Y0)(),d=(0,o(56366).K8)((()=>null==t?void 0:t.getDisplayName(l)),[t,l]),{outerStyle:u,avatarWrapStyle:m,badgeStyle:p}=(0,o(401497).IS)((e=>({outerStyle:{display:"flex",alignItems:"center",minWidth:0,...r},avatarWrapStyle:a?{width:"none",minHeight:"none",marginInlineEnd:6}:{marginInlineEnd:6},badgeStyle:{padding:"2px 6px",borderRadius:4,color:e.text.secondary,background:e.legacyDefaultSelectColor,fontSize:o(726637).A.isMobile?11:9,lineHeight:c.isAndroid?1.5:1,textTransform:"uppercase",letterSpacing:"0.04em",marginInlineStart:8,marginTop:1}})),[r,a,c]);return(0,n.jsxs)("div",{style:u,children:[(0,n.jsx)("div",{style:m,children:(0,n.jsx)(o(256863).A,{botStore:t,size:i})}),(0,n.jsx)("div",{style:{...o(284371).RC},children:d}),s?(0,n.jsx)("div",{style:p,children:"Bot"}):void 0]})}},454503:(e,t,o)=>{o.r(t),o.d(t,{arrowUTurnUpLeftIcon:()=>i,iconDefinition:()=>n});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"2.12 3.72 15.76 12.16",directional:!0,svg:(0,o(474848).jsx)("path",{d:"M7.592 4.792a.625.625 0 1 0-.884-.884l-4.4 4.4a.625.625 0 0 0 0 .884l4.4 4.4a.625.625 0 1 0 .884-.884L4.259 9.375H14a2.625 2.625 0 0 1 0 5.25h-1.42a.625.625 0 1 0 0 1.25H14a3.875 3.875 0 0 0 0-7.75H4.259z"})},i=(0,o(340498).wt)("arrowUTurnUpLeft",n)},468882:(e,t,o)=>{o.d(t,{B2:()=>L,F1:()=>w,Kc:()=>k,Lo:()=>x,UY:()=>C,br:()=>j,lA:()=>M,lh:()=>A,pi:()=>S,w_:()=>y,zP:()=>b});o(898992),o(737550);var n=()=>o(584262),i=()=>o(443239),s=()=>o(898244),r=()=>o(713998),a=()=>o(882262),l=()=>o(415566),c=()=>o(177256),d=()=>o(72135),u=()=>o(201980),m=()=>o(496603),p=()=>o(534177),g=()=>o(939768),h=()=>o(720665),f=()=>o(492414),v=()=>o(972435);function S(e){return Boolean(e.state.isOpen&&e.state.collectionsBulkActionsToolbarStore)}function x(e){return void 0!==e&&"checkbox"!==e}function b(e){switch(e){case"form_editor":case"form_viewer":case"table":return"table";case"board":return"board";case"list":return"list";case"gallery":return"gallery";case"feed":return"feed";case"timeline":return"timeline";case"calendar":return"calendar";case"page":return"page_properties";case"compact_page":return"compact_page";case"mini":return"mini_peek";case"property_module":return"property_module";case"relation":case"relation_section":return"relation_section";default:(0,p().HB)(e)}}function y(e){return{backgroundImage:`linear-gradient(\n\t\tto right,\n\t\t${e.darkDividerColor} 0%,\n\t\t${e.darkDividerColor} 100%\n\t)`,backgroundRepeat:"repeat-x",backgroundPosition:"0 100%",backgroundSize:"100% 1px"}}function C(e){const{store:t,property:o,propertySchema:i}=e,s=null==i?void 0:i.type;if("title"===s)return(0,f().Ay)({store:t,fullyQualified:!1,pageVisitSource:n().y8.LinkInPage});{const e=t.getPropertyValue(o);return r().UY(s,e)}}function k(e){let t=(0,u().k4p)(e);if(!t||""===t.trim()||t.trim().includes(" "))return{domain:void 0,restOfUrl:void 0};t=t.trim();let o=g().qg(t),n=o.host;if(o.protocol&&n||(o=g().qg(`http://${t}`),n=o.host),!n)return{domain:void 0,restOfUrl:void 0};n&&(n=n.replace(/^www./i,""));const i=t.toLowerCase().indexOf(n.toLowerCase());if(-1===i)return{domain:void 0,restOfUrl:void 0};n=t.slice(i,i+n.length);return{domain:n,restOfUrl:t.slice(i+n.length)}}function A(e){const{numberValue:t,numberFormat:o,numberShowAs:n}=e;if(!(m().yr(t)||h().pN(t)||"bar"!==(null==n?void 0:n.type)&&"ring"!==(null==n?void 0:n.type))){const e=v().A.getIntl();return"percent"===o?d().ZV(t,"percent",e):`${t} / ${n.maxValue}`}}function w(e){const{property:t,collectionStore:o}=e,n=o.isSyncedCollection();return Boolean(n)&&(0,i().u)(t)}function M(e,t){switch(e){case"side_peek":return{icon:c().A,tooltip:v().A.formatMessage(I.openInSidePeekTooltip),caption:t?"":v().A.formatMessage(I.openAsPageTitle)};case"center_peek":return{icon:l().q,tooltip:v().A.formatMessage(I.openInCenterPeekTooltip),caption:t?"":v().A.formatMessage(I.openAsPageTitle)};case"full_page":return{icon:a().m,tooltip:v().A.formatMessage(I.openAsPageTooltip),caption:t?"":v().A.formatMessage(I.openAsPageTitle)};default:(0,p().HB)(e)}}const I=(0,o(69708).YK)({openAsPageTitle:{defaultMessage:"Open",id:"database.actionButton.openAsPageTitle"},openAsPageTooltip:{defaultMessage:"Open as page",id:"database.actionButton.openAsPageTooltip"},openInCenterPeekTooltip:{defaultMessage:"Open in center peek",id:"database.actionButton.openInCenterPeekTooltip"},openInSidePeekTooltip:{defaultMessage:"Open in side peek",id:"database.actionButton.openInSidePeekTooltip"}});function j(e){const{store:t,additionalStores:o,collectionContextStore:n}=e,i=t.getAssociatedCollectionStore();return!("collectionTypedView"!==(null==n?void 0:n.contextType)||!i)&&o.some((e=>{var t;return(null===(t=e.getAssociatedCollectionStore())||void 0===t?void 0:t.id)!==i.id}))}function L(e){return Boolean(e&&!s().dA.includes(e.type))}},521855:(e,t,o)=>{o.d(t,{B:()=>h});var n=o(296540),i=()=>o(484714),s=()=>o(56366),r=()=>o(541235),a=()=>o(564884);var l=()=>o(73223),c=()=>o(739135);const d=new Map;var u=()=>o(765957),m=()=>o(594607),p=()=>o(953006),g=o(474848);function h({tutorialId:e,tutorialStepId:t,onPrimaryButtonClick:o,displayStore:h,calloutId:f,enableTracking:v=!1,...S}){const x=(0,i().v3)(),b=function(e){const t=!d.get(e),o=(0,n.useRef)(t);return o.current&&d.set(e,!0),(0,n.useEffect)((()=>()=>{o.current&&d.set(e,!1)}),[e]),o.current}(`${e}.${t}`),{currentStep:y,isLoading:C}=(0,s().K8)((()=>{var t;return{isLoading:!(null!==(t=u().default.state.currentUserSettingsStore)&&void 0!==t&&t.getSettings()),currentStep:(0,c().gt)(u().default.state.currentUserSettingsStore,e)}}),[e]);if((0,n.useEffect)((()=>{C||y!==t||!b?null==h||h.setState(!1):null==h||h.setState(!0)}),[C,y,t,b,h]),C||y!==t||!b)return null;const k=r().c$[e],A=k.steps.findIndex((e=>e.id===t)),w=k.steps.length,M=o=>{v&&function(e,t){(0,a().u)({environment:e,event:{eventName:"tutorial_tooltip_action",eventProperties:t}})}(x,{step:A+1,total_steps:w,tutorial_id:e,tutorial_step_id:t,action_type:o})},I=(0,g.jsx)(p().k,{onCloseClick:()=>{l().dismissTutorial(x,e),M("dismiss")},onPrimaryButtonClick:t=>{l().tutorialGoToNextStep(x,e),null==o||o(t),M("next")},onBackButtonClick:()=>{l().tutorialGoToPrevStep(x,e),M("back")},numSteps:w,currStepIndex:A,...S});return f?(0,g.jsx)(m().B,{calloutId:f,shouldShow:!0,children:I}):I}},526278:(e,t,o)=>{o.d(t,{w:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"2.37 3.97 15.26 12.06",directional:!0,svg:(0,o(474848).jsx)("path",{d:"M2.411 9.79a.6.6 0 0 1 .147-.232l5.4-5.4a.625.625 0 1 1 .884.884L4.509 9.375H17a.625.625 0 1 1 0 1.25H4.509l4.333 4.333a.625.625 0 1 1-.884.884l-5.4-5.4a.62.62 0 0 1-.147-.651"})},i=(0,o(340498).wt)("arrowStraightLeft",n)},536612:(e,t,o)=>{o.d(t,{A:()=>i});class n extends(()=>o(959180))().A{}const i=new n},551619:(e,t,o)=>{o.d(t,{Hy:()=>I,NV:()=>w,O9:()=>L,Rg:()=>j,Sm:()=>B,f7:()=>D,n$:()=>R,no:()=>_,sx:()=>M});var n=()=>o(59226),i=()=>o(726637),s=()=>o(402014),r=()=>o(484714),a=()=>o(792485),l=()=>o(56366),c=()=>o(700500),d=()=>o(519831),u=()=>o(620689),m=()=>o(591197),p=()=>o(835066),g=()=>o(964345),h=()=>o(267584),f=()=>o(478726),v=()=>o(747100),S=()=>o(665579),x=()=>o(765957),b=()=>o(375447),y=()=>o(66496),C=()=>o(548821),k=()=>o(712505),A=()=>o(302022);function w(e){(0,s().SQ)({event:e,context:s().y$.EditorMouseDown,callback:()=>{}})}function M(e){(0,s().SQ)({event:e,context:s().y$.Click,callback:()=>{}})}function I(e){return(0,l().K8)((()=>Boolean(A().A.state.pageMap[e.id])||y().A.state.pages.has(e.id)),[e.id])}function j(e,t){const o=(0,r().v3)(),n=(0,a().S)(),i=I(e),s=(0,l().K8)((()=>{var o,n;return t===C().Rr.Frame?Boolean(null===(o=x().default.state.currentLoadingContainerStore)||void 0===o?void 0:o.state.ready):t===C().Rr.PeekView&&k().default.state.open?Boolean(null===(n=k().default.state.loadingContainerStore)||void 0===n?void 0:n.state.ready):t===C().Rr.CollectionPageView||t===C().Rr.CollectionPageViewFullScreen?e.isReady():void 0}),[t,e]),c=D(e);return(0,l().K8)((()=>{if(!s)return!1;const t=o.currentUser.isLoggedIn(),r=n&&n.publicEditModeStore.state;return Boolean(e&&e.isDefined()&&!e.isNonEditableState()&&e.canEdit()&&!e.hasContent()&&t&&(!(null!=r&&r.hasPublicPermission)||"edit"===(null==r?void 0:r.permission))&&!i&&!c)}),[o.currentUser,c,s,n,i,e])}function L(e,t){const o=(0,r().v3)(),s=(0,a().S)(),{isTablet:c}=(0,r().Y0)(),d=(0,n().X)("tablet_refresh_template_pills_gate");return(0,l().K8)((()=>{if(t===C().Rr.SitePreview)return!1;if(i().A.isMobile&&(!c||!d))return!1;if(!o.currentUser.isLoggedIn())return!1;const n=s&&s.publicEditModeStore.state;if(null!=n&&n.hasPublicPermission&&"edit"!==(null==n?void 0:n.permission))return!1;if(e.getContentLength()>1)return!1;if(!e.canEdit()||e.isNonEditableState())return!1;const r=e.getContentStores()[0];if(r&&!r.isEmptyTextBlock())return!1;if(e.getAssociatedCollectionStore())return!1;const a=g().gZ.state,l=g().Di.state;if(a&&e.id===l)return!1;return!((0,f().L5)(t)?m().VY.state:m().u3.state)}),[o,s,e,t,c,d])}function D(e){return(0,l().K8)((()=>{if(e.isCollectionView()){const t=e.getCollectionStoreIfSingleSource();return!!t&&t.isSyncedCollection()}return e.isType(c().xd.externalObjectInstancePage)}),[e])}function B(e){return(0,l().K8)((()=>{if(!(0,h().vL)())return!1;const t=e.getParentStore();if((null==t?void 0:t.table)===d().Vl){return!!t.getFormatStore().getKeyStore("external_collection_type").getValue()}return!1}),[e])}function R(e){const t=(0,r().v3)(),{device:o,WindowSizeStore:n}=t,s=(0,l().K8)((()=>{const e=n.state.height,o=i().A.isMobile&&b().Ay.state.open?e:0;return u().C6(t)+o}),[t,n]);return(0,l().K8)((()=>"home-phone"===e?S().q3:o.isTablet?380:o.isIOS?Math.max(350,s):i().A.isMobile?400:"side-peek"===e||"center-peek"===e?v().ln:"home"===e?S().wH:"30vh"),[o,s,e])}function _(e){const t=(0,r().v3)(),o=(0,l().K8)((()=>(0,p().dC)(t,e)),[t,e]);return(0,l().K8)((()=>o&&!e.isFullWidth()?(0,p().Zy)(t,(0,v().cq)(e),(0,v().RX)(e)):0),[t,o,e])}},563884:(e,t,o)=>{o.d(t,{k:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("calendar",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M3.24902 14.7764H12.6621C14.1455 14.7764 14.918 14.0107 14.918 12.5479V4.22852C14.918 2.76562 14.1455 2 12.6621 2H3.24902C1.77246 2 1 2.75879 1 4.22852V12.5479C1 14.0107 1.77246 14.7764 3.24902 14.7764ZM3.24219 13.416C2.6748 13.416 2.36035 13.1221 2.36035 12.5205V6.23145C2.36035 5.62988 2.6748 5.33594 3.24219 5.33594H12.6689C13.2363 5.33594 13.5508 5.62988 13.5508 6.23145V12.5205C13.5508 13.1221 13.2363 13.416 12.6689 13.416H3.24219ZM6.63965 7.69434H7.04297C7.28906 7.69434 7.37109 7.61914 7.37109 7.37988V6.97656C7.37109 6.73047 7.28906 6.65527 7.04297 6.65527H6.63965C6.39355 6.65527 6.31152 6.73047 6.31152 6.97656V7.37988C6.31152 7.61914 6.39355 7.69434 6.63965 7.69434ZM8.875 7.69434H9.27832C9.51758 7.69434 9.59961 7.61914 9.59961 7.37988V6.97656C9.59961 6.73047 9.51758 6.65527 9.27832 6.65527H8.875C8.62891 6.65527 8.54688 6.73047 8.54688 6.97656V7.37988C8.54688 7.61914 8.62891 7.69434 8.875 7.69434ZM11.1035 7.69434H11.5068C11.7529 7.69434 11.835 7.61914 11.835 7.37988V6.97656C11.835 6.73047 11.7529 6.65527 11.5068 6.65527H11.1035C10.8643 6.65527 10.7822 6.73047 10.7822 6.97656V7.37988C10.7822 7.61914 10.8643 7.69434 11.1035 7.69434ZM4.41113 9.89551H4.80762C5.05371 9.89551 5.13574 9.82031 5.13574 9.57422V9.1709C5.13574 8.93164 5.05371 8.85645 4.80762 8.85645H4.41113C4.16504 8.85645 4.08301 8.93164 4.08301 9.1709V9.57422C4.08301 9.82031 4.16504 9.89551 4.41113 9.89551ZM6.63965 9.89551H7.04297C7.28906 9.89551 7.37109 9.82031 7.37109 9.57422V9.1709C7.37109 8.93164 7.28906 8.85645 7.04297 8.85645H6.63965C6.39355 8.85645 6.31152 8.93164 6.31152 9.1709V9.57422C6.31152 9.82031 6.39355 9.89551 6.63965 9.89551ZM8.875 9.89551H9.27832C9.51758 9.89551 9.59961 9.82031 9.59961 9.57422V9.1709C9.59961 8.93164 9.51758 8.85645 9.27832 8.85645H8.875C8.62891 8.85645 8.54688 8.93164 8.54688 9.1709V9.57422C8.54688 9.82031 8.62891 9.89551 8.875 9.89551ZM11.1035 9.89551H11.5068C11.7529 9.89551 11.835 9.82031 11.835 9.57422V9.1709C11.835 8.93164 11.7529 8.85645 11.5068 8.85645H11.1035C10.8643 8.85645 10.7822 8.93164 10.7822 9.1709V9.57422C10.7822 9.82031 10.8643 9.89551 11.1035 9.89551ZM4.41113 12.0898H4.80762C5.05371 12.0898 5.13574 12.0146 5.13574 11.7754V11.3721C5.13574 11.126 5.05371 11.0508 4.80762 11.0508H4.41113C4.16504 11.0508 4.08301 11.126 4.08301 11.3721V11.7754C4.08301 12.0146 4.16504 12.0898 4.41113 12.0898ZM6.63965 12.0898H7.04297C7.28906 12.0898 7.37109 12.0146 7.37109 11.7754V11.3721C7.37109 11.126 7.28906 11.0508 7.04297 11.0508H6.63965C6.39355 11.0508 6.31152 11.126 6.31152 11.3721V11.7754C6.31152 12.0146 6.39355 12.0898 6.63965 12.0898ZM8.875 12.0898H9.27832C9.51758 12.0898 9.59961 12.0146 9.59961 11.7754V11.3721C9.59961 11.126 9.51758 11.0508 9.27832 11.0508H8.875C8.62891 11.0508 8.54688 11.126 8.54688 11.3721V11.7754C8.54688 12.0146 8.62891 12.0898 8.875 12.0898Z"})})},568365:(e,t,o)=>{o.d(t,{M:()=>n});const n=new(o(867772).Ay)},591197:(e,t,o)=>{o.d(t,{VY:()=>a,ZJ:()=>s,u3:()=>r});var n=()=>o(496506);class i extends(()=>o(757695))().Store{getInitialState(){return{popupRenderedInPage:!1,popupRenderedInPeekView:!1}}}const s=new i,r=new(n().ComputedStore)((()=>!1!==s.state.popupRenderedInPage),{debugName:"AssistantWriterRenderedInPageStore"}),a=new(n().ComputedStore)((()=>!1!==s.state.popupRenderedInPeekView),{debugName:"AssistantWriterRenderedInPeekViewStore"})},608581:(e,t,o)=>{o.d(t,{A:()=>u});o(898992),o(354520),o(581454),o(941795);var n=o(296540),i=()=>o(726637),s=()=>o(401497),r=()=>o(451306),a=()=>o(284371),l=()=>o(963575),c=o(474848);function d(e){const{button:t,isLast:o}=e,i=(0,s().IS)((e=>({button:{display:"flex",alignItems:"center",padding:"4px 6px",fontWeight:a().Wy.medium,borderInlineEnd:`1px solid ${e.regularDividerColor}`,color:e.text.secondary,fill:e.text.secondary},buttonLast:{borderInlineEnd:"none"},buttonHovered:{background:e.whiteButtonHoveredBackground},buttonPressed:{background:e.whiteButtonPressedBackground}})),[]);return n.cloneElement(t,{...(0,r().AH)(t.props.style,i.button,o&&i.buttonLast),hoveredStyle:(0,r().AH)(i.buttonHovered,o&&i.buttonLast).style,pressedStyle:i.buttonPressed})}const u=function({children:e,isVisible:t,position:u,style:m}){const p=(0,s().IS)((e=>({container:{color:e.text.secondary,fill:e.text.secondary,fontSize:12,background:e.whiteButtonBackground,boxShadow:e.shadowSM,display:"flex",whiteSpace:"nowrap",borderRadius:l().A.borderRadius,maxWidth:"calc(100% - 16px)",minHeight:24,overflow:"hidden",pointerEvents:i().A.isMobile?"auto":"none",opacity:i().A.isMobile?1:0,fontFamily:a().vc(o(662303).locale).sans,position:"absolute",insetInlineEnd:l().A.horizontal.small,bottom:l().A.vertical.small,zIndex:2},containerHover:{pointerEvents:"auto",opacity:1},containerTop:{top:l().A.vertical.small,bottom:void 0}})),[]),g=n.Children.toArray(e).filter(o(534177).O9),h=g.length;return(0,c.jsx)(o(145214).A,{animate:{opacity:t?1:0},...(0,r().AH)(p.container,m,t&&p.containerHover,"top"===u&&p.containerTop),children:g.map(((e,t)=>{const i=t===h-1;if(e&&"object"==typeof e&&"type"in e){if(e.type===o(859428).A&&n.isValidElement(e))return n.cloneElement(e,{render:(t,o)=>{const n=e.props.render(t,o);return(0,c.jsx)(d,{isLast:i,button:n},e.key)}});if(e.type===o(718827).Ay&&n.isValidElement(e))return(0,c.jsx)(d,{isLast:i,button:e},e.key)}}))})}},658985:(e,t,o)=>{o.d(t,{$:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("membersFilled",{viewBox:"0 0 30 30",svg:(0,n.jsx)("path",{d:"M20.31 14.731c2.22 0 4.097-1.967 4.097-4.513 0-2.485-1.887-4.391-4.098-4.391-2.2 0-4.097 1.937-4.087 4.411 0 2.526 1.866 4.493 4.087 4.493zm-11.725.233c1.937 0 3.57-1.724 3.57-3.935 0-2.17-1.653-3.823-3.57-3.823-1.917 0-3.57 1.683-3.56 3.844 0 2.19 1.633 3.914 3.56 3.914zm-5.588 9.21h7.606c-1.085-1.552.082-4.615 2.374-6.42-1.116-.72-2.566-1.248-4.392-1.248-4.533 0-7.464 3.337-7.464 6.085 0 1.004.507 1.582 1.876 1.582zm10.994-.01h12.637c1.673 0 2.251-.508 2.251-1.44 0-2.607-3.316-6.198-8.57-6.198-5.263 0-8.57 3.59-8.57 6.197 0 .933.578 1.44 2.252 1.44z"})})},665579:(e,t,o)=>{o.d(t,{$L:()=>l,BZ:()=>u,EC:()=>h,EI:()=>y,E_:()=>I,Ed:()=>p,Fq:()=>S,Lu:()=>k,Mk:()=>g,O0:()=>M,V$:()=>w,VQ:()=>f,Xx:()=>C,Xy:()=>d,YS:()=>v,_g:()=>b,dd:()=>m,pW:()=>c,q3:()=>a,wH:()=>r,xK:()=>j});var n=()=>o(484714),i=()=>o(401497),s=()=>o(496603);const r=160,a=40,l=40,c=20,d=600,u=270,m=405,p=480,g=500,h=void 0,f=16,v=10,S=8,x={backdropFilter:"blur(48px)",WebkitBackdropFilter:"blur(48px)"},b=4;function y(e){return{icon:e.icon.secondary,text:e.text.secondary}}function C(e){return{width:48,height:48,fill:e.icon.tertiary}}function k({theme:e,isPhone:t}){return t?e.personalHomeBackgroundPhone:e.background.primary}const A=1;function w({isPhone:e,theme:t}){return{zIndex:1,position:"relative",display:"flex",flexDirection:"column",borderRadius:12,background:t.home.tile.background,boxShadow:I({isPhone:e,theme:t}),...x}}function M({mode:e}){switch(e){case"dark":default:return 0;case"light":return A}}function I({isPhone:e,theme:t,borderOnly:o}){if("dark"===t.mode)return"unset";t.mode;const n=M({mode:t.mode});return(0,s().oE)([o||e?void 0:"0 12px 32px rgba(0, 0, 0, 0.02)",`0 0 0 ${n}px rgba(0, 0, 0, 0.05)`]).join(", ")}function j(e){const{borderOnly:t}=e,o=(0,n().WS)(),s=(0,i().DP)();return{unhoveredBoxShadow:I({isPhone:o,theme:s,borderOnly:t}),hoveredBoxShadow:"light"===s.mode?["0 12px 32px rgba(0, 0, 0, 0.03)","0 0 0 1px rgba(0, 0, 0, 0.085)"].join(", "):s.homeShadow.card.hovered}}},691298:(e,t,o)=>{o.d(t,{A:()=>r});var n=o(296540),i=()=>o(502438),s=()=>o(693202);const r=function({shouldPreserveTextSelection:e,shouldPreserveBlockSelection:t,shouldRestoreSelection:r,onClearSelection:a}){const l=(0,o(484714).v3)(),c=(0,n.useRef)(e),d=(0,n.useRef)(""),u=(0,n.useRef)({selectionState:null,textSelectionState:null}),m=(0,n.useCallback)((()=>u.current),[]),p=(0,n.useCallback)((()=>{d.current=window.location.href,s().default.hasSelection()&&(u.current.textSelectionState=s().default.cloneState()),(0,o(749804).I)({environment:l}),t&&(i().default.isSelected()&&(u.current.selectionState=i().default.cloneState()),o(778417).IU({environment:l}))}),[l,t]),g=(0,n.useCallback)((()=>{u.current={selectionState:null,textSelectionState:null},d.current="",null==a||a()}),[a]),h=(0,n.useCallback)((()=>{const{selectionState:e,textSelectionState:o}=u.current;window.location.href===d.current&&(o&&"mode"in o&&"editing"===o.mode&&s().default.setState({...s().default.state,...o}),t&&e&&i().default.setState({...i().default.state,...e})),g()}),[g,t]);return(0,o(852507).l)((()=>{c.current=e,e&&p()})),(0,n.useEffect)((()=>(c.current&&!e?r?h():g():!c.current&&e&&p(),c.current=e,()=>{r?h():g()})),[e,g,h,p,r]),{clearSavedSelection:g,restoreSavedSelection:h,getSavedSelection:m}}},702340:(e,t,o)=>{o.r(t),o.d(t,{Comment:()=>nt,CommentFileBlock:()=>To().A,Discussion:()=>Pt,DiscussionIndicator:()=>Et().Ay,DiscussionInput:()=>ot().A,DiscussionReactionBar:()=>Me().tx,MOBILE_REACTION_PILL_STYLE_OVERRIDES:()=>Me().ZR,MarginCommentsSection:()=>So,NewDiscussionMenu:()=>jo,PropertyDiscussionIndicator:()=>Nt,REACTION_PILL_STYLE:()=>Me().Of,ReactionBar:()=>Me().Ay,ReplyDiscussionMenu:()=>Ro,SuggestionContext:()=>Rt,UnreadDiscussionsPopup:()=>Po().$w,discussionHelpers:()=>F(),discussionViewActions:()=>n,handleDismissNewDiscussion:()=>Mo().HR,reactionActions:()=>Eo()});var n={};o.r(n),o.d(n,{isCommentUnread:()=>ut});o(898992),o(354520);var i=o(296540),s=()=>o(726637),r=()=>o(908006),a=()=>o(484714),l=()=>o(792485),c=()=>o(790748),d=()=>o(56366),u=()=>o(401497),m=()=>o(252291),p=()=>o(98126),g=()=>o(68263),h=()=>o(201980),f=()=>o(69708),v=()=>o(284371),S=()=>o(182641),x=()=>o(901389),b=()=>o(620689),y=()=>o(190033),C=()=>o(231297),k=()=>o(61548),A=()=>o(719147),w=()=>o(447587),M=()=>o(709438),I=()=>o(299545),j=()=>o(252833),L=()=>o(424746),D=()=>o(448291),B=()=>o(372154),R=()=>o(463830),_=()=>o(230062),T=()=>o(285068),P=()=>o(789557),E=()=>o(5774),U=()=>o(848565),F=()=>o(473975);function z(e){return e.isFirstComment&&"comment_unfurl"!==e.discussionLocation&&"feed_item_top_level_discussion"!==e.discussionLocation}var K=()=>o(143943),H=()=>o(404783),V=()=>o(555776),W=(o(944114),()=>o(584262)),N=()=>o(700500),O=()=>o(488715),$=()=>o(203901),J=()=>o(526278),Y=()=>o(29037),G=()=>o(589407),Z=()=>o(546703),Q=()=>o(742852),q=()=>o(895189),X=()=>o(863522),ee=()=>o(105819),te=()=>o(236262),oe=()=>o(599813),ne=()=>o(798880),ie=()=>o(496603),se=()=>o(534177),re=()=>o(878523),ae=()=>o(884107),le=()=>o(53436),ce=()=>o(326496),de=()=>o(145214),ue=()=>o(760217),me=()=>o(406699),pe=()=>o(404277),ge=()=>o(939740),he=()=>o(89924),fe=()=>o(38337),ve=()=>o(722872),Se=()=>o(895093),xe=()=>o(249847),be=()=>o(479490),ye=()=>o(765957),Ce=()=>o(725332),ke=()=>o(672262);var Ae=()=>o(249349),we=()=>o(516430),Me=()=>o(138873),Ie=o(474848);const je=(0,f().YK)({actionBar:{id:"comment.actions.bar.label",defaultMessage:"Comment actions"},addReaction:{id:"comment.actions.addReaction.label",defaultMessage:"Add reaction"},acceptButton:{id:"comment.actions.acceptButton.label",defaultMessage:"Accept"},rejectButton:{id:"comment.actions.rejectButton.label",defaultMessage:"Reject"},moreActions:{id:"comment.actions.moreActions.label",defaultMessage:"More actions"},reopenButton:{id:"comment.actions.reopenButton.label",defaultMessage:"Re-open"},resolveButton:{id:"comment.actions.resolveButton.label",defaultMessage:"Resolve"},markUnreadButton:{id:"comment.actions.markAsUnread.label",defaultMessage:"Mark as unread"},markReadButton:{id:"comment.actions.markAsRead.label",defaultMessage:"Mark as read"},mobileCommentMenuTitle:{id:"comment.mobileCommentMenu.title",defaultMessage:"Comment"},reopenDiscussionButton:{id:"comment.reopenDiscussion.button",defaultMessage:"Re-open discussion"},resolveDiscussionButton:{id:"comment.resolveDiscussion.button",defaultMessage:"Resolve comments"},editComment:{id:"comment.editCommentNoDescriptor.button",defaultMessage:"Edit"},deleteComment:{id:"comment.deleteCommentNoDescriptor.button",defaultMessage:"Delete"},copyLinkToDiscussion:{id:"comment.copyLinkToDiscussionNoDescriptor.button",defaultMessage:"Copy link"}});function Le(e){const{discussionLocation:t,isFirstComment:o,blockStore:n,discussionStore:r,showMarkAsRead:c}=e,u=(0,f().tz)(),p=(0,a().v3)(),h=(0,i.useRef)(null),v=(0,l().S)(),x=(0,d().K8)((()=>Boolean(r.getResolved())),[r]),b=(0,d().K8)((()=>e.store.isDefined()),[e.store]),y=(0,xe().T)(),k=(0,d().K8)((()=>{const t=e.store.getCreatedById();return e.store.getCreatedByTable()===ne().oo&&y===t}),[y,e.store]),A=(0,d().K8)((()=>{var e;const t=null===(e=ye().default.state.sidebarSpaceStore)||void 0===e?void 0:e.getRole();return t&&g().Km(t)}),[]),w=(0,d().K8)((()=>n.getRole()),[n]),M=(0,d().K8)((()=>{var e;return null==v||null===(e=v.publicEditModeStore.state)||void 0===e?void 0:e.permission}),[null==v?void 0:v.publicEditModeStore]),{isFirstCommentOfSuggestionDiscussion:I,disableAccept:j}=(0,d().K8)((()=>{var t;const o="suggestion"===r.getType()&&r.getCommentPointers()[0].id===e.store.id,i=(null===(t=n.getNavigableBlockStore())||void 0===t?void 0:t.canEdit())??!1;return{isFirstCommentOfSuggestionDiscussion:o,disableAccept:o&&!i}}),[r,n,e.store]),L=(0,d().K8)((()=>n.pathIsDead()),[n]),D=(0,d().K8)((()=>z({isFirstComment:o,discussionLocation:t})),[o,t]),B=(0,be().A)("(prefers-reduced-motion: reduce)"),R="comment_only"===w||"comment"===M,_=(0,i.useCallback)((()=>{C().createAndCommit({userAction:"Comment.markDiscussionRead",environment:p,canUndo:!0,perform:e=>(0,Ce().U)({transaction:e,discussionStore:r})}),re().Ry(p,{discussion_id:r.id,discussion_type:r.getType(),from:t,method:"action_group",parent_block_id:r.getParentId(),...re().A2({store:e.store,discussionStore:r,blockStore:n})})}),[p,r,t,e.store,n]),T=(0,i.useCallback)((()=>{C().createAndCommit({userAction:"Comment.markDiscussionUnread",environment:p,canUndo:!0,perform:e=>function(e){const{transaction:t,discussionStore:o}=e,n=o.userId;if(!n)return;const i=o.getUserSeenRecordStore(n);return C().applyOperation({store:i,operation:{pointer:i.pointer,path:[],command:"update",args:{user_id:n,space_id:i.pointer.spaceId,parent_id:o.id,parent_table:o.table,last_seen_at:ke().Xq}},transaction:t}),o}({transaction:e,discussionStore:r})}),B||S().F2(r.id),re().i3(p,{discussion_id:r.id,method:"action_group",discussion_type:r.getType(),from:t,parent_block_id:r.getParentId(),...re().A2({store:e.store,discussionStore:r,blockStore:n})})}),[p,B,r,e.store,n,t]);if(!b||!y)return null;const E=()=>{C().createAndCommit({userAction:"Comment.handleReopen",environment:p,canUndo:!0,perform:t=>{P().E3({environment:p,commentStore:e.store,discussionStore:r,transaction:t,discussionLocation:e.discussionLocation})}})},U=t=>{C().createAndCommit({userAction:"Comment.handleResolve",environment:p,canUndo:!0,perform:t=>{(0,Ae().j)({environment:p,commentStore:e.store,discussionStore:r,transaction:t,discussionLocation:e.discussionLocation})}}),S().UP(),null==t||t.stopPropagation()},F=async()=>{var o,n;const i=e.store.getParentStore();if(!i||null==i||!i.isDefined())return null;let r=i.getParentStore();if(null===(o=r)||void 0===o||!o.isDefined())return null;var a;r.getType()===N().xd.tableRow&&(r=null===(a=r)||void 0===a?void 0:a.getParentBlockStore());if(null===(n=r)||void 0===n||!n.isDefined())return null;const l=(0,O().Q)({model:r.getModel(),baseUrl:s().A.domainBaseUrl,getRecordModel:e.store.getRecordModel,discussionId:i.id,pageVisitSource:W().y8.CopyLink});re().tG(p,{discussion_id:i.id,discussion_type:i.getType(),from:t,parent_block_id:i.getParentId(),...re().A2({store:e.store,discussionStore:i,blockStore:r})});const c=await ae().R.clipboardActions.load();c.copyString({environment:p,stringValue:l,copiedMessage:c.clipboardMessages.copiedLinkToClipboard})};if(!p.currentUser.isLoggedIn())return null;const K=w&&g().h9(w)||L;if(K)return null;const H=D&&!s().A.isMobile&&!R&&!K,V=[];s().A.isMobile&&!R&&!K&&e.isFirstComment&&(x?V.push("reopen"):V.push("resolve")),o&&!x&&(c?V.push("markDiscussionRead"):V.push("markDiscussionUnread")),!I&&k&&V.push("edit"),o&&V.push("copyLink"),I||!k&&!A||V.push("delete");const $=V.length>0;return $||H||e.canShowReactions?(0,Ie.jsx)(me().A,{ref:h,popupType:s().A.isMobile?me().z.BottomSheet:me().z.Popup,bottomSheetInitialState:"half",buttonPopupStore:e.buttonPopupStore,placementToOrigin:"bottom",alignmentToOrigin:"end",stopClickPropagation:!0,suppressOriginContext:!0,renderOrigin:t=>(0,Ie.jsxs)(De,{visible:e.visible,location:e.discussionLocation,children:[!I||j||x?void 0:(0,Ie.jsx)(Be,{store:e.store,discussionStore:e.discussionStore,location:e.discussionLocation}),!I||x||R&&!k?void 0:(0,Ie.jsx)(Re,{store:e.store,discussionStore:e.discussionStore,location:e.discussionLocation}),e.canShowReactions?(0,Ie.jsx)(_e,{store:e.store,location:e.discussionLocation,onReact:e.handleReaction}):void 0,H&&!I?(0,Ie.jsx)(Te,{resolved:x,onResolve:U,onReopen:E}):void 0,$?(0,Ie.jsx)(ce().e,{...t,"aria-label":u.formatMessage(je.moreActions),tooltip:u.formatMessage(je.moreActions),iconLeading:G().ellipsisIcon}):void 0]}),render:t=>{let o;o=s().A.isMobile?{menuType:ve().gu.Modal,title:(0,Ie.jsx)(f().sA,{...je.mobileCommentMenuTitle})}:{menuType:ve().gu.Popup};const n=V.map((t=>"reopen"===t?{key:"reopen",render:e=>(0,Ie.jsx)(ue().A,{...e,icon:(0,Ie.jsx)(m().I,{icon:J().w}),title:(0,Ie.jsx)(f().sA,{...je.reopenDiscussionButton})}),action:E}:"resolve"===t?{key:"resolve",render:e=>(0,Ie.jsx)(ue().A,{...e,icon:(0,Ie.jsx)(m().I,{icon:Y().checkmarkIcon}),title:(0,Ie.jsx)(f().sA,{...je.resolveDiscussionButton})}),action:()=>U()}:"edit"===t?{key:"edit",render:e=>(0,Ie.jsx)(ue().A,{...e,icon:(0,Ie.jsx)(m().I,{icon:ee().pencilLineIcon}),title:(0,Ie.jsx)(f().sA,{...je.editComment})}),action:e.handleEditComment}:"delete"===t?{key:"delete",render:e=>(0,Ie.jsx)(ue().A,{...e,icon:(0,Ie.jsx)(m().I,{icon:te().trashIcon}),title:(0,Ie.jsx)(f().sA,{...je.deleteComment})}),action:e.handleDeleteComment}:"copyLink"===t?{key:"copyLink",render:e=>(0,Ie.jsx)(ue().A,{...e,icon:(0,Ie.jsx)(m().I,{icon:Q().linkIcon}),title:(0,Ie.jsx)(f().sA,{...je.copyLinkToDiscussion})}),action:F}:"markDiscussionRead"===t?{key:"markDiscussionRead",render:e=>(0,Ie.jsx)(ue().A,{...e,icon:(0,Ie.jsx)(m().I,{icon:q().d}),title:(0,Ie.jsx)(f().sA,{...je.markReadButton})}),action:_}:"markDiscussionUnread"===t?{key:"markDiscussionUnread",render:e=>(0,Ie.jsx)(ue().A,{...e,icon:(0,Ie.jsx)(m().I,{icon:X().C}),title:(0,Ie.jsx)(f().sA,{...je.markUnreadButton})}),action:T}:void(0,se().HB)(t)));return(0,Ie.jsx)("div",{className:fe().Jb,children:(0,Ie.jsx)(pe().A,{...o,children:(0,Ie.jsx)(ge().Ay,{type:ge().Oh.Vertical,initialFocus:void 0,onAccept:t.close,sections:ie().oE([n.length&&{key:0,render:e=>(0,Ie.jsx)(he().A,{...e}),items:n}])})})})}}):null}function De(e){const{children:t,visible:o,location:n}=e,i=(0,f().tz)(),r=(0,u().IS)((()=>({wrapper:{position:"absolute",insetInlineEnd:0,pointerEvents:o?"auto":"none",zIndex:1,...s().A.isMobile?{top:-3}:{marginTop:"updates_sidebar"===n?6:0,top:-4}}})),[o,n]);return(0,Ie.jsx)(de().A,{skip:s().A.isMobile,visible:o||s().A.isMobile,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:r.wrapper,children:(0,Ie.jsx)(le().E,{"aria-label":i.formatMessage(je.actionBar),size:"lg",children:t})})}function Be(e){const{store:t,discussionStore:o,location:n}=e,s=(0,a().v3)(),r=(0,f().tz)(),l=(0,i.useCallback)((()=>{C().createAndCommit({userAction:"Suggestion.handleAccept",environment:s,canUndo:!0,perform:e=>{we()._3({action:"accept",environment:s,commentStore:t,discussionStore:o,transaction:e,discussionLocation:n,currentPageStore:(0,Se().f)(o)})}}),S().UP()}),[s,t,o,n]);return(0,Ie.jsx)(ce().e,{"aria-label":r.formatMessage(je.acceptButton),tooltip:r.formatMessage(je.acceptButton),onClick:l,iconLeading:Y().checkmarkIcon})}function Re(e){const{store:t,discussionStore:o,location:n}=e,s=(0,a().v3)(),r=(0,f().tz)(),l=(0,i.useCallback)((()=>{C().createAndCommit({userAction:"Suggestion.handleReject",environment:s,canUndo:!0,perform:e=>{we()._3({action:"reject",environment:s,commentStore:t,discussionStore:o,transaction:e,discussionLocation:n,currentPageStore:(0,Se().f)(o)})}}),S().UP()}),[s,t,o,n]);return(0,Ie.jsx)(ce().e,{"aria-label":r.formatMessage(je.rejectButton),tooltip:r.formatMessage(je.rejectButton),onClick:l,iconLeading:oe().xMarkIcon})}function _e(e){const{store:t,location:o,onReact:n}=e,s=(0,i.useRef)(null),r=(0,a().v3)(),l=(0,f().tz)(),c=(0,i.useCallback)((()=>{(0,Me().uJ)(r,l,t,s.current,o,n)}),[r,l,t,s,o,n]);return(0,Ie.jsx)(ce().e,{ref:s,"aria-label":l.formatMessage(je.addReaction),tooltip:l.formatMessage(je.addReaction),onClick:c,iconLeading:Z().r})}function Te(e){const{resolved:t,onResolve:o,onReopen:n}=e,s=(0,i.useRef)(null),r=(0,f().tz)(),a=t?je.reopenButton:je.resolveButton;return(0,Ie.jsx)(ce().e,{ref:s,"aria-label":r.formatMessage(a),tooltip:r.formatMessage(a),onClick:t?n:o,iconLeading:t?$().F:Y().checkmarkIcon})}o(581454);var Pe=()=>o(675074),Ee=()=>o(483545),Ue=()=>o(518888),Fe=()=>o(489436),ze=()=>o(973753);const Ke=3;function He({stores:e,collapsed:t,shouldShowGrayFogInScroller:o,onRemoveBlockFromComment:n}){return 0===e.length?null:e.length<=Ke?(0,Ie.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:e.map((e=>(0,Ie.jsx)(Fe().A,{store:e,disabled:!1,commentProps:{shouldHideBlockActionMenu:t,onRemoveBlockFromComment:n}},e.id)))}):(0,Ie.jsx)(ze().A,{shouldShowGrayFog:o,children:e.map((e=>(0,Ie.jsx)(Fe().A,{store:e,disabled:!1,commentProps:{shouldHideBlockActionMenu:t,onRemoveBlockFromComment:n}},e.id)))})}var Ve=()=>o(718827),We=()=>o(391214);const Ne=3,Oe=4;function $e({stores:e,embedBlockLocation:t,onRemoveContent:o}){const n=(0,a().v3)();if(0===e.length)return null;if(e.length<=Ne)return(0,Ie.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:e.map((e=>(0,Ie.jsx)(Je,{store:e,embedBlockLocation:t,onRemoveContent:o,isLarge:!0},e.id)))});if(e.length<=Oe)return(0,Ie.jsx)("div",{style:{display:"flex",gap:4},children:e.map((e=>(0,Ie.jsx)(Je,{store:e,embedBlockLocation:t,onRemoveContent:o,isLarge:!1},e.id)))});const i=e.slice(0,Oe-1),s=e[Oe-1],r=e.length-Oe+1,l=e.slice(Oe);return(0,Ie.jsxs)("div",{style:{display:"flex",gap:4},children:[i.map((e=>(0,Ie.jsx)(Je,{store:e,embedBlockLocation:t,onRemoveContent:o,isLarge:!1},e.id))),(0,Ie.jsxs)("div",{children:[(0,Ie.jsx)(Ve().Ay,{style:{position:"absolute",zIndex:1,width:48,height:48,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0, 0, 0, 0.4)",borderRadius:8,color:"white",fontWeight:v().Wy.bold},hoveredStyle:{background:"rgba(0, 0, 0, 0.4)"},pressedStyle:{background:"rgba(0, 0, 0, 0.4)"},onClick:()=>{We().iy({environment:n,blockStore:s})},children:`+${r}`}),(0,Ie.jsx)(Je,{store:s,embedBlockLocation:t,onRemoveContent:o,isLarge:!1},s.id)]}),(0,Ie.jsx)("div",{style:{display:"none"},children:l.map((e=>(0,Ie.jsx)(Je,{store:e,embedBlockLocation:t,onRemoveContent:o,isLarge:!1},e.id)))})]})}function Je({store:e,isLarge:t,embedBlockLocation:o,onRemoveContent:n}){const i=(0,u().IS)((e=>({imageShared:{border:`1px solid ${e.border.secondary}`,borderRadius:8,cursor:"zoom-in"}})),[]);return(0,Ie.jsx)(Ee().Ay,{store:e,blockLocation:o,disabled:!1,disableDrag:!0,disableResizers:!0,preserveScale:!0,inlineContentStyle:{...i.imageShared,...t?Ye:Ge},disableActions:!t,onRemoveBlockFromComment:t?n:void 0},e.id)}const Ye={objectFit:"contain",width:"auto",height:"auto",maxWidth:240,maxHeight:240,minWidth:48,minHeight:48},Ge={width:48,height:48,minWidth:48,minHeight:48};var Ze=()=>o(773382);function Qe({store:e}){const t=(0,d().K8)((()=>Ue().default.getKeyState(Ue().default.getBlockKey(e.id))),[e.id]),o=(0,f().tz)(),n=(0,u().IS)((e=>({wrapper:{height:48,width:214,display:"flex",alignItems:"center",background:"white",border:`1px solid ${e.regularDividerColor}`,borderRadius:12,paddingTop:8,paddingInlineEnd:10,paddingBottom:8,paddingInlineStart:8,gap:8},icon:{background:e.background.tertiaryTranslucent,borderRadius:6,width:32,minWidth:32,height:32,display:"flex",alignItems:"center",justifyContent:"center"},fileDetails:{display:"flex",flexDirection:"column"},fileName:{fontSize:14,fontWeight:v().Wy.medium,lineHeight:"18px",color:e.text.primary,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},fileSizeText:{color:e.text.secondary},progressText:{color:e.text.tertiary},sizeAndProgressContainer:{display:"flex",alignItems:"center",gap:4,fontSize:12,lineHeight:"15px"}})),[]);if(!t)return(0,Ie.jsxs)("div",{style:n.wrapper,children:[(0,Ie.jsx)("div",{style:n.icon,children:(0,Ie.jsx)(p().k,{})}),(0,Ie.jsx)("div",{style:n.fileDetails,children:(0,Ie.jsx)("div",{style:n.fileName,children:o.formatMessage({id:"commentFilePlaceholder.loading",defaultMessage:"Loading..."})})})]});const{name:i,size:s,progressPercent:r,progressText:a}=t;return(0,Ie.jsxs)("div",{style:n.wrapper,children:[(0,Ie.jsx)("div",{style:n.icon,children:(0,Ie.jsx)(p().k,{})}),(0,Ie.jsx)("div",{style:{overflow:"hidden"},children:(0,Ie.jsxs)("div",{style:n.fileDetails,children:[(0,Ie.jsx)("div",{style:n.fileName,children:i}),(0,Ie.jsxs)("div",{style:n.sizeAndProgressContainer,children:[(0,Ie.jsx)("span",{style:n.fileSizeText,children:(0,F().formatFileSize)(s)}),(0,Ie.jsx)("span",{style:n.progressText,children:"â€”"}),(0,Ie.jsx)(p().k,{}),r?(0,Ie.jsx)(Ze().A,{percentage:r,style:n.progressText}):a?(0,Ie.jsx)("span",{children:a}):null]})]})})]})}function qe({stores:e}){return 0===e.length?null:(0,Ie.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:e.map((e=>(0,Ie.jsx)(Qe,{store:e},e.id)))})}function Xe(e){const t=e.discussionFormat===F().DiscussionFormat.Sidebar?Pe().ZO.SidebarComment:Pe().ZO.PageComment,{uploading:o,images:n,embeds:i,files:s}=(0,d().K8)((()=>{const[t,o]=ie().jB(e.contentStores,(e=>{const t=Boolean(Ue().default.getKeyState(Ue().default.getBlockKey(e.id))),o=(0,Ee().getEmbedSourceFromBlockStore)(e);return t||!o})),[n,i]=ie().jB(o,(e=>e.getType()===N().xd.image)),[s,r]=ie().jB(i,(e=>"video"===e.getType()));return{uploading:t,images:n,embeds:s,files:r}}),[e.contentStores]);return 0===o.length&&0===n.length&&0===i.length&&0===s.length?null:(0,Ie.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:4,marginTop:8},children:[(0,Ie.jsx)(qe,{stores:o}),(0,Ie.jsx)($e,{stores:n,embedBlockLocation:t,onRemoveContent:e.onRemoveContent}),i.length>0?(0,Ie.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:i.map((o=>(0,Ie.jsx)(Ee().Ay,{store:o,blockLocation:t,disabled:!1,disableDrag:!0,disableResizers:!0,preserveScale:!0,inlineContentStyle:{},onRemoveBlockFromComment:e.onRemoveContent},o.id)))}):void 0,(0,Ie.jsx)(He,{stores:s,collapsed:e.collapsed,shouldShowGrayFogInScroller:e.discussionHovered&&(e.discussionFormat===F().DiscussionFormat.Margin||e.discussionFormat===F().DiscussionFormat.Sidebar),onRemoveBlockFromComment:e.onRemoveContent})]})}var et=()=>o(147294);function tt(){const e=(0,u().IS)((e=>({container:{position:"relative"},newBarLineWrapper:{width:"100%"},newBarLine:{borderRadius:2,height:U().jw,background:e.blue.background.secondary,width:"100%",margin:"auto 0px"},newBarWrapper:{color:e.text.secondary,fontSize:10,fontWeight:v().Wy.regular,display:"flex",alignItems:"center",marginTop:0,marginBottom:12,paddingInlineStart:0},threadLine:{position:"absolute",backgroundColor:e.border.secondary,width:U().jw,height:8,borderRadius:2,insetInlineStart:U().im,bottom:-6,zIndex:-1}})),[]);return(0,Ie.jsxs)("div",{style:e.container,children:[(0,Ie.jsxs)("div",{style:e.newBarWrapper,children:[(0,Ie.jsx)("div",{style:e.newBarLineWrapper,children:(0,Ie.jsx)("div",{style:e.newBarLine})}),(0,Ie.jsx)(et().J1,{style:{marginInlineStart:12,marginInlineEnd:12}}),(0,Ie.jsx)("div",{style:e.newBarLineWrapper,children:(0,Ie.jsx)("div",{style:e.newBarLine})})]}),(0,Ie.jsx)("div",{style:e.threadLine})]})}var ot=()=>o(640753);const nt=function(e){const{store:t,discussionContext:n,discussionLocation:W,shouldShowThreadLine:N,discussionStore:O,blockStore:$,collapsed:J,showMarkAsRead:Y}=e,G=(0,a().v3)(),[Z,Q]=(0,i.useState)(!1),[q,X]=(0,i.useState)(!1),[ee,te]=(0,i.useState)(!1),[oe,ne]=(0,i.useState)(!1),[ie,se]=(0,i.useState)("feed_item_top_level_discussion"===W&&J),re=(0,d().K8)((()=>e.store.isDefined()?new(H().A)(G,e.store.getSpaceId()):void 0),[G,e.store]),ae=(0,d().K8)((()=>I().dd(e.store).filter((e=>(0,o(878710).G_)(e,{table:o(179034).ev,id:e.id},"alive").getValue()))),[e.store]),le=(0,d().K8)((()=>O.getResolved()),[O]),ce=(0,d().K8)((()=>null==re?void 0:re.state.files),[re]),de=(0,d().K8)((()=>null==re?void 0:re.state.textStore),[re]),ue=(0,i.useCallback)((e=>{const t=e.target;t instanceof HTMLElement&&(0,o(819121).p)(t)&&X(!0)}),[]),me=(0,i.useCallback)((()=>{X(!1)}),[]),pe=(0,i.useCallback)((()=>{_().A.state||te(!0)}),[]),ge=(0,i.useCallback)((()=>{te(!1)}),[]),he=(0,l().S)(),fe=(0,d().uB)(void 0,R().A),ve=(0,d().K8)((()=>fe.state.open),[fe]),Se=(0,o(551619).Sm)($),xe=(0,d().K8)((()=>(0,j().o7)(e.store.id)),[e.store.id]),be=(0,d().K8)((()=>{const t=e.discussionStore.getComments();return Boolean(t&&t[0]===e.store.id)}),[e.discussionStore,e.store.id]),ye=(0,d().K8)((()=>{var t;const o=$.getRole(),n=z({isFirstComment:be,discussionLocation:W}),i=$.pathIsDead(),r=o&&g().h9(o)||i,a="comment_only"===o||he&&"comment"===(null===(t=he.publicEditModeStore.state)||void 0===t?void 0:t.permission),l=n&&!s().A.isMobile&&!a&&!r;return ee||q||e.hoveringDiscussion&&n||ve||s().A.isMobile||e.showResolveButtonByDefaultIfPossible&&l}),[$,e.hoveringDiscussion,e.showResolveButtonByDefaultIfPossible,be,W,he,ee,q,ve]),Ce=(0,i.useContext)(o(789550).R),ke=(0,d().K8)((()=>{const e=t.getCreatedByPointer();return e?{createdByPointer:e,lastEditedTime:t.getLastEditedTime(),createdTime:t.getCreatedTime(),text:t.getText(),reactions:T().L.getUserVisibleReactions(t)}:null}),[t]),Ae=(0,d().K8)((()=>ke?(0,D().JQ)({parentStore:t,pointer:ke.createdByPointer}):null),[ke,t]),we=(0,d().K8)((()=>I().gp(e.store)),[e.store]),je=function(e){const{discussionLocation:t,isCommentCollapsed:o,isDiscussionCollapsed:n,maxLines:i}=e;if("feed_item_top_level_discussion"===t)return o?i:void 0;return n?i:void 0}({discussionLocation:W,isCommentCollapsed:ie,isDiscussionCollapsed:J,maxLines:e.maxLines}),De=(0,i.useCallback)((()=>{C().createAndCommit({userAction:"Comment.deleteComment",environment:G,canUndo:!0,perform:t=>{P().Tu({environment:G,commentStore:e.store,transaction:t,discussionLocation:W})},skipUpdatingEditedMetadata:!0})}),[G,e.store,W]),Be=(0,i.useCallback)((async()=>{const{accept:e}=await x().Gh({message:(0,Ie.jsx)(f().sA,{defaultMessage:"Would you like to delete this comment?",id:"comment.confirmDialog.deleteComment.prompt"}),acceptLabel:(0,Ie.jsx)(f().sA,{defaultMessage:"Delete",id:"comment.confirmDialog.deleteComment.deleteButton.label"})});e&&(De(),S().UP(),V().A.state.overlapsExistingDiscussionMenu&&!B().A.state.open&&V().A.setState({...V().A.state,overlapsExistingDiscussionMenu:!1}),(0,E().j)(G))}),[De,G]),Re=(0,i.useCallback)((async t=>{const o=we.getValue(),n=I().dd(e.store).filter((e=>e.id!==t.id)),i=o&&o.length>0,s=0===n.length;!i&&s?(await Be(),Q(!1)):C().createAndCommit({userAction:"Comment.handleRemoveFileFromActions",environment:G,canUndo:!0,perform:o=>{P().L6({commentStore:e.store,fileBlocks:[t],transaction:o})}})}),[we,G,Be,e.store]),_e=(0,i.useCallback)((()=>{ne(!0)}),[]),Te=(0,i.useCallback)((async()=>{if(!re)return;const e=we.getValue()||[],t=re.state.textStore;C().createAndCommit({userAction:"Comment.handleEditComment",environment:G,canUndo:!0,perform:n=>{o(319975).R9({environment:G,store:t,value:e,transaction:n})}}),Q(!0),await r().default.afterNextFlush(),await r().default.afterNextFlush(),(0,y().z)({store:t})}),[re,we,G]),Pe=(0,i.useCallback)((async()=>{if(!re)return!1;if(!(0,F().hasCommentChanged)(re,e.store))return Q(!1),!0;{const{accept:e}=await x().Gh({message:(0,Ie.jsx)(f().sA,{defaultMessage:"Do you want to discard this edit?",id:"comment.confirmDialog.discardEdit.prompt"}),acceptLabel:(0,Ie.jsx)(f().sA,{defaultMessage:"Discard",id:"comment.confirmDialog.discardEdit.discardButton.label"})});if(e)return Q(!1),!0}return!1}),[re,e.store]),Ee=(0,i.useCallback)((async()=>{const t=null==de?void 0:de.getValue();t&&t.length>0||ce&&ce.length>0?C().createAndCommit({userAction:"Comment.handleSubmitEdit",environment:G,canUndo:!0,perform:o=>{P().QA({environment:G,store:e.store,text:t||[],transaction:o,discussionLocation:W,files:ce||[],property_id:O.getPropertyId(),blockStore:$})}}):await Be(),Q(!1)}),[de,ce,G,e.store,W,O,$,Be]),Ue=(0,i.useCallback)((()=>{"feed_item_top_level_discussion"===W&&se(!1)}),[W]),Fe=(0,i.useRef)(null),ze=(0,i.useRef)(null);(0,c().b)(L().A,(()=>({edit:Te,handleCancelEdit:Pe,getNode:()=>Fe.current,isEditing:()=>Z,discussionLocation:W,commentId:e.store.id})),[Te,Pe,Z,W,e.store.id]);const Ke=null==ke?void 0:ke.text,He=void 0!==Ke&&Ke.length>0&&h().AhH(Ke)>0,Ve=He&&(0,F().isCommentAllEmojis)(Ke),We=Boolean(s().A.isMobile),Ne=(0,K().C)({type:"discussionLocation",location:W}),Oe=function({discussionLocation:e,showNewBar:t,isAllEmojis:o,newStatusDotPosition:n,isMobileRedesignEnabled:i}){return(0,u().IS)((s=>({container:{flexGrow:"comment_unfurl"===e?1:void 0,paddingTop:t?0:"comment_unfurl"===e?U().ds:U().e4,paddingInlineEnd:U().JC(e,i,"end"),paddingBottom:U().Wv,paddingInlineStart:U().JC(e,i,"start")},comment:{position:"relative",fontSize:i?v().J.UIRegular.mobile:v().J.UIRegular.desktop},commentElementsBelowUserRow:{paddingInlineStart:U().FB},discussionInputContainer:{width:"calc(100% + 8px)"},threadLine:{position:"absolute",backgroundColor:s.border.secondary,borderRadius:2,width:U().jw,height:U().k2,insetInlineStart:U().im,top:U().uG},unfurlMoreWrapper:{color:s.text.tertiary,fontWeight:"comment_unfurl"===e?v().Wy.medium:void 0,display:"block",marginBottom:-1.5,pointerEvents:"auto"},text:{cursor:"comment_unfurl"!==e?"text":void 0,lineHeight:"20px",paddingTop:4,...o?{fontSize:32,lineHeight:"32px"}:{}},attachmentContainer:{display:"flex",alignItems:"center"},commentAttachment:{},authorRowContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:n?"flex-start":"space-between"},unreadStatusDot:{display:"flex",flexDirection:"row",alignItems:"center",marginInlineEnd:4,...n&&{marginInlineStart:6}}})),[e,o,t,n,i])}({discussionLocation:W,isAllEmojis:Ve,showNewBar:Boolean(e.showNewBar),newStatusDotPosition:We,isMobileRedesignEnabled:Ne}),$e=(0,i.useMemo)((()=>({type:"comment_match",commentId:e.store.id})),[e.store.id]),Je="comment_unfurl"!==W,Ye=Je&&ke&&ke.reactions.length>0;if((0,i.useEffect)((()=>{oe&&ze.current&&Ye&&(b().hT({element:ze.current,environment:G,scrollerContext:Ce,vertical:{reveal:"closest"},horizontal:void 0,animate:!0}),ne(!1))}),[G,Ce,oe,Ye]),!re)return null;if(!ke||!Ae)return null;const Ge=ae.length>0&&(0,Ie.jsx)("div",{style:Oe.commentAttachment,children:(0,Ie.jsx)(Xe,{contentStores:ae,onRemoveContent:Re,discussionFormat:(0,F().discussionLocationToDiscussionFormat)(W),collapsed:J,discussionHovered:e.hoveringDiscussion})});return(0,Ie.jsxs)("div",{ref:Fe,onClick:e=>Z&&e.stopPropagation(),style:Oe.container,children:[e.showNewBar?(0,Ie.jsx)(tt,{}):void 0,(0,Ie.jsxs)("div",{style:Oe.comment,onFocus:ue,onBlur:me,onMouseMove:pe,onMouseLeave:ge,children:[(0,Ie.jsxs)("div",{style:Oe.authorRowContainer,children:[(0,Ie.jsx)(o(456101).Y,{createdTime:ke.createdTime,lastEditedTime:ke.lastEditedTime,location:W,isResolved:le,isSuggestionComment:e.isSuggestionComment,authorStore:Ae,commentStore:t,suppressMouse:J}),e.showUnreadStatusDot?(0,Ie.jsx)("div",{style:Oe.unreadStatusDot,children:(0,Ie.jsx)(M().m,{size:k().jd})}):void 0]}),N?(0,Ie.jsx)("div",{style:Oe.threadLine}):void 0,(0,Ie.jsxs)("div",{style:Oe.commentElementsBelowUserRow,children:[Boolean(n)?n:void 0,Z?(0,Ie.jsx)("div",{style:{marginTop:4},children:(0,Ie.jsx)(ot().A,{containerStyle:Oe.discussionInputContainer,showAvatar:!1,parentStore:e.store,blockStore:$,onCancel:Pe,onSubmit:Ee,discussionInputStore:re,isEditingExistingComment:!0,isMobileSlideUpMenu:!0,shouldSaveUnsentComments:!1,commentStore:e.store,discussionFormat:(0,F().discussionLocationToDiscussionFormat)(W),canDrop:!0})}):void 0,He&&!Z?(0,Ie.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[(0,Ie.jsx)(w().A,{onMore:"comment_unfurl"===W?void 0:Ue,moreElement:(0,Ie.jsxs)(A().A,{disableUnderline:!0,style:Oe.unfurlMoreWrapper,hoverColor:"blue",children:["â€¦","Â ",(0,Ie.jsx)("span",{children:(0,Ie.jsx)(f().sA,{id:"comment.truncated.showMoreLabel",defaultMessage:"more"})})]}),maxLines:je,children:(0,Ie.jsx)(o(712855).A,{style:Oe.text,store:we,disabled:!0,disabledMentionTypes:{date:!0,property:!0},disableEquationInteraction:!0,inPageFind:$e})}),Se&&xe?(0,Ie.jsx)(p().A,{style:{alignSelf:"flex-end",marginInlineEnd:8,marginInlineStart:8}}):void 0]}):void 0,Z||"comment_unfurl"===W?!He&&(0,Ie.jsxs)("div",{style:Oe.attachmentContainer,children:[(0,Ie.jsx)("div",{style:{marginInlineEnd:5},children:(0,Ie.jsx)(m().I,{colorVariant:"secondary",icon:o(609616).o})}),(0,Ie.jsx)(f().sA,{defaultMessage:"{numberOfAttachments, plural, one {{numberOfAttachments} attachment} other {{numberOfAttachments} attachments}}",values:{numberOfAttachments:ae.length},id:"comment.unfurl.attachments.title"})]}):Ge,Ye?(0,Ie.jsx)("div",{ref:ze,style:{marginTop:8},children:(0,Ie.jsx)(Me().Ay,{parentStore:e.store,discussionLocation:W})}):void 0]}),"comment_unfurl"===W||Z||Se?void 0:(0,Ie.jsx)(Le,{store:e.store,discussionStore:e.discussionStore,blockStore:$,discussionLocation:W,visible:ye,isFirstComment:be,buttonPopupStore:fe,canShowReactions:Je,handleEditComment:Te,handleDeleteComment:Be,handleReaction:_e,showMarkAsRead:Y})]})]})};o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(672577),o(737550);var it=()=>o(601813),st=()=>o(220719),rt=()=>o(749804),at=()=>o(478726),lt=()=>o(953418),ct=()=>o(695625),dt=()=>o(546574);function ut({discussionStore:e,commentStore:t}){var o;if(!t.isDefined())return!1;const n=null===(o=ye().default.state.currentUserStore)||void 0===o?void 0:o.id;const i=dt().A.state.lastInteractionTimes[e.id];if(t.getCreatedById()===n)return!1;const s=function(){if(!e.isDefined()||!n)return 0;const{pageVisitStore:t}=ye().default.state,{lastViewTime:o,lastExitTime:i}=t.state;return i||o}();if(void 0===s)return!1;const r=(0,F().getAndSortCommentStoresByTime)(e).filter((e=>e.getCreatedById()===n)).reverse()[0],a=t.getCreatedTime();return!a||!(r&&a<r.getCreatedTime())&&(!(i&&a<i)&&a>s)}var mt=()=>o(655236),pt=()=>o(97294),gt=()=>o(641007),ht=()=>o(721479),ft=()=>o(693954),vt=()=>o(265665);const St="https://notion.notion.site/AI-Conflict-Detection-158efdeead058037b57efc2b77ad9c21";function xt(e){const{discussionLocation:t,commentStore:o}=e,n=(0,d().K8)((()=>{if(!o)return!1;const e=o.getCreatedByPointer();return!!e&&e.id===gt().px.id}),[o]),i=Boolean(s().A.isMobile),r=(0,K().C)({type:"discussionLocation",location:t}),a=(0,u().IS)((e=>({container:{display:"flex",flexDirection:"row",gap:6,width:"100%",color:e.text.tertiary,fontSize:i?v().J.UISmall.mobile:v().J.UISmall.desktop,paddingTop:U().e4,paddingInlineStart:U().JC(t,r,"start")+U().eQ-8},warningIcon:{width:10,height:10,alignSelf:"center",display:"inline-block",verticalAlign:"text-bottom"},helpIcon:{color:e.text.tertiary,flexDirection:"row-reverse",gap:6,width:14,alignItems:"center",cursor:"pointer",textDecoration:"none",pointerEvents:"auto"},text:{maxWidth:200}})),[t,r,i]);return n?(0,Ie.jsxs)("div",{style:a.container,children:[(0,ft().Q)(a.warningIcon),(0,Ie.jsx)(vt().j,{style:a.text,children:(0,Ie.jsx)(f().sA,{id:"aiCommentHeader.conflictingContent.label",defaultMessage:"Notion AI found potential conflicts"})}),(0,Ie.jsx)(pt().N,{href:St,external:!0,style:a.helpIcon,children:(0,Ie.jsx)(m().I,{icon:ht().questionMarkCircleSmallIcon,size:"sm"})})]}):null}o(430670);var bt=()=>o(8633),yt=()=>o(856402),Ct=()=>o(811879),kt=()=>o(846583);function At(e){const{discussionStore:t,discussionContext:o,discussionLocation:n,blockStore:s,hoveringDiscussion:r,showUnreadStatusDot:l=!1}=e,c=(0,f().tz)(),[m,p]=(0,i.useState)(!1),g=(0,i.useCallback)((()=>{p(!0)}),[]),h=(0,i.useCallback)((()=>{p(!1)}),[]),S=(0,d().uB)(void 0,R().A),x=(0,d().K8)((()=>S.state.open),[S]),b=(0,d().O$)(ye().AppStoreSidebarSpaceStore),y=(0,d().K8)((()=>{const e=T().L.getUserVisibleReactions(t),o=e.flatMap((e=>{const t=e.getCreatedTime();return e.getActorStores().map((e=>({actor:e,createdTime:t})))})),n=(0,ie().hS)(o.sort(((e,t)=>t.createdTime-e.createdTime)),(e=>e.actor.id));return{reactorNames:n.map((e=>e.actor.getDisplayName(c))),reactors:n.map((e=>e.actor)),reactions:e}}),[t,c]),C=(0,d().K8)((()=>{const e=(null==y?void 0:y.reactions)??[];return m||r||x||e.length>0}),[m,r,x,y]),k=function({discussionLocation:e}){return(0,u().IS)((t=>({container:{flexGrow:"comment_unfurl"===e?1:void 0,paddingTop:"comment_unfurl"===e?U().ds:U().e4,paddingBottom:U().Wv},content:{position:"relative",fontSize:14,width:"100%"},authorRowContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"},avatarsAndNames:{display:"flex",flexDirection:"row",alignItems:"center",fontWeight:v().Wy.medium,gap:8},reactorNames:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},reactionElementsBelowUserRow:{paddingInlineStart:U().FB},reactionBarWrapper:{marginTop:8},unreadStatusDot:{display:"flex",flexDirection:"row",alignItems:"center",marginInlineEnd:4},statusDot:{width:8,height:8,borderRadius:"50%",backgroundColor:t.blue.icon.accentPrimary}})),[e])}({discussionLocation:n}),A=(0,i.useRef)(null),w=(0,a().v3)().currentUser.id,M=(0,d().K8)((()=>{var e;const t=null==y||null===(e=y.reactors)||void 0===e?void 0:e.map((e=>(0,D().d5)(e).asActor)).filter(se().O9);return(0,bt().b)({intl:c,currentUserId:w,authors:t,fontWeightForAuthorNames:"medium",isCondensedFormat:!0})}),[w,null==y?void 0:y.reactors,c]);if(!y)return null;const I=o||"updates_sidebar"===n,j=y.reactors[0],L=y.reactors[1];return(0,Ie.jsx)("div",{ref:A,style:k.container,onMouseMove:g,onMouseLeave:h,children:(0,Ie.jsxs)("div",{style:k.content,children:[(0,Ie.jsxs)("div",{style:k.authorRowContainer,children:[(0,Ie.jsxs)("div",{style:k.avatarsAndNames,children:[y.reactors.length>0?(0,Ie.jsxs)("div",{children:[j&&L&&b?(0,Ie.jsx)(yt().v,{frontActorStore:j,backActorStore:L,spaceStore:b}):void 0,j&&!L?(0,Ie.jsx)(Ct().E,{authorStore:j,avatarSize:U().eQ,hasTooltip:!0,avatarStyle:{}},j.id):void 0]}):void 0,(0,Ie.jsx)("span",{style:k.reactorNames,children:(0,Ie.jsx)(f().sA,{id:"reactions.blockReaction",defaultMessage:"{reactors} <regular>reacted</regular>",values:{reactors:M,regular:e=>(0,Ie.jsx)("span",{style:{fontWeight:v().Wy.regular},children:e})}})})]}),l?(0,Ie.jsx)("div",{style:k.unreadStatusDot,children:(0,Ie.jsx)("div",{style:k.statusDot})}):void 0]}),(0,Ie.jsxs)("div",{style:k.reactionElementsBelowUserRow,children:[I?(0,Ie.jsx)(kt().A,{format:(0,F().discussionLocationToDiscussionFormat)(n),discussionLocation:n,store:t,blockStore:s,onClick:e=>e.stopPropagation()}):void 0,C?(0,Ie.jsx)("div",{style:k.reactionBarWrapper,children:(0,Ie.jsx)(Me().Ay,{parentStore:t,discussionLocation:n})}):void 0]})]})})}const wt={block_menu:"8px 16px 0px",page_discussion:"8px 0px 0px",updates_sidebar:"4px 16px 12px",margin_comments:"8px 12px 6px",comment_unfurl:"0",feed_item_top_level_discussion:"8px 16px 0px",new_discussions_sheet:"8px 12px 6px",updates_menu_mentions_comments:"4px 16px 12px",updates_menu_all_updates:"4px 16px 12px",updates_menu_archive:"4px 16px 12px",reply_menu_mentions_comments:"8px 16px 0px",reply_menu_all_updates:"8px 16px 0px",reply_menu_archive:"8px 16px 0px",reply_menu_updates_sidebar:"8px 16px 0px",ai_reject_all_suggestions:"0"},Mt=i.forwardRef((function(e,t){const n=(0,a().v3)(),{format:i,role:s,showMoreCommentsButton:r,onMoreCommentsClick:l,inputVisible:c,blockStore:d}=e,m=(0,o(891078).i0)(d),p=s&&g().h9(s)||m,h=n.currentUser.isLoggedIn(),f=(0,K().C)({type:"discussionFormat",format:e.format}),v=(0,u().IS)((t=>({container:{position:"relative",padding:0,...i===F().DiscussionFormat.Page?{marginInlineStart:16,marginInlineEnd:16}:{}},discussionInputContainer:{padding:wt[e.discussionLocation],...f?{paddingInlineStart:(0,U().JC)(e.discussionLocation,f,"start"),paddingInlineEnd:(0,U().JC)(e.discussionLocation,f,"end")}:{}}})),[i,e.discussionLocation,f]);return h&&!p&&(r||c)?(0,Ie.jsxs)("div",{style:v.container,children:[r?(0,Ie.jsx)(o(499512).d,{enableIcon:!0,onClick:l}):void 0,c?(0,Ie.jsx)(ot().A,{autoFocus:!0,showAvatar:!0,containerStyle:v.discussionInputContainer,parentStore:e.store,onCancel:e.onCancel,onSubmit:e.onSubmit,discussionInputStore:e.discussionInputStore,isMobileSlideUpMenu:!1,shouldSaveUnsentComments:!0,onEditPreviousComment:e.onEditPreviousComment,inReplyToDiscussionId:e.store.id,discussionFormat:e.format,showCtaButtons:e.showCtaButtons,ref:t,onFileUploaded:e.onFileUploaded}):void 0]}):null}));var It=()=>o(631524);function jt(e){const t=(0,K().C)({type:"discussionLocation",location:e.discussionLocation}),o=(0,u().IS)((o=>{const n=t?v().J.UIRegular.mobile:v().J.UIRegular.desktop,i=U().JC(e.discussionLocation,t,"start")+U().eQ;return{moreCommentsWrapper:{color:o.text.tertiary,fontSize:n,flexGrow:1,display:"flex",alignItems:"center",paddingInlineStart:8},button:{borderRadius:6,fontSize:n,color:o.text.secondary,justifyContent:"space-between",padding:"14px 0",margin:`0 0 0 ${i}px`,width:`calc(100% - ${i}px - 16px)`},buttonHovered:{background:o.focusDiscussionInputBackground},threadLine:{position:"absolute",backgroundColor:o.border.secondary,width:U().jw,height:"100%",top:U().e4-U().Yz,insetInlineStart:U().JC(e.discussionLocation,t,"start")+U().im,borderRadius:2},badge:{marginInlineStart:6,marginInlineEnd:6}}}),[e.discussionLocation,t]);return e.count<=0?null:(0,Ie.jsxs)("div",{style:{position:"relative"},children:[(0,Ie.jsx)("div",{style:o.threadLine}),(0,Ie.jsx)(It().p,{colorPalette:"gray",size:"xs",style:o.button,onClick:e.onClick,hoveredStyle:o.buttonHovered,children:(0,Ie.jsxs)("div",{className:"discussion-show-all-button",style:o.moreCommentsWrapper,children:[(0,Ie.jsx)(f().sA,{defaultMessage:"Show {moreCommentsNumber, plural, one {{moreCommentsNumber} reply} other {{moreCommentsNumber} replies}}",id:"discussion.showMoreCommentsSidebarButton.label",values:{moreCommentsNumber:e.count}}),e.showNewBadge?(0,Ie.jsx)(et().J1,{style:o.badge}):null]})},"show")]})}var Lt=()=>o(797809),Dt=()=>o(712030),Bt=()=>o(921855);function Rt(e){const{discussionStore:t}=e,o=(0,f().tz)(),n=(0,d().K8)((()=>t.isSuggestionDiscussion()),[t]),i=(0,d().K8)((()=>{const t=e.discussionStore.getContext();return(t?(0,it().Qe)({discussionContextData:t,discussionId:e.discussionStore.id,discussionType:(0,st().o9)(e.discussionStore.getType()),intl:o}):[])??[]}),[e.discussionStore,o]),s=(0,u().IS)((e=>({container:{marginTop:2},label:{color:e.blue.text.tertiary,fontSize:14,lineHeight:"18px"},labelDeleteColor:{color:e.text.tertiary},text:{color:e.blue.text.accentPrimary,fontSize:14,lineHeight:1.29},textDeleteColor:{color:e.text.secondary},suggestionContextItem:{display:"block",marginBottom:4,whiteSpace:"pre-wrap",wordBreak:"break-word"},unfurlMoreWrapper:{color:e.text.tertiary,fontWeight:v().Wy.medium,display:"block",marginBottom:-1.5,pointerEvents:"auto"}})),[]),r=(0,Lt().RX)(o).title;return n&&r&&0!==i.length?(0,Ie.jsx)("div",{style:s.container,children:(0,Ie.jsx)(w().A,{maxLines:e.collapsed?1:void 0,clampOverride:{lineHeight:1.29,fontSize:14},moreElement:(0,Ie.jsxs)(A().A,{disableUnderline:!0,style:s.unfurlMoreWrapper,hoverColor:"blue",children:["â€¦","Â ",(0,Ie.jsx)("span",{children:(0,Ie.jsx)(f().sA,{id:"suggestion.truncated.showMoreLabel",defaultMessage:"more"})})]}),children:i.map((({label:e,value:o,shouldUseDeleteColor:n,removeQuotationMarks:i},r)=>(0,Ie.jsxs)("div",{style:s.suggestionContextItem,children:[(0,Ie.jsxs)("span",{style:{...s.label,...n&&s.labelDeleteColor},children:[e,": "]}),(0,Ie.jsxs)("span",{style:{...s.text,...n&&s.textDeleteColor},children:[i?null:"â€œ",(0,Ie.jsx)(_t,{value:o,discussionStore:t}),i?null:"â€"]})]},r)))})}):null}function _t({value:e,discussionStore:t}){const o=(0,a().v3)(),n=(0,u().DP)(),i=(0,d().K8)((()=>(0,Bt().S5)({environment:o,textValue:{value:e,spaceId:t.pointer.spaceId},parentStore:t,disableHover:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!0,disableSuggestionAnnotations:!0,disabled:!0,theme:n,emojiType:(0,Dt().FN)(o),katex:o.KatexStore.getKatex(),formulaValueTypes:[]})),[o,e,t,n]);return(0,Ie.jsx)("span",{children:i})}function Tt(e){const{onDismiss:t}=e,n=(0,i.useRef)(null),l=(0,f().tz)(),m=(0,a().v3)(),p=(0,d().K8)((()=>"suggestion"===e.store.getType()),[e.store]),g=(0,d().K8)((()=>I().wc(e.store)),[e.store]),v=(0,d().K8)((()=>g.filter((e=>e.isDefined())).filter((e=>Boolean(e.getAlive())))),[g]),S="page_discussion"===e.discussionLocation?3:5;(0,i.useEffect)((()=>{v.length===S&&E(!0)}),[v,S]);const k=(0,i.useRef)(e.discussionInputStore||new(H().A)(m,e.store.pointer.spaceId)).current,A=(0,d().K8)((()=>(0,F().inputIsEmpty)(k)),[k]),w=(0,d().K8)((()=>{if((0,at().fc)(e.blockStore)){if((0,at().Cg)(e.blockStore)){const t=e.blockStore.getAssociatedCollectionStore();if(t)return!(0,j().vW)(t)}return!0}return!1}),[e.blockStore]),M=(0,d().K8)((()=>e.store.getResolved()),[e.store]),[D,B]=(0,i.useState)(!1),[R,E]=(0,i.useState)(void 0!==e.collapsed&&!e.collapsed),[z,V]=(0,i.useState)(!0),W=(0,d().uB)(void 0,o(150669).A),N=(0,d().K8)((()=>W.state.clientRect),[W]),O=e.format===F().DiscussionFormat.Sidebar,$=e.format===F().DiscussionFormat.Margin,J=e.format===F().DiscussionFormat.Menu,Y=(0,i.useRef)(null);(0,c().b)(o(143857).A,(()=>({isSidebarFormat:()=>O,isMarginFormat:()=>$,isMenuFormat:()=>J,getStore:()=>e.store,getInputStore:()=>k,getNode:()=>Y.current,getMarginDiscussionScrollContainer:()=>n.current})),[O,$,e.store,k]);const G=(0,d().K8)((()=>{if(!O)return;return(0,F().getAndSortCommentStoresByTime)(e.store).find((t=>ut({discussionStore:e.store,commentStore:t})))}),[O,e.store]),Z=(0,i.useRef)(G),Q=(0,d().K8)((()=>(0,mt().s)({discussionStore:e.store,navigableBlockStore:e.blockStore.getNavigableBlockStore()})),[e.store,e.blockStore]),q=(0,d().K8)((()=>{var t,o;if(!Q)return;const n=null===(t=e.store.getUserSeenRecordStore())||void 0===t?void 0:t.getLastSeenAt();return n?null===(o=v.find((e=>e.getCreatedTime()>n)))||void 0===o?void 0:o.id:null==G?void 0:G.id}),[G,v,e.store,Q]),X=(0,i.useCallback)((()=>{var t;if(R||v.length<=S||"block_menu"===e.discussionLocation)return v;if("page_discussion"===e.discussionLocation)return ie().O6(v,1);const o=[e.showAllRepliesAfterTimestamp,null===(t=Z.current)||void 0===t?void 0:t.getCreatedTime(),null==G?void 0:G.getCreatedTime()].filter(se().O9),n=o.length>0?Math.min(...o):void 0;if(n){const e=v.filter((e=>(e.getCreatedTime()||0)>n)),t=v.filter((e=>(e.getCreatedTime()||0)<=n));return t.length<=5?v:[...ie().O6(t,2),...e]}return ie().O6(v,2)}),[v,G,S,e.discussionLocation,e.showAllRepliesAfterTimestamp,R]),ee=(0,d().K8)((()=>{const t=X(),o=new Set(t.map((e=>e.id))),n=v.filter((e=>!o.has(e.id)));return{commentStores:v,commentsToShow:t,commentsToCollapse:n,reactionsToShow:T().L.getUserVisibleReactions(e.store)}}),[v,X,e.store],{useDeepEqual:!0}),te=(0,i.useCallback)((()=>{if(!e.store.isDefined())return;const t=e.store.getContext();if(!t)return;const o=(0,it().l8)({discussionContextData:t,discussionType:(0,st().o9)(e.store.getType()),discussionId:e.store.id,intl:l});return h().JJ$(o,(t=>!h().iQL(t)||h().Orm(t)===e.store.id))}),[e.store,l]),oe=(0,i.useRef)(null),ne=(0,i.useRef)(e.blockStore.clone()).current,re=(0,K().C)({type:"discussionFormat",format:e.format}),ae=(0,u().IS)((t=>({discussionWrapper:{...e.format===F().DiscussionFormat.Page&&{marginTop:ee.reactionsToShow.length>0?6:0,marginInlineEnd:U().Ql,marginInlineStart:U().Ql,marginBottom:ee.reactionsToShow.length>0?6:16,..."feed_item_top_level_discussion"===e.discussionLocation&&{marginInlineStart:-16,marginBottom:ee.reactionsToShow.length>0?0:12}},...e.format===F().DiscussionFormat.Menu&&{padding:"6px 0 12px",marginInlineStart:re?0:-2,boxShadow:e.isFirst?"none":`0 -1px 0 ${t.regularDividerColor}`,marginTop:e.isFirst?0:1},...e.format===F().DiscussionFormat.Margin&&{padding:"4px 0",borderRadius:8}},reactionBarWrapper:{paddingInlineStart:16,paddingInlineEnd:16,..."feed_item_top_level_discussion"===e.discussionLocation&&{display:"flex",justifyContent:"space-between"}},discussionContainer:{...e.format===F().DiscussionFormat.Page&&{borderRadius:8}}})),[ee.reactionsToShow.length,e.discussionLocation,e.format,e.isFirst,re]);(0,i.useEffect)((()=>{m.KatexStore.loadIfNeeded(te)}),[m.KatexStore,te]);const le=(0,i.useCallback)((t=>{if(!s().A.isMobile)return;if(!e.store.isDefined())return;t.stopPropagation(),t.preventDefault(),o(883497).A.setState({open:!1});const n=ie().oE(ct().T.findSelectablesFromIds([e.store.getParentId()])),i=null==n?void 0:n[0];i&&b().pb({environment:m,handle:i,vertical:{reveal:"bottom"},horizontal:{reveal:"closest"},animate:!0})}),[e.store,m]),ce=(0,i.useCallback)((e=>{$||(e.stopPropagation(),E(!0))}),[$]),de=(0,i.useMemo)((()=>{const{commentStores:t,commentsToShow:i,commentsToCollapse:s}=ee;if($){const i=(0,F().lineClampForCommentCount)(t.length);if(!e.collapsed)return(0,Ie.jsx)(o(2143).H,{style:{display:"flex",flexDirection:"column",maxHeight:500,overflowY:"scroll"},ref:n,type:o(611648).A.Y,store:W,children:t.map(((o,n)=>{const s=p&&0===n;return(0,Ie.jsx)(nt,{store:o,discussionStore:e.store,blockStore:e.blockStore,hoveringDiscussion:D,discussionLocation:e.discussionLocation,showResolveButtonByDefaultIfPossible:e.showResolveButtonByDefaultIfPossible,maxLines:i,shouldShowThreadLine:n!==t.length-1,discussionContext:s?(0,Ie.jsx)(Rt,{discussionStore:e.store,collapsed:Boolean(e.collapsed)}):void 0,showNewBar:o.id===q&&0!==n,isSuggestionComment:s,showUnreadStatusDot:0===n&&Q,showMarkAsRead:Q},o.id)}))});const s=t[0]&&(0,Ie.jsx)(nt,{store:t[0],discussionStore:e.store,blockStore:e.blockStore,hoveringDiscussion:D,discussionLocation:e.discussionLocation,showResolveButtonByDefaultIfPossible:e.showResolveButtonByDefaultIfPossible,maxLines:i,collapsed:e.collapsed,shouldShowThreadLine:1!==t.length,discussionContext:p?(0,Ie.jsx)(Rt,{discussionStore:e.store,collapsed:Boolean(e.collapsed)}):void 0,isSuggestionComment:p,showUnreadStatusDot:Q,showMarkAsRead:Q},t[0].id),r=t.length>1&&t[t.length-1]&&(0,Ie.jsx)(nt,{store:t[t.length-1],discussionStore:e.store,blockStore:e.blockStore,hoveringDiscussion:D,discussionLocation:e.discussionLocation,showResolveButtonByDefaultIfPossible:e.showResolveButtonByDefaultIfPossible,maxLines:i,collapsed:e.collapsed,shouldShowThreadLine:!1,showUnreadStatusDot:!1,showMarkAsRead:!1,showNewBar:t[t.length-1].id===q},t[t.length-1].id),a=t.length-2;return(0,Ie.jsxs)(Ie.Fragment,{children:[s,(0,Ie.jsx)(jt,{insetButton:!$,count:a,onClick:ce,discussionLocation:e.discussionLocation,showNewBadge:t.some(((e,o)=>e.id===q&&0!==o&&o!==t.length-1))}),r]})}const r=s.length>0,a=i.map(((t,o)=>{const n=p&&0===o,s=0===o&&!r,a=n?(0,Ie.jsx)(Rt,{discussionStore:e.store,collapsed:Boolean(e.collapsed)}):s&&(e.format===F().DiscussionFormat.Menu||e.format===F().DiscussionFormat.Sidebar)&&(0,Ie.jsx)(kt().A,{format:e.format,discussionLocation:e.discussionLocation,store:e.store,blockStore:e.blockStore,onClick:le}),l="feed_item_top_level_discussion"===e.discussionLocation?(0,F().lineClampForCommentCount)(i.length):void 0;return(0,Ie.jsx)(nt,{store:t,discussionStore:e.store,blockStore:e.blockStore,hoveringDiscussion:D,discussionLocation:e.discussionLocation,showResolveButtonByDefaultIfPossible:e.showResolveButtonByDefaultIfPossible,discussionContext:a,isSuggestionComment:n,showNewBar:t.id===q&&!s,shouldShowThreadLine:o!==i.length-1,maxLines:l,showUnreadStatusDot:s&&Q,showMarkAsRead:Q},t.id)})),l=p,c=l?(0,Ie.jsx)(Rt,{discussionStore:e.store,collapsed:Boolean(e.collapsed)}):(e.format===F().DiscussionFormat.Menu||e.format===F().DiscussionFormat.Sidebar)&&(0,Ie.jsx)(kt().A,{format:e.format,discussionLocation:e.discussionLocation,store:e.store,blockStore:e.blockStore,onClick:le});return(0,Ie.jsxs)("div",{style:{position:"relative",...ae.discussionContainer},children:[r?(0,Ie.jsx)(nt,{store:t[0],discussionStore:e.store,blockStore:e.blockStore,hoveringDiscussion:D,discussionLocation:e.discussionLocation,showResolveButtonByDefaultIfPossible:e.showResolveButtonByDefaultIfPossible,discussionContext:c,shouldShowThreadLine:1!==t.length,isSuggestionComment:l,collapsed:e.collapsed,maxLines:"feed_item_top_level_discussion"===e.discussionLocation&&e.collapsed?(0,F().lineClampForCommentCount)(t.length):void 0,showUnreadStatusDot:Q,showMarkAsRead:Q},t[0].id):void 0,(0,Ie.jsx)(jt,{insetButton:!$,count:s.length-1,showNewBadge:s.some(((e,o)=>e.id===q&&0!==o&&o!==t.length-1)),onClick:ce,discussionLocation:e.discussionLocation}),a]})}),[ee,$,p,e.store,e.collapsed,e.format,e.discussionLocation,e.blockStore,e.showResolveButtonByDefaultIfPossible,le,ae.discussionContainer,D,Q,ce,q,W]),ue=(0,d().K8)((()=>e.blockStore.getRole()),[e.blockStore]),[me,pe]=(0,i.useState)(!0);(0,i.useEffect)((()=>{var e;const t=null===(e=n.current)||void 0===e?void 0:e.getNode();if(t){function o(){t&&pe(lt().wU(t))}return t.addEventListener("scroll",o),()=>t.removeEventListener("scroll",o)}}),[n]);const ge=z&&!e.collapsed&&$&&N&&!me,he=(0,i.useCallback)((()=>{const e=ct().T.findSelectableFromStore(ne);e&&b().pb({environment:m,handle:e,vertical:{reveal:"bottom"},horizontal:{reveal:"closest"},animate:!0})}),[ne,m]),fe=(0,i.useCallback)((()=>{k.reset()}),[k]),ve=(0,i.useCallback)((()=>{const t=m.currentUser.id;if(!t)return;const o=I().wc(e.store).filter((e=>e.getCreatedById()===t)),n=ie().HV(o);if(!n)return;if(p&&1===o.length)return;const i=L().A.find((t=>t.commentId===n.id&&t.discussionLocation===e.discussionLocation));i&&((0,rt().I)({environment:m}),i.edit())}),[e.discussionLocation,p,e.store,m]),Se=(0,i.useCallback)((async()=>{if((0,F().hasCommentChanged)(k)){const{accept:e}=await x().Gh({message:(0,Ie.jsx)(f().sA,{defaultMessage:"Do you want to discard this reply?",id:"discussion.confirmDialog.discardReply.prompt"}),acceptLabel:(0,Ie.jsx)(f().sA,{defaultMessage:"Discard",id:"discussion.confirmDialog.discardReplyButton.label"})});e?(fe(),t&&t()):(await r().default.afterNextFlush(),(0,y().z)({store:k.state.textStore}))}else fe(),t&&t()}),[t,k,fe]),xe=(0,i.useCallback)((()=>{r().default.afterNextFlush((()=>{var e;const t=null===(e=n.current)||void 0===e?void 0:e.getNode();t&&lt().VG({element:t,environment:m,options:{top:t.scrollHeight,behavior:"smooth"}})}))}),[n,m]),be=ie().sg((()=>{setTimeout((()=>V(!0)),50)}),50),ye=(0,i.useCallback)((async()=>{V(!1),C().createAndCommit({userAction:"Discussion.handleSubmitReply",environment:m,canUndo:!0,perform:t=>{P().lV({environment:m,discussionStore:e.store,textValue:k.state.textStore.getValue()||[],transaction:t,discussionLocation:e.discussionLocation,files:k.state.files,property_id:e.store.getPropertyId(),blockStore:e.blockStore}),(0,Ce().U)({transaction:t,discussionStore:e.store})}}),fe(),(0,rt().I)({environment:m}),xe(),be(),s().A.isMobile||(await r().default.afterNextFlush(),(0,o(903864).e)({store:k.state.textStore}))}),[k,be,e.blockStore,e.store,e.discussionLocation,xe,m,fe]),ke=(0,i.useCallback)((()=>{_().A.state||B(!0)}),[]),Ae=(0,i.useCallback)((()=>{B(!1)}),[]);return 0===ee.commentsToShow.length&&ee.reactionsToShow.length>0||"feed_item_top_level_discussion"===e.discussionLocation&&0===ee.commentsToShow.length&&ee.reactionsToShow.length>0?(0,Ie.jsxs)("div",{ref:Y,style:{...ae.discussionWrapper,...ae.reactionBarWrapper},onMouseMove:ke,onMouseLeave:Ae,children:[e.format===F().DiscussionFormat.Menu||e.format===F().DiscussionFormat.Sidebar?(0,Ie.jsx)(At,{discussionStore:e.store,blockStore:e.blockStore,discussionLocation:e.discussionLocation,hoveringDiscussion:D,discussionContext:(0,Ie.jsx)(kt().A,{format:e.format,discussionLocation:e.discussionLocation,store:e.store,blockStore:e.blockStore,onClick:le})}):(0,Ie.jsx)(Me().tx,{focused:!0,disableShadow:!0,parentStore:e.store,discussionLocation:e.discussionLocation}),"feed_item_top_level_discussion"===e.discussionLocation&&e.pageVisitStore&&e.presenceStore?(0,Ie.jsx)(o(126126).hJ,{pageVisitStore:e.pageVisitStore,presenceStore:e.presenceStore,rootStore:e.blockStore,maxUsers:5,isShowingInFeed:!0}):void 0]}):(0,Ie.jsx)(o(199896).Ay,{store:ne,analyticsName:"discussion",canNativeDropOnto:!0,onNativeDrop:async({files:e})=>{oe.current&&await oe.current.uploadFiles(e)},keepTextSelectionOnDrop:!0,shouldShowDropZone:!0,children:(0,Ie.jsxs)("div",{ref:Y,style:ae.discussionWrapper,onMouseMove:ke,onMouseLeave:Ae,children:[e.collapsed?void 0:(0,Ie.jsx)(xt,{commentStore:g[0],discussionLocation:e.discussionLocation}),de,M?(0,Ie.jsx)("div",{style:{height:8}}):(0,Ie.jsx)(Mt,{ref:oe,showMoreCommentsButton:Boolean(ge),onMoreCommentsClick:xe,inputVisible:!(w||e.collapsed&&A&&"feed_item_top_level_discussion"!==e.discussionLocation),store:e.store,blockStore:ne,format:e.format,discussionInputStore:k,discussionLocation:e.discussionLocation,onCancel:Se,onSubmit:ye,onEditPreviousComment:ve,showCtaButtons:!!$||void 0,onFileUploaded:he,role:ue})]})})}const Pt=i.memo(Tt);var Et=()=>o(886901),Ut=()=>o(340498),Ft=()=>o(285790),zt=()=>o(21140),Kt=()=>o(644914),Ht=()=>o(835066);const Vt=(0,f().YK)({commentsAriaLabel:{defaultMessage:"{count, plural, one {1 comment} other {{count} comments}}",id:"comments.components.discussionindicator.commentAriaLabel"},suggestionsAriaLabel:{defaultMessage:"{count, plural, one {1 suggestion} other {{count} suggestions}}",id:"comments.components.discussionindicator.suggestionAriaLabel"},reactionsAriaLabel:{defaultMessage:"{count, plural, one {1 reaction} other {{count} reactions}}",id:"comments.components.discussionindicator.reactionsAriaLabel"}});function Wt(e){const t=(0,f().tz)(),{store:n,propertyId:i,style:s}=e,{showIndicator:r,formattedReactionCount:l,onlySuggestions:c,icon:m,showReactionsIcon:p,onlyHasDraftIndicator:g,formattedCommentCount:h,handleClick:S,discussionIsSelected:x,commentsCount:b,shouldShowDraftIndicator:y}=(0,o(446944).A)({store:n,recursivelyLoadAllDiscussions:!1,onlyCountBlockLevelDiscussions:!1,propertyId:i}),C=(0,u().IS)((e=>({iconButton:{background:x?e.selectLightGray[100]:void 0,gap:2,alignSelf:"center"},icon:{width:Ut().Ev.sm,height:Ut().Ev.sm,color:e.text.tertiary},commentCaptionStyle:{fontWeight:v().Wy.semibold,...y?{color:e.icon.tertiary}:{color:e.text.tertiary,marginBottom:1}},reactionCaptionStyle:{fontWeight:v().Wy.semibold,color:e.text.tertiary}})),[x,y]),k=(0,a().v3)(),A=(0,d().K8)((()=>(0,Kt().me)(k)),[k]),w=(0,d().K8)((()=>(0,Ht().dC)(k,n)),[k,n]),{isPropertyInPageDetails:M}=(0,o(517223)._1)({store:n,propertyId:i});return!r||!M&&(A||w)?null:(0,Ie.jsxs)(zt().Ye,{style:s,children:[b>0||g?(0,Ie.jsx)(zt().Ye,{style:{position:"relative"},children:(0,Ie.jsx)(Ft().A,{ariaLabel:c?t.formatMessage(Vt.suggestionsAriaLabel,{count:h}):t.formatMessage(Vt.commentsAriaLabel,{count:h}),icon:e=>(0,Ie.jsxs)(Ie.Fragment,{children:[m(e),y?(0,Ie.jsx)(o(254131).l,{color:"yellow",useOnPropertyComment:!0}):void 0]}),style:C.iconButton,iconStyle:C.icon,onClick:S,caption:h,captionStyle:C.commentCaptionStyle})}):void 0,p?(0,Ie.jsx)(Ft().A,{ariaLabel:t.formatMessage(Vt.reactionsAriaLabel,{count:l}),icon:o(709837).emojiFaceSmallIcon,style:C.iconButton,iconStyle:C.icon,onClick:S,captionStyle:C.reactionCaptionStyle,caption:l}):void 0]})}const Nt=i.memo(Wt);var Ot=()=>o(747100),$t=()=>o(496506),Jt=()=>o(969842),Yt=()=>o(94953),Gt=()=>o(116008),Zt=()=>o(563884),Qt=()=>o(715862),qt=()=>o(125565),Xt=()=>o(659799),eo=()=>o(907514),to=()=>o(870092),oo=()=>o(938045);function no({discussionData:{groupedDiscussionsData:e,newDiscussionData:t,id:o},onClick:n}){const[s,r]=(0,i.useState)(!1),l=(0,a().v3)(),c=l.currentUser.id,m=(0,i.useCallback)((()=>{r(!0)}),[]),p=(0,i.useCallback)((()=>{r(!1)}),[]),g=t,h=(0,i.useCallback)((async o=>{if(g){const e=ye().default.state.mainEditorCurrentBlockStore;V().A.setActiveWithSource("margin_comments"),await(0,oo().x)({currentBlockStore:e,discussionInputStore:t.discussionInputStore,environment:l})}else if(e.length>0){const t=e[0].discussionStore;await n(o,t)}}),[g,e,null==t?void 0:t.discussionInputStore,l,n]),{commentStores:S,reactionStores:x}=(0,d().K8)((()=>{if(e){return{commentStores:e.flatMap((e=>(0,I().wc)(e.discussionStore))),reactionStores:e.flatMap((e=>T().L.getUserVisibleReactions(e.discussionStore)))}}return{commentStores:[],reactionStores:[]}}),[e]),b=(0,d().K8)((()=>{let o;if(g&&(o=t.parentBlockStore),e.length>0&&(o=e[0].parentBlockStore),!o)return;const n=S.map((e=>e.getCreatedById())).filter(se().O9),i=x.map((e=>e.getActorPointers().map((e=>e.id)))).flat().filter(se().O9);return Array.from(new Set([...n,...i,...g&&c?[c]:[]])).map((e=>to().L.createChildStore(o,{table:ne().oo,id:e}))).slice(0,5)}),[e,g,S,x,c,null==t?void 0:t.parentBlockStore]),y=(0,d().K8)((()=>{const e=S.map((e=>e.getLastEditedTime())),t=x.map((e=>e.getCreatedTime()));return Math.max(...e,...t)}),[S,x]),C=(0,d().K8)((()=>e.map((e=>e.discussionStore)).some((e=>{var t;return(0,mt().s)({discussionStore:e,navigableBlockStore:null===(t=e.getParentStore())||void 0===t?void 0:t.getNavigableBlockStore()})}))),[e]),A=(0,u().IS)((e=>({discussion:{background:s?e.hoveredMarginDiscussionBackground:e.background.primary,width:Ht().JC,display:"flex",cursor:"pointer",border:`1px solid ${e.border.secondary}`,borderRadius:10,padding:"12px",alignItems:"center",gap:6},userAvatarsContainer:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"row-reverse",marginInlineEnd:8},lastEditedTime:{marginTop:1,marginInlineEnd:0,marginBottom:0,marginInlineStart:0,whiteSpace:"normal",display:"flex",justifyContent:"center",alignItems:"center",color:e.text.tertiary,fontSize:12,lineHeight:"15px"},commentAuthorAvatarStyle:{borderRadius:20,position:"relative",userSelect:"none",WebkitUserSelect:"none",width:24,height:24,marginInlineEnd:-6},secondaryLabel:{fontSize:v().J.UISmall.desktop,whiteSpace:"normal",display:"flex",justifyContent:"center",alignItems:"center",lineHeight:"21px",marginInlineStart:0,marginTop:0,color:e.text.tertiary},expandIcon:{width:v().J.UISmall.desktop,height:v().J.UISmall.desktop,fill:e.text.tertiary,marginTop:1},expandDiv:{display:"flex",justifyContent:"center",alignItems:"center",marginInlineStart:0},unreadStatusDot:{display:"flex",alignItems:"center",marginInlineEnd:4,marginInlineStart:"auto"}})),[s]),w=(0,Ie.jsx)("div",{style:A.secondaryLabel,children:(0,Ie.jsx)(f().sA,{defaultMessage:"Draft",id:"marginComments.collapsed.draft.label"})}),j=(0,Ie.jsxs)(Ie.Fragment,{children:[(0,Ie.jsx)("div",{style:A.expandDiv,children:(0,Qt().e)(A.expandIcon)}),g?w:(0,Ie.jsx)("div",{style:A.secondaryLabel,children:(0,Ie.jsx)(f().sA,{defaultMessage:"Expand",id:"marginComments.collapsed.expand.label"})})]}),L=g?w:y&&(0,Ie.jsx)(qt().A,{isSmall:!0,isSecondaryColor:!0,isMultiline:!0,style:A.lastEditedTime,children:(0,Ie.jsx)(Xt().A,{text:(0,eo().nl)(y,{useUltraCompactFormat:!0}),tooltipText:(0,eo().x$)(y),icon:Zt().k})});return(0,Ie.jsxs)("div",{style:A.discussion,onMouseEnter:m,onMouseLeave:p,onClick:h,className:fe().OO1,children:[(0,Ie.jsx)("div",{style:A.userAvatarsContainer,children:null==b?void 0:b.map((e=>(0,Ie.jsx)(Ct().E,{authorStore:e,avatarSize:24,avatarStyle:A.commentAuthorAvatarStyle},e.id)))}),(0,Ie.jsx)(io,{reactionCount:x.length,commentCount:S.length+(g?1:0)}),s?j:L,C?(0,Ie.jsx)("div",{style:A.unreadStatusDot,children:(0,Ie.jsx)(M().m,{size:k().jd})}):void 0]})}function io(e){const t=(0,u().IS)((e=>({commentCount:{fontSize:14,whiteSpace:"normal",marginInlineStart:0,color:e.text.primary,fontWeight:v().Wy.medium,lineHeight:"18px"},textPlaceholder:{background:e.lightDividerColor,height:14,width:81,borderRadius:4,marginInlineStart:4}})),[]);return e.commentCount>0?(0,Ie.jsx)("div",{style:t.commentCount,children:(0,Ie.jsx)(f().sA,{defaultMessage:"{numComments, plural, one {{numComments} comment} other {{numComments} comments}}",id:"marginComments.collapsed.numComments.count",values:{numComments:e.commentCount}})}):e.reactionCount>0?(0,Ie.jsx)("div",{style:t.commentCount,children:(0,Ie.jsx)(f().sA,{defaultMessage:"{numReactions, plural, one {{numReactions} reaction} other {{numReactions} reactions}}",id:"marginComments.collapsed.numReactions.count",values:{numReactions:e.reactionCount}})}):(0,Ie.jsx)("div",{style:t.textPlaceholder})}var so=()=>o(833744),ro=()=>o(211419),ao=()=>o(862292),lo=()=>o(441467);function co({discussionData:{parentBlockStore:e,discussionInputStore:t},isVisible:o}){const n=(0,i.useRef)(null),s=(0,a().v3)(),r=(0,i.useCallback)((async()=>{const e=await ao().T.formulas.load();lo().i5({environment:s,allowActionsWhileCommenting:!0,formulasModule:e})}),[s]),l=(0,d().K8)((()=>t.isEmpty()),[t]),c=(0,i.useCallback)((()=>{V().A.setActiveWithSource("margin_comments")}),[]),m=(0,i.useCallback)((()=>{V().A.resetActiveSource("margin_comments")}),[]),p=(0,i.useCallback)((()=>{l&&Gt().A.reset(),V().A.resetEditorActiveSources()}),[l]),g=(0,i.useCallback)((()=>{V().A.setHoverWithSource("margin_comments")}),[]),h=(0,i.useCallback)((()=>{V().A.resetHoverSource("margin_comments")}),[]),f=(0,i.useMemo)((()=>[`.${ro().hq}`]),[]),v=(0,d().K8)((()=>V().A.state.isActivelyComposing),[]),S=(0,d().K8)((()=>V().A.state.isHovered&&!V().A.state.isActivelyComposing),[]),x=Boolean(v||l);(0,so().L)({active:o&&x,closeHandler:p,ref:n,excludedSelectors:f,ignoreKeydown:!0});const b=(0,u().IS)((e=>({discussion:{borderRadius:10,...v?{boxShadow:e.shadowSM}:{border:`1px solid ${e.lightDividerColor}`},width:Ht().JC,background:e.selectedMarginDiscussionBackground,willChange:"transform",transition:"transform 200ms ease",transform:v?"translateX(calc(var(--direction, 1) * -20px))":S?"translateX(calc(var(--direction, 1) * -5px))":void 0},discussionInputContainer:{borderRadius:6,paddingTop:8,paddingInlineEnd:8,paddingBottom:4,paddingInlineStart:12,backgroundColor:S?e.hoveredMarginDiscussionBackground:void 0}})),[v,S]);return(0,Ie.jsx)("div",{style:b.discussion,ref:n,className:fe().OO1,onMouseEnter:g,onMouseLeave:h,children:(0,Ie.jsx)(ot().A,{parentStore:e,discussionInputStore:t,shouldSaveUnsentComments:!1,isMobileSlideUpMenu:!1,discussionFormat:F().DiscussionFormat.Margin,onSubmit:r,onCancel:p,isNewComment:!0,blockStore:e,canDrop:!0,showAvatar:!1,containerStyle:b.discussionInputContainer,showCtaButtons:!0,onFocus:c,onBlur:m})})}function uo({discussionData:{discussionStore:e,parentBlockStore:t},timeMounted:n,onClick:s,isVisible:r,isDiscussionSelected:l,isDiscussionHovered:c}){const m=(0,i.useRef)(null),p=(0,a().v3)(),[g,h]=(0,i.useState)((()=>new(H().A)(p,e.pointer.spaceId))),f=(0,o(59226).X)("block_reactions"),v=e.id,x=(0,i.useRef)(void 0),[b,y]=(0,i.useState)(!1);(0,i.useEffect)((()=>{l&&(x.current=(0,mt().s)({discussionStore:e,navigableBlockStore:t.getNavigableBlockStore()}))}),[e,l,t]);const C=(0,i.useCallback)((()=>{y(!0);const e=setTimeout((()=>{y(!1)}),750);return()=>clearTimeout(e)}),[]);(0,i.useEffect)((()=>{const e=m.current;if(e)return e.addEventListener("flash-halo",C),()=>{e.removeEventListener("flash-halo",C)}}),[C]);const k=(0,d().K8)((()=>e.getCommentStores().length>0),[e]),A=(0,d().K8)((()=>e.getReactionStores().length>0),[e]),w=(0,i.useMemo)((()=>[`.${(0,o(451306).wV)({discussionId:v})}`,`.${ro().hq}`,`.${fe().OO1}`]),[v]),M=(0,i.useCallback)((async()=>{const t=L().A.find((e=>e.isEditing()));if(t){if(!(await t.handleCancelEdit()))return}x.current&&(0,Ce().X)({environment:p,discussionStores:[e]}),S().xl()}),[e,p]);(0,so().L)({active:r&&l,closeHandler:M,ref:m,excludedSelectors:w,ignoreKeydown:!0});const I=(0,i.useCallback)((async t=>{var o;l||(re().E9(p,{discussion_id:e.id,discussion_type:e.getType(),from:"margin_comments",parent_block_id:e.getParentId(),parent_collection_id:null===(o=e.getParentStore())||void 0===o?void 0:o.getParentCollectionIdUpToTwoLevels()}),await s(t,e))}),[s,e,l,p]),j=(0,u().IS)((e=>({discussion:{border:l?void 0:`1px solid ${e.lightDividerColor}`,borderRadius:10,padding:l?"1px":void 0,background:b?o(100622).IF.blueWithAlpha(.14):l?e.selectedMarginDiscussionBackground:c?e.hoveredMarginDiscussionBackground:e.background.primary,boxShadow:l?e.shadowSM:void 0,width:Ht().JC,cursor:l?void 0:"pointer",transition:"background-color 200ms ease"},wrapper:{willChange:"transform",transition:"transform 200ms ease",transform:l?"translateX(calc(var(--direction, 1) * -20px))":c?"translateX(calc(var(--direction, 1) * -5px))":void 0}})),[c,l,b]);return(0,Ie.jsxs)("div",{className:fe().OO1,ref:m,style:j.wrapper,onClick:I,children:[A&&f?(0,Ie.jsx)("div",{style:{width:Ht().JC},children:(0,Ie.jsx)(Me().tx,{focused:l,parentStore:e,discussionLocation:"margin_comments"})}):void 0,k?(0,Ie.jsx)("div",{style:j.discussion,children:(0,Ie.jsx)(Pt,{store:e,blockStore:t,format:F().DiscussionFormat.Margin,isFirst:!1,isOnly:!1,showResolveButtonByDefaultIfPossible:!1,discussionLocation:"margin_comments",showAllRepliesAfterTimestamp:n,discussionInputStore:g,collapsed:!l})}):void 0]})}const mo=i.memo(uo);function po(e){const{discussionData:t,isLastItem:o,isDiscussionSelected:n,discussionItemElementMap:s}=e,r=(0,d().K8)((()=>!matchMedia("(prefers-reduced-motion: reduce)").matches),[]),l=(0,u().IS)((()=>{const e=r?"opacity 200ms ease-in-out, top 350ms ease":"opacity 200ms ease-in-out";return{discussionContainer:{transition:t.hide?void 0:e,top:t.offsetTop,position:"absolute",paddingBottom:o?Ht().t_:Ht().kH,zIndex:n?1:void 0,opacity:t.hide?0:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",pointerEvents:"auto"}}}),[t.hide,t.offsetTop,n,o,r]);let c;const m=t.type,p=(0,a().v3)(),g=(0,d().K8)((()=>(0,Ht().$N)(p,t.parentBlockStore)),[p,t.parentBlockStore]),h=(0,i.useCallback)((()=>{Yt().A.setState({source:"margin_comments",discussionIds:[t.id]})}),[t.id]),f=(0,i.useCallback)((()=>{Yt().A.setState({discussionIds:[]})}),[]),v=(0,i.useCallback)((e=>{s.set(t.id,e)}),[t.id,s]);return g?"existing"===m?c=(0,Ie.jsx)(mo,{...e,discussionData:t}):"new"===m?c=(0,Ie.jsx)(co,{...e,discussionData:t}):"grouped"===m?c=(0,Ie.jsx)(no,{...e,discussionData:t}):(0,se().HB)(m):c=null,(0,Ie.jsx)("div",{style:l.discussionContainer,onMouseEnter:h,onMouseLeave:f,ref:v,children:c})}const go=i.memo(po),ho=`.${Jt().iU}, .${Jt().F0}, .${Jt().te}`;function fo({pageBlockStore:e,timeMounted:t,isVisible:n,animating:s,pageViewBlockAccessor:r,width:l,context:c}){const m=(0,a().v3)(),p=(0,a().Y0)(),g=(0,i.useRef)(null),h=(0,i.useRef)(new Map),f=(0,i.useRef)(new Map),v=(0,d().K8)((()=>Yt().A.getFirstSelectedDiscussionId()),[]),S=(0,i.useCallback)((async(t,n)=>{var i;(0,o(616068).Z)()||t.target instanceof Element&&t.target.closest(ho)||await P().DZ({discussionStore:n,currentBlockStore:e,environment:m,analyticsFrom:"margin_comments",currentEl:g.current,animateScroll:!0,discussionReadStatus:(0,mt().g)({discussionStore:n,navigableBlockStore:null===(i=n.getParentStore())||void 0===i?void 0:i.getNavigableBlockStore()})})}),[e,m]),[x,b]=(0,i.useState)({data:[],hasNewDiscussion:!1,selectedDiscussion:void 0}),[y,C]=(0,i.useState)(!1),{WindowSizeStore:k}=m,A=o(175947).ek(m.device.isElectronMac),w=(0,d().K8)((()=>!matchMedia("(prefers-reduced-motion: reduce)").matches),[]);(0,i.useEffect)((()=>{if(!n)return;const t=new($t().ComputedStore)((()=>({selectableRectMap:o(666710).default.state.selectableRectMap,pageContentStores:e.getContentStores(),sidebarIsAnimating:o(737230).Ay.state.isAnimating,windowHeight:k.state.height})),{debugName:"effectDataStore"}),i=new($t().ComputedStore)((()=>Ht().Ob.state),{debugName:"discussionStoresStore"}),a=new($t().ComputedStore)((()=>{const e=Gt().A.state,t=Gt().A.getBlockStore(),n=Gt().A.getClosestBlockStore();if(e.open&&e.rect&&"comment"===e.content&&(t||n)&&(!t||o(489348).A.isBlockInFrame(t)&&!e.property_id))return{recomputeFocus:V().A.state.isActivelyComposing,blockStore:t??e.blockStore,discussionInputStore:e.discussionInputStore}}),{debugName:"newMarginDiscussionArgsStore"}),l=new($t().ComputedStore)((()=>{if(!V().A.state.isActivelyComposing)return B().A.getFramePageFirstSelectedDiscussionId();B().A.reset()}),{debugName:"selectedDiscussionIdStore"});let d=!1;const u=(0,ie().sg)((()=>{const{selectableRectMap:o,pageContentStores:n,sidebarIsAnimating:u,windowHeight:m}=t.state,v=i.state,S=a.state,k=l.state;if(s||u)return;const M=r();if(!(M&&g.current&&o&&o.size))return;(0,Ht().cY)({discussionStores:v,pageContentStores:n,marginDiscussionItemRefs:h.current,selectedDiscussionId:k,newMarginDiscussionArgs:S,marginContainerElement:g.current,pageViewBlockElement:M,onComputeComplete:(e,t)=>{d||(f.current=t,y||C(!0),b(e))},computedOnce:y,topbarHeight:A,windowHeight:m,isFullWidth:(0,at().Ck)(e,c,p),prevSelectedDiscussionId:x.selectedDiscussion,previousDiscussionElements:f.current,ignoreOffsetTop:w})}),5);return t.addListener(u),i.addListener(u),l.addListener(u),a.addListener(u),()=>{d=!0,t.removeListener(u),i.removeListener(u),l.removeListener(u),a.removeListener(u)}}),[n,s,r,y,e,x.selectedDiscussion,k,A,m,c,p,w]);const M=(0,u().IS)((()=>({marginCommentsContainer:{display:"flex",flexDirection:"column",paddingTop:8,paddingBottom:8,paddingInlineStart:Ht().JR,paddingInlineEnd:Ht().JR,width:l-2*Ht().JR,flexShrink:0,height:"100%",position:"relative",pointerEvents:"none",zIndex:1}})),[l]);return(0,Ie.jsx)("div",{style:M.marginCommentsContainer,ref:g,children:x.data.map(((e,o)=>(0,Ie.jsx)(go,{discussionData:e,timeMounted:t,onClick:S,isVisible:n,discussionItemElementMap:h.current,isDiscussionSelected:e.selected||"new"===e.type,isDiscussionHovered:e.id===v,isLastItem:o===x.data.length-1},`margin-discussion-${e.id}`)))})}const vo=i.memo(fo);function So({pageBlockStore:e,isVisible:t,pageViewBlockAccessor:o,context:n,isCollapsedAnchor:s}){const[r,l]=(0,i.useState)(!1),c=(0,a().v3)(),m=(0,a().Y0)(),p=(0,i.useMemo)((()=>(new Date).getTime()),[]),g=(0,d().K8)((()=>{const t=(0,at().Ck)(e,n,m);return s?{paddingInlineStart:t?96:16,height:0}:t?void 0:{position:"absolute",insetInlineEnd:(0,Ht().gg)(c,(0,Ot().cq)(e),(0,Ot().RX)(e))}}),[e,n,c,m,s]),h=(0,i.useCallback)((()=>{l(!0)}),[]),f=(0,i.useCallback)((()=>{l(!1)}),[]),v=(0,u().IS)((()=>({marginCommentsSection:{display:t||r?"flex":"none",flexShrink:0,pointerEvents:"none",width:t?Ht().Qb:0,...g}})),[t,r,g]);return(0,Ie.jsx)(de().A,{animate:{opacity:t?1:0},onAnimationStart:h,onAnimationEnd:f,style:v.marginCommentsSection,children:(0,Ie.jsx)(vo,{pageBlockStore:e,timeMounted:p,isVisible:t,animating:r,pageViewBlockAccessor:o,width:Ht().Qb,context:n})})}var xo=()=>o(988083),bo=()=>o(30537),yo=()=>o(297872),Co=()=>o(417392),ko=()=>o(13679);const Ao=function(e){const{capture:t,children:n}=e,s=(0,i.useRef)(null);return(0,c().b)(o(536612).A,(()=>({getNode:()=>s.current,isCaptured:()=>t})),[t]),(0,Ie.jsx)("div",{ref:s,children:i.Children.only(n)})};var wo=()=>o(691298),Mo=()=>o(405981);function Io({blockStore:e,discussionInputStore:t,handleDismiss:o}){const n=(0,a().v3)(),{device:s,WindowSizeStore:r}=n,l=(0,i.useCallback)((async()=>{const e=await ao().T.formulas.load();lo().i5({environment:n,allowActionsWhileCommenting:!0,formulasModule:e})}),[n]),c=(0,d().K8)((()=>xo().A.keyboardHeight()>0),[]),m=(0,d().K8)((()=>{const e=s.isAndroid?12:8;return{paddingLeft:r.getSafePaddingLeftCSS(12),paddingRight:r.getSafePaddingRightCSS(8),paddingBottom:c?e:r.getSafePaddingBottomCSS(e)}}),[r,c,s.isAndroid]),p=(0,d().K8)((()=>s.isMobileBrowser?"90vw":s.isTablet?"470px":"100%"),[s]),g=(0,d().K8)((()=>s.isMobileNative&&s.isPhone?"100%":s.isMobileNative&&s.isTablet?"470px":470),[s]),h=(0,u().IS)((()=>({inputWrapper:{width:g,maxWidth:p,paddingTop:9,paddingInlineStart:m.paddingLeft,paddingInlineEnd:m.paddingRight,paddingBottom:m.paddingBottom}})),[g,p,m]);return(0,wo().A)({shouldPreserveTextSelection:!0,shouldPreserveBlockSelection:!0,shouldRestoreSelection:!0}),(0,Ie.jsx)(yo().A,{capture:!0,allowOpenLinkMenu:!0,render:()=>(0,Ie.jsx)(ko().A,{store:e,droppable:!0,render:()=>(0,Ie.jsx)(Ao,{capture:!0,children:(0,Ie.jsx)("div",{style:h.inputWrapper,children:(0,Ie.jsx)(ot().A,{showAvatar:!0,parentStore:e,onCancel:o,onSubmit:l,discussionInputStore:t,isMobileSlideUpMenu:!0,shouldSaveUnsentComments:!1,discussionFormat:F().DiscussionFormat.Page,blockStore:e,canDrop:!0})})})},e.id)})}const jo=function(){const e=(0,a().v3)(),t=(0,a().WS)(),n=(0,d().K8)((()=>Gt().A.state.rect),[]),s=(0,d().K8)((()=>{if(Gt().A.state.open&&"comment"===Gt().A.state.content){const{discussionInputStore:o}=Gt().A.state;if((0,Kt().me)(e))return null;if(Gt().A.updateRect(),V().A.state.isActivelyComposing){"comments_pane"===V().A.state.clickEntryPoint&&V().A.setActiveWithSource("popover_comments");const n=Gt().A.getBlockStore();var t;if(n)return{blockStore:n,discussionInputStore:o,canMarginCommentsRender:!(null!==(t=Gt().A.state)&&void 0!==t&&t.property_id)&&(0,Ht().$N)(e,n)}}}return null}),[e]),r=(0,i.useCallback)((()=>{const t=null==s?void 0:s.discussionInputStore;t&&(0,o(36088).M)({discussionInputStore:t,environment:e})}),[e,null==s?void 0:s.discussionInputStore]),l=(0,i.useCallback)((()=>{Gt().A.hasContent()?V().A.resetEditorActiveSources():s&&(0,o(681634).c)(e)}),[e,s]);(0,i.useEffect)((()=>{function t(t){const o=Gt().A.state,n=o.open&&"comment"===o.content&&o.discussionInputStore||void 0;n&&((0,Mo().HR)({discussionInputStore:n,environment:e,discussionHelpers:F()}),t.preventDefault())}return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}}),[e]);const c=(0,d().K8)((()=>o(543886).A.state.isOpen),[]);return(0,d().K8)((()=>V().A.state.overlapsExistingDiscussionMenu),[])?null:(0,Ie.jsx)(Co().Ay,{popupType:t?bo().n.SlideUp:bo().n.Popup,keepFocus:!0,open:null!==s&&(!s.canMarginCommentsRender||c),originRect:n,placementToOrigin:"bottom",alignmentToOrigin:"center",originGap:4,onDismiss:l,render:()=>s?(0,Ie.jsx)(Io,{blockStore:s.blockStore,discussionInputStore:s.discussionInputStore,handleDismiss:l}):null,onAnimationEnd:r})};var Lo=()=>o(779315),Do=()=>o(297813),Bo=()=>o(21510);const Ro=function(){const e=(0,a().v3)(),t=(0,a().Y0)(),{open:o,rect:n,discussionLocation:i}=(0,d().K8)((()=>{const{open:e,rect:t}=Bo().A.state;return{open:e,rect:t,discussionLocation:Bo().A.state.open?Bo().A.state.discussionLocation:Bo().A.state.prevDiscussionLocation}}),[]),{popupType:s,bottomSheetInitialState:r}=function(e){if(!e.device.isPhone)return{popupType:bo().n.Popup,bottomSheetInitialState:void 0};return{popupType:bo().n.BottomSheet,bottomSheetInitialState:"full"}}({device:t,discussionLocation:i});return(0,Ie.jsx)(Co().Ay,{popupType:s,bottomSheetInitialState:r,bottomSheetBackgroundColor:s===bo().n.BottomSheet?"primary":void 0,open:o,originRect:n,placementToOrigin:"bottom",alignmentToOrigin:"center",originGap:4,onDismiss:()=>(0,E().o)(e),render:()=>(0,Ie.jsx)(_o,{}),trapFocus:!0})};function _o(){const e=(0,a().v3)(),t=(0,f().tz)(),o=(0,d().O$)(Bo().A),n=(0,d().K8)((()=>Bo().A.state.open?Bo().A.state.discussionInputStore.state.textStore.getValue():null),[]),r=(0,u().IS)((e=>({closeButton:{position:"absolute",insetInlineEnd:10,borderRadius:"50%",background:e.background.tertiaryTranslucent}})),[]);if((0,i.useEffect)((()=>{var e;if(o.open&&"feed_item_top_level_discussion"===o.discussionLocation)return;const t=null===(e=Lo().A.MenuScroller)||void 0===e?void 0:e.getNode();null==t||t.scrollTo({top:t.scrollHeight})}),[n,o]),o.open){const{discussionStore:n,discussionInputStore:i,blockStore:a,discussionLocation:l}=o;let c;return c=s().A.isMobile?{menuType:ve().gu.Modal,title:(0,Ie.jsx)(f().sA,{defaultMessage:"Discussion",id:"discussion.mobileReplyMenu.title"}),right:(0,Ie.jsx)(Ft().A,{icon:Do().xMarkFillIcon,onClick:()=>(0,E().o)(e),style:r.closeButton,ariaLabel:t.formatMessage({id:"updateSidebar.header.closeLabel",defaultMessage:"Close"})}),onClickRight:()=>(0,E().o)(e),whiteBackground:!0}:{menuType:ve().gu.Popup,width:420,minHeight:"100px",maxHeight:"50vh",maxWidth:"100%"},(0,Ie.jsx)(pe().A,{className:fe()._qG,...c,children:(0,Ie.jsx)(yo().A,{capture:!0,allowMobileAutoScroll:!0,render:()=>(0,Ie.jsx)(Pt,{store:n,discussionInputStore:i,onDismiss:()=>(0,E().o)(e),format:F().DiscussionFormat.Menu,isFirst:!0,isOnly:!0,showResolveButtonByDefaultIfPossible:!0,blockStore:a,collapsed:!1,..."feed_item_top_level_discussion"===l?{pageVisitStore:void 0,presenceStore:void 0,discussionLocation:"feed_item_top_level_discussion"}:{discussionLocation:l}})})})}return null}var To=()=>o(165492),Po=()=>o(22426),Eo=()=>o(528787)},709438:(e,t,o)=>{o.d(t,{m:()=>a});o(296540);var n=()=>o(401497),i=()=>o(69708),s=o(474848);const r=8;function a({color:e,size:t,style:o}){const a=(0,i().tz)(),l=(0,n().IS)((n=>({dot:{height:t||r,width:t||r,background:e||n.blue.icon.accentPrimary,flexShrink:0,borderRadius:"100%",pointerEvents:"none",...o}})),[t,e,o]);return(0,s.jsx)("div",{role:"img","aria-label":a.formatMessage({id:"statusDot.ariaLabel",defaultMessage:"New"}),style:l.dot})}},715862:(e,t,o)=>{o.d(t,{e:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("expand",{viewBox:"-1 -1 9 11",svg:(0,n.jsx)("path",{id:"path0_stroke",d:"M 3.5 0L 3.98809 -0.569442L 3.5 -0.987808L 3.01191 -0.569442L 3.5 0ZM 3.5 9L 3.01191 9.56944L 3.5 9.98781L 3.98809 9.56944L 3.5 9ZM 0.488094 3.56944L 3.98809 0.569442L 3.01191 -0.569442L -0.488094 2.43056L 0.488094 3.56944ZM 3.01191 0.569442L 6.51191 3.56944L 7.48809 2.43056L 3.98809 -0.569442L 3.01191 0.569442ZM -0.488094 6.56944L 3.01191 9.56944L 3.98809 8.43056L 0.488094 5.43056L -0.488094 6.56944ZM 3.98809 9.56944L 7.48809 6.56944L 6.51191 5.43056L 3.01191 8.43056L 3.98809 9.56944Z"})})},753397:(e,t,o)=>{o.d(t,{JN:()=>d,QB:()=>s,Sx:()=>r,Wt:()=>c,hR:()=>l,pT:()=>a,rU:()=>u});var n=()=>o(858038),i=()=>o(645873);const s=(0,i()._h)(n().U,(e=>e.GetNotifiedFor)),r=(0,i()._h)(n().U,(e=>e.UpdateSidebar)),a=(0,i()._h)(n().U,(e=>e.MobileInboxPopup)),l=(0,i()._h)(n().U,(e=>e.InboxActionsMenu)),c=(0,i()._h)(n().U,(e=>e.UnreadMentionsBadge)),d=(0,i()._h)(n().U,(e=>e.NotificationInboxPanelContent)),u=(0,i()._h)(n().U,(e=>e.AnimatedEmojiBadge))},780863:(e,t,o)=>{o.d(t,{p:()=>l});var n=o(296540),i=()=>o(40845),s=()=>o(496603),r=()=>o(778417);const a={isRepositioning:!1};function l(e){const{currentPosition:t,imageUrl:o,onSavePosition:l,onPositionChange:c,rootRef:d,environment:u}=e,[m,p]=(0,n.useState)(a),{isRepositioning:g}=m,h=(0,n.useCallback)((()=>{p(a)}),[]),f=(0,n.useMemo)((()=>void 0!==m.temporaryPosition?m.temporaryPosition:t),[m.temporaryPosition,t]);(0,n.useEffect)((()=>{c&&c(f)}),[f,c]);const v=(0,n.useCallback)((e=>{r().IU({environment:u});const t=new Image;t.onload=()=>{p((e=>({...e,isRepositioning:!0,image:t})))};const n=e||o;n&&(t.src=n)}),[u,o]),S=(0,n.useCallback)((()=>{l(f),h()}),[l,f,h]),x=(0,n.useCallback)((()=>{h()}),[h]);(0,n.useEffect)((()=>{const e=e=>{const t=d.current;t&&e.target instanceof Node&&!t.contains(e.target)&&g&&S()};return g&&window.addEventListener("mousedown",e),()=>{window.removeEventListener("mousedown",e)}}),[g,S,d]);const b=(0,n.useCallback)((e=>{const{image:t}=m;if(!t||!g)return;const o=d.current;if(o&&o instanceof Element){const e=o.getBoundingClientRect().width/t.width*t.height;p((t=>({...t,startDragImageScreenHeight:e,startDragRenderedPosition:f})))}}),[m,g,f,d]),y=(0,n.useCallback)((e=>{if(!g)return;const{startDragImageScreenHeight:t,startDragRenderedPosition:o}=m,n=e.diffY/(t||0)+(o||0);p((e=>({...e,temporaryPosition:(0,s().LI)((0,i().A)(n,0,1),4)})))}),[g,m]),C=(0,n.useCallback)((()=>{p((e=>({...e,startDragImageScreenHeight:void 0,startDragRenderedPosition:void 0})))}),[]),k=(0,n.useMemo)((()=>g?"ns-resize":"inherit"),[g]);return{isRepositioning:g,currentImagePosition:f,handleDragStart:b,handleDragMove:y,handleDragEnd:C,handleStartReposition:v,handleSavePosition:S,handleCancelReposition:x,repositioningCursor:k}}},801678:(e,t,o)=>{o.d(t,{A:()=>p});var n=o(296540),i=()=>o(662303),s=()=>o(56366),r=()=>o(69708),a=()=>o(100622),l=()=>o(496603),c=()=>o(284371),d=()=>o(720665),u=()=>o(145214),m=o(474848);const p=function(e){const t=(0,n.useRef)(null),i=(0,o(484714).v3)(),{renderControl:r,onFlushTemporaryPosition:a,style:c,source:u,store:p}=e,h=(0,s().K8)((()=>0===o(502438).default.state.stores.length),[]),[f,v]=(0,n.useState)(!1),S=(0,s().uB)(e.mouseStore,o(454305).A),x=(0,s().K8)((()=>S.state.mouseEntered),[S]),b=(0,s().K8)((()=>function(e,t){if("gallery"===e||"board"===e){const e=t.getFormat().card_cover_position;if((0,l().Et)(e))return e}const o=.5;if(t.isCollectionView()){const e=t.getCollectionStoreIfSingleSource();if(e){const t=e.getFormat().collection_cover_position;return(0,d().pN)(t)?o:t}}const n=t.getFormat(),i=n.page_cover_position;if((0,l().Et)(i))return i;return o}(u,p)),[u,p]),{isRepositioning:y,currentImagePosition:C,handleDragStart:k,handleDragMove:A,handleDragEnd:w,handleStartReposition:M,handleSavePosition:I,handleCancelReposition:j,repositioningCursor:L}=(0,o(780863).p)({currentPosition:b,onSavePosition:e=>{a({imagePosition:e,reset:()=>{S.reset()}})},rootRef:t,environment:i}),D=(0,o(401497).IS)((()=>({dragContainer:{width:"100%",cursor:L},container:{position:"relative",width:"100%",zIndex:1}})),[L]);y&&!h&&j();const B=(0,n.useMemo)((()=>(0,l().nF)((e=>{S.setState({...S.state,mouseEntered:!0})}),100)),[S]),R=(0,n.useMemo)((()=>(0,l().sg)((e=>{S.setState({...S.state,mouseEntered:!1})}),100)),[S]),_=(0,n.useCallback)(((e,t)=>{M(t)}),[M]),T=(0,n.useCallback)((e=>{I()}),[I]),P=(0,n.useCallback)((e=>{const t=e.target;void 0!==t&&t instanceof HTMLElement&&(0,o(819121).p)(t)&&v(!0)}),[]),E=(0,n.useCallback)((()=>{v(!0)}),[]),U=(0,s().K8)((()=>r({handleRepositionClick:_,handleSavePositionClick:T,handleCancelClick:j,isVisible:x||f||y,isRepositioning:y})),[_,T,j,f,y,x,r]),F=(0,o(79043).A)(Boolean(e.preventClickPropagation));return(0,m.jsxs)("div",{ref:t,onFocus:P,onBlur:E,onMouseEnter:B,onMouseMove:B,onMouseLeave:R,...F,...(0,o(451306).AH)(D.container,c),children:[(0,m.jsx)(o(603820).A,{onDraggableDragStart:k,onDraggableDragMove:A,onDraggableDragEnd:w,onDraggableDragCancel:w,disabled:!y,render:t=>(0,m.jsx)("div",{style:D.dragContainer,...t,children:e.render({imagePosition:C,isRepositioning:y})})}),(0,m.jsx)(g,{small:e.small,isRepositioning:y}),U]})};function g({small:e,isRepositioning:t}){if(e)return null;const o={background:a().IF.blackWithAlpha(.4),borderRadius:4,color:a().Tj.white,fontSize:12,fontFamily:c().vc(i().locale).sans,width:180,insetInlineStart:"calc(50% - 90px)",padding:"0.3em 1.5em 0.3em",pointerEvents:"none",position:"absolute",top:"calc(50% - 10px)",textAlign:"center"};return(0,m.jsx)(u().A,{visible:t,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:o,children:(0,m.jsx)(r().sA,{defaultMessage:"Drag image to reposition",id:"withImageRepositioning.dragImage.text"})})}},848401:(e,t,o)=>{o.d(t,{Ay:()=>p,mI:()=>u,vb:()=>m});o(296540);var n=()=>o(401497),i=()=>o(718827),s=()=>o(784892),r=()=>o(65767),a=()=>o(69708),l=()=>o(284371),c=o(474848);const d=(0,a().YK)({removeTokenLabel:{defaultMessage:"Remove {title}",id:"uiGenericToken.removeTokenLabel"},removeTokenLabelGeneric:{defaultMessage:"Remove Item",id:"uiGenericToken.removeTokenLabelGeneric"}}),u=s().NY,m={[s().NY.ExtremeSmall]:{height:12,fontSize:10,margin:"0 4px 0 0",marginEditState:"0 6px 0 0",closeIconSize:8,avatarSize:14},[s().NY.ExtraSmall]:{height:14,fontSize:12,margin:"0 6px 0 0",marginEditState:"0 6px 0 0",closeIconSize:8,avatarSize:14},[s().NY.Small]:{height:18,fontSize:12,margin:"0 6px 6px 0",marginEditState:"0 6px 6px 0",closeIconSize:8,avatarSize:16},[s().NY.CompactEssential]:{height:20,fontSize:14,margin:"0 10px 6px 0",marginEditState:"0 6px 6px 0",closeIconSize:8,avatarSize:20},[s().NY.Medium]:{height:20,fontSize:14,margin:"0 10px 6px 0",marginEditState:"0 6px 6px 0",closeIconSize:8,avatarSize:20},[s().NY.Inline]:{height:20,fontSize:14,closeIconSize:8,avatarSize:20,margin:"0 -5px 0 0",marginEditState:"0 6px 0 0"},[s().NY.Large]:{height:24,fontSize:16,margin:"0 8px 8px 0",marginEditState:"0 8px 8px 0",closeIconSize:10,avatarSize:24}};function p({avatarSize:e,format:t,isSingle:o,onClickRemove:s,renderAvatar:u,showRemoveButton:p,shouldShrink:g,style:h,title:f}){const v=(0,a().tz)(),{height:S,fontSize:x,margin:b,marginEditState:y,closeIconSize:C,avatarSize:k}=m[t],A=e??k,w=(0,n().IS)((()=>({root:{display:"flex",alignItems:"center",flexShrink:g?1:0,minWidth:0,height:S,borderRadius:6,fontSize:x,lineHeight:"120%",margin:o?0:p?y:b,...h}})),[x,S,o,b,y,g,p,h]);return(0,c.jsxs)("div",{style:w.root,children:[null==u?void 0:u(A),(0,c.jsx)("div",{className:"notranslate",style:{...l().RC},children:f}),p?(0,c.jsx)(i().Ay,{ariaLabel:void 0!==f?v.formatMessage(d.removeTokenLabel,{title:f}):v.formatMessage(d.removeTokenLabelGeneric),onClick:s,style:{display:"flex",alignItems:"center",justifyContent:"center",width:S,height:S,marginInlineStart:2,marginInlineEnd:2,flexGrow:0,flexShrink:0,borderRadius:6},children:(0,r().l)({width:C,height:C,opacity:.5})}):null]})}},848565:(e,t,o)=>{o.d(t,{FB:()=>m,JC:()=>g,Ql:()=>p,Wv:()=>s,Yz:()=>a,ds:()=>i,e4:()=>n,eQ:()=>r,im:()=>c,jw:()=>l,k2:()=>u,uG:()=>d});const n=8,i=10,s=8,r=24,a=6,l=1.5,c=(r-l)/2,d=r+a,u=`calc(100% + ${s+(n-a)-d}px)`,m=r+8,p=-16;function g(e,t,o){return t?20:"margin_comments"===e?12:"comment_unfurl"===e&&"start"===o?14:16}},858038:(e,t,o)=>{o.d(t,{U:()=>n});const n=new(o(645873).O2)("notifications",(()=>Promise.all([o.e(75134),o.e(99223),o.e(9773),o.e(36556),o.e(40537),o.e(55373),o.e(36192),o.e(71562),o.e(96346),o.e(44711),o.e(53321),o.e(90825),o.e(16471),o.e(37353),o.e(29151),o.e(87248),o.e(62475),o.e(3151),o.e(98629),o.e(49889),o.e(20108),o.e(22777),o.e(87249),o.e(71621),o.e(88924),o.e(92845),o.e(56369),o.e(5834),o.e(48486),o.e(2411),o.e(89296),o.e(46414),o.e(9294),o.e(11676),o.e(91256),o.e(40563),o.e(67494),o.e(44584),o.e(53141),o.e(4422),o.e(4330),o.e(55162),o.e(71003),o.e(55753),o.e(28866),o.e(22001),o.e(71386),o.e(4351),o.e(6331),o.e(69144),o.e(42660),o.e(55997),o.e(40828),o.e(12341),o.e(96402),o.e(84166),o.e(70359),o.e(29595),o.e(16448),o.e(10442),o.e(16434),o.e(45769),o.e(46080),o.e(75902),o.e(99809),o.e(58636),o.e(78405),o.e(33675),o.e(94562),o.e(65014),o.e(85553),o.e(9020),o.e(14388),o.e(52786),o.e(75332),o.e(6893)]).then(o.bind(o,485745))))},863522:(e,t,o)=>{o.d(t,{C:()=>s});o(296540);var n=o(474848);const i={viewBox:"0 0 20 20",fittedViewBox:"3.12 1.25 15.63 15.63",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M16.25 6.25a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5"}),(0,n.jsx)("path",{d:"M5.25 3.125h7.302a3.8 3.8 0 0 0 0 1.25H5.25a.875.875 0 0 0-.875.875v9.5c0 .483.392.875.875.875h9.5a.875.875 0 0 0 .875-.875V7.448a3.8 3.8 0 0 0 1.25 0v7.302a2.125 2.125 0 0 1-2.125 2.125h-9.5a2.125 2.125 0 0 1-2.125-2.125v-9.5c0-1.174.951-2.125 2.125-2.125"})]})},s=(0,o(340498).wt)("markUnread",i)},867772:(e,t,o)=>{o.d(t,{Ay:()=>l,Gi:()=>s,Wc:()=>n,pF:()=>r,vS:()=>i});const n="loadingLocalImage",i="uploading",s="downloading",r="loaded";class a extends(()=>o(757695))().Store{getInitialState(){return{loadingMode:r}}}const l=a},882262:(e,t,o)=>{o.d(t,{m:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"3.23 3.23 13.54 13.53",svg:(0,o(474848).jsx)("path",{d:"M4.485 8.86V5.369l4.073 4.073a.625.625 0 0 0 .884-.884L5.369 4.485h3.49a.625.625 0 1 0 0-1.25h-5a.625.625 0 0 0-.624.625v5a.625.625 0 0 0 1.25 0m10.146 6.655-4.07-4.07a.625.625 0 0 1 .884-.884l4.07 4.07V11.14a.625.625 0 1 1 1.25 0v5c0 .345-.28.625-.625.625h-5a.625.625 0 1 1 0-1.25z"})},i=(0,o(340498).wt)("arrowExpandDiagonal",n)},903047:(e,t,o)=>{o.d(t,{E:()=>i});var n=()=>o(401497);function i(e){const{size:t,style:o}=e;return(0,n().IS)((e=>({icon:{width:.6*t,height:.6*t,fill:e.text.secondary},iconContainer:{width:t,height:t,borderRadius:"100%",background:e.regularDividerColor,display:"flex",alignItems:"center",justifyContent:"center",...o}})),[t,o])}},934999:(e,t,o)=>{o.d(t,{B:()=>s});o(296540);var n=o(474848);const i={viewBox:"0 0 20 20",fittedViewBox:"3.12 3.12 13.75 13.76",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M8 9.875a.625.625 0 1 0 0 1.25h4a.625.625 0 1 0 0-1.25z"}),(0,n.jsx)("path",{d:"M3.125 4.75c0-.897.728-1.625 1.625-1.625h10.5c.898 0 1.625.728 1.625 1.625v1.57c0 .676-.413 1.256-1 1.5v7.43c0 .898-.727 1.625-1.625 1.625h-8.5a1.625 1.625 0 0 1-1.625-1.625V7.82c-.587-.244-1-.824-1-1.5zm11.5 3.195h-9.25v7.305c0 .207.168.375.375.375h8.5a.375.375 0 0 0 .375-.375zm1-1.625V4.75a.375.375 0 0 0-.375-.375H4.75a.375.375 0 0 0-.375.375v1.57c0 .205.164.372.369.375h10.512a.375.375 0 0 0 .369-.375"})]})},s=(0,o(340498).wt)("archiveBox",i)},965351:(e,t,o)=>{o.d(t,{Ay:()=>P,Lk:()=>T,fB:()=>D});o(581454);var n=o(296540),i=()=>o(484714),s=()=>o(56366),r=()=>o(401497),a=()=>o(934999),l=()=>o(454503),c=()=>o(895189),d=()=>o(863522),u=()=>o(340498),m=()=>o(69708),p=()=>o(534177),g=()=>o(953448),h=()=>o(572080),f=()=>o(231297),v=()=>o(760217),S=()=>o(406699),x=()=>o(285790),b=()=>o(404277),y=()=>o(939740),C=()=>o(89924),k=()=>o(859428),A=()=>o(125565),w=()=>o(722872),M=()=>o(12591),I=()=>o(538075),j=o(474848);const L=(0,m().YK)({changePageNotificationSettings:{defaultMessage:"Change page notification settings",id:"inboxActionsMenu.notificationSettings.tooltipMessage"},markUnread:{defaultMessage:"Mark this notification as unread",id:"inboxActionsMenu.markNotificationAsUnread.tooltipMessage"},markRead:{defaultMessage:"Mark this notification as read",id:"inboxActionsMenu.markNotificationAsRead.tooltipMessage"},archive:{defaultMessage:"Archive this notification",id:"inboxActionsMenu.handleArchive.tooltipMessage"},unarchive:{defaultMessage:"Unarchive",id:"inboxActionsMenu.handleUnarchive.tooltipMessage"}}),D=2,B=30-2*(D+1),R=36-2*(D+1);function _(e){const{notification:t,rootStore:p,onArchiveClicked:g,onUnarchiveClicked:v,onMarkAsReadClicked:b,onMarkAsUnreadClicked:y}=e,C=(0,i().v3)(),A=(0,i().Y0)(),w=(0,m().tz)(),_=(0,s().K8)((()=>!!t&&(0,o(814388).IF)(t.type)),[t]),P=(0,s().K8)((()=>{const e=null==t?void 0:t.navigable_block_id;if(e)return o(148832).B.createChildStore(p,{table:o(179034).ev,id:e})}),[p,t]),E=(0,s().K8)((()=>null==P?void 0:P.getFollowSettingsKey()),[P]),U=(0,s().K8)((()=>{if(!E)return[];if(!P)return[];return I().H8({followSettingsKey:E,environment:C,blockStore:P,from:"inbox"})}),[E,C,P]),F=_&&U.length>0,z=(0,s().K8)((()=>t.read?d().C:c().d),[t.read]),K=(0,n.useCallback)((e=>{t&&(g(),f().createAndCommit({userAction:"InboxActionsMenu.handleArchive",environment:C,canUndo:!0,perform:e=>{h().s4({notification:t,rootStore:p,transaction:e})}}))}),[C,t,g,p]),H=(0,n.useCallback)((e=>{t&&(v(),f().createAndCommit({userAction:"Activity.handleUnarchive",environment:C,canUndo:!0,perform:e=>{h().JV({notificationId:t.id,visited:!1,rootStore:p,transaction:e})}}))}),[C,t,v,p]),V=(0,n.useCallback)((e=>{t&&(t.read?y():b(),f().createAndCommit({userAction:"InboxActionsMenu.toggleNotificationReadStatus",environment:C,canUndo:!0,perform:e=>{h().ZB({notification:t,rootStore:p,transaction:e,read:!t.read})}}))}),[C,t,b,y,p]),W=(0,n.useCallback)((()=>{E&&P&&t&&o(848259).zP({environment:C,notificationId:t.id,pageId:P.pointer.id,isCurrentlyFollowing:(0,o(518773).A)(E).following,from:"inbox"})}),[C,P,E,t]),N=(0,r().IS)((e=>({container:{display:"flex",gap:1,height:"min-content",padding:D,borderWidth:A.isMobile?0:1,borderStyle:"solid",borderColor:e.border.primary,background:e.buttonGroupBackground,borderRadius:6,boxShadow:A.isMobile?void 0:"0px 2px 4px 0px rgba(22, 29, 27, 0.02)"},button:{height:A.isMobile?R:B,width:A.isMobile?R:B,borderRadius:4},icon:{fill:e.icon.secondary,padding:0,width:A.isMobile?u().lD.default:u().Ev.default,height:A.isMobile?u().lD.default:u().Ev.default}})),[A.isMobile]),O=(0,M().C)();return t.visited?(0,j.jsx)("div",{style:N.container,children:(0,j.jsx)(k().A,{renderTooltip:()=>w.formatMessage(L.unarchive),render:e=>(0,j.jsx)(x().A,{ariaLabel:w.formatMessage(L.unarchive),style:N.button,icon:l().arrowUTurnUpLeftIcon,iconStyle:N.icon,onClick:H,...e})})}):(0,j.jsxs)("div",{style:N.container,children:[F?(0,j.jsx)(k().A,{renderTooltip:()=>(0,j.jsx)(m().sA,{...L.changePageNotificationSettings}),render:e=>(0,j.jsx)(S().A,{style:O.popup,popupType:A.isMobile?S().z.SlideUp:S().z.Popup,alignmentToOrigin:"start",placementToOrigin:"bottom",render:e=>(0,j.jsx)(T,{blockStore:P,notification:t,handlers:{handleUnarchive:H,handleArchive:K,toggleNotificationReadStatus:V},closePopup:()=>e.close()}),renderOrigin:t=>(0,j.jsx)(x().A,{ariaLabel:w.formatMessage(L.changePageNotificationSettings),style:N.button,icon:o(104077).r,iconStyle:N.icon,...e,...(0,o(553965).A)(t,{onClick:()=>W()})})})},"pageNotificationSettings"):void 0,(0,j.jsx)(k().A,{renderTooltip:()=>w.formatMessage(t.read?L.markUnread:L.markRead),render:e=>(0,j.jsx)(x().A,{ariaLabel:w.formatMessage(t.read?L.markUnread:L.markRead),style:N.button,icon:z,iconStyle:N.icon,onClick:V,...e})},"markUnread"),(0,j.jsx)(k().A,{renderTooltip:()=>w.formatMessage(L.archive),render:e=>(0,j.jsx)(x().A,{ariaLabel:w.formatMessage(L.archive),style:N.button,icon:a().B,iconStyle:N.icon,onClick:K,...e})},"archive")]})}function T(e){const{blockStore:t,notification:o,handlers:n,closePopup:u}=e,{handleArchive:h,handleUnarchive:f,toggleNotificationReadStatus:S}=n,x=(0,i().v3)(),k=(0,i().Y0)(),D=(0,m().tz)(),B=(0,s().K8)((()=>null==t?void 0:t.getFollowSettingsKey()),[t]),R=(0,s().K8)((()=>{if(!B)return[];if(!t)return[];return I().H8({followSettingsKey:B,environment:x,blockStore:t,from:"inbox"})}),[B,x,t]),_=(0,M().C)(),T=(0,r().IS)((()=>({iconContainer:{display:"flex",justifyContent:"center",alignItems:"center",..._.icon},icon:{height:24,width:24}})),[_.icon]),P=(0,g().J)(),E=(0,s().K8)((()=>o.read?(0,d().C)(T.icon):(0,c().d)(T.icon)),[o.read,T.icon]);return(0,j.jsx)(b().A,{menuType:w().gu.Popup,height:k.isMobile?"50vh":void 0,minWidth:250,maxWidth:k.isMobile?"100vw":void 0,scrollerStyle:_.menuScroller,header:!k.isMobile&&(0,j.jsx)(A().A,{style:_.header,isSmall:!k.isMobile,isSecondaryColor:!k.isMobile,children:(0,j.jsx)(m().sA,{id:"UpdateSidebarTabUpdatesHeader.pageNotificationSettings.label",defaultMessage:"Page notification settings"})}),children:(0,j.jsx)(y().Ay,{type:y().Oh.Vertical,sections:[...k.isMobile?[{key:"Actions title",render:()=>(0,j.jsx)(A().A,{style:_.header,isSmall:!k.isMobile,isSecondaryColor:!k.isMobile,children:(0,j.jsx)(m().sA,{id:"inbox.actionsSectionTitle.label",defaultMessage:"Actions"})}),items:[]},{key:"Actions",render:e=>(0,j.jsx)(C().A,{...e,topBorder:!1,style:_.sectionMenuItem}),items:["markAsReadOrUnread","archive"].map(((e,t)=>{const n=t===R.length-1,i=k.isMobile&&n;return{key:e,render:t=>"archive"===e?(0,j.jsx)(v().A,{...t,style:{..._.buttonMenuItem,...i&&_.transparentButtonMenuItemBorder},pressedStyle:_.buttonMenuItemPressed,icon:o.visited?(0,l().arrowUTurnUpLeftIcon)({..._.icon,padding:3}):(0,a().B)(_.icon),title:D.formatMessage(o.visited?L.unarchive:L.archive),titleStyle:_.title}):"markAsReadOrUnread"===e?(0,j.jsx)(v().A,{...t,style:{..._.buttonMenuItem,...i&&_.transparentButtonMenuItemBorder},pressedStyle:_.buttonMenuItemPressed,icon:(0,j.jsx)("div",{style:T.iconContainer,children:E}),title:D.formatMessage(o.read?L.markUnread:L.markRead),titleStyle:_.title}):void(0,p().HB)(e),action:({event:t})=>{"markAsReadOrUnread"===e?S(t):"archive"===e?o.visited?f(t):h(t):(0,p().HB)(e),u()}}}))}]:[],...k.isMobile?[{key:"Page notification settings title",render:()=>(0,j.jsx)(A().A,{style:_.subheader,isSmall:!k.isMobile,isSecondaryColor:!k.isMobile,children:(0,j.jsx)(m().sA,{id:"inbox.notifyMeForSectionTitle.label",defaultMessage:"Page notification settings"})}),items:[]}]:[],{key:"Page notification settings",render:e=>(0,j.jsx)(C().A,{...e,topBorder:!1,style:_.sectionMenuItem}),items:R.map(((e,t)=>{const o=t===R.length-1,n=k.isMobile&&o;return{key:e.action.analyticsName,render:t=>(0,j.jsx)(v().A,{...t,style:{..._.buttonMenuItem,...n&&_.transparentButtonMenuItemBorder},pressedStyle:_.buttonMenuItemPressed,title:e.title,titleStyle:_.title,isChecked:e.isSelectedOption}),action:()=>{e.action.action({environment:x,blocks:[],publicEditMode:void 0,analyticsFrom:"inbox_long_press_menu",lazyDependencies:P}),u()}}}))}],initialFocus:void 0,onAccept:()=>u()})})}const P=n.memo(_)},970236:(e,t,o)=>{o.d(t,{E:()=>r});o(296540);var n=()=>o(401497),i=()=>o(284371),s=o(474848);function r(e){const{color:t="gray",style:o,content:r,...a}=e,l=(0,n().IS)((e=>({badge:{alignSelf:"center",marginInlineStart:6,padding:"2px 4px",background:e[t].background.secondaryTranslucent,color:e[t].text.accentPrimary,borderRadius:4,fontSize:11,fontWeight:i().Wy.medium,lineHeight:1.3,...o}})),[t,o]);return(0,s.jsx)("div",{style:l.badge,...a,children:r})}},993949:(e,t,o)=>{o.d(t,{J:()=>i,M:()=>s});o(16280);var n=o(296540);const i=n.createContext(null);function s(){const e=(0,n.useContext)(i);if(!e)throw new Error("ActionBarContext must be used inside ActionBar");return e}i.displayName="ActionBarContext"},995847:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>n,xMarkSmallIcon:()=>i});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"3.17 3.17 9.66 9.66",svg:(0,o(474848).jsx)("path",{d:"M12.642 3.358a.625.625 0 0 0-.884 0L8 7.116 4.242 3.358a.625.625 0 1 0-.884.884L7.116 8l-3.758 3.758a.625.625 0 0 0 .884.884L8 8.884l3.758 3.758a.625.625 0 1 0 .884-.884L8.884 8l3.758-3.758a.625.625 0 0 0 0-.884"})},i=(0,o(340498).wt)("xMarkSmall",n)}}]);