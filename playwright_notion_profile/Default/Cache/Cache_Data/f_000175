"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[52273],{104129:(e,t,o)=>{o.d(t,{A:()=>n});o(898992),o(672577);class r extends(()=>o(959180))().A{findModuleContainer({layoutStore:e,moduleId:t}){return this.find((o=>o.layoutStore===e&&o.moduleId===t))}}const n=new r},132174:(e,t,o)=>{o.d(t,{A:()=>i});var r=()=>o(201980);class n extends(()=>o(757695))().Store{getInitialState(){return{isLoaded:!1}}getFormState(){if(this.state.isLoaded)return this.state}getQuestionError(e){if(this.state.isLoaded)return this.state.formQuestionErrorMap.get(e)}updateFormState(e){this.state.isLoaded&&this.setState({...this.state,...e})}updateFilePropertyIdToFormFiles(e,t){var o;if(!this.state.isLoaded)return;const r=null===(o=this.getFormState())||void 0===o?void 0:o.filePropertyIdToFormFiles;this.updateFormState({filePropertyIdToFormFiles:{...r,[e]:t((null==r?void 0:r[e])??[])}})}updateFormErrorMap(e,t){if(!this.state.isLoaded)return;const n=this.state.collectionSchema;if(!n)return;const i=new Map;for(const c of e){var s,l,a;const e=c.id,u=null===(s=c.getConfig())||void 0===s?void 0:s.propertyId;if(!u)continue;const p=null===(l=this.state.draftFormBlockStore)||void 0===l?void 0:l.getProperties()[u],m=(0,o(713998)._g)({schema:n,property:u});if(m){if(c.isRequired()&&null!==(a=this.state.questionIdsVisibleAtLastSubmissionAttempt)&&void 0!==a&&a.includes(e)){const t=this.state.filePropertyIdToFormFiles;if("file"===m.type){var d;if(((null===(d=t[u])||void 0===d?void 0:d.length)??0)<1){i.set(e,"required");continue}}else if("checkbox"===m.type){if(!0!==(0,o(657970).w)(p)){i.set(e,"required");continue}}else if((0,r().w9s)(p)){i.set(e,"required");continue}}if(!(0,r().w9s)(p)){const n=(0,r().q4_)(p);if("number"===m.type&&!(0,o(72135).kf)(n,t)){i.set(e,"invalid_number");continue}if("email"===m.type&&!(0,o(842599).DT)(n)){i.set(e,"invalid_email");continue}if("url"===m.type&&!(0,o(402137).w)(n)){i.set(e,"invalid_url");continue}if("phone_number"===m.type&&!(0,o(754199).e)(n)){i.set(e,"invalid_phone_number");continue}}}}this.updateFormState({formQuestionErrorMap:i})}}const i=n},160241:(e,t,o)=>{o.d(t,{d:()=>n});var r=()=>o(401497);function n(){return(0,r().IS)((e=>({button:{background:"light"===e.mode?e.palette.uiBlue[100]:e.palette.uiBlue[200]},buttonHovered:{background:"light"===e.mode?e.palette.uiBlue[200]:e.palette.uiBlue[300]},buttonPressed:{background:"light"===e.mode?e.palette.uiBlue[300]:e.palette.uiBlue[400]}})),[])}},279897:(e,t,o)=>{o.d(t,{A:()=>d});var r=o(296540),n=()=>o(56366),i=()=>o(401497),s=()=>o(31503),l=()=>o(69708),a=o(474848);function d({propertySchema:e,formQuestionStore:t,formMode:o}){const d=(0,i().IS)((e=>({select:{color:e.text.tertiary,marginTop:4,marginBottom:12,..."viewer"===o?{marginInlineStart:0,marginInlineEnd:0}:{marginInlineStart:10,marginInlineEnd:10}}})),[o]),c=(0,n().K8)((()=>(0,s().hm)(e,t.getModel())),[t,e]),u=(0,r.useMemo)((()=>"builder"===o?void 0===c?(0,a.jsx)(l().sA,{id:"QuestionMaxSelection.builder.unlimited",defaultMessage:"(Respondents can select as many as they like)"}):(0,a.jsx)(l().sA,{id:"QuestionMaxSelection.builder.limited",defaultMessage:"(Respondents can select up to {count})",values:{count:c}}):void 0===c?(0,a.jsx)(l().sA,{id:"QuestionMaxSelection.viewer.unlimited",defaultMessage:"(Select as many as you like)"}):(0,a.jsx)(l().sA,{id:"QuestionMaxSelection.viewer.limited",defaultMessage:"(Select up to {count})",values:{count:c}})),[o,c]);return(0,a.jsx)("div",{style:d.select,children:u})}},316397:(e,t,o)=>{o.d(t,{z:()=>i});var r=()=>o(56366),n=()=>o(937199);function i(){const{layoutStore:e}=(0,n().LH)();return"form"===(0,r().K8)((()=>{var t;return null===(t=e.getModel())||void 0===t?void 0:t.getLayoutType()}),[e])?24:12}},349811:(e,t,o)=>{o.d(t,{Z:()=>l});o(944114);var r=()=>o(496603),n=()=>o(314529);var i=()=>o(334261),s=()=>o(231297);function l({visibility:e,property:t,schema:o,collectionStore:l,format:a,environment:d,transaction:c}){const u=a.collection_page_sections?r().mg(a.collection_page_sections):[];if(!o[t])return;const p=u.findIndex((e=>e.section===t));-1!==p?u[p]={section:t,visibility:e}:u.push({section:t,visibility:e}),u&&(s().createAndCommitOrAppend({userAction:"PagePropertiesRowName.handleShowAsClick",environment:d,canUndo:!0,transaction:c,perform:e=>{i().LK({environment:d,pageSectionFormats:u,store:l,transaction:e})}}),function(e,t){(0,n().DO_NOT_USE_trackLegacy)(e,"relation_show_as",t)}(d,{from:"relation_section",mode:"inline"===e?"page_section":"minimal"===e?"minimal_page_section":"property"}))}},417257:(e,t,o)=>{o.d(t,{H:()=>s,o:()=>i});var r=o(296540),n=()=>o(132174);const i=(0,r.createContext)(null);function s(){const e=(0,r.useContext)(i);return e||new(n().A)}i.displayName="FormBlockContext"},437426:(e,t,o)=>{o.d(t,{$:()=>a});var r=o(296540),n=()=>o(56366),i=()=>o(252291),s=()=>o(895876),l=o(474848);const a=r.memo(r.forwardRef((function({collectionContextStore:e,property:t,iconTransformer:a=(e=>e),getTitleOverride:d,...c},u){const{isMobile:p}=(0,o(484714).Y0)(),m=(0,n().K8)((()=>e.collectionStore()),[e]),g=(0,n().K8)((()=>null==m?void 0:m.getDatabaseType()),[m]),y=(0,n().K8)((()=>Boolean(m&&g&&(0,o(671793).j)((0,o(413955).appConfigs)(),g,t,m))),[m,g,t]),v=(0,r.useCallback)((e=>(0,s().eF)(g,e)),[g]),f=(0,r.useCallback)((e=>(0,l.jsx)(o(760217).A,{...c,...e,disabled:y,disabledFeedback:y,title:(null==d?void 0:d({isRequiredProperty:y}))??(0,l.jsx)(o(69708).sA,{defaultMessage:"Delete property",id:"database.tableHeaderCell.deleteProperty"}),caption:p&&y?(0,s().eF)(g):null,icon:a(y?(0,l.jsx)("div",{...e,children:(0,l.jsx)(i().I,{icon:o(471095).i})}):(0,l.jsx)(i().I,{icon:o(236262).trashIcon})),isRedOnHover:!0})),[g,d,a,p,y,c]);return(0,l.jsx)(o(859428).A,{placement:"left",disableTooltip:!y,renderTooltip:v,render:f})})))},471645:(e,t,o)=>{o.d(t,{P:()=>d});o(296540);var r=()=>o(56366),n=()=>o(401497),i=()=>o(201980),s=()=>o(69708),l=()=>o(582049),a=o(474848);function d({disabled:e,formQuestionStore:t,formMode:o}){const d=(0,s().tz)(),c=(0,n().IS)((e=>({questionDescriptionInput:{cursor:"text",fontSize:16,color:e.text.secondary,padding:"builder"===o?"4px 10px":"4px 0px",width:"fit-content"}})),[o]),{questionDescriptionStore:u,questionDescription:p,showDescription:m}=(0,r().K8)((()=>{var e;const o=t.getDescriptionStore().getValue();return{showDescription:Boolean(null===(e=t.getConfig())||void 0===e?void 0:e.showDescription),questionDescriptionStore:t.getDescriptionStore(),questionDescription:o?(0,i().q4_)(o):void 0}}),[t]);return m&&("viewer"!==o||p)?(0,a.jsx)(l().B,{store:u,style:c.questionDescriptionInput,disabled:e,placeholder:d.formatMessage({id:"FormQuestionDescription.placeholder",defaultMessage:"Add description"}),id:`form-description-${t.id}`}):null}},511177:(e,t,o)=>{o.d(t,{j:()=>m});o(296540);var r=()=>o(56366),n=()=>o(401497),i=()=>o(713998),s=()=>o(451306),l=()=>o(69708),a=()=>o(284371),d=()=>o(417257),c=()=>o(173215),u=()=>o(582049),p=o(474848);function m({disabled:e,onChange:t,formQuestionStore:o,formMode:m}){const g=(0,l().tz)(),y=(0,d().H)(),{parentBlockStore:v,questionNameStore:f,isRequired:h}=(0,r().K8)((()=>({parentBlockStore:o.getParentStore(),questionNameStore:o.getNameStore(),isRequired:o.isRequired()})),[o]),x=(0,r().K8)((()=>{var e,t;const r=y.getFormState();if(!r)return;const n=r.collectionSchema,s=null===(e=o.getConfig())||void 0===e?void 0:e.propertyId;return n&&s?null===(t=(0,i()._g)({schema:n,property:s}))||void 0===t?void 0:t.type:void 0}),[o,y]),b=(0,r().K8)((()=>y.getQuestionError(o.id)),[y,o.id]),S=(0,n().IS)((e=>({questionTitleInput:{padding:"0px 10px",margin:"10px 0px",fontSize:24,lineHeight:"30px",borderRadius:6,fontWeight:a().Wy.bold,cursor:"text",textWrap:"wrap",width:"fit-content"},viewQuestionTitleOverrides:{display:"block",margin:0,padding:"6px 0px",whiteSpace:"pre-wrap",maxWidth:"100%",wordBreak:"break-word"},pseudoAfter:{content:"'*'",color:"required"===b?e.palette.red[500]:e.text.tertiary,fontWeight:"normal"}})),[b]),M=(0,c().x)({textStore:f,spaceId:o.pointer.spaceId,parentStore:v,disabled:!1});return"builder"===m?(0,p.jsx)("div",{className:"form-question-title",children:(0,p.jsx)(u().B,{store:f,onChange:t,disabled:e,placeholder:"builder"===m?g.formatMessage({id:"FormQuestionTitle.placeholder",defaultMessage:"Question name"}):void 0,...(0,s().AH)({...S.questionTitleInput,...h?{pseudoAfter:S.pseudoAfter}:{}})})}):"multi_select"===x?(0,p.jsx)("legend",{className:"form-question-title",...(0,s().AH)({...S.questionTitleInput,...S.viewQuestionTitleOverrides,...h?{pseudoAfter:S.pseudoAfter}:{}}),children:M}):"file"===x?(0,p.jsx)("div",{className:"form-question-title",...(0,s().AH)({...S.questionTitleInput,...S.viewQuestionTitleOverrides,...h?{pseudoAfter:S.pseudoAfter}:{}}),id:`form-question-${o.id}`,children:M}):(0,p.jsx)("h2",{id:`form-question-title-${o.id}`,className:"form-question-title",...(0,s().AH)({...S.questionTitleInput,...S.viewQuestionTitleOverrides,...h?{pseudoAfter:S.pseudoAfter}:{}}),children:M})}},582049:(e,t,o)=>{o.d(t,{B:()=>l});o(296540);var r=()=>o(496603),n=()=>o(712855),i=()=>o(792540),s=o(474848);function l({store:e,disabled:t,style:o,placeholder:l,className:a,onChange:d,id:c}){return(0,s.jsx)(n().A,{store:e,style:o,className:a,disableSlashCommands:!0,onEnter:r().lQ,onEsc:r().lQ,onTab:r().lQ,onUntab:r().lQ,onMoveDown:r().lQ,onMoveUp:r().lQ,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableEmbedMenu:!0,disabledMentionTypes:{page:!1,user:!1,date:!1,createPage:!0,inviteUserToWorkspace:!0,inviteUserToPage:!0,reminder:!0,bot:!0,heading:!0,group:!0,templateVariable:!0,property:!0},disabled:t,pasteBehavior:"inline",placeholder:l,inPageFind:i().Os.none,disableComment:!0,onBlur:r().lQ,onChange:d,id:c})}},646796:(e,t,o)=>{o.d(t,{W:()=>c});var r=o(296540),n=()=>o(221844),i=()=>o(484714),s=()=>o(852507),l=()=>o(56366),a=()=>o(894995),d=()=>o(417257);function c(e){const t=(0,i().v3)(),{inMemoryRecordCacheName:o,collectionSchemaPropertyIds:c,collectionId:u,spaceId:p,formMode:m}=e,g=(0,d().H)(),y=(0,r.useMemo)((()=>new(n().A)({name:o,isTemporaryData:!0})),[o]),v=(0,l().K8)((()=>{var e;const o=null===(e=g.getFormState())||void 0===e?void 0:e.draftFormBlockStore;return o||a().createDummyFormPage({environment:t,spaceId:p,collectionSchemaPropertyIds:c,temporaryRecordCache:y,collectionId:u,formMode:m})}),[u,c,t,g,m,p,y]);return(0,s().l)((()=>{y.addCacheFallback(t.defaultRecordCache.inMemoryRecordCache),g.updateFormState({draftFormBlockStore:v})})),v}},728915:(e,t,o)=>{o.d(t,{Ai:()=>l,EJ:()=>d,M8:()=>c,TX:()=>p,Yj:()=>s,cf:()=>u});o(581454);var r=()=>o(69708),n=()=>o(534177),i=()=>o(921855);const s=12,l=(0,r().YK)({anonymousSubmissionLabel:{id:"FormBlock.anonymousSubmissionLabel",defaultMessage:"Submitting response anonymously"}}),a=(0,r().YK)({inaccessibleTitle:{id:"FormBlock.inaccessible.title",defaultMessage:"This form is not publicly available."},inaccessibleSubtitle:{id:"FormBlock.inaccessible.subtitle",defaultMessage:"Login to submit or contact the form creator to publish."},closedOrDeletedTitle:{id:"FormBlock.closedOrDeleted.title",defaultMessage:"This form is closed or deleted."},closedOrDeletedSubtitle:{id:"FormBlock.closedOrDeleted.subtitle",defaultMessage:"Try contacting the form owner if you think it’s a mistake."},submissionErrorTitle:{id:"FormBlock.submissionError.title",defaultMessage:"Something went wrong."},submissionErrorSubtitle:{id:"FormBlock.submissionError.subtitle",defaultMessage:"There was an issue submitting the form. Please try again or contact the form owner."}}),d={closedOrDeleted:a.closedOrDeletedTitle,inaccessible:a.inaccessibleTitle,submissionError:a.submissionErrorTitle},c={closedOrDeleted:a.closedOrDeletedSubtitle,inaccessible:a.inaccessibleSubtitle,submissionError:a.submissionErrorSubtitle};function u({questionType:e,filePropertyIdToFormFiles:t,draftSubmissionPageStore:o,propertyId:r}){switch(e){case"checkbox":return"Yes"===(0,i().r4)(o.getPropertyValue(r),o)?"true":"false";case"file":return((null==t?void 0:t[r])??[]).map((e=>e.fileName)).join(", ");case"text":case"title":case"select":case"multi_select":case"relation":case"date":case"person":case"number":case"email":case"url":case"phone_number":case"place":return(0,i().r4)(o.getPropertyValue(r),o);default:(0,n().HB)(e)}}function p(e){return e?500:600}},936587:(e,t,o)=>{o.d(t,{c:()=>n});o(898992),o(354520);var r=()=>o(449195);function n(e,t){const o="section_hide"!==(0,r().z5)(null==t?void 0:t.page_section_visibility);return e.filter((e=>"discussions"!==e.type||o))}},952273:(e,t,o)=>{o.d(t,{n:()=>So,B:()=>Co});o(16280),o(898992),o(354520),o(581454);var r=()=>o(153321),n=o(296540),i=()=>o(59226),s=()=>o(726637),l=()=>o(484714),a=()=>o(56366),d=()=>o(401497),c=()=>o(970236),u=()=>o(713998),p=()=>o(688728),m=()=>o(369186),g=()=>o(155185),y=()=>o(800065),v=()=>o(69708),f=()=>o(100622),h=()=>o(496603),x=()=>o(534177),b=()=>o(284371),S=()=>o(348241),M=()=>o(908201),I=()=>o(21140),_=()=>o(478726),C=()=>o(143197),w=()=>o(548821),j=()=>o(864994),A=()=>o(557198),k=()=>o(106065),T=()=>o(852302),P=()=>o(106412),B=()=>o(148832),F=()=>o(472090),E=()=>o(937199),D=o(474848);function O(e){const{wrapper:t,viewsModule:o}=e,{pageStore:r,moduleStateByIdStore:i}=(0,E().bi)(),[s,l]=(0,n.useState)(void 0),{setModuleSelection:d}=(0,E().LH)(),c=(0,n.useMemo)((()=>new(F().E)),[]),u=(0,n.useCallback)((e=>{e&&c.observe(e)}),[c]),p=(0,a().K8)((()=>c.rect.state.width),[c]);(0,n.useEffect)((()=>{s&&i.set(o.id,{collectionContextStore:s})}),[s,i,o.id]);const{collectionViewBlockStore:m,viewsModuleContext:g,isViewsMainModule:y}=(0,a().K8)((()=>{if(!o)return{collectionViewBlockStore:void 0,viewsModuleContext:void 0,isViewsMainModule:!1};const e=B().B.createChildStore(r,o.collection_view_block_pointer);return{collectionViewBlockStore:e,viewsModuleContext:{location:"layoutBuilder",viewsModule:o,currentPageStore:r,collectionViewBlockStore:e,selectViewsModule:()=>{d&&d({type:"existing_module",moduleId:o.id,isDragging:!1})}},isViewsMainModule:"viewsMain"===o.type}}),[r,o,d]);if(!m||!g)return null;return t((0,D.jsx)("div",{ref:u,children:(0,D.jsx)(T().l,{children:(0,D.jsx)(P().tx,{value:{location:"layout_editor",isPreviewing:!0,disableHeaderPointerEvents:!1,disableEditsAndConfiguration:!1,disableContentPointerEvents:!1,disablePageLinks:!1,hideAggregation:!1,hideViewBlockSource:!1,enableHorizontalScroll:!0},children:(0,D.jsx)(k().dN,{store:m,isFullScreen:!1,productUseCase:"page_layout_editor",disabled:!1,disableHoverMenu:!0,headerActionsBehavior:"always_show",headerAllowedActions:L,fullWidth:p,overridePaddingLeft:0,overridePaddingRight:0,setCollectionContextStore:l,showOnlyCurrentView:!y,isUnlistedView:!1,viewsModuleContext:g})})})}))}const L=["filter","sort"];var H=()=>o(678834),R=()=>o(402014),K=()=>o(93583),Q=()=>o(790748),G=()=>o(887146),V=()=>o(778781),q=()=>o(747100),W=()=>o(115512),$=()=>o(554283),z=()=>o(104129),N=()=>o(435930),U=()=>o(823082),Y=()=>o(316397),X=(o(944114),o(737550),()=>o(30537)),J=()=>o(487929),Z=()=>o(403733),ee=()=>o(62900),te=()=>o(569397),oe=()=>o(4688),re=()=>o(30626),ne=()=>o(236262),ie=()=>o(728396),se=()=>o(475140);var le=()=>o(120997),ae=()=>o(251822),de=()=>o(789280),ce=()=>o(349811),ue=()=>o(334261),pe=()=>o(231297),me=()=>o(962326),ge=()=>o(437426),ye=()=>o(760217),ve=()=>o(406699),fe=()=>o(285790),he=()=>o(404277),xe=()=>o(939740),be=()=>o(89924),Se=()=>o(859428),Me=()=>o(722872),Ie=()=>o(543665),_e=()=>o(237775),Ce=()=>o(978846),we=()=>o(640868),je=()=>o(259476),Ae=()=>o(719849);async function ke(e){switch(e){case"property_number":case"property_title":case"property_person":case"property_file":case"property_text":case"property_checkbox":case"property_url":case"property_email":case"property_phone_number":case"property_created_by":case"property_last_edited_by":case"property_button":case"property_select":case"property_multi_select":case"property_status":case"property_date":case"property_created_time":case"property_last_edited_time":case"property_last_visited_time":case"property_relation":case"property_rollup":case"property_formula":case"property_auto_increment_id":case"property_location":case"property_verification":case"property_place":return await async function(){return await Ae().f({icon:je().trashSmallIcon,confirmTextStyle:"red",title:(0,D.jsx)(v().sA,{defaultMessage:"Remove property from layout?",id:"deletePropertyActions.title"}),confirmText:(0,D.jsx)(v().sA,{defaultMessage:"Remove",id:"deletePropertyActions.confirmText"}),confirmTextPerRadioOption:{delete_property_and_module:(0,D.jsx)(v().sA,{defaultMessage:"Remove and delete",id:"deletePropertyActions.confirmTextForDeletePropertyAndModule"})},radioOptions:[{key:"delete_module",title:(0,D.jsx)(v().sA,{defaultMessage:"Remove from layout",id:"deletePropertyActions.titleForDeleteModuleOption"}),subtitle:(0,D.jsx)(v().sA,{defaultMessage:"The property will still be visible in database views and in the page’s property group",id:"deletePropertyActions.subtitleForDeleteModuleOption"})},{key:"delete_property_and_module",title:(0,D.jsx)(v().sA,{defaultMessage:"Remove from layout and database",id:"deletePropertyActions.titleForDeletePropertyAndModuleOption"}),subtitle:(0,D.jsx)(v().sA,{defaultMessage:"The property will be removed from both the page layout and the database",id:"deletePropertyActions.subtitleForDeletePropertyAndModuleOption"})}]})}();case"relationsGroup":return await async function(){return await Ae().f({icon:je().trashSmallIcon,confirmTextStyle:"red",title:(0,D.jsx)(v().sA,{defaultMessage:"Remove relations group from layout?",id:"deleteRelationsGroupModuleActions.title"}),confirmText:(0,D.jsx)(v().sA,{defaultMessage:"Remove",id:"deleteRelationsGroupModuleActions.confirmText"}),confirmTextPerRadioOption:{delete_property_and_module:(0,D.jsx)(v().sA,{defaultMessage:"Remove and delete",id:"deleteRelationsGroupModuleActions.confirmTextForDeletePropertyAndModule"})},radioOptions:[{key:"delete_module",title:(0,D.jsx)(v().sA,{defaultMessage:"Remove from layout",id:"deleteRelationsGroupModuleActions.titleForDeleteModuleOption"}),subtitle:(0,D.jsx)(v().sA,{defaultMessage:"The relations properties will still be visible in database views and in the page’s property group",id:"deleteRelationsGroupModuleActions.subtitleForDeleteModuleOption"})},{key:"delete_property_and_module",title:(0,D.jsx)(v().sA,{defaultMessage:"Remove from layout and database",id:"deleteRelationsGroupModuleActions.titleForDeletePropertyAndModuleOption"}),subtitle:(0,D.jsx)(v().sA,{defaultMessage:"The relations properties will be removed from both the page layout and the database",id:"deleteRelationsGroupModuleActions.subtitleForDeletePropertyAndModuleOption"})}]})}();case"formSubmit":case"formQuestion":case"formTitle":case"placeholder":case"views":case"transcript":case"row":case"view":return"delete_module";default:(0,x().HB)(e)}}var Te=()=>o(447934),Pe=()=>o(479062),Be=()=>o(936587),Fe=()=>o(970176),Ee=()=>o(160241),De=()=>o(252291),Oe=()=>o(955363),Le=()=>o(212727),He=()=>o(662971);function Re({parent:e,onSelect:t,...o}){const r=(0,l().v3)(),{layoutStore:n}=(0,E().LH)(),i=(0,a().K8)((()=>n.getModules()),[n]),s=(0,a().K8)((()=>Boolean((0,se().JO)(i,(e=>"relationsGroup"===e.type)))),[i]),d=(0,D.jsx)(v().sA,{id:"AdvancedModuleMenuItem.originButtonTitle",defaultMessage:"Advanced"}),c=s?(0,D.jsx)(v().sA,{id:"AdvancedModuleMenuItem.buttons.moveToRelationsGroupModule",defaultMessage:"Add to relations group"}):(0,D.jsx)(v().sA,{id:"AdvancedModuleMenuItem.buttons.convertToRelationsGroupModule",defaultMessage:"Convert to relations group"}),u={key:"moveOrConvertToRelationsGroup",render:(e,t)=>(0,D.jsx)(ye().A,{...e,icon:(0,D.jsx)(De().I,{icon:Oe().arrowDiagonalUpRightIcon}),title:c,caption:(0,D.jsx)(v().sA,{id:"AdvancedModuleMenuItem.moveOrConvertToRelationsGroup.caption",defaultMessage:"Supports minimal or responsive page sections"})}),action:()=>t()};return(0,D.jsx)(He().A,{...o,onFocus:e.onFocus,renderOrigin:(e,t)=>(0,D.jsx)(ye().A,{...e,ref:t,title:d,icon:(0,D.jsx)(De().I,{icon:Le().gearIcon})}),renderExtension:t=>{let o;return o=r.device.isMobile?{menuType:Me().gu.ActionSheet}:{menuType:Me().gu.Popup},(0,D.jsx)(he().A,{...o,...t,children:(0,D.jsx)(xe().Ay,{type:xe().Oh.Vertical,initialFocus:0,sections:[{key:"sections",render:e=>(0,D.jsx)(be().A,{...e}),items:[u]}],onAccept:e.onAccept})})}})}function Ke({icon:e}){const t=(0,d().IS)((()=>({iconWrapper:{display:"flex",alignItems:"center",justifyContent:"center",width:16,height:16,overflow:"visible"}})),[]);return(0,D.jsx)("div",{style:t.iconWrapper,children:e})}const Qe=n.memo(Ke);var Ge=()=>o(340498);const Ve=(0,Ge().wt)("propertyGroup",{viewBox:"0 0 20 20",svg:(0,D.jsx)("path",{d:"M5.49512 7.7334C5.35384 7.7334 5.23079 7.68099 5.12598 7.57617C5.02116 7.47135 4.96875 7.34603 4.96875 7.2002C4.96875 7.05436 5.01888 6.92904 5.11914 6.82422C5.22396 6.7194 5.34928 6.66699 5.49512 6.66699H6.27441C6.42025 6.66699 6.54557 6.7194 6.65039 6.82422C6.75977 6.92904 6.81445 7.05436 6.81445 7.2002C6.81445 7.35059 6.75977 7.47819 6.65039 7.58301C6.54557 7.68327 6.42025 7.7334 6.27441 7.7334H5.49512ZM5.49512 9.97559C5.34928 9.97559 5.22396 9.92546 5.11914 9.8252C5.01888 9.72038 4.96875 9.59505 4.96875 9.44922C4.96875 9.29883 5.01888 9.1735 5.11914 9.07324C5.22396 8.96842 5.34928 8.91602 5.49512 8.91602H6.27441C6.4248 8.91602 6.55241 8.96842 6.65723 9.07324C6.76204 9.1735 6.81445 9.29883 6.81445 9.44922C6.81445 9.59505 6.75977 9.72038 6.65039 9.8252C6.54557 9.92546 6.42025 9.97559 6.27441 9.97559H5.49512ZM8.16113 7.65137C8.03353 7.65137 7.92643 7.60807 7.83984 7.52148C7.75781 7.4349 7.7168 7.3278 7.7168 7.2002C7.7168 7.07715 7.76009 6.97461 7.84668 6.89258C7.93327 6.80599 8.03809 6.7627 8.16113 6.7627H14.5732C14.6963 6.7627 14.7988 6.80599 14.8809 6.89258C14.9674 6.97461 15.0107 7.07715 15.0107 7.2002C15.0107 7.3278 14.9674 7.4349 14.8809 7.52148C14.7988 7.60807 14.6963 7.65137 14.5732 7.65137H8.16113ZM8.16113 9.89355C8.03353 9.89355 7.92643 9.85026 7.83984 9.76367C7.75781 9.67708 7.7168 9.57227 7.7168 9.44922C7.7168 9.32161 7.76009 9.21452 7.84668 9.12793C7.93327 9.04134 8.03809 8.99805 8.16113 8.99805H14.5732C14.6963 8.99805 14.7988 9.04362 14.8809 9.13477C14.9674 9.22135 15.0107 9.32617 15.0107 9.44922C15.0107 9.57682 14.9674 9.68392 14.8809 9.77051C14.7988 9.85254 14.6963 9.89355 14.5732 9.89355H8.16113ZM4.1416 16.4492C3.40332 16.4492 2.84505 16.2624 2.4668 15.8887C2.08854 15.515 1.89941 14.9635 1.89941 14.2344V5.9082C1.89941 5.17904 2.08854 4.6276 2.4668 4.25391C2.84505 3.87565 3.40332 3.68652 4.1416 3.68652H15.8447C16.5876 3.68652 17.1481 3.87565 17.5264 4.25391C17.9046 4.6276 18.0938 5.17904 18.0938 5.9082V14.2344C18.0938 14.9635 17.9046 15.515 17.5264 15.8887C17.1481 16.2624 16.5876 16.4492 15.8447 16.4492H4.1416ZM4.22363 15.1094H15.7695C16.084 15.1094 16.3255 15.0273 16.4941 14.8633C16.6628 14.6947 16.7471 14.4463 16.7471 14.1182V6.02441C16.7471 5.69629 16.6628 5.4502 16.4941 5.28613C16.3255 5.11751 16.084 5.0332 15.7695 5.0332H4.22363C3.90462 5.0332 3.66081 5.11751 3.49219 5.28613C3.32812 5.4502 3.24609 5.69629 3.24609 6.02441V14.1182C3.24609 14.4463 3.32812 14.6947 3.49219 14.8633C3.66081 15.0273 3.90462 15.1094 4.22363 15.1094Z"})});function qe({propertyGroups:e,propertyIds:t,parent:r,onSelectSectionMove:i,...s}){const c=(0,l().v3)(),u=(0,M().ET)(),p=(0,n.useCallback)((r=>{const n=u.collectionStore();let s=e;for(const e of t)s=(0,o(706665).lT)({propertyGroups:s,propertyId:e,destinationGroupId:r.id});n&&pe().createAndCommit({environment:c,perform(e){(0,o(395963).Yf)({collectionStore:n,newGroups:s,transaction:e})},canUndo:!0,userAction:"MoveToPropertyGroupMenuItem.handlePropertyGroupClick"}),i()}),[u,c,i,e,t]),m=(0,d().IS)((e=>({icon:{width:20,height:20},sectionMenuItem:{paddingTop:4,paddingBottom:4}})),[]),g=(0,a().K8)((()=>e.map((e=>({key:e.id,render:(t,o)=>(0,D.jsx)(ye().A,{...t,title:e.title}),action:()=>p(e)})))),[p,e]),y=(0,D.jsx)(v().sA,{id:"ModuleActionMenu.buttons.moveToPropertiesGroupButton",defaultMessage:"Add to property group"}),f=(0,D.jsx)(Qe,{icon:Ve(m.icon)});return e.length<=1?(0,D.jsx)(ye().A,{...s,icon:f,title:y}):(0,D.jsx)(He().A,{...s,onFocus:r.onFocus,renderOrigin:(e,t)=>(0,D.jsx)(ye().A,{...e,ref:t,title:y,icon:f}),renderExtension:e=>{let t;return t=c.device.isMobile?{menuType:Me().gu.ActionSheet}:{menuType:Me().gu.Popup,width:200},(0,D.jsx)(he().A,{...t,...e,children:(0,D.jsx)(xe().Ay,{type:xe().Oh.Vertical,initialFocus:0,sections:[{key:"sections",render:e=>(0,D.jsx)(be().A,{...e,style:m.sectionMenuItem,title:(0,D.jsx)(v().sA,{id:"moveToPropertyGroupMenuItem.sections",defaultMessage:"Sections"})}),items:g}],onAccept:r.onAccept})})}})}const We=n.memo(qe),$e=n.memo((function(e){const{layoutType:t,module:o,isModuleHoveredOrSelected:r}=e;switch(t){case"form":if("formQuestion"===o.type)return(0,D.jsx)(ze,{moduleId:o.id,isModuleHoveredOrSelected:r});break;case"page_in_collection":case void 0:return(0,D.jsx)(Ne,{module:o});default:(0,x().HB)(t)}return null}));function ze({moduleId:e,isModuleHoveredOrSelected:t}){const{canEditLayout:o}=(0,E().LH)(),r=(0,d().IS)((()=>({actionButton:{position:"absolute",top:10,insetInlineEnd:10,zIndex:1e3}})),[]);return o?(0,D.jsx)("div",{style:r.actionButton,children:(0,D.jsx)(Ue,{moduleId:e,isModuleHoveredOrSelected:t})}):null}function Ne({module:e}){const{canEditLayout:t}=(0,E().LH)(),o=function(e){const{layoutModule:t}=e,{sessionId:o,layoutStore:r,setModuleSelection:s}=(0,E().LH)(),d=(0,l().v3)(),c=(0,i().X)("bottom_page_discussions_enabled"),u=(0,M().ET)(),m=(0,a().K8)((()=>u.collectionStore()),[u]),{collectionSchema:g,collectionFormat:y,propertyGroups:f}=(0,a().K8)((()=>({collectionSchema:null==m?void 0:m.getSchema(),collectionFormat:null==m?void 0:m.getFormat(),propertyGroups:(null==m?void 0:m.getNormalizedPropertyGroups())??[]})),[m]),h=(0,n.useMemo)((()=>y&&g?(0,J().T)({format:y,schema:g,visibilityLevels:["inline","minimal"]}).map((e=>e.section)):[]),[y,g]),{layoutType:b,isTabbedLayout:S,viewsMainTabModuleKey:I,currentModulePosition:_,modulesSplitByMoveable:C}=(0,a().K8)((()=>{var e,o;const n=r.getModules(),i=(0,se().JO)(n,(e=>e.id===t.id)),s=null==i?void 0:i.area;if("form_conditional_modules"===s)throw new Error("[Forms Conditional Logic Not Implemented] usePageLayoutModuleActionMenuListItems not implemented for form_conditional_modules");const l=s&&("views_main_tab_modules"===s?null==n||null===(e=n[s])||void 0===e?void 0:e[i.viewId]:null==n?void 0:n[s]),a=s&&l&&(0,ae().jS)(s,l,c),d=null===(o=function(e){if(e.views_main_tab_modules)return(0,x().uv)(e.views_main_tab_modules)}(n))||void 0===o?void 0:o[0];return{layoutType:r.getLayoutType(),isTabbedLayout:r.isTabbedPageLayout(),viewsMainTabModuleKey:d,currentModulePosition:i,modulesSplitByMoveable:a}}),[t.id,r,c]),w=(0,n.useCallback)((({destinationModuleId:e})=>{b&&((0,ie().Hc)(b)?s(void 0):s({type:"existing_module",moduleId:e,isDragging:!1,draggingModuleInitialArea:void 0,draggingModuleFinalArea:void 0}),(0,ie().U2)(b)&&(0,Fe().z)({layoutStore:r,moduleId:e,environment:d}))}),[r,b,s,d]),j=(0,n.useCallback)((({moduleGroup:e,indexOfStartOfGroup:n})=>{if(!C||e.length<=1||null==_||!_.area)return[];const i=e.findIndex((e=>e.id===t.id)),s=-1!==i,l=0===i,a=i===e.length-1,c=n+i,u=[];return s&&!l&&u.push({key:"move-up",render:e=>(0,D.jsx)(ye().A,{...e,title:(0,D.jsx)(v().sA,{id:"ModuleActionMenu.buttons.moveUpButton",defaultMessage:"Move up"}),icon:(0,D.jsx)(Qe,{icon:(0,oe().arrowStraightUpSmallIcon)()})}),action:()=>{(0,Ce().E)({environment:d,layoutStore:r,position:{type:"absolute",index:c-1,..."views_main_tab_modules"===(null==_?void 0:_.area)?{area:"views_main_tab_modules",viewId:_.viewId}:{area:_.area}},moduleId:t.id,sessionId:o}),w({destinationModuleId:t.id})}}),s&&!a&&u.push({key:"move-down",render:e=>(0,D.jsx)(ye().A,{...e,title:(0,D.jsx)(v().sA,{id:"ModuleActionMenu.buttons.moveDownButton",defaultMessage:"Move down"}),icon:(0,D.jsx)(Qe,{icon:(0,Z().arrowStraightDownSmallIcon)()})}),action:()=>{(0,Ce().E)({environment:d,layoutStore:r,position:{type:"absolute",index:c+1,..."views_main_tab_modules"===(null==_?void 0:_.area)?{area:"views_main_tab_modules",viewId:_.viewId}:{area:_.area}},moduleId:t.id,sessionId:o}),w({destinationModuleId:t.id})}}),u}),[_,d,t.id,r,C,w,o]),A=(0,n.useMemo)((()=>{const e=[],n=(0,le().p)(t,"page_details"),i=(null==C?void 0:C.nonMoveableHeaderModules)??[],l=C&&"moveableCenterModules"in C?C.moveableCenterModules:[],a=C&&"moveableFooterModules"in C?(0,Be().c)(C.moveableFooterModules,y):[],b=(null==C?void 0:C.moveableModules)??[];if(c){const o=l.some((e=>e.id===t.id)),r=j({moduleGroup:o?l:a,indexOfStartOfGroup:o?i.length:i.length+l.length});e.push(...r)}else{const t=j({moduleGroup:b,indexOfStartOfGroup:i.length});e.push(...t)}if("page_main"!==(null==_?void 0:_.area)&&"views_main_tab_modules"!==(null==_?void 0:_.area)||!n?"page_details"===(null==_?void 0:_.area)&&e.push({key:"moveToMainPage",render:e=>(0,D.jsx)(ye().A,{...e,title:(0,D.jsx)(v().sA,{id:"ModuleActionMenu.buttons.moveToPage",defaultMessage:"Move to page"}),icon:(0,D.jsx)(Qe,{icon:(0,ee().n)()})}),action:()=>{S&&I?(0,Ce().E)({environment:d,position:{type:"area_relative",area:"views_main_tab_modules",viewId:I,location:"end_moveable"},moduleId:t.id,layoutStore:r,sessionId:o}):(0,Ce().E)({environment:d,position:{type:"area_relative",area:"page_main",location:"end_moveable"},moduleId:t.id,layoutStore:r,sessionId:o}),w({destinationModuleId:t.id})}}):e.push({key:"moveToSidebar",render:e=>(0,D.jsx)(ye().A,{...e,title:(0,D.jsx)(v().sA,{id:"ModuleActionMenu.buttons.moveToInfoPanel",defaultMessage:"Move to panel"}),icon:(0,D.jsx)(Qe,{icon:(0,te().arrowStraightRightSmallIcon)()})}),action:()=>{(0,Ce().E)({environment:d,position:{type:"area_relative",area:"page_details",location:"end_moveable"},moduleId:t.id,layoutStore:r,sessionId:o}),w({destinationModuleId:t.id})}}),(0,de().Fe)(t)&&(0,de().wm)(t)){let o=[];(0,V().gx)(t)?o=[t.propertyId]:(0,V().V_)(t)?o=h:(0,x().HB)(t);const n=()=>{var e;pe().createAndCommitOrAppend({environment:d,transaction:void 0,canUndo:!0,userAction:"ModuleActionsMenu.moveToPropertyGroup",perform(e){for(const t of o)(0,Te().HD)({environment:d,transaction:e,layoutStore:r,property:t})}});const t=null===(e=r.firstModuleOfType("properties"))||void 0===e?void 0:e.id;t?w({destinationModuleId:t}):s(void 0)};e.push({key:"moveToPropertiesGroupModule",render:(e,t)=>(0,D.jsx)(We,{...e,parent:t,propertyIds:o,onSelectSectionMove:n,propertyGroups:f}),action:n})}if((0,V().Yp)(t)){const o=()=>{var e;pe().createAndCommitOrAppend({environment:d,transaction:void 0,canUndo:!0,userAction:"ModuleActionsMenu.moveToRelationsGroupModule",perform(e){const o=r.getCollectionModel();if(!o)return;const n=Ie().m.createChildStore(r,o.pointer);(0,Te().HD)({environment:d,transaction:e,layoutStore:r,property:t.propertyId}),(0,ce().Z)({property:t.propertyId,visibility:"inline",schema:o.getSchema(),format:o.getFormat(),collectionStore:n,environment:d,transaction:e})}});const o=null===(e=r.firstModuleOfType("relationsGroup"))||void 0===e?void 0:e.id;o?w({destinationModuleId:o}):s(void 0)};e.push({key:"moveToRelationsGroup",render:(e,t)=>(0,D.jsx)(Re,{parent:t,onSelect:o,...e}),action:o})}if((0,de().Fe)(t)){const n=async()=>{var e;if(null==_||!_.area||!g)return;const n=await ke(t.type);if(n)switch(n){case"delete_module":pe().createAndCommitOrAppend({environment:d,transaction:void 0,canUndo:!0,perform(e){const n=r.getCollectionModel();if((0,V().gx)(t))(0,Te().HD)({environment:d,transaction:e,layoutStore:r,property:t.propertyId}),m&&n&&ue().D7({transaction:e,property:t.propertyId,visibility:"show",format:n.getFormat(),store:m});else if((0,V().V_)(t))for(const t of h)(0,Te().HD)({environment:d,transaction:e,layoutStore:r,property:t}),m&&n&&ue().D7({transaction:e,property:t,visibility:"show",format:n.getFormat(),store:m});else(0,we().U)({environment:d,layoutStore:r,position:{..."views_main_tab_modules"===(null==_?void 0:_.area)?{area:"views_main_tab_modules",viewId:_.viewId}:{area:_.area},moduleId:t.id},sessionId:o})},userAction:"ModuleActionsMenu.removePropertyFromLayout.deleteModule"});const l=null===(e=r.firstModuleOfType("properties"))||void 0===e?void 0:e.id;return void(l&&w({destinationModuleId:l}));case"delete_property_and_module":let a=[];if((0,V().gx)(t)?a=[t.propertyId]:(0,V().V_)(t)&&(a=h||[]),a.length)for(const e of a){var i;(0,me().B)({collectionContextStore:u,environment:d,property:e,schema:g,from:"table_column"}),(0,Pe().PS)({environment:d,module:t,sessionId:o,collectionId:null===(i=r.getCollectionModel())||void 0===i?void 0:i.id,layoutId:r.id,context:(0,p().We)(null==_?void 0:_.area),area:null==_?void 0:_.area,depth:0})}else(0,we().U)({environment:d,layoutStore:r,sessionId:o,position:{..."views_main_tab_modules"===(null==_?void 0:_.area)?{area:"views_main_tab_modules",viewId:_.viewId,moduleId:t.id}:{area:_.area,moduleId:t.id}}});return void s(void 0);default:(0,x().HB)(n)}};e.push({key:"removeModule",render:e=>(0,V().gx)(t)?(0,D.jsx)(ge().$,{...e,getTitleOverride:({isRequiredProperty:e})=>e?void 0:(0,D.jsx)(v().sA,{id:"ModuleActionMenu.buttons.removeFromPropertyModule",defaultMessage:"Remove from layout"}),iconTransformer:e=>(0,D.jsx)(Qe,{icon:e}),collectionContextStore:u,property:t.propertyId}):(0,D.jsx)(ye().A,{...e,title:(0,D.jsx)(v().sA,{id:"ModuleActionMenu.buttons.removeFromModule",defaultMessage:"Remove from layout"}),isRedOnHover:!0,icon:(0,D.jsx)(Qe,{icon:(0,ne().trashIcon)({width:14})})}),action:n})}return e}),[t,C,_,d,r,o,w,S,I,h,s,f,g,u,c,j,y,m]);return A}({layoutModule:e}),r=(0,d().IS)((()=>({actionButton:{position:"absolute",top:4,insetInlineEnd:4,zIndex:1e3}})),[]);return t&&0!==o.length?(0,D.jsx)("div",{style:r.actionButton,children:(0,D.jsx)(Ye,{moduleId:e.id,menuListItems:o})}):null}function Ue({moduleId:e,isModuleHoveredOrSelected:t}){const{layoutStore:o,setModuleSelection:r}=(0,E().LH)(),n=(0,a().K8)((()=>o.getModuleById(e)),[o,e]),i=(0,a().K8)((()=>{if(n&&"formQuestion"===n.type)return _e().c.createChildStore(o,{table:"form_question",id:n.formQuestionId,spaceId:o.getSpaceId()??""})}),[o,n]),s=(0,Ee().d)(),l=(0,d().IS)((e=>({iconStyle:{fill:e.palette.uiBlue[600]}})),[]),c=(0,v().tz)();if(!n||!i)return null;const u=c.formatMessage({id:"FormLayoutModuleActionMenu.editQuestion.tooltip",defaultMessage:"Edit question"});return(0,D.jsx)("div",{style:{opacity:t?1:0,pointerEvents:t?"auto":"none",transition:"opacity 200ms ease",borderRadius:4,height:24},children:(0,D.jsx)(Se().A,{render:t=>(0,D.jsx)(fe().A,{...t,icon:re()._,hasBackground:!0,style:{...s.button,cursor:"pointer"},iconStyle:l.iconStyle,pressedStyle:s.buttonPressed,hoveredStyle:s.buttonHovered,ariaLabel:u,onMouseDown:e=>{(0,R().SQ)({event:e,context:R().y$.EditorMouseDown})},onClick:()=>r({type:"existing_module",moduleId:e,isDragging:!1,draggingModuleInitialArea:void 0,draggingModuleFinalArea:void 0})}),renderTooltip:()=>u})})}function Ye({moduleId:e,menuListItems:t}){const o=(0,v().tz)(),r=(0,n.useMemo)((()=>[{type:"actionGroup",label:o.formatMessage({id:"ModuleActionMenu.openButton",defaultMessage:"Action menu for module"}),icon:re()._,menuListItems:t}]),[o,t]);return(0,D.jsx)(Je,{moduleId:e,actionMenuItems:r,isModuleHoveredOrSelected:!0,boxShadow:!1})}function Xe({isFirst:e,isLast:t}){return{borderStartStartRadius:e?4:0,borderEndStartRadius:e?4:0,borderStartEndRadius:t?4:0,borderEndEndRadius:t?4:0,borderInlineEnd:"solid rgba(15, 15, 15, 0.1)",borderInlineEndWidth:t?0:1}}function Je({moduleId:e,actionMenuItems:t,isModuleHoveredOrSelected:o,boxShadow:r}){const[i,s]=(0,n.useState)(!1),l=(0,n.useCallback)((e=>{s(e)}),[]);return(0,D.jsx)("div",{style:{opacity:o||i?1:0,pointerEvents:o||i?"auto":"none",transition:"opacity 200ms ease",borderRadius:4,height:24,boxShadow:r?"rgba(15, 15, 15, 0.1) 0px 0px 0px 1px, rgba(15, 15, 15, 0.1) 0px 2px 4px":void 0},children:t.map(((e,o)=>{const r=0===o,n=t.length-1===o;switch(e.type){case"action":return(0,D.jsx)(Ze,{item:e,isFirst:r,isLast:n},o);case"actionGroup":return(0,D.jsx)(et,{itemGroup:e,isFirst:r,isLast:n,isOpen:i,setIsOpen:l},o)}}))})}function Ze({item:e,isFirst:t,isLast:o}){const{layoutStore:r}=(0,E().LH)(),n=(0,a().K8)((()=>r.getLayoutType()),[r]),i=(0,d().IS)((e=>({iconButton:{...Xe({isFirst:t,isLast:o})},icon:{..."form"===n?{fill:e.icon.secondary}:{}}})),[t,o,n]);return(0,D.jsx)(Se().A,{render:t=>(0,D.jsx)(fe().A,{...t,icon:e.icon,hasBackground:!0,ariaLabel:e.label,style:i.iconButton,iconStyle:i.icon,onMouseDown:e=>{(0,R().SQ)({event:e,context:R().y$.EditorMouseDown})},onClick:e.action}),renderTooltip:()=>e.tooltipLabel??null,disableTooltip:!e.tooltipLabel})}function et({itemGroup:e,isFirst:t,isLast:o,isOpen:r,setIsOpen:n}){const{layoutStore:i}=(0,E().LH)(),s=(0,a().K8)((()=>i.getLayoutType()),[i]),l=(0,d().IS)((e=>({iconButton:{...Xe({isFirst:t,isLast:o})},icon:{..."form"===s?{fill:e.icon.secondary}:{fill:e.blue.text.accentPrimary}},iconButtonHovered:{..."form"===s?void 0:{background:e.blue.background.secondaryTranslucent}},sectionMenuItem:{paddingTop:4,paddingBottom:4}})),[t,o,s]);return(0,D.jsx)(ve().A,{alignmentToOrigin:"end",popupType:X().n.Popup,onClose:()=>n(!1),onClick:()=>n(!0),open:r,render:()=>(0,D.jsx)(he().A,{menuType:Me().gu.Popup,onClick:()=>n(!1),children:(0,D.jsx)(xe().Ay,{initialFocus:void 0,sections:[{key:0,render:e=>(0,D.jsx)(be().A,{...e,desktopStyle:l.sectionMenuItem}),items:e.menuListItems}],type:xe().Oh.Vertical})}),renderOrigin:t=>(0,D.jsx)(fe().A,{...t,icon:e.icon,hasBackground:"form"===s,ariaLabel:e.label,style:l.iconButton,iconStyle:l.icon,onMouseDown:e=>{(0,R().SQ)({event:e,context:R().y$.EditorMouseDown})},hoveredStyle:l.iconButtonHovered,pressedStyle:l.iconButtonHovered})})}const tt=(0,n.createContext)(void 0);tt.displayName="PageEditorModuleContext";const ot=tt.Provider;var rt=()=>o(817942);const nt=!1,it=10,st=8;function lt(e){const{isSelected:t,isDragging:o,isConfigurable:r,isDraggable:s}=function(){const e=(0,n.useContext)(tt);if(!e)throw new Error("PageEditorModuleContext not found");return e}(),{style:l,children:c,module:u,area:p,moduleMaxHeight:m}=e,g="placeholder"===u.type,{setModuleSelection:y,layoutStore:v,currentModuleSelection:f}=(0,E().LH)(),[h,x]=(0,$().B)(),b=(0,n.useRef)(null),S=(0,K().A)(h,b),M=(0,a().K8)((()=>{var e;return null===(e=v.getModel())||void 0===e?void 0:e.getLayoutType()}),[v]),I=(0,a().K8)((()=>(0,q().cq)(v)),[v]),_=(0,Y().z)();(0,Q().b)(z().A,(()=>({layoutStore:v,moduleId:u.id,moduleType:u.type,area:p,getNode:()=>b.current})),[v,u,b,p]);const C=(0,n.useCallback)((e=>{if(!r||"viewsMain"===u.type)return{};const n={margin:0,borderRadius:"form"===M?12:st,...!r||s||"form"===M&&g?{}:{cursor:"pointer",margin:"0 0 12px 0"},padding:"form"!==M||g?0:12,transition:"box-shadow 0.3s"};if(o&&!g)return{...n,...(0,W().nl)({width:3,color:e.blue.border.accentPrimary}),transform:"scale(1.03)",transition:"transform 0.8s cubic-bezier(0.5, -1.5, 0.5, 2)"};if(t&&!g)return{...n,...(0,W().nl)({width:3,color:e.blue.border.accentPrimary})};const i=null==f?void 0:f.isDragging;return x&&!i?{...n,...(0,W().nl)({width:3,color:"light"===e.mode?e.blue.border.strong:e.blue.text.tertiary})}:{...n,...(0,W().nl)({width:1,color:"light"===e.mode?e.blue.border.strong:e.blue.text.tertiary})}}),[null==f?void 0:f.isDragging,r,s,o,x,g,t,M,u.type]),w=(0,d().IS)((e=>{const t=C(e),o="form"!==M?it:"cover"===u.type?0:"formTitle"===u.type?_:it,n=g?e.palette.uiBlue[75]:"form"===M&&I?e.background.elevated:e.background.primary,i="light"===e.mode?e.palette.gray[0]:e.palette.gray[50];return{labelContainer:{height:32,backgroundColor:"light"===e.mode?e.palette.uiBlue[100]:e.palette.uiBlue[200],display:"flex",alignItems:"center",gap:4,padding:6},dragHandle:{fill:e.blue.text.accentPrimary,width:12,height:12},noDragHandle:{},label:{fontSize:14,fontWeight:500,color:e.blue.text.accentPrimary,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",paddingInlineEnd:24},previewContainer:{padding:12},container:{background:n,width:"100%",position:"relative",marginBottom:o,...r?t:{},overflow:"formTitle"!==u.type&&"viewsMain"!==u.type?"hidden":void 0,...l},mouseEventCover:{position:"absolute",top:0,insetInlineStart:0,insetInlineEnd:0,bottom:0,zIndex:999},contentFadedOverlay:{borderRadius:st,position:"absolute",background:`linear-gradient(to bottom, transparent 0%, ${i} 100%)`,width:"100%",height:m?.4*m+"px":void 0,top:m?.6*m+"px":void 0},overflowContainer:{borderRadius:st,height:`calc(100% - ${2*W().MH}px)`,width:`calc(100% - ${2*W().MH}px)`,insetInlineStart:`${W().MH}px`,overflow:"hidden",position:"relative"}}}),[C,r,u.type,l,M,_,g,I,m]),j="form"!==M&&!nt&&"viewsMain"!==u.type,A=((0,U().H)(u),x||t),k="editor"===u.type,T="discussions"===u.type,P=(0,i().X)("bottom_page_discussions_enabled");return(0,D.jsxs)("div",{style:w.container,ref:S,onClick:e=>{r&&!s&&"viewsMain"!==u.type&&y({type:"existing_module",moduleId:u.id,isDragging:!1}),r&&(0,R().SQ)({event:e,context:R().y$.Click})},className:"cover"===u.type?rt().pv:rt().hg,children:["form"!==M&&"viewsMain"!==u.type&&r?(0,D.jsxs)("div",{style:w.overflowContainer,children:[(0,D.jsxs)("div",{style:w.labelContainer,children:[s?(0,G().i)(w.dragHandle):(0,D.jsx)("div",{style:w.noDragHandle}),(0,D.jsx)("div",{style:w.label,children:(0,D.jsx)(at,{module:u})})]}),(0,D.jsx)("div",{style:w.previewContainer,children:c}),(k||T)&&P?(0,D.jsx)("div",{style:w.contentFadedOverlay}):void 0]}):c,j?(0,D.jsx)("div",{style:w.mouseEventCover}):void 0,r?(0,D.jsx)($e,{layoutType:M,module:u,isModuleHoveredOrSelected:A}):void 0]})}function at(e){const{module:t}=e;return(0,V().gx)(t)?(0,D.jsx)(dt,{module:t}):(0,D.jsx)(v().sA,{...N().s[t.type]})}function dt(e){const{module:t}=e,{collectionStore:o}=(0,E().bi)(),r=(0,a().K8)((()=>o.getSchema()),[o]),n=(0,a().K8)((()=>r[t.propertyId]),[t,r]);return n?(0,D.jsx)(D.Fragment,{children:n.name}):null}var ct=()=>o(31503),ut=()=>o(721479),pt=()=>o(994408),mt=()=>o(190033),gt=()=>o(599806),yt=()=>o(543886),vt=()=>o(894995),ft=()=>o(630960),ht=()=>o(471645),xt=()=>o(279897),bt=()=>o(511177),St=()=>o(266405),Mt=()=>o(646796),It=()=>o(710149);function _t({layoutStore:e,formQuestionId:t}){const o=(0,l().v3)(),r=(0,M().ET)(),i=(0,n.useRef)(null),{canEditLayout:s}=(0,E().LH)(),{collectionStore:d,formBlock:c}=(0,a().K8)((()=>{var e;return{collectionStore:r.collectionStore(),formBlock:null===(e=r.collectionViewStore())||void 0===e?void 0:e.getFormBlockStore()}}),[r]);if(!d)throw new Error("No collection store found");const p=(0,a().K8)((()=>e.getSpaceId()),[e]),m=(0,a().K8)((()=>{if(p)return _e().c.createChildStore(e,{table:"form_question",id:t,spaceId:p})}),[t,e,p]),g=(0,a().K8)((()=>!(null!=m&&m.isReady())),[m]),y=(0,a().K8)((()=>{var e;if(m)return null===(e=m.getConfig())||void 0===e?void 0:e.propertyId}),[m]),v=(0,a().K8)((()=>{const e=d.getSchema();return e?Object.keys(e):[]}),[d]),f=(0,a().K8)((()=>{const e=d.getSchema();if(e&&y)return(0,u()._g)({schema:e,property:y})}),[d,y],{useDeepEqual:!0}),h=(0,Mt().W)({inMemoryRecordCacheName:"FormQuestionTemporaryRecordCache",collectionSchemaPropertyIds:v,collectionId:d.id,spaceId:p,formMode:"builder"}),x=(0,a().K8)((()=>{const e=d.getSchema();if(!e||!m)return"generic_error";return(0,St().e)(o,m,e,null==c?void 0:c.hasSitePublicPermission())}),[d,o,c,m]),{autofocusedQuestionTextStore:b}=(0,S().cJ)(),I=(0,a().K8)((()=>Boolean(b.state&&b.state.questionId===(null==m?void 0:m.id))),[b,null==m?void 0:m.id]);return(0,n.useEffect)((()=>{var e,t;m&&(I&&("title"===(null===(e=b.state)||void 0===e?void 0:e.questionInputType)?(0,pt().C)({environment:o,store:m.getNameStore(),canSelectAllBlocks:!1,contentEditableContextId:void 0}):"description"===(null===(t=b.state)||void 0===t?void 0:t.questionInputType)&&(0,mt().z)({store:m.getDescriptionStore()}),b.clear()))}),[b,o,I,m]),g?(0,D.jsx)(Ct,{}):m&&y&&d&&h?(0,D.jsxs)("div",{ref:i,children:[(0,D.jsx)(wt,{formQuestionStore:m}),x?(0,D.jsx)(kt,{questionErrorState:x,propertyType:null==f?void 0:f.type}):(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(jt,{formQuestionStore:m}),f&&(0,ct().OG)(f)?(0,D.jsx)(At,{formQuestionStore:m,propertySchema:f}):void 0,(0,D.jsx)(gt().q,{store:h,property:y,disabled:!0,locked:!s,surface:"form_editor",blockPropertyValueOverlayStore:yt().A,collectionStore:d,tableWrap:!1,formQuestionStore:m},y)]})]}):null}function Ct(){const e=(0,d().IS)((e=>({questionTitleShimmer:{borderRadius:8,height:22,width:200},questionInputShimmer:{borderRadius:5,height:16,width:"100%",marginTop:12}})),[]);return(0,D.jsxs)("div",{children:[(0,D.jsx)(It().A,{style:e.questionTitleShimmer}),(0,D.jsx)(It().A,{style:e.questionInputShimmer})]})}function wt({formQuestionStore:e}){const t=(0,l().v3)(),o=(0,M().ET)(),{collectionStore:r}=(0,S().cJ)(),{canEditLayout:i}=(0,E().LH)(),s=(0,a().K8)((()=>Boolean(o.normalizedSchemaStore.state)),[o]),d=(0,n.useMemo)((()=>(0,h().sg)((()=>{(0,vt().maybeSyncQuestionNameToPropertyName)({environment:t,questionStore:e,collectionStore:r,collectionContextStore:o})}),500)),[o,r,t,e]),c=!i;return s&&r?(0,D.jsx)(bt().j,{formMode:"builder",disabled:c,onChange:d,formQuestionStore:e}):null}function jt({formQuestionStore:e}){const{canEditLayout:t}=(0,E().LH)(),o=!t;return(0,D.jsx)(ht().P,{disabled:o,formQuestionStore:e,formMode:"builder"})}function At(e){return(0,D.jsx)(xt().A,{...e,formMode:"builder"})}function kt({questionErrorState:e,propertyType:t}){const o=(0,d().IS)((e=>({helpIcon:{marginInlineStart:6},container:{display:"flex",flexDirection:"row",alignItems:"center",paddingInlineStart:8},textSpan:{color:e.text.tertiary}})),[]),r=(0,n.useMemo)((()=>{switch(e){case"deleted_property":return(0,D.jsx)(v().sA,{id:"BrokenLinkedPropertyWarning.deletedProperty",defaultMessage:"This question’s corresponding property has been deleted."});case"invalid_property_type":return(0,D.jsx)(v().sA,{id:"BrokenLinkedPropertyWarning.invalidProperty",defaultMessage:"This question’s corresponding property is not supported."});case"invalid_property_type_for_public_form":return"person"===t?(0,D.jsx)(v().sA,{id:"BrokenLinkedPropertyWarning.invalidPublicProperty.person",defaultMessage:"Person property is not supported in public forms."}):(0,D.jsx)(v().sA,{id:"BrokenLinkedPropertyWarning.invalidPublicProperty.generic",defaultMessage:"This question’s linked property type is not supported in public forms."});case"related_collection_not_public":return(0,D.jsx)(v().sA,{...ft().yh.relatedCollectionNotPublic});case"generic_error":return(0,D.jsx)(v().sA,{id:"BrokenLinkedPropertyWarning.message",defaultMessage:"Something is wrong with this linked property."})}}),[t,e]),i=(0,n.useMemo)((()=>{switch(e){case"deleted_property":return(0,D.jsx)(v().sA,{id:"BrokenLinkedPropertyWarning.deletedProperty.helperTooltip",defaultMessage:"Delete this question or link it to a different property."});case"invalid_property_type":return(0,D.jsx)(v().sA,{id:"BrokenLinkedPropertyWarning.invalidProperty.helperTooltip",defaultMessage:"Change the question type to a supported type"});case"generic_error":return(0,D.jsx)(v().sA,{id:"BrokenLinkedPropertyWarning.genericError.helperTooltip",defaultMessage:"Delete this question or link it to a different property."})}}),[e]);return(0,D.jsxs)("div",{style:o.container,children:[(0,D.jsx)("span",{style:o.textSpan,children:r}),(0,D.jsx)(Se().A,{renderTooltip:()=>(0,D.jsx)("div",{style:{width:240,whiteSpace:"pre-wrap"},children:i}),disableTooltip:"invalid_property_type_for_public_form"===e||"related_collection_not_public"===e,render:t=>"invalid_property_type_for_public_form"===e||"related_collection_not_public"===e?null:(0,D.jsx)("div",{...t,style:o.helpIcon,children:(0,D.jsx)(De().I,{icon:ut().questionMarkCircleSmallIcon,size:"sm",colorVariant:"secondary"})})})]})}var Tt=()=>o(963900),Pt=()=>o(661344),Bt=()=>o(601726),Ft=()=>o(578405),Et=()=>o(660197),Dt=(o(672577),()=>o(718827)),Ot=()=>o(631524),Lt=()=>o(214388),Ht=()=>o(412532),Rt=()=>o(626466);const Kt={viewBox:"0 0 16 16",fittedViewBox:"1.87 1.87 12.26 12.26",svg:(0,D.jsx)("path",{d:"M1.875 4a2.125 2.125 0 1 1 2.75 2.032V10c0 .76.616 1.375 1.375 1.375h3.968a2.126 2.126 0 1 1 0 1.25H6A2.625 2.625 0 0 1 3.375 10V6.032A2.13 2.13 0 0 1 1.875 4M4 3.125a.875.875 0 1 0 0 1.75.875.875 0 0 0 0-1.75M11.125 12a.875.875 0 1 0 1.75 0 .875.875 0 0 0-1.75 0"})},Qt=(0,Ge().wt)("nodeTopLeftBottomRightSmall",Kt);var Gt=()=>o(617668),Vt=()=>o(37165),qt=()=>o(751735),Wt=()=>o(249947),$t=()=>o(832857),zt=()=>o(98205),Nt=()=>o(147503),Ut=()=>o(447453),Yt=()=>o(261503),Xt=()=>o(439264),Jt=()=>o(417392),Zt=()=>o(152197),eo=()=>o(170253),to=()=>o(991249),oo=()=>o(329304);function ro(e){const{parentModule:t}=e,o=(0,a().K8)((()=>t.conditionalGroups),[t],{useDeepEqual:!0});return o?(0,D.jsx)(D.Fragment,{children:o.map((e=>(0,D.jsx)(no,{conditionalGroup:e,parentModule:t},e.id)))}):null}function no(e){var t;const{conditionalGroup:o,parentModule:r}=e,i=(0,l().v3)(),{setModuleSelection:s,currentModuleSelection:c,canEditLayout:u,layoutStore:p,sessionId:m}=(0,E().LH)(),g=(0,Zt().r)(),{formConditionalGroupsStore:y}=(0,S().cJ)(),v=(0,a().K8)((()=>{const e=(0,zt().h8)(r.id,o.id);return!y.state.conditionalGroupCollapsedStates[e]}),[o.id,y,r.id]),f=(0,n.useMemo)((()=>new(eo().A)),[]),[x,b]=(0,n.useState)(!1),[M,I]=(0,n.useState)(!1),_=(0,d().IS)((e=>({conditionalGroupContainer:{display:"flex",cursor:"auto",paddingTop:20},conditionalGroupContent:{display:"flex",flexDirection:"column",paddingBottom:12,paddingInlineStart:10,marginInlineStart:4,cursor:"auto",flexGrow:1},draggableList:{gap:24,display:"flex",flexDirection:"column"}})),[]),C=(0,a().K8)((()=>{var e;const t=null===(e=r.conditionalGroups)||void 0===e?void 0:e.find((e=>e.id===o.id));return t?t.children??[]:[]}),[o,r]),w=(0,n.useCallback)((e=>{const t="existing_module"===(null==c?void 0:c.type)&&c.moduleId===e;return(0,D.jsx)(So,{pageModuleId:e,active:t,area:"form_conditional_modules"})}),[c]),j=(0,a().K8)((()=>{const e=p.getModules().form_conditional_modules;if(!e)return!0;return C.some((t=>"formQuestion"===e[t].type))}),[C,p]),A=(0,oo()._X)({name:"forms_conditional_logic",spaceId:g,userId:null===(t=i.currentUser)||void 0===t?void 0:t.id}),k=null==A?void 0:A.upsell,T=void 0===r.parentModuleId&&k,P=(0,n.useCallback)(((e,{key:t,endPosition:n})=>{(0,Ce().E)({environment:i,layoutStore:p,position:{type:"absolute",area:"form_conditional_modules",parentConditionalGroupId:o.id,parentModuleId:r.id,index:n},moduleId:t,sessionId:m})}),[o.id,i,p,r.id,m]),B=(0,n.useCallback)((()=>{const e=(0,zt().h8)(r.id,o.id),t=y.state.conditionalGroupCollapsedStates[e];y.setState({conditionalGroupCollapsedStates:{...y.state.conditionalGroupCollapsedStates,[e]:!t}})}),[o.id,y,r.id]),F=(0,n.useCallback)((()=>{s(void 0)}),[s]),O=(0,n.useCallback)((e=>{e&&s({type:"existing_module",moduleId:e,isDragging:!1})}),[s]);return(0,D.jsxs)("div",{onMouseDown:e=>{b(!1),I(!1),(0,R().SQ)({event:e,context:R().y$.EditorMouseDown,callback:h().D_})},children:[T?(0,D.jsx)(io,{upsell:k}):void 0,(0,D.jsxs)("div",{style:_.conditionalGroupContainer,children:[(0,D.jsx)(so,{isGroupExpanded:v,toggleGroupVisibility:B}),(0,D.jsxs)("div",{style:_.conditionalGroupContent,children:[(0,D.jsx)(lo,{parentModule:r,groupId:o.id,trigger:o.trigger,isGroupExpanded:v,filterOptionsPopupOpen:x,setFilterOptionsPopupOpen:b,filterOperatorPopupOpen:M,setFilterOperatorPopupOpen:I}),v?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(Xt().Ay,{className:rt().hg,store:f,keys:C,direction:"vertical",onDrop:(e,t)=>{P(e,t)},onDragCancel:F,hoverCursorStyleOverride:1===C.length?"pointer":void 0,onClick:O,draggingStyle:{display:void 0},draggingStyleForNonDraggedItems:{display:void 0},renderKey:e=>w(e),disabled:!u,style:_.draggableList}),j?(0,D.jsx)(po,{parentModuleId:r.id,parentConditionalGroupId:o.id}):void 0]}):void 0]})]})]})}function io(e){const{upsell:t}=e,o=(0,l().v3)(),r=(0,d().IS)((e=>({container:{color:e.yellow.text.secondary,background:e.yellow.background.secondaryTranslucent,borderRadius:6,width:"100%",padding:"10px 22px",marginTop:24,fontSize:14,display:"flex",alignItems:"center"},upgradeButton:{marginInlineEnd:-4,color:e.yellow.text.secondary,fontWeight:b().Wy.medium},upgradeButtonHovered:{backgroundColor:(0,qt().X4)(e.yellow.text.secondary,.1)},upgradeButtonPressed:{backgroundColor:(0,qt().X4)(e.yellow.text.secondary,.2)}})),[]);return(0,D.jsxs)("div",{style:r.container,children:[(0,D.jsx)("div",{style:{width:"90%",marginInlineEnd:10},children:(0,D.jsx)(v().sA,{id:"upgradeForConditionalLogicWarning.warning",defaultMessage:"Conditional logic is only available on Business and Enterprise plan types."})}),(0,D.jsx)(Ot().p,{style:r.upgradeButton,hoveredStyle:r.upgradeButtonHovered,pressedStyle:r.upgradeButtonPressed,onMouseDown:()=>{to().K(o,{upsell:t,from:"forms_conditional_logic"})},children:(0,D.jsx)(v().sA,{id:"upgradeForConditionalLogicWarning.upgrade",defaultMessage:"Upgrade"})})]})}function so(e){const{isGroupExpanded:t,toggleGroupVisibility:o}=e,r=(0,d().IS)((e=>({groupBar:{gap:6,opacity:"light"===e.mode?.5:.75,color:e.blue.text.tertiary,display:"flex",flexDirection:"column",alignItems:"center",marginTop:3,paddingInlineStart:26},toggleHovered:{background:void 0,opacity:"light"===e.mode?.8:1},toggleIcon:{height:14,width:14,transform:t?"rotate(180deg)":"rotate(90deg)",fill:e.blue.text.tertiary}})),[t]);return(0,D.jsxs)(Dt().Ay,{style:r.groupBar,onClick:o,hoveredStyle:r.toggleHovered,pressedStyle:r.toggleHovered,children:[(0,Ht().l)(r.toggleIcon),(0,D.jsx)("div",{style:{width:2,flexGrow:1,background:"linear-gradient(0deg, rgba(35, 131, 226, 0) 0px, rgba(35, 131, 226, 0.57) 64px)",borderRadius:1,opacity:.4}})]})}function lo(e){const{isGroupExpanded:t,groupId:o,trigger:r,parentModule:i,filterOptionsPopupOpen:s,setFilterOptionsPopupOpen:c,filterOperatorPopupOpen:u,setFilterOperatorPopupOpen:p}=e,m=(0,v().tz)(),g=(0,l().v3)(),{layoutStore:y,sessionId:f}=(0,E().LH)(),{isCollectionEmpty:x}=(0,S().cJ)(),b=(0,M().ET)(),I=(0,Zt().r)(),_=(0,a().K8)((()=>{const e=r.filter;if((0,Lt().gc)(e)&&((0,Lt().v0)(e)||(0,Lt().as)(e))){return(0,Lt().v0)(e)?(0,Lt().Zl)(e):(0,Lt().SM)(e)}}),[r]),C=(0,n.useMemo)((()=>(0,Lt().Ui)(r.filter)?void 0===r.filter.value.value:0===(null==_?void 0:_.length)),[r.filter,_]),w=(0,d().IS)((e=>({indentedBranchContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:14,marginBottom:12},triggerText:{display:"flex",alignItems:"center",gap:4,color:e.blue.text.tertiary},deleteButton:{width:20,height:20},deleteIcon:{width:18,height:18},triggerOption:{color:e.blue.text.accentPrimary},descendantCount:{display:"flex",alignItems:"center",gap:4,marginInlineStart:4},popupButton:{display:"flex",padding:"0px 3px",borderRadius:4,color:e.blue.text.accentPrimary},triggerButtonHoveredStyle:{background:e.lightBlueBannerBackground},triggerButtonPressedStyle:{background:e.lightBlueBannerBackground},chevronIcon:{height:14,width:14,color:e.blue.text.accentPrimary,marginTop:3,marginInlineStart:2},triggerOptionText:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:300,color:C?e.blue.text.disabled:void 0}})),[C]),[j,A]=(0,n.useState)(!1),k=(0,n.useMemo)((()=>j),[j]),T=(0,a().K8)((()=>y.getModules().form_conditional_modules||{}),[y]),P=(0,n.useMemo)((()=>{var e;const t=null===(e=i.conditionalGroups)||void 0===e?void 0:e.find((e=>e.id===o));if(!t)return 0;let r=0;for(const o of t.children??[]){const e=T[o];if(!e||"formQuestion"!==e.type)continue;const{formQuestionDescendants:t}=(0,zt().Yg)({currentModule:e,nestedModules:T,includePlaceholders:!1});r+=t.length}return r}),[i,o,T]),B=(0,a().K8)((()=>{var e;if(!I)return;const t=_e().c.createChildStore(y,{id:i.formQuestionId,table:Vt().lo,spaceId:I}),o=null===(e=b.collectionStore())||void 0===e?void 0:e.getSchema();if(!o)return;const r=o[t.getPropertyId()??""];return(0,ct().hm)(r,t.getModel())}),[i.formQuestionId,y,I,b]),F=(0,a().K8)((()=>{if(!_||_.length<2||(0,Lt().Ui)(r.filter))return;const e=r.filter;return(0,Lt().v0)(e)?"any":"enum_contains_all"===e.operator?"all":"any"}),[r,_]),O=(0,a().K8)((()=>{if(!F)return;const e="any"===F?(0,D.jsx)(v().sA,{defaultMessage:"any",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.FilterOperator.any"}):(0,D.jsx)(v().sA,{defaultMessage:"all",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.FilterOperator.all"});return(0,Lt().v0)(r.filter)||1===B?e:(0,D.jsx)(Jt().Ay,{popupType:Jt().nl.Popup,placementToOrigin:"bottom",alignmentToOrigin:"start",style:{marginInlineStart:-14},open:u,origin:(0,D.jsxs)(Dt().Ay,{onMouseDown:e=>{(0,R().SQ)({event:e,context:R().y$.EditorMouseDown,callback:h().D_})},onClick:()=>p(!0),style:w.popupButton,hoveredStyle:w.triggerButtonHoveredStyle,pressedStyle:w.triggerButtonPressedStyle,children:[e,(0,Rt().arrowChevronSingleDownFillIcon)(w.chevronIcon)]}),onDismiss:()=>p(!1),disableMouseCapture:!0,enableOutsideClickDismiss:!0,originGap:6,render:()=>(0,D.jsx)(ao,{trigger:r,currentOperator:F,parentModule:i,conditionalGroupId:o}),trapFocus:!0})}),[F,r,B,u,p,w,i,o]),L=(0,a().K8)((()=>{if((0,Lt().Ui)(r.filter))switch(r.filter.value.value){case!0:return(0,D.jsx)(v().sA,{defaultMessage:"checked",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.IfCheckboxIsChecked"});case!1:return(0,D.jsx)(v().sA,{defaultMessage:"unchecked",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.IfCheckboxIsUnchecked"});default:return(0,D.jsx)(v().sA,{defaultMessage:"Select",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.NoOptionsSelected"})}return _&&0!==_.length?_.map((e=>e.value)).join(", "):(0,D.jsx)(v().sA,{defaultMessage:"Select",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.NoOptionsSelected"})}),[_,r.filter]),H=(0,a().K8)((()=>(0,D.jsx)(Jt().Ay,{popupType:Jt().nl.Popup,placementToOrigin:"bottom",alignmentToOrigin:"start",style:{marginInlineStart:-14},open:s,origin:(0,D.jsxs)(Dt().Ay,{style:w.popupButton,onMouseDown:e=>{(0,R().SQ)({event:e,context:R().y$.EditorMouseDown,callback:h().D_})},onClick:()=>c(!0),hoveredStyle:w.triggerButtonHoveredStyle,pressedStyle:w.triggerButtonPressedStyle,children:[(0,D.jsx)("span",{style:w.triggerOptionText,children:L}),(0,Rt().arrowChevronSingleDownFillIcon)(w.chevronIcon)]}),onDismiss:()=>c(!1),disableMouseCapture:!0,enableOutsideClickDismiss:!0,originGap:6,render:()=>(0,D.jsx)(co,{parentModule:i,trigger:r,groupId:o}),trapFocus:!0})),[s,L,o,i,c,w,r]),K=(0,n.useCallback)((()=>{A(!0)}),[]),Q=(0,n.useCallback)((()=>{A(!1)}),[]),G=(0,n.useCallback)((()=>{$t().FG({environment:g,parentModule:i,layoutStore:y,groupId:o,collectionContextStore:b,isCollectionEmpty:x,sessionId:f})}),[g,i,o,y,b,x,f]),V=(0,a().K8)((()=>(0,Lt().v0)(r.filter)||(0,Lt().as)(r.filter)?F?(0,D.jsx)(v().sA,{defaultMessage:"If {filterOperatorPopup} of {filterValuesPopup} is selected",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.IfFilterValueIsSelected",values:{filterOperatorPopup:O,filterValuesPopup:H}}):(0,D.jsx)(v().sA,{defaultMessage:"If {filterValuesPopup} is selected",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.SimpleFilter.Trigger",values:{filterValuesPopup:H}}):(0,Lt().Ui)(r.filter)?(0,D.jsx)(v().sA,{defaultMessage:"If {filterValuesPopup}",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.Checkbox",values:{filterValuesPopup:H}}):void 0),[F,O,H,r.filter]);return(0,D.jsxs)("div",{style:w.indentedBranchContainer,onMouseMove:K,onMouseLeave:Q,children:[(0,D.jsxs)("div",{style:w.triggerText,children:[V,!t&&P>0?(0,D.jsxs)("div",{style:w.descendantCount,children:[(0,D.jsx)(De().I,{icon:Qt,size:"sm"}),(0,D.jsx)("span",{children:P})]}):void 0]}),k?(0,D.jsx)(Se().A,{placement:"top",textWrap:!1,renderTooltip:()=>(0,D.jsx)(v().sA,{defaultMessage:"Delete condition",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.DeleteIcon.Tooltip.title"}),render:e=>(0,D.jsx)(fe().A,{style:w.deleteButton,iconStyle:w.deleteIcon,colorPalette:"blue",colorVariant:"accentPrimary",onClick:G,icon:ne().trashIcon,ariaLabel:m.formatMessage({defaultMessage:"Delete condition",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.DeleteIcon.title"}),...e})}):void 0]})}function ao(e){const{currentOperator:t,trigger:o,parentModule:r,conditionalGroupId:n}=e,i=(0,l().v3)(),{layoutStore:s}=(0,E().LH)(),a=[{key:"any",render:e=>(0,D.jsx)(ye().A,{...e,disabled:!1,title:(0,D.jsx)(v().sA,{defaultMessage:"any",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.FilterOperator.any"}),isChecked:"any"===t}),action:()=>{(0,Lt().gc)(o.filter)&&(0,Lt().as)(o.filter)&&$t().Is({environment:i,layoutStore:s,module:r,conditionalGroupId:n,newValue:{...o.filter,operator:"enum_contains"}})}},{key:"all",render:e=>(0,D.jsx)(ye().A,{...e,disabled:!1,title:(0,D.jsx)(v().sA,{defaultMessage:"all",id:"FormConditionalLogicModuleRenderer.ConditionTrigger.FilterOperator.all"}),isChecked:"all"===t}),action:()=>{(0,Lt().gc)(o.filter)&&(0,Lt().as)(o.filter)&&$t().Is({environment:i,layoutStore:s,module:r,conditionalGroupId:n,newValue:{...o.filter,operator:"enum_contains_all"}})}}],d=[{key:0,render:e=>(0,D.jsx)(be().A,{...e}),items:a}],c={menuType:Me().gu.Popup,width:200};return(0,D.jsx)(he().A,{...c,children:(0,D.jsx)(xe().Ay,{type:xe().Oh.Vertical,sections:d,onAccept:()=>{},initialFocus:void 0})})}function co(e){const{parentModule:t,trigger:o,groupId:r}=e,n=(0,l().v3)(),{layoutStore:i,canEditLayout:s}=(0,E().LH)(),d=(0,M().ET)(),{collectionViewStore:c,schema:u}=(0,a().K8)((()=>{const e=d.collectionStore();if(!e)throw new Error("No collection store found");return{collectionViewStore:d.collectionViewStore(),schema:e.getSchema()}}),[d]);return c?(0,D.jsx)(Wt().td,{collectionViewId:c.id,propertyFilter:o,schema:u,parentStore:c,onChange:e=>{$t().Is({environment:n,layoutStore:i,module:t,conditionalGroupId:r,newValue:e})},onChangeDebounced:h().lQ,onClose:h().lQ,onDelete:h().lQ,onAddToCombinatorFilter:h().lQ,context:Wt().mL.PropertyFilter,userCanConfigureFilters:s,allowRelativeDateFilter:!1,allowRelativePersonFilter:!1,collectionContextStore:d}):null}function uo(){const e=(0,d().IS)((e=>({container:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",height:"100%",gap:8,color:e.blue.text.accentPrimary},plusIcon:{borderRadius:"100%",background:e.blue.background.secondaryTranslucent,width:20,height:20,padding:2,boxShadow:`0 0 0 3px ${e.blue.background.secondaryTranslucent}`,marginInlineEnd:4}})),[]);return(0,D.jsxs)("div",{style:e.container,children:[(0,D.jsx)(De().I,{icon:Gt().plusIcon,style:e.plusIcon}),(0,D.jsx)("span",{children:(0,D.jsx)(v().sA,{defaultMessage:"Add or select questions",id:"FormConditionalLogicModuleRenderer.NestedPlaceholderModuleTitle"})})]})}function po(e){var t;const o=(0,l().v3)(),r=(0,Zt().r)(),{parentModuleId:i,parentConditionalGroupId:s}=e,c=(0,M().ET)(),u=(0,n.useRef)(null),p=(0,a().K8)((()=>{const e=(0,Yt().S)(c.settingsStore);return"formQuestionCreateSettings"===(null==e?void 0:e.type)&&c.settingsStore.state.ref===u}),[c.settingsStore,u]),m=(0,d().IS)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"center",width:"100%",marginTop:12},plusButton:{borderRadius:"100%",background:e.blue.background.secondaryTranslucent,width:20,height:20,padding:2,boxShadow:`0 0 0 3px ${e.blue.background.secondaryTranslucent}`,marginInlineEnd:4},pressedStyle:{background:void 0,color:e.blue.text.accentPrimary},hoveredStyle:{background:void 0,color:e.blue.text.accentPrimary},buttonStyle:{height:32,color:p?e.blue.text.accentPrimary:e.blue.text.tertiary,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:8}})),[p]),g=(0,n.useCallback)((()=>{(0,Ut().O)({collectionContextStore:c,collectionSettingsStore:c.settingsStore,ref:u}),Nt().dP({collectionSettingsStore:c.settingsStore,item:{type:"formQuestionCreateSettings",area:"form_conditional_modules",parentModuleId:i,parentConditionalGroupId:s},ref:u})}),[c,u,i,s]),y=(0,oo()._X)({name:"forms_conditional_logic",spaceId:r,userId:null===(t=o.currentUser)||void 0===t?void 0:t.id});return(null==y?void 0:y.upsell)?null:(0,D.jsx)("div",{style:m.container,ref:u,children:(0,D.jsxs)(Ot().p,{onClick:g,onMouseDown:e=>{(0,R().SQ)({event:e,context:R().y$.EditorMouseDown})},style:m.buttonStyle,pressedStyle:m.pressedStyle,hoveredStyle:m.hoveredStyle,children:[(0,D.jsx)(De().I,{icon:Gt().plusIcon,style:m.plusButton}),(0,D.jsx)("span",{children:(0,D.jsx)(v().sA,{defaultMessage:"Add more questions",id:"FormConditionalLogicModuleRenderer.NestedAddMoreQuestionsButton"})})]})})}const mo={transcript:!0,bottomControls:!0,expandedBacklinks:!0,inlinePageSections:!0},go=480,yo=300,vo={editor:!0,discussions:!0};function fo(e,t){return"viewsMain"===e.type?{minHeight:"500px"}:"editor"===e.type?{maxHeight:t?`${go}px`:void 0}:"discussions"===e.type?{maxHeight:t?`${yo}px`:void 0}:void 0}function ho(e){if(e)switch(e.type){case"editor":return go;case"discussions":return yo;default:return}}const xo="16px",bo=o(757695).Store.createValue(!1,{name:"HEADER_FOCUS_STORE"});function So({pageModuleId:e,active:t=!1,isDragging:o=!1,area:r,style:l}){const{layoutStore:d}=(0,E().LH)(),c=(0,a().K8)((()=>null==d?void 0:d.getModuleById(e)),[d,e],{useDeepEqual:!0}),u=(0,i().X)("bottom_page_discussions_enabled"),p=(0,a().K8)((()=>!!c&&(0,g()._)(c,u)),[c,u]),m=(0,a().K8)((()=>{var e;return null===(e=d.getModel())||void 0===e?void 0:e.getLayoutType()}),[d]),v=(0,a().K8)((()=>!s().A.isMobile&&(!!c&&(("form"!==m||"placeholder"!==c.type)&&(0,y().iw)(c,u)))),[m,c,u]),f=(0,n.useMemo)((()=>({isSelected:t,isDragging:o,isConfigurable:p,isDraggable:v})),[t,o,p,v]);return c?(0,D.jsx)(ot,{value:f,children:"form"===m?(0,D.jsx)(_o,{pageModule:c,style:l}):(0,D.jsx)(Mo,{pageModule:c,style:l,area:r})}):null}const Mo=n.memo(Io);function Io({pageModule:e,style:t,area:r}){const{pageStore:s}=(0,E().bi)(),c=(0,a().K8)((()=>Boolean(s.getCover())),[s]),u=(0,m().Lv)(e).type,p=e.type,g=(0,l().v3)(),y=(0,a().K8)((()=>(0,o(577814).A)({environment:g,store:s,pageViewBlockStore:void 0})),[g,s]),v=(0,i().X)("bottom_page_discussions_enabled"),f=(0,d().IS)((()=>{return{wrapper:{...fo(e,v),opacity:v||(o=e,!0!==(null==vo?void 0:vo[o.type]))?void 0:"33%",marginTop:c&&"normalizedTitleWithIcon"===p?"-50px":void 0,...t}};var o}),[c,e,p,t,v]),b=(0,n.useCallback)((t=>(0,D.jsx)(lt,{module:e,style:f.wrapper,area:r,moduleMaxHeight:ho(e),children:t})),[e,f.wrapper,r]);if((0,n.useEffect)((()=>{const e=s.getContentStore();if(e)return C().A.setLimitParents(s,{[e.id]:12}),()=>{C().A.removeLimitParents(s)}}),[s]),mo[u])return null;switch(p){case"cover":return(0,D.jsx)(wo,{wrapper:b,pageStore:s,isEditable:!1},`${e.id}-${s.id}`);case"properties":return(0,D.jsx)(To,{pageStore:s,wrapper:b,pageModule:e},`${e.id}-${s.id}`);case"viewsMain":case"views":return(0,D.jsx)(O,{wrapper:b,viewsModule:e},`${e.id}-${s.id}`);case"property_title":case"property_text":case"property_url":case"property_email":case"property_phone_number":case"property_checkbox":case"property_person":case"property_created_by":case"property_last_edited_by":case"property_file":case"property_select":case"property_multi_select":case"property_status":case"property_number":case"property_date":case"property_created_time":case"property_last_edited_time":case"property_last_visited_time":case"property_formula":case"property_relation":case"property_rollup":case"property_button":case"property_auto_increment_id":case"property_location":case"property_verification":case"property_place":return(0,D.jsx)(o(483832).v,{propertyId:e.propertyId,context:w().Rr.Frame,disabled:!0,store:s,pageModule:e,wrapper:b,stackPropertyLabelAndValue:!0},`${e.id}-${s.id}`);case"normalizedTitleWithIcon":return(0,D.jsx)(jo,{wrapper:b,module:e},`${e.id}-${s.id}`);case"editor":return(0,D.jsx)(o(729923).p,{context:w().Rr.Frame,disabled:!0,handlePlaceholderWrapClick:h().lQ,pageBlockStore:s,editorWrapper:b},`${e.id}-${s.id}`);case"discussions":return(0,D.jsx)(o(257502).d,{store:s,wrapper:b,showDefaultTitle:!0,discussionLocation:"page_discussion",pageDiscussionsRenderState:y},`${e.id}-${s.id}`);case"inlinePageSections":return(0,D.jsx)(Ao,{wrapper:b},`${e.id}-${s.id}`);case"relationsGroup":return(0,D.jsx)(o(996262).z,{pageStore:s,wrapper:b,disabled:!0,context:w().Rr.Frame,showDefaultTitle:!0});case"transcript":case"bottomControls":case"expandedBacklinks":case"deleted_property":return null;case"formQuestion":case"formTitle":case"formSubmit":case"placeholder":case"recentActivity":case"collaborators":case"teamspaces":case"row":case"view":throw new Error(`Cannot render ${p} in page layout editor.`);default:(0,x().HB)(p)}}function _o({pageModule:e,style:t}){const o=(0,m().Lv)(e).type,{layoutStore:i,canEditLayout:s}=(0,E().LH)(),{formBlockStore:l,headerFocusStore:c,headerMouseStore:u}=(0,S().cJ)(),p=(0,M().ET)(),g=(0,a().K8)((()=>p.permissionScopesStore.state.canConfigureCollection),[p.permissionScopesStore]),y=(0,n.useCallback)((()=>{u.setState({...u.state,mouseEntered:!0})}),[u]),v=(0,n.useCallback)((()=>{u.setState({...u.state,mouseEntered:!1})}),[u]),h=(0,a().K8)((()=>{var e;const t=null===(e=p.collectionViewBlockStore())||void 0===e?void 0:e.getParentBlockStore();return null==t?void 0:t.getFormatStore().getKeyStore("block_color").getValue()}),[p]),b=(0,a().K8)((()=>"formQuestion"===e.type&&e.conditionalGroups&&e.conditionalGroups.length>0),[e]),I=(0,a().K8)((()=>{var t;return void 0!==(null===(t=i.getModules().form_conditional_modules)||void 0===t?void 0:t[e.id])}),[i,e]),_=(0,d().IS)((e=>({formTitleWrapper:{background:h?(0,f().ed)(h,e).background:void 0}})),[h]);if(mo[o])return null;const C=o=>(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(lt,{module:e,style:t,area:I?"form_conditional_modules":"form_layout_schema",children:o}),b&&"formQuestion"===e.type?(0,D.jsx)(ro,{parentModule:e}):void 0]}),w=e.type;switch(w){case"formTitle":return C((0,D.jsxs)("div",{style:_.formTitleWrapper,children:[(0,D.jsx)("div",{style:{paddingInlineStart:xo},children:(0,D.jsx)(Tt().zE,{formBlockStore:l,disabled:!s,formMode:"builder",headerFocusStore:c,onHeaderMouseEnter:y,onHeaderMouseLeave:v})}),(0,D.jsx)(Tt().Y1,{collectionContextStore:p,formBlockStore:l})]}));case"formQuestion":return C((0,D.jsx)(_t,{layoutStore:i,formQuestionId:e.formQuestionId}));case"formSubmit":return null;case"placeholder":return C((0,D.jsx)(r().P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:I?72:36},transition:{duration:.2},children:I?(0,D.jsx)(uo,{}):void 0},"placeholderModule"));case"cover":return(0,D.jsx)(wo,{wrapper:C,pageStore:l,isEditable:g},e.id);case"property_title":case"property_text":case"property_url":case"property_email":case"property_phone_number":case"property_checkbox":case"property_person":case"property_created_by":case"property_last_edited_by":case"property_file":case"property_select":case"property_multi_select":case"property_status":case"property_number":case"property_date":case"property_created_time":case"property_last_edited_time":case"property_last_visited_time":case"property_formula":case"property_relation":case"property_rollup":case"property_button":case"property_auto_increment_id":case"property_location":case"property_verification":case"property_place":case"normalizedTitleWithIcon":case"inlinePageSections":case"expandedBacklinks":case"discussions":case"bottomControls":case"editor":case"transcript":case"properties":case"views":case"viewsMain":case"relationsGroup":case"deleted_property":case"recentActivity":case"collaborators":case"teamspaces":case"row":case"view":throw new Error("Cannot render these modules in a form.");default:(0,x().HB)(w)}}const Co=160;function wo(e){const{wrapper:t,pageStore:o,isEditable:r}=e;return(0,a().K8)((()=>Boolean(o.getCover())),[o])?t((0,D.jsx)(Bt().f,{store:o,isEditable:r,onMouseEnter:h().lQ,onMouseLeave:h().lQ,paddingX:0,pageCoverHeight:Co})):(0,D.jsx)("div",{className:rt().hg,style:{height:0}})}function jo(e){const{wrapper:t,module:o}=e,{pageStore:r,collectionStore:n}=(0,E().bi)(),i=(0,a().K8)((()=>n.getFormat()),[n]),s=(0,a().K8)((()=>Boolean(r.getCover())),[r]),{backlinksConfiguredToShowAboveTitle:l}=(0,A().X1)({format:i}),d=l?(0,D.jsx)("div",{style:{marginTop:8},children:(0,D.jsx)(H().y,{pageStore:r})}):void 0,c=(0,M().ET)();return t((0,D.jsx)(Et().H,{store:r,context:w().Rr.Frame,isEditable:!1,headerControls:d,hasCover:s,isInSidePeek:!1,headerFocusStore:bo,openMenuOnMount:!1,openMenuOnMountCallback:h().lQ,disabled:!0,titlePlaceholder:void 0,collectionContextStore:c,shouldShowTemplatePicker:!1,onTitleChange:h().lQ,onTitleEditText:h().lQ,onTitleEsc:h().lQ,onTitleUntab:h().lQ,onTitleTab:h().lQ,handleHeaderMouseEnter:h().lQ,handleHeaderMouseLeave:h().lQ,isInPageLayoutModuleEditor:!0,layoutModule:o}))}function Ao(e){const{pageStore:t}=(0,E().bi)(),o=(0,a().K8)((()=>t.getSchema()),[t]),r=(0,a().K8)((()=>(0,_().gV)(t)),[t]),n=(0,a().K8)((()=>{if(!r)return;return(r.collection_page_sections||[]).filter((e=>{const r=o[e.section];if(!r||"relation"!==r.type)return;const n=t.getPropertyValue(e.section),i=(0,u().bG)({relationValue:(0,u().n)(n),propertySchema:r,getRecordModel:t.getRecordModel,includeNoAccess:!0}).length;return"inline"===e.visibility&&o[e.section]&&0!==i})).map((e=>e.section))}),[r,o,t]);return(n??[]).length>0?(0,D.jsx)(Pt().LG,{context:w().Rr.Frame,disabled:!0,inlinePropertyIDs:n,store:t,wrapper:e.wrapper}):(0,D.jsx)(ko,{text:"Inline page sections"})}function ko(e){const t=(0,d().IS)((e=>({text:{fontSize:14,color:"light"===e.mode?e.palette.gray[500]:e.palette.gray[600]}})),[]);return(0,D.jsx)(rt().vV,{children:(0,D.jsxs)(I().Ye,{children:[(0,D.jsx)("span",{style:t.text,children:e.text}),(0,D.jsx)(c().E,{content:"Not enabled"})]})})}function To(e){const{pageModule:t,pageStore:o,wrapper:r}=e,n=(0,l().v3)(),{layoutStore:i}=(0,E().LH)(),s=(0,d().IS)((e=>({empty:{color:e.text.tertiary,fontSize:b().J.UIRegular.desktop,padding:"0 6px"}})),[]),c=(0,a().K8)((()=>{var e;const o=null==i||null===(e=i.getModel())||void 0===e?void 0:e.getRawPageModuleAreaById(t.id);if(o)return(0,p().Fw)(o)}),[i,t.id]),u=(0,a().K8)((()=>!(0,j().g)({environment:n,layoutArea:c,moduleType:t.type,pageViewBlockContext:w().Rr.Frame})),[n,c,t.type]);return(0,D.jsx)(Ft().h,{context:w().Rr.Frame,disabled:!0,store:o,wrapper:r,layoutModule:t,variant:t.variant,customization:{disableContainerPadding:!0,neverShowPropertiesElsewhereInLayout:!0,disableLastRowBottomPadding:!0,stackPropertyLabelAndValue:u,emptyState:(0,D.jsx)("div",{style:s.empty,children:(0,D.jsx)(v().sA,{id:"pageLayout.emptyModule",defaultMessage:"Empty"})})},forceGroupsOpenOrClosed:"open"},`${t.id}-${o.id}`)}},962326:(e,t,o)=>{o.d(t,{B:()=>c,I:()=>d});var r=()=>o(966759),n=()=>o(390787),i=()=>o(854593),s=()=>o(4319),l=()=>o(231297),a=()=>o(846657);async function d({theme:e,collectionContextStore:t,environment:o,property:r,from:n,schema:s,onDeleteCompleted:l,...d}){const u=!!s[r]&&(0,a().J)(s[r]);await i().q({environment:o,collectionContextStore:t,property:r,handleDeleteAccept:async()=>{await c({collectionContextStore:t,environment:o,property:r,schema:s,from:n,permanentlyDelete:u,...d}),null==l||l()},theme:e,from:n,isPermanentlyDelete:u})}async function c(e){const{collectionContextStore:t,environment:o,property:i,schema:a,from:d,permanentlyDelete:c,...u}=e,p=t.collectionStore();if(!p)return;const m=p.getSchema()[i];await l().createAndCommitAsync({environment:o,userAction:"TableHeaderCell.handleDeleteAccept",waitForServerCommit:!1,perform:async e=>{await(0,n().P)({environment:o,collectionStore:p,schema:a,property:i,transaction:e,permanentlyDelete:c}),u.updateFrozenColumn&&s().sp({environment:o,collectionContextStore:t,currentIndex:u.columnIndex,entrypoint:u.updateFrozenColumnEntrypoint,transaction:e,propertyAction:"delete"})}}),m&&(0,r().i)({environment:o,collectionContextStore:t,property_type:m.type,from:d,property:i})}},963900:(e,t,o)=>{o.d(t,{Y1:()=>D,zE:()=>F});o(18107),o(967357);var r=o(296540),n=()=>o(484714),i=()=>o(56366),s=()=>o(401497),l=()=>o(631524),a=()=>o(449552),d=()=>o(201980),c=()=>o(69708),u=()=>o(751735),p=()=>o(496603),m=()=>o(284371),g=()=>o(348241),y=()=>o(582049),v=()=>o(465741),f=()=>o(728915),h=()=>o(774524),x=()=>o(312310),b=()=>o(790324),S=()=>o(299772),M=()=>o(953418),I=()=>o(665381),_=()=>o(129522),C=()=>o(765957),w=()=>o(548821),j=()=>o(134217),A=()=>o(749240),k=()=>o(660197),T=o(474848);function P({onAfterAddIconClick:e,disabled:t,formBlockStore:o}){if((0,i().K8)((()=>Boolean(o.getIcon()&&o.getCover())),[o]))return null;const r=t?(0,T.jsx)(T.Fragment,{}):(0,T.jsx)(B,{onAfterAddIconClick:e});return(0,T.jsx)(h().A,{store:o,context:w().Rr.Form,children:r})}function B({onAfterAddIconClick:e}){const{formBlockStore:t,headerFocusStore:o,headerMouseStore:r}=(0,g().cJ)(),s=(0,n().Y0)(),l=(0,i().K8)((()=>{const e=r.state.mouseEntered||o.state;return(0,S().g1)(e)}),[o,r]),{hasIcon:a,hasCover:d}=(0,i().K8)((()=>({hasIcon:Boolean(t.getIcon()),hasCover:Boolean(t.getCover())})),[t]);return(0,T.jsxs)(T.Fragment,{children:[a?void 0:(0,T.jsx)(b().A,{store:t,afterOnClick:e,style:l,label:s.isSmallPhone?(0,T.jsx)(c().sA,{id:"FormHeaderControls.iconMobile",defaultMessage:"Icon"}):(0,T.jsx)(c().sA,{id:"FormHeaderControls.icon",defaultMessage:"Form icon"})}),d?void 0:(0,T.jsx)(x().A,{store:t,style:l,label:s.isSmallPhone?(0,T.jsx)(c().sA,{id:"FormHeaderControls.pageCoverMobile",defaultMessage:"Cover"}):(0,T.jsx)(c().sA,{id:"FormHeaderControls.pageCover",defaultMessage:"Form cover"}),from:"form_page_header"})]})}function F({formBlockStore:e,formMode:t,disabled:o,headerFocusStore:s,onHeaderMouseEnter:l,onHeaderMouseLeave:a,aliasStore:u,formBlockWidth:m}){const g=(0,c().tz)(),v=(0,n().Y0)(),[h,x]=(0,r.useState)(!1),b=(0,i().K8)((()=>null==e?void 0:e.getTitleStore()),[e]),{hasCoverImage:S,hasPageIcon:M,formDescriptionStore:I}=(0,i().K8)((()=>({hasCoverImage:Boolean(null==e?void 0:e.getCover()),hasPageIcon:Boolean(null==e?void 0:e.getIcon()),formDescriptionStore:e.getFormDescriptionStore()})),[e]),_=(0,i().K8)((()=>(0,d().w9s)(I.getValue())),[I]);if(!e||!b)return null;const C="viewer"===t&&v.isMobile&&M?12:0;let j=0;return"builder"===t?M&&S&&(j=12):u?(j=M||S?24:12,u&&"narrow"===m&&!v.isMobile&&(j-=f().Yj)):j=M||S?24:48,(0,T.jsxs)("div",{style:{marginTop:C,marginInlineStart:"builder"===t?3:0},children:[(0,T.jsx)(k().H,{store:e,context:w().Rr.Form,isEditable:!o,headerControls:(0,T.jsx)(P,{onAfterAddIconClick:()=>x(!0),disabled:o,formBlockStore:e}),hasCover:S,isInSidePeek:!1,hideTitleIfEmpty:"viewer"===t,headerFocusStore:s,openMenuOnMount:h,openMenuOnMountCallback:()=>x(!1),disabled:o,titlePlaceholder:g.formatMessage({id:"formTitle.titlePlaceholder",defaultMessage:"Form title"}),collectionContextStore:void 0,shouldShowTemplatePicker:!1,onTitleChange:p().lQ,onTitleEditText:p().lQ,onTitleEsc:p().lQ,onTitleUntab:p().lQ,onTitleTab:p().lQ,onMoveUp:p().lQ,onMoveDown:p().lQ,handleHeaderMouseEnter:l,handleHeaderMouseLeave:a,disableEnter:!0,extraStyles:{fontSize:40,fontWeight:"bold",cursor:"text",marginTop:j},layoutModule:E}),"builder"!==t&&_?void 0:(0,T.jsx)("div",{style:{marginTop:16,marginInlineStart:3},children:(0,T.jsx)(y().B,{store:I,disabled:o,placeholder:g.formatMessage({id:"FormTitle.description.placeholder",defaultMessage:"Description (optional)"}),style:{cursor:"text"}})})]})}const E={id:"titleWithIcon",type:"normalizedTitleWithIcon",propertyIds:[]};function D({collectionContextStore:e,formBlockStore:t}){const o=(0,n().v3)(),r=(0,i().O$)(C().AppStoreSidebarSpaceStore),d=(0,i().K8)((()=>r?(0,I().G)(o,r):""),[o,r]),{isFormPublic:p,isFormClosed:g}=(0,i().K8)((()=>({isFormPublic:t.getIsFormPublic(),isFormClosed:t.getIsFormClosed()})),[t]),y=(0,i().K8)((()=>{const e=A().subscriptionDataStoreInstance.state;return Boolean(e&&r&&j().V$(o,e,r.id))}),[o,r]),f=(0,i().K8)((()=>y?"closed":(0,v().C0)(p,g)),[p,g,y]),h=(0,i().K8)((()=>{const t=e.collectionViewBlockStore();return!!t&&t.canEditMembership()}),[e]),x=(0,s().IS)((e=>{const t=()=>{switch(f){case"shared_to_web":return{light:{color:e.yellow.text.secondary,background:e.yellow.background.secondaryTranslucent},dark:{color:e.yellow.text.secondary,background:e.yellow.background.secondaryTranslucent}};case"shared_to_space":return{light:{color:e.text.secondary,background:e.background.secondaryTranslucent},dark:{color:e.text.secondary,background:e.background.secondaryTranslucent}};case"closed":return{light:{color:e.palette.red[500],background:e.palette.red[50]},dark:{color:e.palette.red[600],background:e.palette.red[200]}}}};return{container:{color:t()[e.mode].color,background:t()[e.mode].background,borderRadius:6,width:"100%",padding:"10px 22px",marginTop:24,fontSize:14,display:"flex",alignItems:"center"},lockIconContainer:{display:"flex",alignItems:"center"},changePermissionButton:{marginInlineEnd:-4,color:t()[e.mode].color,fontWeight:m().Wy.medium},changePermissionButtonHovered:{backgroundColor:(0,u().X4)(t()[e.mode].color,.1)},changePermissionButtonPressed:{backgroundColor:(0,u().X4)(t()[e.mode].color,.2)}}}),[f]),b=(0,v().ls)({formSharingState:f,spaceName:d,isOverBlockLimit:y});return(0,T.jsxs)("div",{style:x.container,children:[(0,T.jsx)("div",{style:{width:y?"100%":"90%",marginInlineEnd:10},children:(0,T.jsxs)("div",{style:x.lockIconContainer,children:[g||p||y?void 0:(0,a().g)({width:14,height:14,marginInlineEnd:6,marginInlineStart:-2}),b]})}),!y&&h?(0,T.jsx)(l().p,{style:x.changePermissionButton,hoveredStyle:x.changePermissionButtonHovered,pressedStyle:x.changePermissionButtonPressed,onClick:()=>{var t,o;const r=null===(t=e.collectionViewBlockStore())||void 0===t?void 0:t.id,n=(null===(o=_().K.getMembersByDOMOrder({filter:e=>e.getBlockStore().id===r}).at(0))||void 0===o?void 0:o.getNode())??null;if(n instanceof Element){const t=e.isFullScreenStore.state?n:n.parentElement;(0,M().vq)(t,{edgeDist:0,animate:!1})}e.formShareMenuButtonPopupStore.setState({...e.formShareMenuButtonPopupStore.state,open:!0})},children:(0,T.jsx)(c().sA,{id:"editorFormResponderWarning.changePermission",defaultMessage:"Change"})}):void 0]})}},970176:(e,t,o)=>{o.d(t,{z:()=>i});var r=()=>o(953418),n=()=>o(104129);function i({layoutStore:e,moduleId:t,environment:o}){setTimeout((()=>{!function({layoutStore:e,moduleId:t,environment:o}){const i=n().A.findModuleContainer({layoutStore:e,moduleId:t}),s=null==i?void 0:i.getNode();s&&(0,r().$v)({element:s,environment:o,additionalPadding:{top:100,bottom:100}})}({layoutStore:e,moduleId:t,environment:o})}),100)}}}]);