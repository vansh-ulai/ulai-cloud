"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[34399,77916],{6104:(e,i,s)=>{s.d(i,{S:()=>l});s(296540);var t=()=>s(69708),o=()=>s(901389),n=()=>s(931938),r=()=>s(418739),a=s(474848);async function l(e){const{environment:i,store:s,newPermissionItem:l}=e,c=s.getSpaceStore(),d=(0,n().k)({environment:i,spaceStore:c}),m=(0,r().j)({environment:i,store:s,newPermissionItem:l});if(void 0===d&&void 0===m)return{wasDuplicatable:d,willBeDuplicatable:m,confirmedChange:void 0};if(!d||m)return{wasDuplicatable:d,willBeDuplicatable:m,confirmedChange:void 0};const{accept:p}=await o().Gh({message:(0,a.jsx)(t().sA,{defaultMessage:"This is the custom landing page for this workspace.",id:"customGettingStarted.changePermissionConfirm.title"}),description:(0,a.jsx)(t().sA,{defaultMessage:"If other workspace members cannot view this page, they will have Notionâ€™s default landing page installed instead. Are you sure you want to change the page permissions?",id:"customGettingStarted.changePermissionConfirm.description"}),acceptLabel:(0,a.jsx)(t().sA,{defaultMessage:"Change permission",id:"customGettingStarted.changePermissionConfirm.button.text"})});return{wasDuplicatable:d,willBeDuplicatable:m,confirmedChange:p}}},31082:(e,i,s)=>{s.d(i,{Bw:()=>d,V0:()=>b});s(898992),s(354520),s(581454);var t=()=>s(564884),o=()=>s(848538),n=()=>s(534177),r=()=>s(134696),a=()=>s(579627),l=()=>s(680074),c=()=>s(159026);function d(e){const{environment:i,internalDomains:s,inviteResults:t,destination:d,metadata:b}=e;0!==t.length&&(function(e){var i;const{addedPermissions:s,environment:t,internalDomains:o,metadata:n,destination:a}=e;if(0===s.length)return;const c=s.map((e=>e.invite.inviteTarget)),d=s.map((e=>e.blockPermissionItem)),m=s.filter(u).filter((e=>void 0!==e.invite.internalDomain)).map((e=>e.inviteeUserId));r().Jg(t,{domainType:(0,l().FX)(),internal_domains:o??[],invite_flow_id:n.inviteFlowId,invite_message_length:(null===(i=n.inviteMessage)||void 0===i?void 0:i.length)??0,invite_origin:n.inviteOrigin,invite_targets:c,invitee_ids_with_internal_domain:m,invitee_ids_with_internal_domain_enforced:[],is_onboarding:!1,is_space:!1,permission_items:d,role:a.role,share_menu_session_id:n.shareMenuSessionId})}({addedPermissions:t.filter(g),environment:i,internalDomains:s,destination:d,metadata:b}),function(e){var i;const{createdMembers:s,environment:t,internalDomains:n,metadata:c,destination:d}=e;if(0===s.length)return;const m=s.map((e=>e.invite.inviteTarget)),p=s.map((e=>a().zV(e.spaceActor))),u=s.filter((e=>void 0!==e.invite.internalDomain)).map((e=>e.inviteeUserId)),g=s.filter((e=>e.wasInternalDomainEnforced)).map((e=>e.inviteeUserId));if(r().Jg(t,{domainType:(0,l().FX)(),internal_domains:n??[],invite_flow_id:c.inviteFlowId,invite_message_length:(null===(i=c.inviteMessage)||void 0===i?void 0:i.length)??0,invite_origin:c.inviteOrigin,invite_targets:m,invitee_ids_with_internal_domain:u,invitee_ids_with_internal_domain_enforced:g,is_onboarding:!1,is_space:!0,permission_items:p,role:(0,o().ps)(d.spaceMembershipType),share_menu_session_id:c.shareMenuSessionId}),g.length>0){const e=n?n.map((e=>e.url)):[];r().hp(t,{invite_flow_id:c.inviteFlowId,invite_origin:c.inviteOrigin,user_ids:g,internal_domains:e})}}({createdMembers:t.filter(h),environment:i,internalDomains:s,destination:d,metadata:b}),function(e){const{createdGuestRequests:i,environment:s,destination:t,metadata:a}=e;if(0===i.length)return;const l=i.filter((e=>void 0!==e.invite.internalDomain)).map((e=>{var i;return null===(i=e.invite.invitee)||void 0===i?void 0:i.email})).filter(n().O9);r().xF(s,{internal_guest_enforcement:!1,invite_flow_id:a.inviteFlowId,is_bot:!1,is_internal_domain:l.length>0,invitee_emails_with_internal_domain:l,invitee_emails_with_internal_domain_enforced:[],role:t.role,space_role:(0,o().ps)(t.spaceMembershipType),user_count:i.length})}({createdGuestRequests:t.filter(m),environment:i,destination:d,metadata:b}),function(e){const{createdMemberRequests:i,environment:s,destination:t,metadata:a}=e;if(0===i.length)return;const l=i.filter((e=>void 0!==e.invite.internalDomain)).map((e=>{var i;return null===(i=e.invite.invitee)||void 0===i?void 0:i.email})).filter(n().O9),d=i.filter((e=>e.wasInternalDomainEnforced)).map((e=>{var i;return null===(i=e.invite.invitee)||void 0===i?void 0:i.email})).filter(n().O9);r().RH(s,{from:"share_menu",invite_flow_id:a.inviteFlowId,invite_space_role_selection:c().NJ.workspace_member,is_bot:!1,is_internal_domain:l.length>0,internal_guest_enforcement:d.length>0,invitee_emails_with_internal_domain:l,invitee_emails_with_internal_domain_enforced:d,role:t.role,space_role:(0,o().ps)(t.spaceMembershipType),user_count:i.length})}({createdMemberRequests:t.filter(p),environment:i,destination:d,metadata:b}))}function m(e){return"createdGuestRequest"===e.type}function p(e){return"createdMemberRequest"===e.type}function u(e){return"addedUserPermission"===e.type}function g(e){return!(!u(e)&&!function(e){return"addedGroupPermission"===e.type}(e))}function h(e){return"createdMember"===e.type}function b({environment:e,spaceId:i,pageId:s,pageVisibility:o,hasTrustedDomainPermission:n,hasPublicShareLinkPermission:r,shareMenuSessionId:a}){(0,t().u)({environment:e,event:{eventName:"general_access_menu_open",eventProperties:{spaceId:i,pageId:s,pageVisibility:o,hasTrustedDomainPermission:n,hasPublicShareLinkPermission:r,shareMenuSessionId:a}}})}},64744:(e,i,s)=>{s.d(i,{v:()=>ne,O:()=>re});s(898992),s(354520),s(672577),s(737550);var t=s(296540),o=()=>s(59226),n=()=>s(726637),r=()=>s(56366),a=()=>s(401497),l=()=>s(97294),c=()=>s(406533),d=()=>s(68263),m=()=>s(179034),p=()=>s(519831),u=()=>s(69708),g=()=>s(285790),h=()=>s(147294),b=()=>s(89924),v=()=>s(765957),f=()=>s(463830),y=()=>s(453597),I=(s(944114),s(581454),()=>s(564884)),S=()=>s(484714),P=()=>s(631524),x=()=>s(160432),_=()=>s(302107),j=()=>s(852424),A=()=>s(922189),w=()=>s(340498),M=s(474848);const k={viewBox:"0 0 20 20",fittedViewBox:"1.59 1.59 16.81 16.81",svg:(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("path",{d:"M10 5.875c.345 0 .625.28.625.625v2.875H13.5a.625.625 0 1 1 0 1.25h-2.875V13.5a.625.625 0 1 1-1.25 0v-2.875H6.5a.625.625 0 1 1 0-1.25h2.875V6.5c0-.345.28-.625.625-.625"}),(0,M.jsx)("path",{d:"M8.497 2.222c.83-.83 2.176-.83 3.005 0l6.276 6.275c.83.83.83 2.176 0 3.006l-6.275 6.275c-.83.83-2.176.83-3.006 0l-6.275-6.275a2.125 2.125 0 0 1 0-3.006zm2.122.884a.875.875 0 0 0-1.238 0L3.106 9.38a.875.875 0 0 0 0 1.238l6.275 6.275a.875.875 0 0 0 1.238 0l6.275-6.275a.875.875 0 0 0 0-1.238z"})]})},C=(0,w().wt)("plusDiamond",k);var T=()=>s(231297),N=()=>s(760217),B=()=>s(406699),R=()=>s(404277),O=()=>s(939740),D=()=>s(347160),L=()=>s(722872),E=()=>s(152197),W=()=>s(878710),K=()=>s(329304),U=()=>s(204330),G=()=>s(437487),V=()=>s(99756);function z({store:e,collectionStore:i,disabled:s}){const o=(0,S().v3)(),n=(0,r().uB)(void 0,f().A),{isMobile:a}=(0,S().Y0)(),l=(0,t.useCallback)((e=>(0,M.jsx)(F,{buttonPopupEvents:e,disabled:s,collectionStore:i})),[s,i]);return i?(0,M.jsx)(B().A,{popupType:a?B().z.BottomSheet:B().z.Popup,forceInitialInbound:!0,buttonPopupStore:n,renderOrigin:l,originGap:a?void 0:8,style:{},onClick:()=>{(0,I().u)({environment:o,event:{eventName:"click_add_db_row_permission_rule",eventProperties:{collection_view_block_id:e.id,collection_id:i.id,share_menu_session_id:G().Ay.state.sessionId}}})},render:s=>(0,M.jsx)(H,{blockStore:e,collectionStore:i,onCreateRuleComplete:()=>s.close()}),onDismiss:()=>{},onClose:()=>{}}):null}function F({buttonPopupEvents:e,disabled:i,collectionStore:s}){const{isMobile:t}=(0,S().Y0)(),o=(0,a().IS)((e=>({button:{height:"unset",...t?{width:"100%",padding:"6px 0px"}:{padding:"6px 8px"}},textContainer:{display:"flex",flexDirection:"column",paddingInlineStart:t?12:10},buttonSubtitle:{color:e.text.tertiary,fontSize:12},iconContainer:{background:e.blue.background.secondaryTranslucent},icon:{fill:e.blue.icon.accentPrimary}})),[t]),n=(0,r().K8)((()=>s.getPropertyPermissionItems().validItems.length>0),[s]);return(0,M.jsxs)(P().p,{...e,style:o.button,disabled:i,disabledFeedback:i,children:[(0,M.jsx)(V().A,{type:"square",iconType:"function",iconFn:C,containerStyle:o.iconContainer,iconStyle:o.icon,isMobile:t}),(0,M.jsxs)("div",{style:o.textContainer,children:[(0,M.jsx)("span",{children:(0,M.jsx)(u().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionButton.title",defaultMessage:"Add a new rule"})}),n||t?void 0:(0,M.jsx)("span",{style:o.buttonSubtitle,children:(0,M.jsx)(u().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionButton.subtitle",defaultMessage:"Ex. Anyone selected in Assignees should have edit access"})})]})]})}function H({blockStore:e,collectionStore:i,onCreateRuleComplete:s}){const{isMobile:o}=(0,S().Y0)(),n=(0,S().v3)(),l=(0,r().K8)((()=>i.getSchema()),[i]),c=(0,r().K8)((()=>{const{validItems:e}=i.getPropertyPermissionItems();return e}),[i]),d=(0,t.useMemo)((()=>l?Object.entries(l).filter((([e,i])=>"person"===(null==i?void 0:i.type))).map((([e,i])=>e)):[]),[l]),m=o?36:28,p=(0,a().IS)((e=>({roleSelectButton:{display:"flex",justifyContent:"space-between",background:e.background.secondary,border:`1px solid ${e.text.quaternary}`,marginTop:12,marginBottom:10,height:m},createRuleButton:{width:"100%",height:m},noPropertiesAvailableMenuItem:{color:e.text.tertiary},disabled:{opacity:.3}})),[m]),g=(0,E().r)(),h=(0,K()._X)({name:"collection_property_permissions",spaceId:g,userId:n.currentUser.id}),[v,f]=t.useState("read_and_write"),[y,P]=t.useState(void 0),k=(0,t.useCallback)((()=>{P({type:"page_creator"})}),[]),C=(0,t.useCallback)((e=>{P({type:"person",property_id:e}),"editor"===v&&f("read_and_write")}),[v]),B=function({existingPropertyPermissionItems:e,personPropertyIds:i,collectionSchema:s,selectedPropertyInfo:t,selectPersonProperty:o,selectPageCreatorProperty:n}){const l=(0,u().tz)(),c=(0,a().DP)(),d=(0,S().v3)(),m=(0,E().r)(),p=(0,K()._X)({name:"collection_property_permissions",spaceId:m,userId:d.currentUser.id});return(0,r().K8)((()=>{const r=e.some((e=>"page_creator"===e.property_info.type)),a=!("unavailable"===(null==p?void 0:p.type)&&p.upsell);if(!a)return[];const d=[];for(const n of i){if(e.some((e=>"person"===e.property_info.type&&e.property_info.property_id===n)))continue;const i=null==s?void 0:s[n];i&&d.push({key:n,action:()=>{o(n)},render:e=>(0,M.jsx)(N().A,{...e,title:i.name,disabled:!a,icon:(0,M.jsx)(j().zB,{type:i.type,icon:i.icon,size:w().Ev.sm,theme:c,style:{fill:c.icon.secondary}}),isChecked:"person"===(null==t?void 0:t.type)&&(null==t?void 0:t.property_id)===n,focused:e.focused,buttonStyle:{padding:0}})})}return r||d.push({key:"page_creator",action:()=>{n()},render:e=>(0,M.jsx)(N().A,{...e,title:(0,_().mf)({intl:l,collectionSchema:s}),disabled:!a,icon:(0,A().personCircleFillIcon)({width:20}),desktopIconStyle:{fill:c.icon.secondary},isChecked:"page_creator"===(null==t?void 0:t.type),focused:e.focused,buttonStyle:{padding:0}})}),d}),[e,p,i,s,t,c,l,o,n])}({existingPropertyPermissionItems:c,personPropertyIds:d,collectionSchema:l,selectedPropertyInfo:y,selectPersonProperty:C,selectPageCreatorProperty:k});(0,t.useEffect)((()=>{if(1===B.length&&!y){const e=B[0];"page_creator"===e.key?k():"string"==typeof e.key&&C(e.key)}}),[B,y,k,C]);const V=(0,t.useCallback)((()=>{if(!i||!y)return;const t=(0,W().G_)(i,i.pointer,"permissions");s(),T().createAndCommit({userAction:"AddNewPropertyPermissionPopup.onCreateRule",environment:n,canUndo:!0,perform:e=>{T().applyOperation({store:t,operation:{pointer:t.pointer,command:"setPermissionItem",path:t.path,args:{type:"collection_property_permission",property_info:y,role:v}},transaction:e})}}),(0,I().u)({environment:n,event:{eventName:"create_db_row_permission_rule",eventProperties:{permission_property_info:y,permission_role:v,share_menu_session_id:G().Ay.state.sessionId,collection_id:i.id,collection_view_block_id:e.id}}})}),[i,n,y,v,s,e]),z=(0,t.useMemo)((()=>[..."page_creator"===(null==y?void 0:y.type)?["editor"]:[],"read_and_write","comment_only","reader"]),[y]),F=(0,r().K8)((()=>{const e=[],i="unavailable"===(null==h?void 0:h.type)&&h.upsell,s=!i;if(i){const i={key:"upgrade_section",items:[{key:"upgrade_button",action:()=>{},render:()=>(0,M.jsx)(U().R,{source:"collection_property_permissions",display:"button",upsell:h.upsell,featureName:"collection_property_permissions"})}],render:e=>(0,M.jsx)(b().A,{...e})};e.push(i)}let t;0===B.length&&(t={key:"no_available_properties",action:()=>{},render:e=>(0,M.jsx)(N().A,{...e,style:p.noPropertiesAvailableMenuItem,disabled:!0,title:(0,M.jsx)(u().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionPopup.noPropertiesMessage",defaultMessage:"No available properties"})})});const n={key:"options_section",items:t?[t]:B,render:e=>(0,M.jsx)(b().A,{...e,style:{paddingBottom:8,...!s&&p.disabled},title:(0,M.jsx)(u().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionPopup.title",defaultMessage:"Select person property"}),desktopTitleStyle:{fontSize:12,fontWeight:"medium",marginBottom:4,padding:"0px 6px"}})};e.push(n);const r={key:"buttons_section",items:[{key:"roleSelectButton",action:()=>{},render:e=>(0,M.jsx)(D().Ay,{table:"collection",type:"collection_property_permission",role:v,upgradeButtonName:"collection_property_permissions",onChange:e=>{f(e)},buttonStyle:p.roleSelectButton,availableRoleItems:z.map((e=>({role:e}))),disabled:!s})},{key:"createRuleButton",action:()=>{},render:()=>(0,M.jsx)(x().A,{colorPalette:"blue",disabled:!y||!s,style:p.createRuleButton,onClick:V,children:(0,M.jsx)(u().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionPopup.createButton",defaultMessage:"Create rule"})})}],render:e=>(0,M.jsx)(b().A,{...e,topBorder:!0,topBorderExtendToEdge:!0,style:{padding:o?16:10,...!s&&p.disabled},title:(0,M.jsx)(u().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionPopup.roleSectionTitle",defaultMessage:"Grant access to a particular page for anyone selected in this property"}),desktopTitleStyle:{fontSize:12,fontWeight:"medium",margin:"10px 0px 4px",padding:0,lineHeight:"16px"},noTextOverflow:!0,mobileTitleStyle:{padding:0}})};return e.push(r),e}),[B,z,V,y,v,p.createRuleButton,p.noPropertiesAvailableMenuItem,p.roleSelectButton,p.disabled,o,h]);return(0,M.jsx)(R().A,{menuType:L().gu.Popup,maxWidth:o?"100%":void 0,width:o?"100%":320,children:(0,M.jsx)("div",{style:{padding:o?8:6},children:(0,M.jsx)(O().Ay,{type:O().Oh.Vertical,initialFocus:void 0,sections:F})})})}var Y=()=>s(187820),q=()=>s(755535),$=()=>s(697650);function X(e){const{collectionStores:i,selectedCollectionStore:s,onCollectionPickerSelection:t,buttonPopupStore:o}=e,l=(0,u().tz)(),c=(0,a().IS)((e=>({titleSpan:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:200,display:"flex",alignItems:"center",gap:2},collectionName:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:n().A.isMobile?void 0:200,fontSize:n().A.isMobile?15:12,color:e.text.secondary},sectionMenuItemContainer:{maxWidth:n().A.isMobile?void 0:250},selectButton:{height:20},innerButtonStyle:{paddingInlineStart:4,paddingInlineEnd:4},titleIcon:{marginInlineEnd:1}})),[]),d=(0,r().K8)((()=>[{key:"collections",items:i.map((e=>{const i=(0,M.jsx)(Y().B6,{icon:e.getIcon(),iconRecordCategory:"collection",disabled:!0,isEmptyPage:!1,size:20,emojiSize:16}),o=(0,$().getCollectionNameOrDefault)({collectionStore:e,intl:l});return{key:e.id,render:n=>(0,M.jsx)(N().A,{...n,title:o,icon:i,onClick:()=>{t(e)},isChecked:e.id===s.id}),action:()=>{}}})),render:e=>(0,M.jsx)("div",{style:c.sectionMenuItemContainer,children:(0,M.jsx)(b().A,{...e,topBorder:!1,title:l.formatMessage({id:"collectionPropertyPermissionsSection.collectionPicker.title",defaultMessage:"Sources"})})})}]),[t,i,s.id,l,c.sectionMenuItemContainer]),m=(0,r().K8)((()=>{const e=(0,M.jsx)(Y().B6,{icon:s.getIcon(),iconRecordCategory:"collection",disabled:!0,isEmptyPage:!1,size:16,style:c.titleIcon}),i=(0,$().getCollectionNameOrDefault)({collectionStore:s,intl:l});return(0,M.jsxs)("span",{style:c.titleSpan,children:[e,(0,M.jsx)("div",{style:c.collectionName,children:i})]})}),[s,l,c.titleSpan,c.collectionName,c.titleIcon]);return(0,M.jsx)(q().A,{selectedTitle:m,buttonPopupStore:o,renderMenuSections:e=>d,alignmentToOrigin:"start",style:c.selectButton,innerButtonStyle:c.innerButtonStyle})}const J={viewBox:"0 0 20 20",fittedViewBox:"1.59 1.59 16.81 16.81",svg:(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("path",{d:"M9.834 13.113a.675.675 0 1 1 0 1.35.675.675 0 0 1 0-1.35m.142-6.874c1.408 0 2.792.934 2.792 2.361 0 .84-.509 1.527-1.176 1.933l-.769.524.001.001a.9.9 0 0 0-.406.723.625.625 0 0 1-1.25 0c0-.706.368-1.352.945-1.751l.003-.002.799-.546.027-.018c.394-.24.576-.566.576-.864 0-.493-.552-1.111-1.542-1.111-.84 0-1.401.477-1.513.925A.625.625 0 0 1 7.25 8.11c.287-1.15 1.478-1.872 2.726-1.872"}),(0,M.jsx)("path",{d:"M8.498 2.221c.83-.83 2.175-.83 3.005 0l6.275 6.277c.83.83.83 2.175 0 3.005l-6.275 6.275c-.83.83-2.175.83-3.005 0L2.22 11.503a2.125 2.125 0 0 1 0-3.005zm2.12.885a.875.875 0 0 0-1.236 0L3.106 9.381a.875.875 0 0 0 0 1.238l6.276 6.275a.875.875 0 0 0 1.237 0l6.275-6.275a.875.875 0 0 0 0-1.238z"})]})},Q=(0,w().wt)("questionDiamond",J);var Z=()=>s(534177),ee=()=>s(125565),ie=()=>s(268153),se=()=>s(87043);function te(e){const{collectionStore:i,disabled:s}=e,t=(0,r().K8)((()=>{const{validItems:e,invalidItems:s}=i.getPropertyPermissionItems();return[...e,...s]}),[i]);return 0===t.length?null:(0,M.jsx)(M.Fragment,{children:t.map(((e,t)=>(0,M.jsx)(oe,{collectionStore:i,permissionItem:e,disabled:s},t)))})}function oe({collectionStore:e,permissionItem:i,disabled:s}){const o=(0,u().tz)(),n=(0,S().v3)().device.isMobile,l=(0,r().K8)((()=>e.getSchema()),[e]),c=(0,a().IS)((e=>({errorText:{color:e.orange.text.secondary},errorStateIcon:{fill:e.orange.icon.accentPrimary},errorStateIconContainer:{background:e.orange.background.secondary}})),[]),d=i.property_info.type,m=(0,r().K8)((()=>(0,_().o7)({collectionSchema:l,permissionItem:i})),[l,i]),g=(0,a().DP)(),h=n?26:18,b=(0,r().K8)((()=>{switch(d){case"page_creator":return(0,M.jsx)(V().A,{type:"square",iconType:"function",iconFn:A().personCircleFillIcon,isMobile:n,iconStyle:{width:h,height:h}});case"person":const e=i.property_info.property_id,s=l[e];return"property_not_found"===m?(0,M.jsx)(V().A,{type:"square",iconType:"function",iconFn:A().personCircleFillIcon,isMobile:n,iconStyle:c.errorStateIcon,containerStyle:c.errorStateIconContainer}):"incorrect_property_type"===m?(0,M.jsx)(V().A,{type:"square",iconType:"function",iconFn:Q,isMobile:n,iconStyle:c.errorStateIcon,containerStyle:c.errorStateIconContainer}):s?(0,M.jsx)(V().A,{type:"square",iconType:"element",element:(0,M.jsx)(j().zB,{type:s.type,icon:s.icon,size:h,theme:g}),iconSize:n?se().Bj:se().Ev}):null}}),[d,n,c.errorStateIconContainer,c.errorStateIcon,i.property_info,l,m,g,h]),v=(0,t.useMemo)((()=>{switch(d){case"page_creator":return(0,_().mf)({intl:o,collectionSchema:l});case"person":const e=i.property_info.property_id,s=null==l?void 0:l[e];if("property_not_found"===m)return(0,M.jsx)("div",{style:c.errorText,children:(0,M.jsx)(u().sA,{defaultMessage:"Missing property",id:"propertyPermissionItem.person.missingProperty.label"})});if("incorrect_property_type"===m){const e=null==s?void 0:s.name;return(0,M.jsx)("div",{style:c.errorText,children:e?(0,M.jsx)(u().sA,{defaultMessage:"Incorrect property type for {propertyName}",id:"propertyPermissionItem.person.incorrectPropertyType.labelWithPropertyName",values:{propertyName:e}}):(0,M.jsx)(u().sA,{defaultMessage:"Incorrect property type",id:"propertyPermissionItem.person.incorrectPropertyType.label"})})}return(0,M.jsx)(u().sA,{defaultMessage:"Anyone in {propertyName}",id:"propertyPermissions.personProperty.label",values:{propertyName:(null==s?void 0:s.name)??""}});default:(0,Z().HB)(d)}}),[d,i,l,m,c.errorText,o]),f=(0,t.useMemo)((()=>{if(!n)return null;const e=(0,ie().R)({type:i.type,role:i.role,table:"block",isRemovable:!1}).label;return(0,M.jsx)(ee().A,{isSmall:!0,children:(0,M.jsx)(u().sA,{...e})})}),[n,i]);return(0,M.jsx)(se().Ay,{store:e,permissionItem:i,from:{table:p().Vl,collectionId:e.id},icon:b,title:v,subtitle:f,upgradeButtonName:"collection_property_permissions",isRemovableOverride:!0,shouldDisable:s})}function ne({blockStore:e,renderInfo:i,onCollectionChange:s}){const o=(0,u().tz)(),d=(0,r().uB)(void 0,f().A),m=(0,a().IS)((e=>({helpIcon:{width:n().A.isMobile?20:16,height:n().A.isMobile?20:16,color:e.icon.tertiary,marginInlineStart:n().A.isMobile?16:void 0},attributionHeader:{paddingTop:2},sectionMenuItem:{padding:"8px 4px",border:`1px solid ${e.border.secondary}`,borderRadius:8,marginInlineStart:12,marginInlineEnd:12},sectionMenuItemMobile:{padding:"8px 16px",border:`1px solid ${e.border.secondary}`,borderRadius:8},attributionHeaderContainer:{display:"flex",alignItems:"center",justifyContent:"space-between"},titleContainer:{display:"flex",alignItems:"center"},newBadge:{marginInlineStart:4}})),[]),p=(0,t.useCallback)((e=>{s(e),d.setState({...d.state,open:!1})}),[s,d]);return(0,M.jsxs)(b().A,{disableMobilePadding:!0,disableMobileBorders:!0,style:m.sectionMenuItem,mobileStyle:m.sectionMenuItemMobile,children:[(0,M.jsxs)("div",{style:m.attributionHeaderContainer,children:[(0,M.jsxs)("div",{style:m.titleContainer,children:[(0,M.jsx)("span",{style:m.attributionHeader,children:(0,M.jsx)(y().E3,{collectionPickerPopupMenu:i.showCollectionPicker?(0,M.jsx)(X,{collectionStores:i.collectionStores,selectedCollectionStore:i.selectedCollectionStore,onCollectionPickerSelection:p,buttonPopupStore:d}):void 0})}),"collection"===i.renderMode?(0,M.jsx)(h().Ee,{newBadgeKey:"collection_property_permissions",didUserEngage:!1,keyType:"date",style:m.newBadge}):void 0]}),(0,M.jsx)(l().N,{href:"https://www.notion.com/help/sharing-and-permissions#database-page-level-access",external:!0,children:(0,M.jsx)(g().A,{icon:()=>(0,c().questionMarkCircleIcon)(m.helpIcon),ariaLabel:o.formatMessage({id:"collectionPropertyPermissionsSection.help",defaultMessage:"Help"})})})]}),(0,M.jsx)(te,{collectionStore:i.selectedCollectionStore,disabled:i.disableRuleEditing}),"collection"===i.renderMode?(0,M.jsx)(z,{store:e,collectionStore:i.selectedCollectionStore,disabled:i.disableRuleEditing}):void 0]})}function re(e){const[i,s]=(0,t.useState)(void 0),n=(0,o().X)("collection_property_permissions"),a=(0,r().K8)((()=>v().default.state.currentCollectionViewStore),[]),l=(0,r().K8)((()=>{if(e.table===m().ev)return e}),[e]),{renderMode:c,collectionStores:u}=(0,r().K8)((()=>l?function(e){const i=e.getParentStore(),s=function(e){return e.getCollectionStores()??[]}(e);if((null==i?void 0:i.table)===p().Vl)return{renderMode:"page_in_collection",collectionStores:[i]};if(s.length>0)return{renderMode:"collection",collectionStores:s};return{renderMode:void 0,collectionStores:[]}}(l):{renderMode:void 0,collectionStores:[]}),[l]),g=(0,r().K8)((()=>!!l&&l.getPermissionItems().some(d().T6)),[l]),h=(0,r().K8)((()=>c?u.filter((e=>function(e,i,s){const t=i.getPropertyPermissionItems().validItems.length>0,o=i.isPageTreeCollection();if(o)return!1;if("page_in_collection"===e)return t&&!s;return!0}(c,e,g))):[]),[c,u,g]);(0,t.useEffect)((()=>{if(i)return;const e=null==a?void 0:a.getCollectionStore(),t=h.find((i=>i.id===(null==e?void 0:e.id)));t?s(t):h.length>0&&!i&&s(h[0])}),[h,i,a]);const b=(0,t.useCallback)((e=>{s(e)}),[s]),f=(0,r().K8)((()=>!i||!c||(!i.canAdmin()||"collection"!==c)),[i,c]),y=Boolean(l&&h.length>0&&i&&c);if(!(n&&y&&i&&c))return{shouldRender:!1};const I="collection"===c&&h.length>1;return{shouldRender:!0,renderInfo:{renderMode:c,collectionStores:u,selectedCollectionStore:i,disableRuleEditing:f,showCollectionPicker:I},onCollectionChange:b}}},105239:(e,i,s)=>{s.d(i,{N:()=>o});s(296540);const t={viewBox:"0 0 20 20",fittedViewBox:"3.37 1.37 13.26 16.26",svg:(0,s(474848).jsx)("path",{d:"M9.191 1.478a.624.624 0 0 1 .864.867l-.08.099-1.942 1.932H10A6.625 6.625 0 1 1 3.375 11a.625.625 0 1 1 1.25 0A5.375 5.375 0 1 0 10 5.626H8.037L9.962 7.56l.08.098a.626.626 0 0 1-.966.783L6.083 5.434l-.077-.096a.626.626 0 0 1 .08-.788l3.007-2.993z"})},o=(0,s(340498).wt)("arrowCircleSpinCounterClockwise",t)},117183:(e,i,s)=>{s.d(i,{A:()=>z});s(296540);var t=()=>s(484714),o=()=>s(401497),n=()=>s(179034),r=()=>s(314529),a=()=>s(242422),l=()=>s(726637),c=()=>s(406094),d=()=>s(160432),m=()=>s(584262),p=()=>s(742852),u=()=>s(340498),g=()=>s(68263),h=()=>s(69708),b=()=>s(502492),v=()=>s(284371),f=()=>s(884107),y=()=>s(859428),I=()=>s(125565),S=()=>s(544198),P=()=>s(492414),x=()=>s(300789),_=()=>s(80668),j=()=>s(146842),A=()=>s(928074),w=()=>s(56366),M=s(474848);function k(e){const{store:i}=e,r=(0,t().v3)(),{device:a,WindowSizeStore:l}=r,c=(0,w().K8)((()=>({left:l.getSafePaddingLeftCSS(8),right:l.getSafePaddingRightCSS(12)})),[l]),{collection_view_block_id:d,collection_view_id:m,collection_id:p}=(0,w().K8)((()=>{var e;return i&&i.table===n().ev&&i.isCollectionView()?{collection_view_block_id:i.id,collection_view_id:(0,s(939555).I)(i,r),collection_id:null===(e=i.getCollectionStoreIfSingleSource())||void 0===e?void 0:e.id}:{collection_view_block_id:void 0,collection_view_id:void 0,collection_id:void 0}}),[i,r]),g=(0,o().IS)((e=>({button:{display:"flex",alignItems:"center",width:a.isMobile?"100%":void 0,height:a.isMobile?44:32,paddingTop:a.isMobile?12:4,paddingBottom:a.isMobile?12:4,paddingInlineStart:c.left,paddingInlineEnd:c.right},questionMarkCircleSmall:{width:u().Ev.sm,height:u().Ev.sm,fill:a.isMobile?e.icon.secondary:e.icon.tertiary}})),[a.isMobile,c]);return(0,M.jsx)(s(97294).N,{href:(0,s(232930).x)("guides.sharing"),onClick:()=>s(148024).FH(r,{from:"sharing",share_menu_session_id:s(437487).Ay.state.sessionId,collection_id:p,collection_view_block_id:d,collection_view_id:m}),style:{width:a.isMobile?"100%":void 0},external:!0,children:(0,M.jsxs)(s(631524).p,{size:"sm",style:{...g.button,...e.style},disabled:Boolean(e.disableHover),children:[(0,M.jsx)("div",{style:{marginInlineStart:a.isMobile?2:0,marginInlineEnd:a.isMobile?8:6},children:(0,s(721479).questionMarkCircleSmallIcon)(g.questionMarkCircleSmall)}),(0,M.jsx)(I().A,{isMobile:a.isMobile,isSecondaryColor:!a.isMobile,children:(0,M.jsx)(h().sA,{defaultMessage:"Learn about sharing",id:"blockPermissionsSettings.learnAboutSharing.prompt"})})]})})}k.displayName="LearnAboutSharingLink";const C=k,T=new(s(178624).R)({key:"copy_link_no_permissions_tooltip_shown",namespace:s(553737).cd,important:!0,trackingType:"necessary"});function N(e){const{store:i,buttonPopupStore:s,events:n}=e,r=(0,t().v3)(),{device:a,mobileNative:c}=r,p=a.isMobile,u=(0,o().IS)((e=>({button:{flex:1,height:36,minHeight:36,borderRadius:12,marginTop:12,...p?{minHeight:48,fontSize:v().J.UIRegular.mobile}:{}}})),[p]);return(0,M.jsx)(d().A,{colorPalette:"blue",onClick:()=>{a.isMobileNative?function(e){const{store:i,mobileNative:s}=e,t=(0,b().kb)({schemeUrl:(0,P().Ay)({store:i,pageVisitSource:m().y8.CopyLink}),baseUrl:l().A.domainBaseUrl});s&&s.share(t)}({store:i,mobileNative:c}):O({store:i,buttonPopupStore:s,environment:r});const{collectionId:e,ownedCollectionCount:t,linkedCollectionCount:o}=(0,S().P)(i,{skipPages:!0}),n=i.getParentCollectionIdUpToTwoLevels();L(r,{collection_id:e,owned_collection_count:t,linked_collection_count:o,parent_collection_id:n})},style:u.button,...n,children:a.isMobileNative?(0,M.jsx)(h().sA,{id:"pageShareMenu.shareLinkButton.label",defaultMessage:"Share link"}):(0,M.jsx)(h().sA,{id:"pageShareMenu.copyLinkButton.label",defaultMessage:"Copy link"})})}function B(e){const{store:i,buttonPopupStore:s,events:n,trustedDomainPermissionItem:l,calculatedPermissions:d}=e,m=(0,t().v3)(),g=(0,o().IS)((e=>({icon:{width:u().Ev.default,height:u().Ev.default,fill:e.icon.secondary,marginInlineStart:0,marginInlineEnd:6},label:{color:e.text.primary},button:{paddingInlineStart:10,paddingInlineEnd:12,paddingTop:6,paddingBottom:6,color:e.text.primary,justifyContent:"center",borderRadius:6}})),[]);return(0,M.jsxs)(c().A,{size:"lg",onClick:()=>{const e=(0,A().Jz)({calculatedPermissions:d,currentUserId:m.currentUser.id});O({store:i,buttonPopupStore:s,environment:m,keepPopupOpen:!0}),e&&setTimeout((async()=>{await _().S.copy_link_no_permissions_tooltip({mainEditorCurrentBlockStore:i})&&!T.state&&"on"===a().default.getEligibleGroup({experimentId:"copy_page_link_awtl_tooltip",defaultGroup:"control"})&&((0,r().DO_NOT_USE_trackLegacy)(m,"tooltip_action",{tooltip_type:"copy_link_no_permissions",action:"shown",space_id:i.getSpaceId()}),T.setState(!0),(0,x().UW)(m,j().COPY_LINK_NO_PERMISSIONS_TOOLTIP_ID))}),100);const{collectionId:t,ownedCollectionCount:o,linkedCollectionCount:n}=(0,S().P)(i,{skipPages:!0}),c=i.getParentCollectionIdUpToTwoLevels();L(m,{collection_id:t,owned_collection_count:o,linked_collection_count:n,parent_collection_id:c,trusted_domain_permission_role:l.role})},style:g.button,...n,children:[(0,p().linkIcon)(g.icon),(0,M.jsx)(I().A,{style:g.label,children:(0,M.jsx)(h().sA,{id:"blockPermissionsSettings.copyLinkButtonV2.label",defaultMessage:"Copy link"})})]})}function R(e){const{calculatedPermissions:i,spaceName:s}=e,t=i.mostPermissivePublicItem.permissionItem;if((0,g().Tt)(t.role))return(0,M.jsx)(h().sA,{defaultMessage:"This page has public link access, so anyone with the link will be able to view the page.",id:"blockPermissionsSettings.publicLinkInfo.tooltip"});const o=i.mostPermissiveSpaceItem.permissionItem;return(0,g().Tt)(o.role)?s?(0,M.jsx)(h().sA,{defaultMessage:"Anyone at {spaceName} can access with this link",id:"blockPermissionsSettings.workspacePermissions.tooltipV2",values:{spaceName:s}}):(0,M.jsx)(h().sA,{defaultMessage:"This page has workspace access, so anyone in the workspace will be able to view the link.",id:"blockPermissionsSettings.workspacePermissions.tooltip"}):i.permissionItemsCount>1?(0,M.jsx)(h().sA,{defaultMessage:"Only people invited to this page can access with this link",id:"blockPermissionsSettings.userPermissions.tooltipV2"}):(0,M.jsx)(h().sA,{defaultMessage:"Only you can access this page, so the link will only work for you.",id:"blockPermissionsSettings.privatePermissions.tooltip"})}async function O(e){const{store:i,buttonPopupStore:s,environment:t,keepPopupOpen:o}=e,n=(0,P().Ay)({store:i,pageVisitSource:m().y8.CopyLink}),r=await f().R.clipboardActions.load();await r.copyString({environment:t,stringValue:n,copiedMessage:r.clipboardMessages.copiedLinkToClipboard}),s&&!o&&s.setState({open:!1})}const D=function(e){const{store:i,buttonPopupStore:n,calculatedPermissions:r}=e,a=(0,t().v3)(),{device:l}=a,c=(0,s(653953).X)(),d=(0,o().IS)((e=>({tooltip:{width:280}})),[]);return(0,M.jsxs)(M.Fragment,{children:[l.isMobile?void 0:(0,M.jsx)(C,{store:i}),(0,M.jsx)(y().A,{delayThreshold:500,placement:"bottom",renderTooltip:()=>(0,M.jsx)(R,{calculatedPermissions:r,spaceName:c}),textWrap:!0,style:d.tooltip,render:e=>l.isMobile?(0,M.jsx)(N,{store:i,buttonPopupStore:n,events:e}):(0,M.jsx)(B,{store:i,buttonPopupStore:n,events:e,trustedDomainPermissionItem:r.mostPermissiveTrustedDomainItem.permissionItem,calculatedPermissions:r})})]})};function L(e,i){(0,r().DO_NOT_USE_trackLegacy)(e,"copy_link_from_permissions_setting",i)}var E=()=>s(496703);function W(e){const{store:i,buttonPopupStore:s}=e,t=l().A.isMobile,n=(0,o().IS)((()=>({tooltip:{width:280}})),[]);return(0,M.jsxs)(M.Fragment,{children:[t?void 0:(0,M.jsx)(C,{}),(0,M.jsx)(y().A,{delayThreshold:500,placement:"bottom",renderTooltip:()=>(0,M.jsx)(G,{}),textWrap:!0,style:n.tooltip,render:e=>t?(0,M.jsx)(K,{store:i,buttonPopupStore:s,events:e}):(0,M.jsx)(U,{store:i,buttonPopupStore:s,events:e})})]})}function K(e){const{store:i,buttonPopupStore:s,events:n}=e,r=(0,t().v3)(),a=l().A.isMobile,c=(0,o().IS)((()=>({button:{flex:1,height:36,minHeight:36,borderRadius:12,marginTop:12,...a?{minHeight:48,fontSize:v().J.UIRegular.mobile}:{}}})),[a]);return(0,M.jsx)(d().A,{colorPalette:"blue",onClick:()=>{V({store:i,buttonPopupStore:s,environment:r})},style:c.button,...n,children:(0,M.jsx)(h().sA,{id:"workflowShareMenu.copyLinkButton.label",defaultMessage:"Copy link"})})}function U(e){const{store:i,buttonPopupStore:s,events:n}=e,r=(0,t().v3)(),a=(0,o().IS)((e=>({icon:{width:u().Ev.default,height:u().Ev.default,fill:e.icon.secondary,marginInlineStart:0,marginInlineEnd:6},label:{color:e.text.primary},button:{paddingInlineStart:10,paddingInlineEnd:12,paddingTop:6,paddingBottom:6,color:e.text.primary,justifyContent:"center",borderRadius:6}})),[]);return(0,M.jsxs)(c().A,{size:"lg",onClick:()=>{V({store:i,buttonPopupStore:s,environment:r,keepPopupOpen:!0})},style:a.button,...n,children:[(0,p().linkIcon)(a.icon),(0,M.jsx)(I().A,{style:a.label,children:(0,M.jsx)(h().sA,{id:"workflowShareMenu.copyLinkButtonV2.label",defaultMessage:"Copy link"})})]})}function G(){return(0,M.jsx)(h().sA,{defaultMessage:"Copy a link to share this agent with others",id:"workflowShareMenu.copyLinkInfo.tooltip"})}async function V(e){const{store:i,buttonPopupStore:s,environment:t,keepPopupOpen:o}=e,n=(0,E().L)({workflowId:i.id,params:{},pageVisitSource:m().y8.CopyLink,baseUrl:l().A.domainBaseUrl}),r=await f().R.clipboardActions.load();await r.copyString({environment:t,stringValue:n,copiedMessage:r.clipboardMessages.copiedLinkToClipboard}),s&&!o&&s.setState({open:!1})}const z=function(e){const{isMobile:i}=(0,t().Y0)(),r=(0,o().IS)((s=>{const t=i?`0.5px solid ${s.border.primary}`:`1px solid ${s.border.secondary}`;return{container:{display:"flex",alignItems:i?"normal":"center",flexDirection:i?"column":"row",justifyContent:"space-between",padding:i?"16px 20px 20px":"12px 12px",...e.hasCollectionPropertyPermissionsSection?{}:{borderTop:t}}}}),[i,e.hasCollectionPropertyPermissionsSection]);return e.store.table!==n().ev?(0,M.jsx)("div",{style:r.container,children:(0,M.jsx)(W,{store:e.store,buttonPopupStore:e.buttonPopupStore})}):(0,M.jsx)("div",{style:r.container,children:i?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(s(343001).GeneralAccessPermissionSection,{store:e.store,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs}),(0,M.jsx)(D,{store:e.store,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:e.calculatedPermissions})]}):(0,M.jsx)(D,{store:e.store,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:e.calculatedPermissions})})}},146842:(e,i,s)=>{s.r(i),s.d(i,{COPY_LINK_NO_PERMISSIONS_TOOLTIP_ID:()=>h,CopyLinkNoPermissionsTooltip:()=>v,PUBLIC_SHARE_LINK_TOOLTIP_ID:()=>g,PublicShareLinkTutorialTooltip:()=>b});s(296540);var t=()=>s(314529),o=()=>s(484714),n=()=>s(56366),r=()=>s(12193),a=()=>s(69708),l=()=>s(594607),c=()=>s(953006),d=()=>s(21140),m=()=>s(300789),p=()=>s(131448),u=s(474848);const g="public_share_link_tooltip",h="copy_link_no_permissions_tooltip";function b(e){const{originRef:i,onPrimaryButtonClick:s}=e,t=(0,o().v3)(),h=(0,n().K8)((()=>p().default.isVisible(g)),[]);return(0,u.jsx)(l().B,{shouldShow:h,calloutId:g,children:(0,u.jsx)(c().k,{style:{width:260},pointerLength:25,pointerPosition:"50%",origin:i,placementToOrigin:"bottom",alignmentToOrigin:"start",numSteps:1,header:(0,u.jsxs)(d().wt,{gap:10,children:[(0,r().globeIcon)({height:20,width:20}),(0,u.jsx)(a().sA,{id:"generalAccessPermissions.publicShareLink.tutorialTooltip.header",defaultMessage:"Share your page with anyone"})]}),content:(0,u.jsx)(a().sA,{id:"generalAccessPermissions.publicShareLink.tutorialTooltip.content",defaultMessage:"You can now change your page settings to collaborate with anyone on the web with the link"}),finalButtonContent:(0,u.jsx)(a().sA,{id:"generalAccessPermissions.publicShareLink.tutorialTooltip.finalButtonContent",defaultMessage:"Try it out"}),onPrimaryButtonClick:()=>{(0,m().a)(t,g),s()},shouldDismissUponOutsideClick:!0,onCloseClick:()=>{(0,m().a)(t,g)}})})}function v(e){const{originRef:i,onPrimaryButtonClick:s}=e,g=(0,o().v3)(),b=(0,n().K8)((()=>p().default.isVisible(h)),[]);return(0,u.jsx)(l().B,{shouldShow:b,calloutId:h,children:(0,u.jsx)(c().k,{style:{width:260},pointerLength:25,pointerPosition:"50%",origin:i,placementToOrigin:"bottom",alignmentToOrigin:"start",numSteps:1,header:(0,u.jsxs)(d().wt,{gap:10,children:[(0,r().globeIcon)({height:20,width:20}),(0,u.jsx)(a().sA,{id:"shareMenu.copyLinkNoPermissions.tutorialTooltip.header",defaultMessage:"Ready to share?"})]}),content:(0,u.jsx)(a().sA,{id:"shareMenu.copyLinkNoPermissions.tutorialTooltip.content",defaultMessage:"This page is private. Update permissions to share with others."}),finalButtonContent:(0,u.jsx)(a().sA,{id:"shareMenu.copyLinkNoPermissions.tutorialTooltip.finalButtonContent",defaultMessage:"Add permissions"}),onPrimaryButtonClick:()=>{(0,t().DO_NOT_USE_trackLegacy)(g,"tooltip_action",{tooltip_type:"copy_link_no_permissions",action:"add_permissions_clicked"}),(0,m().a)(g,h),s()},shouldDismissUponOutsideClick:!0,onCloseClick:()=>{(0,t().DO_NOT_USE_trackLegacy)(g,"dismiss_tooltip",{tooltip_type:"copy_link_no_permissions"}),(0,m().a)(g,h)}})})}},180925:(e,i,s)=>{s.d(i,{A:()=>a});var t=s(296540),o=()=>s(340498),n=s(474848);function r({onClick:e,hovered:i,expanded:r,children:a}){const l=(0,s(484714).Y0)().isMobile,[c,d]=t.useState(!1),m=(0,t.useCallback)((()=>d(!0)),[]),p=(0,t.useCallback)((()=>d(!1)),[]),u=(0,s(401497).IS)((e=>{const t=(0,s(623275).iM)({theme:e,size:26,useLargeBorderRadius:!0,useLightBackgroundColor:!0}),n={position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",top:"auto",insetInlineStart:"auto",opacity:i?1:0,transition:"opacity 150ms ease, background 150ms ease",...t,width:24,height:24,borderRadius:4};return{container:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},chevronButton:{...n,background:"unset"},chevronContainerHovered:{...n,background:t.background},childrenContainer:{opacity:i?0:1,transition:"opacity 200ms"},chevronIconInnerContainer:{background:"unset",height:24,width:24,borderRadius:4},chevronIcon:{transform:`rotate(${r?90:0}deg)`,transition:"transform 150ms ease",width:o().Ev.default,height:o().Ev.default}}}),[r,i]);return l?(0,n.jsx)(n.Fragment,{children:a}):(0,n.jsxs)("div",{style:u.container,onMouseEnter:m,onMouseLeave:p,children:[(0,n.jsx)(s(718827).Ay,{disabled:!1,style:c?u.chevronContainerHovered:u.chevronButton,onClick:e,children:(0,n.jsx)(s(99756).A,{type:"square",iconType:"function",iconFn:s(222334).arrowChevronSingleRightIcon,containerStyle:u.chevronIconInnerContainer,iconStyle:u.chevronIcon,isMobile:l})}),(0,n.jsx)("div",{style:u.childrenContainer,children:a})]})}const a=t.memo(r)},328403:(e,i,s)=>{s.d(i,{A:()=>M});s(296540);var t=()=>s(484714),o=()=>s(56366),n=()=>s(401497),r=()=>s(792071),a=()=>s(798880),l=()=>s(695608),c=()=>s(69708),d=()=>s(231704),m=()=>s(313171),p=()=>s(125565),u=()=>s(453697),g=()=>s(268153),h=()=>s(646736),b=()=>s(762433),v=()=>s(979340),f=()=>s(765957),y=()=>s(324561);var I=()=>s(87043),S=()=>s(810727),P=s(474848);function x(e){const{userValue:i,isInvited:s}=e,o=(0,t().Y0)().isMobile,r=(0,n().IS)((e=>({iconPlaceholder:{height:o?I().Bj:I().Ev,width:o?I().Bj:I().Ev,borderRadius:20},invitedIcon:{borderRadius:20,outlineColor:e.palette.gray[300]}})),[o]);return i?(0,P.jsx)(u().A,{borderStyle:s?"dashed":void 0,iconStyle:s?r.invitedIcon:void 0,userValue:i,size:o?I().Bj:I().Ev}):(0,P.jsx)(A,{style:r.iconPlaceholder})}function _(e){const{userValue:i,guestLabel:s}=e,t=(0,c().tz)(),r=(0,o().K8)((()=>{const{currentUserStore:e}=f().default.state;return!!e&&(!!i&&e.id===i.id)}),[i]),a=(0,n().IS)((e=>({titlePlaceholder:{height:8,width:81,borderRadius:4},titleYouIndicator:{color:"dark"===e.mode?e.text.secondary:e.text.tertiary}})),[]),u=(0,o().O$)(f().AppStoreSidebarSpaceStore),g="restricted_member"===(0,h().V_)({spaceStore:u,userId:null==i?void 0:i.id});if(!i)return(0,P.jsx)(A,{style:a.titlePlaceholder});const b=(0,l().c6)(t,i);return(0,P.jsxs)("div",{style:{display:"flex",gap:4},children:[(0,P.jsx)(p().A,{className:"notranslate",children:r?(0,P.jsx)(c().sA,{id:"cellMemberAvatar.displayName.title",defaultMessage:"{userFullDisplayName} <youIndicatorText>(You)</youIndicatorText>",values:{userFullDisplayName:b,youIndicatorText:e=>(0,P.jsx)("span",{style:a.titleYouIndicator,children:e})}}):b}),s?(0,P.jsx)(d().w,{labelType:s}):void 0,g?(0,P.jsx)(m().L,{}):void 0]})}function j(e){const{userValue:i,permissionRole:s}=e,{isMobile:o}=(0,t().Y0)(),r=(0,n().IS)((()=>({subtitlePlaceholder:{height:8,width:139,borderRadius:4,marginTop:10}})),[]);if(o&&s){const e=(0,g().R)({type:"user_permission",role:s,table:"block",isRemovable:!1}).label;return(0,P.jsx)(p().A,{isSmall:!0,children:(0,P.jsx)(c().sA,{...e})})}return null!=i&&i.email?(0,P.jsx)(p().A,{isSmall:!0,children:i.email}):(0,P.jsx)(A,{style:r.subtitlePlaceholder})}function A(e){const i=(0,n().IS)((i=>({placeholder:{...e.style,background:i.lightDividerColor}})),[e.style]);return(0,P.jsx)("div",{style:i.placeholder})}function w(e){const{userValue:i,permissionItem:s,store:t}=e,o=(0,c().tz)(),n=r().Bj6.fromValue(a().oo,i),l=null==n?void 0:n.getDisplayName(o),d=!(null!=i&&i.onboarding_completed||null!=i&&i.mobile_onboarding_completed),m=(0,S().z)({permissionItem:s,targetType:"user",targetName:l,store:t});return d?(0,P.jsx)(c().sA,{defaultMessage:"User has not yet created an account",id:"blockPermissionsSettings.notOnboarded.message"}):m||null}const M=function(e){const{store:i,userPermission:t,fromPermissionWrapper:n}=e,r=(0,o().K8)((()=>s(870092).L.createChildStore(i,{table:a().oo,id:t.permissionItem.user_id}).getValue()),[i,t.permissionItem.user_id]),l=function(){const e=(0,o().O$)(f().AppStoreSidebarSpaceStore),i=(0,y().lh)({spaceId:null==e?void 0:e.id});return(0,o().K8)((()=>{if(!e)return!1;const s=(0,b().AI)(i);return(0,v().dL)(s)||(0,v().Pg)(s)}),[e,i])}(),c=(0,o().K8)((()=>{const e=i.getSpaceStore(),s=(null==r?void 0:r.onboarding_completed)||(null==r?void 0:r.mobile_onboarding_completed);if(null!=r&&r.id&&(s||!l)){const s=(0,h().sE)(e,r.id);return(0,d().p)({spaceUserStore:s,userId:r.id,store:i})}if(null!=r&&r.id&&!s&&l)return"invited"}),[i,r,l]),m="invited"===c;return(0,P.jsx)("div",{children:(0,P.jsx)(I().Ay,{store:i,permissionItem:t.permissionItem,from:t.from,ignoreLocalHoverState:e.ignoreLocalHoverState,icon:(0,P.jsx)(x,{userValue:r,isInvited:m}),title:(0,P.jsx)(_,{userValue:r,guestLabel:c}),subtitle:m?void 0:(0,P.jsx)(j,{userValue:r,permissionRole:t.permissionItem.role}),selectHeader:s(726637).A.isMobile?(0,P.jsx)(s(678553).Ay,{title:(0,P.jsx)(_,{userValue:r,guestLabel:c}),caption:(0,P.jsx)(j,{userValue:r}),icon:(0,P.jsx)(x,{userValue:r}),desktopIconStyle:{marginInlineStart:16},style:{background:"transparent",border:"none"}}):void 0,selectFooter:e.selectFooter,showInherited:e.showInherited,upgradeButtonName:"user_permission_item",isRemovableOverride:e.isRemovableOverride,fromPermissionWrapper:n,roleItemOverrides:e.roleItemOverrides,nonInheritedTooltip:e.tooltip?e.tooltip:(0,P.jsx)(w,{userValue:r,permissionItem:t.permissionItem,store:i}),menuListItemProps:e.menuListItemProps,style:e.style,...e.permissionItemArgs})},t.permissionItem.user_id)}},343001:(e,i,s)=>{s.r(i),s.d(i,{GeneralAccessPermissionSection:()=>Cs,InheritedPermissionsListV2:()=>ks,MOBILE_SHARE_MENU_HORIZONTAL_PADDING:()=>As,default:()=>Rs});s(517642),s(658004),s(733853),s(845876),s(432475),s(515024),s(731698),s(898992),s(823215),s(354520),s(672577),s(803949),s(581454);var t=s(296540),o=()=>s(59226),n=()=>s(726637),r=()=>s(484714),a=()=>s(56366),l=()=>s(401497),c=()=>s(611648),d=()=>s(150669),m=()=>s(187174),p=()=>s(386164),u=()=>s(68263),g=()=>s(179034),h=()=>s(824862),b=()=>s(798880),v=()=>s(743246),f=()=>s(695608),y=()=>s(69708),I=()=>s(496603),S=()=>s(701763),P=()=>s(559506),x=()=>s(2143),_=()=>s(89924),j=()=>s(47373),A=()=>s(329443),w=()=>s(698449),M=()=>s(141333),k=()=>s(646736),C=()=>s(765957),T=()=>s(605402),N=()=>s(258836),B=()=>s(870092),R=()=>s(201718),O=()=>s(928074),D=()=>s(623275),L=()=>s(437487),E=()=>s(245241),W=()=>s(678553),K=()=>s(859428),U=()=>s(125565),G=()=>s(913441),V=()=>s(622936),z=()=>s(87043),F=s(474848);function H(e){const{store:i,workflowStore:s,agentPermission:t,fromPermissionWrapper:o}=e,r=(0,y().tz)(),l=(0,a().K8)((()=>s.canAdmin()),[s]);return(0,F.jsx)("div",{children:(0,F.jsx)(z().Ay,{store:i,permissionItem:t.permissionItem,from:t.from,ignoreLocalHoverState:e.ignoreLocalHoverState,icon:(0,F.jsx)(Y,{workflowStore:s}),title:(0,F.jsx)(q,{workflowStore:s}),subtitle:(0,F.jsx)($,{workflowStore:s}),shouldDisable:!l,selectHeader:n().A.isMobile?(0,F.jsx)(W().Ay,{title:(0,F.jsx)(q,{workflowStore:s}),caption:(0,F.jsx)($,{workflowStore:s}),icon:(0,F.jsx)(Y,{workflowStore:s}),desktopIconStyle:{marginInlineStart:16},style:{background:"transparent",border:"none"}}):void 0,selectFooter:e.selectFooter,showInherited:e.showInherited,upgradeButtonName:"bot_permission_item",isRemovableOverride:e.isRemovableOverride,fromPermissionWrapper:o,roleItemOverrides:e.roleItemOverrides,menuListItemProps:e.menuListItemProps,tag:(0,F.jsx)(G().Kg,{label:r.formatMessage(E().Nz.agent)}),...e.permissionItemArgs})},t.permissionItem.bot_id)}function Y(e){const{workflowStore:i}=e,s=n().A.isMobile,t=(0,a().K8)((()=>null==i?void 0:i.getIcon()),[i]);return i?(0,F.jsx)(V().AgentIcon,{agentIcon:t,workflowStore:i,size:s?z().Bj:z().Ev,animated:!1}):(0,F.jsx)(X,{})}function q(e){const{workflowStore:i}=e,s=(0,y().tz)(),t=(0,a().K8)((()=>i&&i.getNameWithDefault(s)),[s,i]);return i?(0,F.jsx)("div",{style:{display:"flex",gap:4},children:(0,F.jsx)(U().A,{className:"notranslate",children:t})}):(0,F.jsx)(X,{})}function $(e){const{workflowStore:i}=e,s=(0,l().IS)((()=>({subtitle:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}})),[]),t=(0,a().K8)((()=>null==i?void 0:i.getDescription()),[i]);return t?(0,F.jsx)(K().A,{renderTooltip:()=>(0,F.jsx)("div",{children:t}),render:e=>(0,F.jsx)("div",{...e,style:s.subtitle,children:t})}):(0,F.jsx)(X,{})}function X(){const e=(0,l().IS)((e=>({placeholder:{height:8,width:139,borderRadius:4,marginTop:10,background:e.lightDividerColor}})),[]);return(0,F.jsx)("div",{style:e.placeholder})}var J=()=>s(913348),Q=()=>s(328403),Z=()=>s(718827),ee=()=>s(30626);function ie({permissions:e}){const i=(0,r().v3)().device.isMobile,[s,o]=(0,t.useState)(!1),n=(0,l().IS)((e=>({button:{display:s?"none":"inline-flex",padding:8,alignItems:"center",...(0,D().CY)(),width:"calc(100% - 16px)",height:48},icon:{width:14,transform:"rotate(90deg)",fill:e.icon.tertiary},list:{display:s?"block":"none"},dotsIconContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:32,marginInlineEnd:(0,D().qj)({isMobile:i})}})),[i,s]);return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsxs)(Z().Ay,{onClick:()=>o(!0),style:n.button,children:[(0,F.jsx)("div",{style:n.dotsIconContainer,children:(0,ee()._)(n.icon)}),(0,F.jsx)(U().A,{isSmall:!1,isSecondaryColor:!0,children:(0,F.jsx)(y().sA,{id:"blockPermissionsSettings.permissionsList.expandButtonV2",defaultMessage:"See {count} more",values:{count:e.length}})})]}),(0,F.jsx)("div",{style:n.list,children:e})]})}var se=()=>s(464192),te=()=>s(12193),oe=()=>s(340498),ne=()=>s(268153),re=()=>s(38337);function ae(e,i){const s=(e.table===g().ev?e.getPublicPermission():void 0)??{type:"public_permission",role:"none"},t=(0,I().o8)(s);t.role=i;const{is_site:o}=t;return"none"===i?o?{...t,role:"reader",is_public_share_link:!1}:{...t,is_public_share_link:!1}:{...t,is_public_share_link:!0}}var le=()=>s(439616),ce=()=>s(463830),de=()=>s(976721),me=()=>s(252291),pe=()=>s(631524),ue=()=>s(906380),ge=()=>s(406699),he=()=>s(417392),be=()=>s(534177),ve=()=>s(284371),fe=()=>s(760217),ye=()=>s(404277),Ie=()=>s(939740),Se=()=>s(722872);var Pe=()=>s(726360);function xe(e){const{permission:i,includeHybrid:s}=e;return"none"===i.role?"private":s?"open_unlisted_hybrid":i.unlisted_timestamp?"unlisted":"open"}var _e=()=>s(367049);var je=()=>s(805025),Ae=()=>s(629027);function we(e){const{store:i,publicPermission:s,permissionItemArgs:o,menuListItemProps:a,onClose:c}=e,{permissionItem:d,from:m}=s,{sudoModeStore:p,location:g}=o,h=(0,r().v3)(),{isPhone:b}=(0,r().Y0)(),v=n().A.isMobile,f=(0,se().v)(s.permissionItem),I=(0,Ae().P)({store:i}),S=I.disabled,P=(0,t.useCallback)((async()=>{const e=(0,u().Yi)(m),s=ae(i,"reader");await(0,de().Hc)({oldPermissionItem:d,newPermissionItem:s,wasInherited:e!==i.id,environment:h,store:i,sudoModeStore:p,location:g}),c()}),[h,i,d,m,p,g,c]),x=(0,l().IS)((e=>({menuItemIcon:{height:20,width:20,fill:e.icon.secondary,...S&&{fill:e.icon.tertiary}},menuItemDesktopIconStyle:{...v?{marginTop:5,marginBottom:4,marginInlineStart:13,marginInlineEnd:6}:{marginInlineStart:0},alignSelf:"center"},menuItemContainer:{minHeight:28,marginBottom:2,lineHeight:"unset",...b&&{paddingTop:je().T3,paddingBottom:je().T3},color:e.text.primary,...S&&{color:e.text.tertiary}}})),[v,b,S]);let _;return S&&"space"===I.disabledBy&&(_=(0,F.jsx)(y().sA,{defaultMessage:"Workspace admin has disabled this sharing permission",id:"publicShareLinkItem.menuItemTooltip.publicSharingDisabledWorkspace"})),S&&"team"===I.disabledBy&&(_=(0,F.jsx)(y().sA,{defaultMessage:"Teamspace admin has disabled this sharing permission",id:"publicShareLinkItem.menuItemTooltip.publicSharingDisabledTeamspace"})),(0,F.jsx)(K().A,{renderTooltip:e=>_,placement:"bottom",disableTooltip:!S,render:e=>(0,F.jsx)(fe().A,{...a,...e,title:(0,F.jsx)(y().sA,{defaultMessage:"Anyone on the web with link",id:"publicShareLinkItem.menuItem.title"}),shouldWrapTitle:!0,shouldWrapCaption:!0,style:x.menuItemContainer,icon:(0,te().globeIcon)(x.menuItemIcon),desktopIconStyle:x.menuItemDesktopIconStyle,isChecked:f,disabled:S,onClick:P})})}var Me=()=>s(471095),ke=()=>s(898808);const Ce=oe().Ev.default,Te=[{key:"private",title:({type:e})=>"full"===e?(0,F.jsx)(y().sA,{id:"linkSharingPill.visibilityTitle.inviteOnlyFullLength",defaultMessage:"Only people invited"}):(0,F.jsx)(y().sA,{id:"linkSharingPill.visibilityTitle.inviteOnly",defaultMessage:"Invite only"}),caption:()=>(0,F.jsx)(y().sA,{id:"linkSharingPill.visibilityCaption.inviteOnly",defaultMessage:"Only you and people invited can access"}),icon:({style:e})=>(0,Me().i)({...e,marginTop:1})},{key:"unlisted",title:({spaceName:e})=>(0,F.jsx)(y().sA,{id:"linkSharingPill.visibilityTitle.anyoneWithLinkRedesign",defaultMessage:"Anyone at {spaceName} with the link",values:{spaceName:e}}),caption:()=>(0,F.jsx)(y().sA,{id:"linkSharingPill.visibilityCaption.anyoneWithLinkRedesign",defaultMessage:"Workspace members can access with the link"}),icon:({style:e})=>(0,s(742852).linkIcon)({...e,marginTop:1})},{key:"open",title:({spaceName:e})=>(0,F.jsx)(y().sA,{id:"linkSharingPill.visibilityTitle.everyoneInWorkspace",defaultMessage:"Everyone at {spaceName}",values:{spaceName:e}}),caption:()=>(0,F.jsx)(y().sA,{id:"linkSharingPill.visibilityCaption.everyoneInWorkspaceV2",defaultMessage:"Workspace members can access and discover in search"}),icon:({spaceStore:e,teamspaceIconSize:i})=>(0,F.jsx)(ke().x,{disabled:!0,store:e,size:i,style:{marginInlineStart:(Ce-i)/2,marginInlineEnd:(Ce-i)/2}})},{key:"open_unlisted_hybrid",title:({spaceName:e,visibility:i})=>"unlisted"===i?(0,F.jsx)(y().sA,{id:"blockPermissionsSettings.permissionItem.workspaceAccessNew.unlisted",defaultMessage:"Everyone at {spaceName} with the link",values:{spaceName:e}}):(0,F.jsx)(y().sA,{id:"linkSharingPill.visibilityTitle.everyoneInWorkspace",defaultMessage:"Everyone at {spaceName}",values:{spaceName:e}}),caption:()=>{},icon:({spaceStore:e,teamspaceIconSize:i})=>(0,F.jsx)(ke().x,{disabled:!0,store:e,size:i,style:{marginInlineStart:(Ce-i)/2,marginInlineEnd:(Ce-i)/2}})}];const Ne={key:"publicShareLink",title:()=>{},caption:()=>{},icon:()=>{}};function Be(e){const{store:i,spacePermission:o,sudoModeStore:n,location:c,isRestricted:d,trustedDomainPermission:m,publicPermission:p,showPublicShareLinkPermission:h,parentCloseCallback:b,handleSpacePermissionChange:v,permissionItemArgs:f,onlyShowPrivateSpaceVisibility:I}=e,S=(0,r().v3)(),{isMobile:P,isTablet:x}=(0,r().Y0)(),j=(0,a().O$)(C().AppStoreSidebarSpaceStore),A=xe({permission:o.permissionItem,includeHybrid:!0}),w=xe({permission:o.permissionItem,includeHybrid:!1}),M=o.from,k=(0,u().Yi)(M),T=!(M.table===i.table&&k===i.id),N=(0,a().K8)((()=>{const{sidebarSpaceStore:e}=C().default.state;return!(!e||i.table!==g().ev)&&i.isTopLevelWorkspacePage(e.id)}),[i]),B=(0,s(653953).X)(),R=(0,a().K8)((()=>{const e=O().QJ({store:i});return e?xe({permission:e,includeHybrid:!1}):"private"}),[i]),D=(0,u().Tt)((null==m?void 0:m.permissionItem.role)??"none"),E=(0,Pe().H)(),W=(0,a().K8)((()=>(0,O().pQ)({trustedDomainsStore:E})),[E]),K=function(e){const{onlyShowPrivateSpaceVisibility:i,hideOpenAndUnlistedOption:s}=e;return Te.filter((({key:e})=>i||s?"private"===e:"private"===e||"open_unlisted_hybrid"===e))}({onlyShowPrivateSpaceVisibility:I,hideOpenAndUnlistedOption:(0,_e().V)()});(0,t.useEffect)((()=>{null!=j&&j.id&&s(31082).V0({environment:S,spaceId:j.id,pageId:i.id,pageVisibility:w,hasTrustedDomainPermission:D,hasPublicShareLinkPermission:!(null==p||!p.permissionItem)&&(0,se().v)(p.permissionItem),shareMenuSessionId:L().Ay.state.sessionId})}),[null==j?void 0:j.id,i.id,w,D,S,p]);const G=h?[...K,Ne]:K,V=(0,l().IS)((e=>({icon:{fill:P?e.icon.primary:e.text.primary,width:Ce},iconContainer:{...P?{marginInlineStart:13,marginTop:5,marginBottom:4}:{marginInlineStart:0},marginInlineEnd:0,alignSelf:"center"},selectedTitle:{},titleStyle:P?{marginInlineStart:4}:{},mobileScroller:{background:e.background.secondary},mobileButton:{paddingTop:8,paddingBottom:8},mobileButtonDivider:{borderBottom:`1px solid ${e.regularDividerColor}`},sectionMenuItem:{...P?{}:{paddingTop:4,paddingBottom:4},...P?{overflow:"hidden",background:e.background.elevated,borderRadius:12,marginInlineStart:16,marginInlineEnd:16,marginBottom:16,borderWidth:1,borderStyle:"solid",borderColor:e.border.secondary,padding:void 0}:{}},menuList:{...P?{width:"100%",margin:"0 auto"}:{}},header:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",background:e.background.secondary,paddingTop:12,paddingBottom:20},headerLabel:{fontSize:16,fontWeight:ve().Wy.semibold}})),[P]);if(!j)return null;const z=!!p&&(0,se().v)(p.permissionItem);return(0,F.jsx)(ye().A,{menuType:Se().gu.Popup,disableScroller:!0,scrollerStyle:P?V.mobileScroller:{},height:P?x?"100%":"50vh":void 0,minWidth:P?"100%":void 0,maxWidth:P?"100%":void 0,maxHeight:P?"100%":void 0,header:P?(0,F.jsx)("div",{style:V.header,children:(0,F.jsx)(U().A,{style:V.headerLabel,children:(0,F.jsx)(y().sA,{defaultMessage:"General access",id:"PermissionRoleSelect.Header.GeneralAccess"})})}):void 0,children:(0,F.jsx)(Ie().Ay,{type:Ie().Oh.Vertical,initialFocus:void 0,style:P?V.menuList:void 0,sections:[{key:"visibilityOptions",render:e=>(0,F.jsx)(_().A,{...e,disableDesktopPadding:P,style:V.sectionMenuItem}),items:G.map(((e,t)=>{const r=e.key;if("publicShareLink"===r){if(i.table!==g().ev)return;return p?{key:"public_share_link",action:()=>{},render:e=>(0,F.jsx)(we,{store:i,publicPermission:p,permissionItemArgs:f,menuListItemProps:e,onClose:b})}:void 0}const a=function(e){const{oldVisibility:i,newVisibility:s,hasPublicShareLinkPublicPermission:t}=e;if(t)return!1;if(i===s)return!0;if("unlisted"===i&&"open"===s||"open"===i&&"unlisted"===s)return!0;return!1}({oldVisibility:A,newVisibility:r,hasPublicShareLinkPublicPermission:z}),l=t!==Te.length-1,m={minHeight:28,...P?V.mobileButton:{},...P&&l?V.mobileButtonDivider:{},...l&&!P&&{marginBottom:2}};return{key:r,render:i=>(0,F.jsx)(fe().A,{title:(0,F.jsx)(U().A,{isMultiline:!0,children:e.title({spaceName:B,type:"full",visibility:w})}),icon:e.icon({style:V.icon,spaceStore:j,teamspaceIconSize:20}),desktopIconStyle:V.iconContainer,titleStyle:{...V.titleStyle,...a&&!P?V.selectedTitle:{}},isChecked:a,buttonStyle:{borderRadius:6},style:m,shouldWrapTitle:!0,...i}),action:async()=>{if(a)return;const e=o.permissionItem,t={type:"space_permission",role:Re(e,w,r,i)};"unlisted"===r&&(t.unlisted_timestamp=Date.now());const l=function(e,i){if(e===i)return!1;switch(i){case"open":case"open_unlisted_hybrid":return!1;case"unlisted":return"open"===e;case"private":return!0;default:(0,be().HB)(i)}}(R,r)&&!d&&!N;let m=!1,u=!1;if("block"===i.table){const e=await(0,s(6104).S)({environment:S,store:i,newPermissionItem:t});if(e.wasDuplicatable&&!e.willBeDuplicatable){if(!e.confirmedChange)return void b();m=!0}else!e.wasDuplicatable&&e.willBeDuplicatable&&(u=!0)}const g=await(0,de().Hc)({oldPermissionItem:e,newPermissionItem:t,wasInherited:T,environment:S,store:i,sudoModeStore:n,location:c,restrictingVisibility:l,trustedDomainsLoggingData:{trustedDomainsPointers:null==E?void 0:E.state.trustedDomainPointers,hasTrustedDomainPermission:D,isTrustedDomainItemEnabled:W}});g&&v&&v({before:e,after:t}),g&&"private"===r&&p&&z&&function(e){const{environment:i,store:s,publicPermission:t,wasInherited:o,location:n,sudoModeStore:r}=e,a=t.permissionItem,l=ae(s,"none");(0,de().Hc)({environment:i,store:s,oldPermissionItem:a,newPermissionItem:l,wasInherited:o,location:n,sudoModeStore:r})}({environment:S,store:i,publicPermission:p,wasInherited:T,location:c,sudoModeStore:n}),g&&m?s(663234).a({environment:S,spaceStore:j,pageId:void 0}):g&&u&&s(601866).Vb({environment:S,spaceStore:j,errors:[]}),b()}}})).filter(be().O9)}]})})}function Re(e,i,s,t){return"private"===s?"none":t.table===v().C0&&"private"===i?"reader":"private"===i?"editor":e.role}const Oe=t.memo((function({store:e,spacePermission:i,trustedDomainPermission:o,publicPermission:n,showPublicShareLinkPermission:c,isRestricted:d,permissionItemArgs:m,hideHoverStyles:p,buttonPopupStore:u,isDisplayOnly:h,handleSpacePermissionChange:b,title:v,onlyShowPrivateSpaceVisibility:f}){const y=(0,r().v3)().device.isMobile,I=e.table===g().ev,S=(0,s(891078).i0)(I?e:void 0),P=(0,a().K8)((()=>e.canAdmin()),[e]),x=!P||h||S,_=(0,t.useCallback)((()=>u.setState({...u.state,open:!0})),[u]),j=(0,l().IS)((e=>({origin:{display:"flex",alignItems:"center",justifyContent:"center",paddingInlineStart:6,marginInlineStart:-6,height:void 0,paddingTop:4,paddingBottom:4,maxWidth:250},privacyMenu:{...!y&&{width:330,borderRadius:10},...y&&{maxWidth:"100%"}},title:{fontSize:14,whiteSpace:"normal"},mobileButton:{display:"flex",alignItems:"center",whiteSpace:"normal",gap:4,marginBottom:4,height:void 0}})),[y]);return x?(0,F.jsx)("div",{style:j.title,children:v}):(0,F.jsx)(ge().A,{renderOrigin:e=>y?(0,F.jsx)("div",{style:j.title,...e,children:(0,F.jsxs)("div",{style:j.mobileButton,children:[v,(0,F.jsx)(me().I,{icon:ue().arrowChevronSingleRightSmallIcon,size:"sm",colorVariant:"secondary"})]})}):(0,F.jsxs)(pe().p,{style:j.origin,hoveredStyle:p?{background:"unset"}:void 0,pressedStyle:p?{background:"unset"}:void 0,disabled:x,...e,children:[(0,F.jsx)(s(265665).j,{children:v}),P?(0,F.jsx)(me().I,{icon:s(324254).arrowChevronSingleDownSmallIcon,size:"sm",colorVariant:"secondary"}):null]}),disabled:x,onClick:_,buttonPopupStore:u,style:j.privacyMenu,alignmentToOrigin:"start",popupType:y?he().nl.BottomSheet:he().nl.Popup,render:s=>i?(0,F.jsx)(Be,{store:e,spacePermission:i,parentCloseCallback:s.close,trustedDomainPermission:o,publicPermission:n,showPublicShareLinkPermission:c,isRestricted:d,sudoModeStore:m.sudoModeStore,location:m.location,permissionItemArgs:m,handleSpacePermissionChange:b,onlyShowPrivateSpaceVisibility:f}):null})}));var De=()=>s(99756);const Le={type:"public_permission",role:"none",is_public_share_link:!1};function Ee(e){const{store:i,spacePermission:s,publicPermission:o,trustedDomainPermission:c,permissionItemArgs:d,fromPermissionWrapper:m,isRestricted:p}=e,{permissionItem:g,from:h}=o,{location:b,sudoModeStore:v}=d,f=(0,r().v3)(),y=n().A.isMobile,I=(0,a().uB)(void 0,ce().A),S=(0,a().K8)((()=>!f.currentUser.isLoggedIn()),[f.currentUser]),P="none"!==s.permissionItem.role,x=(0,se().v)(g)?g:{...g,...Le},_=(0,t.useCallback)((()=>{I.setState({open:!0})}),[I]),j=(0,t.useCallback)((async e=>{const s=(0,u().Yi)(h)!==i.id;if("string"!=typeof e||!(e in u().TE))return!1;const t=ae(i,e);return await(0,de().Hc)({environment:f,store:i,oldPermissionItem:g,newPermissionItem:t,wasInherited:s,location:b,sudoModeStore:v})}),[f,i,g,h,b,v]),A=(0,t.useCallback)((async e=>{const s=(0,u().Yi)(h)!==i.id,t={...g,expiration_timestamp:e};return await(0,de().Hc)({environment:f,store:i,oldPermissionItem:g,newPermissionItem:t,wasInherited:s,location:b,sudoModeStore:v})}),[f,i,g,h,b,v]),w=(0,l().IS)((e=>({container:{width:"100%"},linkExpirationContainer:y?{minHeight:0}:{},linkExpirationButton:y?{paddingInlineStart:16,paddingInlineEnd:16,paddingTop:12,paddingBottom:12,width:void 0,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:e.border.secondary,background:e.background.elevated}:{padding:0}})),[y]),M=(0,t.useMemo)((()=>[{role:"none",prefixItem:{key:"link-expiration",render:e=>(0,F.jsx)("div",{...e,children:(0,F.jsx)(le().A,{permissionItem:g,hideIcon:!0,onChange:A,focused:!1,buttonStyle:w.linkExpirationButton,style:w.linkExpirationContainer})}),action:()=>{}}}]),[g,A,w.linkExpirationButton,w.linkExpirationContainer]);return(0,F.jsx)("div",{style:w.container,className:re().VRj,children:(0,F.jsx)(z().Ay,{store:i,permissionItem:x,from:h,shouldDisable:S,fromPermissionWrapper:m,onClick:_,onChange:j,roleItemOverrides:M,icon:(0,F.jsx)(We,{}),title:(0,F.jsx)(Oe,{store:i,spacePermission:s,trustedDomainPermission:c,publicPermission:o,showPublicShareLinkPermission:!0,isRestricted:p,permissionItemArgs:d,fromPermissionWrapper:m,buttonPopupStore:I,hideHoverStyles:!1,isDisplayOnly:d.shouldDisable??!1,title:(0,F.jsx)(Ke,{}),onlyShowPrivateSpaceVisibility:P}),subtitle:y?(0,F.jsx)(Ue,{role:g.role}):void 0,upgradeButtonName:"public_share_link_item",isRemovableOverride:!0,renderTitleWithoutUILabelWrapper:!0,...d})})}function We(){const e=n().A.isMobile,i=(0,l().IS)((()=>({globeIcon:{width:e?24:oe().Ev.default,height:e?24:oe().Ev.default}})),[e]);return(0,F.jsx)(De().A,{type:"square",iconType:"function",iconFn:te().globeIcon,iconStyle:i.globeIcon,isMobile:e})}function Ke(){const e=(0,l().IS)((()=>({title:{fontSize:14,whiteSpace:"normal"}})),[]);return(0,F.jsx)("div",{style:e.title,children:(0,F.jsx)(y().sA,{defaultMessage:"Anyone on the web with link",id:"publicShareLinkItem.permissionItem.title"})})}function Ue(e){const{role:i}=e;return n().A.isMobile?(0,F.jsx)(y().sA,{...(0,ne().R)({type:"public_permission",role:i,table:"block",isRemovable:!1}).label}):null}var Ge=()=>s(665381);function Ve({store:e}){const i=(0,r().v3)(),t=i.device.isMobile,o=(0,a().K8)((()=>{var t,o;return e instanceof s(985405).SpaceStore?null===(t=(0,s(625247).c)(i,e))||void 0===t?void 0:t.icon:null===(o=e.getIcon())||void 0===o?void 0:o.icon}),[i,e]),n=(0,l().IS)((e=>({teamOrSpaceIcon:(0,D().iM)({theme:e,size:t?z().Bj:z().Ev,useLargeBorderRadius:!0,useLightBackgroundColor:!0,icon:o}),iconBoxStyles:{color:e.icon.secondary}})),[o,t]),{innerEmojiOrFlatIconSize:c,innerInitialSize:d}=function({baseSize:e}){return{innerEmojiOrFlatIconSize:.65*e,innerInitialSize:.75*e}}({baseSize:t?z().Bj:z().Ev});return(0,F.jsx)(ke().x,{disabled:!0,store:e,size:t?z().Bj:z().Ev,iconContainerStyles:n.teamOrSpaceIcon,iconBoxStyles:n.iconBoxStyles,innerEmojiOrFlatIconSize:c,innerInitialSize:d})}const ze=t.memo(Ve);function Fe({store:e,spaceOwnerPermission:i,permissionItemArgs:s,fromPermissionWrapper:t}){const o=(0,r().v3)(),n=(0,a().O$)(C().AppStoreSidebarSpaceStore),l=(0,a().K8)((()=>{if(n)return(0,Ge().G)(o,n)}),[o,n]);return n?(0,F.jsx)(z().Ay,{store:e,permissionItem:i.permissionItem,from:i.from,icon:(0,F.jsx)(ze,{store:n}),title:(0,F.jsx)(U().A,{isMultiline:!0,children:(0,F.jsx)(y().sA,{id:"spaceOwnerPermissionItem.title",defaultMessage:"Owners of {spaceName}",values:{spaceName:l||(0,F.jsx)(y().sA,{id:"generalAccessPermissionsList.getSpaceName.untitledWorkspace.name",defaultMessage:"Untitled workspace"})}})}),upgradeButtonName:"space_owner_permission_item",fromPermissionWrapper:t,isRemovableOverride:!1,hideRoleSelectButton:!1,renderTitleWithoutUILabelWrapper:!0,shouldDisable:!0,...s}):null}var He=()=>s(581369);function Ye(e){const{permissionItem:i,onToggle:s,focused:t}=e,o=(0,y().tz)(),{isMobile:n}=(0,r().Y0)(),c=(0,a().K8)((()=>Boolean(i)&&!Boolean(i.unlisted_timestamp)),[i]),d=(0,l().IS)((e=>({visibilityToggle:{display:"flex",alignItems:"start",justifyContent:"space-between",marginInlineStart:12,paddingInlineStart:4},buttonMenuItemStyleMobile:{backgroundColor:e.background.elevated,paddingTop:12,paddingBottom:12,marginInlineEnd:12,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:e.border.secondary,width:"100%"}})),[]),m=o.formatMessage({id:"spacePermissionItem.visibilityPicker.unlistedToggle",defaultMessage:"Hide in search"});return(0,F.jsx)("div",{children:(0,F.jsx)(fe().A,{onClick:s,focused:t,style:n?d.buttonMenuItemStyleMobile:{},title:m,shouldWrapTitle:!0,right:(0,F.jsx)("div",{style:n?{}:d.visibilityToggle,children:(0,F.jsx)(He().A,{disabled:!1,on:!c,onClick:s})})})})}var qe=()=>s(645873);const $e=new(qe().O2)("PublicShareLinkTutorialTooltip",(()=>s.e(77916).then(s.bind(s,146842)))),Xe=(0,qe()._h)($e,(e=>e.PublicShareLinkTutorialTooltip));var Je=()=>s(146842),Qe=()=>s(484578);function Ze({visibility:e,spaceStore:i}){const s=(0,r().v3)(),t=(0,a().K8)((()=>(0,Ge().G)(s,i)),[s,i]);switch(e){case"private":return(0,F.jsx)(y().sA,{id:"spacePermissionVisibilityPicker.private",defaultMessage:"Only people invited"});case"unlisted":return(0,F.jsx)(y().sA,{id:"blockPermissionsSettings.permissionItem.workspaceAccessNew.unlisted",defaultMessage:"Everyone at {spaceName} with the link",values:{spaceName:t}});case"open":case"open_unlisted_hybrid":return(0,F.jsx)(y().sA,{defaultMessage:"Everyone at {workspaceName}",id:"blockPermissionsSettings.permissionItem.workspaceAccessNew",values:{workspaceName:t}});default:(0,be().HB)(e)}}const ei=new(s(178624).R)({key:"shareMenuRoleSelectCalloutCount",namespace:s(553737).Bq,important:!0,trackingType:"necessary"});function ii({visibility:e,spaceStore:i,isMobile:s}){const t=(0,l().IS)((()=>({lockIcon:{width:s?24:18,height:s?24:18}})),[s]);return"private"===e?(0,F.jsx)(De().A,{type:"square",iconType:"function",iconFn:Me().i,iconStyle:t.lockIcon,isMobile:s}):"unlisted"===e||"open"===e||"open_unlisted_hybrid"===e?(0,F.jsx)(ze,{store:i}):void(0,be().HB)(e)}function si({store:e,spacePermission:i,trustedDomainPermission:s,publicPermission:t,showPublicShareLinkPermission:o,isRestricted:n,permissionItemArgs:r,fromPermissionWrapper:a,buttonPopupStore:l,visibility:c,spaceStore:d,hideHoverStyles:m,isDisplayOnly:p,handleSpacePermissionChange:u}){return(0,F.jsx)(Oe,{store:e,spacePermission:i,trustedDomainPermission:s,publicPermission:t,showPublicShareLinkPermission:o,isRestricted:n,permissionItemArgs:r,fromPermissionWrapper:a,buttonPopupStore:l,hideHoverStyles:m,isDisplayOnly:p,handleSpacePermissionChange:u,title:(0,F.jsx)(Ze,{visibility:c,spaceStore:d})})}const ti=function({trustedDomainPermission:e,isRestricted:i,publicPermission:o,showPublicShareLinkPermission:n,shouldShowPublicShareLinkTooltip:c,...d}){const{store:m,spacePermission:p,fromPermissionWrapper:h}=d,b=(0,r().v3)(),f=b.device.isMobile,S=(0,t.useRef)(null),P=(0,a().uB)(void 0,ce().A);(0,t.useEffect)((()=>{c&&(0,s(300789).HH)(b,Je().PUBLIC_SHARE_LINK_TOOLTIP_ID)}),[b,c]);const x=u().Ni(p.permissionItem)&&"none"!==p.permissionItem.role,_=(0,Qe().QX)(p),j=(0,a().O$)(C().AppStoreSidebarSpaceStore),A=(0,a().K8)((()=>{const e=C().default.state.sidebarSpaceStore;return null==e||!e.isDefined()}),[]),w=(0,a().K8)((()=>{const e=C().default.state.sidebarSpaceStore;return!!e&&(0,s(272509).I)(e)}),[]),M=(0,a().K8)((()=>(0,O().WG)()),[]),k=(0,a().K8)((()=>s(242422).default.checkGate({gateName:"domain_link_sharing_redesign_override",disableExposureLogging:!0})),[]),T=(0,Pe().H)(),N=(0,a().K8)((()=>{var e;return null==T||null===(e=T.getForSpace(j))||void 0===e?void 0:e.trustedDomains}),[T,j]),B=(0,a().K8)((()=>(0,s(965597).Hb)({space:null==j?void 0:j.getModel(),trustedDomains:N,enableTrustedDomainPermissionRedesign:k})),[j,N,k]),R=(0,a().K8)((()=>j&&m.table===g().ev?m.isTopLevelWorkspacePage(j.id):m.table===v().C0),[m,j]),D=(0,a().K8)((()=>{const e=(0,O().QJ)({store:m});return e?xe({permission:e,includeHybrid:!1}):"private"}),[m]),L=(0,a().K8)((()=>ei.getState()??0),[]),[E,U]=(0,t.useState)(!1),G=(0,t.useCallback)((({before:e,after:i})=>{let s=!1;const t=(0,Qe().QX)(e),o=(0,Qe().QX)(i);"private"===t&&"private"!==o&&L<3&&(s=!0,ei.setState(L+1)),U(s)}),[L]),V=(0,t.useCallback)((()=>{P.setState({open:!0})}),[P]),H=(0,t.useCallback)((async()=>{const e=p.permissionItem,s=(0,I().mg)(e);let t;"unlisted"===("open"===_?"unlisted":"open")?(s.unlisted_timestamp=Date.now(),t="open"===D):(delete s.unlisted_timestamp,t=!1);const o=p.from,n=(0,u().Yi)(o),r=!(o.table===m.table&&n===m.id);t=t&&!R&&!i,await(0,de().Hc)({oldPermissionItem:e,newPermissionItem:s,wasInherited:r,environment:b,store:m,restrictingVisibility:t,sudoModeStore:d.permissionItemArgs.sudoModeStore,location:d.permissionItemArgs.location})}),[b,p,R,d.permissionItemArgs,_,m,i,D]),Y=(0,l().IS)((e=>({container:{width:"100%"}})),[]),q=(0,t.useMemo)((()=>[{role:"none",prefixItem:{key:"can-find-in-search-toggle",render:e=>(0,F.jsx)(K().A,{placement:"left",renderTooltip:()=>(0,F.jsx)("div",{style:{width:250,whiteSpace:"normal"},children:(0,F.jsx)(y().sA,{defaultMessage:"Hide this page in search results from users without the link or who havenâ€™t visited it before",id:"spacePermissionItem.unlistedToggle.tooltip"})}),render:i=>(0,F.jsx)("div",{...e,...i,children:(0,F.jsx)(Ye,{permissionItem:p.permissionItem,onToggle:H,focused:e.focused})})}),action:()=>{}}}]),[p,H]),$="private"===_;if(!j)return null;if(A)return w?(0,F.jsx)("div",{style:Y.container,className:x?void 0:re().VRj,children:(0,F.jsx)(z().Ay,{store:m,permissionItem:p.permissionItem,from:p.from,icon:(0,F.jsx)(ii,{visibility:_,spaceStore:j,isMobile:b.device.isMobile}),iconStyle:void 0,title:(0,F.jsx)(si,{store:m,spaceStore:j,spacePermission:p,trustedDomainPermission:e,publicPermission:o,showPublicShareLinkPermission:n,isRestricted:!0,permissionItemArgs:d.permissionItemArgs,fromPermissionWrapper:h,buttonPopupStore:P,visibility:_,hideHoverStyles:$,isDisplayOnly:!0,handleSpacePermissionChange:G}),subtitle:f&&!$?(0,F.jsx)(y().sA,{...(0,ne().R)({type:"space_permission",role:p.permissionItem.role,table:"block",isRemovable:!1}).label}):void 0,upgradeButtonName:"space_permission_item",fromPermissionWrapper:h,isRemovableOverride:!0,hideRoleSelectButton:$,renderTitleWithoutUILabelWrapper:!0,...d.permissionItemArgs,shouldDisable:!0})}):null;const X=M&&(null==B?void 0:B.length)>0&&("open"===_||"unlisted"===_),J=X?(0,F.jsx)(y().sA,{defaultMessage:"Anyone with a {trustedDomain} email can also view this page",id:"blockPermissionsSettings.spacePermission.trustedDomainTooltip",values:{trustedDomain:B[0]}}):void 0;return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(Xe,{originRef:S,onPrimaryButtonClick:V}),(0,F.jsx)(Je().CopyLinkNoPermissionsTooltip,{originRef:S,onPrimaryButtonClick:V}),(0,F.jsx)("div",{style:Y.container,className:x?void 0:re().VRj,ref:S,children:(0,F.jsx)(z().Ay,{store:m,permissionItem:p.permissionItem,from:p.from,icon:(0,F.jsx)(ii,{visibility:_,spaceStore:j,isMobile:b.device.isMobile}),iconStyle:void 0,title:(0,F.jsx)(si,{store:m,spaceStore:j,spacePermission:p,trustedDomainPermission:e,publicPermission:o,showPublicShareLinkPermission:n,isRestricted:i,permissionItemArgs:d.permissionItemArgs,fromPermissionWrapper:h,buttonPopupStore:P,visibility:_,hideHoverStyles:$,isDisplayOnly:d.permissionItemArgs.shouldDisable??!1,handleSpacePermissionChange:G}),selectHeader:f?(0,F.jsx)(W().Ay,{title:(0,F.jsx)(si,{store:m,spaceStore:j,spacePermission:p,trustedDomainPermission:e,publicPermission:o,showPublicShareLinkPermission:n,isRestricted:i,permissionItemArgs:d.permissionItemArgs,fromPermissionWrapper:h,buttonPopupStore:P,visibility:_,hideHoverStyles:$,isDisplayOnly:!0,handleSpacePermissionChange:G}),icon:(0,F.jsx)(ii,{visibility:_,spaceStore:j,isMobile:b.device.isMobile}),desktopIconStyle:{marginInlineStart:16}}):void 0,onClick:V,inheritedTooltip:X?J:void 0,nonInheritedTooltip:J,subtitle:f&&!$?(0,F.jsx)(y().sA,{...(0,ne().R)({type:"space_permission",role:p.permissionItem.role,table:"block",isRemovable:!1}).label}):void 0,upgradeButtonName:"space_permission_item",fromPermissionWrapper:h,isRemovableOverride:!0,hideRoleSelectButton:$,renderTitleWithoutUILabelWrapper:!0,roleItemOverrides:q,openRoleSelectMenuOnRender:E,...d.permissionItemArgs})})]})};function oi(e){const{store:i,spaceOwnerPermission:s,showSpaceOwnerPermission:t,spacePermission:o,showSpacePermission:n,trustedDomainPermission:r,publicPermission:a,showPublicShareLinkPermission:l,permissionItemArgs:c,isRestricted:d}=e,m=(0,se().v)(a.permissionItem);return(0,F.jsxs)(F.Fragment,{children:[t?(0,F.jsx)(Fe,{store:i,spaceOwnerPermission:s,permissionItemArgs:c,fromPermissionWrapper:"permission_list"}):void 0,n&&ni(o,a,l)?l?(0,F.jsx)(ti,{store:i,spacePermission:o,publicPermission:a,showPublicShareLinkPermission:l&&!m,trustedDomainPermission:r,permissionItemArgs:c,fromPermissionWrapper:"permission_list",isRestricted:d,shouldShowPublicShareLinkTooltip:!m}):(0,F.jsx)(ti,{store:i,spacePermission:o,showPublicShareLinkPermission:!1,trustedDomainPermission:void 0,permissionItemArgs:c,fromPermissionWrapper:"permission_list",isRestricted:d}):void 0,l&&m?(0,F.jsx)(Ee,{store:i,spacePermission:o,publicPermission:a,trustedDomainPermission:r,permissionItemArgs:c,fromPermissionWrapper:"permission_list",isRestricted:d}):void 0]})}function ni(e,i,s){return!s||("none"!==e.permissionItem.role||"none"===e.permissionItem.role&&!(0,se().v)(i.permissionItem))}const ri={viewBox:"0 0 20 20",fittedViewBox:"2.35 2.37 15.6 15.25",svg:(0,F.jsx)("path",{d:"M8.674 11.629c2.7 0 5.101 1.315 6.12 3.306.361.705.2 1.42-.23 1.922-.412.48-1.06.768-1.74.768h-8.3c-.68 0-1.328-.288-1.74-.768-.43-.501-.591-1.217-.23-1.922 1.019-1.99 3.42-3.306 6.12-3.306m6.805.01a.675.675 0 1 1 0 1.35.675.675 0 0 1 0-1.35m.114-5.489c1.168 0 2.358.778 2.358 2.013 0 .714-.427 1.29-.974 1.634l-.636.434v.001a.59.59 0 0 0-.27.476.625.625 0 0 1-1.25 0c0-.609.317-1.163.81-1.504l.003-.002.64-.436.012-.01.015-.008c.287-.175.4-.401.4-.585 0-.301-.359-.764-1.108-.764-.632 0-1.018.358-1.09.646a.625.625 0 0 1-1.213-.304c.248-.99 1.263-1.592 2.303-1.592M8.674 2.375c1.137 0 2.055.469 2.675 1.241.608.758.9 1.766.9 2.824 0 1.059-.292 2.067-.9 2.825-.62.772-1.538 1.242-2.675 1.242s-2.055-.47-2.675-1.242c-.608-.758-.9-1.766-.9-2.825 0-1.058.292-2.066.9-2.824.62-.772 1.538-1.241 2.675-1.241"})},ai=(0,oe().wt)("personQuestionFill",ri);const li=function(e){const{store:i}=e,s=(0,l().IS)((e=>({icon:{width:17,height:17,fill:e.icon.secondary},iconContainer:{backgroundColor:e.lightDividerColor,borderRadius:32}})),[]),t={table:g().ev,blockId:i.id};return(0,F.jsx)(z().Ay,{icon:ai(s.icon),iconStyle:s.iconContainer,title:(0,F.jsx)(y().sA,{defaultMessage:"More people may have access",id:"blockPermissionsSettings.permissionItem.hiddenAccess"}),nonInheritedTooltip:(0,F.jsx)(y().sA,{defaultMessage:"This page may be shared with additional people through a parent page or teamspace that you donâ€™t have access to",id:"blockPermissionsSettings.hiddenAccess.tooltip"}),permissionRoleSelect:(0,F.jsx)(F.Fragment,{}),store:i,permissionItem:{type:"display_only_hidden_permission"},from:t,upgradeButtonName:"team_permission_item"})};var ci=()=>s(453597),di=()=>s(574357),mi=()=>s(77295),pi=()=>s(267),ui=()=>s(598101),gi=()=>s(422155),hi=()=>s(584262),bi=()=>s(433847),vi=()=>s(946141),fi=()=>s(296798),yi=()=>s(187820),Ii=()=>s(16006),Si=()=>s(339425),Pi=()=>s(492414),xi=()=>s(186445),_i=()=>s(569028),ji=()=>s(632709),Ai=()=>s(148832),wi=()=>s(95758),Mi=()=>s(848237),ki=()=>s(613850),Ci=()=>s(901389),Ti=()=>s(579627),Ni=()=>s(231297),Bi=()=>s(761652),Ri=()=>s(247123);async function Oi(e){const{environment:i,useSudoMode:s,store:t,permissionChanges:o,from:n,shareMenuSessionId:r,parentStore:a}=e,l={type:"restore",permissionChanges:o};(!(l.permissionChanges.length>0)||(await Ci().Gh({message:(0,Ri().r6)(l),description:(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(U().A,{isSmall:!0,isMultiline:!0,children:(0,F.jsx)(y().sA,{id:"restrictedPermissionConfirmationModal.relink.caption",defaultMessage:"The following settings will be restored to match {parentName}",values:{parentName:(0,F.jsx)(Bi().A,{store:a,style:{fontWeight:ve().Wy.regular},useInvertedColors:!1,maxLength:45})}})}),(0,F.jsx)(Ri().f2,{openState:l})]}),acceptColor:"blue",acceptLabel:(0,Ri().QU)(l),icon:(0,ki().G)({height:oe().Ev.xl,width:oe().Ev.xl})})).accept)&&(t.getPermissionItemsStore().canAdmin()?Ni().createAndCommit({userAction:"PermissionsRestoreBanner.restoreRestrictedPermissions",environment:i,canUndo:!0,useSudoMode:s,perform:e=>{Ti().P8({environment:i,store:t,transaction:e,from:n,shareMenuSessionId:r})}}):Ti().YD({environment:i,store:t,from:n,shareMenuSessionId:r}))}function Di(e){const{store:i,sudoModeStore:s}=e,o=(0,r().v3)(),{isMobile:n}=(0,r().Y0)(),c=(0,a().K8)((()=>function(e){const{store:i,environment:s}=e,t=(0,di().U)([mi().K,(0,ui().A)(Si().o)]);if(i.table===g().ev)return t({environment:s,blocks:[i],publicEditMode:void 0});return!1}({store:i,environment:o})),[i,o]),d=(0,a().K8)((()=>i.table===g().ev&&i.isRestricted()),[i]),m=(0,a().K8)((()=>(0,xi().f)(i,{includeTeamHomeFeed:!1,includeDataSources:!1})[1]),[i]),p=(0,a().K8)((()=>(0,bi().wD)((0,_i().E)(m))),[m]),u=(0,t.useCallback)((async()=>{const e=!!s&&s.shouldSaveTransactionWithSudoMode(i);if(i.isDefined()&&m)if(d){if(i.table===g().ev){const s=i.getPermissionItems(),t=(0,bi().Cd)(i.getModel(),s,p);await Oi({environment:o,useSudoMode:e,store:i,permissionChanges:t,from:"inheritance_banner",shareMenuSessionId:L().Ay.state.sessionId,parentStore:m})}}else await(0,de().Dw)({environment:o,useSudoMode:e,store:i,permissionItem:void 0,fromPermissionWrapper:"inheritance_banner",shouldInherit:!1})}),[o,s,i,d,m,p]),h=(0,l().IS)((e=>({container:{...(0,D().kJ)({theme:e,isMobile:n}),paddingInlineStart:12,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:8},labelContainer:{display:"flex",flexDirection:"row",justifyContent:"flex-start"},rightContainer:{flexShrink:0}})),[n]);return!c&&d?null:m?p.length<2?null:(0,F.jsxs)("div",{style:h.container,children:[(0,F.jsx)("div",{style:h.labelContainer,children:(0,F.jsx)(U().A,{isMultiline:!0,isSmall:!0,children:(0,F.jsx)(Li,{store:i,navigableParentStore:m,showToggle:c})})}),c?(0,F.jsx)("div",{style:h.rightContainer,children:(0,F.jsx)(He().A,{on:!d,onClick:u})}):void 0]}):null}function Li({store:e,navigableParentStore:i,showToggle:s}){const t=(0,r().v3)(),o=(0,a().K8)((()=>{if(i instanceof Ai().B)return(0,Pi().Ay)({store:i,fullyQualified:!1,pageVisitSource:hi().y8.ShareMenu})}),[i]),n=(0,a().K8)((()=>(0,yi().Te)(i)),[i]),c=(0,a().K8)((()=>i.getIcon()),[i]),d=(0,l().IS)((e=>({recordContainer:{display:"inline",alignItems:"center"},title:{display:"inline"},recordIcon:{display:"inline-block",marginInlineEnd:2,verticalAlign:"text-bottom"}})),[]),m=(0,F.jsxs)("div",{style:d.recordContainer,children:[(0,F.jsx)(yi().B6,{disabled:!0,icon:c,iconRecordCategory:n,size:14,isEmptyPage:!1,style:d.recordIcon}),(0,F.jsx)(fi().A,{inline:!0,underline:!0,onClick:()=>{i instanceof wi().h&&(Mi().F2({environment:t,teamId:i.id,tab:ji().p.Members,from:"share_menu"}),vi().ks(t,{store:i,option:"view",from:"share_menu"}))},href:o,style:d.recordContainer,children:(0,F.jsx)(Ii().A,{shouldWrap:!0,store:i,style:d.title})})]});return s?(0,F.jsx)(y().sA,{id:"pageShareMenu.inheritingFromParentPageBanner.switchLabel",defaultMessage:"Share with everyone who has access to {parentPageTitle}",values:{parentPageTitle:m}}):(0,F.jsx)(y().sA,{id:"pageShareMenu.inheritingFromParentPageBanner.readOnlyLabel",defaultMessage:"Shared with everyone who has access to {parentPageTitle}",values:{parentPageTitle:m}})}var Ei=()=>s(243581),Wi=()=>s(105239),Ki=()=>s(126617),Ui=()=>s(735790),Gi=()=>s(854150),Vi=()=>s(285790),zi=()=>s(115512);async function Fi(e){const{environment:i,useSudoMode:s,store:t}=e;if(t.table!==g().ev)return;const o={type:"restoreTeamPermissions",permissionChanges:[]},{accept:n}=await Ci().Gh({message:(0,Ri().r6)(o),acceptLabel:(0,Ri().QU)(o),cancelLabel:(0,F.jsx)(y().sA,{id:"restrictedPermissionConfirmationModal.actionButton.close",defaultMessage:"Close"})});n&&Ni().createAndCommit({userAction:"PermissionsRestoreBanner.restoreTeamPermissions",environment:i,canUndo:!0,useSudoMode:s,perform:e=>{Ti().zE({environment:i,store:t,transaction:e})}})}function Hi(e){const{showRestoreButton:i,store:s,type:t,sudoModeStore:o}=e,n=(0,r().v3)(),{isMobile:c}=(0,r().Y0)(),d=(0,a().K8)((()=>(0,xi().f)(s,{includeTeamHomeFeed:!1,includeDataSources:!1})[1]),[s]),m=(0,a().K8)((()=>s.canAdmin()),[s]),p=(0,l().IS)((e=>({banner:{...(0,D().kJ)({theme:e,isMobile:c}),display:"flex",flexDirection:"row",alignItems:"flex-start",gap:8},content:{display:"flex",alignItems:"flex-start",gap:2,flex:"1 0 0"},label:{fontSize:(0,zi().ny)(n,"UIRegular"),lineHeight:"20px",color:e.text.secondary,flex:"1 0 0",paddingInlineStart:4},iconContainer:{paddingTop:2,height:20,width:20,display:"flex",alignItems:"center",justifyContent:"center"}})),[n,c]);return m?c?(0,F.jsxs)("div",{style:p.banner,children:[(0,F.jsxs)("div",{style:p.content,children:["restricted"===t?(0,F.jsx)("div",{style:p.iconContainer,children:(0,F.jsx)(me().I,{icon:Ei().r,colorVariant:"secondary"})}):void 0,(0,F.jsx)(U().A,{style:p.label,isMultiline:!0,children:(0,F.jsx)(Yi,{type:t,navigableParentStore:d,showRestoreButton:i,store:s})})]}),i?(0,F.jsx)(qi,{type:t,store:s,sudoModeStore:o}):void 0]}):(0,F.jsxs)("div",{style:p.banner,children:[(0,F.jsxs)("div",{style:p.content,children:["restricted"===t?(0,F.jsx)("div",{style:p.iconContainer,children:(0,F.jsx)(me().I,{icon:Ei().r,colorVariant:"secondary"})}):void 0,(0,F.jsx)(U().A,{style:p.label,isMultiline:!0,children:(0,F.jsx)(Yi,{store:s,type:t,navigableParentStore:d,showRestoreButton:i})})]}),i?(0,F.jsx)(qi,{type:t,store:s,sudoModeStore:o}):void 0]}):null}function Yi(e){const{store:i,type:s,navigableParentStore:t}=e,o=(0,r().v3)(),n=(0,a().K8)((()=>{if(t instanceof Ai().B)return(0,Pi().Ay)({store:t,fullyQualified:!1,pageVisitSource:hi().y8.ShareMenu})}),[t]),c=(0,a().K8)((()=>t instanceof wi().h),[t]),d=(0,a().K8)((()=>t.getIcon()),[t]),m=(0,a().K8)((()=>i.table===v().C0?"workflow":i.isCollectionView()?"database":"page"),[i]),p=(0,l().IS)((e=>({recordContainer:{display:"inline",alignItems:"center",gap:2,marginInlineStart:2},title:{display:"inline"},recordIcon:{display:"inline-block",marginInlineEnd:2,verticalAlign:"text-bottom"}})),[]),u=t instanceof wi().h?(0,F.jsx)(fi().A,{inline:!0,underline:!0,onClick:()=>{Mi().F2({environment:o,teamId:t.id,tab:ji().p.Members,from:"permission_item"}),vi().ks(o,{store:t,option:"view",from:"share_menu"})},children:(0,F.jsx)(Ii().A,{shouldWrap:!0,maxLength:30,store:t,style:p.title})}):(0,F.jsxs)("div",{style:p.recordContainer,children:[d?(0,F.jsx)(yi().B6,{disabled:!0,icon:d,iconRecordCategory:"database"===m?"collectionViewBlock":"pageBlock",size:14,isEmptyPage:!1,style:p.recordIcon}):void 0,(0,F.jsx)(fi().A,{inline:!0,href:n,style:p.recordContainer,children:(0,F.jsx)(Ii().A,{shouldWrap:!1,maxLength:30,store:t,style:p.title,underline:!0})})]});switch(s){case"elevated":return c?"database"===m?(0,F.jsx)(y().sA,{id:"pageShareMenu.restoreTeamspacePermissionsBannerDatabase.label",defaultMessage:"Share settings on this database differ from the {teamspaceTitle} teamspace default",values:{teamspaceTitle:u}}):(0,F.jsx)(y().sA,{id:"pageShareMenu.restoreTeamspacePermissionsBanner.label",defaultMessage:"Share settings on this page differ from the {teamspaceTitle} teamspace default",values:{teamspaceTitle:u}}):"database"===m?(0,F.jsx)(y().sA,{id:"pageShareMenu.restoreParentPagePermissionsBannerDatabase.label",defaultMessage:"Share settings on this database differ from the parent page {parentPageTitle}",values:{parentPageTitle:u}}):(0,F.jsx)(y().sA,{id:"pageShareMenu.restoreParentPagePermissionsBanner.label",defaultMessage:"Share settings on this page differ from the parent page {parentPageTitle}",values:{parentPageTitle:u}});case"restricted":return c?"database"===m?(0,F.jsx)(y().sA,{id:"pageShareMenu.restrictedAccessFromTeamspaceBannerDatabase.label",defaultMessage:"Share settings on this database are unlinked from the {teamspaceTitle} teamspace default",values:{teamspaceTitle:u}}):(0,F.jsx)(y().sA,{id:"pageShareMenu.restrictedAccessFromTeamspaceBanner.label",defaultMessage:"Share settings on this page are unlinked from the {teamspaceTitle} teamspace default",values:{teamspaceTitle:u}}):"database"===m?(0,F.jsx)(y().sA,{id:"pageShareMenu.restrictedAccessFromParentPageBannerDatabase.label",defaultMessage:"Share settings on this database are unlinked from the parent page {parentPageTitle}",values:{parentPageTitle:u}}):(0,F.jsx)(y().sA,{id:"pageShareMenu.restrictedAccessFromParentPageBanner.label",defaultMessage:"Share settings on this page are unlinked from the parent page {parentPageTitle}",values:{parentPageTitle:u}});default:(0,be().HB)(s)}}function qi(e){const{type:i,store:s,sudoModeStore:t}=e,o=(0,r().v3)(),{isMobile:n}=(0,r().Y0)(),c=(0,y().tz)(),d=(0,a().K8)((()=>!!t&&t.shouldSaveTransactionWithSudoMode(s)),[s,t]),m=(0,a().K8)((()=>(0,xi().f)(s,{includeTeamHomeFeed:!1,includeDataSources:!1})[1]),[s]),p=m.table===Gi().yK,u=(0,a().K8)((()=>{if(m instanceof Ai().B)return(0,Pi().Ay)({store:m,fullyQualified:!1,pageVisitSource:hi().y8.ShareMenu})}),[m]),g=(0,l().IS)((e=>({icon:{fill:e.icon.secondary,height:16,width:16},mobileRestoreButton:{fontSize:(0,zi().ny)(o,"UIRegular"),fontWeight:ve().Wy.medium,flexShrink:0,borderRadius:4,paddingInlineStart:4,paddingInlineEnd:4,color:e.blue.text.accentPrimary}})),[o]),h=[p?{key:"showTeamSettings",render:e=>(0,F.jsx)(fe().A,{...e,icon:(0,F.jsx)(me().I,{icon:Ui().M}),title:(0,F.jsx)(y().sA,{id:"pageShareMenu.restoreParentPagePermissionsBanner.viewDefaults.label",defaultMessage:"View defaults"})}),action:()=>{m.table===Gi().yK&&(Mi().F2({environment:o,teamId:m.id,tab:ji().p.Members,from:"permission_item"}),vi().ks(o,{store:m,option:"view",from:"share_menu"}))}}:u?{key:"showParentPageSettings",render:e=>(0,F.jsx)(fe().A,{...e,icon:(0,F.jsx)(me().I,{icon:Ui().M}),title:(0,F.jsx)(y().sA,{id:"pageShareMenu.restoreParentPagePermissionsBanner.viewDefaults.label",defaultMessage:"View defaults"}),href:u}),action:()=>{}}:void 0,{key:"restore",action:async()=>{if("elevated"===i)await Fi({environment:o,useSudoMode:d,store:s});else if("restricted"===i){if(!s.isDefined())return;if(s.table===v().C0)return;const e=s.getPermissionItems(),i=(0,xi().f)(s,{includeTeamHomeFeed:!1,includeDataSources:!1})[1];if(!i)return;const t=(0,bi().wD)((0,_i().E)(i)),n=(0,bi().Cd)(s.getModel(),e,t);await Oi({environment:o,useSudoMode:d,store:s,permissionChanges:n,from:"unlinked_banner",shareMenuSessionId:L().Ay.state.sessionId,parentStore:i})}else(0,be().HB)(i)},render:e=>(0,F.jsx)(fe().A,{...e,title:(0,F.jsx)(y().sA,{id:"pageShareMenu.restoreParentPagePermissionsBanner.restoreSettings.label",defaultMessage:"Restore settings"}),icon:(0,F.jsx)(me().I,{icon:Wi().N})})}].filter(be().O9),b=[{key:"all",render:e=>(0,F.jsx)(_().A,{...e}),items:h}];return n?(0,F.jsx)(Z().Ay,{style:g.mobileRestoreButton,onClick:async()=>{if("elevated"===i)await Fi({environment:o,useSudoMode:d,store:s});else if("restricted"===i){if(!s.isDefined())return;if(s.table===v().C0)return;const e=s.getPermissionItems(),i=(0,xi().f)(s,{includeTeamHomeFeed:!1,includeDataSources:!1})[1];if(!i)return;const t=(0,bi().wD)((0,_i().E)(i)),n=(0,bi().Cd)(s.getModel(),e,t);await Oi({environment:o,useSudoMode:d,store:s,permissionChanges:n,from:"unlinked_banner",shareMenuSessionId:L().Ay.state.sessionId,parentStore:i})}else(0,be().HB)(i)},children:(0,F.jsx)(y().sA,{defaultMessage:"Restore",id:"pageShareMenu.restoreParentPagePermissionsBanner.restore.mobile.label"})}):(0,F.jsx)(ge().A,{render:()=>(0,F.jsx)(ye().A,{menuType:Se().gu.Popup,children:(0,F.jsx)(Ie().Ay,{type:Ie().Oh.Vertical,sections:b,initialFocus:void 0})}),renderOrigin:e=>(0,F.jsx)(Vi().A,{icon:Ki().ellipsisSmallIcon,iconStyle:g.icon,ariaLabel:c.formatMessage({id:"pageShareMenu.restorePagePermissionsBanner.restoreOptionsButton.label",defaultMessage:"See restore permissions options"}),...e}),popupType:ge().z.Popup,placementToOrigin:"bottom",alignmentToOrigin:"end"})}function $i(e){const{store:i}=e,s=(0,r().v3)(),t=(0,a().K8)((()=>function(e){const{store:i,environment:s}=e,t=(0,gi().or)([mi().K,(0,di().U)([pi()._,(0,ui().A)(mi().K)])]);if(i.table!==g().ev)return!1;return t({environment:s,blocks:[i],publicEditMode:void 0})}({store:i,environment:s})),[i,s]);return(0,F.jsx)(Hi,{type:"restricted",showRestoreButton:t,store:i,sudoModeStore:e.sudoModeStore})}function Xi(e){const{store:i}=e;return(0,a().K8)((()=>(0,O().le)({store:i})),[i])?(0,F.jsx)(Hi,{type:"elevated",showRestoreButton:!1,store:i,sudoModeStore:e.sudoModeStore}):null}const Ji=function(e){const{store:i,showRestrictedPermissionBanner:s,showPermissionInheritanceBanner:t}=e;return(0,a().K8)((()=>(0,O().iG)({store:i}).canAccessParent),[i])?t?(0,F.jsx)(Di,{store:i,sudoModeStore:e.sudoModeStore}):s?(0,F.jsx)($i,{store:i,sudoModeStore:e.sudoModeStore}):(0,F.jsx)(Xi,{store:i,sudoModeStore:e.sudoModeStore}):null};var Qi=()=>s(173783),Zi=()=>s(422366),es=()=>s(37433);function is(e){const{teamName:i,isCompact:s}=e;return s?(0,F.jsx)(y().sA,{defaultMessage:"Teamspace guests",id:"blockPermissionsSettings.permissionItem.teamGuestAccess.compact"}):i?(0,F.jsx)(y().sA,{defaultMessage:"Teamspace guests of {teamName}",id:"blockPermissionsSettings.permissionItem.teamGuestAccess",values:{teamName:i}}):(0,F.jsx)(y().sA,{id:"blockPermissionsSettings.permissionItem.teamspaceGuestsTeamName.hidden",defaultMessage:"Teamspace guests of a private teamspace"})}function ss({teamGuestsCount:e,isCompact:i}){return 0===e?null:(0,F.jsx)(y().sA,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamGuestPermission.subtitle",values:{membersCount:e}})}function ts(e){const{teamName:i}=e,s=(0,l().IS)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return i?(0,F.jsx)("div",{style:s.tooltip,children:(0,F.jsx)(y().sA,{defaultMessage:"Applies to all teamspace guests of {teamName}.",values:{teamName:i},id:"blockPermissionsSettings.teamGuestPermission.tooltip"})}):null}const os=function({store:e,blockTeamGuestPermission:i,isExternalTeam:s,fromPermissionWrapper:t,teamGuestsCount:o,permissionItemArgs:n}){const{isMobile:c}=(0,r().Y0)(),{permissionItem:d}=i,m=(0,a().O$)(C().AppStoreSidebarSpaceStore),p=(0,a().K8)((()=>{var i;return u().un(d)?d.team_id:null===(i=(0,Zi().U)(e))||void 0===i?void 0:i.id}),[d,e]),{teamStore:g,teamIsDefined:h,teamName:b}=(0,a().K8)((()=>{if(!m||!p)return{};const e=wi().h.createChildStore(m,{table:Gi().yK,id:p,spaceId:m.id});return null!=e&&e.isDefined()?{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:e.getName()}:{}}),[m,p]),v=(0,a().K8)((()=>{if(o)return o;if(void 0!==g){const e=(0,es().PF)({teamStore:g});if(void 0!==e)return e.totalMembersAndGuestsCount-e.membersIncludingOwnersCount}}),[g,o]),f=!s,y=(0,l().IS)((()=>({container:{width:"100%"}})),[]);return g?(0,F.jsx)("div",{style:y.container,className:re().rkF,children:(0,F.jsx)(z().Ay,{isCompact:f,store:e,permissionItem:d,icon:(0,F.jsx)(Qi().A,{size:c?z().Bj:z().Ev}),title:(0,F.jsx)(is,{teamName:b,isCompact:f}),nonInheritedTooltip:(0,F.jsx)(ts,{teamName:b}),from:i.from,subtitle:h&&(0,F.jsx)(ss,{teamGuestsCount:v??0,isCompact:f}),upgradeButtonName:"team_permission_item",fromPermissionWrapper:t,...n})}):null};function ns({teamName:e,isCompact:i}){return i?(0,F.jsx)(y().sA,{defaultMessage:"Members",id:"blockPermissionsSettings.permissionItem.teamAccessV3"}):e?(0,F.jsx)(y().sA,{defaultMessage:"Teamspace members",id:"blockPermissionsSettings.permissionItem.teamAccessV2"}):(0,F.jsx)(y().sA,{id:"blockPermissionsSettings.permissionItem.membersTeamName.hidden",defaultMessage:"Members of a private teamspace"})}function rs({membersCount:e,permissionItem:i}){const{isMobile:s}=(0,r().Y0)();return 0===e?null:s&&i?(0,F.jsxs)("div",{children:[(0,F.jsx)(y().sA,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamMembersPermission.subtitle",values:{membersCount:e}})," Â· ",(0,F.jsx)(y().sA,{...(0,ne().R)({type:i.type,role:i.role,table:Gi().yK,isRemovable:!1}).label})]}):(0,F.jsx)(y().sA,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamMembersPermission.subtitle",values:{membersCount:e}})}function as(e){const{teamName:i}=e,s=(0,l().IS)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return i?(0,F.jsx)("div",{style:s.tooltip,children:(0,F.jsx)(y().sA,{defaultMessage:"Applies to all owners and members of {teamName}.",values:{teamName:i},id:"blockPermissionsSettings.teamPermission.tooltip"})}):null}const ls=function({store:e,blockTeamPermission:i,isExternalTeam:s,fromPermissionWrapper:t,teamMembersCount:o,permissionItemArgs:n}){const{isMobile:c}=(0,r().Y0)(),{permissionItem:d}=i,m=(0,a().O$)(C().AppStoreSidebarSpaceStore),p=(0,a().K8)((()=>{var i;return u().gl(d)?d.team_id:null===(i=(0,Zi().U)(e))||void 0===i?void 0:i.id}),[d,e]),{teamStore:g,teamIsDefined:h,teamName:b}=(0,a().K8)((()=>{if(!m||!p)return{};const e=wi().h.createChildStore(m,{table:Gi().yK,id:p,spaceId:m.id});return{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:null==e?void 0:e.getName()}}),[m,p]),v=!s,f=(0,a().K8)((()=>{return o||(void 0!==g?null===(e=(0,es().PF)({teamStore:g,spaceId:null==m?void 0:m.id}))||void 0===e?void 0:e.membersIncludingOwnersCount:void 0);var e}),[g,o,m]),y=(0,l().IS)((()=>({container:{width:"100%"}})),[]);return g?(0,F.jsx)("div",{style:y.container,className:re().rkF,children:(0,F.jsx)(z().Ay,{isCompact:v,store:e,permissionItem:i.permissionItem,from:i.from,icon:(0,F.jsx)(Qi().A,{size:c?z().Bj:z().Ev}),title:(0,F.jsx)(ns,{teamName:b,isCompact:v}),nonInheritedTooltip:(0,F.jsx)(as,{teamName:(0,F.jsx)(Bi().A,{store:g,useInvertedColors:!0})}),subtitle:h&&(0,F.jsx)(rs,{membersCount:f??0,permissionItem:i.permissionItem}),upgradeButtonName:"team_permission_item",fromPermissionWrapper:t,...n})}):null};function cs({teamName:e,isCompact:i}){return i?(0,F.jsx)(y().sA,{defaultMessage:"Owners",id:"blockPermissionsSettings.permissionItem.teamOwnerAccessV3"}):e?(0,F.jsx)(y().sA,{defaultMessage:"Teamspace owners",id:"blockPermissionsSettings.permissionItem.teamOwnerAccessV2",values:{teamName:e}}):(0,F.jsx)(y().sA,{id:"blockPermissionsSettings.permissionItem.teamName.hidden",defaultMessage:"Owners of a private teamspace"})}function ds({teamOwnersCount:e,isCompact:i,permissionItem:s}){const{isMobile:t}=(0,r().Y0)();return 0===e?null:t&&s?(0,F.jsxs)("div",{children:[(0,F.jsx)(y().sA,{defaultMessage:"{teamOwnersCount, plural, one {{teamOwnersCount} person} other {{teamOwnersCount} people}}",id:"blockPermissionsSettings.teamOwnerPermission.subtitle",values:{teamOwnersCount:e}})," Â· ",(0,F.jsx)(y().sA,{...(0,ne().R)({type:s.type,role:s.role,table:Gi().yK,isRemovable:!1}).label})]}):(0,F.jsx)(y().sA,{defaultMessage:"{teamOwnersCount, plural, one {{teamOwnersCount} person} other {{teamOwnersCount} people}}",id:"blockPermissionsSettings.teamOwnerPermission.subtitle",values:{teamOwnersCount:e}})}function ms(e){const{teamName:i}=e,s=(0,l().IS)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return i?(0,F.jsx)("div",{style:s.tooltip,children:(0,F.jsx)(y().sA,{defaultMessage:"Applies to all owners of {teamName}",values:{teamName:i},id:"blockPermissionsSettings.teamOwnerPermission.tooltip"})}):null}const ps=function({store:e,blockTeamOwnerPermission:i,isExternalTeam:s,fromPermissionWrapper:t,teamOwnersCount:o,permissionItemArgs:n}){const{isMobile:c}=(0,r().Y0)(),{permissionItem:d}=i,m=(0,a().O$)(C().AppStoreSidebarSpaceStore),p=(0,a().K8)((()=>{var i;return u().nl(d)?d.team_id:null===(i=(0,Zi().U)(e))||void 0===i?void 0:i.id}),[d,e]),{teamStore:g,teamName:h}=(0,a().K8)((()=>{if(!m||!p)return{undefined:void 0};const e=wi().h.createChildStore(m,{table:Gi().yK,id:p,spaceId:m.id});return{teamStore:e,teamName:e.getName()}}),[m,p]),b=!s,v=(0,a().K8)((()=>{return o||(void 0!==g?null===(e=(0,es().PF)({teamStore:g}))||void 0===e?void 0:e.ownersCount:void 0);var e}),[g,o]),f=(0,l().IS)((()=>({container:{width:"100%"}})),[]);return g?(0,F.jsx)("div",{style:f.container,className:re().D3T,children:(0,F.jsx)(z().Ay,{isCompact:b,store:e,permissionItem:i.permissionItem,from:i.from,icon:(0,F.jsx)(Qi().A,{size:c?z().Bj:z().Ev}),title:(0,F.jsx)(cs,{teamName:h,isCompact:b}),nonInheritedTooltip:(0,F.jsx)(ms,{teamName:(0,F.jsx)(Bi().A,{store:g,useInvertedColors:!0})}),subtitle:(0,F.jsx)(ds,{teamOwnersCount:v??0,isCompact:b,permissionItem:i.permissionItem}),upgradeButtonName:"team_owner_permission_item",fromPermissionWrapper:t,...n})}):null};var us=()=>s(515187),gs=()=>s(710149),hs=()=>s(180925);function bs({teamName:e}){return e?(0,F.jsx)(y().sA,{defaultMessage:"People in {teamName}",id:"blockPermissionsSettings.permissionItem.teamspaceAccessV2",values:{teamName:e}}):(0,F.jsx)(y().sA,{defaultMessage:"People in a private teamspace",id:"blockPermissionsSettings.permissionItem.teamspace.hiddenV2"})}function vs({membersCount:e,teamPermissionItem:i}){const{isMobile:s}=(0,r().Y0)(),t=(0,l().IS)((e=>({container:{display:"flex",alignItems:"center",gap:2}})),[]),o=e?(0,F.jsx)("div",{children:(0,F.jsx)(y().sA,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.memberCount.subtitle",values:{membersCount:e}})}):(0,F.jsxs)("div",{style:t.container,children:[(0,F.jsx)(gs().A,{style:{height:12,width:14,borderRadius:4,marginInlineEnd:2,marginInlineStart:2}}),(0,F.jsx)(y().sA,{defaultMessage:"people",id:"blockPermissionsSettings.teamPermission.subtitle.people",values:{membersCount:e}})]});return s?(0,F.jsxs)("div",{style:t.container,children:[o,i?(0,F.jsxs)(F.Fragment,{children:[" Â· ",(0,F.jsx)(y().sA,{...(0,ne().R)({type:i.type,role:i.role,table:"block",isRemovable:!1}).label})]}):void 0]}):(0,F.jsxs)("div",{style:t.container,children:[(0,F.jsx)(y().sA,{defaultMessage:"Teamspace",id:"blockPermissionsSettings.teamPermission.subtitle.teamspace"})," Â· ",o]})}const fs=function({store:e,blockTeamMemberPermission:i,blockTeamOwnerPermission:o,blockTeamGuestPermission:n,permissionItemArgs:c}){const d=(0,r().v3)(),m=d.device.isMobile,[p,h]=(0,t.useState)(!1),[b,v]=(0,t.useState)(!1),{permissionItem:f}=i,I=(0,a().O$)(C().AppStoreSidebarSpaceStore),P=(0,a().K8)((()=>{var i;return u().gl(f)?f.team_id:null===(i=(0,Zi().U)(e))||void 0===i?void 0:i.id}),[f,e]),x=o.permissionItem.role,_=f.role,A={type:"display_only_overview_permission",role:x===_?_:"none"===_||"none"===x?"limited":"access"},{teamStore:w,teamIsDefined:M,teamName:k}=(0,a().K8)((()=>{if(!I||!P)return{undefined:void 0};const e=wi().h.createChildStore(I,{table:Gi().yK,id:P,spaceId:I.id});return{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:null==e?void 0:e.getName()}}),[I,P]),T=(0,a().K8)((()=>{if(void 0!==w)return(0,es().PF)({teamStore:w,spaceId:null==I?void 0:I.id})}),[w,I]),{membersCount:N,totalMembersAndGuestsCount:B,ownersCount:R,teamGuestsCount:O}=void 0!==T?{membersCount:T.membersIncludingOwnersCount,totalMembersAndGuestsCount:T.totalMembersAndGuestsCount,ownersCount:T.ownersCount,teamGuestsCount:T.totalMembersAndGuestsCount-T.membersIncludingOwnersCount}:{membersCount:0,totalMembersAndGuestsCount:void 0,ownersCount:0,teamGuestsCount:0},E=(0,a().K8)((()=>{if(!I)return!1;return!I.getDisableTeamGuests()&&((null==w||!w.isDefault())&&(0,j().Qd)())}),[I,w]),W=(0,t.useCallback)((()=>h(!0)),[]),K=(0,t.useCallback)((()=>h(!1)),[]),U=(0,t.useCallback)((()=>{const e=!1===b;if(v(!b),e){if(!w)return;S().lD(d,{share_menu_session_id:L().Ay.state.sessionId,type:"team",team_id:w.id})}}),[d,b,v,w]),G=(0,l().IS)((e=>({teamPermissionsContainer:{paddingInlineStart:16,display:b?"block":"none"},roleButton:{color:e.text.secondary,fontSize:(0,D().kx)({environment:d})},mobileTitleContainer:{display:"flex",alignItems:"center"},mobileTextContainer:{dislay:"block",overflow:"hidden"},mobileChevronIcon:{marginInlineStart:4,fill:e.icon.secondary,transform:`rotate(${b?90:0}deg)`,transition:"transform 150ms ease"}})),[b,d]);if(!w)return null;const V=M?(0,F.jsx)(ze,{store:w}):(0,s(566910).e)(),H=(0,F.jsx)(hs().A,{expanded:b,hovered:p,onClick:U,children:V});return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(z().Ay,{store:e,permissionItem:A,from:i.from,onMouseEnter:W,onMouseLeave:K,icon:H,title:m?(0,F.jsxs)("div",{style:G.mobileTitleContainer,children:[(0,F.jsx)("div",{style:G.mobileTextContainer,children:(0,F.jsx)(bs,{teamName:k})}),(0,F.jsx)("div",{style:G.mobileChevronIcon,children:(0,F.jsx)(me().I,{icon:ue().arrowChevronSingleRightSmallIcon,size:"sm"})})]}):(0,F.jsx)(bs,{teamName:k}),subtitle:M&&(0,F.jsx)(vs,{membersCount:B,teamPermissionItem:A}),nonInheritedTooltip:(0,F.jsx)(y().sA,{id:"TeamPermissionItem.access",defaultMessage:"People in the {inlineIconAndName} teamspace",values:{inlineIconAndName:(0,F.jsx)(Bi().A,{store:w,useInvertedColors:!0})}}),upgradeButtonName:"team_permission_item",onClick:U,permissionRoleSelect:!b&&(0,F.jsx)(ne().Y,{type:A.type,role:A.role,icon:us().w,disabled:!0,buttonStyle:G.roleButton,table:g().ev,isCurrentUser:!1,from:"shareMenu"}),isCollapsible:!0,...c}),(0,F.jsxs)("div",{style:G.teamPermissionsContainer,children:[o?(0,F.jsx)(ps,{store:e,permissionItemArgs:c,blockTeamOwnerPermission:o,teamOwnersCount:R,fromPermissionWrapper:"expandable_permission"}):void 0,i?(0,F.jsx)(ls,{store:e,permissionItemArgs:c,blockTeamPermission:i,teamMembersCount:N,fromPermissionWrapper:"expandable_permission"}):void 0,E&&n?(0,F.jsx)(os,{store:e,permissionItemArgs:c,blockTeamGuestPermission:n,teamGuestsCount:O,fromPermissionWrapper:"expandable_permission"}):void 0]})]})};var ys=()=>s(64744);function Is(e){const{store:i,isExpanded:s,numberOfPeopleInvited:o,inheritedPermissionRole:n,permissionItemArgs:c,onToggle:d}=e,m=(0,r().v3)(),p=m.device.isMobile,u=(0,a().K8)((()=>(0,xi().f)(i,{includeTeamHomeFeed:!1,includeDataSources:!1})[1]),[i]),[h,b]=t.useState(!1),v=(0,a().K8)((()=>{const e=(0,xi().f)(i,{includeTeamHomeFeed:!1,includeDataSources:!1})[1];if(e instanceof wi().h)return{icon:(0,F.jsx)(ke().x,{disabled:!0,store:e,size:p?z().Bj:z().Ev}),title:e.getName()};if(e instanceof Ai().B){if("page"===e.getType()){const i=e.isEmptyPage();return{icon:(0,F.jsx)(yi().B6,{disabled:!0,icon:e.getIcon(),size:20,isEmptyPage:i,iconRecordCategory:(0,yi().Te)(e)}),title:(0,F.jsx)(Ii().A,{shouldWrap:!0,store:e}),fromTable:g().ev,fromId:e.id}}if("collection_view"===e.getType()||"collection_view_page"===e.getType())return{icon:(0,F.jsx)(yi().B6,{disabled:!0,icon:e.getIcon(),size:20,isEmptyPage:e.isDefined(),iconRecordCategory:(0,yi().Te)(e)}),title:(0,F.jsx)(Ii().A,{shouldWrap:!0,store:e}),fromTable:g().ev,fromId:e.id}}}),[i,p]),f=(0,t.useCallback)((()=>b(!0)),[]),I=(0,t.useCallback)((()=>b(!1)),[]),S=(0,l().IS)((e=>({mobileTitleContainer:{display:"flex",alignItems:"center"},mobileTextContainer:{dislay:"block",overflow:"hidden"},mobileChevronIcon:{marginInlineStart:4,fill:e.icon.secondary,transform:`rotate(${s?90:0}deg)`,transition:"transform 150ms ease"},roleButton:{color:e.text.secondary,fontSize:(0,D().kx)({environment:m})},selectContainer:{opacity:s?0:1},loadingSubtitleContainer:{display:"flex",alignItems:"center"},placeholderSubtitle:{height:12,width:14,borderRadius:4,marginInlineEnd:2}})),[m,s]),P={type:"display_only_inherited_permission",role:n??"access"};return v?(0,F.jsx)(z().Ay,{icon:v.icon&&(0,F.jsx)(hs().A,{onClick:d,expanded:s,hovered:h,children:(0,F.jsx)(De().A,{type:"circle",iconType:"element",element:v.icon,isMobile:p})}),store:i,permissionItem:P,onMouseEnter:f,onMouseLeave:I,from:{table:g().ev,blockId:v.fromId?v.fromId:i.id},title:p?(0,F.jsxs)("div",{style:S.mobileTitleContainer,children:[(0,F.jsx)("div",{style:S.mobileTextContainer,children:(0,F.jsx)(y().sA,{id:"permissionsListV2.inheritedPermissions",defaultMessage:"People invited to {title}",values:{title:v.title}})}),(0,F.jsx)("div",{style:S.mobileChevronIcon,children:(0,F.jsx)(me().I,{icon:ue().arrowChevronSingleRightSmallIcon,size:"sm"})})]}):(0,F.jsx)(y().sA,{id:"permissionsListV2.inheritedPermissions",defaultMessage:"People invited to {title}",values:{title:v.title}}),subtitle:o?(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(y().sA,{id:"inheritedPermissionItem.numberOfPeopleInvited",defaultMessage:"{numberOfPeopleInvited, plural, one {{numberOfPeopleInvited} person} other {{numberOfPeopleInvited} people}}",values:{numberOfPeopleInvited:o}}),p?(0,F.jsxs)(F.Fragment,{children:[" Â· ",(0,F.jsx)(y().sA,{...(0,ne().R)({type:P.type,role:P.role,table:"block",isRemovable:!1}).label})]}):void 0]}):(0,F.jsxs)("div",{style:S.loadingSubtitleContainer,children:[(0,F.jsx)(gs().A,{style:S.placeholderSubtitle}),(0,F.jsx)(y().sA,{id:"inheritedPermissionItem.subtitle.people",defaultMessage:"people",values:{numberOfPeopleInvited:o}}),p?(0,F.jsxs)(F.Fragment,{children:[" Â· ",(0,F.jsx)(y().sA,{...(0,ne().R)({type:P.type,role:P.role,table:"block",isRemovable:!1}).label})]}):void 0]}),inheritedTooltip:o&&o>0?(0,F.jsx)(y().sA,{id:"inheritedPermissionItem.numberOfPeopleInvited.tooltip",defaultMessage:"{numberOfPeopleInvited, plural, one {{numberOfPeopleInvited} person has } other {{numberOfPeopleInvited} people have}} access through the parent page {inlineIconAndName}",values:{numberOfPeopleInvited:o,inlineIconAndName:(0,F.jsx)(Bi().A,{store:u,useInvertedColors:!0})}}):null,upgradeButtonName:"team_permission_item",onClick:d,permissionRoleSelect:(0,F.jsx)("div",{style:S.selectContainer,children:(0,F.jsx)(ne().Y,{type:P.type,role:P.role,icon:us().w,disabled:!0,buttonStyle:S.roleButton,table:g().ev,isCurrentUser:!1,from:"shareMenu"})}),isCollapsible:!0,style:e.style,...c}):null}const Ss=t.memo(Is);var Ps=()=>s(801191),xs=()=>s(852507);const _s=(0,y().YK)({commenter:{id:"permissionsLevelBanner.commenter.labelV2",defaultMessage:"You can only comment on this page"},reader:{id:"permissionsLevelBanner.reader.labelV2",defaultMessage:"You can only view this page"}});function js({store:e}){const i=(0,r().v3)(),{isMobile:s}=(0,r().Y0)(),n=(0,a().K8)((()=>e.getRole()),[e]),[c,d]=(0,t.useState)("noRequest"),m=(0,o().X)("share_menu_inheritance_banner");(0,xs().l)((()=>{S().VJ(i,{share_menu_session_id:L().Ay.state.sessionId,role:n})}));const p=(0,l().IS)((e=>({container:{...(0,D().kJ)({theme:e,isMobile:s}),display:"flex",alignItems:"center",justifyContent:"space-between"},bannerBodyContainer:{display:"flex",alignItems:"center"},bannerLabel:{display:"flex"},pendingAccessRequestLabel:{color:e.text.tertiary},accessRequestLabel:{color:e.blue.text.accentPrimary},accessRequestButton:{display:"flex",alignItems:"center",justifyContent:"center",fontWeight:ve().Wy.medium,flexShrink:0,borderRadius:4,paddingInlineStart:6,paddingInlineEnd:6,margin:-4,height:24}})),[s]),u=(0,t.useCallback)((async()=>{var s;if("reader"!==n&&"comment_only"!==n)return;const t=await P().callApi({eventName:"requestAccess",environment:i,data:{type:"current-actor-to-block",block:{id:e.id,spaceId:e.getSpaceId()},attributes:{origin_type:"share_menu",add_permissions_on_approval:!1,role:"read_and_write",existing_permissions:n},message:void 0}});"success"===t.type&&t.data.request?(d("requested"),S().T_(i,{request_access_type:"page",previous_access_level:n,requested_access_level:"read_and_write",requestId:t.data.requestId})):"failed"===t.type&&"UserRateLimitResponse"===(null===(s=t.body)||void 0===s?void 0:s.name)&&d("rateLimited")}),[i,n,e]),g=n?function(e){switch(e){case"comment_only":return _s.commenter;case"reader":return _s.reader;case"editor":case"read_and_write":case"none":case"membership_admin":case"content_only_editor":return null;default:(0,be().HB)(e)}}(n):void 0;return g?(0,F.jsxs)("div",{style:p.container,children:[(0,F.jsx)("div",{style:p.bannerBodyContainer,children:(0,F.jsx)(U().A,{style:p.bannerLabel,isMultiline:!0,isSmall:m,children:(0,F.jsx)(y().sA,{...g})})}),(0,F.jsx)(pe().p,{colorPalette:"blue",style:p.accessRequestButton,onClick:u,disabled:"noRequest"!==c,children:(0,F.jsx)(U().A,{isSmall:m,style:"noRequest"===c?p.accessRequestLabel:p.pendingAccessRequestLabel,children:"requested"===c?(0,F.jsx)(y().sA,{defaultMessage:"Requested edit access",id:"permissionsLevelBanner.requestPermission.accessRequestedV2"}):"rateLimited"===c?(0,F.jsx)(y().sA,{defaultMessage:"Try again later",id:"permissionsLevelBanner.requestPermission.rateLimited"}):(0,F.jsx)(y().sA,{defaultMessage:"Request edit access",id:"permissionsLevelBanner.requestPermission.requestEdit"})})})]}):null}const As=20;function ws({dividerType:e,scrollerStore:i}){const s=(0,a().K8)((()=>(null==i?void 0:i.state.elementRef)??{current:null}),[i]),o=(0,M().CR)(s),n=(0,M().yE)(s),r=(0,M().o7)(s),c=(0,t.useMemo)((()=>{if("top"===e)return n>0;return Math.ceil(n+r+10)<Math.floor(o)}),[e,r,o,n]),d=(0,l().IS)((e=>({divider:{opacity:c?1:0,height:1,borderTop:`1px solid ${e.regularDividerColor}`,padding:"0px 16px",transition:"opacity 200ms",margin:"0px 16px"}})),[c]);return(0,F.jsx)("div",{style:d.divider})}function Ms({store:e,calculatedPermissions:i,permissionItemArgs:s}){const{showTeamPermission:t,mostPermissiveAncestorTeamGuestItem:o,mostPermissiveAncestorTeamMemberItem:n,mostPermissiveAncestorTeamOwnerItem:r,pagePermissionUIModel:a}=i;return(0,F.jsxs)(F.Fragment,{children:[t&&r&&n?(0,F.jsx)(fs,{store:e,blockTeamOwnerPermission:r,blockTeamMemberPermission:n,blockTeamGuestPermission:o,permissionItemArgs:s}):void 0,Ns({store:e,mostPermissiveTeamPermissions:a.mostPermissiveTeamPermissions,permissionItemArgs:s})]})}function ks(e){const{store:i,permissionItemArgs:s,inheritedPagePermissions:o,hasInaccessiblePermissions:n}=e,a=(0,r().v3)(),[c,d]=t.useState(!1),{mostPermissiveGroupPermissions:p,mostPermissiveUserPermissions:u}=o,g=function(e){var i,s;const{mostPermissiveGroupPermissions:t,mostPermissiveUserPermissions:o}=e;let n="access";const r=(null===(i=o[0])||void 0===i?void 0:i.permissionItem.role)||(null===(s=t[0])||void 0===s?void 0:s.permissionItem.role)||"access",a=!(o.length>0)||o.every((e=>e.permissionItem.role===r)),l=!(t.length>0)||t.every((e=>e.permissionItem.role===r));a&&l&&(n=r);return n}(o),[{value:h}]=(0,m().Yb)((async()=>{const e=C().default.state.sidebarSpaceStore;return e?await async function({environment:e,mostPermissiveUserPermissions:i,mostPermissiveGroupPermissions:s,spaceStore:t}){const o=new Set;for(const{permissionItem:r}of i)o.add(r.user_id);const n=new Set;for(const{permissionItem:r}of s)n.add(r.group_id);if(n.size>0){const i=await P().callApi({eventName:"getSpacePermissionGroupMembers",environment:e,data:{groupIds:Array.from(n),spaceId:t.id}});if("success"===i.type)for(const[,{userIds:e}]of Object.entries(i.data.groupUsersMap)){const i=e.filter((e=>{var i;return null===(i=(0,k().sE)(t,e))||void 0===i?void 0:i.isMember()}));for(const e of i)o.add(e)}}return o.size}({environment:a,mostPermissiveUserPermissions:u,mostPermissiveGroupPermissions:p,spaceStore:e}):0}),[a,p,u]),b=Bs(o),v=(0,l().IS)((()=>({inheritedPagePermissionsContainer:b?{paddingInlineStart:D().zr}:{}})),[b]);return(0,F.jsxs)(F.Fragment,{children:[b?(0,F.jsx)(Ss,{store:i,isExpanded:c,onToggle:()=>{d((e=>!e)),S().lD(a,{share_menu_session_id:L().Ay.state.sessionId,type:"inherited_page"})},numberOfPeopleInvited:h??0,inheritedPermissionRole:g,permissionItemArgs:s,style:e.style}):void 0,c?(0,F.jsx)("div",{style:v.inheritedPagePermissionsContainer,children:(0,F.jsx)(Ts,{store:i,pagePermissions:o,numberPermissionsAlreadyRendered:0,permissionItemArgs:s,forceExpanded:!0,hasInaccessiblePermissions:n,isInherited:!0})}):void 0]})}function Cs({store:e,calculatedPermissions:i,permissionItemArgs:s}){const{showSpaceOwnerPermission:t,mostPermissiveSpaceOwnerItem:o,showSpacePermission:n,mostPermissiveTrustedDomainItem:r,mostPermissiveSpaceItem:a,mostPermissivePublicItem:l,showPublicShareLinkPermission:c,showRestrictedPermissionBanner:d}=i;return(0,F.jsxs)(_().A,{disableMobilePadding:!0,disableMobileBorders:!0,style:{paddingTop:12,paddingInlineStart:8,paddingInlineEnd:8,paddingBottom:8},children:[(0,F.jsx)(ci().nc,{}),(0,F.jsx)(oi,{store:e,spaceOwnerPermission:o,showSpaceOwnerPermission:t,spacePermission:a,showSpacePermission:n,publicPermission:l,showPublicShareLinkPermission:c,trustedDomainPermission:r,permissionItemArgs:s,fromPermissionWrapper:"permission_list",isRestricted:d})]})}function Ts(e){const i=(0,y().tz)(),s=(0,a().K8)((()=>{const e=C().default.state.sidebarSpaceStore;return null!=e&&e.isDefined()?e.id:""}),[]),t=(0,r().v3)(),n=t.currentUser.id,{store:l,pagePermissions:c,numberPermissionsAlreadyRendered:d,permissionItemArgs:u,forceExpanded:g,isInherited:S,hasInaccessiblePermissions:x}=e,{showUserPermissions:_,showAgentPermissions:M,mostPermissiveGroupPermissions:k,mostPermissiveAgentPermissions:O,mostPermissiveUserPermissions:D}=c,[{value:L}]=(0,m().Yb)((async()=>{const e=await P().callApi({eventName:"getSpacePermissionGroupIdsContainingMembers",environment:t,data:{spaceId:s,userIds:D.map((e=>e.permissionItem.user_id))},headers:(0,p().WS)({cellId:void 0,spaceId:s})});return"success"===e.type?e.data.userToGroupMap:{}}),[t,s,D],{debugName:"userToPermissionGroupIds",debounce:300,throttle:1e3}),E=(0,a().K8)((()=>{const e=_?function(e){const{mostPermissiveUserPermissions:i,userToPermissionGroupIds:s,hasInaccessiblePermissions:t,currentUserId:o}=e,n={};return i.forEach((i=>{if(e.store.table===v().C0&&"none"===i.permissionItem.role)return;const r=(0,A().ex)({userId:i.permissionItem.user_id,store:e.store,userPermissionGroupIds:new Set((null==s?void 0:s[i.permissionItem.user_id])??[])}),a=B().L.createChildStore(e.store,{table:b().oo,id:i.permissionItem.user_id}),l=a.getModel();let c;a.isReady()&&l&&(c=(0,f().c6)(e.intl,l));const d=o&&i.permissionItem.user_id===o;n[i.permissionItem.user_id]=(0,F.jsx)(Q().A,{store:e.store,userPermission:i,selectFooter:(0,F.jsx)(Ps().n,{targetName:c,targetType:"user",mostPermissivePermissions:r,hasInaccessiblePermissions:t,isCurrentUser:Boolean(d)}),tooltip:t&&"editor"!==i.permissionItem.role?(0,F.jsx)(y().sA,{defaultMessage:"This user may have higher permission access through a parent page or teamspace that you donâ€™t have access to",id:"blockPermissionsSettings.maybeHigherUserPermission.tooltip"}):void 0,showInherited:!1,permissionItemArgs:e.permissionItemArgs,fromPermissionWrapper:"permission_list"},i.permissionItem.user_id)})),n}({store:l,mostPermissiveUserPermissions:D,permissionItemArgs:u,userToPermissionGroupIds:L??{},intl:i,hasInaccessiblePermissions:x,currentUserId:n}):{};return I().oE(Object.keys(e).map((s=>{const t=B().L.createChildStore(l,{table:b().oo,id:s}),o=t.getModel();if(t.isReady()&&o)return{title:(0,f().c6)(i,o),isSelfPermission:Boolean(n)&&t.id===n,permissionItem:e[s]}})))}),[_,l,D,u,i,n,L,x]),W=(0,a().K8)((()=>{const e=s?function(e){const{spaceId:i,mostPermissiveGroupPermissions:s,isInherited:t}=e,o={},n=new Set(T().A.state.permissionGroupsAndMemberCounts.map((e=>e.group.group_id)));return s.forEach((s=>{if(e.store.table===v().C0&&"none"===s.permissionItem.role)return;const r=s.permissionItem.group_id;n.has(r)&&(o[r]=(0,F.jsx)(J().A,{store:e.store,groupPermission:s,spaceId:i,showInherited:!1,permissionItemArgs:e.permissionItemArgs,fromPermissionWrapper:"permission_list",disableExpansion:t,tooltip:e.hasInaccessiblePermissions&&"editor"!==s.permissionItem.role?(0,F.jsx)(y().sA,{defaultMessage:"Some users in this group may have higher permission access through a parent page or teamspace that you donâ€™t have access to",id:"blockPermissionsSettings.maybeHigherGroupPermission.tooltip"}):void 0}))})),o}({store:l,spaceId:s,mostPermissiveGroupPermissions:k,permissionItemArgs:u,hasInaccessiblePermissions:x,isInherited:S}):{};return Object.keys(e).map((s=>{const t=T().A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===s));return{title:t?(0,w().Pf)({intl:i,groupName:t.group.name}):"",isSelfPermission:!1,permissionItem:e[s]}}))}),[x,i,S,k,u,s,l]);E.sort(((e,i)=>e.isSelfPermission?-1:i.isSelfPermission?1:e.title.localeCompare(i.title)));const K=(0,o().X)("agents_in_block_share_menu"),U=(0,j().ke)(),G=(0,a().K8)((()=>{const e=M&&U&&K?function(e){const{store:i,mostPermissiveAgentPermissions:s,permissionItemArgs:t,spaceId:o}=e,n={};return s.forEach((e=>{if(i.table===v().C0)return;const s=e.permissionItem.bot_id,r=N().v.createChildStore(i,{table:h().GP,id:s,spaceId:o});if(!r.isReady()||!r.isWorkflowBot())return;const a=r.getWorkflowId();if(!a)return;const l=R().N.createChildStore(i,{table:v().C0,id:a,spaceId:o});if(null==l||!l.getAlive())return!1;n[s]=(0,F.jsx)(H,{store:i,workflowStore:l,spaceId:o,agentPermission:e,showInherited:!1,permissionItemArgs:t,fromPermissionWrapper:"permission_list"})})),n}({store:l,permissionItemArgs:u,hasInaccessiblePermissions:x,spaceId:s,mostPermissiveAgentPermissions:O}):{};return I().oE(Object.keys(e).map((t=>{const o=N().v.createChildStore(l,{table:h().GP,id:t,spaceId:s}).getWorkflowId();if(!o)return;const n=R().N.createChildStore(l,{table:v().C0,id:o,spaceId:s}),r=n.getModel();return n.isReady()&&r?{title:n.getNameWithDefault(i),isSelfPermission:!1,permissionItem:e[t]}:void 0})))}),[M,l,K,U,u,O,i,x,s]);G.sort(((e,i)=>e.title.localeCompare(i.title))),W.sort(((e,i)=>e.title.localeCompare(i.title)));const V=[...E,...W,...G].map((({permissionItem:e})=>e)),z=V.length;if(0===z)return null;const Y=Math.max(4,7-d);return!g&&z>Y?(0,F.jsxs)(F.Fragment,{children:[V.slice(0,2),(0,F.jsx)(ie,{permissions:V.slice(2)})]}):(0,F.jsx)(F.Fragment,{children:V})}function Ns(e){const{store:i,mostPermissiveTeamPermissions:s,permissionItemArgs:t}=e;return s.map((e=>u().nl(e.permissionItem)?(0,F.jsx)(ps,{store:i,blockTeamOwnerPermission:e,isExternalTeam:!0,permissionItemArgs:t,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.owner`):u().un(e.permissionItem)?(0,F.jsx)(os,{store:i,blockTeamGuestPermission:e,isExternalTeam:!0,permissionItemArgs:t,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.teamGuest`):(0,F.jsx)(ls,{store:i,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:t,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.member`)))}function Bs(e){return e.mostPermissiveUserPermissions.length>0||e.mostPermissiveGroupPermissions.length>0}const Rs=function(e){const i=(0,r().v3)(),{device:o}=i,m=o.isMobile,{store:p,permissionItemArgs:u,calculatedPermissions:h,showPermissionInheritanceBanner:b}=e,{sudoModeStore:v}=u,f=(0,a().uB)(void 0,d().A),y=(0,a().uB)(void 0,d().A),I=(0,ys().O)(p),{pagePermissionUIModel:P,showRestrictedPermissionBanner:j,showSpacePermission:A,showTeamPermission:w}=h,{inheritedPermissions:M,pagePermissions:k}=(0,O().kT)({store:p,pagePermissionUIModel:P,currentUserId:i.currentUser.id}),C=Bs(k),T=Bs(M),N=(0,a().K8)((()=>!(0,O().Aj)({store:p})),[p]),B=o.isMobile?c().A.None:c().A.Y,R=(0,l().IS)((()=>({scroller:{paddingInlineStart:m?As:0,paddingInlineEnd:m?As:0}})),[m]);(0,t.useEffect)((()=>{S().Fn({environment:i,calculatedPermissions:h})}),[]);const D=Number(A),L=(0,a().K8)((()=>(0,s(311337).y)(i)),[i]),E=D+Number(w)+Number(T),W=(0,a().K8)((()=>e.showFooter??!n().A.isMobile),[e.showFooter]),K=(0,a().K8)((()=>p.getSpaceId()),[p]),U=(0,s(329304).P9)({name:"block_read_and_write_role",spaceId:K,userId:i.currentUser.id}),G=(0,a().K8)((()=>p.table===g().ev&&(U&&void 0!==p.getRole()&&p.canRead()&&!p.canEdit()&&(0,s(90023).jH)(p.getSystemBlockTypeStore().getValue()))),[U,p]);return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(ws,{dividerType:"top",scrollerStore:f}),(0,F.jsxs)(x().H,{type:B,style:R.scroller,store:f,children:[G&&p.table===g().ev?(0,F.jsx)(js,{store:p}):(0,F.jsx)(Ji,{store:p,showRestrictedPermissionBanner:j,showPermissionInheritanceBanner:b,sudoModeStore:v}),L?void 0:(0,F.jsxs)(_().A,{disableMobilePadding:!0,disableMobileBorders:!0,style:{padding:"0px 8px"},children:[C?(0,F.jsx)(Ts,{store:p,pagePermissions:k,numberPermissionsAlreadyRendered:E,permissionItemArgs:u,forceExpanded:!(T||h.showTeamPermission),hasInaccessiblePermissions:N}):void 0,T?(0,F.jsx)(ks,{store:p,inheritedPagePermissions:M,permissionItemArgs:u,hasInaccessiblePermissions:N}):void 0,p.table===g().ev?(0,F.jsx)(Ms,{store:p,calculatedPermissions:h,permissionItemArgs:u}):void 0,N?(0,F.jsx)(li,{store:p}):void 0]})]}),(0,F.jsx)(ws,{dividerType:"bottom",scrollerStore:f}),D>0&&!n().A.isMobile?(0,F.jsx)(Cs,{store:p,calculatedPermissions:h,permissionItemArgs:u}):void 0,p.table===g().ev&&I.shouldRender?(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(ws,{dividerType:"top",scrollerStore:y}),(0,F.jsx)(x().H,{type:B,style:R.scroller,store:y,children:(0,F.jsx)(ys().v,{blockStore:p,renderInfo:I.renderInfo,onCollectionChange:I.onCollectionChange})})]}):void 0,W?(0,F.jsx)(s(117183).A,{store:p,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:h,permissionItemArgs:u,hasCollectionPropertyPermissionsSection:I.shouldRender}):void 0]})}},418739:(e,i,s)=>{s.d(i,{j:()=>l});var t=()=>s(68263),o=()=>s(601866),n=()=>s(329443),r=()=>s(148832),a=()=>s(620173);function l(e){const{environment:i,store:s,newPermissionItem:l}=e,c=s.getSpaceStore(),d=c?o().iY(c):void 0;if(!d)return;if("block"!==s.table||s.id!==d){const e=new(r().B)(i,{table:"block",id:d});return(0,a().n)(e)}const m=(0,n().Jh)(s),p=(0,n().K1)(s);if(m&&p)return!0;const u="space_permission"===l.type&&"none"===l.role,g="public_permission"===l.type&&!(0,t().Tt)(l.role),h="public_permission"===l.type&&(0,t().W8)(l)&&!1===l.allow_duplicate;return!u&&!(g||h)}},453597:(e,i,s)=>{s.d(i,{E3:()=>m,nc:()=>d});s(296540);var t=()=>s(484714),o=()=>s(56366),n=()=>s(401497),r=()=>s(69708),a=()=>s(284371),l=()=>s(125565),c=s(474848);function d(){return(0,c.jsx)(p,{children:(0,c.jsx)(r().sA,{id:"blockPermissionsSettings.permissionsList.generalAccessAttribution",defaultMessage:"General access"})})}function m({collectionPickerPopupMenu:e}){const i=e?(0,c.jsx)(r().sA,{id:"blockPermissionsSettings.permissionsList.collectionPropertyPermissionsAttribution.pageLevelAccessFor",defaultMessage:"Page-level access for {popupMenu}",values:{popupMenu:e}}):(0,c.jsx)(r().sA,{id:"blockPermissionsSettings.permissionsList.collectionPropertyPermissionsAttribution.pageLevelAccess",defaultMessage:"Page-level access"});return(0,c.jsx)(p,{children:(0,c.jsx)("span",{style:{display:"flex",alignItems:"center"},children:i})})}function p(e){const{children:i}=e,{WindowSizeStore:s}=(0,t().v3)(),{isMobile:r}=(0,t().Y0)(),{paddingLeft:d,paddingRight:m}=(0,o().K8)((()=>{const e=r?0:8;return{paddingLeft:s.getSafePaddingLeftCSS(e),paddingRight:s.getSafePaddingRightCSS(e)}}),[s,r]),p=(0,n().IS)((e=>({label:{color:e.text.secondary,fontWeight:a().Wy.medium,paddingInlineStart:d,paddingInlineEnd:m,paddingTop:0,paddingBottom:4,overflow:"visible",textWrap:"wrap",...r?{fontSize:15,paddingTop:2,color:e.text.secondary}:{}}})),[r,d,m]);return(0,c.jsx)(l().A,{isSmall:!0,style:p.label,children:i})}},545340:(e,i,s)=>{s.d(i,{A:()=>o});class t extends(()=>s(757695))().Store{getInitialState(){return{trustedDomainPointers:[],enabledTrustedEmailDomains:[],trustedDomains:[],lastEmitData:{value:-1,spaceId:void 0}}}getForSpace(e){if(!e)return;const{enabledTrustedEmailDomains:i,trustedDomainPointers:s,trustedDomains:t,lastEmitData:o}=this.state;return o.spaceId===e.id?{enabledTrustedEmailDomains:i,trustedDomainPointers:s,trustedDomains:t}:void 0}shouldRefetchTrustedDomains({currentSpaceId:e,emitValue:i}){const{spaceId:s,value:t}=this.state.lastEmitData;return e!==s||i!==t}}const o=t},629027:(e,i,s)=>{s.d(i,{P:()=>n});var t=()=>s(56366),o=()=>s(928153);function n({store:e}){return(0,t().K8)((()=>(0,o().C)({store:e})),[e])}},653953:(e,i,s)=>{s.d(i,{X:()=>l});var t=()=>s(484714),o=()=>s(56366),n=()=>s(69708),r=()=>s(665381),a=()=>s(765957);function l(){const e=(0,t().v3)(),i=(0,n().tz)();return(0,o().K8)((()=>{const{sidebarSpaceStore:s}=a().default.state;return s?(0,r().G)(e,s):i.formatMessage({defaultMessage:"Untitled workspace",id:"spaceHelpers.getSpaceName.untitledWorkspace.name"})}),[e,i])}},678634:(e,i,s)=>{s.d(i,{_:()=>h});s(898992),s(672577);var t=s(296540),o=()=>s(484714),n=()=>s(56366),r=()=>s(519831),a=()=>s(854150),l=()=>s(69708),c=()=>s(511303),d=()=>s(765957),m=()=>s(605402),p=()=>s(543665),u=()=>s(95758),g=s(474848);function h({permissionItem:e,from:i}){const s=(0,o().v3)(),{organizationOwnerRecordCache:h}=(0,t.useContext)(c().N),b=(0,n().O$)(d().AppStoreSidebarSpaceStore),v=(0,n().K8)((()=>null==b?void 0:b.getName()),[b]),f=(0,n().K8)((()=>{var i;if("group_permission"!==e.type)return;const s=e.group_id;return null===(i=m().A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===s)))||void 0===i?void 0:i.group.name}),[e]),y=(0,n().K8)((()=>{if("explicit_team_permission"!==e.type&&"explicit_team_owner_permission"!==e.type)return;const i=e.team_id;return new(u().h)(s,{id:i,table:a().yK},{inMemoryRecordCache:h}).getName()}),[e,s,h]),I=(0,n().K8)((()=>{if("collection_property_permission"!==e.type||(null==i?void 0:i.table)!==r().Vl)return;const t=i.collectionId;return new(p().m)(s,{id:t,table:r().Vl}).getName()}),[s,i,e.type]);switch(e.type){case"space_permission":return b?(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.spacePermission",defaultMessage:"{name} workspace",values:{name:v}}):null;case"space_owner_permission":case"user_permission":case"bot_permission":case"exclusive_user_permission":case"public_permission":case"deleted_permission":case"restricted_permission":case"trusted_domain_permission":default:return null;case"explicit_team_permission":case"team_permission":return(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.teamPermission",defaultMessage:"{name} teamspace",values:{name:y}});case"team_owner_permission":case"explicit_team_owner_permission":return(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.teamOwnersPermission",defaultMessage:"{name} teamspace",values:{name:y}});case"explicit_team_guest_permission":return(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.teamGuestsPermission",defaultMessage:"Team guests"});case"group_permission":return f?(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.groupPermission",defaultMessage:"{groupName} group",values:{groupName:f}}):(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.groupPermissionWithoutName",defaultMessage:"Group"});case"collection_property_permission":return I?(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.collectionPropertyPermission",defaultMessage:"permission rule on the {collectionName} database",values:{collectionName:I}}):(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.collectionPropertyPermissionWithoutName",defaultMessage:"permission rule on a database"})}}},726360:(e,i,s)=>{s.d(i,{H:()=>n,U:()=>o});var t=s(296540);const o=(0,t.createContext)(new(s(545340).A));function n(){return(0,t.useContext)(o)}o.displayName="TrustedDomainsContext"},801191:(e,i,s)=>{s.d(i,{n:()=>u});s(898992),s(354520),s(296540);var t=()=>s(401497),o=()=>s(433847),n=()=>s(68263),r=()=>s(69708),a=()=>s(802790),l=()=>s(125565),c=()=>s(972435),d=()=>s(678634),m=s(474848);const p={none:c().A.formatMessage(o().Sf.noAccessDescription),reader:c().A.formatMessage(o().Sf.canReadDescription),comment_only:c().A.formatMessage(o().Sf.canCommentDescription),content_only_editor:c().A.formatMessage(o().Sf.canEditContentDescription),read_and_write:c().A.formatMessage(o().Sf.canEditDescription),membership_admin:c().A.formatMessage(o().Sf.membershipAdminDescription),editor:c().A.formatMessage(o().Sf.fullAccessDescription)};function u({targetType:e,targetName:i,mostPermissivePermissions:s,hasInaccessiblePermissions:u,isCurrentUser:g}){const h=(0,t().IS)((e=>({label:{marginInlineStart:12,marginInlineEnd:12,paddingTop:8,paddingBottom:8}})),[]);let b=function({targetType:e,targetName:i,mostPermissivePermissions:s}){var t;const a=null==s||null===(t=s.filter((i=>"user"===e?(0,o().bn)(i)||(0,n().tb)(i.permissionItem):(0,o().bn)(i))))||void 0===t?void 0:t[0];if(!a)return null;const l=(0,n().PW)(a.permissionItem.role)?a.permissionItem:void 0,u=(0,n().PW)(a.permissionItem.role)?a.from:void 0;if(!l||!l.role||"string"!=typeof l.role||"none"===l.role)return null;const g=p[l.role]||c().A.formatMessage(o().Sf.defaultAccessLabel);return(0,m.jsx)(r().sA,{id:"permissionsItem.generalAccess",defaultMessage:"{userName} will still have {accessLevel} from the {permissionItemName}",values:{permissionItemName:(0,m.jsx)(d()._,{permissionItem:l,from:u}),userName:i,accessLevel:g}})}({targetType:e,targetName:i,mostPermissivePermissions:s});return b||!u||g||(b=(0,m.jsx)(r().sA,{id:"permissionsItem.unknownInheritedAccess",defaultMessage:"{userName} may have a different access level from a parent page, group, or teamspace",values:{userName:i}})),b?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(a().A,{size:1,colorVariant:"secondary"}),(0,m.jsx)(l().A,{style:h.label,isSmall:!0,isMultiline:!0,children:b})]}):null}},810727:(e,i,s)=>{s.d(i,{z:()=>h});s(898992),s(672577),s(296540);var t=()=>s(56366),o=()=>s(401497),n=()=>s(854150),r=()=>s(69708),a=()=>s(284371),l=()=>s(16006),c=()=>s(422366),d=()=>s(605402),m=()=>s(95758),p=()=>s(898808),u=()=>s(678634),g=s(474848);function h({permissionItem:e,targetType:i,targetName:s,store:h}){const b=(0,o().IS)((()=>({groupOrTeamName:{fontWeight:a().Wy.bold}})),[]),v=(0,t().K8)((()=>{var i;if("group_permission"!==e.type)return;const s=null===(i=d().A.state.permissionGroupsAndMemberCounts.find((i=>i.group.group_id===e.group_id)))||void 0===i?void 0:i.group.name;return s?(0,g.jsx)("span",{style:b.groupOrTeamName,children:s}):void 0}),[e,b.groupOrTeamName]),f=(0,t().K8)((()=>{var i;if("team_permission"!==e.type&&"explicit_team_permission"!==e.type&&"team_owner_permission"!==e.type&&"explicit_team_owner_permission"!==e.type&&"explicit_team_guest_permission"!==e.type)return;const s="team_permission"===e.type||"team_owner_permission"===e.type?null===(i=(0,c().U)(h))||void 0===i?void 0:i.id:e.team_id;if(!s)return;const t=m().h.createChildStore(h,{table:n().yK,id:s,spaceId:h.getSpaceId()});return(0,g.jsxs)("span",{style:{...b.groupOrTeamName,display:"inline-flex",gap:4},children:[(0,g.jsx)(p().x,{store:t,size:14,style:{margin:1}}),(0,g.jsx)(l().A,{store:t,shouldWrap:!0})]})}),[e,h,b.groupOrTeamName]);if("none"===e.role)return;const y=(0,g.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.withoutUserName",defaultMessage:"Access is from the â€œ{permissionItemName}â€",values:{permissionItemName:(0,g.jsx)(u()._,{permissionItem:e})}});if("group"===i&&"group_permission"===e.type)return s?(0,g.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.groupWithGroupName",defaultMessage:"The {targetGroupName} group has access to this page",values:{targetGroupName:s}}):(0,g.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.groupWithoutGroupName",defaultMessage:"This group has access to this page"});if("user"===i&&("user_permission"===e.type||"exclusive_user_permission"===e.type))return s?(0,g.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.userWithUserName",defaultMessage:"{targetUserName} has access to this page",values:{targetUserName:s}}):void 0;switch(e.type){case"space_permission":return s&&"user"===i?(0,g.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.spaceWithUserName",defaultMessage:"{targetUserName} has access from the â€œ{permissionItemName}â€ setting on this page",values:{targetUserName:s,permissionItemName:(0,g.jsx)(u()._,{permissionItem:e})}}):s&&"group"===i?(0,g.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.spaceWithGroupName",defaultMessage:"The {targetGroupName} group has access from the â€œ{permissionItemName}â€ setting on this page",values:{targetGroupName:s,permissionItemName:(0,g.jsx)(u()._,{permissionItem:e})}}):y;case"space_owner_permission":return y;case"team_permission":case"explicit_team_permission":return"user"===i&&s&&f?(0,g.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.member.teamWithUserName",defaultMessage:"{targetUserName} has access as a member of the {teamspaceName} teamspace",values:{targetUserName:s,teamspaceName:f}}):"group"===i&&s&&f?(0,g.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.group.teamWithUserName",defaultMessage:"The {targetGroupName} group has access from the {teamspaceName} teamspace",values:{targetGroupName:s,teamspaceName:f}}):y;case"team_owner_permission":case"explicit_team_owner_permission":return"user"===i&&s&&f?(0,g.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.owner.teamWithUserName",defaultMessage:"{targetUserName} has access as an owner of the {teamspaceName} teamspace",values:{targetUserName:s,teamspaceName:f}}):"group"===i&&s&&f?(0,g.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.group.teamWithUserName",defaultMessage:"The {targetGroupName} group has access from the {teamspaceName} teamspace",values:{targetGroupName:s,teamspaceName:f}}):y;case"explicit_team_guest_permission":return s&&f?(0,g.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.guest.teamWithUserName",defaultMessage:"{targetUserName} has access as a guest of the {teamspaceName} teamspace",values:{targetUserName:s,teamspaceName:f}}):y;case"group_permission":return s&&v?(0,g.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.groupWithUserName",defaultMessage:"{targetUserName} has access as a member of the {groupName} group",values:{targetUserName:s,groupName:v}}):y;case"user_permission":case"exclusive_user_permission":return s?(0,g.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.userWithUserName",defaultMessage:"{targetUserName} has access to this page",values:{targetUserName:s}}):void 0;default:return}}},913348:(e,i,s)=>{s.d(i,{A:()=>y});s(898992),s(672577),s(581454);var t=s(296540),o=()=>s(484714),n=()=>s(56366),r=()=>s(401497),a=()=>s(187174),l=()=>s(69708),c=()=>s(559506),d=()=>s(453697),m=()=>s(698449),p=()=>s(765957),u=()=>s(87043),g=()=>s(946928),h=s(474848);function b(e){const{group:i,store:s,groupPermission:t}=e,l=(0,o().v3)(),d=(0,n().O$)(p().AppStoreSidebarSpaceStore),[{value:u}]=(0,a().Yb)((async()=>{const e=await c().callApi({eventName:"getSpacePermissionGroupMembers",environment:l,data:{groupIds:[i.group_id],spaceId:i.space_id}});if("success"===e.type){var s;const t=null===(s=e.data.groupUsersMap[i.group_id])||void 0===s?void 0:s.userIds,{limitedUserStores:o}=(0,m().gA)({userIds:t,limit:void 0,spaceStore:d});return o}}),[d,l,i.group_id,i.space_id]),g=(0,r().IS)((e=>({container:{paddingInlineStart:16}})),[]);return(0,h.jsx)("div",{style:g.container,children:null==u?void 0:u.map((e=>(0,h.jsx)("div",{children:(0,h.jsx)(v,{userStore:e,store:s,groupPermission:t})},e.id)))})}function v(e){const{userStore:i,store:s,groupPermission:t}=e,r=(0,o().v3)(),{isMobile:a}=r.device,c=(0,l().tz)(),m=(0,n().K8)((()=>i.getDisplayName(c)),[c,i]),p=(0,n().K8)((()=>i.getEmail()),[i]);return(0,h.jsx)(u().Ay,{store:s,permissionItem:{type:"display_only_group_member_permission"},from:t.from,icon:(0,h.jsx)(d().A,{userStore:i,avatarShouldShowShadow:!1,size:a?u().Bj:u().Ev,hasTooltip:!1}),title:m||p,subtitle:p,upgradeButtonName:"permission_groups"})}function f(e){const{group:i}=e,s=(0,l().tz)(),t=(0,m().Pf)({intl:s,groupName:i.name});return(0,h.jsx)(l().sA,{defaultMessage:"People in {groupName} have access to the page",values:{groupName:t},id:"blockPermissionsSettings.groupPermission.tooltipV2"})}const y=function(e){const{store:i,groupPermission:a,spaceId:c,fromPermissionWrapper:d,disableExpansion:v}=e,{isMobile:y}=(0,o().Y0)(),I=(0,l().tz)(),[S,P]=(0,t.useState)(!1),[x,_]=(0,t.useState)(!1),{group:j,memberCount:A}=(0,n().K8)((()=>{const{sidebarSpaceStore:e}=p().default.state;if(!e)return{};return{...s(605402).A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===a.permissionItem.group_id))}}),[a.permissionItem.group_id]),w=!v&&!(!j||!A||0===A),M=(0,t.useCallback)((()=>P(!0)),[]),k=(0,t.useCallback)((()=>P(!1)),[]),C=(0,t.useCallback)((()=>{w&&_(!x)}),[x,w]),T=(0,r().IS)((e=>({mobileChevronIcon:{marginInlineStart:4,fill:e.icon.secondary,transform:`rotate(${x?90:0}deg)`,transition:"transform 150ms ease"},mobileTitleContainer:{display:"flex",alignItems:"center"}})),[x]);if(!j)return null;const N=(0,m().Pf)({intl:I,groupName:j.name}),B=w?(0,h.jsx)(s(180925).A,{expanded:x,hovered:S,onClick:C,children:(0,h.jsx)(g().A,{groupIcon:j.icon,spaceId:c})}):(0,h.jsx)(g().A,{groupIcon:j.icon,spaceId:c});return(0,h.jsxs)("div",{style:{fontWeight:400},className:s(38337).HlM,children:[(0,h.jsx)(u().Ay,{onMouseEnter:M,onMouseLeave:k,onClick:w?C:void 0,isCollapsible:w,store:i,permissionItem:a.permissionItem,from:a.from,icon:B,title:(0,h.jsxs)("div",{style:T.mobileTitleContainer,children:[N,w&&y?(0,h.jsx)("div",{style:T.mobileChevronIcon,children:(0,h.jsx)(s(252291).I,{icon:s(158115).arrowChevronSingleRightFillSmallIcon,size:"xs"})}):void 0]}),ignoreLocalHoverState:e.ignoreLocalHoverState,showInherited:e.showInherited,nonInheritedTooltip:e.tooltip?e.tooltip:(0,h.jsx)(f,{group:j}),subtitle:y?(0,h.jsxs)("div",{children:[(0,h.jsx)(l().sA,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:A}})," Â· ",(0,h.jsx)(l().sA,{...(0,s(268153).R)({type:"group_permission",role:a.permissionItem.role,table:"block",isRemovable:!1}).label})]}):(0,h.jsxs)("div",{children:[(0,h.jsx)(l().sA,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," Â· ",(0,h.jsx)(l().sA,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:A}})]}),upgradeButtonName:"group_permission_item",isRemovableOverride:e.isRemovableOverride,fromPermissionWrapper:d,roleItemOverrides:e.roleItemOverrides,menuListItemProps:e.menuListItemProps,style:e.style,...e.permissionItemArgs}),x?(0,h.jsx)(b,{group:j,store:i,groupPermission:a}):void 0]},j.id)}},931938:(e,i,s)=>{s.d(i,{k:()=>r});var t=()=>s(601866),o=()=>s(148832),n=()=>s(620173);function r(e){const{environment:i,spaceStore:s}=e,r=s&&t().iY(s);if(!r)return;const a=new(o().B)(i,{table:"block",id:r});return(0,n().n)(a)}},946928:(e,i,s)=>{s.d(i,{A:()=>a});var t=s(296540),o=()=>s(99756),n=s(474848);function r({groupIcon:e,spaceId:i}){const{isMobile:t}=(0,s(484714).Y0)(),r=(0,s(401497).IS)((e=>({icon:{fill:e.icon.secondary}})),[]);return e&&i?(0,n.jsx)(o().A,{type:"circle",iconType:"recordIcon",icon:{icon:e,pointer:{table:s(96689).NX,id:i}},isMobile:t}):(0,n.jsx)(o().A,{type:"circle",iconType:"function",iconFn:s(658985).$,iconStyle:r.icon,isMobile:t})}const a=t.memo(r)}}]);