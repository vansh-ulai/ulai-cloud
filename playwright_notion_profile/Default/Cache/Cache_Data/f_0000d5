"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[9304],{299772:(e,t,o)=>{o.d(t,{AP:()=>Y,Ay:()=>ie,DX:()=>$,JK:()=>Z,NS:()=>pe,T1:()=>ee,Wj:()=>le,Y4:()=>J,dp:()=>oe,g1:()=>me,mv:()=>ae,nu:()=>Se,rK:()=>ve,uD:()=>ne,zs:()=>G});o(944114),o(898992),o(672577);var n=o(296540),r=()=>o(242422),i=()=>o(726637),a=()=>o(662303),l=()=>o(484714),s=()=>o(56366),d=()=>o(721908),c=()=>o(757695),u=()=>o(519831),g=()=>o(69708),p=()=>o(496603),S=()=>o(534177),m=()=>o(284371),v=()=>o(934839),b=()=>o(473227),f=()=>o(915086),y=()=>o(778417),k=()=>o(190033),h=()=>o(766081),P=()=>o(468882),C=()=>o(543886),_=()=>o(405170),A=()=>o(908201),B=()=>o(964345),K=()=>o(135552),M=()=>o(478726),x=()=>o(747100),w=()=>o(252833),I=()=>o(470928),T=()=>o(891078),R=()=>o(696746),E=()=>o(106628),D=()=>o(792415),z=()=>o(765957),V=()=>o(463830),F=()=>o(353643),j=()=>o(77246),H=()=>o(150193),L=()=>o(732770),O=()=>o(375447),N=()=>o(548821),U=()=>o(612587),q=()=>o(712505),Q=()=>o(93658),W=()=>o(502438),X=o(474848);const G=m().vc(a().locale).sans,Y={serif:m().vc(a().locale).serif,mono:m().vc(a().locale).mono,comic:m().vc(a().locale).comic},Z={serif:1.6,mono:1.6},$={serif:0,mono:.055},J={serif:15,mono:14},ee={serif:17,mono:15},te={width:"100%",display:"flex",flexDirection:"column",position:"relative",alignItems:"center",flexGrow:1},oe=14,ne=16;function re(e,t){var a,m;const C=(0,n.useRef)();C.current=performance.now();const{store:_,context:R,disabled:H,onTitleEsc:U,styleOverrides:W}=e,G=(0,s().K8)((()=>{var e;return null===(e=_.getSpaceStore())||void 0===e?void 0:e.getFreezeSettings()}),[_]),Y=(0,o(973454).p)(G),Z=H||"active"===Y,$=(0,l().v3)(),J=(0,l().Y0)(),ee=(0,o(792485).S)(),oe=(0,T().bx)(_,Z),ne=(0,T().HX)(_,Z),re=(0,s().K8)((()=>_.isReady()&&ne&&!_.isNonEditableState()&&!(0,M().sV)(_)&&!(0,M().fc)(_)),[ne,_]),ie=(0,s().O$)(o(929219).e),le=(0,s().K8)((()=>_.isCollectionView()),[_]),be=(0,s().K8)((()=>Boolean((0,o(851941).X2)(_.id))?"v8":"v4"),[_]),fe=(0,s().K8)((()=>_.isCollectionViewPageWithContent()),[_]),ye=(0,s().K8)((()=>"workflow"===_.getType()),[_]),ke=(0,s().K8)((()=>{const e=_.getAssociatedCollectionStore(),t=null==e?void 0:e.getLayoutStore();return Boolean(t)}),[_]),he=(0,s().K8)((()=>(0,o(742943).T0)($)),[$]),Pe=e.disableTopControls||he;(0,o(451035).z)(_,$);const Ce=(0,o(551619).no)(_),_e=(0,n.useMemo)((()=>({layout:{translateX:-Ce},layoutFull:{translateX:Ce}})),[Ce]),Ae=(0,s().K8)((()=>c().Store.createValue(!1,{name:"headerFocusStore"})),[]),Be=(0,s().O$)(Ae),{isInPeek:Ke,isInsideSidePeek:Me}=(0,s().K8)((()=>({isInPeek:(0,x().cq)(_),isInsideSidePeek:(0,M().mb)(_)})),[_]),xe=(0,n.useMemo)((()=>new(N().Ay)),[]),we=(0,n.useMemo)((()=>new(V().A)),[]),Ie=(0,n.useMemo)((()=>new(V().A)),[]),Te=(0,n.useMemo)((()=>new(o(970585).A)),[]),Re=(0,s().K8)((()=>c().Store.createValue(!1,{name:"forceControlHoverVisibleStore"})),[]),Ee=(0,s().O$)(Re),De=(0,n.useMemo)((()=>({headerFocusStore:Ae,pageViewBlockStore:xe,resolvedDiscussionButtonPopupStore:we,backlinksButtonPopupStore:Ie,templatePickerMenuListStore:Te,forceControlHoverVisibleStore:Re})),[Ae,xe,we,Ie,Te,Re]),[ze,Ve]=(0,n.useState)(!1),[Fe,je]=(0,n.useState)(!1),[He,Le]=(0,n.useState)(""),Oe=(0,n.useCallback)((()=>{we.setState({open:!0}),xe.setState({...xe.state,forceDiscussionOpen:!0})}),[xe,we]),Ne=(0,n.useCallback)((()=>{const e=qe.current;if(e){if(function(e){if(!e.isIOS)return!1;return!0}(J))return{paddingLeft:0,paddingRight:0};const t=getComputedStyle(e),o=parseFloat(t.getPropertyValue("padding-left")),n=parseFloat(t.getPropertyValue("padding-right"));return{paddingLeft:p().yr(o)?0:o,paddingRight:p().yr(n)?0:n}}}),[J]),Ue=(0,n.useCallback)((()=>{const e=qe.current;if(e){const t=e.getBoundingClientRect().width,o=Ne()??{paddingLeft:0,paddingRight:0};return t-o.paddingLeft-o.paddingRight}}),[Ne]),qe=(0,n.useRef)(null),Qe=(0,n.useRef)(null),We=(0,n.useRef)(null),Xe=(0,n.useCallback)((()=>qe.current),[]),Ge=(0,n.useCallback)((()=>Qe.current),[]),Ye=(0,n.useMemo)((()=>new(o(688742).B)($)),[]);(0,o(790748).b)(o(489348).A,(()=>({store:_,blockContext:R,openResolvedDiscussionPopup:Oe,getContentInnerWidth:Ue,getContentWrapEl:Xe,getLayoutEl:Ge,collectionContextStore:Ye,headerFocusStore:Ae,pageViewBlockStore:xe,resolvedDiscussionButtonPopupStore:we,backlinksButtonPopupStore:Ie,templatePickerMenuListStore:Te,forceControlHoverVisibleStore:Re,headerMouseStore:void 0,detailsFocusStore:void 0,detailsMouseStore:void 0,renderedType:"page",getBlockStore:()=>_,getNode:()=>We.current})),[_,R,Oe,Ue,Ne,Xe,Ge,Ye,De]);const Ze=(0,n.useRef)(!1),$e=(0,s().K8)((()=>_.getTitleStore()),[_]),Je=(0,s().K8)((()=>_.isInsideFactoryOrDuplicateBlocksAction()),[_]),et=(0,s().K8)((()=>{var e;const t=z().default.state.sidebarSpaceViewStore,o=null==t||null===(e=t.getSettings())||void 0===e?void 0:e.agent_personalization_settings;return(null==o?void 0:o.context_page_id)===_.id}),[_]),tt=(0,s().K8)((()=>{const e=D().A.state.publicPageData;return Boolean(null==e?void 0:e.isDLSViewer)}),[]),ot=(0,o(600871).D1)(J),nt=(0,n.useCallback)((()=>!!$e&&(!!e.forceSelectTitleOnMount||!le&&(!(i().A.isMobile&&J.isPhone&&o(960955).A.hasOpenMobileSlideUps())&&(!o(201980).q4_($e.getValue())||(0,M().In)(_)&&!i().A.isMobile)))),[J.isPhone,le,e.forceSelectTitleOnMount,_,$e]),rt=(0,s().K8)((()=>_.isFormBlock()),[_]),[it,at]=(0,s().K8)((()=>[Boolean(_.getIcon()),Boolean(_.getCover())]),[_]),lt=(0,s().K8)((()=>{const e=o(21735).A.state.shouldUseEdgeCache,t=r().default.checkGate({gateName:"edge_cache_mentions"});return e&&t}),[]);(0,o(67141).v)(),(0,n.useEffect)((()=>{if(async function(e){const{environment:t,shouldUseEdgeCache:o}=e;o||O().Ay.state.emptyQueryUserRequestStore.setState({...O().Ay.state.emptyQueryUserRequestStore.state,ready:!1,loading:!0});await z().default.waitUntil((()=>Boolean(z().default.state.sidebarSpaceStore&&z().default.state.mainEditorCurrentBlockStore)));const n=await E().T.searchActions.load(),r=await n.searchVisibleSpaceUsers({environment:t,query:"",membersOnly:!1,minFuzzyScore:25,placeSelfFirst:!1});o||O().Ay.state.emptyQueryUserRequestStore.setState({ready:!0,loading:!1,result:r})}({environment:$,shouldUseEdgeCache:lt}),(0,o(63467).y)(),J.isPhone&&!ot){const{PageScroller:e}=o(779315).A;if(e){const t=e.getNode();if(t&&oe&&!at){const e=Se(R,J);t.scrollTo({top:e})}}}var e;$e&&nt()&&(y().hc({environment:$,store:_}),(0,k().z)({store:$e}),J.isAndroid&&J.isMobileNative&&(null===(e=$.mobileNative)||void 0===e||e.forceKeyboardVisibility(!0)));if(f().updateMetricDataWithIsPushTag($),R!==N().Rr.Frame||le||rt||(C.current&&o(606932).A.markPageViewBlockRender(C.current),f().measurePageRenderMetrics({environment:$,isEditable:re,isHomePage:!1,isWikiHome:!1,isPageWithCustomLayout:ke,idSchema:be}),function(e,t,o){var n;ge(e,t,o)&&(null===(n=t.mobileNative)||void 0===n||n.markTransitionReady({environment:t,type:"new_page",id:e.id,sendImmediately:!0}))}(_,$,J)),Ye){const e=(0,o(476492).kz)(Ye);o(406792).default.DO_NOT_USE_measureLegacy("collections.open_item_page_lag",{environment:$,data:{...e,peek_mode:q().default.getPeekMode()}})}}),[]);const st=(0,s().K8)((()=>_.getFormat()),[_]),dt=(0,s().K8)((()=>{var e;return null===(e=j().Uv.getStateForBlock(_.id))||void 0===e?void 0:e.mode}),[_.id]),ct=(0,s().K8)((()=>{var e;const t=B().ei.state,n=(0,S().O9)(t)&&(null===(e=(0,o(254619).N)(t))||void 0===e?void 0:e.id)===_.id;return B().gZ.state&&n&&"disconnected"===o(165121).A.state}),[_.id]),ut=(0,s().K8)((()=>{var e;return(0,o(847585).z)(_)||Boolean(null===(e=D().A.state.publicPageData)||void 0===e?void 0:e.isDeleted)&&(0,M().jN)(R)}),[_,R]),gt=(0,s().K8)((()=>null==ee?void 0:ee.publicEditModeStore.state),[null==ee?void 0:ee.publicEditModeStore]),pt="on"===(0,o(477293).r)("better_template_indicators"),St=(0,s().K8)((()=>_.isTemplate()?_:pt?_.getNearestAncestorTemplateStore():void 0),[_,pt]),mt=Boolean(St),vt=(0,s().K8)((()=>_.isDraft()),[_]),bt=(0,o(59226).X)("feed_sidebar_item"),ft=(0,s().K8)((()=>{const e=ve($),t=q().default.state.mode===o(868840).O&&"posts"===$.RouterStore.state.route.name;return bt?t:e}),[$,bt]),yt=(0,o(596698).V)($,_),kt=(0,o(266597).Y)(_),ht=(0,s().K8)((()=>r().default.getConfigKey("collection_size_limits","block_properties_max_size")),[]);(0,n.useEffect)((()=>{if(R===N().Rr.Frame){const e=ue(R);null==gt||!gt.hasPublicPermission||"edit"!==gt.permission||mt||(0,o(326589).g)()?v().zA({bannerStore:e,id:"EditingPageBanner"}):v().HQ({bannerStore:e,id:"EditingPageBanner",contentKey:"editing_page",styleKey:K().q.White});o(864260).A.state.pageMap[_.id]?v().HQ({bannerStore:e,id:"ImportingEvernotePage",contentKey:"importing_evernote",styleKey:K().q.Blue,blockStore:_}):v().zA({bannerStore:e,id:"ImportingEvernotePage"})}if((0,M().Zz)(R)){const e=ue(R),t=(0,o(472316).G)(_),n=(0,o(699606).C)(_);if((0,o(322769).vW)(t))v().HQ({bannerStore:e,id:"SpaceContentDuplicationPage",contentKey:"space_content_duplication",styleKey:K().q.Red,blockStore:_});else if(!ut||rt||ge(_,$,J))if(n)v().HQ({bannerStore:e,id:"ArchivedTeamPage",contentKey:"page_in_archived_team",styleKey:K().q.Red});else for(const o of["SpaceContentDuplicationPage","DeletedPage","ArchivedTeamPage"])v().zA({bannerStore:e,id:o});else v().HQ({bannerStore:e,id:"DeletedPage",contentKey:"deleted_or_moved_page",blockStore:_,styleKey:K().q.Red});vt&&ft?v().HQ({bannerStore:e,id:"DraftPostInExpandedFeedComposerBanner",contentKey:"draft_post_in_expanded_feed_composer",styleKey:K().q.Blue,blockStore:_}):v().zA({bannerStore:e,id:"DraftPostInExpandedFeedComposerBanner"}),ct?v().HQ({bannerStore:e,id:"DictationConnectionBanner",styleKey:K().q.Yellow,contentKey:"dictation_connection",blockStore:_}):v().zA({bannerStore:e,id:"DictationConnectionBanner"}),dt&&(0,j().Or)(dt)?v().HQ({bannerStore:e,id:"TranslateBanner",styleKey:K().q.Blue,contentKey:"translate",blockStore:_}):v().zA({bannerStore:e,id:"TranslateBanner"}),tt&&!(0,x().cq)(_)?v().HQ({bannerStore:e,id:"TrustedDomainPageBanner",styleKey:K().q.LightGray,contentKey:"trusted_domain_page",blockStore:_}):v().zA({bannerStore:e,id:"TrustedDomainPageBanner"}),St?v().HQ({bannerStore:e,id:"CollectionTemplatePage",contentKey:"template_in_page",styleKey:K().q.Beige,blockStore:St,context:R,disabled:Z}):Je?v().HQ({bannerStore:e,id:"CollectionTemplatePage",contentKey:"template_in_button",styleKey:K().q.Beige,blockStore:_,context:R,disabled:Z}):v().zA({bannerStore:e,id:"CollectionTemplatePage"}),et?v().HQ({bannerStore:e,id:"AgentProfilePage",contentKey:"agent_profile_page",styleKey:K().q.Purple,blockStore:_,context:R,disabled:Z}):v().zA({bannerStore:e,id:"AgentProfilePage"}),(null!=st&&st.is_asana_imported_project||null!=st&&st.is_asana_imported_task)&&(null!=st&&st.dismissed_asana_import_banner?v().zA({bannerStore:e,id:"AsanaImporterBanner"}):v().HQ({bannerStore:e,id:"AsanaImporterBanner",contentKey:"asana_importer_banner",blockStore:_,styleKey:K().q.ImportNotification})),"sites"===(null==yt?void 0:yt.type)?v().HQ({id:"Site",bannerStore:e,styleKey:K().q.Blue,contentKey:"site",blockStore:_}):"marketplace_template"===(null==yt?void 0:yt.type)?v().HQ({id:"MarketplaceTemplateBanner",bannerStore:e,styleKey:K().q.Blue,contentKey:"marketplace_template",template:yt.template,blockStore:_}):(v().zA({bannerStore:e,id:"Site"}),v().zA({bannerStore:e,id:"MarketplaceTemplateBanner"})),"custom_page"===(null==kt?void 0:kt.type)?v().HQ({id:"CustomGettingStartedPageBanner",bannerStore:e,styleKey:K().q.LightGray,contentKey:"custom_getting_started_page_banner",blockStore:_}):"own_page"===(null==kt?void 0:kt.type)?v().HQ({id:"SetCustomGettingStartedPageBanner",bannerStore:e,styleKey:K().q.LightGray,contentKey:"set_custom_getting_started_page_banner",blockStore:_}):(v().zA({bannerStore:e,id:"CustomGettingStartedPageBanner"}),v().zA({bannerStore:e,id:"SetCustomGettingStartedPageBanner"}));if((0,M().Cg)(_)&&Ye){const t=Ye.collectionStore();if(!t)return;if((0,w().fo)({collectionStore:t})&&(0,w().z9)({collectionStore:t})){const n=(0,o(703596).j)({collectionFormat:t.getFormat()});n.shouldShowBanner&&v().HQ({bannerStore:e,id:n.bannerId,contentKey:n.contentKey,styleKey:n.styleKey,blockStore:_})}}o(478988).xZ(_,$,ht).then((t=>{var n;t&&(o(165358).log({level:"info",type:"collectionLimitsBannerDisplayed",from:"PageViewBlock",data:{miscDataToConvertToString:{blockId:_.id,spaceId:_.getSpaceId(),collectionId:null===(n=_.getCollectionPointerIfSingleSource())||void 0===n?void 0:n.id}}}),v().HQ({bannerStore:e,id:"PagePropertiesLimitExceededBanner",contentKey:"page_properties_limit_exceeded",styleKey:K().q.Yellow}))})).catch((()=>{}))}return()=>{(0,M().Zz)(R)&&(v().zA({bannerStore:ue(R),id:"DeletedPage"}),v().zA({bannerStore:ue(R),id:"CollectionTemplatePage"}),v().zA({bannerStore:ue(R),id:"AgentProfilePage"}),v().zA({bannerStore:ue(R),id:"Site"}),v().zA({bannerStore:ue(R),id:"MarketplaceTemplateBanner"}),v().zA({bannerStore:ue(R),id:"CustomGettingStartedPageBanner"}),v().zA({bannerStore:ue(R),id:"SetCustomGettingStartedPageBanner"}),v().zA({bannerStore:ue(R),id:"CrdtPage"}),v().zA({bannerStore:ue(R),id:"TrustedDomainPageBanner"}),v().zA({bannerStore:ue(R),id:"TranslateBanner"}),v().zA({bannerStore:ue(R),id:"AsanaImporterBanner"}),v().zA({bannerStore:ue(R),id:"DraftPostInExpandedFeedComposerBanner"}),v().zA({bannerStore:ue(R),id:"AuthMissingForJiraSyncedCollectionPageBanner"}),v().zA({bannerStore:ue(R),id:"JiraTwoWaySyncInfoBanner"}),v().zA({bannerStore:ue(R),id:"PagePropertiesLimitExceededBanner"}))}}),[$,gt,R,Z,ee,_,oe,ut,rt,Je,null==st?void 0:st.is_asana_imported_project,null==st?void 0:st.is_asana_imported_task,null==st?void 0:st.dismissed_asana_import_banner,dt,ct,tt,mt,vt,ft,J,yt,kt,Ye,ht,et,St]),(0,o(852507).l)((()=>{"suggest"===j().Uv.getMode(_,!0)?b().Nz({environment:$,location:"page_navigation",navigableBlockStore:_}):i().A.isMobile||_.canEdit()||!_.canComment()||_.isLocked()||le&&!fe||j().Uv.hasModeSet(_)||_.isFormBlock()||R===N().Rr.PostInFullPageOrPeek||(0,o(142748).ot)((0,o(569028).E)(_))||b().PD({environment:$,navigableBlockStore:_,mode:"suggest",location:"default_on_for_comment_only_user"})})),(0,o(589895).Bs)({pageId:_.id,isFrameContext:(0,M().jN)(R)}),(0,n.useEffect)((()=>()=>{"suggest"===j().Uv.getMode(_,!0)&&b().eB({environment:$,location:"page_navigation",navigableBlockStore:_})}),[$,_]);const Pt=(0,s().K8)((()=>de(_)),[_]),Ct=(0,s().K8)((()=>null==Pt?void 0:Pt.getParentBlockStore()),[Pt]),_t=(0,s().K8)((()=>null==Ye?void 0:Ye.collectionStore()),[Ye]);Pt&&Pt!==_t&&Ye.setContext({type:"collectionPage",collectionViewBlockStore:Ct,collectionStore:Pt});const At=(0,s().K8)((()=>{const e=(0,o(110750).Xz)($.TabbedRouterStore.state);if("web"===e.type){var t,n;if("page"===(null===(t=e.redirectedTo)||void 0===t?void 0:t.route.name))return null===(n=e.redirectedTo)||void 0===n?void 0:n.route.blockId;if("page"===e.route.name)return e.route.blockId}}),[$]),Bt=(0,n.useRef)(void 0);(0,n.useEffect)((()=>{if($.mobileNative&&He===At){var e;const t=At!==Bt.current;null===(e=$.mobileNative)||void 0===e||e.markTransitionReady({environment:$,type:"page",id:_.id,sendImmediately:!0,isNavigationEvent:t}),Bt.current=At}}),[$,At,He,_.id]),(0,n.useEffect)((()=>{Le(_.id)}),[_]);const Kt=(0,n.useCallback)((()=>{Ke||F().A.state.isDragging||Q().default.state.isActive||Ve(!0)}),[Ke]),Mt=(0,n.useCallback)((()=>{Ke||F().A.state.isDragging||Q().default.state.isActive||Ve(!1)}),[Ke]),xt=(0,n.useCallback)((()=>{F().A.state.isDragging||Q().default.state.isActive||je(!0)}),[]),wt=(0,n.useCallback)((()=>{F().A.state.isDragging||Q().default.state.isActive||je(!1)}),[]),It=(0,d().d)(xt,100),Tt=(0,d().d)(wt,100),Rt=(0,n.useCallback)((e=>{$e&&(y().hc({environment:$,store:_}),e.isAtStartOfLine?(0,o(903864).e)({store:$e}):(0,k().z)({store:$e}))}),[$,_,$e]),Et=(0,n.useCallback)((e=>{(0,o(749804).I)({environment:$}),y().IU({environment:$}),U&&U(e)}),[$,U]),Dt=(0,n.useCallback)((e=>{if(le)return!0;if(e.preventDefault(),function(e){return Boolean(de(e))}(_)){const e=(0,M().gV)(_);if(e&&e.collection_page_properties){const t=e.collection_page_properties.find(((e,t)=>function(e,t){const o=de(t);if(!o)return!1;const n=function(e){return e.getSchema()}(t);return(0,P().B2)(n[e])}(e.property,_)));t&&o(908006).default.afterNextFlush((()=>{o(90654).ho({environment:$,blockPropertyValueOverlayStore:ce(R),collectionContextStore:Ye,store:_,property:t.property,surface:"page"})}))}}}),[Ye,R,$,le,_]),zt=(0,n.useCallback)((e=>{if(le)return!0;Et(e)}),[Et,le]),Vt=(0,n.useCallback)((()=>{Te.reset()}),[Te]),Ft=(0,n.useCallback)((e=>{e.target===We.current&&null===e.relatedTarget&&document.hasFocus()&&y().IU({environment:$})}),[$]),jt=(0,s().K8)((()=>pe((0,o(835066).dC)($,_),_,R,J)),[$,_,R,J]),Ht=(0,s().K8)((()=>{const e=_.isDraft(),t=_.isPublishedDraft(),o=_.isTeamPost();return R===N().Rr.DraftPostInInlineComposer?N().Rr.DraftPostInInlineComposer:o?t?N().Rr.PostInFullPageOrPeek:e?N().Rr.DraftPostInFullPageComposer:void 0:void 0}),[_,R]),Lt=(0,o(933951).sS)({pageStore:_,postContext:Ht,collectionStore:Pt,pageViewBlockStore:De.pageViewBlockStore}),Ot=(0,s().K8)((()=>q().default.state.topHoverAreaEntered),[]),Nt=(0,n.useCallback)((e=>{const{isBottomControl:t,forceVisible:o}=e??{},n=Ke?Ot:ze;let r;return r=!!i().A.isMobile||(!!o||(!!Ee||(t?Fe&&!L().A.state.isKeyboardMode:n&&!L().A.state.isKeyboardMode||Be))),me(r)}),[Fe,Be,ze,Ke,Ot,Ee]),Ut=(0,s().K8)((()=>Nt({isBottomControl:!1})),[Nt]),qt=(0,s().K8)((()=>"suggest"===j().Uv.getMode(_)),[_]),Qt=(0,s().K8)((()=>(0,I().$3)({environment:$,collectionStore:_.getAssociatedCollectionStore()})),[$,_]),Wt=(0,s().K8)((()=>(0,I().xE)($)),[$]),Xt=(0,s().K8)((()=>(0,I().Wk)({environment:$,blockStore:_,showUpsell:Qt})),[$,_,Qt]),Gt=(0,o(400851).X)({environment:$,blockStore:_,from:"topControls",blockContext:R}),Yt=(0,n.useCallback)((({from:e})=>{if(le)return;const t=de(_);t&&(0,o(447934).nh)({environment:$,blockStore:_,collectionStore:t,from:e})}),[$,le,_]),Zt=(0,n.useMemo)((()=>{if(Pe||ot)return[];const e=[];return!re||it||qt||e.push((0,X.jsx)(n.Fragment,{children:(0,X.jsx)(o(790324).A,{store:_,afterOnClick:()=>{Ze.current=!0},style:Ut,label:J.isSmallPhone?(0,X.jsx)(g().sA,{id:"PageViewBlock.icon.pageIconMobile",defaultMessage:"Icon"}):(0,X.jsx)(g().sA,{id:"PageViewBlock.icon.pageIcon",defaultMessage:"Add icon"})})},"add-icon")),!ie||!re||at||qt||Ht||e.push((0,X.jsx)(n.Fragment,{children:(0,X.jsx)(o(312310).A,{store:_,style:Ut,label:J.isSmallPhone?(0,X.jsx)(g().sA,{id:"PageViewBlock.cover.pageCoverMobile",defaultMessage:"Cover"}):(0,X.jsx)(g().sA,{id:"PageViewBlock.cover.pageCover",defaultMessage:"Add cover"}),from:"page_header"})},"add-cover")),Xt&&e.push((0,X.jsx)(n.Fragment,{children:(0,X.jsx)(o(527580).ui,{store:_,style:Ut,showUpsell:Qt,showNewBadge:Wt})},"verify-page")),Gt&&!Ht&&e.push((0,X.jsx)(o(74175).E,{blockStore:_,onClick:()=>Yt({from:"customize_page_button_above_title"}),style:Ut},"customize-layout")),re&&!i().A.isMobile&&e.push((0,X.jsx)(n.Fragment,{children:(0,X.jsx)(o(538776).l,{store:_})},"generate-preview-image")),e}),[Pe,ot,re,it,qt,ie,at,Ht,Xt,Gt,J.isSmallPhone,_,Ut,Qt,Wt,Yt]),$t=(0,s().K8)((()=>{const{WindowSizeStore:e}=$,t=le?"20vh":(null==W?void 0:W.pageCoverHeight)??ae,n=(null==W?void 0:W.paddingX)??(0,M().OU)(R,$);return(0,X.jsx)(o(993905).s,{allowSelectionWithin:!1,style:(0,o(601726).E)(_,$),children:(0,X.jsx)(o(253448).d,{height:t,store:_,disabled:!re,paddingLeft:e.getSafePaddingLeftCSS(n),paddingRight:e.getSafePaddingRightCSS(n),proxyWidth:e.state.width})})}),[$,le,null==W?void 0:W.pageCoverHeight,null==W?void 0:W.paddingX,R,_,re]),Jt=(0,s().K8)((()=>{const e=$.currentUser.isLoggedIn(),t=null==ee?void 0:ee.publicEditModeStore.state;let n;return R===N().Rr.Frame?n=z().default.state.currentLoadingContainerStore:R===N().Rr.PeekView&&q().default.state.open&&(n=q().default.state.loadingContainerStore),Boolean(_&&n&&_.isDefined()&&!_.isNonEditableState()&&_.canEdit()&&!_.hasContent()&&e&&(!(null!=t&&t.hasPublicPermission)||"edit"===(null==t?void 0:t.permission))&&!(Boolean(o(302022).A.state.pageMap[_.id])||o(66496).A.state.pages.has(_.id))&&n.state.ready&&!(0,M().sV)(_)&&!(0,M().fc)(_))}),[$.currentUser,null==ee?void 0:ee.publicEditModeStore,_,R]),eo=(0,n.useMemo)((()=>({store:_,isEditable:re,hasCover:at,isInSidePeek:Me,openMenuOnMountCallback:()=>{Ze.current=!1}})),[at,re,Me,_]),to=(0,s().K8)((()=>Boolean(_.getAssociatedCollectionStore())),[_]),oo=(0,s().K8)((()=>J.isPhone&&!to&&!le),[J.isPhone,to,le]),no=(0,s().K8)((()=>{var t;const o=(null===(t=e.styleOverrides)||void 0===t?void 0:t.paddingX)??(0,M().OU)(R,$);let n=e.titlePlaceholder;return oo&&(n=""),{store:_,disabled:!oe||he,isInSidePeek:Me,paddingLeft:o,paddingRight:o,extraStyles:e.titleStyle,titlePlaceholder:n,collectionContextStore:Ye,shouldShowTemplatePicker:Jt,onTitleChange:Vt,onTitleEditText:Rt,onTitleEsc:Et,onTitleUntab:zt,onTitleTab:Dt}}),[null===(a=e.styleOverrides)||void 0===a?void 0:a.paddingX,e.titleStyle,e.titlePlaceholder,R,$,_,he,oe,Ye,Jt,Vt,Rt,Et,zt,Dt,Me,oo]),ro=(0,n.useCallback)((e=>{"page"===e&&f().measurePageRenderMetrics({environment:$,isEditable:re,isHomePage:!1,isWikiHome:!0,isPageWithCustomLayout:!1,idSchema:be})}),[$,re,be]),io=(0,s().K8)((()=>{const e=_.getAssociatedLayoutStore(),t=(0,o(860116).I)(e),n="hidden"===(0,o(577814).A)({environment:$,store:_,pageViewBlockStore:void 0}).type;return R!==N().Rr.DraftPostInInlineComposer&&R!==N().Rr.Presentation&&(!t||n)}),[R,_,$]),ao=(0,s().K8)((()=>{var t,n;const r=(0,X.jsx)(o(155129).X.Provider,{value:Ce,children:(0,X.jsx)(o(145214).A,{tag:o(817942).Mx,animate:_e.layout,type:jt,withBottomPadding:io,ref:Qe,children:(0,X.jsx)(o(825114).A,{context:R,postContext:Ht,onHeaderMouseEnter:Kt,onHeaderMouseLeave:Mt,onDetailMouseEnter:It,onDetailMouseLeave:Tt,pageCoverHeight:(null===(t=e.styleOverrides)||void 0===t?void 0:t.pageCoverHeight)??ae,modules:(null===(n=e.layoutModulesByArea)||void 0===n?void 0:n.page_main)??Lt.page_main,styleOverrides:e.styleOverrides,templatePickerMenuListStore:De.templatePickerMenuListStore,topControls:Zt,getControlHoverStyle:Nt,pageViewBlockStores:De,...eo,openMenuOnMount:Ze.current,...no,disabled:Z,pageViewBlockAccessor:Ge,editorContentContainerRef:qe,layoutRef:Qe})})});return Ye&&Ye.contextType?(0,X.jsx)(A().RI,{value:Ye,children:r}):r}),[Ce,_e.layout,jt,R,Ht,Kt,Mt,It,Tt,e.styleOverrides,null===(m=e.layoutModulesByArea)||void 0===m?void 0:m.page_main,Lt.page_main,De,Zt,Nt,eo,no,Z,Ge,Ye,io]),lo=(0,s().K8)((()=>{var t;const n=_.getType()===o(700500).xd.copyIndicator,r=((null===(t=_.getFormat())||void 0===t||null===(t=t.duplication_job_ids)||void 0===t?void 0:t.length)||0)>0;return n&&r?(0,X.jsx)(h().R,{store:_,peekMode:void 0,forceShowIcon:!0}):n&&(_.getParentTable()!==u().Vl||_.getParentTable()===u().Vl&&0===Object.keys(_.getProperties()).length)?(0,X.jsx)(o(388139).F,{}):o(777932).A.state.isDuplicating?(0,X.jsx)(h().R,{store:_,peekMode:void 0,forceShowIcon:!0}):le?(0,X.jsx)(A().RI,{value:Ye,children:(0,X.jsx)(o(811420).m,{canEdit:oe,context:N().Rr.CollectionViewBlockFullScreen,controlHoverStyle:Ut,handleHeaderMouseEnter:Kt,handleHeaderMouseLeave:Mt,headerFocusStore:De.headerFocusStore,pageCover:$t,topControls:Zt,...eo,openMenuOnMount:Ze.current,...no,store:_,productUseCase:"full_page",onCollectionViewBlockMount:ro,editorContentContainerRef:qe,pageViewBlockStore:xe})}):rt?(0,X.jsx)(o(620137).e,{renderLoading:()=>(0,X.jsx)(h().R,{store:_,peekMode:void 0}),innerRenderLoading:()=>(0,X.jsx)(h().R,{store:_,peekMode:void 0}),store:_}):ye?(0,X.jsx)(o(563615).eN,{store:_}):(0,X.jsx)(o(485601).c,{displayName:"PageContent",style:{...te,...e.style},disabled:!oe||_.isNonEditableState(),onBlur:Ft,shouldSelectOnEnter:se,ref:We,children:(0,X.jsx)(o(11048).A,{name:"PageContent",children:ao})})}),[_,le,rt,ye,e.style,oe,Ft,ao,Ye,Ut,Kt,Mt,De.headerFocusStore,$t,Zt,eo,no,ro,xe]);return(0,T().NW)(_,t,(0,n.useMemo)((()=>({store:_,blockContext:R,openResolvedDiscussionPopup:Oe,getContentInnerWidth:Ue,getContentWrapEl:Xe,getLayoutEl:Ge,collectionContextStore:Ye,...De,renderedType:"page",getBlockStore:()=>_,getNode:()=>We.current})),[_,R,Ye,Ue,Xe,Ge,Oe,De]),lo)}const ie=n.memo(n.forwardRef(re),o(821062).A),ae=i().A.isMobile?200:"30vh";function le(e,t=0){return e.isTablet?380:e.isIOS?Math.max(350,t):i().A.isMobile?400:"30vh"}function se(){return 0===W().default.state.stores.length}function de(e){return e.getAssociatedCollectionStore()}function ce(e){return(0,M().L5)(e)?_().A:C().A}function ue(e){return(0,M().L5)(e)?U().A:(0,M().jN)(e)?H().A:(0,S().HB)(e)}function ge(e,t,o){const{RouterStore:n}=t,{route:r}=n.state,i=e;return o.isMobileNative&&"page"===r.name&&r.showMoveTo&&i.isEmptyTitle()&&i.isEmptyPage()}function pe(e,t,o,n){return o===N().Rr.DraftPostInInlineComposer?"create-post":o===N().Rr.Presentation?"presentation-mode":n.isPhone?"phone":n.isTablet?(0,M().Ck)(t,o,n)?"wide":"tablet":(0,M().L5)(o)?(0,M().mb)(t)?"side-peek":"center-peek":(0,M().A7)(o)||(0,M().Vi)(o)?"template-preview":(0,M().sL)(o)?(0,M().Ck)(t,o,n)?"wide":"default":(0,M().Ck)(t,o,n)?e?"wide-right-margin-expanded":"wide":"default"}function Se(e,t){return 28+(0,M().XD)(e)}function me(e){return{opacity:e?1:0,pointerEvents:e?"auto":"none",transition:"opacity 100ms ease"}}function ve(e){if(!q().default.isSidePeekOpen()&&!q().default.isCenterPeekOpen())return!1;const t=z().default.state.mainEditorCurrentBlockStore;return(0,R().lU)(t)}}}]);