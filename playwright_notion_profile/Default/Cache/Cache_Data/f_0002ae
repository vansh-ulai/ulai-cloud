"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[3476,77282,83627],{346:(e,t,n)=>{n.d(t,{MG:()=>g,T1:()=>m,a1:()=>b,dt:()=>h,kg:()=>f,lC:()=>y,n_:()=>v});var o=n(296540),i=()=>n(484714),r=()=>n(56366),s=()=>n(187174),a=()=>n(645873),l=()=>n(941463),c=()=>n(441199),d=()=>n(749687),u=()=>n(737230),p=()=>n(756114);const m=new(a().O2)("PerformanceToolbar",(()=>Promise.all([n.e(71386),n.e(45624)]).then(n.bind(n,688201)))),g=(0,a()._h)(m,(e=>e.PerformanceToolbar)),h=(0,a()._h)(m,(e=>e.PerformanceToolbarSettings));function f(){const e=(0,i().v3)();return(0,r().K8)((()=>(0,p().D)(e,e.RouterStore.state)),[e])}function v(){const e=(0,i().v3)(),t=S("performanceToolbarStore"),n=S("isPerformanceToolbarVisible");return(0,r().K8)((()=>!(!t||!n)&&n(e,e.RouterStore.state,t.state)),[n,e,t])}function y(){const e=S("performanceToolbarStore");return(0,r().K8)((()=>!!e&&e.state.isPerformanceToolbarMounted),[e])}function b(){const e=(0,i().v3)(),t=S("createPerformanceToolbarMouseListeners"),n=S("performanceToolbarStore"),{sidebarExpanded:s,sidebarWidth:a,secondarySidebarExpanded:p,secondarySidebarWidth:m,updateSidebarExpanded:g,updateSidebarWidth:h}=(0,r().K8)((()=>({sidebarExpanded:d().sidebarExpandedStore.state,sidebarWidth:d().sidebarWidthStore.state,secondarySidebarExpanded:c().default.isOpen(),secondarySidebarWidth:l().Ay.getWidth(),updateSidebarExpanded:u().Ay.state.expanded,updateSidebarWidth:u().Ay.state.width})),[]);return(0,o.useEffect)((()=>{if(n&&t)return t(e,(e=>n.update((t=>({...t,isMouseNearPerformanceToolbar:e})))),s,a,p,m,g,h)}),[t,e,n,s,a,p,m,g,h])}function S(e){const t=f(),[{value:n}]=(0,s().Yb)((()=>t?m.load().then((t=>t[e])):Promise.resolve(void 0)),[e,t]);return n}},2796:(e,t,n)=>{n.d(t,{J:()=>P,L:()=>B});n(898992),n(354520);var o=()=>n(993474),i=()=>n(96563),r=()=>n(604018),s=()=>n(229533),a=()=>n(430483),l=()=>n(450528);const c={type:"box",displayName:"Box",icon:n(256385).g,isEligible:e=>a().zD.canUseAiConnectorSearchScope("box"),isLoading:()=>!(0,r().A7)("box"),isConnected:e=>a().zD.isConnectedToBoxAiConnector(n(953911).M.state),needsAuth:()=>!1,isInProgress:()=>(0,s().LT)("box").isInProgress,isDisconnecting:()=>(0,s().$t)("box"),isAvailable(e){return this.isConnected(e)},createSearchScope:()=>({type:"box"}),isEnabled(e){return(0,l().H5)(e,this.type)},setEnabled(e,t){return this.isAvailable({})?(0,l().dV)(e,this.type,t,(()=>this.createSearchScope())):e},connect(e){if(!e)return;const{environment:t,connectorsFeatureAvailability:n}=e;(0,i().pp)({environment:t,connector:"box",analyticsFrom:"multi_search_scope_menu",connectorsFeatureAvailability:n})}};var d=()=>n(262246);const u={type:"discord",displayName:"Discord",icon:n(661596).h,isEligible:e=>a().zD.canUseAiConnectorSearchScope("discord"),isLoading:()=>!(0,r().A7)("discord"),isConnected:e=>a().zD.isConnectedToDiscordAiConnector(d().l.state),needsAuth:()=>(0,s().wM)(d().l.state),isAvailable(e){return this.isConnected(e)},isInProgress:()=>(0,s().LT)("discord").isInProgress,isDisconnecting:()=>(0,s().$t)("discord"),createSearchScope:()=>({type:"discord"}),isEnabled(e){return(0,l().H5)(e,this.type)},setEnabled(e,t){return this.isAvailable({})?(0,l().dV)(e,this.type,t,(()=>this.createSearchScope())):e},connect(e){if(!e)return;const{environment:t,connectorsFeatureAvailability:n}=e;(0,i().pp)({environment:t,connector:"discord",analyticsFrom:"multi_search_scope_menu",connectorsFeatureAvailability:n})}};var p=()=>n(576590),m=()=>n(291075);const g={type:"github",displayName:"GitHub",icon:n(941115).A,isEligible:e=>a().zD.canUseAiConnectorSearchScope("github"),isLoading:()=>!(0,r().A7)("github"),isConnected:e=>a().zD.isConnectedToGithubUniversalQnA(m().o.state),needsAuth:()=>(0,s().F1)(m().o.state),isInProgress:()=>(0,s().LT)("github").isInProgress,isDisconnecting:()=>(0,s().$t)("github"),isAvailable(e){return this.isConnected(e)},createSearchScope:()=>({type:"github"}),isEnabled(e){return(0,l().H5)(e,this.type)},setEnabled(e,t){return this.isAvailable({})?(0,l().dV)(e,this.type,t,(()=>this.createSearchScope())):e},connect(e){if(!e)return;const{environment:t,connectorsFeatureAvailability:n}=e;this.needsAuth()?(0,p().openAuthNeededModal)({environment:t,connector:"github",from:"multi_search_scope_menu"}):(0,i().pp)({environment:t,connector:"github",analyticsFrom:"multi_search_scope_menu",connectorsFeatureAvailability:n})}};const h={type:"google-calendar",displayName:"Google Calendar",icon:n(683589).c,isEligible:e=>a().zD.canUseAiConnectorSearchScope("google-calendar"),isLoading:()=>!(0,r().A7)("google-calendar"),isConnected:e=>a().zD.isConnectedToGoogleCalendarUniversalQnA(n(575922).W.state),needsAuth:()=>!1,isInProgress:()=>(0,s().LT)("google-calendar").isInProgress,isDisconnecting:()=>(0,s().$t)("google-calendar"),isAvailable(e){return this.isConnected(e)},createSearchScope:()=>({type:"google-calendar"}),isEnabled(e){return(0,l().H5)(e,this.type)},setEnabled(e,t){return this.isAvailable({})?(0,l().dV)(e,this.type,t,(()=>this.createSearchScope())):e},connect(e){if(!e)return;const{environment:t,connectorsFeatureAvailability:n}=e;(0,i().pp)({environment:t,connector:"google-calendar",analyticsFrom:"multi_search_scope_menu",connectorsFeatureAvailability:n})}};var f=()=>n(174636);const v={type:"google-drive",displayName:"Google Drive",icon:n(627437).s,isEligible:e=>a().zD.canUseAiConnectorSearchScope("google-drive"),isLoading:()=>!(0,r().A7)("google-drive"),isConnected:e=>a().zD.isConnectedToGoogleDriveUniversalQnA(f().R.state),needsAuth:()=>!1,isInProgress:()=>(0,s().LT)("google-drive").isInProgress,isDisconnecting:()=>(0,s().$t)("google-drive"),isAvailable(e){return this.isConnected(e)},createSearchScope:()=>({type:"google-drive"}),isEnabled(e){return(0,l().H5)(e,this.type)},setEnabled(e,t){return this.isAvailable({})?(0,l().dV)(e,this.type,t,(()=>this.createSearchScope())):e},connect(e){if(!e)return;const{environment:t,connectorsFeatureAvailability:n}=e;(0,i().pp)({environment:t,connector:"google-drive",analyticsFrom:"multi_search_scope_menu",connectorsFeatureAvailability:n})}};const y={type:"helpdocs",displayName:"Help Center",icon:n(682759).s,isEligible:e=>a().zD.canShowHelpdocsScope(),isLoading:()=>!1,isAvailable(e){return this.isEligible(e)},needsAuth:()=>!1,isInProgress:()=>!1,isDisconnecting:()=>!1,isConnected:e=>!0,createSearchScope:()=>({type:"helpdocs"}),isEnabled:e=>(0,l().H5)(e,"helpdocs"),setEnabled(e,t,n){return(0,l().dV)(e,"helpdocs",t,(()=>this.createSearchScope()))},connect(){}};const b={type:"jira",displayName:"Jira",icon:n(856988).N,isEligible:e=>a().zD.canUseAiConnectorSearchScope("jira"),isLoading:()=>!(0,r().A7)("jira"),isConnected:e=>a().zD.isConnectedToJiraUniversalQnA(n(99254).y.state,n(479350).E.state),needsAuth:()=>!1,isInProgress:()=>(0,s().LT)("jira").isInProgress,isDisconnecting:()=>(0,s().$t)("jira"),isAvailable(e){return this.isConnected(e)},createSearchScope:()=>({type:"jira"}),isEnabled(e){return(0,l().H5)(e,this.type)},setEnabled(e,t){return this.isAvailable({})?(0,l().dV)(e,this.type,t,(()=>this.createSearchScope())):e},connect(e){if(!e)return;const{environment:t,connectorsFeatureAvailability:n}=e;(0,i().pp)({environment:t,connector:"jira",analyticsFrom:"multi_search_scope_menu",connectorsFeatureAvailability:n})}};const S={type:"linear",displayName:"Linear",icon:n(658861).u,isEligible:e=>a().zD.canUseAiConnectorSearchScope("linear"),isLoading:()=>!(0,r().A7)("linear"),isConnected:e=>a().zD.isConnectedToLinearUniversalQnA(n(46657).W.state),needsAuth:()=>(0,s().eA)("linear"),isInProgress:()=>(0,s().LT)("linear").isInProgress,isDisconnecting:()=>(0,s().$t)("linear"),isAvailable(e){return this.isConnected(e)&&!this.needsAuth()},createSearchScope:()=>({type:"linear"}),isEnabled(e){return(0,l().H5)(e,this.type)},setEnabled(e,t){return this.isAvailable({})?(0,l().dV)(e,this.type,t,(()=>this.createSearchScope())):e},connect(e){if(!e)return;const{environment:t,connectorsFeatureAvailability:n}=e;this.needsAuth()?(0,p().openAuthNeededModal)({environment:t,connector:"linear",from:"multi_search_scope_menu"}):(0,i().pp)({environment:t,connector:"linear",analyticsFrom:"multi_search_scope_menu",connectorsFeatureAvailability:n})}};const x={type:"microsoft-teams",displayName:"Microsoft Teams",icon:n(685230).F,isEligible:e=>a().zD.canUseAiConnectorSearchScope("microsoft-teams"),isLoading:()=>!(0,r().A7)("microsoft-teams"),isConnected:e=>a().zD.isConnectedToMicrosoftTeamsUniversalQnA(n(963702).F.state),needsAuth:()=>!1,isInProgress:()=>(0,s().LT)("microsoft-teams").isInProgress,isDisconnecting:()=>(0,s().$t)("microsoft-teams"),isAvailable(e){return this.isConnected(e)},createSearchScope:()=>({type:"microsoft-teams"}),isEnabled(e){return(0,l().H5)(e,this.type)},setEnabled(e,t){return this.isAvailable({})?(0,l().dV)(e,this.type,t,(()=>this.createSearchScope())):e},connect(e){if(!e)return;const{environment:t,connectorsFeatureAvailability:n}=e;(0,i().pp)({environment:t,connector:"microsoft-teams",analyticsFrom:"multi_search_scope_menu",connectorsFeatureAvailability:n})}};const k={type:"notion-calendar",displayName:"Notion Calendar",icon:n(971851).Q,isEligible:e=>a().zD.canUseAiConnectorSearchScope("notion-calendar"),isLoading:()=>!(0,r().A7)("notion-calendar"),isConnected:e=>a().zD.isConnectedToNotionCalendarUniversalQnA(n(702327).g.state),needsAuth:()=>!1,isInProgress:()=>(0,s().LT)("notion-calendar").isInProgress,isDisconnecting:()=>(0,s().$t)("notion-calendar"),isAvailable(e){return this.isConnected(e)},createSearchScope:()=>({type:"notion-calendar"}),isEnabled(e){return(0,l().H5)(e,this.type)},setEnabled(e,t){return this.isAvailable({})?(0,l().dV)(e,this.type,t,(()=>this.createSearchScope())):e},connect(e){if(!e)return;const{environment:t,connectorsFeatureAvailability:n}=e;(0,i().pp)({environment:t,connector:"notion-calendar",analyticsFrom:"multi_search_scope_menu",connectorsFeatureAvailability:n})}};const C={type:"notion-mail",displayName:"Notion Mail",icon:n(384154).D,isEligible:e=>a().zD.canUseAiConnectorSearchScope("notion-mail"),isLoading:()=>!(0,r().A7)("notion-mail"),isConnected:e=>a().zD.isConnectedToNotionMailUniversalQnA(n(8870).L.state),needsAuth:()=>!1,isInProgress:()=>(0,s().LT)("notion-mail").isInProgress,isDisconnecting:()=>(0,s().$t)("notion-mail"),isAvailable(e){return this.isConnected(e)},createSearchScope:()=>({type:"notion-mail"}),isEnabled(e){return(0,l().H5)(e,this.type)},setEnabled(e,t){return this.isAvailable({})?(0,l().dV)(e,this.type,t,(()=>this.createSearchScope())):e},connect(e){if(!e)return;const{environment:t,connectorsFeatureAvailability:n}=e;(0,i().pp)({environment:t,connector:"notion-mail",analyticsFrom:"multi_search_scope_menu",connectorsFeatureAvailability:n})}};const A={type:"notion",displayName:"Notion",icon:n(374693)._,isEligible:e=>!0,isLoading:()=>!1,isAvailable:e=>!0,needsAuth:()=>!1,isInProgress:()=>!1,isDisconnecting:()=>!1,isConnected:e=>!0,createSearchScope:()=>({type:"notion"}),isEnabled(e){return(0,l().H5)(e,this.type)},setEnabled(e,t){return(0,l().dV)(e,this.type,t,(()=>this.createSearchScope()))},connect(){}};const I={type:"outlook",displayName:"Outlook",icon:n(350527).g,isEligible:e=>a().zD.canUseAiConnectorSearchScope("outlook"),isLoading:()=>!(0,r().A7)("outlook"),isConnected:e=>a().zD.isConnectedToOutlookUniversalQnA(n(291657).y.state),needsAuth:()=>!1,isInProgress:()=>(0,s().LT)("outlook").isInProgress,isDisconnecting:()=>(0,s().$t)("outlook"),isAvailable(e){return this.isConnected(e)},createSearchScope:()=>({type:"outlook"}),isEnabled(e){return(0,l().H5)(e,this.type)},setEnabled(e,t){return this.isAvailable({})?(0,l().dV)(e,this.type,t,(()=>this.createSearchScope())):e},connect(e){if(!e)return;const{environment:t,connectorsFeatureAvailability:n}=e;(0,i().pp)({environment:t,connector:"outlook",analyticsFrom:"multi_search_scope_menu",connectorsFeatureAvailability:n})}};const w={type:"salesforce",displayName:"Salesforce",icon:n(251839).M,isEligible:e=>a().zD.canUseAiConnectorSearchScope("salesforce"),isLoading:()=>!(0,r().A7)("salesforce"),isConnected:e=>a().zD.isConnectedIsSalesforceAiConnector(n(723771).C.state),needsAuth:()=>!1,isInProgress:()=>(0,s().LT)("salesforce").isInProgress,isDisconnecting:()=>(0,s().$t)("salesforce"),isAvailable(e){return this.isConnected(e)},createSearchScope:()=>({type:"salesforce"}),isEnabled(e){return(0,l().H5)(e,this.type)},setEnabled(e,t){return this.isAvailable({})?(0,l().dV)(e,this.type,t,(()=>this.createSearchScope())):e},connect(e){if(!e)return;const{environment:t,connectorsFeatureAvailability:n}=e;(0,i().pp)({environment:t,connector:"salesforce",analyticsFrom:"multi_search_scope_menu",connectorsFeatureAvailability:n})}};const M={type:"sharepoint",displayName:"SharePoint",icon:n(188079).s,isEligible:e=>a().zD.canUseAiConnectorSearchScope("sharepoint"),isLoading:()=>!(0,r().A7)("sharepoint"),isConnected:e=>a().zD.isConnectedIsSharepointAiConnector(n(92383).E.state),needsAuth:()=>!1,isInProgress:()=>(0,s().LT)("sharepoint").isInProgress,isDisconnecting:()=>(0,s().$t)("sharepoint"),isAvailable(e){return this.isConnected(e)},createSearchScope:()=>({type:"sharepoint"}),isEnabled(e){return(0,l().H5)(e,this.type)},setEnabled(e,t){return this.isAvailable({})?(0,l().dV)(e,this.type,t,(()=>this.createSearchScope())):e},connect(e){if(!e)return;const{environment:t,connectorsFeatureAvailability:n}=e;(0,i().pp)({environment:t,connector:"sharepoint",analyticsFrom:"multi_search_scope_menu",connectorsFeatureAvailability:n})}};const T={type:"slack",displayName:"Slack",icon:n(703888).j,isEligible:e=>a().zD.canUseAiConnectorSearchScope("slack"),isLoading:()=>!(0,r().A7)("slack"),isConnected:e=>a().zD.isConnectedToSlackUniversalQnA(f().R.state),needsAuth:()=>(0,s().al)(f().R.state),isAvailable(e){return this.isConnected(e)},isInProgress:()=>(0,s().LT)("slack").isInProgress,isDisconnecting:()=>(0,s().$t)("slack"),createSearchScope:()=>({type:"slack"}),isEnabled(e){return(0,l().H5)(e,this.type)},setEnabled(e,t){return this.isAvailable({})?(0,l().dV)(e,this.type,t,(()=>this.createSearchScope())):e},connect(e){if(!e)return;const{environment:t,connectorsFeatureAvailability:n}=e;this.needsAuth()?(0,p().openAuthNeededModal)({environment:t,connector:"slack",from:"multi_search_scope_menu"}):(0,i().pp)({environment:t,connector:"slack",analyticsFrom:"multi_search_scope_menu",connectorsFeatureAvailability:n})}};const j={notion:A,web:{type:"web",displayName:"Web search",icon:n(822423).u,isEligible:e=>e.originSurface?a().zD.isWebSearchEnabledForSource(e.originSurface):a().zD.isResearchModeWebSearchEnabled(),isLoading:()=>!1,isAvailable(e){return this.isEligible(e)},needsAuth:()=>!1,isInProgress:()=>!1,isDisconnecting:()=>!1,isConnected(e){return this.isAvailable(e)},createSearchScope:()=>({type:"web"}),isEnabled:e=>"workflow"===e.type?(0,n(724639).H0)({config:e,modules:[]}):e.useWebSearch??!1,setEnabled(e,t,n){return this.isAvailable(n??{})?{...e,useWebSearch:t}:e},connect(){}},...{slack:T,github:g,gmail:(0,o().K)("gmail").toSearchScopeModule(),"google-drive":v,jira:b,outlook:I,linear:S,"microsoft-teams":x,"notion-mail":C,sharepoint:M,"google-calendar":h,"notion-calendar":k,salesforce:w,discord:u,asana:(0,o().K)("asana").toSearchScopeModule(),box:c},helpdocs:y};function P(e){return Object.values(j).filter((t=>t.isEligible(e)))}function B(e){return j[e]}},8741:(e,t,n)=>{n.r(t),n.d(t,{arrowDiagonalUpRightSmallIcon:()=>i,iconDefinition:()=>o});n(296540);const o={viewBox:"0 0 16 16",fittedViewBox:"3.65 3.66 8.68 8.68",directional:!0,svg:(0,n(474848).jsx)("path",{d:"M5.603 3.663a.625.625 0 1 0 0 1.25h4.6l-6.37 6.371a.615.615 0 0 0 .013.87.616.616 0 0 0 .87.014l6.371-6.372v4.601a.625.625 0 1 0 1.25 0v-6.11a.625.625 0 0 0-.625-.624z"})},i=(0,n(340498).wt)("arrowDiagonalUpRightSmall",o)},27356:(e,t,n)=>{n.r(t),n.d(t,{UISpacePermissionGroupToken:()=>v});var o=n(296540),i=()=>n(726637),r=()=>n(484714),s=()=>n(56366),a=()=>n(401497),l=()=>n(784892),c=()=>n(437607),d=()=>n(914462),u=()=>n(69708),p=()=>n(284371),m=()=>n(764353),g=()=>n(848401),h=()=>n(580648),f=n(474848);function v(e){const{parentStore:t,style:n,format:v}=e,y=e.groupPointer.id,b=e.groupPointer.spaceId,S=(0,c().S4)({spacePermissionGroupId:y,spaceId:b}),x=(0,s().K8)((()=>{if(e.groupModel)return e.groupModel;if(!t)return;return m().C.createChildStore(t,S).getModel()}),[t,S,e.groupModel]),k=(0,r().Y0)(),{outerStyle:C,avatarWrapStyle:A}=(0,a().IS)((e=>({outerStyle:{display:"flex",alignItems:"center",minWidth:0},avatarWrapStyle:{width:"none",minHeight:"none",marginInlineEnd:6},badgeStyle:{borderRadius:4,background:e.legacyDefaultSelectColor,fontSize:i().A.isMobile?11:9,lineHeight:k.isAndroid?1.5:1,textTransform:"uppercase",letterSpacing:"0.04em"}})),[k]),I=(0,u().tz)(),w=(0,s().K8)((()=>(0,d().n)({intl:I,permissionGroupModel:x})),[I,x]),M=(0,o.useCallback)((e=>v===l().NY.Inline?(0,f.jsx)(h().o,{group:x,size:e}):(0,f.jsxs)("div",{style:C,children:[(0,f.jsx)("div",{style:A,children:(0,f.jsx)(h().o,{group:x,size:e})}),(0,f.jsx)("div",{style:{...p().RC},children:w})]})),[v,C,A,x,w]);return(0,f.jsx)(g().Ay,{...e,style:{margin:0,...n},renderAvatar:M})}},32527:(e,t,n)=>{n.d(t,{E:()=>i});n(296540);const o={viewBox:"0 0 16 16",fittedViewBox:"2.67 2.3 10.65 11.35",svg:(0,n(474848).jsx)("path",{d:"M7.1 2.344a.625.625 0 0 0-.724.507l-.5 2.844h-1.98a.625.625 0 1 0 0 1.25h1.76l-.373 2.11H3.304a.625.625 0 0 0 0 1.25h1.76L4.6 12.932a.625.625 0 0 0 1.231.216l.501-2.843h2.483l-.463 2.627a.625.625 0 0 0 1.231.216l.501-2.843h2.02a.625.625 0 0 0 0-1.25h-1.8l.372-2.11h2.02a.625.625 0 0 0 0-1.25h-1.8l.463-2.627a.625.625 0 1 0-1.23-.217l-.502 2.844H7.145l.462-2.627a.625.625 0 0 0-.507-.724m-.547 6.71.371-2.109h2.483l-.372 2.11z"})},i=(0,n(340498).wt)("numberSmall",o)},53528:(e,t,n)=>{n.d(t,{OH:()=>a,T2:()=>l,do:()=>c});var o=()=>n(597777),i=()=>n(869190),r=()=>n(604995),s=()=>n(416504);function a(e){const{dateTime:t,intl:n,shortenDateAndRange:o}=e,s=r().C6.toPersistedDate(t.valueOf());return i().ZF({value:s,allowRelativeDates:!0,intl:n,shortenDateAndRange:o,displayInUserTimezone:!0})}function l(e){const{dateTime:t,intl:n,userTimeZone:o,displayInUserTimezone:s,alwaysIncludeTimezone:a}=e,l=r().C6.toPersistedDateTime(t.valueOf(),t.zoneName);return i().ZF({value:l,allowRelativeDates:!0,intl:n,userTimeZone:o,displayInUserTimezone:s,alwaysIncludeTimezone:a})}function c(e){const{luxonRange:t,intl:n}=e,a=r().C6.toPersistedDateRange(t),l=i().ZF({value:a,allowRelativeDates:!1,shortenDateAndRange:!0,intl:n,displayInUserTimezone:!0}),c=t.end.setZone((0,s().P)()),d=i().fU({start_time:c.toFormat(o().GE),humanReadable:!1,intl:n});return n.formatMessage({id:"verification.timeRange",defaultMessage:"{formattedDateRange} at {formattedEndTime}"},{formattedDateRange:l,formattedEndTime:d})}},59400:(e,t,n)=>{n.d(t,{nR:()=>d,m$:()=>a,m4:()=>l,Dy:()=>c,_Q:()=>g,FZ:()=>p});n(296540);var o=()=>n(645873),i=n(474848);function r(e){const{innerContent:t,collectionSettingsProps:o}=e,r=(0,n(401497).IS)((e=>({offlineMessage:{color:e.text.secondary}})),[]);return(0,i.jsx)(n(735695).Ay,{collectionSettingsStore:o.collectionSettingsStore,fullHeight:o.fullHeight,hideDesktopHeader:o.hideDesktopHeader,title:"offlineError"===t?(0,i.jsx)("div",{style:r.offlineMessage,children:(0,i.jsx)(n(69708).sA,{defaultMessage:"Please go online.",id:"lazyCollectionSettings.offlineError"})}):void 0,children:"loadingSpinner"===t?(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",overflow:"hidden",paddingBottom:20},children:(0,i.jsx)(n(98126).k,{})}):void 0})}const s=new(o().O2)("collectionSettings",(()=>Promise.all([n.e(75134),n.e(9773),n.e(36556),n.e(40537),n.e(55373),n.e(36192),n.e(71562),n.e(96346),n.e(44711),n.e(53321),n.e(90825),n.e(62475),n.e(3151),n.e(98629),n.e(87249),n.e(71621),n.e(88924),n.e(92845),n.e(56369),n.e(5834),n.e(48486),n.e(2411),n.e(89296),n.e(46414),n.e(9294),n.e(11676),n.e(91256),n.e(40563),n.e(67494),n.e(44584),n.e(53141),n.e(4422),n.e(4330),n.e(55162),n.e(71003),n.e(55753),n.e(28866),n.e(22001),n.e(71386),n.e(4351),n.e(6331),n.e(69144),n.e(12341),n.e(96402),n.e(84166),n.e(16448),n.e(45769),n.e(74562),n.e(37384),n.e(94562),n.e(13955),n.e(76677),n.e(43223),n.e(45147),n.e(15517),n.e(94995),n.e(98339),n.e(1966),n.e(55776),n.e(51444),n.e(13297),n.e(4802),n.e(62032),n.e(32487),n.e(28058),n.e(75422),n.e(50856),n.e(36359),n.e(92924),n.e(25204),n.e(52986),n.e(45732),n.e(30443),n.e(99108)]).then(n.bind(n,409198)))),a=(0,o()._h)(s,(e=>e.CollectionSettings),{renderLoading:(e,t)=>(0,i.jsx)(r,{innerContent:e?"loadingSpinner":"empty",collectionSettingsProps:t}),renderOfflineError:e=>(0,i.jsx)(r,{innerContent:"offlineError",collectionSettingsProps:e})}),l=(0,o()._h)(s,(e=>e.CollectionSettingsButtonOptions)),c=(0,o()._h)(s,(e=>e.CollectionSettingsPropertyTypeMenuItem)),d=(0,o()._h)(s,(e=>e.CollectionEditButtonAutomationOption)),u=new(o().O2)("TableHeaderPropertyCreationMenu",(()=>Promise.all([n.e(9773),n.e(36556),n.e(40537),n.e(55373),n.e(36192),n.e(71562),n.e(96346),n.e(87249),n.e(71621),n.e(88924),n.e(92845),n.e(56369),n.e(5834),n.e(48486),n.e(2411),n.e(89296),n.e(46414),n.e(9294),n.e(11676),n.e(91256),n.e(40563),n.e(67494),n.e(44584),n.e(53141),n.e(74562),n.e(37384),n.e(13955),n.e(50856),n.e(43935)]).then(n.bind(n,908800)))),p=(0,o()._h)(u,(e=>e.TableHeaderPropertyCreationMenu)),m=new(o().O2)("CollectionSettingsSaveControl",(()=>Promise.all([n.e(71562),n.e(21990)]).then(n.bind(n,615950)))),g=(0,o()._h)(m,(e=>e.CollectionSettingsSaveControl))},65767:(e,t,n)=>{n.d(t,{l:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("closeThick",{viewBox:"0 0 8 8",svg:(0,o.jsx)("polygon",{points:"8 1.01818182 6.98181818 0 4 2.98181818 1.01818182 0 0 1.01818182 2.98181818 4 0 6.98181818 1.01818182 8 4 5.01818182 6.98181818 8 8 6.98181818 5.01818182 4"})})},68350:(e,t,n)=>{n.d(t,{I:()=>v});var o=n(296540),i=()=>n(484714),r=()=>n(56366),s=()=>n(401497),a=()=>n(898244),l=()=>n(645873);const c=new(l().O2)("PagePropertiesRowNameMenu",(async()=>Promise.all([n.e(9773),n.e(36556),n.e(40537),n.e(96346),n.e(92845),n.e(46414),n.e(71003),n.e(74562),n.e(37384),n.e(13955),n.e(1423)]).then(n.bind(n,716547)))),d=(0,l()._h)(c,(e=>e.PagePropertiesRowNameMenu));var u=()=>n(795963),p=()=>n(735372),m=()=>n(59364),g=()=>n(417392),h=()=>n(398217),f=n(474848);const v=o.memo((function(e){const{property:t,blockStore:l,schema:c,disabled:p,locked:h,canConfigureCollection:v,isInPeekRenderer:b,labelComponent:S,hideDragHandle:x,pagePropertiesStore:k,styleVariants:C,disableRowNameInteractivity:A,dragHandleStyle:I,layoutModule:w,forceHighlight:M,forceFocusedHighlight:T,hideIcon:j,propertyNameAriaId:P,showDragHandleAsIcon:B}=e,_=(0,o.useRef)(null),E=(0,n(908201).Ks)(),D=(0,i().v3)(),{isPhone:z}=(0,i().Y0)(),[R,V]=(0,o.useState)(!1),L=c[t],N=(0,r().K8)((()=>k.state.hoveredProperty===t),[k,t]),{shouldShowDragHandle:F,shouldRenderDragHandle:H,shouldShowDragIcon:O}=(0,r().K8)((()=>{const e=!z&&!n(732770).A.state.isKeyboardMode&&!x&&!p&&!h&&v,t=e&&!B;return{shouldShowDragHandle:N&&t,shouldRenderDragHandle:t,shouldShowDragIcon:e&&N&&B&&!j}}),[N,z,x,p,h,v,B,j]),W=(0,r().K8)((()=>k.state.openProperty),[k]),U=(0,r().K8)((()=>null==E?void 0:E.collectionStore()),[E]),K=(0,s().IS)((e=>{const{size:t="medium",width:o={variant:"fixed",widthMobile:u().yN,widthDesktop:u().OQ},height:i,color:r="default"}=C||{},s="medium"!==(null==i?void 0:i.variant)&&(null!=i&&i.variant||"medium"!==t)?24:34;let a;if("fixed"===o.variant){const e=z?o.widthMobile||u().yN:o.widthDesktop||u().OQ;a={width:e,maxWidth:e,minWidth:0}}else if("hug-content"===o.variant){a={width:"min-content",maxWidth:z?o.maxWidthMobile||"100%":o.maxWidthDesktop||"100%",minWidth:0}}else(0,n(534177).HB)(o);return{propertyLabelContainerStyles:{display:"flex",alignItems:"center",color:"primary"===r?e.text.primary:e.text.secondary,height:s,...a},tooltipLockedIcon:{width:12,fill:e.text.inversePrimary,marginInlineStart:2,display:"inline-block",verticalAlign:"middle",paddingBottom:3},tooltipDescription:{color:e.text.inverseSecondary},tooltipAutoUpdatedByAi:{color:e.text.inverseSecondary},personPropertyPermissionsTooltip:{color:e.text.inverseSecondary}}}),[C,z]),G=(0,o.useCallback)((()=>{k.setState({...k.state,hoveredProperty:void 0})}),[k]),q=(0,o.useCallback)((()=>{k.setState({...k.state,hoveredProperty:t})}),[k,t]),$=(0,o.useMemo)((()=>H&&(0,f.jsx)(n(145214).A,{animate:{opacity:F?1:0},initial:{opacity:0},exit:{opacity:0},style:{width:m().Z+4,marginInlineStart:-(m().Z+4)},onMouseMove:q,onMouseLeave:G,children:(0,f.jsx)(n(348501).A,{role:"cell",disallowTabbing:!0,onClick:t=>function(e,t,o,i){(0,n(616068).Z)()||i.setState({...i.state,openProperty:{property:t,isInPeekRenderer:o}})}(0,e.property,e.isInPeekRenderer,k)})})),[k,e.isInPeekRenderer,e.property,G,q,F,H]),Y=(0,o.useCallback)((e=>{if(!E)return;const o=E.permissionScopesStore.state,i={onClick:!A&&o.canConfigureBlock?()=>function(e,t,o,i){(0,n(749804).I)({environment:o}),n(778417).IU({environment:o}),(0,n(404779).y)(),i.setState({...i.state,openProperty:{property:e,isInPeekRenderer:t}})}(t,b,D,k):n(496603).D_};return(0,f.jsx)(y,{hideIcon:Boolean(j),showDragIcon:O,dragHandleStyle:I,schema:c,property:t,disabled:p||Boolean(A),locked:h,canConfigureCollection:v,events:(0,n(553965).A)(i,e),propertyNameAriaId:P,setIsDescriptionIconTooltipHovered:e=>V(e),styleVariants:C,layoutModule:w,forceHighlight:M,forceFocusedHighlight:T,collectionStore:U,blockStore:l})}),[E,A,j,O,I,c,t,p,h,v,P,C,w,M,T,U,l,b,D,k]),Q=Boolean(W&&!p&&W.property===t&&W.isInPeekRenderer===b),Z=(0,o.useCallback)((()=>{if(!E)return;k.setState({...k.state,openProperty:void 0});const e=E.settingsStore;n(147503).os({collectionSettingsStore:e})}),[E,k]),X=(0,o.useCallback)((()=>{const t=null==E?void 0:E.settingsStore;if(E&&t)return(0,f.jsx)("div",{ref:_,children:t.state.open?(0,f.jsx)(n(59400).m$,{context:n(527438).Bd.TopbarFilterPopup,collectionContextStore:E,collectionSettingsStore:t,hideDesktopHeader:!0}):(0,f.jsx)(d,{...e,popupContainerRef:_})})}),[E,e]),J=(0,o.useCallback)((e=>{if(!E||!L)return null;const o=(0,a().$M)(L)&&(0,a().om)(L);return(0,f.jsxs)("div",{...e,style:n(673730).Q$,children:[(0,f.jsxs)("div",{children:[L.name,h?(0,n(315564).S)(K.tooltipLockedIcon):void 0]}),void 0!==(null==L?void 0:L.description)&&L.description.length>0?(0,f.jsx)("div",{style:K.tooltipDescription,children:L.description}):null,U?(0,f.jsx)(n(408839).t,{propertySchema:L,collectionStore:U,property:t,style:K.personPropertyPermissionsTooltip,blockStore:l}):void 0,o&&o.auto_update_on_edit?(0,f.jsx)("div",{style:K.tooltipAutoUpdatedByAi,children:(0,f.jsx)(n(69708).sA,{defaultMessage:"Auto-updated by AI",id:"database.tableHeaderCell.tooltipAiAutofillDescription"})}):void 0]})}),[E,L,U,K.tooltipLockedIcon,K.tooltipDescription,K.personPropertyPermissionsTooltip,K.tooltipAutoUpdatedByAi,h,t,l]);return E&&L?(0,f.jsx)(n(859428).A,{disableTooltip:z,renderTooltip:J,delayThreshold:R?0:500,placement:"left",tooltipClassName:n(38337).StS,render:e=>(0,f.jsxs)("div",{style:K.propertyLabelContainerStyles,onMouseMove:q,onMouseLeave:G,children:[$,(0,f.jsx)(g().Ay,{popupType:z?g().nl.BottomSheet:g().nl.Popup,bottomSheetInitialState:"half",originGap:1,alignmentToOrigin:"start",render:X,trapFocus:!1,open:Q,onDismiss:Z,origin:S??Y(e)})]},t)}):null})),y=o.memo((function(e){const{schema:t,property:i,disabled:a,locked:l,canConfigureCollection:c,events:d,styleVariants:u,forceHighlight:m,forceFocusedHighlight:g,showDragIcon:v,collectionStore:y,blockStore:b}=e,S=(null==u?void 0:u.color)||"default",x=(null==u?void 0:u.size)||"medium",k=null==u?void 0:u.fontWeight,C=t[i],A=(0,s().DP)(),I=(0,n(379771).Q)(i),w=o.useMemo((()=>{if(!I)return null;const e=A.background.primary;return"jira"===I?(0,n(280746).jiraIcon)({width:10,height:10,stroke:e,strokeWidth:1,paintOrder:"stroke fill",vectorEffect:"non-scaling-stroke"}):(0,n(769145).salesforceIcon)({width:10,height:10,stroke:e,strokeWidth:1,paintOrder:"stroke fill",vectorEffect:"non-scaling-stroke"})}),[I,A.background.primary]),M=(0,r().K8)((()=>{if(g)return!0;const e=p().wb.state;return!(!e||"page_property_name"!==e.type)&&e.propertyId===i}),[i,g]),T=(0,r().K8)((()=>{var e;if(m)return!0;const n=p().qu.state,o=null===(e=t[i])||void 0===e?void 0:e.name;if(!n||!o)return!1;return o.toLowerCase().includes(n.toLowerCase())}),[i,t,m]),j=(0,s().IS)((t=>{const o=M?t.findHighlightMatch.selectedBackground:t.findHighlightMatch.unselectedBackground;return{button:{display:"flex",alignItems:"center",height:"100%",width:(0,n(778781).gx)(e.layoutModule)?void 0:"100%",borderRadius:4,padding:"0 6px",maxWidth:"100%"},property:{backgroundColor:T?o:void 0,outline:T?`5px solid ${o}`:void 0,borderRadius:T?4:void 0,color:M?"black":void 0,..."medium"===x?{fontSize:14,lineHeight:"20px"}:{fontSize:13,lineHeight:"18px"},...k?{fontWeight:n(284371).Wy[k]}:{}},icon:{marginInlineEnd:2,..."primary"===S?{fill:t.icon.primary}:M?{fill:"black"}:{}}}}),[S,M,x,k,e.layoutModule,T]);return C?(0,f.jsx)(n(718827).Ay,{role:"cell",id:e.propertyNameAriaId,style:j.button,disabled:a||l||!c,...d,onContextMenu:e=>{e.preventDefault(),d.onClick(e)},children:(0,f.jsx)(h().mA,{propertySchema:C,showIcon:!e.hideIcon,showDragIcon:v,showIntegrationIconOverlay:w,badge:(0,f.jsxs)(f.Fragment,{children:[y?(0,f.jsx)(n(897941).$,{propertySchema:C,collectionStore:y,property:i,blockStore:b}):void 0,(0,f.jsx)(h().Jv,{propertySchema:C}),(0,f.jsx)(n(367424).D,{propertySchema:C})]}),style:j.property,property:i,className:M?n(643707).wT:void 0,labelSizeVariant:x,iconSize:"medium"===x?16:14,iconStyle:j.icon,dragHandleStyle:e.dragHandleStyle})}):null}))},70278:(e,t,n)=>{n.r(t),n.d(t,{AiBlockV2:()=>Mn});n(16280),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(803949),n(581454);var o=n(296540),i=()=>n(564884),r=()=>n(993905),s=()=>n(726637),a=()=>n(17022),l=()=>n(484714),c=()=>n(56366),d=()=>n(401497),u=()=>n(252291),p=()=>n(160432),m=()=>n(1295),g=()=>n(534177),h=()=>n(68263),f=()=>n(179034),v=()=>n(519831),y=()=>n(96689),b=()=>n(189141);function S(e){const{referenceContext:t,getRecordRole:n,getCanReadSlackChannel:o}=e;if(!t)return!0;for(const i of t)if("collection"===i.type){const e=n({id:i.collectionId,table:v().Vl})??"none";if(!(0,h().Tt)(e))return!1}else if("page"===i.type||"currentPage"===i.type){const e=n({id:i.pageId,table:f().ev})??"none";if(!(0,h().Tt)(e))return!1}else if("slack"===i.type){if(!o(i))return!1}else(0,g().HB)(i);return!0}class x{constructor(e,t){this.permissionLevel=void 0,this.isTemplateInstantiation=void 0,this.permissionLevel=e,this.isTemplateInstantiation=(null==t?void 0:t.isTemplateInstantiation)??!1}canOpenConfigurationPanel(){switch(this.permissionLevel){case"editor":case"configuration_reader":return!0;case"reader":return!1;default:(0,g().HB)(this.permissionLevel)}}canEditConfigurationPanel(){if(this.isTemplateInstantiation)return!0;switch(this.permissionLevel){case"reader":case"configuration_reader":return!1;case"editor":return!0;default:(0,g().HB)(this.permissionLevel)}}canGenerateBlock(){switch(this.permissionLevel){case"editor":return!0;case"configuration_reader":case"reader":return!1;default:(0,g().HB)(this.permissionLevel)}}canDuplicateBlock(){if(this.isTemplateInstantiation)return!0;switch(this.permissionLevel){case"reader":return!1;case"configuration_reader":case"editor":return!0;default:(0,g().HB)(this.permissionLevel)}}}var k=()=>n(663760),C=()=>n(165358),A=()=>n(416845),I=()=>n(513416),w=()=>n(831081),M=()=>n(735790),T=()=>n(134025),j=()=>n(370085),P=()=>n(388821),B=()=>n(798880),_=()=>n(985529),E=()=>n(439180),D=()=>n(69708),z=()=>n(532659),R=()=>n(496603),V=()=>n(229833),L=()=>n(532313),N=()=>n(559506),F=()=>n(901389),H=()=>n(863168),O=()=>n(384944),W=()=>n(778417),U=()=>n(231297),K=()=>n(285790),G=()=>n(859428),q=()=>n(864145),$=()=>n(972435),Y=()=>n(765957),Q=()=>n(829e3),Z=()=>n(148832),X=()=>n(878710),J=()=>n(991249),ee=()=>n(329304),te=()=>n(11048),ne=()=>n(919980),oe=()=>n(628864),ie=(n(944114),n(823215),n(672577),n(737550),()=>n(493552)),re=()=>n(700500),se=()=>n(324254),ae=()=>n(537193),le=()=>n(671089),ce=()=>n(395546),de=()=>n(880565),ue=()=>n(813197),pe=()=>n(920495),me=()=>n(983521),ge=()=>n(37719),he=()=>n(284371),fe=()=>n(59226),ve=()=>n(98126),ye=()=>n(96563),be=()=>n(604018),Se=()=>n(760217),xe=()=>n(406699),ke=()=>n(404277),Ce=()=>n(939740),Ae=()=>n(460292),Ie=()=>n(89924),we=()=>n(581369),Me=()=>n(722872),Te=()=>n(553965),je=()=>n(152197),Pe=()=>n(724639),Be=()=>n(2796),_e=()=>n(450528);var Ee=()=>n(756219),De=n(474848);const ze=280,Re=350,Ve=(0,D().YK)({tooltipLabel:{id:"MultiSearchScopePopup.tooltipLabel",defaultMessage:"Search scope settings"},sourcesSection:{id:"MultiSearchScopePopup.sourcesSection",defaultMessage:"Sources"},connectorsSection:{id:"MultiSearchScopePopup.connectorsSection",defaultMessage:"Connectors"},connectLabel:{id:"MultiSearchScopePopup.connectLabel",defaultMessage:"Connect"}});function Le(e){const{buttonPopupParent:t,value:n,onChange:i,validScopeOverrides:r,hideConnectorFooter:a,originSource:d}=e,u=(0,l().v3)(),p=(0,je().r)(),m=(0,ee()._X)({name:"ai_connectors",spaceId:p,userId:u.currentUser.id}),{normalizedValue:g,eligibleScopes:h,handleToggleScope:f}=function(e){const{value:t,onChange:n,avoidEverythingScope:i,originSource:r}=e,s=(0,o.useMemo)((()=>"workflow"===t.type?(0,Pe().n_)({config:t,modules:[]})??[]:"ai-block"===t.type?t.searchScopes:[]),[t]),a=(0,c().K8)((()=>(0,Be().J)({originSurface:r})),[r]),l=(0,c().K8)((()=>a.filter((e=>e.isAvailable({})))),[a]),d=(0,o.useMemo)((()=>{if("workflow"!==t.type&&"ai-block"!==t.type)return t;const e=s.some((e=>"everything"===e.type)),n=(0,_e().NV)(t);if(e){const e=l.filter((e=>"web"!==e.type)).map((e=>e.createSearchScope()));return{...t,searchScopes:e,useWebSearch:n}}{const e=s.filter((e=>"web"!==e.type));return{...t,searchScopes:e,useWebSearch:n}}}),[t,l,s]),u=(0,o.useCallback)((e=>{const t=e.isEnabled(d);let o=e.setEnabled(d,!t);const r=(0,_e().ZP)(o),s=(0,_e().NV)(o),a=l.map((e=>e.type)).filter((e=>"web"!==e)),c=r.map((e=>e.type)),u=a.every((e=>c.includes(e))),p=r.filter((e=>"ai-knowledge"!==e.type)),m=p.filter((e=>"web"!==e.type)),g=s||p.some((e=>"web"===e.type));o=m.length>0||g?u&&a.length>0&&!i?{...o,searchScopes:[{type:"everything"}],useWebSearch:s}:{...o,searchScopes:p,useWebSearch:s}:{...o,searchScopes:[{type:"ai-knowledge"}],useWebSearch:s},n(o)}),[d,n,l,i]);return{normalizedValue:d,handleToggleScope:u,eligibleScopes:a,availableScopes:l}}({value:n,onChange:i,avoidEverythingScope:Boolean(r),originSource:d}),v=(0,o.useCallback)((e=>{e.connect({environment:u,connectorsFeatureAvailability:m})}),[u,m]),y=(0,c().K8)((()=>{const e={sections:[],addSection(e){e&&this.sections.push(e)}},t=h.filter((e=>["web","notion"].includes(e.type)));t.length>0&&e.addSection(Ne({key:"sources-section",title:(0,De.jsx)(D().sA,{...Ve.sourcesSection}),scopeModules:t,value:g,onToggleScope:f,onConnectScope:v,originSource:d}));const n=h.filter((e=>{if("web"!==e.type&&"notion"!==e.type)return!r||r.includes(e.type)}));return n.length>0&&e.addSection(Ne({key:"connectors-section",title:(0,De.jsx)(D().sA,{...Ve.connectorsSection}),scopeModules:n,value:g,onToggleScope:f,onConnectScope:v,originSource:d})),e.sections}),[h,g,f,v,r,d]);return(0,De.jsx)(ke().A,{menuType:Me().gu.Popup,width:s().A.isMobile&&"ai_block"===d?"100%":ze,maxHeight:s().A.isMobile&&"ai_block"===d?void 0:Re,footer:!a&&(0,De.jsx)(He,{buttonPopupParent:t,connectorsFeatureAvailability:m}),children:(0,De.jsx)(Ce().Ay,{type:Ce().Oh.Vertical,initialFocus:void 0,sections:y,style:s().A.isMobile&&"ai_block"===d?{width:"100%"}:void 0})})}function Ne(e){const{key:t,title:n,scopeModules:o,value:i,onToggleScope:r,onConnectScope:a,originSource:l}=e;return{key:t,render:e=>(0,De.jsx)(Ie().A,{...e,title:n,mobileTitleStyle:s().A.isMobile&&"ai_block"===l?{fontSize:17}:void 0}),items:o.map((e=>({key:e.type,render:t=>(0,De.jsx)(Fe,{...t,scope:e,value:i,onToggle:()=>r(e),onConnect:()=>a(e),originSource:l}),action:!e.isLoading()&&e.isAvailable({})?()=>r(e):e.isLoading()?()=>{}:()=>a(e)})))}}function Fe(e){const{scope:t,value:n,onToggle:o,onConnect:i,focused:r,originSource:a}=e,l=(0,d().eP)(),{isEnabled:u,isLoading:p,isAvailable:m,needsAuth:h}=(0,c().K8)((()=>({isEnabled:t.isEnabled(n),isLoading:t.isLoading(),isAvailable:t.isAvailable({}),needsAuth:t.needsAuth()})),[t,n]);let f=null;f=p?(0,De.jsx)(ve().k,{}):m?(0,De.jsx)(we().A,{on:u,disabled:!m,onClick:o,disallowTabbing:!0}):(0,De.jsx)(ie().D,{styleKey:(s().A.isMobile,"Caption/Regular"),colorVariant:"secondary",children:(0,De.jsx)(D().sA,{...Ve.connectLabel})});const v=(()=>{if((0,g().O)(t.icon.variants,"darkMode")){const e=t.icon;return(0,De.jsx)(Ae().Q,{iconGroup:e,overrideSize:()=>s().A.isMobile&&"ai_block"===a?22:18,variantName:"dark"===l?"darkMode":"default"})}return(0,De.jsx)(Ae().Q,{iconGroup:t.icon,overrideSize:()=>s().A.isMobile&&"ai_block"===a?22:18,variantName:"default"})})();return(0,De.jsx)(Se().A,{role:"menuitemcheckbox",focused:r,icon:v,title:t.displayName,onClick:()=>{p||(m?o():i())},disabled:p,right:f,dontShrinkRight:!0,buttonStyle:s().A.isMobile&&"ai_block"===a?{padding:"16px"}:void 0,titleStyle:s().A.isMobile&&"ai_block"===a?{fontSize:17}:void 0,rightStyle:s().A.isMobile&&"ai_block"===a?{marginInlineStart:"auto"}:void 0})}function He(e){const{buttonPopupParent:t,connectorsFeatureAvailability:n}=e,i=(0,l().v3)(),r=(0,fe().X)("notion_ai_workspace_settings"),s=(0,c().K8)((()=>0===(0,be().Nr)().length),[]),a=(0,o.useCallback)((()=>{(0,ye().pp)({environment:i,connector:"generic",analyticsFrom:"multi_search_scope_menu",connectorsFeatureAvailability:n}),t.close()}),[t,n,i]);return!r||s?null:(0,De.jsx)(Ie().A,{topBorderExtendToEdge:!0,children:(0,De.jsx)(Ee().$V,{onClick:a,focused:!1})})}var Oe=()=>n(486674),We=()=>n(847743);function Ue(){return(0,c().K8)((()=>{const e=(0,Be().J)({originSurface:"ai_block"}),t=e.find((e=>"slack"===e.type)),n=e.find((e=>"web"===e.type));return{isSlackConnected:(null==t?void 0:t.isAvailable({originSurface:"ai_block"}))??!1,isWebSearchAvailable:(null==n?void 0:n.isAvailable({originSurface:"ai_block"}))??!1}}),[])}var Ke=()=>n(805751),Ge=()=>n(187820),qe=()=>n(16006),$e=()=>n(125565);function Ye(e){const{onToggle:t,toggled:n}=e,[i,r]=(0,o.useState)(n),s=(0,o.useRef)(!1),a=(0,o.useCallback)((()=>{r((e=>!e)),s.current=!0}),[]);return(0,o.useEffect)((()=>{s.current&&(t(i),s.current=!1)}),[i,t]),(0,o.useEffect)((()=>{r(n)}),[n]),(0,De.jsxs)("div",{style:{marginTop:10,display:"flex",alignItems:"center",fontWeight:600,gap:10,justifyContent:"space-between"},children:[(0,De.jsx)($e().A,{children:(0,De.jsx)(D().sA,{id:"AiBlockV2.AutoGenerateOnTemplateDuplicationFieldToggle.Label",defaultMessage:"Autofill when template is duplicated"})}),(0,De.jsx)(we().A,{on:i,onClick:a})]})}var Qe=()=>n(970236),Ze=()=>n(149375),Xe=()=>n(245241),Je=()=>n(778078),et=()=>n(825972),tt=()=>n(135599),nt=()=>n(970585),ot=()=>n(64e3),it=()=>n(417392),rt=()=>n(305390),st=(n(18107),n(967357),()=>n(148307)),at=()=>n(992214),lt=()=>n(784892),ct=()=>n(416504),dt=()=>n(129852),ut=()=>n(881690),pt=()=>n(589222),mt=()=>n(631524),gt=()=>n(623580);const ht=(0,D().YK)({addContextPlaceholder:{id:"ContextTokenPlaceholderTypeahead.addContextPlaceholder",defaultMessage:"Add context"}}),ft={regular:24,spacious:31};function vt(e){const{disabled:t,currentlyFocusedItem:n,items:i,query:r,setQuery:s,isMenuOpen:a,hasContextsAlready:l,inputRef:c,heightVariant:u,hideCompactMode:p,isShowingContextWarning:m}=e,g=(0,D().tz)(),h=(0,o.useMemo)((()=>{var e;if(!r)return;const t=r.trimEnd(),o=r.slice(t.length);if(n)return n.title.toLowerCase().startsWith(t.toLowerCase())?`${t}${n.title.slice(t.length)}${o}`:r;const s=null===(e=i.find((e=>e.title.toLowerCase().startsWith(t.toLowerCase()))))||void 0===e?void 0:e.title;return s?`${t}${s.slice(t.length)}${o}`:r}),[i,r,n]),f=(0,o.useMemo)((()=>!!m||!a&&l),[m,a,l]),v=(0,o.useMemo)((()=>{if(r){const e=h??r,t=r.trimEnd(),n=r.slice(t.length);if(n.length>0){const t=n.replace(/ /g,"Â ");return e.trimEnd()+t}return e}return g.formatMessage(ht.addContextPlaceholder)}),[r,g,h]),y=(0,o.useRef)(null);(0,o.useEffect)((()=>{a||s("")}),[a,s]);const b=(0,d().IS)((e=>({container:{display:"flex",alignItems:"center",background:f?"transparent":e.inputBackground,borderRadius:4,paddingInlineStart:0,paddingInlineEnd:0,height:ft[u],width:"fit-content",...he().RC},backgroundInput:{height:void 0,display:"flex",alignItems:"center",borderRadius:6,paddingTop:4,paddingBottom:4,paddingInlineStart:4,paddingInlineEnd:10,fontSize:12,lineHeight:"18px",color:e.text.quaternary,whiteSpace:"nowrap",width:"auto"},foregroundInput:{boxShadow:"none",background:"transparent",position:"absolute",top:0,insetInlineStart:0,width:"100%",color:e.text.secondary,lineHeight:"18px",fontSize:12,paddingTop:4,paddingBottom:4,paddingInlineStart:4,paddingInlineEnd:10,overflow:"hidden",textOverflow:"clip",textIndent:0,scrollLeft:0},plusIcon:{fill:e.text.quaternary,width:14,height:14,marginInlineStart:4,...f&&{marginInlineEnd:0}}})),[f,u]);return p&&f?null:(0,De.jsx)(G().A,{disableTooltip:!f,textWrap:!0,style:{minWidth:200,padding:"4px 8px"},renderTooltip:()=>(0,De.jsx)(D().sA,{id:"ContextTokenPlaceholderTypeahead.tooltip",defaultMessage:"Add context to help Notion AI generate relevant content"}),render:o=>(0,De.jsxs)(mt().p,{...o,style:b.container,onClick:e.onFocus,disabled:t,children:[(0,De.jsx)(Ae().Q,{iconGroup:pt().h,variantName:"default",colorPalette:"gray",colorVariant:"primary",style:b.plusIcon}),f?void 0:(0,De.jsxs)("div",{style:{position:"relative"},children:[(0,De.jsx)("div",{ref:y,style:b.backgroundInput,children:v}),(0,De.jsx)(Ke().A,{capture:!0,debugName:"ContextTokenPlaceholderTypeahead",allowMenuList:!0,children:(0,De.jsx)(gt().A,{ref:c,disabled:t,style:b.foregroundInput,focus:a,value:r,onChange:e=>{s(e.target.value)},onKeyDown:t=>{"Tab"===t.key&&n&&(t.preventDefault(),e.onSuggestionSelected(n))},suppressFocusRing:!0,onFocus:()=>{e.onFocus()}})})]})]})})}const yt=(0,D().YK)({slackIconAriaLabel:{id:"AiBlockV2ContextTokenInput.slackIconAriaLabel",defaultMessage:"Slack"}});function bt(e){const{disabled:t,currentContexts:n,contextInputRef:i,inputRef:r,query:s,setQuery:a,searchResultMenuIsOpen:l,setSearchResultMenuIsOpen:u,handleUpdateContexts:p,searchResultMenuState:m,menuListStore:h,heightVariant:f,actionButtons:v,showEmptyStateWarning:y}=e,b=(0,ct().P)(),S=(0,D().tz)(),x=(0,c().K8)((()=>"notion"===m.type?m.results.map((e=>({key:e.blockStore.id,item:e,title:e.blockStore.getRenderTitle({userTimeZone:b,intl:S})??(0,at().L)(S)}))):"slack"===m.type?m.results.map((e=>({key:e.channel.id,title:e.channel.name,item:e}))):"choose"===m.type?[]:void(0,g().HB)(m)),[m,b,S]),k=(0,c().K8)((()=>{const e=h.state.focus.indexGlobal;return void 0!==e?x.at(e):void 0}),[h,x]),C=(0,o.useCallback)((e=>{p(n.filter((t=>!(0,R().n4)(t,e))))}),[n,p]),A=Boolean(v),I=(0,d().IS)((e=>({container:{position:"relative",borderRadius:6,boxShadow:e.inputBoxShadow,backgroundColor:"dark"===e.mode?e.palette.translucentGray[100]:"transparent",display:"flex",alignItems:"center",padding:4,gap:4,justifyContent:"space-between",cursor:t?"not-allowed":"pointer",width:"100%"},tokensWrapper:{display:"flex",alignItems:"center",flexWrap:"wrap",gap:4,flex:1,minHeight:ft[f],paddingInlineStart:A?4:void 0,paddingTop:4,paddingBottom:4},actionButtonsWrapper:{display:"flex",alignItems:"center",flexShrink:0,marginInlineEnd:4},firstLinePlaceholder:{position:"absolute",top:0,insetInlineStart:0,height:32,width:"100%"}})),[t,f,A]);return(0,De.jsxs)("div",{style:I.container,onClick:()=>{t||u(!0)},children:[(0,De.jsx)("div",{ref:i,style:I.firstLinePlaceholder}),(0,De.jsxs)("div",{style:I.tokensWrapper,children:[(0,De.jsx)(vt,{hideCompactMode:A,disabled:t,inputRef:r,query:s,setQuery:a,items:x,currentlyFocusedItem:k,onSuggestionSelected:e=>{l&&(p([e.item,...n]),a(""),u(!1))},hasContextsAlready:n.length>0,onFocus:()=>{u(!0)},isMenuOpen:l,heightVariant:f,isShowingContextWarning:y&&!l}),y&&!l?(0,De.jsx)(St,{disabled:t,heightVariant:f}):void 0,n.map((e=>(0,De.jsx)(xt,{contextItem:e,disabled:t,onRemove:t=>{C(e),t.preventDefault(),t.stopPropagation()}},function(e){if("currentPage"===e.type)return`currentPage-${e.blockStore.id}`;if("block"===e.type)return`block-${e.blockStore.id}`;if("slack"===e.type)return`slack-${e.channel.id}`}(e))))]}),v?(0,De.jsx)("div",{style:I.actionButtonsWrapper,children:v}):void 0]})}function St(e){const{disabled:t}=e,n=(0,d().IS)((e=>({container:{position:"relative",borderRadius:6,display:"flex",alignItems:"center",justifyContent:"space-between",cursor:t?"default":"pointer",paddingInlineStart:4},contentWrapper:{display:"flex",alignItems:"center",gap:8},placeholder:{color:e.yellow.text.secondary,fontSize:14,userSelect:"none"},exclamationIcon:{color:e.yellow.text.secondary,height:18,width:18}})),[t]);return(0,De.jsx)("div",{style:n.container,children:(0,De.jsxs)("div",{style:n.contentWrapper,children:[(0,dt().exclamationMarkCircleIcon)(n.exclamationIcon),(0,De.jsx)("div",{style:n.placeholder,children:(0,De.jsx)(D().sA,{defaultMessage:"AI blocks work better with context",id:"aiBlockV2ContextInput.placeholder"})})]})})}function xt(e){const{contextItem:t,disabled:n,onRemove:o}=e,i=(0,D().tz)(),r=(0,ct().P)(),s=(0,c().K8)((()=>"currentPage"===t.type||"block"===t.type?t.blockStore.getRenderTitle({userTimeZone:r,intl:i})??(0,at().L)(i):"slack"===t.type?t.channel.name:void(0,g().HB)(t)),[t,i,r]),a=(0,d().IS)((e=>({tokenWrapper:{backgroundColor:e.lightGrayBannerBackground,cursor:"pointer",paddingInlineStart:4,paddingInlineEnd:4,paddingTop:12,paddingBottom:12,borderRadius:4,maxWidth:150,height:24,color:e.text.secondary}})),[]);return(0,De.jsx)(ut().A,{disabled:n,style:a.tokenWrapper,format:lt().NY.Small,isSingle:!0,shouldShrink:!0,backgroundColor:"transparent",shouldWrap:!1,showRemoveButton:!0,onClickRemove:o,value:(0,De.jsx)(It,{contextItem:t}),showTooltip:"overflow",tooltip:s,tooltipPlacement:"bottom",tooltipOriginGap:0})}const kt=16,Ct=12;function At(){return(0,d().IS)((e=>({recordTitleStyle:{display:"flex",alignItems:"center",gap:4}})),[])}function It(e){const{contextItem:t}=e;return"currentPage"===t.type?(0,De.jsx)(wt,{blockStore:t.blockStore}):"block"===t.type?(0,De.jsx)(Mt,{blockStore:t.blockStore}):"slack"===t.type?(0,De.jsx)(Tt,{channel:t.channel}):(0,g().HB)(t)}function wt(e){const{blockStore:t}=e,n=At(),o=(0,c().K8)((()=>t.getIcon()),[t]),i=(0,c().K8)((()=>(0,Ge().Te)(t)),[t]);return(0,De.jsxs)("div",{style:n.recordTitleStyle,children:[(0,De.jsx)(Ge().B6,{disabled:!0,icon:o,iconRecordCategory:i,isEmptyPage:!1,size:kt}),(0,De.jsx)("div",{style:he().RC,children:(0,De.jsx)(D().sA,{defaultMessage:"Current page",id:"ContextTokenInput.currentPage"})})]})}function Mt(e){const{blockStore:t}=e,n=At(),o=(0,c().K8)((()=>t.getIcon()),[t],{useDeepEqual:!0}),i=(0,c().K8)((()=>(0,Ge().Te)(t)),[t]);return(0,De.jsxs)("div",{style:n.recordTitleStyle,children:[(0,De.jsx)(Ge().B6,{disabled:!0,icon:o,iconRecordCategory:i,isEmptyPage:!1,size:kt}),(0,De.jsx)(qe().A,{store:t})]})}function Tt(e){const{channel:t}=e,n=At(),o=(0,D().tz)();return(0,De.jsxs)("div",{style:n.recordTitleStyle,children:[(0,De.jsx)("img",{width:Ct,src:st().A.images.externalIntegrations.slackIconPng,alt:o.formatMessage(yt.slackIconAriaLabel)}),(0,De.jsx)("div",{children:t.name})]})}const jt=(0,D().YK)({notionContextLabel:{id:"notionContextLabel",defaultMessage:"Notion"},slackContextLabel:{id:"slackContextLabel",defaultMessage:"Slack"}}),Pt="notion";function Bt(e){var t;const{currentContexts:n,handleUpdateContexts:i,disabled:r,showEmptyStateWarning:s,heightVariant:a,defaultSearchContext:d,onSearchContextSelected:u,actionButtons:p,excludeBlockTypes:m}=e,[h,f]=(0,o.useState)(!1),v=(0,c().uB)(void 0,nt().A),y=(0,c().K8)((()=>["notion",...(0,be().wd)().filter(Dt)]),[]),[b,S]=(0,o.useState)(""),{searchResultMenuState:x,setCurrentSearchContext:k}=function(e){const{availableSearchContexts:t,currentContexts:n,query:i,defaultSearchContext:r,excludeBlockTypes:s}=e,a=t.length>1,[d,u]=(0,o.useState)(r||(a?void 0:Pt)),p=(0,l().v3)(),m=(0,je().r)(),h=(0,c().K8)((()=>et().NK.state.map((e=>e.store))),[]),{results:f,isResultsLoading:v}=(0,tt().W)({source:"ai_block_v2_page_context_search",query:i,limit:20,type:Xe().Vz.BlocksInSpace,excludedBlockIds:n.filter((e=>"slack"!==e.type)).map((e=>e.blockStore.id)),filters:{requireEditPermissions:!1,excludeTemplates:!1},options:{disable:!i||"notion"!==d},peopleBlocksToInclude:"none"}),y=(0,o.useMemo)((()=>f.map((e=>e.store))),[f]),b=(0,o.useMemo)((()=>i?v?"searching":"loaded":"default"),[i,v]),S=(0,c().O$)(Y().AppStoreMainEditorCurrentBlockStore),x=(0,c().K8)((()=>{let e;if(i)e=y??[];else{e=[...S?[S]:[],...h]}return s&&s.length>0?e.filter((e=>{const t=e.getType();return!t||!s.includes(t)})):e}),[i,y,h,S,s]);(0,o.useEffect)((()=>{m&&(0,oe().Hn)({environment:p,spaceId:m,externalAuthConfig:{type:"universal",app:"slack",spaceId:m}})}),[p,m]);const{channels:k,isFetchingSlack:C}=(0,c().K8)((()=>{if(!m)return{channels:Q().m.channels,isFetchingSlack:Q().m.fetching};const e=Q().c.getStateForBot({type:"universal",app:"slack",spaceId:m});return{channels:e.channels,isFetchingSlack:e.fetching}}),[m]),A=(0,o.useMemo)((()=>Object.values(k).map((e=>({type:"slack",channel:e})))),[k]),[I,w]=(0,o.useState)([]);(0,o.useEffect)((()=>{0===I.length&&A.length>0&&w(A)}),[A,I.length]);const M=function(e,t){const[n,i]=(0,o.useState)(e);return(0,o.useEffect)((()=>{const n=setTimeout((()=>i(e)),t);return()=>clearTimeout(n)}),[e,t]),n}(i,300),[T,j]=(0,o.useState)([]);(0,o.useEffect)((()=>{let e=!1;async function t(){if("slack"===d&&M){const t=await async function(e,t,n,o){const i=100,r=[];for(let s=0;s<t.length;s+=i){const a=t.slice(s,s+i);await new Promise((e=>setTimeout(e,0)));const l=(0,Je().Ay)(e,a,n,o);r.push(...l)}return(0,Je().Ay)(e,r,n,o)}(M,A,(e=>e.channel.name));e||j(t)}else j(I)}return t(),()=>{e=!0}}),[d,M,A,I]);const P=(0,o.useDeferredValue)(M),B=(0,o.useMemo)((()=>"slack"===d&&P?T:I),[d,P,I,T]),_=(0,o.useMemo)((()=>{if(!d)return{type:"choose"};const e=x.map((e=>({type:e.id===(null==S?void 0:S.id)?"currentPage":"block",blockStore:e})));if("slack"===d){let e="default";return i&&(e=C?"searching":"loaded"),{type:d,status:e,results:B}}if("notion"===d)return{type:d,status:b,results:e};(0,g().HB)(d)}),[d,i,x,B,b,C,S]);return{setCurrentSearchContext:u,searchResultMenuState:_t({currentContexts:n,state:_})}}({availableSearchContexts:y,currentContexts:n,query:b,defaultSearchContext:d,excludeBlockTypes:m}),C=(0,o.useRef)(null),A=(0,o.useRef)(null);return(0,o.useEffect)((()=>{e.forceOpen&&d&&(f(!0),k(d),null==u||u())}),[e.forceOpen,d,k]),(0,De.jsx)(it().Ay,{popupType:it().nl.Popup,open:h,onDismiss:()=>{f(!1)},placementToOrigin:"bottom",alignmentToOrigin:"start",originRect:null==A||null===(t=A.current)||void 0===t?void 0:t.getBoundingClientRect(),trapFocus:!1,sameWidthAsOrigin:!0,origin:(0,De.jsx)(bt,{disabled:r,currentContexts:n,inputRef:C,handleUpdateContexts:i,searchResultMenuIsOpen:h,setSearchResultMenuIsOpen:f,menuListStore:v,query:b,setQuery:S,searchResultMenuState:x,contextInputRef:A,heightVariant:a,actionButtons:p,showEmptyStateWarning:s}),render:()=>(0,De.jsx)(Et,{query:b,setQuery:S,availableSearchContexts:y,onSelectResult:e=>{i([e,...n]),f(!1),S("")},currentContexts:n,setCurrentSearchContext:e=>{var t;k(e),null===(t=C.current)||void 0===t||t.focus()},state:x,menuListStore:v})})}function _t(e){const{currentContexts:t,state:n}=e,o=new Set,i=new Set;for(const r of t)"block"===r.type?o.add(r.blockStore.id):"slack"===r.type?i.add(r.channel.id):"currentPage"===r.type?o.add(r.blockStore.id):(0,g().HB)(r);if("choose"===n.type)return n;if("notion"===n.type){const e=(0,R().hS)(n.results.filter((e=>!o.has(e.blockStore.id))),(e=>e.blockStore.id));return{...n,results:e}}if("slack"===n.type){const e=n.results.filter((e=>!i.has(e.channel.id))).sort(((e,t)=>e.channel.name.localeCompare(t.channel.name)));return{...n,results:e}}(0,g().HB)(n)}function Et(e){const{onSelectResult:t,availableSearchContexts:n,state:i,setCurrentSearchContext:r,menuListStore:s,query:a,setQuery:l}=e,c=(0,D().tz)(),u=(0,d().IS)((e=>({backText:{color:e.text.tertiary,fontSize:12},backContentWrap:{display:"flex",alignItems:"center",cursor:"pointer",marginTop:4,marginInlineStart:8}})),[]),p=(0,o.useMemo)((()=>(0,Je().Ay)(a,n,(e=>"notion"===e?c.formatMessage(jt.notionContextLabel):"slack"===e?c.formatMessage(jt.slackContextLabel):void(0,g().HB)(e)))),[n,a,c]),m=(0,o.useMemo)((()=>{const e={key:"no-results",render:()=>(0,De.jsx)(ot().A,{title:(0,De.jsx)(D().sA,{defaultMessage:"No results found",id:"contextTokenInput.searchResultMenu.noResults.message"})}),action:()=>{}};if("choose"===i.type)return 0===p.length?[e]:p.map((e=>({key:e,render:t=>(0,De.jsx)(zt,{...t,searchContext:e}),action:()=>{r(e),l("")}})));const n=[];return"default"===i.status||"loaded"===i.status||"searching"===i.status?0===i.results.length?"searching"===i.status?(n.push({key:"loading",render:()=>(0,De.jsx)(ot().A,{title:(0,De.jsx)(D().sA,{defaultMessage:"Loadingâ¦",id:"contextTokenInput.searchResultMenu.loading.message"})}),action:()=>{}}),n):(n.push(e),n):n.concat(i.results.map((e=>"block"===e.type?{key:e.blockStore.id,render:t=>(0,De.jsx)(rt().A,{...t,store:e.blockStore}),action:()=>{t(e)}}:"slack"===e.type?{key:e.channel.id,render:t=>(0,De.jsx)(oe().qj,{...t,channel:e.channel}),action:()=>{t(e)}}:"currentPage"===e.type?{key:`${e.blockStore.id}-currentPage`,render:t=>(0,De.jsx)(rt().A,{...t,store:e.blockStore,right:(0,De.jsx)(Qe().E,{content:(0,De.jsx)(D().sA,{id:"ContextTokenInput.currentPage",defaultMessage:"Current page"})})}),action:()=>{t(e)}}:void(0,g().HB)(e)))):(0,g().HB)(i.status)}),[i,p,r,t,l]);return(0,De.jsx)(ke().A,{menuType:Me().gu.Popup,maxHeight:200,header:"choose"!==i.type&&n.length>1&&(0,De.jsx)("div",{style:u.backContentWrap,children:(0,De.jsx)(K().A,{ariaLabel:c.formatMessage({id:"ContextTokenInput.backButton",defaultMessage:"Back"}),icon:Ze().v,onClick:()=>{r(void 0)},caption:(0,De.jsx)("div",{style:u.backText,children:(0,De.jsx)(D().sA,{id:"ContextTokenInput.backButton",defaultMessage:"Back"})}),captionStyle:{textTransform:void 0,letterSpacing:void 0}})}),children:(0,De.jsx)(Ce().Ay,{type:Ce().Oh.Vertical,initialFocus:0,store:s,sections:[{key:"search-results",render:e=>(0,De.jsx)(Ie().A,{...e}),items:m}]})})}function Dt(e){return"slack"===e}const zt=o.forwardRef(((e,t)=>{const{searchContext:o,...i}=e,r=(0,D().tz)();let s,a;return"notion"===o?s=(0,De.jsx)(u().I,{icon:n(558687).notionIcon,size:"default"}):"slack"===o?s=(0,De.jsx)(u().I,{icon:n(888382).slackIcon,size:"default"}):(0,g().HB)(o),"notion"===o?a=r.formatMessage(jt.notionContextLabel):"slack"===o?a=r.formatMessage(jt.slackContextLabel):(0,g().HB)(o),(0,De.jsx)(Se().A,{ref:t,...i,icon:s,title:a})}));zt.displayName="SearchContextMenuItem";var Rt=()=>n(908006),Vt=()=>n(395361),Lt=()=>n(201980),Nt=()=>n(829300),Ft=()=>n(319975),Ht=()=>n(190033),Ot=()=>n(515692),Wt=()=>n(220331),Ut=()=>n(38337),Kt=()=>n(792540),Gt=()=>n(794144),qt=()=>n(693202),$t=()=>n(712855);const Yt=Object.freeze({property:!0});function Qt(e){const{store:t,minTextHeight:n=50,placeholder:i,showAtMentionMenu:r,fontSize:s=14,fontWeight:u=500,disabled:p,context:m,updateContexts:g}=e,h=(0,l().v3)(),f=(0,c().O$)(qt().default),v=(0,o.useMemo)((()=>{const e=new Set;return null==m||m.forEach((t=>{"page"!==t.type&&"currentPage"!==t.type||e.add(t.pageId)})),e}),[m]),y=(0,o.useCallback)((async()=>{const e=qt().default.state;"editing"===e.mode&&(0,Gt().K)(e.multiSelection)&&e.multiSelection.start.store===t||((0,Ht().z)({store:t}),await Rt().default.afterNextFlush())}),[t]),b=(0,o.useCallback)((e=>{p||(e.preventDefault(),e.stopPropagation(),async function(){await y(),await Rt().default.afterNextFlush(),Nt().Gf({environment:h,mentionTypes:Ot().Ap,usePopupOnMobile:!0,mentionSectionOrdering:Ot().h2})}())}),[p,h,y]),S=(0,o.useCallback)((()=>{const e=a().e.withListenerIgnored((()=>t.getValue()));if(e){const t=(0,Lt().moK)(e).filter((e=>!v.has(e.id))).map((e=>({type:"page",pageId:e.id})));g([...m??[],...t])}}),[m,v,t,g]),x=(0,Vt().Y)(S,200);(0,o.useEffect)((()=>{!async function(){await Rt().default.afterNextFlush(),await Rt().default.afterNextFlush(),(0,Ht().z)({store:t})}()}),[t]);const k=(0,o.useCallback)((()=>{"editing"===f.mode&&U().createAndCommit({userAction:"AiBlockV2InstructionEditor.handleEnter",environment:h,canUndo:!0,perform:e=>{Ft().$D({environment:h,editorMode:"default",store:t,string:"\n",multiSelection:f.multiSelection,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:e})}})}),[h,t,f]),C=(0,d().IS)((e=>({inputWrap:{display:"flex",flexDirection:"column",justifyContent:"space-between",boxShadow:e.inputBoxShadow,minHeight:n,backgroundColor:"dark"===e.mode?e.palette.translucentGray[100]:"transparent",borderRadius:6,overflow:"inherit",flexGrow:1,flexShrink:1,paddingInlineStart:6,paddingInlineEnd:6,paddingBottom:6},textContainer:{fontSize:s,fontWeight:u,flexGrow:1,padding:"4px 0",maxHeight:240,overflow:"auto"},placeholder:{color:e.text.quaternary}})),[s,u,n]);return(0,De.jsxs)("div",{style:C.inputWrap,className:Ut().CCX,children:[(0,De.jsx)($t().A,{onChange:x,placeholder:i,placeholderStyle:C.placeholder,style:C.textContainer,disabled:p,store:t,pasteBehavior:"inline",disableSlashCommands:!0,disableEmbedMenu:!0,disableEmojiCommands:!1,disableComment:!0,disableSelectAllBlocks:!1,disableSelectionDrag:!0,disableMobileActionBar:!0,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!0,disableSuggestEdit:!0,inPageFind:Kt().Os.none,onEnter:k,disabledMentionTypes:Yt}),r?(0,De.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",flexDirection:"column",alignItems:"flex-end"},children:(0,De.jsx)(Wt().q,{onClick:b})}):void 0]})}var Zt=()=>n(792485),Xt=()=>n(929219),Jt=()=>n(973647),en=()=>n(68465),tn=()=>n(589994);const nn=(0,D().YK)({disabledAiCredits:{id:"AiBlockV2.disabled.aiCredits",defaultMessage:"AI is currently disabled"},currentlyGenerating:{defaultMessage:"Generation in progress",id:"AiBlockV2.currentlyGenerating"},cannotEditBlock:{defaultMessage:"This block cannot be edited",id:"AiBlockV2.cannotEditBlock"},insufficientPermissions:{defaultMessage:"You do not have permission to generate this block",id:"AiBlockV2.insufficientPermissions"},noInstructions:{defaultMessage:"No instructions provided",id:"AiBlockV2.noInstructions"},offline:{defaultMessage:"Unavailable while offline",id:"AiBlockV2.offline"},syncing:{defaultMessage:"Saving changes...",id:"AiBlockV2.saving"}});function on(e){const{store:t,isGenerating:n,permissionLevelCalculator:o}=e,i=(0,Zt().S)(),r=(0,D().tz)(),{blockConfiguration:s}=rn(t),a=!(0,c().O$)(Xt().e),l=function(e){return(0,c().K8)((()=>tn().transactionQueue.isPendingTransactionForRecord(e.pointer)),[e])}(t);return(0,c().K8)((()=>{const e=null==i?void 0:i.publicEditModeStore.state;return(0,en().ZE)(e)?n?{isDisabled:!1,tooltipMessage:r.formatMessage(nn.currentlyGenerating)}:a?{isDisabled:!0,disabledMessage:r.formatMessage(nn.offline)}:l?{isDisabled:!0,disabledMessage:r.formatMessage(nn.syncing)}:!t.canEdit()||t.isNonEditableState()?{isDisabled:!0,disabledMessage:r.formatMessage(nn.cannotEditBlock)}:o.canGenerateBlock()?"summarizeThisPage"===s.type||"extractKeyPointsFromThisPage"===s.type||"custom"!==s.type||s.autofillInstructions?{isDisabled:!1}:{isDisabled:!0,disabledMessage:r.formatMessage(nn.noInstructions)}:{isDisabled:!0,disabledMessage:r.formatMessage(nn.insufficientPermissions)}:{isDisabled:!0,disabledMessage:r.formatMessage(nn.disabledAiCredits)}}),[null==i?void 0:i.publicEditModeStore,n,t,o,s,r,a,l])}function rn(e){const t=(0,l().v3)();return{blockConfiguration:(0,c().K8)((()=>{var t;const n=null===(t=Y().default.state.sidebarSpaceStore)||void 0===t?void 0:t.getRecordModel;return function(e){const{model:t,getRecordModel:n}=e;if(!t)return b().Z0;const o=new(b().QN)(n),i=o.migrateToLatest({model:t});if(Jt().Q.isFail(i))return b().Z0;return i.value}({model:e.getModel(),getRecordModel:n})}),[e]),updateBlockConfiguration:(0,o.useCallback)((n=>{U().createAndCommit({userAction:"AiBlock.updateBlockConfiguration",environment:t,canUndo:!0,perform:t=>{U().applyOperation({store:e,operation:T().op.update({pointer:e.pointer,path:["format"],args:{ai_block_configuration_menu:n}}),transaction:t})}})}),[t,e])}}function sn(e){const t=(0,o.useRef)(void 0),{blockConfiguration:n,updateBlockConfiguration:i}=rn(e);return{updateBlockSkillType:(0,o.useCallback)((e=>{var o;if(e===n.type)return;if(e===(null===(o=t.current)||void 0===o?void 0:o.type))return i(t.current),void(t.current=n);let r;switch(e){case"custom":r={type:"custom",version:3,autofillInstructions:n.autofillInstructions,context:n.context,searchScopes:n.searchScopes};break;case"extractKeyPointsFromThisPage":r={...n,type:"extractKeyPointsFromThisPage",version:3};break;case"summarizeThisPage":r={...n,type:"summarizeThisPage",version:3};break;default:(0,g().HB)(e)}t.current=n,i(r)}),[n,i]),currentSkillType:n.type}}const an=(0,D().YK)({custom:{id:"AiBlockV2.inlineConfig.skillSelector.custom",defaultMessage:"Custom output"},summarize:{id:"AiBlockV2.inlineConfig.skillSelector.pageSummary",defaultMessage:"Page summary"},extractKeyPoints:{id:"AiBlockV2.inlineConfig.skillSelector.keyPoints",defaultMessage:"Key points"},selectOutputType:{id:"AiBlockV2.inlineConfig.skillSelector.selectOutputType",defaultMessage:"Select output type"},summarizePlaceholder:{id:"AiBlockV2.inlineConfig.skillSelector.summarizePlaceholder",defaultMessage:"Create a summary about this page"},extractKeyPointsPlaceholder:{id:"AiBlockV2.inlineConfig.skillSelector.extractKeyPointsPlaceholder",defaultMessage:"Find key points on this page"},customAutofillInstructionsPlaceholder:{id:"AiBlockV2.inlineConfig.customAutofillInstructionsPlaceholder",defaultMessage:"Describe the content that should be generated. Use â@â to mention people, pages, or dates"},currentPageOnlyPrefix:{id:"AiBlockV2.inlineConfig.contextType.currentPageOnlyPrefix",defaultMessage:"Current page only â"},currentPageOnlyPrefixNoEmdash:{id:"AiBlockV2.inlineConfig.contextType.currentPageOnlyPrefixNoEmdash",defaultMessage:"Current page â"},notion:{id:"AiBlockConfigView.source.notion",defaultMessage:"Notion"},slack:{id:"AiBlockConfigView.source.slack",defaultMessage:"Slack"},web:{id:"AiBlockConfigView.source.web",defaultMessage:"Web search"},noSources:{id:"AiBlockConfigView.source.noSources",defaultMessage:"Donât search any sources"}});function ln(e){const{store:t,disabled:n,setSelectedContextType:i,inferredCustomContextType:r}=e,a=(0,d().IS)((e=>({dropdown:{display:"flex",alignItems:"center",padding:"8px 12px",border:`1px solid ${e.border.secondary}`,borderRadius:6,marginBottom:4,gap:4,cursor:"pointer",fontSize:14,minHeight:36,justifyContent:"space-between",...n?{backgroundColor:e.inputBackground,cursor:"not-allowed"}:{}},dropdownText:{color:e.text.primary,display:"flex",alignItems:"center",gap:8},optionIcon:{marginInlineEnd:8,fill:e.icon.tertiary,width:16,height:16},mobileMenuItemStyle:{borderBottom:`1px solid ${e.border.secondary}`}})),[n]),l=[{key:"custom",label:(0,De.jsx)(D().sA,{...an.custom}),icon:()=>(0,me().L)({...a.optionIcon,fill:void 0})},{key:"summarizeThisPage",label:(0,De.jsx)(D().sA,{...an.summarize}),icon:()=>(0,ge().P)({...a.optionIcon,fill:void 0})},{key:"extractKeyPointsFromThisPage",label:(0,De.jsx)(D().sA,{...an.extractKeyPoints}),icon:()=>(0,de().q)({...a.optionIcon,fill:void 0})}],{currentSkillType:c,updateBlockSkillType:p}=sn(t),m=l.find((e=>e.key===c)),g=(0,o.useCallback)(((e,t)=>{p(e),i("custom"!==e?"current_page":r),t()}),[p,i,r]);return(0,De.jsx)(xe().A,{popupType:s().A.isMobile?xe().z.BottomSheet:xe().z.Popup,bottomSheetInitialState:"half",placementToOrigin:"bottom",trapFocus:!1,sameWidthAsOrigin:!0,disabled:n,renderOrigin:e=>(0,De.jsxs)("div",{...(0,Te().A)(e,{onClick:e=>e.stopPropagation()}),style:a.dropdown,children:[(0,De.jsxs)("span",{style:a.dropdownText,children:[null==m?void 0:m.icon(),(null==m?void 0:m.label)||(0,De.jsx)(D().sA,{...an.selectOutputType})]}),(0,De.jsx)(u().I,{icon:se().arrowChevronSingleDownSmallIcon,size:"sm",colorVariant:"tertiary"})]}),render:e=>{const t={menuType:Me().gu.Popup},n=[{key:"skillOptions",render:e=>(0,De.jsx)(Ie().A,{...e}),items:l.map(((t,n)=>({key:t.key,action:()=>{g(t.key,e.close)},render:e=>(0,De.jsx)(Se().A,{...e,title:t.label,left:t.icon(),isChecked:t.key===c,mobileIconStyle:{height:28,width:28},titleStyle:s().A.isMobile?{fontSize:17,paddingTop:16,paddingBottom:16}:void 0,style:s().A.isMobile&&n<l.length-1?a.mobileMenuItemStyle:void 0})})))}],o=(0,De.jsx)(ke().A,{...t,children:(0,De.jsx)(Ce().Ay,{initialFocus:void 0,type:Ce().Oh.Vertical,sections:n,style:{position:"relative"}})});return s().A.isMobile?(0,De.jsxs)(De.Fragment,{children:[(0,De.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:22,marginBottom:14},children:(0,De.jsx)(ie().D,{styleKey:"Title-sm/Semibold",children:(0,De.jsx)(D().sA,{id:"AiBlockV2.inlineConfig.title",defaultMessage:"Generate"})})}),o]}):o}})}function cn(e){const{handleSaveButton:t,saveButtonDisabledMessage:n}=e,o=(0,d().IS)((()=>({buttonContainer:{zIndex:100,display:"flex",gap:8,alignItems:"center"}})),[]),i=void 0!==n;return(0,De.jsx)("div",{style:o.buttonContainer,children:(0,De.jsx)(G().A,{disableTooltip:!i,renderTooltip:()=>(0,De.jsx)("div",{children:n}),placement:"bottom",render:e=>(0,De.jsx)(p().A,{colorPalette:"blue",...e,onClick:t,size:"md",disabled:i,children:(0,De.jsx)(D().sA,{id:"AiBlockV2.inlineConfig.done",defaultMessage:"Done"})})})})}function dn({store:e}){const t=(0,c().K8)((()=>e.getIcon()),[e]),n=(0,c().K8)((()=>e.isEmptyPage()),[e]),o=(0,c().K8)((()=>(0,Ge().Te)(e)),[e]),i=(0,d().IS)((e=>({pageTitlePreview:{color:e.gray.text.tertiary}})),[]);return(0,De.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,De.jsx)(Ge().B6,{disabled:!0,icon:t,iconRecordCategory:o,isEmptyPage:n,size:16}),(0,De.jsx)(qe().A,{style:i.pageTitlePreview,store:e})]})}function un(e){const{blockConfiguration:t,updateBlockConfiguration:n,editDisabledLackOfPermissions:i,selectedContext:r,updateSelectedContext:s}=e,a=(0,D().tz)(),l=(0,o.useMemo)((()=>"custom"!==t.type),[t.type]),u=(0,d().IS)((e=>({textInputContainer:{border:`1px solid ${e.border.secondary}`,borderRadius:6,padding:"12px",minHeight:150,height:150,position:"relative",...l&&{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:e.inputBackground,color:e.gray.text.tertiary,pointerEvents:"none"}},textInput:{fontSize:14,fontWeight:400,padding:"4px 0",overflow:"auto"}})),[l]),p=(0,o.useRef)(!1),m=(0,o.useCallback)((e=>{"custom"===t.type&&(p.current?p.current=!1:n({...t,autofillInstructions:e}))}),[t,n]),{store:h,setValue:f}=(0,We().AI)({initialValue:"custom"===t.type?t.autofillInstructions:void 0,onChange:m}),v="custom"===t.type?t.autofillInstructions:void 0,y=(0,c().K8)((()=>h.getValue()),[h]);(0,o.useEffect)((()=>{R().n4(v,y)||(p.current=!0,f(v))}),[v,y,f]);const b=a.formatMessage(function(e){switch(e){case"summarizeThisPage":return an.summarizePlaceholder;case"extractKeyPointsFromThisPage":return an.extractKeyPointsPlaceholder;case"custom":return an.customAutofillInstructionsPlaceholder;default:(0,g().HB)(e)}}(t.type)),S=t.type;switch(S){case"summarizeThisPage":case"extractKeyPointsFromThisPage":return(0,De.jsx)("div",{style:u.textInputContainer,children:(0,De.jsx)("div",{style:u.textInput,children:b})});case"custom":return(0,De.jsx)(Qt,{store:h,placeholder:b,minTextHeight:150,fontSize:14,fontWeight:400,disabled:i,context:r,updateContexts:s,showAtMentionMenu:!0});default:(0,g().HB)(S)}}function pn(e){const{blockConfiguration:t,updateBlockConfiguration:n,editDisabledLackOfPermissions:i,setSelectedContextType:r,selectedContextType:a,currentPageScope:l}=e,p=(0,D().tz)(),{isSlackConnected:m}=Ue(),h="custom"===t.type,f=i||!h,v=(0,d().IS)((e=>({dropdown:{display:"flex",alignItems:"center",border:`1px solid ${e.border.secondary}`,borderRadius:6,padding:"8px 12px",gap:4,cursor:"pointer",fontSize:14,minHeight:36,justifyContent:"space-between",...f&&{backgroundColor:e.inputBackground,color:e.gray.text.tertiary,cursor:"not-allowed"}},dropdownText:{color:e.text.primary,display:"flex",alignItems:"center",gap:8},optionIcon:{marginInlineEnd:8,fill:e.icon.tertiary,width:s().A.isMobile?22:16,height:s().A.isMobile?22:16},currentPageInfoWrapper:{...he().RC,lineHeight:1.2,paddingBottom:2},mobileMenuItemStyle:{borderBottom:`1px solid ${e.border.secondary}`}})),[f]),y=s().A.isMobile,b=(0,c().K8)((()=>{const e=(0,Oe().a)();return[{key:"current_page",label:e?(0,De.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,De.jsx)("span",{children:p.formatMessage(y?an.currentPageOnlyPrefixNoEmdash:an.currentPageOnlyPrefix)}),(0,De.jsx)("div",{style:v.currentPageInfoWrapper,children:(0,De.jsx)(dn,{store:e})})]}):p.formatMessage({id:"aiBlock.contextType.currentPage",defaultMessage:"Context"}),icon:()=>(0,pe().n)({...v.optionIcon,fill:void 0})},{key:"specified_context",label:p.formatMessage({id:"aiBlock.contextType.specifiedContext",defaultMessage:"Specified context"}),icon:()=>(0,le().checkmarkCircleIcon)({...v.optionIcon,fill:void 0})}]}),[p,y,v]),S=b.find((e=>e.key===a))??b[0],x=(0,o.useCallback)((e=>{if(r(e),!h)return;let o,i;switch(e){case"current_page":o=l,i=[];break;case"specified_context":o=t.context&&t.context.length>0?t.context:void 0;const n=t.searchScopes??[];i=n.length>0?n:[{type:"notion"},...m?[{type:"slack"}]:[]];break;default:(0,g().HB)(e)}n({...t,type:"custom",context:o,searchScopes:i})}),[t,n,l,h,r,m]),k=t.type;switch(k){case"summarizeThisPage":case"extractKeyPointsFromThisPage":return(0,De.jsxs)("div",{style:v.dropdown,children:[(0,De.jsxs)("span",{style:v.dropdownText,children:[S.icon(),S.label]}),(0,De.jsx)(u().I,{icon:se().arrowChevronSingleDownSmallIcon,size:"sm",colorVariant:"tertiary"})]});case"custom":return(0,De.jsx)(xe().A,{popupType:s().A.isMobile?xe().z.BottomSheet:xe().z.Popup,bottomSheetInitialState:"half",disabled:f,placementToOrigin:"bottom",trapFocus:!1,sameWidthAsOrigin:!0,renderOrigin:e=>(0,De.jsxs)("div",{...(0,Te().A)(e,{onClick:e=>e.stopPropagation()}),style:v.dropdown,children:[(0,De.jsxs)("span",{style:v.dropdownText,children:[S.icon(),S.label]}),(0,De.jsx)(u().I,{icon:se().arrowChevronSingleDownSmallIcon,size:"sm",colorVariant:"tertiary"})]}),render:e=>{const t={menuType:Me().gu.Popup},n=[{key:"contextOptions",render:e=>(0,De.jsx)(Ie().A,{...e}),items:b.map(((t,n)=>({key:t.key,action:()=>{x(t.key),e.close()},render:e=>(0,De.jsx)(Se().A,{...e,title:t.label,left:t.icon(),isChecked:t.key===a,mobileIconStyle:{height:28,width:28},titleStyle:s().A.isMobile?{fontSize:17,paddingTop:12,paddingBottom:12}:void 0,style:s().A.isMobile&&n<b.length-1?v.mobileMenuItemStyle:void 0})})))}],o=(0,De.jsx)(ke().A,{...t,children:(0,De.jsx)(Ce().Ay,{initialFocus:void 0,type:Ce().Oh.Vertical,sections:n,style:{position:"relative"}})});return s().A.isMobile?(0,De.jsxs)(De.Fragment,{children:[(0,De.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:22,marginBottom:14},children:(0,De.jsx)(ie().D,{styleKey:"Title-sm/Semibold",children:(0,De.jsx)(D().sA,{id:"AiBlockV2.inlineConfig.contextType.title",defaultMessage:"Using information from"})})}),o]}):o}});default:(0,g().HB)(k)}}function mn(e){const{selectedContext:t,store:n,updateSelectedContext:i,editDisabledLackOfPermissions:r}=e,s=(0,l().v3)(),[a,u]=(0,o.useState)(void 0),p=(0,d().IS)((e=>({contextSection:{marginTop:7},contextInputWrapper:{position:"relative",display:"flex",alignItems:"center"},symbolButton:{width:24,height:24,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,cursor:"pointer",backgroundColor:"transparent",border:"none",padding:0},symbolIcon:{width:18,height:18,fill:e.icon.tertiary}})),[]),[m,h]=(0,o.useState)(!1),v=(0,o.useCallback)((e=>{u(e),h(!0)}),[]),y=(0,je().r)(),b=(0,c().K8)((()=>{if(!(0,be().wd)().includes("slack"))return!1;if(y){if(Q().c.getStateForBot({type:"universal",app:"slack",spaceId:y}).failed)return!1}return!0}),[y]),S=(0,D().tz)();return(0,De.jsx)("div",{style:p.contextSection,children:(0,De.jsx)(Ke().A,{debugName:"AiBlockConfigViewContextInput",capture:!0,allowMenuList:!1,allowEsc:!0,allowEnter:!0,children:(0,De.jsx)("div",{style:p.contextInputWrapper,children:(0,De.jsx)(Bt,{heightVariant:"regular",defaultSearchContext:a,onSearchContextSelected:()=>{u(void 0),h(!1)},forceOpen:m,currentContexts:(null==t?void 0:t.map((e=>{if("page"===e.type||"collection"===e.type){const t=n.getSpaceId();return{type:"block",blockStore:new(Z().B)(s,{table:f().ev,id:e.pageId,spaceId:t})}}if("currentPage"===e.type){const t=n.getSpaceId();return{type:"currentPage",blockStore:new(Z().B)(s,{table:f().ev,id:e.pageId,spaceId:t})}}if("slack"===e.type)return e;(0,g().HB)(e)})))||[],handleUpdateContexts:e=>{const t=[];for(const n of e)if("block"===n.type){const e=n.blockStore.getCollectionStores();e&&e.length>0?t.push(...e.map((e=>({pageId:n.blockStore.id,collectionId:e.id,type:"collection"})))):t.push({pageId:n.blockStore.id,type:"page"})}else"slack"===n.type?t.push(n):"currentPage"===n.type?t.push({type:"currentPage",pageId:n.blockStore.id}):(0,g().HB)(n);i(t)},disabled:r,showEmptyStateWarning:void 0===t||0===t.length,excludeBlockTypes:[re().xd.collectionView,re().xd.collectionViewPage],actionButtons:r?void 0:(0,De.jsxs)(De.Fragment,{children:[b?(0,De.jsx)(K().A,{ariaLabel:S.formatMessage(an.slack),icon:ue().L,style:p.symbolButton,iconStyle:p.symbolIcon,disabled:r,onClick:e=>{e.stopPropagation(),v("slack")}}):void 0,(0,De.jsx)(K().A,{ariaLabel:S.formatMessage(an.notion),icon:ae().b,style:p.symbolButton,disabled:r,iconStyle:p.symbolIcon,onClick:e=>{e.stopPropagation(),v("notion")}})]})})})})})}function gn(e){const{buttonPopupParent:t,value:n,onChange:i,validScopeOverrides:r,editDisabledLackOfPermissions:a}=e,l=(0,d().IS)((e=>({clearAllButton:{padding:"8px 12px",cursor:"pointer",fontSize:14,color:e.text.primary,borderBottom:`1px solid ${e.border.secondary}`,...s().A.isMobile&&{padding:"16px",fontSize:17,width:"100%",textAlign:"start"}},disabledButton:{color:e.gray.text.tertiary,cursor:"not-allowed"}})),[]),c=(0,o.useCallback)((()=>{a||(i({type:"ai-block",searchScopes:[],useWebSearch:!1}),t.close())}),[i,t,a]);return(0,De.jsxs)("div",{style:s().A.isMobile?{width:"100%"}:void 0,children:[s().A.isMobile?(0,De.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:22,marginBottom:14},children:(0,De.jsx)(ie().D,{styleKey:"Title-sm/Semibold",children:(0,De.jsx)(D().sA,{id:"AiBlockV2.inlineConfig.search.title",defaultMessage:"Search"})})}):void 0,(0,De.jsx)("div",{style:{...l.clearAllButton,...a?l.disabledButton:{}},onClick:c,role:"button",tabIndex:0,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),c())},children:(0,De.jsx)(D().sA,{id:"AiBlockConfigView.dontSearchAnySources",defaultMessage:"Donât search any sources"})}),(0,De.jsx)(Le,{buttonPopupParent:t,value:n,onChange:i,validScopeOverrides:r,hideConnectorFooter:!0,originSource:"ai_block"})]})}function hn(e){const{searchScopes:t,setSearchScopes:n,editDisabledLackOfPermissions:i}=e,r=(0,d().IS)((e=>({section:{marginTop:8},sectionTitle:{fontSize:14,fontWeight:600,color:e.text.primary,marginBottom:8,display:"flex",alignItems:"center"},searchContainer:{border:`1px solid ${e.border.secondary}`,borderRadius:6,cursor:"pointer",...i&&{backgroundColor:e.inputBackground,color:e.gray.text.tertiary,cursor:"not-allowed"}},dropdownTrigger:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",fontSize:14,minHeight:36},dropdownText:{fontSize:14,color:e.text.primary},rightSection:{display:"flex",alignItems:"center",gap:8},tooltipContent:{width:250,whiteSpace:"normal",wordWrap:"break-word"},infoIcon:{marginInlineStart:4,cursor:"help"}})),[i]),a=(0,D().tz)(),{isSlackConnected:l,isWebSearchAvailable:c}=Ue(),p=(0,o.useMemo)((()=>{if(t)return t.filter((e=>"web"===e.type?c:"slack"!==e.type||l))}),[l,c,t]),m=(0,o.useMemo)((()=>{if(!p||0===p.length)return a.formatMessage(an.noSources);const e=[],t=p.some((e=>"everything"===e.type));return(t||p.some((e=>"notion"===e.type)))&&e.push(a.formatMessage(an.notion)),(t||p.some((e=>"slack"===e.type)))&&l&&e.push(a.formatMessage(an.slack)),(t||p.some((e=>"web"===e.type)))&&c&&e.push(a.formatMessage(an.web)),a.formatList(e,{type:"conjunction"})}),[p,l,c,a]),g=(0,o.useMemo)((()=>["slack"]),[]),h=(0,o.useMemo)((()=>{const e=(null==p?void 0:p.some((e=>"web"===e.type)))??!1;return{type:"ai-block",searchScopes:(null==p?void 0:p.filter((e=>"web"!==e.type)))??[],useWebSearch:e}}),[p]),f=(0,o.useCallback)((e=>{const{searchScopes:t=[],useWebSearch:o}=e;n(o?[...t,{type:"web"}]:t)}),[n]);return(0,De.jsxs)("div",{style:r.section,children:[(0,De.jsxs)("div",{style:r.sectionTitle,children:[(0,De.jsx)(D().sA,{id:"AiBlockConfigView.search",defaultMessage:"Search"}),s().A.isMobile?void 0:(0,De.jsx)(G().A,{renderTooltip:()=>(0,De.jsx)("div",{style:r.tooltipContent,children:(0,De.jsx)(D().sA,{id:"AiBlockConfigView.search.explanation",defaultMessage:"Select what contexts AI can search to complement the information in the other fields"})}),render:e=>(0,De.jsx)("div",{...e,children:(0,De.jsx)(u().I,{icon:ce().infoCircleSmallIcon,size:"sm",colorVariant:"tertiary",style:r.infoIcon})})})]}),(0,De.jsx)("div",{style:r.searchContainer,children:(0,De.jsx)(xe().A,{popupType:s().A.isMobile?xe().z.BottomSheet:xe().z.Popup,originGap:2,disabled:i,placementToOrigin:"bottom",alignmentToOrigin:"start",renderOrigin:e=>(0,De.jsxs)("div",{style:r.dropdownTrigger,...e,children:[(0,De.jsx)("div",{children:(0,De.jsx)("div",{style:r.dropdownText,children:m||a.formatMessage({id:"AiBlockConfigView.dontSearchAnySources2",defaultMessage:"Don't search any sources"})})}),(0,De.jsx)("div",{style:r.rightSection,children:(0,De.jsx)(u().I,{icon:se().arrowChevronSingleDownSmallIcon,size:"sm",colorVariant:"tertiary"})})]}),render:e=>(0,De.jsx)(gn,{buttonPopupParent:e,value:h,onChange:f,validScopeOverrides:g,editDisabledLackOfPermissions:i})})})]})}function fn(e){const{store:t,onClose:n,permissionLevelCalculator:i}=e,r=!i.canEditConfigurationPanel(),{blockConfiguration:a,updateBlockConfiguration:l}=rn(t),{currentSkillType:p}=sn(t),m=(0,c().K8)((()=>{const e=t.getNavigableBlockStore();return(null==e?void 0:e.isTemplate())??!1}),[t]),h=(0,o.useMemo)((()=>{const e=a.context??[],t=a.searchScopes??[];return e.every((e=>"currentPage"===e.type))&&0===t.length?"current_page":"specified_context"}),[a]),f=(0,o.useMemo)((()=>"custom"!==a.type?"current_page":h),[a,h]),[v,y]=(0,o.useState)(f),b=(0,c().K8)((()=>{const e=(0,Oe().a)();return e?[{type:"currentPage",pageId:e.id}]:[]}),[]),S="custom"===a.type?a.context:void 0,x=(0,o.useCallback)((e=>{if(null!=e&&e.some((e=>"currentPage"!==e.type))&&y("specified_context"),"custom"===p){const t={...a,type:"custom",version:a.version,autofillInstructions:a.autofillInstructions,context:R().hS(e,(e=>{switch(e.type){case"currentPage":case"page":return e.pageId;case"collection":return e.collectionId;case"slack":return e.channel.id;default:return(0,g().HB)(e)}})),searchScopes:"custom"===a.type?a.searchScopes:[]};l(t)}}),[p,a,l]),k=(0,o.useCallback)((e=>{l({...a,autoGenerateOnTemplateDuplication:e})}),[a,l]),C=(0,o.useCallback)((e=>{l({...a,searchScopes:e})}),[a,l]),A=(0,D().tz)(),I=(0,o.useMemo)((()=>r?A.formatMessage({id:"AiBlockConfigView.saveButtonDisabled.insufficientEditPermissions",defaultMessage:"Insufficient permissions to edit"}):void 0),[r,A]),w=(0,d().IS)((e=>({container:{padding:16,position:"relative",margin:"0 auto"},content:{paddingTop:2},header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},headerTitle:{fontSize:16,fontWeight:600,color:e.text.primary},section:{marginBottom:20},sectionTitle:{fontSize:14,fontWeight:600,color:e.text.primary,marginBottom:8,display:"flex",alignItems:"center"},tooltipContent:{width:250,whiteSpace:"normal",wordWrap:"break-word"},infoIcon:{marginInlineStart:4,cursor:"help"}})),[]),{isSlackConnected:M}=Ue();return(0,De.jsxs)("div",{style:w.container,children:[(0,De.jsxs)("div",{style:w.header,children:[(0,De.jsx)("div",{style:w.headerTitle,children:(0,De.jsx)(D().sA,{id:"AiBlockConfigView.aiBlock",defaultMessage:"AI block"})}),(0,De.jsx)(cn,{handleSaveButton:n,saveButtonDisabledMessage:I})]}),(0,De.jsxs)("div",{style:w.content,children:[(0,De.jsxs)("div",{style:w.section,children:[(0,De.jsx)("div",{style:w.sectionTitle,children:(0,De.jsx)(D().sA,{id:"AiBlockConfigView.generate",defaultMessage:"Generate"})}),(0,De.jsx)(ln,{store:t,disabled:r,inferredCustomContextType:h,setSelectedContextType:y})]}),(0,De.jsx)("div",{style:w.section,children:(0,De.jsx)(un,{blockConfiguration:a,updateBlockConfiguration:l,editDisabledLackOfPermissions:r,selectedContext:S,updateSelectedContext:x})}),(0,De.jsxs)("div",{style:w.section,children:[(0,De.jsxs)("div",{style:w.sectionTitle,children:[(0,De.jsx)(D().sA,{id:"AiBlockConfigView.using",defaultMessage:"Using"}),s().A.isMobile?void 0:(0,De.jsx)(G().A,{renderTooltip:()=>(0,De.jsx)("div",{style:w.tooltipContent,children:M?(0,De.jsx)(D().sA,{id:"AiBlockConfigView.using.tooltip",defaultMessage:"AI uses information in mentioned page(s) or channels. At this time, AI Block cannot see databases."}):(0,De.jsx)(D().sA,{id:"AiBlockConfigView.using.tooltipWithoutSlack",defaultMessage:"AI uses information in mentioned page(s). At this time, AI Block cannot see databases."})}),render:e=>(0,De.jsx)("div",{...e,children:(0,De.jsx)(u().I,{icon:ce().infoCircleSmallIcon,size:"sm",colorVariant:"tertiary",style:w.infoIcon})})})]}),(0,De.jsx)(pn,{blockConfiguration:a,updateBlockConfiguration:l,editDisabledLackOfPermissions:r,setSelectedContextType:y,selectedContextType:v,currentPageScope:b}),"custom"===a.type&&"specified_context"===v?(0,De.jsx)(mn,{selectedContext:S,store:t,updateSelectedContext:x,editDisabledLackOfPermissions:r}):void 0,"specified_context"===v?(0,De.jsx)(hn,{searchScopes:a.searchScopes,setSearchScopes:C,editDisabledLackOfPermissions:r,setSelectedContextType:y}):void 0,m?(0,De.jsx)(Ye,{onToggle:k,toggled:Boolean(a.autoGenerateOnTemplateDuplication)}):void 0]})]})]})}var vn=()=>n(617837);function yn(e){const{traceId:t,feedbackState:n,setFeedbackState:o,iconHeight:i}=e;return(0,De.jsx)(vn().j,{setFeedbackState:o,feedbackState:n,traceId:t,feature:"ai_block",iconHeight:i})}var bn=()=>n(145214);function Sn(e){const{hoveredOrSelectionState:t,setHaloShouldBeVisible:n,colorVariant:i="purple",showingConfigView:r}=e,s=(0,d().IS)((e=>({haloContent:{position:"absolute",insetInlineStart:-6,insetInlineEnd:-6,top:-3,bottom:-3,pointerEvents:"none",borderRadius:8,border:`2px solid ${"purple"===i?e.palette.purple[300]:e.blue.border.strong}`}})),[i]),a=(0,o.useMemo)((()=>t!==q().l.Default||r),[t,r]);return(0,De.jsx)(bn().A,{visible:a,initial:{opacity:0,scale:.995},animate:{opacity:t===q().l.Hovered?.45:1,scale:1},exit:{opacity:0,scale:.995},onAnimationStart:()=>{n(!0)},onAnimationEnd:()=>{a||n(!1)},style:s.haloContent})}(0,D().YK)({summarize:{id:"aiBlock.summarize",defaultMessage:"Summarize this page with AI"},findActionItems:{id:"aiBlock.findActionItems",defaultMessage:"Find action items on this page with AI"},helpMeWrite:{id:"aiBlock.helpMeWrite",defaultMessage:"Tell the AI what to writeâ¦"},summarizeMeetingTranscript:{id:"aiBlock.summarizeMeetingTranscript",defaultMessage:"Summarize this meeting with any action items and decisions taken"}});function xn(e){const t=(0,D().tz)(),n=(0,c().K8)((()=>{const n=e.getFormat().ai_last_edited;return n?t.formatDate(n,{day:"numeric",month:"long",year:"numeric"}):void 0}),[t,e]);return(0,c().K8)((()=>{var o;const i=e.getLastEditedTime();if(!i)return;const r=t.formatDate(i,{day:"numeric",month:"long",year:"numeric"});if(r===n)return{lastAiEditGenerationTime:n,lastEditedByName:void 0,lastHumanEditedTime:void 0};return{lastEditedByName:(null===(o=e.getLastEditedByStore())||void 0===o?void 0:o.getDisplayName(t,!1))??void 0,lastHumanEditedTime:r,lastAiEditGenerationTime:n}}),[t,n,e])}function kn(e){const{disabledResult:t,lastGeneratedProps:n}=e,o=(0,d().IS)((e=>({darkTextColor:{color:"#787774"}})),[]);return t.isDisabled?(0,De.jsx)("div",{children:t.disabledMessage}):t.tooltipMessage?(0,De.jsx)("div",{children:t.tooltipMessage}):n?(0,De.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:4},children:[n.lastEditedByName&&n.lastHumanEditedTime?(0,De.jsx)("div",{style:o.darkTextColor,children:(0,De.jsx)(D().sA,{defaultMessage:"Edited by {personName} on {timestamp}",id:"AiBlockV2.lastGeneratedByHuman",values:{personName:n.lastEditedByName,timestamp:n.lastHumanEditedTime}})}):void 0,(0,De.jsx)("div",{style:o.darkTextColor,children:(0,De.jsx)(D().sA,{defaultMessage:"Generated by Notion AI on {timestamp}",id:"AIBlockV2.LastGeneratedAt",values:{timestamp:n.lastAiEditGenerationTime}})})]}):null}function Cn(e){const t=e?Q().c.getStateForBot({type:"universal",app:"slack",spaceId:e}):void 0;return e=>{const n=null==t?void 0:t.channels[e.channel.id];return Boolean(n)}}function An(e){const{onSettings:t,handleGenerateClick:n,handleStopGeneratingClick:i,isGenerating:r,traceId:a,isEmpty:l,store:c,permissionLevelCalculator:m}=e,g=(0,D().tz)(),h=s().A.isMobile,f=on({store:c,isGenerating:r,permissionLevelCalculator:m}),{isDisabled:v}=f,y=xn(c),[b,S]=(0,o.useState)(void 0),x=m.canOpenConfigurationPanel(),k=(0,d().IS)((e=>({container:{position:"absolute",top:2,insetInlineEnd:2,display:"flex",gap:6,zIndex:90},generateWrapper:{display:"flex",alignItems:"center",borderRadius:6,padding:"0px",height:"30px",userSelect:"none"},additionalButtonWrapper:{display:"flex",alignItems:"center",backgroundColor:e.popoverBackground,borderRadius:6,padding:"0px",boxShadow:e.shadowMD,border:`1px solid ${e.regularDividerColor}`,height:"30px",userSelect:"none"},iconButton:{height:"100%",display:"flex",alignItems:"center"},generateButton:{boxShadow:e.shadowMD,height:"100%",display:"flex",alignItems:"center",gap:4},labelText:{fontSize:"12px"}})),[]),C=(0,o.useCallback)((e=>{e.stopPropagation(),e.preventDefault(),r?i():n()}),[n,i,r]),A=r?g.formatMessage({id:"AiBlockV2.generatingTooltip",defaultMessage:"Generating..."}):g.formatMessage({id:"AiBlockV2.generateTooltip",defaultMessage:"Generate"});return(0,De.jsxs)("div",{style:k.container,children:[(0,De.jsxs)("div",{style:k.additionalButtonWrapper,children:[h||l||r?null:(0,De.jsx)(yn,{traceId:a,feedbackState:b,setFeedbackState:S,iconHeight:"100%"}),(0,De.jsx)(G().A,{renderTooltip:()=>x?g.formatMessage({id:"AiBlockV2.settingsTooltip",defaultMessage:"Settings"}):g.formatMessage({id:"AiBlockV2.settingsTooltipDisabled",defaultMessage:"Insufficient permissions to edit"}),render:e=>(0,De.jsx)(K().A,{...e,disabled:!x,icon:M().M,onClick:t,ariaLabel:g.formatMessage({id:"AiBlockV2.settingsButton",defaultMessage:"Settings"}),size:"sm",colorVariant:"secondary",style:k.iconButton})})]}),(0,De.jsx)("div",{style:k.generateWrapper,children:(0,De.jsx)(G().A,{disableTooltip:!v&&!y,renderTooltip:()=>(0,De.jsx)(kn,{store:c,disabledResult:f,lastGeneratedProps:y}),render:e=>(0,De.jsxs)(p().A,{...e,onMouseDown:e=>e.preventDefault(),onClick:C,disabled:v,ariaLabel:A,size:"md",style:k.generateButton,colorPalette:"blue",children:[r?(0,De.jsx)(u().I,{icon:w().U,size:"sm"}):void 0,(0,De.jsx)("div",{style:k.labelText,contentEditable:!1,children:A})]})})})]})}const In=(0,D().YK)({failedToGenerate:{id:"AIBlockV2.FailedToGenerate",defaultMessage:"Failed to generate. Please try again later."}});function wn(e){const{spaceId:t,currentUserId:n}=(0,c().K8)((()=>{var e,t;return{spaceId:null===(e=Y().default.state.sidebarSpaceStore)||void 0===e?void 0:e.id,currentUserId:null===(t=Y().default.state.currentUserStore)||void 0===t?void 0:t.id}}),[]),o=(0,c().K8)((()=>e.getModel()),[e]),i=(0,c().K8)((()=>{var t;return null===(t=e.getNavigableBlockStore())||void 0===t?void 0:t.pointer}),[e]);return(0,c().K8)((()=>function(e){const{model:t,spaceId:n,currentUserId:o,getRecordRole:i,getCanReadSlackChannel:r,currentPagePointer:s}=e;if(!t)return"reader";if(!n||!o)return"reader";const a=i(t.pointer)??"none";if(!(0,h().Tt)(a))return"reader";const l=i({id:n,table:y().NX})??"none";if(!(0,h().Tt)(l))return"reader";if(!(0,h().p2)(a))return"configuration_reader";const c=(0,b().Lv)({model:t});if("custom"===c.type)return S({referenceContext:c.context,getCanReadSlackChannel:r,getRecordRole:i})?"editor":"reader";if("summarizeThisPage"===c.type||"extractKeyPointsFromThisPage"===c.type)return s?S({referenceContext:[{type:"page",pageId:s.id}],getCanReadSlackChannel:r,getRecordRole:i})?"editor":"configuration_reader":"reader";(0,g().HB)(c)}({spaceId:t,currentUserId:n,getCanReadSlackChannel:Cn(t),getRecordRole:e.getRecordRole,model:o,currentPagePointer:i})),[t,n,e,o,i])}function Mn(e){const{store:t,hoveredOrSelectionState:n,setHaloShouldBeVisible:s,showingOverlay:d,disabled:u,disableHoverMenu:p}=e,m=(0,l().v3)(),h=(0,D().tz)(),[v,y]=(0,o.useState)(!1),b=new x(wn(t)),{blockConfiguration:S,updateBlockConfiguration:k}=rn(t);(0,o.useEffect)((()=>{H().EF.state===t.pointer.id&&(!function(e){var t;const{updateBlockConfiguration:n,blockConfiguration:o,environment:i}=e,r=new Set,s=null===(t=Y().default.state.sidebarSpaceStore)||void 0===t?void 0:t.id;if(s&&"context"in o){for(const e of o.context??[])if("collection"===e.type||"page"===e.type||"currentPage"===e.type){const t=new(Z().B)(i,{table:f().ev,id:e.pageId,spaceId:s});a().e.withListenerIgnored((()=>!t.canRead()))&&r.add(e.pageId)}else"slack"===e.type?Cn(s)(e)||r.add(e.channel.id):(0,g().HB)(e);n({...o,context:(o.context??[]).filter((e=>"slack"===e.type?!r.has(e.channel.id):!r.has(e.pageId)))})}}({environment:m,blockConfiguration:S,updateBlockConfiguration:k}),y(!0),s(!0),H().EF.setState(void 0))}),[S,m,t.pointer.id,k,s]),(0,o.useEffect)((()=>{W().AP()}),[n]);const w=(0,o.useCallback)((e=>{F().ui({message:e,showCancel:!1,keepFocus:!1,items:[{label:$().A.formatMessage(F()._0.dismissButtonLabel),onAccept:R().D_}]})}),[]),[M,T]=(0,o.useState)(!1),j=(0,c().K8)((()=>t.isGenerating()),[t]);(0,o.useEffect)((()=>{T(j)}),[j]);const P=t.id,B=(0,o.useMemo)((()=>{var e;return{block_id:t.id,prompt_type:S.type,search_scopes_enabled:null===(e=S.context)||void 0===e?void 0:e.map((e=>e.type))}}),[S.context,S.type,t.id]),[E,O]=(0,o.useState)(void 0),U=(0,o.useCallback)((async()=>{(0,i().u)({environment:m,event:{eventName:"ai_block_generate_clicked",eventProperties:B}});const e=new AbortController;O(e),await async function(e){const{environment:t,setIsGenerating:n,onError:o,store:i,intl:r,abortController:s}=e;function a(){o(r.formatMessage(In.failedToGenerate))}n(!0);const l=async()=>{var e,n;const o=null===(e=Y().default.state.sidebarSpaceStore)||void 0===e?void 0:e.id;if(!o)return;const r=null===(n=i.getNavigableBlockStore())||void 0===n?void 0:n.pointer;if(!r)return;const a=await(0,ee().Bw)(t,{spaceId:o,userId:t.currentUser.id,amount:1,name:"ai_usage"});if(!(0,_().e2)(a))return void J().K(t,{from:"ai_block",upsell:a.upsell});const l=await N().callStreamApi({eventName:"generateAiBlock",environment:t,data:{blockPointer:{...i.pointer,spaceId:o},parentPagePointer:{...r,spaceId:o},analyticsSource:"client"},abortSignal:s.signal}),c=await(0,ee().Bw)(t,{spaceId:o,userId:t.currentUser.id,amount:"unknown",name:"ai_usage"});if((0,I().kX)(l)||"success"!==l.type||!z().hS.is(l.data))throw new Error("InvalidServerResponse");{let e;for await(const n of l.data){if(!(0,I().PX)(n)){if((0,I().kX)(n)){if(null!=c&&c.upsell&&(0,A().iD)(n,A().yP))return void J().K(t,{from:"ai_limit_in_app",upsell:c.upsell});throw"ValidationError"===n.name?new(A().yI)(n.body.debugMessage??"Unknown error"):new Error("InvalidStreamResponse")}throw new Error("InvalidStreamResponse")}Tn({environment:t,markdownString:n.markdownString,aiBlockStore:i}),e=n.markdownString}if(!e||0===e.length)throw new Error("EmptyGeneration")}};try{return await(0,L().L5)({fn:l,retryAttemptsMS:[50,100,200],retryAttemptRandomOffsetMS:0,initialInput:void 0,handleError:(e,t,n)=>s.signal.aborted?{status:"throw",error:new Error("User aborted request.")}:(t&&a(),function(e){const{type:t,aiBlockId:n,spaceId:o,miscDataToConvertToString:i,error:r}=e;C().log({from:"generateAiBlockTask",level:"error",type:t,error:r?(0,V().convertErrorToLog)(r):void 0,data:{miscDataToConvertToString:{aiBlockId:n,spaceId:o,...i}}})}({aiBlockId:i.id,spaceId:i.getSpaceId(),type:e.name,error:e,miscDataToConvertToString:{source:"client",isRetrying:!t,retryAttempt:n}}),t?{status:"throw",error:e}:{status:"retry"})})}finally{n(!1)}}({environment:m,intl:h,onError:w,store:t,setIsGenerating:T,abortController:e})}),[m,h,w,B,t]),K=(0,o.useCallback)((()=>{null==E||E.abort(),T(!1),(0,i().u)({environment:m,event:{eventName:"ai_block_stop_generate_clicked",eventProperties:B}})}),[E,m,B,T]),G=(0,o.useCallback)((()=>{M||y(!0)}),[M]),Q=(0,o.useCallback)((()=>{(0,i().u)({environment:m,event:{eventName:"ai_block_settings_panel_opened",eventProperties:B}}),y(!0),s(!0)}),[m,s,B]),X=(0,o.useCallback)((()=>{y(!1),s(!1),(0,i().u)({environment:m,event:{eventName:"ai_block_settings_done_clicked",eventProperties:B}})}),[m,s,B]),ie=(0,c().K8)((()=>!t.hasContent()),[t]),re=(0,c().K8)((()=>t.getContentStore()),[t]),se=(0,l().Y0)(),ae=(0,c().K8)((()=>!v&&n!==q().l.Default),[n,v]);return(0,o.useEffect)((()=>{const e=a().e.withListenerIgnored((()=>{var e;return null===(e=Y().default.state.sidebarSpaceStore)||void 0===e?void 0:e.id}));e&&(0,oe().Hn)({environment:m,spaceId:e,externalAuthConfig:{type:"universal",app:"slack",spaceId:e}})}),[m]),(0,De.jsxs)(te().A,{name:"AiBlockV2",children:[(0,De.jsxs)("div",{style:{paddingInlineStart:8,minHeight:35,position:"relative"},onClick:ie?G:void 0,children:[ae?(0,De.jsx)(An,{onSettings:Q,handleGenerateClick:U,handleStopGeneratingClick:K,isGenerating:M,traceId:P,isEmpty:ie,permissionLevelCalculator:b,store:t}):void 0,v?(0,De.jsx)(r().s,{allowSelectionWithin:!0,onClick:e=>e.stopPropagation(),children:(0,De.jsx)(fn,{store:t,onClose:X,permissionLevelCalculator:b})}):(0,De.jsx)(ne().A,{emptyPlaceholder:(0,De.jsx)(jn,{placeholderText:h.formatMessage({id:"AiBlockV2.EmptyEditingPlaceholder3",defaultMessage:"Your AI content will be generated here - click to setup"})}),disabled:u||M,store:re,disableHoverMenu:p||n!==q().l.SelectedDescendant,disableDrag:se.isMobile})]}),d?(0,De.jsx)(Sn,{hoveredOrSelectionState:n,setHaloShouldBeVisible:s,colorVariant:"blue",showingConfigView:v}):void 0]})}function Tn(e){const{environment:t,markdownString:n,aiBlockStore:o}=e,i=o.getSpaceId(),r=t.currentUser.id;if(!r)return;const a={table:B().oo,id:r},l=t.idCreator.getSpaceIdCreatorSync(i),c=(0,k().hM)(n),d=(0,m().ie)({pageId:o.id,recordMap:P().RecordMap.create(),updates:[{action:"insert",blocks:c}],spaceId:i,useCrdt:!1,idCreator:l,actorPointer:a,uriContext:{baseUrl:s().A.domainBaseUrl,publicDomainName:s().A.publicDomainName},agentBlocksOnPage:[]});U().createAndCommit({userAction:"aiBlockV2.handleMarkdownStreamResponse",environment:t,canUndo:!0,perform:e=>{o.getContentIds().forEach((t=>{U().applyOperation({store:o,operation:(0,j().TQ)({blockParentId:o.id,recordId:t}),transaction:e})}));for(const n of d)if((0,E().ph)(n)){const o=new(Z().B)(t,n.pointer);U().applyCrdtTextOperation({store:o,operation:n,invertedOperation:void 0,transaction:e})}else if((0,T().$Y)(n)||(0,T().mP)(n))switch(n.pointer.table){case f().ev:{const o=new(Z().B)(t,n.pointer);U().applyOperation({store:o,operation:n,transaction:e});break}default:{const o=new(X().pm)({environment:t,pointer:n.pointer,path:n.path});U().applyOperation({store:o,operation:n,transaction:e})}}else(0,g().HB)(n);O().zv({store:o.getFormatStore(),data:{ai_last_edited:Date.now()},transaction:e})}})}function jn(e){const{placeholderText:t}=e,n=(0,d().IS)((e=>({textWrapper:{caretColor:e.text.tertiary,color:e.text.tertiary,display:"flex",alignItems:"center",cursor:"pointer",minHeight:35}})),[]);return(0,De.jsx)("div",{style:n.textWrapper,children:t})}},70899:(e,t,n)=>{n.d(t,{U:()=>i});n(296540);const o={viewBox:"0 0 16 16",fittedViewBox:"1.87 1.87 12.25 12.26",svg:(0,n(474848).jsx)("path",{d:"M11.904 3.28a6.125 6.125 0 1 0-1.648 10.415.625.625 0 1 0-.46-1.163 4.875 4.875 0 1 1 2.808-2.93c-.102.294-.43.523-.878.523a.87.87 0 0 1-.872-.872V5.705a.625.625 0 0 0-1.242-.098 3.04 3.04 0 0 0-1.746-.527c-.792 0-1.542.277-2.095.825-.557.55-.871 1.332-.871 2.256s.313 1.714.864 2.276 1.3.858 2.102.858c.8 0 1.55-.294 2.104-.85a2.12 2.12 0 0 0 1.756.93c.835 0 1.738-.441 2.058-1.361a6.125 6.125 0 0 0-1.88-6.734M6.65 6.793c.294-.29.715-.463 1.216-.463.5 0 .929.173 1.228.466.296.289.508.735.508 1.365 0 .631-.213 1.095-.515 1.4-.303.306-.73.484-1.221.484-.49 0-.91-.178-1.209-.482-.296-.303-.507-.767-.507-1.402 0-.633.21-1.08.5-1.368"})},i=(0,n(340498).wt)("atSmall",o)},73223:(e,t,n)=>{n.r(t),n.d(t,{checkIsTutorialDone:()=>h,dismissTutorial:()=>d,resetTutorials:()=>u,tutorialAdvanceToStep:()=>p,tutorialAdvanceToStepAfter:()=>m,tutorialGoToNextStep:()=>l,tutorialGoToPrevStep:()=>c,tutorialGoToStep:()=>g});var o=()=>n(541235),i=()=>n(231297),r=()=>n(755199),s=()=>n(739135),a=()=>n(765957);function l(e,t,n){var o;const{currentUserSettingsStore:i}=a().default.state;if(!i)return;const l=null===(o=i.getSettings())||void 0===o?void 0:o.tutorials;n?r().mJ({userSettingsStore:i,transaction:n,data:{tutorials:{...l,[t]:(0,s().i9)(i,t)}}}):f({userAction:"TutorialActions.nextStep",environment:e,perform:e=>{r().mJ({userSettingsStore:i,transaction:e,data:{tutorials:{...l,[t]:(0,s().i9)(i,t)}}})},userId:i.id})}function c(e,t){var n;const{currentUserSettingsStore:o}=a().default.state;if(!o)return;const i=null===(n=o.getSettings())||void 0===n?void 0:n.tutorials;f({userAction:"TutorialActions.prevStep",environment:e,perform:e=>{r().mJ({userSettingsStore:o,transaction:e,data:{tutorials:{...i,[t]:(0,s().KD)(o,t)}}})},userId:o.id})}function d(e,t){var n;const{currentUserSettingsStore:i}=a().default.state;if(!i)return;const s=null===(n=i.getSettings())||void 0===n?void 0:n.tutorials;(null==s?void 0:s[t])!==o().YD&&f({userAction:"TutorialActions.dismissTutorial",environment:e,perform:e=>{r().mJ({userSettingsStore:i,transaction:e,data:{tutorials:{...s,[t]:o().YD}}})},userId:i.id})}function u(e){const{currentUserSettingsStore:t}=a().default.state;t&&f({userAction:"TutorialActions.resetTutorialsDebug",environment:e,perform:e=>{r().mJ({userSettingsStore:t,transaction:e,data:{tutorials:{}}})},userId:t.id})}function p(e,t,n){var i;const{currentUserSettingsStore:l}=a().default.state;if(!l||(0,s().x$)(l,t))return;const c=(0,s().gt)(l,t);o().c$[t].steps.findIndex((e=>e.id===c))>=o().c$[t].steps.findIndex((e=>e.id===n))||r().mJ({userSettingsStore:l,transaction:e,data:{tutorials:{...null===(i=l.getSettings())||void 0===i?void 0:i.tutorials,[t]:n}}})}function m(e,t,n){if((0,s().ll)(n))return;const o=(0,s().tb)(t,n);o&&p(e,t,o)}function g(e,t,n,o){var i;const{currentUserSettingsStore:s}=a().default.state;if(!s)return;const l=null===(i=s.getSettings())||void 0===i?void 0:i.tutorials;o?r().mJ({userSettingsStore:s,transaction:o,data:{tutorials:{...l,[t]:n}}}):f({userAction:"TutorialActions.nextStep",environment:e,perform:e=>{r().mJ({userSettingsStore:s,transaction:e,data:{tutorials:{...l,[t]:n}}})},userId:s.id})}function h(e){const{currentUserSettingsStore:t}=a().default.state;return!!t&&(0,s().x$)(t,e)}function f(e){return i().createAndCommit({...e,canUndo:!1})}},73956:(e,t,n)=>{n.r(t),n.d(t,{checkmarkFillSmallIcon:()=>i,iconDefinition:()=>o});n(296540);const o={viewBox:"0 0 16 16",fittedViewBox:"2.87 2.88 10.25 10.24",svg:(0,n(474848).jsx)("path",{d:"M12.756 2.987a.75.75 0 0 1 .257 1.029l-5.244 8.74a.75.75 0 0 1-1.213.102L3.06 8.78a.75.75 0 0 1 1.14-.976l2.818 3.289 4.709-7.848a.75.75 0 0 1 1.029-.257"})},i=(0,n(340498).wt)("checkmarkFillSmall",o)},77279:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});class o extends(()=>n(757695))().Store{getInitialState(){return{discussionIdToExpansionStartPointMap:{}}}}const i=new o},97059:(e,t,n)=>{n.d(t,{s:()=>i});n(296540);const o={viewBox:"0 0 16 16",fittedViewBox:"1.82 1.82 12.68 12.68",svg:(0,n(474848).jsx)("path",{d:"M8 1.825a.575.575 0 0 0-.575.575V4a.575.575 0 0 0 1.15 0V2.4A.575.575 0 0 0 8 1.825m4.367 1.809a.575.575 0 0 0-.814 0l-1.131 1.131a.575.575 0 1 0 .813.813l1.132-1.131a.575.575 0 0 0 0-.813m-7.92 0a.575.575 0 0 0-.813.813l1.13 1.131a.575.575 0 1 0 .814-.813zm3.248 3.071a.7.7 0 1 0-.99.99l.77.77.99-.99zm4.305.72a.575.575 0 0 0 0 1.15h1.6a.575.575 0 1 0 0-1.15zm-9.6 0a.575.575 0 1 0 0 1.15H4a.575.575 0 0 0 0-1.15zm11.895 5.88-5.37-5.37-.99.99 5.37 5.37a.7.7 0 0 0 .99-.99m-8.717-2.883a.575.575 0 0 0-.813 0l-1.131 1.131a.575.575 0 1 0 .813.813l1.131-1.131a.575.575 0 0 0 0-.813M8 11.425a.575.575 0 0 0-.575.575v1.6a.575.575 0 1 0 1.15 0V12A.575.575 0 0 0 8 11.425"})},i=(0,n(340498).wt)("magicWandSmall",o)},101749:(e,t,n)=>{n.d(t,{N:()=>s});n(296540);var o=()=>n(69708),i=()=>n(423657),r=n(474848);function s(e){const t=(0,i().A)(e);return t.isGuestRequestRequired?(0,r.jsx)(o().sA,{id:"contextualInvite.buttonAndTokenTooltip.guestRequestRequired",defaultMessage:"This guest must be approved by a workspace owner first"}):t.isStoreInTeam?t.teamAllowsGuests?void 0:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{children:(0,r.jsx)(o().sA,{id:"contextualInvite.buttonAndTokenTooltip.teamDisablesGuestsAlertLine1",defaultMessage:"This teamspace doesnât allow guests."})}),(0,r.jsx)("div",{children:(0,r.jsx)(o().sA,{id:"contextualInvite.buttonAndTokenTooltip.teamDisablesGuestsAlertLine2",defaultMessage:"Remove any guests to continue."})})]}):t.spaceAllowsGuests?void 0:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{children:(0,r.jsx)(o().sA,{id:"contextualInvite.buttonAndTokenTooltip.spaceDisablesGuestsAlertLine1",defaultMessage:"This workspace doesnât allow guests."})}),(0,r.jsx)("div",{children:(0,r.jsx)(o().sA,{id:"contextualInvite.buttonAndTokenTooltip.spaceDisablesGuestsAlertLine2",defaultMessage:"Remove any guests to continue."})})]})}},103674:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().Store{getInitialState(){return{permissionsInviteStore:(0,n(406999)._P)(),contextualInviteStore:new(n(159026).Ay)}}get stage(){return this.state.contextualInviteStore.state.inviteStage}}const i=o},115314:(e,t,n)=>{n.d(t,{v:()=>s});n(16280),n(296540);var o=()=>n(69708),i=()=>n(534177),r=n(474848);function s(e,t){switch(e){case"editor":return(0,r.jsx)(o().sA,{id:"PersonPropertyPermissionsBadge.tooltipText.editor",defaultMessage:"Anyone selected in {propertyName} has full access to this page",values:{propertyName:t}});case"read_and_write":return(0,r.jsx)(o().sA,{id:"PersonPropertyPermissionsBadge.tooltipText.readAndWrite",defaultMessage:"Anyone selected in {propertyName} can edit this page",values:{propertyName:t}});case"reader":return(0,r.jsx)(o().sA,{id:"PersonPropertyPermissionsBadge.tooltipText.reader",defaultMessage:"Anyone selected in {propertyName} can view this page",values:{propertyName:t}});case"comment_only":return(0,r.jsx)(o().sA,{id:"PersonPropertyPermissionsBadge.tooltipText.commentOnly",defaultMessage:"Anyone selected in {propertyName} can comment on this page",values:{propertyName:t}});case"content_only_editor":case"membership_admin":case"none":throw new Error(`Unhandled role in person property permissions badge: ${e}`);default:(0,i().HB)(e)}}},115562:(e,t,n)=>{n.d(t,{W:()=>c});n(296540);var o=()=>n(819121),i=()=>n(401497),r=()=>n(451306),s=()=>n(73956),a=()=>n(340498),l=n(474848);function c(e){const{selectorSize:t="normal",...n}=e,{disabled:c,checked:d}=n,[u,p]=(0,o().A)(),m=function(e){const{checked:t,disabled:n,isFocusVisible:o,selectorSize:r}=e;return(0,i().IS)((e=>({root:{position:"absolute",display:"flex",width:"large"===r?15:11,height:"large"===r?15:11,margin:1.5,justifyContent:"center",alignItems:"center",flexShrink:0,borderRadius:"large"===r?2:1,transition:"background 100ms ease-out",...t?{boxShadow:`0 0 0 1.5px ${n?e.background.tertiaryTranslucent:e.blue.background.accentPrimary}`,background:n?e.background.tertiaryTranslucent:e.blue.background.accentPrimary}:{boxShadow:`0 0 0 1.5px ${n?e.icon.quaternary:e.border.strong}`,background:e.background.primary},...o&&{boxShadow:e.buttonBlueFocusRing}},active:{background:t?e.blueButtonPressedBackground:e.buttonHoveredBackground},input:{opacity:0,width:"large"===r?18:void 0,height:"large"===r?18:void 0,...n?{pointerEvents:"none"}:{cursor:"pointer"}},icon:{color:e.blue.text.inversePrimary,width:"large"===r?a().Ev.xs:a().Ev.xxs,height:"large"===r?a().Ev.xs:a().Ev.xxs,ariaHidden:!0}})),[r,t,n,o])}({checked:d,disabled:c,selectorSize:t,isFocusVisible:p});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("input",{ref:u,type:"checkbox",style:m.input,...n}),(0,l.jsx)("span",{...(0,r().AH)(m.root,c?{}:{pseudoActive:m.active}),children:d?(0,s().checkmarkFillSmallIcon)(m.icon):void 0})]})}},123350:(e,t,n)=>{n.r(t),n.d(t,{RequestMembersModal:()=>j,default:()=>P,messages:()=>T});var o=n(296540),i=()=>n(484714),r=()=>n(56366),s=()=>n(401497),a=()=>n(160432),l=()=>n(69708),c=()=>n(100622),d=()=>n(284371),u=()=>n(134696),p=()=>n(542056),m=()=>n(471995),g=()=>n(805751),h=()=>n(623580),f=()=>n(404277),v=()=>n(433876),y=()=>n(417392),b=()=>n(125565),S=()=>n(654856),x=()=>n(897537),k=()=>n(495867),C=()=>n(722872),A=()=>n(743260),I=()=>n(766343),w=()=>n(103674),M=n(474848);const T=(0,l().YK)({reason_placeholder:{id:"RequestMembersModal.reason.placeholder",defaultMessage:"Add a reason (optional)"}});function j(e){const t=(0,i().v3)(),{spaceStore:n,origin:j,analyticsFrom:P}=e,{modalOpen:B,focus:_}=(0,r().K8)((()=>{const{open:e,focus:t}=I().A.state;return{modalOpen:e,focus:t}}),[]),E=(0,o.useCallback)((e=>{B&&I().A.setState({...I().A.state,open:!0,focus:e})}),[B]),D=(0,r().uB)(void 0,w().A),z=(0,l().tz)(),R=(0,s().IS)((e=>({modalStyle:{alignSelf:"center",overflow:"visible",top:0,width:420},container:{padding:20},title:{fontWeight:d().Wy.medium,marginBottom:10},reasonTitle:{color:c().Tj.mediumTextColor,marginTop:10,marginBottom:5},footer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:15},requestInvitesButton:{marginInlineStart:20},divider:{width:"100%",marginTop:10,marginBottom:15},showDivider:{background:e.regularDividerColor,boxShadow:e.shadowLG},hideDivider:{boxShadow:"none"}})),[]);(0,o.useEffect)((()=>{E("invites")}),[E]);const V=e=>{e.currentTarget===e.target&&E("none")},L=async()=>{u().RH(t,{...k().nE(t,D.state.contextualInviteStore),from:P}),p().KW({permissionsInviteStore:D.state.permissionsInviteStore,contextualInviteStore:D.state.contextualInviteStore}),D.state.contextualInviteStore.startRequestMembership();const e=D.state.contextualInviteStore.state.invitedUsers;I().A.close();const o=await k().xi({environment:t,spaceStore:n,originId:void 0,originType:P,reasonMessage:D.state.permissionsInviteStore.state.emailMessage,contextualInviteStore:D.state.contextualInviteStore,intl:z});N({success:o,intl:z,users:e}),D.reset()},N=e=>{const{success:t,intl:n,users:o}=e;0!==o.length&&(t?m().D6({label:n.formatMessage({id:"requestMembersModal.requestSuccess.toast",defaultMessage:"Successfully requested membership for {users} to your workspace admins."},{users:k().id(o,n)})}):m().D6({label:n.formatMessage({id:"requestMembersModal.requestFail.toast",defaultMessage:"Failed to invite {users} to the workspace."},{users:k().id(o,n)})}))};return(0,M.jsx)(v().A,{modalStyle:R.modalStyle,open:B,onDismiss:async()=>{if(!(await(0,A().iQ)({environment:t,permissionsInviteStoreState:D.state.permissionsInviteStore.state,from:"space_settings_add_members"})))return I().A.close(),void D.reset();E("none")},renderContent:()=>(0,M.jsxs)("div",{style:R.container,onClick:V,children:[(0,M.jsx)("div",{style:R.title,onClick:V,children:(0,M.jsx)(l().sA,{id:"requestMembersModal.title",defaultMessage:"Request to invite members"})}),(0,M.jsx)(y().Ay,{popupType:y().nl.Popup,alignmentToOrigin:"start",placementToOrigin:"bottom",open:"invites"===_,sameWidthAsOrigin:!0,originGap:10,trapFocus:!0,disableMouseCapture:!0,popupWrapStyle:{boxShadow:"none"},origin:(0,M.jsx)(S().A,{permissionsInviteStore:D.state.permissionsInviteStore,store:n,handleClickRemoveToken:e=>{p().St({targetToRemove:e,permissionsInviteStore:D.state.permissionsInviteStore})},handleInputChange:async e=>{E("invites"),await p().Pp({environment:t,event:e,permissionsInviteStore:D.state.permissionsInviteStore})},handleInputSubmit:async()=>{},origin:"add_members",right:(0,M.jsx)("div",{}),focus:"invites"===_,handleFocus:()=>E("invites")}),onDismiss:()=>E("none"),render:()=>{const e=(0,M.jsx)(x().A,{permissionsInviteStore:D.state.permissionsInviteStore,store:n,shouldShowGroups:!1,sectionRenderLimit:10,membersOnly:!1}),t={menuType:C().gu.Popup,disableScroller:!1};return(0,M.jsx)("div",{children:(0,M.jsx)(f().A,{...t,width:380,children:e})})},style:{width:"100%"}}),(0,M.jsx)("div",{style:{...R.divider,..."invites"===_?R.showDivider:R.hideDivider}}),(0,M.jsx)("div",{style:R.reasonTitle,onClick:V,children:(0,M.jsx)(l().sA,{id:"requestMembersModal.reasonForRequest.title",defaultMessage:"Reason for request"})}),(0,M.jsx)(g().A,{debugName:"RequestMembersModal",capture:!0,allowEsc:!0,children:(0,M.jsx)(h().A,{textarea:!0,style:{padding:8},value:D.state.permissionsInviteStore.state.emailMessage,focus:"reason"===_,onFocus:()=>E("reason"),onChange:e=>{D.state.permissionsInviteStore.setState({...D.state.permissionsInviteStore.state,emailMessage:e.target.value})},placeholder:z.formatMessage(T.reason_placeholder)})}),(0,M.jsxs)("div",{style:R.footer,onClick:V,children:[(0,M.jsx)(b().A,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,M.jsx)(l().sA,{id:"RequestMembersModal.caption",defaultMessage:"Your admins will approve or decline your request."})}),(0,M.jsx)(a().A,{colorPalette:"blue",size:"lg",style:R.requestInvitesButton,onClick:L,children:(0,M.jsx)(l().sA,{id:"requestMembersModal.requestInvitesButton.label",defaultMessage:"Request invites"})})]})]}),origin:(0,M.jsx)("div",{onClick:()=>{I().A.open()},children:j})})}const P=j},132855:(e,t,n)=>{n.r(t),n.d(t,{arrowInCircleUpFillIcon:()=>i,iconDefinition:()=>o});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.25 15.26",svg:(0,n(474848).jsx)("path",{d:"M10 17.625a7.625 7.625 0 1 0 0-15.25 7.625 7.625 0 0 0 0 15.25m3.042-8.07a.625.625 0 0 1-.884 0L10.625 8.02v5.466a.625.625 0 1 1-1.25 0V8.021L7.842 9.554a.625.625 0 1 1-.884-.883l2.6-2.6a.625.625 0 0 1 .884 0l2.6 2.6a.625.625 0 0 1 0 .883"})},i=(0,n(340498).wt)("arrowInCircleUpFill",o)},171018:(e,t,n)=>{n.d(t,{A6:()=>c,Ep:()=>l,YB:()=>r,es:()=>d});var o=()=>n(757695),i=()=>n(712505);class r extends o().Store{getInitialState(){return{forceShowProperties:!1,searchOpen:!1,searchQuery:""}}}const s="unnamed";class a extends o().Store{getInitialState(){return{pagePropertiesStoreMap:{}}}getNewEditorPagePropertiesStore(e){var t;const n=e||s;if(null!==(t=this.state.pagePropertiesStoreMap)&&void 0!==t&&t[n])return this.state.pagePropertiesStoreMap[n];const o=new r,i={pagePropertiesStoreMap:{...this.state.pagePropertiesStoreMap,[n]:o}};return this.setState(i),o}}const l=new a,c=new a;function d(e){const t=e||s;return(i().default.state.open?c:l).state.pagePropertiesStoreMap[t]}},173783:(e,t,n)=>{n.d(t,{A:()=>s});n(296540);var o=()=>n(658985),i=()=>n(903047),r=n(474848);function s(e){const t=(0,i().E)(e),n=(0,o().$)(t.icon);return(0,r.jsx)("div",{style:t.iconContainer,children:n})}},175320:(e,t,n)=>{n.d(t,{lv:()=>f,C5:()=>g,u7:()=>m,uh:()=>h});var o=()=>n(560198),i=()=>n(100622);const r="theme";var s=()=>n(534177),a=()=>n(20822),l=()=>n(661179),c=()=>n(44551);const d=15;function u(e,t){const{ThemeStore:n}=e,{mode:s,usingSystemTheme:a}=t;if(o()._u)return;const l={mode:s};var d,u;n.setState(l),e.mobileNative&&e.mobileNative.setTheme(s,a),d=function(e,t){const n=(0,i().O4)({theme:e});return{mode:e,usingSystemTheme:t,colors:{white:i().Tj.white,blue:i().Tj.blue},borderRadius:4,textColor:n.text.primary,popoverBackgroundColor:n.popoverBackground,popoverBoxShadow:n.shadowMD,inputBoxShadow:n.inputBoxShadow,inputBackgroundColor:n.inputBackground,dividerColor:n.darkDividerColor,shadowOpacity:n.shadowOpacity}}(s,a),null===c().electronApi||void 0===c().electronApi||null===(u=c().electronApi.setTheme)||void 0===u||u.call(c().electronApi,d),localStorage.setItem(r,JSON.stringify(l)),m(s),"dark"===s?(document.body.classList.add("dark"),document.body.classList.add("notion-dark-theme")):(document.body.classList.remove("dark"),document.body.classList.remove("notion-dark-theme"))}const p={scrollbarTrack:{light:"rgba(0, 0, 0, 0)",dark:"rgba(0, 0, 0, 0)"},scrollbarThumb:{light:"#D3D1CB",dark:"rgba(255, 255, 255, 0.2)"}};function m(e){if(0===l().A.state)return;const t=document.getElementById("scroll-properties");t&&(t.innerHTML=`\n\t\t* {\n\t\t\tscrollbar-width: ${d}px;\n\t\t\tscrollbar-color: ${p.scrollbarThumb[e]}  ${p.scrollbarTrack[e]};\n\t\t}\n\t`)}function g(e){a().A.setState(e)}function h(e){const t=f(e);switch(t){case"dark":case"light":u(e,{mode:t,usingSystemTheme:!1});break;case"system":!async function(e){const{mobileNative:t}=e;let n="light";n=t&&t.api.getTheme?await t.api.getTheme():(0,o().VD)(e),u(e,{mode:n,usingSystemTheme:!0})}(e);break;default:(0,s().HB)(t)}}function f(e){const t=a().A.state||"system";return"dark"===(n=t)||"light"===n||"system"===n?n:"system";var n}},175882:(e,t,n)=>{n.r(t),n.d(t,{exclamationMarkTriangleSmallIcon:()=>r,iconDefinition:()=>i});n(296540);var o=n(474848);const i={viewBox:"0 0 16 16",fittedViewBox:"1.49 1.87 13.01 11.75",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M7.9 5.281a.625.625 0 0 0-.625.625v2.5a.625.625 0 0 0 1.25 0v-2.5a.625.625 0 0 0-.625-.625m0 4.7a.725.725 0 1 0 0 1.45.725.725 0 0 0 0-1.45"}),(0,o.jsx)("path",{d:"M9.58 2.788c-.702-1.217-2.458-1.217-3.16 0l-4.677 8.1c-.702 1.216.176 2.737 1.58 2.737h9.354c1.405 0 2.283-1.52 1.58-2.738zm-2.078.625a.575.575 0 0 1 .996 0l4.677 8.1a.575.575 0 0 1-.498.862H3.324a.575.575 0 0 1-.498-.863z"})]})},r=(0,n(340498).wt)("exclamationMarkTriangleSmall",i)},176412:(e,t,n)=>{n.d(t,{L:()=>i});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"0.97 2.72 18.06 14.56",svg:(0,n(474848).jsx)("path",{d:"M3.893 2.875a.626.626 0 0 1 .79-.02l.091.088.128.148.015.033.072.105 11.27 13.148a.623.623 0 0 1-1.033.68l-1.616-1.884c-1.12.408-2.338.633-3.61.633-3.757 0-7.049-1.946-8.707-4.843l-.155-.283a1.46 1.46 0 0 1 0-1.359l.155-.283c.89-1.554 2.25-2.834 3.898-3.687L3.825 3.757l-.072-.105a.626.626 0 0 1 .14-.777M7.41 7.941a3.3 3.3 0 0 0-.717 2.056l.004.17A3.307 3.307 0 0 0 9.83 13.3l.17.004c.595 0 1.151-.161 1.634-.437l-1.52-1.773a1.104 1.104 0 0 1-1.18-1.377zM10 4.194c3.878 0 7.26 2.075 8.862 5.127l.074.164c.125.332.125.7 0 1.032l-.074.163a9.3 9.3 0 0 1-2.987 3.327l-2.69-3.138a3.3 3.3 0 0 0 .116-.702l.005-.17a3.31 3.31 0 0 0-3.136-3.303L10 6.691a3 3 0 0 0-.377.022L7.682 4.447A10.7 10.7 0 0 1 10 4.194"})},i=(0,n(340498).wt)("eyeSlashFill",o)},198491:(e,t,n)=>{n.d(t,{A:()=>l,e:()=>a});n(296540);var o=()=>n(662303),i=()=>n(69708),r=()=>n(412236),s=n(474848);function a({upsellTier:e}){return(0,s.jsx)(i().sA,{defaultMessage:"Upgrade to {upsellTier, select, plus {Plus} business {Business} enterprise {Enterprise} other {connect}}",id:"collectionSettings.connectedRelationUpsell.title",values:{upsellTier:e}})}function l({upsellTier:e,expirationDate:t,hasLearnMore:n}){return t?(0,s.jsx)(i().sA,{defaultMessage:"{upsellTier, select, plus {Plus plan} business {Business plan} enterprise {Enterprise plan} other {Upgrade}} will be required to access this feature starting on {expirationDate} {hasLearnMore, select, true {{learnMoreLink}} other {} }",id:"collectionSettings.collectionPremiumFeatureUpsell.expiration.description",values:{upsellTier:e,expirationDate:t.setLocale(o().locale).toLocaleString({month:"long",day:"numeric"}),hasLearnMore:n,learnMoreLink:(0,s.jsx)(r().V,{})}}):(0,s.jsx)(i().sA,{defaultMessage:"{upsellTier, select, plus {Plus} business {Business} enterprise {Enterprise} other {}} plan is required to access this feature {hasLearnMore, select, true {{learnMoreLink}} other {} }",id:"collectionSettings.collectionPremiumFeatureUpsell.noExpiration.description",values:{upsellTier:e,hasLearnMore:n,learnMoreLink:(0,s.jsx)(r().V,{})}})}},219348:(e,t,n)=>{n.d(t,{DV:()=>v,EQ:()=>g,Mu:()=>h,Nr:()=>f,cP:()=>u,m0:()=>m,m2:()=>d,s8:()=>p});n(898992),n(354520),n(672577);var o=()=>n(242422),i=()=>n(56366),r=()=>n(84520),s=()=>n(821062),a=()=>n(72234),l=()=>n(231297),c=()=>n(765957);const d={"baseball-cap":"permanent",bow:"permanent",cat:"permanent",cherry:"permanent",cowboy:"permanent",crown:"permanent",duck:"permanent",firefighter:"permanent",flower:"permanent",glasses:"permanent",headphone:"permanent",leaf:"permanent",magician:"permanent",mustache:"permanent",paprika:"permanent",pencil:"permanent",propeller:"permanent","safety-hat":"permanent",scarf:"permanent","seasonal-bat":"october25","seasonal-demon":"october25","seasonal-frankenstein":"october25","seasonal-pumpkin":"october25"};function u(e){const{store:t,from:n}=e;if(t.update((e=>({...e,isOpen:!0,openCount:e.openCount+1,from:n||"unknown"}))),e.shouldSetSeenPersonalizationSettingsModal){const{sidebarSpaceViewStore:t}=c().default.state;t&&l().createAndCommit({environment:e.environment,userAction:"AgentPersonalizationSettings.markSeen",canUndo:!1,perform:e=>{const n=t.getSettings()||{},o={...n,agent_personalization_settings:{...n.agent_personalization_settings||{},has_already_seen_personalization_settings_modal:!0}};a().AG(t,e,o)}})}}function p(e){const{store:t}=e;t.update((e=>({...e,isOpen:!1})))}function m(e){const{store:t}=e;return t.state.isOpen}function g(e){const{store:t}=e;return t.state.from||"unknown"}function h(e){var t;const{environment:n,agentName:o,customizationItems:i,newPageIdToAdd:r,contextPageId:d}=e,{sidebarSpaceViewStore:u}=c().default.state;if(!u)return;const p=null===(t=u.getSettings())||void 0===t?void 0:t.agent_personalization_settings;let m=(null==p?void 0:p.recently_used_pages)||[];r&&(m=m.filter((e=>e.page_id!==r)),m.unshift({page_id:r,used_at:Date.now()}),m=m.slice(0,10));const g={name:o,customization_items:i,context_page_id:d,recently_used_pages:m.length>0?m:void 0,has_already_seen_personalization_settings_modal:(null==p?void 0:p.has_already_seen_personalization_settings_modal)||!0};(0,s().A)(g,p)||l().createAndCommit({environment:n,userAction:"AgentPersonalizationSettings.save",canUndo:!0,perform:e=>{const t=u.getSettings()||{},n={...t,agent_personalization_settings:{...t.agent_personalization_settings||{},...g}};a().AG(u,e,n)}})}function f(){return(0,i().K8)((()=>{const e=o().default.getConfigKey("agent_seasonal_accessories","batch"),t=o().default.getConfigKey("agent_seasonal_accessories","batch_expiration_time"),n=t&&new Date(t)<new Date;return r().sy.filter((t=>{const o=d[t];return"permanent"===o||o===e&&!n}))}),[])}function v(e){const t=f();return(0,i().K8)((()=>{var n,i;const s=null==e||null===(n=e.getSettings())||void 0===n?void 0:n.agent_personalization_settings;if(null!=s&&null!==(i=s.customization_items)&&void 0!==i&&i[0]){const e=s.customization_items[0];if(t.includes(e))return e}const a=o().default.getEligibleGroup({experimentId:"nosy_default_accessory"}),l=(null==s?void 0:s.has_already_seen_personalization_settings_modal)??!1;if(a&&"control"!==a&&!l){const e=r().sy.find((e=>e===a));if(e)return e}}),[e,t])}},256863:(e,t,n)=>{n.d(t,{A:()=>s});n(296540);var o=()=>n(56366),i=()=>n(824862),r=n(474848);const s=function(e){const{botValue:t,botStore:s,showActiveDot:a,style:l,size:c}=e,d=(0,n(69708).tz)(),u=(0,o().K8)((()=>{if(s){const e=s.getIcon();if(e)return{pointer:{table:i().GP,id:s.id,spaceId:s.getSpaceId()},icon:e}}else if(null!=t&&t.icon)return{pointer:{table:i().GP,id:t.id,spaceId:t.space_id},icon:t.icon}}),[s,t]),p=(0,o().K8)((()=>(null==s?void 0:s.getDisplayName(d))??(0,n(799288).Hg)(t)),[s,t,d]),{activeDotStyle:m}=(0,n(401497).IS)((e=>({activeDotStyle:{height:10,width:10,backgroundColor:e.palette.green[400],border:"2px solid white",borderRadius:"50%",position:"absolute",insetInlineStart:11,top:11}})),[]);return(0,r.jsxs)("div",{style:l,children:[(0,r.jsx)(n(187820).B6,{icon:u,title:p,size:c||18,disabled:!0,isEmptyPage:!1,useInvertedColors:!0}),a?(0,r.jsx)("div",{style:m}):void 0]})}},265665:(e,t,n)=>{n.d(t,{j:()=>c});var o=n(296540),i=()=>n(484714),r=()=>n(401497),s=()=>n(284371),a=()=>n(859428);var l=n(474848);function c({children:e,style:t,tooltipStyle:n,placement:c="bottom"}){const{isSafari:d}=(0,i().Y0)(),u=(0,o.useRef)(null),p=function(e){const[t,n]=(0,o.useState)(!1);return(0,o.useEffect)((()=>{const{current:t}=e;if(!t)return void n(!1);const o="ResizeObserver"in window?new ResizeObserver((([e])=>{n(e.target.scrollWidth>e.target.clientWidth)})):void 0;return null==o||o.observe(t),()=>null==o?void 0:o.unobserve(t)}),[]),t}(u),m=(0,r().IS)((()=>({overflowText:{...s().RC,...t}})),[t]);return(0,l.jsx)(a().A,{delayThreshold:500,placement:c,textWrap:!0,style:n,forceVisibleState:!(d||!p)&&void 0,renderTooltip:()=>p?e:void 0,render:t=>(0,l.jsx)("div",{ref:u,style:m.overflowText,...t,children:e})})}},267155:(e,t,n)=>{n.d(t,{z:()=>a});n(296540);var o=()=>n(401497),i=()=>n(69708),r=()=>n(89924),s=n(474848);function a(e){const t=(0,o().IS)((()=>({container:{paddingBlock:4}})),[]);return(0,s.jsx)(r().A,{title:e.hideTitle?void 0:(0,s.jsx)(i().sA,{id:"inviteUserModal.searchDropdown.selectPersonTitle",defaultMessage:"Select a person"}),style:t.container,...e})}},289190:(e,t,n)=>{n.d(t,{m:()=>i});class o extends(()=>n(757695))().Store{getInitialState(){return{type:"uninitialized"}}isWriting(){return"filling"===this.state.type&&!this.state.haveAllBlocksCompletedAutofill&&!this.state.didInterruptStreaming}setIsWriting(e){const{propertySchema:t,stores:o,sessionIdForAnalytics:i,collectionId:r}=e,s=i||n(206267).JW();return this.setState({type:"filling",propertySchema:t,collectionId:r,numBlocksToAutofill:o.length,numBlocksAutofilled:0,sessionId:s,didInterruptStreaming:!1,haveAllBlocksCompletedAutofill:!1}),s}}const i=new o},313171:(e,t,n)=>{n.d(t,{L:()=>s});n(296540);var o=()=>n(970236),i=()=>n(69708),r=n(474848);function s(){return(0,r.jsx)(o().E,{content:(0,r.jsx)(i().sA,{id:"spaceUserMembershipType.restrictedMember",defaultMessage:"Restricted"}),color:"yellow"})}},367424:(e,t,n)=>{n.d(t,{D:()=>p});n(296540);var o=()=>n(401497),i=()=>n(252291),r=()=>n(532940),s=()=>n(284371),a=()=>n(198491),l=()=>n(859428),c=()=>n(553965),d=()=>n(817126),u=n(474848);function p({propertySchema:e}){const t=(0,d().kg)(e);return t?(0,u.jsx)(m,{featureName:t}):null}function m({featureName:e}){const t=(0,o().IS)((e=>({container:{display:"flex",flexDirection:"column",gap:4,width:200,textWrap:"wrap"},title:{lineHeight:s().K_.UISmall.desktop,fontSize:s().J.UISmall.desktop},description:{lineHeight:s().K_.UISmall.desktop,fontSize:s().J.UISmall.desktop,color:e.text.secondary}})),[]),n=(0,d().uF)({featureName:e});if(null==n||!n.upsell)return null;const{upsellTier:p,expirationDate:m}=n;return(0,u.jsx)(l().A,{placement:"top",render:e=>(0,u.jsx)("div",{...(0,c().A)(e),children:(0,u.jsx)(i().I,{icon:r().exclamationMarkTriangleIcon,colorPalette:"yellow",colorVariant:"accentPrimary",style:{padding:2}})}),renderTooltip:()=>(0,u.jsxs)("div",{style:t.container,children:[(0,u.jsx)("div",{style:t.title,children:(0,u.jsx)(a().e,{upsellTier:p})}),(0,u.jsx)("div",{style:t.description,children:(0,u.jsx)(a().A,{expirationDate:m,upsellTier:p})})]})})}},388182:(e,t,n)=>{n.d(t,{A:()=>o});const o=n(757695).Store.createValue({open:!1},{name:"ConfirmOverwriteModalStore"})},408839:(e,t,n)=>{n.d(t,{t:()=>l});n(296540);var o=()=>n(56366),i=()=>n(112886),r=()=>n(115314),s=()=>n(763870),a=n(474848);function l({collectionStore:e,property:t,propertySchema:n,style:l,blockStore:c}){const d=(0,s().i)({collectionStore:e,property:t,propertySchema:n,blockStore:c}),u=(0,o().K8)((()=>{if(!d)return null;const{role:e}=d,t=n.name;return(0,r().v)(e,t)}),[d,n.name]),p=(0,i().keyFillSmallIcon)({width:12,height:12,verticalAlign:"middle",display:"inline-block",marginBottom:2});return u?(0,a.jsxs)("span",{style:l,children:[p," ",u]}):null}},412236:(e,t,n)=>{n.d(t,{V:()=>d});var o=n(296540),i=()=>n(401497),r=()=>n(69708),s=()=>n(284371),a=()=>n(719147),l=n(474848);const c="https://www.notion.com/pricing";function d(){const[e,t]=(0,o.useState)(!1),n=(0,i().IS)((t=>({default:{color:t.blue.text.accentPrimary,textDecoration:e?"underline":"none",fontWeight:s().Wy.medium}})),[e]);return(0,l.jsx)(a().A,{href:c,external:!0,style:{...n.default},hoverColor:"blue",onMouseEnter:()=>t(!0),onMouseLeave:()=>t(!1),children:(0,l.jsx)(r().sA,{id:"PackingChangeLearnMore.learnMore",defaultMessage:"Learn more"})})}},417555:(e,t,n)=>{n.d(t,{A:()=>c});n(296540);var o=()=>n(784892),i=()=>n(738418),r=()=>n(695608),s=()=>n(534177),a=()=>n(698449),l=n(474848);const c=function({isStrikedThrough:e,backgroundColor:t,onClickRemove:c,target:d,disabled:u,showInfoIcon:p,style:m,shouldWrap:g}){const h=(0,n(484714).v3)(),f=(0,n(69708).tz)(),{device:v}=h,y=(0,n(56366).K8)((()=>function({target:e,intl:t,showInfoIcon:n}){let o;switch(e.type){case"newUser":o=e.value.email.trim();break;case"existingUser":o=(0,r().c6)(t,e.value);break;case"group":o=(0,a().Pf)({intl:t,groupName:e.value.name});break;default:(0,s().HB)(e)}return n?(c=o,(0,l.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,i().G)({marginInlineEnd:4,width:14,height:14}),c]})):o;var c}({target:d,intl:f,showInfoIcon:p})),[d,f,p]);return(0,l.jsx)(n(881690).A,{showRemoveButton:!0,isSingle:!0,isStrikedThrough:e,backgroundColor:t,format:v.isMobile?o().NY.Large:o().NY.Medium,onClickRemove:e=>function(e,t,n){e.stopPropagation(),t(n)}(e,c,d),disabled:u,disabledFeedback:!0,value:y,style:m,shouldWrap:g})}},423657:(e,t,n)=>{n.d(t,{A:()=>l});var o=()=>n(299545),i=()=>n(78846),r=()=>n(707396),s=()=>n(765957);function a(e,t){return(0,i().h)(e)?{isGuestRequestRequired:!0}:t?{isStoreInTeam:!0,teamAllowsGuests:!0,spaceAllowsGuests:!0,isGuestRequestRequired:!1}:{isStoreInTeam:!1,spaceAllowsGuests:!0,isGuestRequestRequired:!1}}const l=function(e){return(0,n(56366).K8)((()=>{if((0,o().nw)(e))return{isStoreInTeam:!1,spaceAllowsGuests:!0,isGuestRequestRequired:!1};if("workflow"===e.table){const e=s().default.state.sidebarSpaceStore;return(0,r().r)(e)?a(e,void 0):{isStoreInTeam:!1,spaceAllowsGuests:!(null!=e&&e.getDisableGuests()),isGuestRequestRequired:!1}}if(!(0,o()._p)(e))return(0,r().r)(e)?a(e,void 0):{isStoreInTeam:!1,spaceAllowsGuests:!0,isGuestRequestRequired:!1};const t=(0,n(422366).U)(e),i=(0,n(672873).p)(e),l=i||s().default.state.sidebarSpaceStore;if((0,r().r)(l))return a(l,t);const c=!(null!=i&&i.getDisableGuests());return t?{isStoreInTeam:!0,teamAllowsGuests:!t.getDisableGuests(),spaceAllowsGuests:c,isGuestRequestRequired:!1}:{isStoreInTeam:!1,spaceAllowsGuests:c,isGuestRequestRequired:!1}}),[e])}},427636:(e,t,n)=>{n.d(t,{A:()=>i});n(296540);var o=n(474848);const i=function(e){const{botStore:t,avatarSize:i,shouldShowBadge:r,style:s,inline:a}=e,l=(0,n(69708).tz)(),c=(0,n(484714).Y0)(),d=(0,n(56366).K8)((()=>null==t?void 0:t.getDisplayName(l)),[t,l]),{outerStyle:u,avatarWrapStyle:p,badgeStyle:m}=(0,n(401497).IS)((e=>({outerStyle:{display:"flex",alignItems:"center",minWidth:0,...s},avatarWrapStyle:a?{width:"none",minHeight:"none",marginInlineEnd:6}:{marginInlineEnd:6},badgeStyle:{padding:"2px 6px",borderRadius:4,color:e.text.secondary,background:e.legacyDefaultSelectColor,fontSize:n(726637).A.isMobile?11:9,lineHeight:c.isAndroid?1.5:1,textTransform:"uppercase",letterSpacing:"0.04em",marginInlineStart:8,marginTop:1}})),[s,a,c]);return(0,o.jsxs)("div",{style:u,children:[(0,o.jsx)("div",{style:p,children:(0,o.jsx)(n(256863).A,{botStore:t,size:i})}),(0,o.jsx)("div",{style:{...n(284371).RC},children:d}),r?(0,o.jsx)("div",{style:m,children:"Bot"}):void 0]})}},448693:(e,t,n)=>{n.d(t,{Ay:()=>S,t_:()=>x,v7:()=>k});n(296540);var o=()=>n(484714),i=()=>n(56366),r=()=>n(764880),s=()=>n(784892),a=()=>n(534177),l=()=>n(313364),c=()=>n(258836),d=()=>n(842677),u=()=>n(870092),p=()=>n(427636),m=()=>n(256863),g=()=>n(848401),h=()=>n(994006),f=()=>n(453697),v=n(474848);function y(e){const t=(0,o().v3)(),{actor:n,format:r,hasTooltip:y,tooltipHeader:S,hasPersonHoverCard:x}=e,k=(0,i().K8)((()=>{const e=n.asActor;return e&&d().RecordStores.createUniqueRootStore(t,e.pointer)}),[n,t]);return(0,v.jsx)(g().Ay,{...e,renderAvatar:e=>{if(k)return k instanceof c().v?r===s().NY.Inline?(0,v.jsx)(m().A,{botStore:k,size:e,style:b}):(0,v.jsx)(p().A,{botStore:k,avatarSize:e,inline:!0,style:b}):k instanceof u().L?r===s().NY.Inline?(0,v.jsx)(f().A,{userStore:k,size:e,avatarShouldShowShadow:!0,hasTooltip:y??!0,style:b,tooltipHeader:S,hasPersonHoverCard:x}):(0,v.jsx)(h().A,{userStore:k,avatarSize:e,inline:!0,hasTooltip:y,hasPersonHoverCard:x,style:b,tooltipHeader:S}):void(k instanceof l().p||(0,a().HB)(k))}})}const b={minWidth:0};y.Format=s().NY;const S=y;function x(e){const{userValue:t,...n}=e;return(0,v.jsx)(y,{actor:(0,r().MR)(t),...n})}function k(e){const{botValue:t,...n}=e;return(0,v.jsx)(y,{actor:(0,r().oC)(t),...n})}x.Format=g().mI,k.Format=g().mI},448801:(e,t,n)=>{n.d(t,{i:()=>i});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698);var o=()=>n(371562);o();function i(e,t){const n=o().create({arrays:{detectMove:!1,includeValueOnMove:!0}}).diff(e,t);if(!n)return{beforeOps:{},removeOps:new Set};let i=[],r=[];for(const o in n)"_t"!==o&&("_"===o[0]?i.push(parseInt(o.slice(1),10)):1===n[o].length&&r.push({index:parseInt(o,10),value:n[o][0]}));const s={},a=new Set,l=[...e];i=i.sort(((e,t)=>e-t));for(let o=i.length-1;o>=0;o--){const e=i[o],t=l.splice(e,1)[0];a.add(t)}r=r.sort(((e,t)=>e.index-t.index));for(let o=0;o<r.length;o++){const e=r[o];s[e.value]=l[e.index],l.splice(e.index,0,e.value)}return{beforeOps:s,removeOps:a}}},471095:(e,t,n)=>{n.d(t,{i:()=>i});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"3.97 1.95 12.05 15.66",svg:(0,n(474848).jsx)("path",{d:"M6 5.95a4 4 0 1 1 8 0v1.433a2.426 2.426 0 0 1 2.025 2.392v5.4A2.425 2.425 0 0 1 13.6 17.6H6.4a2.425 2.425 0 0 1-2.425-2.425v-5.4c0-1.203.876-2.201 2.025-2.392zm6.75 1.4v-1.4a2.75 2.75 0 1 0-5.5 0v1.4zm-2.2 5.458a1.35 1.35 0 1 0-1.1 0v1.242a.55.55 0 0 0 1.1 0z"})},i=(0,n(340498).wt)("lockFill",o)},482871:(e,t,n)=>{n.d(t,{z:()=>d});n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(430670),n(581454);var o=()=>n(898244),i=()=>n(448801),r=()=>n(179034),s=()=>n(722101),a=()=>n(878710),l=(n(354520),()=>n(496603));function c(e){const{collectionContextStore:t,collectionViewStore:n,transaction:i}=e,c=n.getPageSortStore(),d=c.getValue(),u=t.groupsStore.getAllGroupStates(),p=function(e){const{pageSort:t,currentResults:n}=e;if(!t||t.length<=o().WF)return[];const i=t.filter((e=>!n.has(e)));return l().sb([...i.reverse(),...l().o8(t).reverse()]).slice(0,t.length-o().WF)}({pageSort:d,currentResults:new Set(u.flatMap((e=>e.resultsStore.state.map((e=>e.id)))))});for(const o of p)s().TF({parentStore:c,childToRemoveStore:(0,a().v3)(c,{table:r().ev,id:o}),transaction:i})}function d(e){const{resultIds:t,collectionViewStore:n,collectionContextStore:l,transaction:d}=e,u=n.getPageSortStore(),p=u.getValue()||[],{beforeOps:m}=(0,i().i)(p,t.slice(0,o().WF));for(const[o,i]of Object.entries(m))if(i){const e=(0,a().v3)(n,{table:r().ev,id:i});s().nc({parentStore:u,insertStore:(0,a().v3)(n,{table:r().ev,id:o}),beforeStore:e,transaction:d})}else{const e=t.findIndex((e=>e===o)),i=t[e-1],l=i?(0,a().v3)(n,{table:r().ev,id:i}):void 0;s().WH({parentStore:u,insertStore:(0,a().v3)(n,{table:r().ev,id:o}),afterStore:l,transaction:d})}c({collectionContextStore:l,collectionViewStore:n,transaction:d})}},491848:(e,t,n)=>{n.d(t,{w:()=>i});n(898992),n(672577);var o=()=>n(755199);function i({collectionContextStore:e,transaction:t}){const n="collectionTypedView"===e.contextType,i=e.databaseType,r=e.collectionStoresStore.state,s=r.find((e=>e.canEdit()||e.canEditCollection()||e.canEditContentOnly()))||r[0];!n&&s&&o().ee({transaction:t,databaseType:i,collectionId:s.id})}},505108:(e,t,n)=>{n.d(t,{a:()=>m});var o=n(296540),i=()=>n(401497),r=()=>n(699143),s=()=>n(493552),a=()=>n(534177),l=()=>n(284371),c=()=>n(819121),d=()=>n(451306),u=n(474848);function p(e){const{disabled:t,checked:n,selectorSize:o}=e,[r,s]=(0,c().A)(),a=function(e){const{checked:t,disabled:n,isFocusVisible:o,selectorSize:r}=e;return(0,i().IS)((e=>({root:{position:"absolute",display:"flex",width:15,height:15,padding:5,margin:1.5,justifyContent:"center",alignItems:"center",gap:8,flexShrink:0,borderRadius:"50%",transition:"background 100ms ease-out",...t?{boxShadow:`0 0 0 1.5px ${n?e.background.tertiaryTranslucent:e.blue.background.accentPrimary}`,background:n?e.background.tertiaryTranslucent:e.blue.background.accentPrimary}:{boxShadow:`0 0 0 1.5px ${n?e.icon.quaternary:e.border.strong}`,background:e.background.primary},...o&&{boxShadow:e.buttonBlueFocusRing}},active:{background:t?e.blueButtonPressedBackground:e.buttonHoveredBackground},input:{opacity:0,width:"small"===r?14:18,height:"small"===r?14:18,...n?{pointerEvents:"none"}:{cursor:"pointer"}}})),[t,n,o,r])}({checked:n,disabled:t,isFocusVisible:s,selectorSize:o});return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("input",{ref:r,type:"radio",style:a.input,className:"radio-button",...e}),(0,u.jsx)("span",{...(0,d().AH)("custom-radio-button",a.root,t?{}:{pseudoActive:a.active})})]})}const m=o.forwardRef((function({additionalContent:e,description:t,isDisabled:n,isSelected:s,label:a,name:c,onChange:d,width:p="fill",selectorSize:m="normal",selectAlignXAxis:f="left",selectAlignYAxis:v="center",selectType:y="checkbox",style:b,supportText:S,value:x,colorVariant:k,alignAdditionalContent:C,...A},I){const w=(0,o.useId)(),M=function(e){const{isSelected:t,isDisabled:n,selectAlignYAxis:o,alignAdditionalContent:r}=e;return(0,i().IS)((e=>{const i=t&&!n?e.blue.border.accentPrimary:e.border.primary;return{container:{display:"flex",alignItems:r??"center",gap:12,userSelect:"none",paddingTop:9,paddingInlineEnd:16,paddingBottom:10,paddingInlineStart:10,borderRadius:6,border:`1px solid ${i}`,...!n&&{cursor:"pointer"}},title:{fontWeight:l().Wy.medium,fontSize:14,userSelect:"none",lineHeight:18},additionalContentWrapper:{flexShrink:0},selectorWrapper:{display:"flex",..."top"===o?{marginTop:2}:{}},rightAlignSelectorWrapper:{display:"flex"}}}),[t,n,o,r])}({isSelected:s,isDisabled:n,selectAlignYAxis:v,alignAdditionalContent:C}),T=(0,u.jsxs)(r().Y1,{direction:"horizontal",align:"top"===v?"top-left":"center-left",gap:12,width:p,children:[(0,u.jsx)("div",{style:M.selectorWrapper,children:(0,u.jsx)(h,{id:w,selectType:y,name:c,value:x,onChange:d,isSelected:s,selectorSize:m,isDisabled:n,...A})}),(0,u.jsx)(g,{colorVariant:k,description:t,label:a,selectorSize:m,supportText:S,isDisabled:n})]}),j=(0,u.jsxs)(r().Y1,{direction:"horizontal",align:"top"===v?"top-center":"center",gap:12,children:[(0,u.jsx)(g,{colorVariant:k,description:t,label:a,selectorSize:m,supportText:S,isDisabled:n}),(0,u.jsx)("div",{style:{...M.selectorWrapper,...M.rightAlignSelectorWrapper},children:(0,u.jsx)(h,{id:w,selectType:y,name:c,value:x,onChange:d,selectorSize:m,isSelected:s,isDisabled:n,...A})})]}),P=e?(0,u.jsx)("div",{style:M.additionalContentWrapper,children:e}):null;return(0,u.jsx)("label",{ref:I,style:{...M.container,...b},htmlFor:w,children:"left"===f?(0,u.jsxs)(u.Fragment,{children:[T,P]}):(0,u.jsxs)(u.Fragment,{children:[P,j]})})}));function g(e){const{description:t,label:n,supportText:o,selectorSize:i,isDisabled:l,colorVariant:c}=e;let d;return"large"===i?d="Page-Content/Text-Block":"normal"===i||void 0===i?d="Body-sm/Medium":"small"===i?d="Caption/Regular":(0,a().HB)(i),(0,u.jsxs)(r().Y1,{gap:4,children:[(0,u.jsxs)(r().Y1,{gap:2,children:[(0,u.jsx)(s().D,{styleKey:d,colorVariant:c||(l?"disabled":"primary"),children:n}),t?(0,u.jsx)(s().D,{styleKey:"Caption/Regular",colorVariant:l?"disabled":"secondary",children:t}):null]}),o?(0,u.jsx)(s().D,{styleKey:"Caption/Medium",colorVariant:"tertiary",children:o}):null]})}function h(e){const{selectType:t,selectorSize:o="normal",id:r,name:s,value:l,onChange:c,isSelected:d,isDisabled:m,...g}=e,h=(0,i().IS)((()=>({checkboxWrapper:{minWidth:18,display:"flex",justifyContent:"center"}})),[]);switch(t){case"radio":return(0,u.jsx)(p,{id:r,name:s,value:l,onChange:c,checked:d,disabled:m,selectorSize:o,...g});case"checkbox":return(0,u.jsx)("div",{style:h.checkboxWrapper,children:(0,u.jsx)(n(115562).W,{id:r,name:s,value:l,onChange:c,checked:d,disabled:m,selectorSize:o,...g})});case"none":return null;default:(0,a().HB)(t)}}},541235:(e,t,n)=>{n.d(t,{Ud:()=>s,YD:()=>r,c$:()=>o,q_:()=>i});const o={"sprints-onboarding":{steps:[{id:"current-sprint-view-tooltip"},{id:"sprint-task-tooltip"},{id:"complete-sprint-button-tooltip"}]},"enhanced-qna-onboarding":{steps:[{id:"find-in-tooltip"},{id:"mention-tooltip"}]},"jira-sync-onboarding":{steps:[{id:"all-projects-tooltip"},{id:"all-issues-tooltip"},{id:"database-views-and-filters-tooltip"},{id:"settings-to-setup-projects-and-issues"}]},"project-management-import-onboarding":{steps:[{id:"your-teamspace-tooltip"},{id:"all-projects-tooltip"},{id:"navigate-to-project-tasks-tooltip"},{id:"project-customization-tooltip"},{id:"related-tasks-database-views-tooltip"}]},"ai-comment-onboarding":{steps:[{id:"ai-comment-onboarding-tooltip"}]},database_onboarding:{steps:[{id:"database_onboarding_status_property_tooltip"},{id:"database_onboarding_add_property_tooltip"},{id:"database_onboarding_database_page_tooltip"},{id:"database_onboarding_board_view_tooltip"}]}},i="completed",r="dismissed";function s(e,t){return null==t?void 0:t[e]}},551619:(e,t,n)=>{n.d(t,{Hy:()=>M,NV:()=>I,O9:()=>j,Rg:()=>T,Sm:()=>B,f7:()=>P,n$:()=>_,no:()=>E,sx:()=>w});var o=()=>n(59226),i=()=>n(726637),r=()=>n(402014),s=()=>n(484714),a=()=>n(792485),l=()=>n(56366),c=()=>n(700500),d=()=>n(519831),u=()=>n(620689),p=()=>n(591197),m=()=>n(835066),g=()=>n(964345),h=()=>n(267584),f=()=>n(478726),v=()=>n(747100),y=()=>n(665579),b=()=>n(765957),S=()=>n(375447),x=()=>n(66496),k=()=>n(548821),C=()=>n(712505),A=()=>n(302022);function I(e){(0,r().SQ)({event:e,context:r().y$.EditorMouseDown,callback:()=>{}})}function w(e){(0,r().SQ)({event:e,context:r().y$.Click,callback:()=>{}})}function M(e){return(0,l().K8)((()=>Boolean(A().A.state.pageMap[e.id])||x().A.state.pages.has(e.id)),[e.id])}function T(e,t){const n=(0,s().v3)(),o=(0,a().S)(),i=M(e),r=(0,l().K8)((()=>{var n,o;return t===k().Rr.Frame?Boolean(null===(n=b().default.state.currentLoadingContainerStore)||void 0===n?void 0:n.state.ready):t===k().Rr.PeekView&&C().default.state.open?Boolean(null===(o=C().default.state.loadingContainerStore)||void 0===o?void 0:o.state.ready):t===k().Rr.CollectionPageView||t===k().Rr.CollectionPageViewFullScreen?e.isReady():void 0}),[t,e]),c=P(e);return(0,l().K8)((()=>{if(!r)return!1;const t=n.currentUser.isLoggedIn(),s=o&&o.publicEditModeStore.state;return Boolean(e&&e.isDefined()&&!e.isNonEditableState()&&e.canEdit()&&!e.hasContent()&&t&&(!(null!=s&&s.hasPublicPermission)||"edit"===(null==s?void 0:s.permission))&&!i&&!c)}),[n.currentUser,c,r,o,i,e])}function j(e,t){const n=(0,s().v3)(),r=(0,a().S)(),{isTablet:c}=(0,s().Y0)(),d=(0,o().X)("tablet_refresh_template_pills_gate");return(0,l().K8)((()=>{if(t===k().Rr.SitePreview)return!1;if(i().A.isMobile&&(!c||!d))return!1;if(!n.currentUser.isLoggedIn())return!1;const o=r&&r.publicEditModeStore.state;if(null!=o&&o.hasPublicPermission&&"edit"!==(null==o?void 0:o.permission))return!1;if(e.getContentLength()>1)return!1;if(!e.canEdit()||e.isNonEditableState())return!1;const s=e.getContentStores()[0];if(s&&!s.isEmptyTextBlock())return!1;if(e.getAssociatedCollectionStore())return!1;const a=g().gZ.state,l=g().Di.state;if(a&&e.id===l)return!1;return!((0,f().L5)(t)?p().VY.state:p().u3.state)}),[n,r,e,t,c,d])}function P(e){return(0,l().K8)((()=>{if(e.isCollectionView()){const t=e.getCollectionStoreIfSingleSource();return!!t&&t.isSyncedCollection()}return e.isType(c().xd.externalObjectInstancePage)}),[e])}function B(e){return(0,l().K8)((()=>{if(!(0,h().vL)())return!1;const t=e.getParentStore();if((null==t?void 0:t.table)===d().Vl){return!!t.getFormatStore().getKeyStore("external_collection_type").getValue()}return!1}),[e])}function _(e){const t=(0,s().v3)(),{device:n,WindowSizeStore:o}=t,r=(0,l().K8)((()=>{const e=o.state.height,n=i().A.isMobile&&S().Ay.state.open?e:0;return u().C6(t)+n}),[t,o]);return(0,l().K8)((()=>"home-phone"===e?y().q3:n.isTablet?380:n.isIOS?Math.max(350,r):i().A.isMobile?400:"side-peek"===e||"center-peek"===e?v().ln:"home"===e?y().wH:"30vh"),[n,r,e])}function E(e){const t=(0,s().v3)(),n=(0,l().K8)((()=>(0,m().dC)(t,e)),[t,e]);return(0,l().K8)((()=>n&&!e.isFullWidth()?(0,m().Zy)(t,(0,v().cq)(e),(0,v().RX)(e)):0),[t,n,e])}},555267:(e,t,n)=>{n.d(t,{A:()=>l});var o=n(296540),i=()=>n(401497),r=()=>n(98126),s=()=>n(62856),a=n(474848);function l({loadingMessage:e}){const t=(0,i().DP)(),n=(0,s().A)(!0,400);return(0,a.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},children:n?(0,a.jsxs)(o.Fragment,{children:[(0,a.jsx)(r().k,{}),e?(0,a.jsx)("div",{style:{marginInlineStart:8,color:t.text.secondary},children:e}):void 0]}):void 0})}},557297:(e,t,n)=>{n.d(t,{lz:()=>r,nO:()=>i,wl:()=>s});var o=()=>n(645873);const i={chatSidebar:new(o().O2)("chatSidebar",(()=>Promise.all([n.e(9773),n.e(55373),n.e(36192),n.e(71562),n.e(96346),n.e(44711),n.e(53321),n.e(45158),n.e(87249),n.e(71621),n.e(88924),n.e(92845),n.e(56369),n.e(5834),n.e(48486),n.e(2411),n.e(89296),n.e(46414),n.e(9294),n.e(11676),n.e(91256),n.e(40563),n.e(67494),n.e(44584),n.e(53141),n.e(35564),n.e(87487),n.e(28463),n.e(2703)]).then(n.bind(n,942646)))),chatSidebarActions:new(o().O2)("chatSidebarActions",(async()=>await Promise.resolve().then(n.bind(n,118078)))),chatSidebarHelpers:new(o().O2)("chatSidebarHelpers",(async()=>await Promise.resolve().then(n.bind(n,890754)))),chatSidebarModeButton:new(o().O2)("chatSidebarModeButton",(async()=>await Promise.all([n.e(75134),n.e(9773),n.e(55373),n.e(36192),n.e(71562),n.e(96346),n.e(44711),n.e(53321),n.e(90825),n.e(16471),n.e(37353),n.e(29151),n.e(87248),n.e(67539),n.e(41383),n.e(87249),n.e(71621),n.e(88924),n.e(92845),n.e(56369),n.e(5834),n.e(48486),n.e(2411),n.e(89296),n.e(46414),n.e(9294),n.e(11676),n.e(91256),n.e(40563),n.e(67494),n.e(44584),n.e(53141),n.e(4422),n.e(4330),n.e(55162),n.e(71003),n.e(55753),n.e(28866),n.e(22001),n.e(71386),n.e(4351),n.e(6331),n.e(69144),n.e(42660),n.e(55997),n.e(40828),n.e(12341),n.e(96402),n.e(84166),n.e(70359),n.e(29595),n.e(16448),n.e(10442),n.e(16434),n.e(45769),n.e(46080),n.e(75902),n.e(99809),n.e(47160),n.e(32254),n.e(34442),n.e(31276),n.e(35738),n.e(77747),n.e(35564),n.e(8501),n.e(91347),n.e(32994),n.e(1499),n.e(94814)]).then(n.bind(n,256499)))),dockedSidebar:new(o().O2)("dockedSidebar",(async()=>await Promise.all([n.e(9773),n.e(55373),n.e(36192),n.e(71562),n.e(96346),n.e(44711),n.e(53321),n.e(45158),n.e(87249),n.e(71621),n.e(88924),n.e(92845),n.e(56369),n.e(5834),n.e(48486),n.e(2411),n.e(89296),n.e(46414),n.e(9294),n.e(11676),n.e(91256),n.e(40563),n.e(67494),n.e(44584),n.e(53141),n.e(35564),n.e(87487),n.e(28463)]).then(n.bind(n,675803)))),mobileChatModal:new(o().O2)("mobileChatModal",(async()=>await Promise.all([n.e(9773),n.e(55373),n.e(36192),n.e(71562),n.e(96346),n.e(87249),n.e(71621),n.e(88924),n.e(92845),n.e(56369),n.e(5834),n.e(48486),n.e(2411),n.e(89296),n.e(46414),n.e(9294),n.e(11676),n.e(91256),n.e(40563),n.e(67494),n.e(44584),n.e(53141),n.e(87487),n.e(63454)]).then(n.bind(n,257819))))},r=(0,o()._h)(i.chatSidebar,(e=>e.ChatSidebar)),s=(0,o()._h)(i.chatSidebarModeButton,(e=>e.ChatSidebarModeButtonPopupContents))},563884:(e,t,n)=>{n.d(t,{k:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("calendar",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M3.24902 14.7764H12.6621C14.1455 14.7764 14.918 14.0107 14.918 12.5479V4.22852C14.918 2.76562 14.1455 2 12.6621 2H3.24902C1.77246 2 1 2.75879 1 4.22852V12.5479C1 14.0107 1.77246 14.7764 3.24902 14.7764ZM3.24219 13.416C2.6748 13.416 2.36035 13.1221 2.36035 12.5205V6.23145C2.36035 5.62988 2.6748 5.33594 3.24219 5.33594H12.6689C13.2363 5.33594 13.5508 5.62988 13.5508 6.23145V12.5205C13.5508 13.1221 13.2363 13.416 12.6689 13.416H3.24219ZM6.63965 7.69434H7.04297C7.28906 7.69434 7.37109 7.61914 7.37109 7.37988V6.97656C7.37109 6.73047 7.28906 6.65527 7.04297 6.65527H6.63965C6.39355 6.65527 6.31152 6.73047 6.31152 6.97656V7.37988C6.31152 7.61914 6.39355 7.69434 6.63965 7.69434ZM8.875 7.69434H9.27832C9.51758 7.69434 9.59961 7.61914 9.59961 7.37988V6.97656C9.59961 6.73047 9.51758 6.65527 9.27832 6.65527H8.875C8.62891 6.65527 8.54688 6.73047 8.54688 6.97656V7.37988C8.54688 7.61914 8.62891 7.69434 8.875 7.69434ZM11.1035 7.69434H11.5068C11.7529 7.69434 11.835 7.61914 11.835 7.37988V6.97656C11.835 6.73047 11.7529 6.65527 11.5068 6.65527H11.1035C10.8643 6.65527 10.7822 6.73047 10.7822 6.97656V7.37988C10.7822 7.61914 10.8643 7.69434 11.1035 7.69434ZM4.41113 9.89551H4.80762C5.05371 9.89551 5.13574 9.82031 5.13574 9.57422V9.1709C5.13574 8.93164 5.05371 8.85645 4.80762 8.85645H4.41113C4.16504 8.85645 4.08301 8.93164 4.08301 9.1709V9.57422C4.08301 9.82031 4.16504 9.89551 4.41113 9.89551ZM6.63965 9.89551H7.04297C7.28906 9.89551 7.37109 9.82031 7.37109 9.57422V9.1709C7.37109 8.93164 7.28906 8.85645 7.04297 8.85645H6.63965C6.39355 8.85645 6.31152 8.93164 6.31152 9.1709V9.57422C6.31152 9.82031 6.39355 9.89551 6.63965 9.89551ZM8.875 9.89551H9.27832C9.51758 9.89551 9.59961 9.82031 9.59961 9.57422V9.1709C9.59961 8.93164 9.51758 8.85645 9.27832 8.85645H8.875C8.62891 8.85645 8.54688 8.93164 8.54688 9.1709V9.57422C8.54688 9.82031 8.62891 9.89551 8.875 9.89551ZM11.1035 9.89551H11.5068C11.7529 9.89551 11.835 9.82031 11.835 9.57422V9.1709C11.835 8.93164 11.7529 8.85645 11.5068 8.85645H11.1035C10.8643 8.85645 10.7822 8.93164 10.7822 9.1709V9.57422C10.7822 9.82031 10.8643 9.89551 11.1035 9.89551ZM4.41113 12.0898H4.80762C5.05371 12.0898 5.13574 12.0146 5.13574 11.7754V11.3721C5.13574 11.126 5.05371 11.0508 4.80762 11.0508H4.41113C4.16504 11.0508 4.08301 11.126 4.08301 11.3721V11.7754C4.08301 12.0146 4.16504 12.0898 4.41113 12.0898ZM6.63965 12.0898H7.04297C7.28906 12.0898 7.37109 12.0146 7.37109 11.7754V11.3721C7.37109 11.126 7.28906 11.0508 7.04297 11.0508H6.63965C6.39355 11.0508 6.31152 11.126 6.31152 11.3721V11.7754C6.31152 12.0146 6.39355 12.0898 6.63965 12.0898ZM8.875 12.0898H9.27832C9.51758 12.0898 9.59961 12.0146 9.59961 11.7754V11.3721C9.59961 11.126 9.51758 11.0508 9.27832 11.0508H8.875C8.62891 11.0508 8.54688 11.126 8.54688 11.3721V11.7754C8.54688 12.0146 8.62891 12.0898 8.875 12.0898Z"})})},567121:(e,t,n)=>{n.d(t,{EG:()=>s,K5:()=>r,RH:()=>i,Yi:()=>a,ls:()=>o});const o=32,i=202,r=1e3,s="Want to add a metric? Look for 'src/client/performanceToolbar/config.ts' in notion-next.",a="To disable the toolbar entirely, go to the 'Experiments' panel and look for the 'performance_debugging_toolbar' flag."},578194:(e,t,n)=>{n.d(t,{r:()=>o});const o=(0,n(583835).Dv)("importEvernote")},580648:(e,t,n)=>{n.d(t,{o:()=>c});n(296540);var o=()=>n(56366),i=()=>n(914462),r=()=>n(69708),s=()=>n(173783),a=()=>n(187820),l=n(474848);function c(e){const{group:t}=e,n=e.size??20,c=(0,r().tz)(),d=(0,o().K8)((()=>{if(t&&t.icon)return{pointer:t.pointer,icon:t.icon}}),[t]),u=(0,o().K8)((()=>(0,i().n)({intl:c,permissionGroupModel:t})),[c,t]);return(0,l.jsx)("div",{children:d?(0,l.jsx)(a().B6,{disabled:!0,size:n,icon:d,isEmptyPage:!1,title:u}):(0,l.jsx)(s().A,{size:n})})}},591197:(e,t,n)=>{n.d(t,{VY:()=>a,ZJ:()=>r,u3:()=>s});var o=()=>n(496506);class i extends(()=>n(757695))().Store{getInitialState(){return{popupRenderedInPage:!1,popupRenderedInPeekView:!1}}}const r=new i,s=new(o().ComputedStore)((()=>!1!==r.state.popupRenderedInPage),{debugName:"AssistantWriterRenderedInPageStore"}),a=new(o().ComputedStore)((()=>!1!==r.state.popupRenderedInPeekView),{debugName:"AssistantWriterRenderedInPeekViewStore"})},617837:(e,t,n)=>{n.d(t,{j:()=>b});var o=n(296540),i=()=>n(564884),r=()=>n(484714),s=()=>n(56366),a=()=>n(401497),l=()=>n(929219),c=()=>n(163749),d=()=>n(340266),u=()=>n(322972),p=()=>n(557943),m=()=>n(69708),g=()=>n(534177),h=()=>n(272200),f=()=>n(966106),v=()=>n(285790),y=n(474848);function b(e){const{traceId:t,feedbackState:n,setFeedbackState:i,feature:c,iconHeight:d}=e,u=(0,a().IS)((e=>({wrapper:{...d?{height:d}:{}},iconButton:{...d?{height:d}:{}}})),[d]),{thumbsUpType:p,thumbsDownType:h}=(0,o.useMemo)((()=>{switch(c){case"ai_block":return{thumbsDownType:"ai_block_thumbs_down",thumbsUpType:"ai_block_thumbs_up"};case"ai_autofill":return{thumbsDownType:"ai_autofill_thumbs_down",thumbsUpType:"ai_autofill_thumbs_up"};default:(0,g().HB)(c)}}),[c]),b=(0,m().tz)(),k=(0,r().v3)(),C=!(0,s().O$)(l().e),A=(0,o.useCallback)((()=>{f().A.setState({...f().A.state,open:!0,type:h,traceId:t,thumbsUpOrDown:"down"}),i({type:"thumbsdown",userContent:"",shareWithNotion:!0}),S({environment:k,feature:c,inferenceId:t,feedbackType:"thumbsdown",userContent:"",shareWithNotion:!0})}),[k,i,h,t,c]),I=(0,o.useCallback)((()=>{f().A.setState({...f().A.state,open:!0,type:p,traceId:t,thumbsUpOrDown:"up"}),i({type:"thumbsup",userContent:"",shareWithNotion:!0}),S({environment:k,feature:c,inferenceId:t,feedbackType:"thumbsup",userContent:"",shareWithNotion:!0})}),[k,i,p,t,c]);return(0,y.jsxs)("div",{onClick:e=>{e.stopPropagation(),e.preventDefault()},style:u.wrapper,children:[(0,y.jsx)(v().A,{onClick:I,icon:x("thumbsup","thumbsup"===(null==n?void 0:n.type)),ariaLabel:b.formatMessage({id:"AiFeatureFeedbackButtons.thumbsUp",defaultMessage:"Helpful"}),disabled:C,style:u.iconButton}),(0,y.jsx)(v().A,{icon:x("thumbsdown","thumbsdown"===(null==n?void 0:n.type)),onClick:A,ariaLabel:b.formatMessage({id:"AiFeatureFeedbackButtons.thumbsDown",defaultMessage:"Not helpful"}),disabled:C,style:u.iconButton})]})}function S(e){const{environment:t,feature:n,inferenceId:o,feedbackType:r,userContent:s,shareWithNotion:a}=e;let l;l="thumbsup"===r?"thumbs_up":"thumbs_down",(0,i().u)({environment:t,event:{eventName:"ai_feedback_given",eventProperties:{feature:n,inference_id:o,sentiment:l}}}),h().trackAIAction(t,{type:"property_autofill",inference_id:o,feedback_type:r,timestamp:(new Date).toUTCString(),user_comment:s,share_with_notion:a})}function x(e,t){switch(e){case"thumbsup":return t?u().P:p().s;case"thumbsdown":return t?c().m:d().d}}},625194:(e,t,n)=>{n.d(t,{m:()=>s});var o=n(296540),i=()=>n(96330),r=n(474848);const s=o.memo((function(e){const{textValue:t}=e,n=(0,o.useMemo)((()=>(0,i().X1)((0,i().eC)(t))),[t]);return(0,r.jsx)("span",{children:n})}))},627503:(e,t,n)=>{n.d(t,{a:()=>i});n(296540);const o={viewBox:"0 0 16 16",fittedViewBox:"1.37 1.37 13.25 13.25",svg:(0,n(474848).jsx)("path",{d:"M3.25 1.375c-1.036 0-1.875.84-1.875 1.875v6c0 1.036.84 1.875 1.875 1.875h1.625v1.625c0 1.036.84 1.875 1.875 1.875h6c1.036 0 1.875-.84 1.875-1.875v-6c0-1.036-.84-1.875-1.875-1.875h-1.625V3.25c0-1.036-.84-1.875-1.875-1.875zM2.625 3.25c0-.345.28-.625.625-.625h6c.345 0 .625.28.625.625v1.625H6.75c-1.036 0-1.875.84-1.875 1.875v3.125H3.25a.625.625 0 0 1-.625-.625zm3.5 3.5c0-.345.28-.625.625-.625h6c.345 0 .625.28.625.625v6c0 .345-.28.625-.625.625h-6a.625.625 0 0 1-.625-.625z"})},i=(0,n(340498).wt)("duplicateSmall",o)},628864:(e,t,n)=>{n.d(t,{Hn:()=>V,XN:()=>R,pj:()=>_,qj:()=>L});n(16280),n(944114),n(898992),n(354520),n(672577),n(581454),n(737550);var o=n(296540),i=()=>n(484714),r=()=>n(56366),s=()=>n(401497),a=()=>n(252291),l=()=>n(98126),c=()=>n(148307),d=()=>n(617871),u=()=>n(70899),p=()=>n(642557),m=()=>n(344417),g=()=>n(32527),h=()=>n(69708),f=()=>n(496603),v=()=>n(973647),y=()=>n(534177),b=()=>n(559506),S=()=>n(510683),x=()=>n(881707),k=()=>n(152197),C=()=>n(62856),A=()=>n(53137),I=()=>n(829e3),w=()=>n(760217),M=()=>n(419357),T=()=>n(89924),j=()=>n(859428),P=n(474848);const B=(0,h().YK)({channelSearchPlaceholder:{id:"notificationRuleSettings.selectChannelView.searchInput.placeholder",defaultMessage:"Searchâ¦"}});function _(e){const{currentNotificationChannels:t,onNotificationChannelSelect:n,onNotificationChannelSelectAll:u,onClose:p,onNewSlackAccountAdded:g,renderMenu:b,channelFilter:I,workflowExternalScopedConnectionPointer:_,isMultiSelectMode:z,shouldHideSlackAccountSection:L,shouldShowSelectAllChannels:N,isAllChannels:F,shouldShowImChannels:H,onClearSelection:O,shouldHideSelectedChannels:W=!1,searchPlaceholder:U=B.channelSearchPlaceholder,shouldShowTooltipsOnChannelNames:K=!1,shouldShowFixedSearch:G=!1,moduleId:q,workflowId:$}=e,Y=(0,i().v3)(),{isMobile:Q}=(0,i().Y0)(),Z=(0,h().tz)(),X=(0,r().O$)(A().A.completeSlackAuthentications),J=e.currentExternalAuthentication??f().$1(X),ee=(0,o.useMemo)((()=>_?{type:"workflow",workflowExternalScopedConnectionId:_.id}:J?{type:"external",botId:J.id}:void 0),[_,J]);o.useEffect((()=>{const e=_?null==_?void 0:_.spaceId:null==J?void 0:J.space_id;ee&&e&&V({environment:Y,spaceId:e,externalAuthConfig:ee,moduleId:q,workflowId:$})}),[Y,ee,J,_,q,$]);const te=(null==_?void 0:_.id)??(null==J?void 0:J.id),[ne,oe]=o.useState(""),{loadedChannelsForAccount:ie,isLoading:re}=R(ee),se=(0,r().K8)((()=>A().A.integrations.state.find((e=>e.id===d().zG))),[]),ae=(0,k().r)(),le=o.useCallback((e=>{J?n(e,J.parent_id):_&&n(e,_.id),z||p()}),[n,J,_,p,z]),ce=o.useCallback((()=>{const e=J?J.parent_id:null==_?void 0:_.id;e&&u&&u(e),z&&N||p()}),[J,_,z,N,u,p]),de=(0,s().IS)((e=>({icon:{marginInlineStart:8,width:12,height:12,color:e.text.tertiary},container:{backgroundColor:e.popoverBackground,marginTop:12,marginBottom:6},searchIcon:{width:14,height:14,marginInlineEnd:6,flexGrow:0,flexShrink:0,color:e.icon.primary},fixedSearchInput:{paddingBlock:4,borderBottom:`1px solid ${e.border.secondary}`}})),[]),ue=o.useCallback((e=>{const{channel:n}=e,o=!F&&(null==t?void 0:t.some((e=>e.id===n.id)));if(!o||!W)return{key:n.id,render:e=>(0,P.jsx)(j().A,{renderTooltip:()=>n.name,disableTooltip:!K,alignment:"center",placement:"right",render:t=>(0,P.jsx)(w().A,{...e,...t,icon:(0,P.jsx)(a().I,{icon:D({channel:n}),colorVariant:"tertiary",size:"sm"}),desktopIconStyle:{width:8},title:n.name,isChecked:o})}),action:()=>{le(n)}}}),[F,t,le,W,K]),{publicChannels:pe,privateChannels:me,personalChannels:ge,imChannels:he}=o.useMemo((()=>function(e,t){const n=[],o=[],i=[],r=[];e.sort(((e,t)=>e.name.localeCompare(t.name)));for(const s of e)t&&!t(s)||("public"===s.type?n.push(s):"private"===s.type?o.push(s):"me"===s.type?i.push(s):"im"===s.type?r.push(s):(0,y().HB)(s.type));return{publicChannels:n,privateChannels:o,personalChannels:i,imChannels:r}}(ie,I)),[I,ie]),fe=o.useCallback((()=>pe.map((e=>({menuListItem:ue({channel:e}),channelName:e.name}))).filter(y().O9)),[pe,ue]),ve=o.useCallback((()=>me.map((e=>({menuListItem:ue({channel:e}),channelName:e.name}))).filter(y().O9)),[me,ue]),ye=o.useCallback((()=>ge.map((e=>({menuListItem:ue({channel:e}),channelName:e.name}))).filter(y().O9)),[ge,ue]),be=o.useCallback((()=>he.map((e=>({menuListItem:ue({channel:e}),channelName:e.name}))).filter(y().O9)),[he,ue]),Se=o.useCallback((()=>fe().map((({menuListItem:e,channelName:t})=>{if(E({channelName:t,query:ne}))return e})).filter(y().O9)),[fe,ne]),xe=o.useCallback((()=>ve().map((({menuListItem:e,channelName:t})=>{if(E({channelName:t,query:ne}))return e})).filter(y().O9)),[ve,ne]),ke=o.useCallback((()=>ye().map((({menuListItem:e,channelName:t})=>{if(E({channelName:t,query:ne}))return e})).filter(y().O9)),[ye,ne]),Ce=o.useCallback((()=>be().map((({menuListItem:e,channelName:t})=>{if(E({channelName:t,query:ne}))return e})).filter(y().O9)),[be,ne]),Ae=o.useCallback((()=>J?(0,x().qO)(J).organizationName:"Workflows organization"),[J]),Ie=o.useCallback((()=>{if(!te)return[];const e=[],n=Se(),o=xe(),i=ke(),r=Ce(),s=N&&z&&!ne,a=Boolean(O&&!ne&&((null==t?void 0:t.length)||F));return a&&O&&e.push({key:"clear-selection-section",render:e=>(0,P.jsx)(T().A,{...e}),items:[{key:"clear-selection",render:e=>(0,P.jsx)(w().A,{...e,title:(0,P.jsx)(h().sA,{id:"workflows.slack.clearSelection",defaultMessage:"Clear selection"}),isChecked:!1}),action:()=>O()}]}),s&&e.push({key:"select-all-channels",render:e=>(0,P.jsx)(T().A,{...e}),items:[{key:"all-channels",render:e=>(0,P.jsx)(w().A,{...e,title:(0,P.jsx)(h().sA,{id:"notificationRuleSettings.selectChannelView.selectAllChannels.label",defaultMessage:"All channels"}),isChecked:F}),action:ce}]}),i.length>0&&e.push({key:"personal-channels",render:e=>(0,P.jsx)(T().A,{...e,title:Ae(),topBorder:s||a}),items:i}),n.length>0&&e.push({key:"public-channels",render:e=>(0,P.jsx)(T().A,{...e,topBorder:i.length>0||s||a,title:0===i.length&&Ae()}),items:n}),o.length>0&&e.push({key:"private-channels",render:e=>(0,P.jsx)(T().A,{...e,topBorder:n.length>0||s||a,title:0===i.length&&n.length>0&&Ae()}),items:o}),H&&r.length>0&&e.push({key:"im-channels",render:e=>(0,P.jsx)(T().A,{...e,title:(0,P.jsx)(h().sA,{defaultMessage:"Direct Messages with Notion",id:"imChannels.title"})}),items:r}),e}),[te,Se,xe,ke,Ce,N,z,ne,O,null==t?void 0:t.length,F,H,ce,Ae]),we=(0,C().A)(re,500,300);if(!te)return null;const Me=[];return G||Me.push({key:"search-input-section",items:[{key:"search-input-item",action:()=>{},render:e=>(0,P.jsx)("div",{children:(0,P.jsx)(M().Ay,{...e,inputLeft:(0,P.jsx)(M().Zf,{icon:m().u}),inputRight:we&&(0,P.jsx)(l().A,{style:{marginInlineEnd:2}}),showClearButton:!0,placeholder:Z.formatMessage(U),focusInitial:!Q,value:ne,onChange:e=>{oe(e.target.value)}})})}],render:e=>(0,P.jsx)(T().A,{...e})}),Me.push(...Ie()),t||L||!se||Me.push({key:"add-another-slack-account-section",items:[{key:"add-another-slack-account-item",action:async()=>{if(!ae)return;const e=await S().Jq({environment:Y,integration:se,spaceId:ae,from:"collection_view_settings"});v().Q.isFail(e)||g()},render:e=>(0,P.jsx)(w().A,{...e,icon:(0,P.jsx)("img",{src:c().A.images.externalIntegrations.slackIconPng,style:{width:18,height:"auto"}}),title:(0,P.jsx)(h().sA,{id:"notificationRuleSettings.selectChannelView.setupAnotherSlackAccount.label",defaultMessage:"Add another Slack account"})})}],render:e=>(0,P.jsx)(T().A,{...e,topBorder:!0})}),(0,P.jsxs)(P.Fragment,{children:[G?(0,P.jsx)("div",{style:de.fixedSearchInput,children:(0,P.jsx)(M().Ay,{...e,inputLeft:(0,P.jsx)(M().Zf,{icon:m().u}),inputRight:we&&(0,P.jsx)(l().A,{style:{marginInlineEnd:2}}),showClearButton:!0,placeholder:Z.formatMessage(U),focusInitial:!Q,value:ne,onChange:e=>{oe(e.target.value)}})}):void 0,b(Me)]})}function E(e){const{channelName:t,query:n}=e;return 0===n.length||t.toLocaleLowerCase().indexOf(n.trim().toLocaleLowerCase())>=0}function D(e){const{channel:t}=e;return"private"===t.type?p().O:"me"===t.type||"im"===t.type?u().U:g().E}const z=15e3;function R(e){const t=(0,r().K8)((()=>{if(e)return I().c.getStateForBot(e)}),[e]);return{loadedChannelsForAccount:(0,o.useMemo)((()=>t?Object.values(t.channels):[]),[t]),isLoading:(null==t?void 0:t.fetching)??!1}}async function V(e){const{environment:t,externalAuthConfig:n,spaceId:o,moduleId:i,workflowId:r}=e,s=I().c.getStateForBot(n);if(!(s.fetching||Date.now()-s.lastRefreshed<z)){if(I().c.updateStateForBot(n,{fetching:!0,lastRefreshed:Date.now(),failed:!1}),"workflow"===n.type&&i&&r){const e=await b().callApi({eventName:"getViaWorkflowModuleConfigurationUtil",environment:t,data:{workflowId:r,moduleId:i,spaceId:o,moduleType:"slack",callArguments:{functionName:"getExistingSlackChannels",functionArgs:[]}}});if("success"===e.type){if("getExistingSlackChannels"!==e.data.functionName)throw new Error("Invalid function name");I().c.addChannelsForBot(n,e.data.functionReturn)}else I().c.updateStateForBot(n,{failed:!0})}else{let e;for(;;){const i=await b().callApi({eventName:"getExternalNotificationChannels",environment:t,data:{spaceId:o,cursor:e,...n}});if("success"!==i.type){I().c.updateStateForBot(n,{failed:!0}),console.error(i.error);break}{const t={};for(const e of i.data.channels)t[e.id]=e;if(I().c.addChannelsForBot(n,t),e=i.data.cursor,!e)break}await new Promise((e=>setTimeout(e,0)))}}I().c.updateStateForBot(n,{fetching:!1})}}const L=o.forwardRef(((e,t)=>{const{channel:n,currentNotificationChannels:o,...i}=e;return(0,P.jsx)(w().A,{ref:t,...i,icon:(0,P.jsx)(a().I,{icon:D({channel:n}),colorVariant:"tertiary",size:"sm"}),desktopIconStyle:{width:8},title:n.name,isChecked:null==o?void 0:o.some((e=>e.id===n.id))})}));L.displayName="SlackChannelMenuItem"},642557:(e,t,n)=>{n.d(t,{O:()=>r});n(296540);var o=n(474848);const i={viewBox:"0 0 16 16",fittedViewBox:"3.17 1.59 9.66 12.45",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M8 8.1a1.125 1.125 0 0 0-.525 2.12v.93a.525.525 0 1 0 1.05 0v-.93A1.125 1.125 0 0 0 8 8.1"}),(0,o.jsx)("path",{d:"M8 1.6a3.25 3.25 0 0 0-3.25 3.25v1a2.026 2.026 0 0 0-1.575 1.975v4.2c0 1.118.907 2.025 2.025 2.025h5.6a2.025 2.025 0 0 0 2.025-2.025v-4.2c0-.964-.673-1.77-1.575-1.975v-1A3.25 3.25 0 0 0 8 1.6M6 4.85a2 2 0 1 1 4 0v.95H6zM4.425 7.825c0-.428.347-.775.775-.775h5.6c.428 0 .775.347.775.775v4.2a.775.775 0 0 1-.775.775H5.2a.775.775 0 0 1-.775-.775z"})]})},r=(0,n(340498).wt)("lockSmall",i)},654734:(e,t,n)=>{n.d(t,{A:()=>c});var o=n(296540),i=()=>n(597777),r=()=>n(869190),s=()=>n(604995),a=()=>n(416504),l=n(474848);const c=function(e){const t=(0,n(69708).tz)(),c=(0,n(401497).DP)(),p=(0,n(396182).I)(),m=(0,o.useRef)(),g=(0,o.useCallback)((()=>{const t=e.value;if(!t)return;const o=s().q8(t,(0,a().P)());if(!o)return;const i=o.valueOf(),r=i-Date.now();r<0||r>n(720665).nD||m.current&&m.current.timestamp===i||(m.current&&clearTimeout(m.current.timer),m.current={timestamp:i,timer:setTimeout((()=>p("DateBox","DateBox/createReminderTimer")),r)})}),[p,e.value]),h=(0,o.useCallback)((()=>{m.current&&(clearTimeout(m.current.timer),m.current=void 0)}),[]);(0,o.useEffect)((()=>{g()}),[g]),(0,o.useEffect)((()=>()=>{h()}),[h]);const{value:f,withComma:v}=e,y=(0,n(56366).K8)((()=>f?(0,r().ZF)({value:f,date_format:e.dateFormat,time_format:e.timeFormat,userTimeZone:(0,a().P)(),allowRelativeDates:!0,intl:t,shortenDateAndRange:e.shortenDateAndRange,displayInUserTimezone:e.displayInUserTimezone,getToday:n(838924).x1}):void 0),[t,e.dateFormat,e.displayInUserTimezone,e.shortenDateAndRange,e.timeFormat,f]);if(!f)return null;const b=s().AA(f,(0,a().P)(),n(662303).locale);let S;if((0,i().Lh)(f)){const e=s().Zs(f,(0,a().P)());S=e?{color:c.errorText}:{color:n(100622).Tj.blue}}const x=(0,l.jsxs)(l.Fragment,{children:[y,(0,i().Lh)(f)?(0,n(599987).P)({display:"inline-block",width:"1em",marginInlineStart:6,marginInlineEnd:2,paddingBottom:4,verticalAlign:"middle"}):void 0,v?", ":null]});return e.disableTooltip?(0,l.jsx)("div",{className:e.className,style:{...e.style,...S},children:x}):(0,l.jsx)(n(859428).A,{renderTooltip:()=>(0,l.jsxs)(l.Fragment,{children:[e.tooltipHeader,(0,l.jsxs)("div",{style:u(c,e.tooltipHeader),children:[d(b.start),b.end?` â ${d(b.end)}`:""]})]}),render:t=>(0,l.jsx)("div",{className:e.className,style:{...e.style,...S},...t,children:x}),placement:e.tooltipPlacement})};function d(e){return(0,r().eV)({value:e,preset:"medium"})}function u(e,t){return t?{color:e.text.inverseSecondary}:{}}},654856:(e,t,n)=>{n.d(t,{A:()=>u});n(581454);var o=n(296540),i=()=>n(56366),r=()=>n(69708),s=()=>n(743260),a=()=>n(299545),l=()=>n(417555),c=()=>n(856952),d=n(474848);const u=function(e){const{origin:t,permissionsInviteStore:u,store:p,handleClickRemoveToken:m,handleInputChange:g,handleInputSubmit:h,right:f,focus:v,handleFocus:y}=e,b=(0,i().K8)((()=>0!==(0,n(329443).Qo)()),[]),S="share_menu"===t||"add_members"===t,x="add_members"===t,[k,C]=(0,i().$y)(u),A=(0,n(484714).v3)(),{device:I}=A,w=(0,r().tz)(),{tokenQuery:M}=k,T=(0,n(101749).N)(p),j=k.inviteTargets.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`,i=(0,s().yi)(e),a="newUser"===e.type||"existingUser"===e.type?e.value.email:void 0,c=i?T:void 0,u={key:t,target:e,onClickRemove:m,shouldWrap:S,showInfoIcon:Boolean(c)};return S&&a?(0,d.jsx)(n(859428).A,{placement:"top",disableTooltip:x,renderTooltip:()=>i?c||(0,d.jsx)(r().sA,{defaultMessage:"{email} will be invited as a guest",id:"ContextualInvite.permissions_invites.guest.tooltip",values:{email:a}}):a,render:n=>(0,o.createElement)("span",{...n,key:t},(0,d.jsx)(l().A,{...u,backgroundColor:(0,s().qv)(e)}))},t):(0,o.createElement)(l().A,{...u,key:t})})),P=0===k.inviteTargets.length;return(0,d.jsx)(c().Ay,{focus:I.isMobile?void 0:v,focusInitial:I.isMobile,focusAfterAnimation:!0,onClick:()=>{I.isMobile||null==y||y()},format:c().le.Share,value:M,onChange:g,type:"email",tokens:j,disabled:!1,autoComplete:"off",placeholder:S?b?w.formatMessage({defaultMessage:"Add people, groups, or emailsâ¦",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithTeams"}):w.formatMessage({defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots"}):(0,a().Yu)(p)||(0,a().nw)(p)?w.formatMessage({id:"inviteUserModal.searchInput.placeholder",defaultMessage:"Search name or emails"}):w.formatMessage({id:"permissionsInvite.searchInput.placeholder",defaultMessage:"Search emails, names, or groups"}),onRemoveLastToken:()=>{const e={...k};e.inviteTargets=e.inviteTargets.slice(0,-1),C(k)},right:f,inputFullWidth:!0,inputAndTokenWrapRightStyle:{paddingTop:A.device.isMobile||"add_members"===t?0:P?7:6,paddingBottom:A.device.isMobile||S?0:4},onEmptySubmit:()=>h(),dontShowBorderBottom:I.isAndroid,showBorder:S,...!S&&{style:{padding:"10px  9px 4px 9px"}},...S&&{style:{borderRadius:4,paddingTop:P?3:0,paddingBottom:0,...v&&{background:"none"}}}})}},658985:(e,t,n)=>{n.d(t,{$:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("membersFilled",{viewBox:"0 0 30 30",svg:(0,o.jsx)("path",{d:"M20.31 14.731c2.22 0 4.097-1.967 4.097-4.513 0-2.485-1.887-4.391-4.098-4.391-2.2 0-4.097 1.937-4.087 4.411 0 2.526 1.866 4.493 4.087 4.493zm-11.725.233c1.937 0 3.57-1.724 3.57-3.935 0-2.17-1.653-3.823-3.57-3.823-1.917 0-3.57 1.683-3.56 3.844 0 2.19 1.633 3.914 3.56 3.914zm-5.588 9.21h7.606c-1.085-1.552.082-4.615 2.374-6.42-1.116-.72-2.566-1.248-4.392-1.248-4.533 0-7.464 3.337-7.464 6.085 0 1.004.507 1.582 1.876 1.582zm10.994-.01h12.637c1.673 0 2.251-.508 2.251-1.44 0-2.607-3.316-6.198-8.57-6.198-5.263 0-8.57 3.59-8.57 6.197 0 .933.578 1.44 2.252 1.44z"})})},665579:(e,t,n)=>{n.d(t,{$L:()=>l,BZ:()=>u,EC:()=>h,EI:()=>x,E_:()=>M,Ed:()=>m,Fq:()=>y,Lu:()=>C,Mk:()=>g,O0:()=>w,V$:()=>I,VQ:()=>f,Xx:()=>k,Xy:()=>d,YS:()=>v,_g:()=>S,dd:()=>p,pW:()=>c,q3:()=>a,wH:()=>s,xK:()=>T});var o=()=>n(484714),i=()=>n(401497),r=()=>n(496603);const s=160,a=40,l=40,c=20,d=600,u=270,p=405,m=480,g=500,h=void 0,f=16,v=10,y=8,b={backdropFilter:"blur(48px)",WebkitBackdropFilter:"blur(48px)"},S=4;function x(e){return{icon:e.icon.secondary,text:e.text.secondary}}function k(e){return{width:48,height:48,fill:e.icon.tertiary}}function C({theme:e,isPhone:t}){return t?e.personalHomeBackgroundPhone:e.background.primary}const A=1;function I({isPhone:e,theme:t}){return{zIndex:1,position:"relative",display:"flex",flexDirection:"column",borderRadius:12,background:t.home.tile.background,boxShadow:M({isPhone:e,theme:t}),...b}}function w({mode:e}){switch(e){case"dark":default:return 0;case"light":return A}}function M({isPhone:e,theme:t,borderOnly:n}){if("dark"===t.mode)return"unset";t.mode;const o=w({mode:t.mode});return(0,r().oE)([n||e?void 0:"0 12px 32px rgba(0, 0, 0, 0.02)",`0 0 0 ${o}px rgba(0, 0, 0, 0.05)`]).join(", ")}function T(e){const{borderOnly:t}=e,n=(0,o().WS)(),r=(0,i().DP)();return{unhoveredBoxShadow:M({isPhone:n,theme:r,borderOnly:t}),hoveredBoxShadow:"light"===r.mode?["0 12px 32px rgba(0, 0, 0, 0.03)","0 0 0 1px rgba(0, 0, 0, 0.085)"].join(", "):r.homeShadow.card.hovered}}},671891:(e,t,n)=>{n.d(t,{l:()=>i});var o=()=>n(56366);function i(e){const t=(0,o().K8)((()=>function(e){if(!e)return;const t=null==e?void 0:e.getAssociatedCollectionStore();return null==t?void 0:t.getLayoutStore()}(e)),[e]);return t}},733816:(e,t,n)=>{n.d(t,{o:()=>i});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"2.37 4.12 15.25 11.75",svg:(0,n(474848).jsx)("path",{d:"M2.375 6.25c0-1.174.951-2.125 2.125-2.125h11c1.174 0 2.125.951 2.125 2.125v7.5a2.125 2.125 0 0 1-2.125 2.125h-11a2.125 2.125 0 0 1-2.125-2.125zm1.25 7.49L7.366 10 3.625 6.259zm.884.885H15.49l-3.74-3.741-1.309 1.308a.625.625 0 0 1-.884 0L8.25 10.884zM12.634 10l3.741 3.741V6.26zM4.509 5.375 10 10.866l5.491-5.491z"})},i=(0,n(340498).wt)("envelope",o)},739135:(e,t,n)=>{n.d(t,{KD:()=>c,gt:()=>d,i9:()=>l,ll:()=>s,tb:()=>a,x$:()=>r});var o=()=>n(541235),i=()=>n(496603);function r(e,t){return s(d(e,t))}function s(e){return void 0!==e&&(e===o().q_||e===o().YD)}function a(e,t){if(s(t))return;const n=o().c$[e],i=n.steps.findIndex((e=>e.id===t));return-1===i?n.steps[0].id:i===n.steps.length-1?o().q_:n.steps[i+1].id}function l(e,t){const n=d(e,t);if(n&&!s(n))return a(t,n)}function c(e,t){const n=d(e,t);if(n)return function(e,t){const n=o().c$[e];var r;if(s(t))return null===(r=(0,i().HV)(n.steps))||void 0===r?void 0:r.id;const a=n.steps.findIndex((e=>e.id===t));return-1!==a&&0!==a?n.steps[a-1].id:void 0}(t,n)}function d(e,t){var n;if(!e)return;const i=((null===(n=e.getSettings())||void 0===n?void 0:n.tutorials)||{})[t];return void 0===i?o().c$[t].steps[0].id:i}},756114:(e,t,n)=>{n.d(t,{D:()=>o});function o(e,t){t.route.name;return!1}},766343:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().Store{getInitialState(){return{open:!1,focus:"none"}}open(){this.setState({open:!0,focus:"none"})}close(){this.setState({open:!1,focus:"none"})}}const i=new o},766854:(e,t,n)=>{n.d(t,{H:()=>x,Q:()=>S});n(898992),n(672577);var o=()=>n(242422),i=()=>n(929219),r=()=>n(700500),s=()=>n(179034),a=()=>n(201980),l=()=>n(557281),c=()=>n(384944),d=()=>n(381678),u=()=>n(476492),p=()=>n(646736),m=()=>n(406792),g=()=>n(765957),h=()=>n(148832),f=()=>n(622811),v=()=>n(491848),y=()=>n(482871);function b(e,t,n){const i=(0,d()._)(e),r=null==i?void 0:i.id;if(!r||!n)return;if(!o().default.checkGate({gateName:"full_access_for_created_collection_pages"}))return;if(t.canAdmin())return;const s=t.getSpaceStore();return s&&(0,p().dp)(s,r).isMember()?[{role:"editor",type:"user_permission",user_id:r}]:void 0}function S(e){const{collectionContextStore:t,transaction:n}=e;return(0,v().w)({collectionContextStore:t,transaction:n}),x(e)}function x(e){var t,n,o;const{environment:d,collectionContextStore:p,groupsPointer:v,insertAtIndex:S,shouldCoerce:x,templateStore:k,transaction:C,from:A,tracker:I,inMemoryRecordCache:w,isKeyboard:M,title:T}=e,j=m().default.DO_NOT_USE_markLegacy("collections.add_item_lag");m().default.DO_NOT_USE_measureAfterNextFlushLegacy(j,{environment:d,getData:()=>({...u().kz(p),from:A.createBlock})});const P="collectionTypedView"===p.contextType,B=p.databaseType,_=p.collectionStoresStore.state,E=_.find((e=>e.canEdit()||e.canEditCollection()||e.canEditContentOnly()))||_[0],D=null===(t=g().default.state.sidebarSpaceStore)||void 0===t?void 0:t.id,z=g().default.state.currentUserSettingsStore,R=P&&B&&D&&z&&[...z.getAllPreferredCollections(D),...z.getPreferredCollectionsOfType(D,B)]||[];let V;const L=v[0];if("group_header"===A.createBlock&&"location"===L.value.type){const e=L.value.value;if(e){V=_.find((t=>t.id===e.id&&(t.canEdit()||t.canEditCollection()||t.canEditContentOnly())))}}else V=function(e,t){for(const n of e){const e=t.find((e=>e.id===n&&(e.canEdit()||e.canEditCollection()||e.canEditContentOnly())));if(e)return e}}(R,_);const N=V??E,F=null==N?void 0:N.getSpaceId(),H=p.collectionViewStore(),O=p.getViewType(),W=c().Wv({environment:d,type:r().xd.page,inMemoryRecordCache:w,transaction:C,spaceId:F,tracker:I,permissions:b(d,N,F),properties:{title:(0,a().x9d)(T)}});if(!N||!H||!O)return{coercionSucceeded:!0,newStore:W};const U=null===(n=p.groupsStore.getGroupState(v))||void 0===n?void 0:n.groupUiParentStore;if(!U)return{coercionSucceeded:!0,newStore:W};const K=h().B.createChildStore(U,{table:s().ev,id:W.id});k&&i().A.state.online&&l().n5({title:"template",environment:d,store:W,templateStore:k,isKeyboard:M??!1,isCreateIn:!1,transaction:C,from:A.initCollection??"collection_group_actions"});const G=(0,f().j)({environment:d,store:W,collectionStore:N,collectionContextStore:p,groupsPointer:v,shouldCoerce:x,transaction:C}),q=(null===(o=p.groupsStore.getGroupState(v))||void 0===o||null===(o=o.reducerResultStore.state)||void 0===o?void 0:o.blockIds)||[],$=void 0!==S?S:q.length;if(p.permissionScopesStore.state.canEditContent||P){const e=[...q.slice(0,$),K.id,...q.slice($)];(0,y().z)({resultIds:e,collectionViewStore:H,collectionContextStore:p,transaction:C})}return{coercionSucceeded:G,newStore:K}}},795963:(e,t,n)=>{n.d(t,{Ge:()=>a,OQ:()=>i,aG:()=>l,yN:()=>s});var o=()=>n(864994);const i=160,r=120,s=120;function a({isMobile:e,stackPropertyLabelAndValue:t,isPropertyInPageDetails:n}){if(t||!n)return;const a=r/o().b*100;return e?s:`min(max(${a}%, ${r}px), ${i}px)`}function l({stackPropertyLabelAndValue:e}){return e?{variant:"hug-content"}:{variant:"fixed"}}},817126:(e,t,n)=>{n.d(t,{G9:()=>p,Ld:()=>d,kg:()=>u,uF:()=>m});var o=()=>n(56366),i=()=>n(898244),r=()=>n(617871),s=()=>n(985529),a=()=>n(462853),l=()=>n(765957),c=()=>n(329304);function d({spaceId:e,userId:t}){const n=(0,c()._X)({name:"collection_connected_property_figma",spaceId:e,userId:t}),o=(0,c()._X)({name:"collection_connected_property_github",spaceId:e,userId:t}),i=(0,c()._X)({name:"collection_connected_property_google_drive",spaceId:e,userId:t}),s=(0,c()._X)({name:"collection_connected_property_zendesk",spaceId:e,userId:t}),a=(0,c()._X)({name:"collection_synced_database_salesforce_workspace",spaceId:e,userId:t});return{[r().e1]:n,[r().ob]:o,[r().Hd]:i,[r().k0]:s,[r().mn]:a}}function u(e){if(!e)return;const t=e&&(0,i().UU)(e)?e.connectedRelation.integration_id:void 0;return(0,a().l)(t)}function p(e){const t=e.featureName,n=(0,o().K8)((()=>{var t;return e.spaceId??(null===(t=l().default.state.sidebarSpaceStore)||void 0===t?void 0:t.id)}),[e.spaceId]),i=(0,o().K8)((()=>{var t;return e.userId??(null===(t=l().default.state.currentUserStore)||void 0===t?void 0:t.id)}),[e.userId]);return(0,c()._X)({name:t,spaceId:n,userId:i})}function m({featureName:e}){const t=p({featureName:e});if(!t)return;const n=(0,s().e2)(t),o=(0,s().Xq)(t);let i,r;return!o||"product"!==o.type||"plus"!==o.product&&"business"!==o.product&&"enterprise"!==o.product||(i=o.product),n&&(r=n&&t.expiry&&"sunset"===t.expiry.type?t.expiry.endDate:void 0),{isAvailable:n,expirationDate:r,upsell:o,upsellTier:i}}},829e3:(e,t,n)=>{n.d(t,{c:()=>s,m:()=>i});function o(e){switch(e.type){case"external":return`external-${e.botId}`;case"workflow":return`workflow-${e.workflowExternalScopedConnectionId}`;case"universal":return`universal-${e.app}-${e.spaceId}`;default:throw(0,n(534177).HB)(e)}}const i={channels:{},fetching:!1,lastRefreshed:0,failed:!1};class r extends(()=>n(757695))().Store{getStateForBot(e){const t=o(e);return this.state[t]??i}updateStateForBot(e,t){this.setState({...this.state,[o(e)]:{...this.getStateForBot(e),...t}})}addChannelsForBot(e,t){const n=this.getStateForBot(e);this.setState({...this.state,[o(e)]:{...n,channels:{...n.channels,...t}}})}}const s=new r;(0,n(852832).exposeDebugValue)("ExternalNotificationChannelsStore",s)},831081:(e,t,n)=>{n.d(t,{U:()=>i});n(296540);const o={viewBox:"0 0 16 16",fittedViewBox:"3 3 10 10",svg:(0,n(474848).jsx)("path",{d:"M11.75 3h-7.5C3.56 3 3 3.56 3 4.25v7.5c0 .69.56 1.25 1.25 1.25h7.5c.69 0 1.25-.56 1.25-1.25v-7.5C13 3.56 12.44 3 11.75 3"})},i=(0,n(340498).wt)("mediaStopFillSmall",o)},837622:(e,t,n)=>{n.d(t,{A:()=>u});var o=n(296540),i=()=>n(56366),r=()=>n(401497),s=()=>n(201980),a=()=>n(116008),l=()=>n(921855),c=()=>n(735372),d=n(474848);const u=o.memo((function(e){const{parentStore:t,withComma:u,linkifyUrls:p,disableCommentHighlight:m,disableLinks:g,shouldTruncate:h,clampLines:f,textValue:v}=e,y=(0,n(484714).v3)(),b=(0,r().DP)(),S=(0,n(712030).Ol)();(0,o.useEffect)((()=>{void 0!==v&&y.KatexStore.loadIfNeeded((()=>v))}),[y.KatexStore,v]);const{collectionContextStore:x,property:k}=(0,o.useContext)(n(971003).L8),{collectionViewBlockId:C,collectionViewId:A}=(0,i().K8)((()=>{var e,t;return{collectionViewId:null==x||null===(e=x.collectionViewStore())||void 0===e?void 0:e.id,collectionViewBlockId:null==x||null===(t=x.collectionViewBlockStore())||void 0===t?void 0:t.id}}),[x]),I=(0,i().K8)((()=>y.KatexStore.getKatex()),[y.KatexStore]),w=(0,i().K8)((()=>{const e=c().qu.state,n=c().wb.state;return e&&k&&v?l().nu({textValue:v,blockId:t.id,textProps:{type:"page_property_value_match",collectionViewBlockId:C,collectionViewId:A,propertyId:k},find:e,currentFocusedResult:n}):v}),[k,v,t.id,C,A]),M=(0,i().K8)((()=>{if(a().A.getPropertyId()!==k||a().A.getBlockStore()!==t)return w;const e=a().A.getMultiSelection();return e?s().Mwp({textValue:w,selection:{startIndex:e.start.index,endIndex:e.end.index},annotation:[s().Ifu.TemporaryComment]}):v?s().Mwp({textValue:w,selection:{startIndex:0,endIndex:s().qAZ(v).length},annotation:[s().Ifu.TemporaryComment]}):w}),[t,k,v,w]),T=(0,i().K8)((()=>void 0===M?null:l().S5({environment:y,textValue:M&&{value:M,spaceId:(0,n(161479).e)(t.pointer.spaceId)},parentStore:t,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableCommentAnnotations:m??!1,disabled:!0,theme:b,disableLinks:g??!1,emojiType:S,katex:I,formulaValueTypes:[],stopLinkPropagation:!0,linkTargetBlank:!0})),[M,y,t,m,b,g,S,I],{silenceRerenderDefender:!0}),j=(0,o.useMemo)((()=>{if(!p||void 0===v)return null;const e=(0,s().k4p)(v);return(0,n(735577).A)(e)?(0,n(713998).MO)(v):null}),[p,v]),P=(0,r().IS)((e=>({text:{...h&&!f?n(284371).RC:void 0,...h&&f?{...(0,n(115512).pA)(f),overflow:"hidden",textOverflow:"ellipsis"}:{}}})),[h,f]);return(0,d.jsxs)("span",{style:P.text,children:[j?(0,d.jsx)(n(97294).N,{href:j,style:{display:"inline",pointerEvents:"auto",...(0,n(468882).w_)(b)},external:!0,onClick:e=>e.stopPropagation(),children:T}):T,u?", ":null]})}))},848401:(e,t,n)=>{n.d(t,{Ay:()=>m,mI:()=>u,vb:()=>p});n(296540);var o=()=>n(401497),i=()=>n(718827),r=()=>n(784892),s=()=>n(65767),a=()=>n(69708),l=()=>n(284371),c=n(474848);const d=(0,a().YK)({removeTokenLabel:{defaultMessage:"Remove {title}",id:"uiGenericToken.removeTokenLabel"},removeTokenLabelGeneric:{defaultMessage:"Remove Item",id:"uiGenericToken.removeTokenLabelGeneric"}}),u=r().NY,p={[r().NY.ExtremeSmall]:{height:12,fontSize:10,margin:"0 4px 0 0",marginEditState:"0 6px 0 0",closeIconSize:8,avatarSize:14},[r().NY.ExtraSmall]:{height:14,fontSize:12,margin:"0 6px 0 0",marginEditState:"0 6px 0 0",closeIconSize:8,avatarSize:14},[r().NY.Small]:{height:18,fontSize:12,margin:"0 6px 6px 0",marginEditState:"0 6px 6px 0",closeIconSize:8,avatarSize:16},[r().NY.CompactEssential]:{height:20,fontSize:14,margin:"0 10px 6px 0",marginEditState:"0 6px 6px 0",closeIconSize:8,avatarSize:20},[r().NY.Medium]:{height:20,fontSize:14,margin:"0 10px 6px 0",marginEditState:"0 6px 6px 0",closeIconSize:8,avatarSize:20},[r().NY.Inline]:{height:20,fontSize:14,closeIconSize:8,avatarSize:20,margin:"0 -5px 0 0",marginEditState:"0 6px 0 0"},[r().NY.Large]:{height:24,fontSize:16,margin:"0 8px 8px 0",marginEditState:"0 8px 8px 0",closeIconSize:10,avatarSize:24}};function m({avatarSize:e,format:t,isSingle:n,onClickRemove:r,renderAvatar:u,showRemoveButton:m,shouldShrink:g,style:h,title:f}){const v=(0,a().tz)(),{height:y,fontSize:b,margin:S,marginEditState:x,closeIconSize:k,avatarSize:C}=p[t],A=e??C,I=(0,o().IS)((()=>({root:{display:"flex",alignItems:"center",flexShrink:g?1:0,minWidth:0,height:y,borderRadius:6,fontSize:b,lineHeight:"120%",margin:n?0:m?x:S,...h}})),[b,y,n,S,x,g,m,h]);return(0,c.jsxs)("div",{style:I.root,children:[null==u?void 0:u(A),(0,c.jsx)("div",{className:"notranslate",style:{...l().RC},children:f}),m?(0,c.jsx)(i().Ay,{ariaLabel:void 0!==f?v.formatMessage(d.removeTokenLabel,{title:f}):v.formatMessage(d.removeTokenLabelGeneric),onClick:r,style:{display:"flex",alignItems:"center",justifyContent:"center",width:y,height:y,marginInlineStart:2,marginInlineEnd:2,flexGrow:0,flexShrink:0,borderRadius:6},children:(0,s().l)({width:k,height:k,opacity:.5})}):null]})}},858341:(e,t,n)=>{n.d(t,{m:()=>c});var o=()=>n(988083),i=()=>n(496603),r=()=>n(155959),s=()=>n(693202);const a=i().sg(((e,t)=>{o().A.setState({...o().A.state,phase:e,estimatedKeyboardWebViewOverlap:t})}),300),l=i().sg(((e,t)=>{o().A.setState({...o().A.state,phase:e,estimatedKeyboardWebViewOverlap:t})}),150);function c(e,t,n){const{device:i,RouterStore:c}=e;if(!(0,r().T)("supportsAlwaysMultiTextSelectionBehavior")){const e="page"===c.state.route.name,o=i.isAndroid&&i.isMobileNative,r="editing"===s().default.state.mode;if(e&&o&&!r)return void a(t,n)}if((0,r().T)("supportsDebouncingKeyboardDuringOnboarding")){const e="onboarding"===c.state.route.name,o=i.isIOS&&i.isMobileNative;if(e&&o)return void l(t,n)}o().A.setState({...o().A.state,phase:t,estimatedKeyboardWebViewOverlap:n})}},862139:(e,t,n)=>{n.d(t,{_:()=>g});var o=n(296540),i=()=>n(484714),r=()=>n(56366),s=()=>n(69708),a=()=>n(698449),l=()=>n(765957),c=()=>n(760217),d=()=>n(173783),u=()=>n(678553),p=()=>n(187820),m=n(474848);function g(e){const t=(0,i().Y0)(),{group:n,menuListItemProps:g,spaceStore:h,iconSizeOverride:f}=e,v=(0,s().tz)(),y=(0,r().K8)((()=>{const e=h??l().AppStoreSidebarSpaceStore.state;if(e&&n.icon)return{pointer:{table:e.table,id:e.id},icon:n.icon}}),[n,h]),b=(0,o.useMemo)((()=>(0,a().Pf)({intl:v,groupName:n.name})),[n.name,v]),S=f||(t.isMobile?u().nd:u().pg);return(0,m.jsx)(c().A,{...g,icon:y?(0,m.jsx)(p().B6,{disabled:!0,size:S,icon:y,isEmptyPage:!1,title:b}):(0,m.jsx)(d().A,{size:S}),title:b})}},864994:(e,t,n)=>{n.d(t,{b:()=>r,g:()=>s});var o=()=>n(548821),i=()=>n(154807);const r=n(253658).YG;function s({environment:e,layoutArea:t,moduleType:n,pageViewBlockContext:s}){return("page_main"===t||"views_main_tab_modules"===t)&&"properties"===n||"properties"===n&&"page_details"===t&&(0,i().Wi)({environment:e,isInPeek:s===o().Rr.PeekView})>=r}},881707:(e,t,n)=>{n.d(t,{Dy:()=>a,Os:()=>c,l$:()=>l,qO:()=>s});n(944114),n(898992),n(354520);var o=()=>n(617871),i=()=>n(792071),r=()=>n(402904);function s(e){if(e.integration_id!==o().zG)throw"Cannot render account for integration.";const t=/(.+) - (.+)/.exec(e.account_name);if(!t)return{accountName:e.account_name};const[,n,i]=t;return{organizationName:n,accountName:i}}function a(e){return i().Bj6.fromValue(r().As,e).getSlackWorkspaceId()}function l(e,t){return t?e.filter((e=>{const n=a(e);return!!n&&t(n)})):e}function c(e,t=""){const n={};for(const o of e){const{accountName:e,organizationName:i}=s(o);d({query:t,accountName:e,organizationName:i})&&(n[e]||(n[e]=[]),n[e].push({externalAuthentication:o,workspaceName:i}))}return n}function d(e){const{accountName:t,organizationName:n,query:o}=e;if(0===o.length)return!0;const i=t.toLocaleLowerCase().indexOf(o.trim().toLocaleLowerCase())>=0,r=!!n&&n.toLocaleLowerCase().indexOf(o.trim().toLocaleLowerCase())>=0;return i||r}},888643:(e,t,n)=>{n.d(t,{k:()=>i});var o=()=>n(402014);function i(e){(0,o().SQ)({event:e,context:o().y$.Click,callback:()=>{}})}},897537:(e,t,n)=>{n.d(t,{A:()=>_});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(672577),n(581454),n(296540);var o=()=>n(56366),i=()=>n(252291),r=()=>n(970236),s=()=>n(842599),a=()=>n(733816),l=()=>n(792071),c=()=>n(848538),d=()=>n(798880),u=()=>n(69708),p=()=>n(534177),m=()=>n(284371),g=()=>n(743260),h=()=>n(299545),f=()=>n(37433),v=()=>n(148832),y=()=>n(543665),b=()=>n(901791),S=()=>n(760217),x=()=>n(231704),k=n(474848);function C(){return(0,k.jsx)(r().E,{content:(0,k.jsx)(u().sA,{id:"spaceUserMembershipType.member",defaultMessage:"Member"})})}var A=()=>n(939740),I=()=>n(64e3),w=()=>n(313171),M=()=>n(267155);const T=(0,u().YK)({invited_page:{id:"PermissionsInviteSearchRequest.userTooltip.invited_page",defaultMessage:"{userNameAndEmail} is invited to this page already"},invited_database:{id:"PermissionsInviteSearchRequest.userTooltip.invite_database",defaultMessage:"{userNameAndEmail} is invited to this database already"},invited_space:{id:"PermissionsInviteSearchRequest.userTooltip.invited_space",defaultMessage:"{userNameAndEmail} is invited to this workspace already"},invited_team:{id:"PermissionsInviteSearchRequest.userTooltip.invited_team",defaultMessage:"{userNameAndEmail} is invited to this teamspace already"},not_in_space:{id:"PermissionsInviteSearchRequest.userTooltip.admin",defaultMessage:"Click to invite {userNameAndEmail}"}}),j=(0,u().YK)({workspaceOwnerTooltip:{id:"inviteUserModal.userRole.workspaceOwnerBadge.tooltip",defaultMessage:"{ userNameAndEmail} is a workspace owner in this workspace"},membershipAdminTooltip:{id:"inviteUserModal.userRole.membershipAdminBadge.tooltip",defaultMessage:"{ userNameAndEmail} is a membership admin in this workspace"},memberTooltip:{id:"inviteUserModal.userRole.memberBadge.tooltip",defaultMessage:"{ userNameAndEmail} is a member in this workspace"},restrictedMemberTooltip:{id:"inviteUserModal.userRole.restrictedMemberBadge.tooltip",defaultMessage:"{ userNameAndEmail} is a restricted member in this workspace"},guestTooltip:{id:"inviteUserModal.userRole.guest.tooltip",defaultMessage:"{ userNameAndEmail} is a guest in this workspace"}});function P(e,t){return e.filter(((e,n)=>n<t))}function B(e){const{membershipType:t,intl:n,userNameAndEmail:o}=e;switch(t){case"owner":return{tooltip:n.formatMessage(j.workspaceOwnerTooltip,{userNameAndEmail:o}),userTypeToken:(0,k.jsx)(b().l,{role:t})};case"membership_admin":return{tooltip:n.formatMessage(j.membershipAdminTooltip,{userNameAndEmail:o}),userTypeToken:(0,k.jsx)(b().l,{role:t})};case"member":return{tooltip:n.formatMessage(j.memberTooltip,{userNameAndEmail:o}),userTypeToken:(0,k.jsx)(C,{})};case"restricted_member":return{tooltip:n.formatMessage(j.restrictedMemberTooltip,{userNameAndEmail:o}),userTypeToken:(0,k.jsx)(w().L,{})};case"page_guest":return{tooltip:n.formatMessage(j.guestTooltip,{userNameAndEmail:o}),userTypeToken:(0,k.jsx)(x().w,{labelType:t})};default:(0,p().HB)(t)}}const _=function(e){const{store:t,shouldShowGroups:p,sectionRenderLimit:b,membersOnly:x,hideCurrentUser:C,disableInvitedUsers:w,guestsMustBeRequested:j,hideTitle:_,defaultUserTitle:E,performSearchRequest:D}=e,[z,R,V]=(0,o().$y)(e.permissionsInviteStore),L=(0,n(484714).v3)(),N=(0,u().tz)(),{tokenQuery:F}=z,H="invitee",O=(0,o().K8)((()=>{const e=n(21735).A.state.shouldUseEdgeCache,t=n(242422).default.checkGate({gateName:"edge_cache_settings"});return e&&t}),[]),W={request:F,performRequest:e=>D?D({query:e,limit:10,environment:L}):n(542056).hQ({query:e,sectionLimit:{userLimit:10,groupLimit:p?10:0,importContactLimit:0},membersOnly:x,environment:L,intl:N,shouldUseEdgeCacheRollout:O}),render:(e,o,x)=>{if(e)return(0,k.jsx)(M().z,{loading:!x,hideTitle:_,children:(0,k.jsx)(I().A,{title:(0,k.jsx)(u().sA,{id:"inviteUserModal.searchInput.errorMessage",defaultMessage:"Something went wrong"})})});const D=o&&{...o,inviteUsers:o.inviteUsers.filter((e=>!(0,g().mQ)({permissionsInviteStore:V,target:e})&&(!C||e.value.id!==L.currentUser.id))),importedContacts:(0,g().GZ)(o.inviteUsers,o.importedContacts)},R=D&&(null==F?void 0:F.length)>0,{inviteUsers:O,inviteGroups:W,importedContacts:U=[]}=R?D:(0,g().Es)({currentInviteActors:D,permissionsInviteStore:V,targetStore:t}),K=[...P(O,b),...P(U,10)].map(((e,o)=>{const s="newUser"===e.type?e.value.email:e.value.id,p=(0,g().vP)(e),m=Boolean(R&&(0,g().VF)({permissionsInviteStore:V,userTarget:e,targetStore:t}));return{key:s,render:o=>{const{tooltip:s,userTypeToken:g}=function(e){const{userTarget:t,targetStore:n,isInvited:o,membershipType:i,intl:s}=e,a="newUser"===t.type?null:l().Bj6.fromValue(d().oo,t.value),p=null==a?void 0:a.id,m=null==a?void 0:a.getDisplayName(s),g=t.value.email,b=m&&m!==g?`${m} (${g})`:g??s.formatMessage({id:"userTypeTooltip.generalPerson",defaultMessage:"This person"});if((0,h().$R)(n)&&p){const e=n.getTeamRoleForUser(p,new Set);if(e&&"none"!==e){const t=s.formatMessage(f().Y7[e].label);return{tooltip:s.formatMessage(T.invited_team,{userNameAndEmail:b}),userTypeToken:(0,k.jsx)(r().E,{content:(0,k.jsx)(u().sA,{id:"inviteUserModal.teamspaceRole.memberBadge.label",defaultMessage:"{teamRoleMessage}",values:{teamRoleMessage:t}})})}}return(0,c().P)(i)||(0,c().GN)(i)?B({userNameAndEmail:b,membershipType:i,intl:s}):{tooltip:void 0,userTypeToken:void 0}}if(o)return{tooltip:(0,h().Yu)(n)?s.formatMessage(T.invited_space,{userNameAndEmail:b}):n instanceof v().B?s.formatMessage(T.invited_page,{userNameAndEmail:b}):n instanceof y().m?s.formatMessage(T.invited_database,{userNameAndEmail:b}):s.formatMessage(T.invited_team,{userNameAndEmail:b}),userTypeToken:(0,k.jsx)(r().E,{content:(0,k.jsx)(u().sA,{id:"inviteUserModal.userRole.invitedBadge.label",defaultMessage:"Invited"})})};if("none"===i)return{tooltip:s.formatMessage(T.not_in_space,{userNameAndEmail:b}),userTypeToken:void 0};return B({userNameAndEmail:b,membershipType:i,intl:s})}({userTarget:e,targetStore:t,membershipType:p,isInvited:m,intl:N});return"existingUser"===e.type?(0,k.jsx)(n(457688).A,{...o,actor:(0,n(764880).A7)(e.value),right:g,tooltip:s,tooltipPlacement:"bottom",disabled:w&&m,defaultUserTitle:E}):(0,k.jsx)(n(859428).A,{placement:"bottom",alignment:"start",textWrap:!0,render:t=>(0,k.jsx)(S().A,{...o,...t,icon:(0,k.jsx)(i().I,{icon:a().o}),right:g,title:e.value.email.trim(),disabled:w&&m}),disableTooltip:!s,renderTooltip:()=>s})},action:()=>{if(w&&m)return;const t={...e,..."existingUser"===e.type&&{membershipType:p}};n(134696).kH(L,{subscription_tier:(0,n(10984).AI)(),invite_token_query:F,selected_user_token:e,selected_user_token_rank:o,from:"permission_invite"}),V.setState({...z,inviteTargets:[...z.inviteTargets,t],tokenQuery:"",inputFocus:H})}}})),G=P(W,b).map((e=>{const{value:t}=e;return{key:t.id,render:e=>(0,k.jsx)(n(862139)._,{group:t,menuListItemProps:e}),action:()=>{V.setState({...z,inviteTargets:[...z.inviteTargets,e],tokenQuery:"",inputFocus:H})}}})),q=[];if(K.length>0&&q.push({key:"user results",render:e=>(0,k.jsx)(M().z,{...e,loading:!x,hideTitle:_}),items:K}),p&&G.length>0&&q.push({key:"group results",render:e=>(0,k.jsx)(n(89924).A,{...e,title:(0,k.jsx)(u().sA,{id:"inviteUserModal.searchDropdown.selectGroupTitle",defaultMessage:"Select a group"}),loading:!x}),items:G}),0===q.length){const e=(0,s().qh)(z.tokenQuery);if((0,s().DT)(e)){const i={type:"newUser",value:{email:e},source:"email"},r=(0,g().mQ)({target:i,permissionsInviteStore:V});if(!r)return;if(r)return(0,k.jsx)(M().z,{loading:!x,hideTitle:_,children:(0,k.jsx)(I().A,{title:(0,k.jsx)(u().sA,{id:"inviteUserModal.userAlreadyInvitedMessage",defaultMessage:"Already inviting {user}.",values:{user:(0,k.jsx)("span",{style:{fontWeight:m().Wy.bold},children:(0,g().Sk)({intl:N,target:r})})}})})});const s=(o&&o.inviteUsers||[]).find((t=>"existingUser"===t.type&&t.value.email===e));if(s&&"existingUser"===s.type&&(0,g().wF)({store:t,target:s}))return(0,k.jsx)(M().z,{loading:!x,hideTitle:_,children:(0,k.jsx)(I().A,{title:(0,k.jsx)(u().sA,{id:"inviteUserModal.userAlreadyHasPermissionMessage",defaultMessage:"{user} already has permission.",values:{user:(0,k.jsx)("span",{style:{fontWeight:m().Wy.bold},children:(0,n(695608).c6)(N,s.value)})}})})})}else{if(!z.tokenQuery)return null;q.push({key:"user results",render:e=>(0,k.jsx)(M().z,{...e,loading:!x,hideTitle:_,title:j?(0,k.jsx)(u().sA,{id:"inviteUserModal.searchDropdown.requestPeople",defaultMessage:"Keep typing to request inviting an email"}):(0,k.jsx)(u().sA,{id:"inviteUserModal.searchDropdown.addPeople",defaultMessage:"Keep typing to invite email"})}),items:[{key:z.tokenQuery,render:e=>(0,k.jsx)(S().A,{icon:(0,k.jsx)(i().I,{icon:a().o}),title:z.tokenQuery,...e}),action:()=>{}}]})}}return(0,k.jsx)(A().Ay,{type:A().Oh.Vertical,initialFocus:F.length>0?0:void 0,sections:q})}};return(0,k.jsx)(n(251126).A,{...W})}},901791:(e,t,n)=>{n.d(t,{l:()=>s});n(296540);var o=()=>n(970236),i=()=>n(69708),r=n(474848);function s(e){return(0,r.jsx)(o().E,{style:{textWrap:"nowrap"},content:"membership_admin"===e.role?(0,r.jsx)(i().sA,{id:"spacePermissionsSettings.user.membershipAdmin",defaultMessage:"Membership admin"}):(0,r.jsx)(i().sA,{id:"spacePermissionsSettings.user.workspaceOwner",defaultMessage:"Workspace owner"})})}},903047:(e,t,n)=>{n.d(t,{E:()=>i});var o=()=>n(401497);function i(e){const{size:t,style:n}=e;return(0,o().IS)((e=>({icon:{width:.6*t,height:.6*t,fill:e.text.secondary},iconContainer:{width:t,height:t,borderRadius:"100%",background:e.regularDividerColor,display:"flex",alignItems:"center",justifyContent:"center",...n}})),[t,n])}},933371:(e,t,n)=>{n.d(t,{X:()=>o});const o=n(757695).Store.createValue({shouldReset:!1},{name:"MobileAssistantMenuStore"})},937199:(e,t,n)=>{n.d(t,{LH:()=>r,Op:()=>i,bi:()=>l,sf:()=>a,v$:()=>s});n(16280);var o=n(296540);const i=(0,o.createContext)(null);function r(){const e=(0,o.useContext)(i);if(!e)throw new Error("usePageLayoutEditorContext must be used inside BaseLayoutEditorContext.Provider");return e}function s(){return(0,o.useContext)(i)}i.displayName="BaseLayoutEditorContext";const a=(0,o.createContext)(null);function l(){const e=(0,o.useContext)(a);if(!e)throw new Error("usePageLayoutEditorContext must be used inside PageLayoutEditorContextProvider");return e}a.displayName="PageLayoutEditorContext"},977870:(e,t,n)=>{n.d(t,{c:()=>i});class o extends(()=>n(757695))().Store{getInitialState(){return{wasGetVisibleUsersCalled:!1}}}const i=new o;n(852832).exposeDebugValue("GetVisibleUsersStore",i)},981305:(e,t,n)=>{n.d(t,{B:()=>r});n(16280);var o=n(296540),i=()=>n(472090);function r(e,t,n=0){(0,o.useEffect)((()=>{const o=new(i().E)({throttleMs:n});if(!e.current)throw new Error("ref.current is null");return o.observe(e.current),o.rect.addListener(t),()=>{o.destroy()}}),[t])}}}]);