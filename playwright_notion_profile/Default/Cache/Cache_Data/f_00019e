"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[96772,98682],{29037:(e,t,s)=>{s.r(t),s.d(t,{checkmarkIcon:()=>i,iconDefinition:()=>r});s(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"3.92 3.91 12.17 12.18",svg:(0,s(474848).jsx)("path",{d:"M15.784 4.002a.625.625 0 0 1 .214.857L9.445 15.784a.625.625 0 0 1-1.01.085l-4.37-5.098a.625.625 0 0 1 .948-.814l3.806 4.44 6.109-10.181a.625.625 0 0 1 .857-.214"})},i=(0,s(340498).wt)("checkmark",r)},62088:(e,t,s)=>{s.d(t,{oY:()=>q,uE:()=>R});s(944114),s(517642),s(658004),s(733853),s(845876),s(432475),s(515024),s(731698),s(898992),s(354520),s(430670);var r=s(296540),i=()=>s(59226),n=()=>s(484714),o=()=>s(56366),a=()=>s(929219),l=()=>s(187174),u=()=>s(68263),c=()=>s(798880),d=()=>s(69708),p=()=>s(496603),m=()=>s(763824),h=()=>s(381678),f=()=>s(47373),v=()=>s(329443),g=()=>s(124749),y=()=>s(645873),S=()=>s(369955),b=()=>s(118789),M=()=>s(106628),_=()=>s(765957),I=()=>s(375447),x=()=>s(870092),C=()=>s(271084),w=()=>s(233692);const A=75,k=75,T=4;function R(e){const{query:t,environment:s,intl:f,useMentionMenuStore:g,open:S}=e,w=(0,o().K8)((()=>g?I().Ay.state.open:S),[S,g]),k=(0,o().K8)((()=>!(!e.disabled&&!g)&&!I().Ay.state.mentionTypes.user),[e.disabled,g]),R=(0,o().K8)((()=>Boolean(_().default.state.sidebarSpaceStore)),[]),q=(0,i().X)("edge_cache_mentions"),[{value:P=[],status:F}]=(0,l().Yb)((async()=>{if(k||q||!w||!R)return[];const e=await async function(e,t,s){if(a().A.state.online){const r=await M().T.searchActions.load();return await r.searchVisibleSpaceUsers({environment:t,query:e,membersOnly:!1,minFuzzyScore:25,placeSelfFirst:r.isPersonalPronoun(e,s)})}return[]}(t,s,f.locale);return e}),[k,q,w,R,t,s,f.locale],{debounce:A}),{results:E,isLoading:L}=function(e){const{query:t,flagEnabled:s,disabled:i,useMentionMenuStore:a,open:f}=e,g=(0,d().tz)(),S=(0,n().v3)(),w=(0,o().K8)((()=>a?I().Ay.state.open:f),[f,a]),k=(0,o().O$)(_().AppStoreSidebarSpaceStore),T=!i&&s&&t.length>0&&k&&w,R=(0,o().K8)((()=>{var e;const t=C().k.getSortedUserIds(),s=null===(e=(0,h()._)(S))||void 0===e?void 0:e.id;return[...(0,p().oE)([s]),...t]}),[S]),q=(0,o().K8)((()=>{const e=_().default.state.mainEditorCurrentBlockStore;return e?(0,v().i0)(e).flatMap((({permissionItem:e})=>(0,u().B2)(e)?[e.user_id]:[])):[]}),[]),P=(0,y().fJ)(M().T.searchActions),[{value:F=[],status:E}]=(0,l().Yb)((async()=>{if(!T||"resolved"!==P.status)return[];const e=(0,p().sb)([...R,...q]),s=P.value;return(await s.searchUsers({environment:S,parentStore:k,query:t,userIds:e,minFuzzyScore:25,placeSelfFirst:s.isPersonalPronoun(t,g.locale)})).slice(0,3)}),[T,P.status,P.value,R,q,S,k,t,g.locale]),L=(0,r.useMemo)((()=>({field:"name_normalized",direction:"asc"})),[]),B=(0,b().n)({query:t,sort:L,filter:void 0,limit:50,disable:!T}),V=(0,o().K8)((()=>(null==B?void 0:B.rowsStore.state.rows)??[]),[B]),[{value:j=[],status:O}]=(0,l().Yb)((async()=>{if(!T)return[];const e=V.sort(((e,t)=>{var s,r;const i=(null===(s=C().k.state)||void 0===s?void 0:s[e.id])??0;return((null===(r=C().k.state)||void 0===r?void 0:r[t.id])??0)-i})),t=await(0,m().lX)(e,Math.max(e.length,1),(async e=>{const t=x().L.createChildStore(k,{table:c().oo,id:e.id});return await t.load(),t.getValue()}));return(0,p().oE)(t)}),[k,T,V],{debounce:A}),U=(0,r.useMemo)((()=>{const e=new Set;return[...F,...j].filter((t=>!e.has(t.id)&&(e.add(t.id),!0)))}),[F,j]),D="pending"===O||"pending"===E;return{results:U,isLoading:D}}({query:t,flagEnabled:q,disabled:k,...g?{useMentionMenuStore:!0}:{useMentionMenuStore:!1,open:!0}}),B=(0,r.useMemo)((()=>q?E:P),[q,P,E]),V=(0,o().K8)((()=>I().Ay.state.emptyQueryUserRequestStore.state.result??[]),[]),j="pending"===(q?L:F);return{results:0===t.length?V.slice(0,T):B.slice(0,20),isLoading:j}}function q(e){const{query:t,environment:s,useMentionMenuStore:r,open:i}=e,n=(0,o().K8)((()=>r?I().Ay.state.open:i),[i,r]),a=(0,f().ke)(),u=(0,S().L)(),c=(0,g().$)(),d=!(0,o().K8)((()=>!(!e.disabled&&!r)&&!I().Ay.state.mentionTypes.bot),[e.disabled,r])&&a&&n&&Boolean(u)&&Boolean(c),[{value:p=[],status:m}]=(0,l().Yb)((async()=>{if(!d)return[];try{if(!u||!c)return[];const e=await M().T.customAgentSearchService.load(),{workflowStores:r}=await e.getCustomAgents({environment:s,spaceStore:u,userStore:c}),i=e.searchWorkflowStores({query:t,workflowStores:r,limit:5}),n=[];for(const t of i){const e=(0,w().m)(t);n.push({workflowStore:t,name:e.name,icon:e.icon})}return n}catch{return[]}}),[d,u,c,t,s],{debounce:k});return{results:p,isLoading:"pending"===m}}},97835:(e,t,s)=>{s.r(t),s.d(t,{iconDefinition:()=>i,inviteMemberIcon:()=>n});s(296540);var r=s(474848);const i={viewBox:"0 0 20 20",fittedViewBox:"3.68 2.37 15.82 17.13",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M10 2.375c-1.137 0-2.054.47-2.674 1.242-.608.757-.9 1.765-.9 2.824s.292 2.066.9 2.824c.62.772 1.537 1.241 2.674 1.241s2.055-.469 2.675-1.241c.608-.758.9-1.766.9-2.824 0-1.059-.292-2.067-.9-2.824-.62-.773-1.538-1.242-2.675-1.242M7.676 6.441c0-.842.233-1.554.624-2.042.38-.473.937-.774 1.7-.774s1.32.301 1.7.774c.391.488.624 1.2.624 2.042s-.233 1.554-.624 2.041c-.38.473-.937.774-1.7.774s-1.32-.3-1.7-.774c-.391-.487-.624-1.2-.624-2.041M10 11.63c-2.7 0-5.101 1.315-6.12 3.305-.361.706-.199 1.421.23 1.923.412.48 1.06.767 1.74.767h5.845a4.6 4.6 0 0 1-.28-1.25H5.85c-.342 0-.634-.148-.79-.33-.138-.162-.172-.336-.067-.54.761-1.488 2.672-2.626 5.007-2.626.83 0 1.605.144 2.294.395.269-.364.59-.688.952-.96A7.9 7.9 0 0 0 10 11.63"}),(0,r.jsx)("path",{d:"M16 19.5a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7m2.594-3.469a.625.625 0 0 0-.625-.625h-1.375v-1.375a.625.625 0 0 0-1.25 0v1.375h-1.375a.625.625 0 0 0 0 1.25h1.375v1.375a.625.625 0 1 0 1.25 0v-1.375h1.375c.345 0 .625-.28.625-.625"})]})},n=(0,s(340498).wt)("inviteMember",i)},108184:(e,t,s)=>{s.r(t),s.d(t,{COMPLETION_THROTTLE:()=>y,PREVIEW_STEP_DELAY:()=>S,maybeUpdateAiEligibility:()=>_,postProcessAICreatedStores:()=>M,showCompletionErrorWithCode:()=>b,wrapTemporaryBlocksInList:()=>I});s(18107),s(967357);var r=()=>s(386164),i=()=>s(179034),n=()=>s(720665),o=()=>s(559506),a=()=>s(722101),l=()=>s(384944),u=()=>s(471995),c=()=>s(324089),d=()=>s(412669),p=()=>s(556122),m=()=>s(594794),h=()=>s(972435),f=()=>s(878710),v=()=>s(668721),g=()=>s(661077);const y=300,S=250;function b(e){const t=h().A.getIntl();return 451===e?u().D6({label:t.formatMessage({id:"completionActions.moderationError",defaultMessage:"AI does not allow content that is harmful or illegal. Please revise your input and try again. (451)"})}):413===e?u().D6({label:t.formatMessage({id:"completionActions.promptOrAttachmentTooLarge",defaultMessage:"Query or attachment is too large. Please revise your input and try again. (413)"})}):502===e||503===e||504===e?u().D6({label:t.formatMessage({id:"completionActions.providerError",defaultMessage:"We’re experiencing issues with our AI provider. Try again in a few minutes. ({errorCode})"},{errorCode:e})}):void u().D6({label:t.formatMessage({id:"completionActions.genericError",defaultMessage:"AI is temporarily unavailable. Try again in a few minutes. ({errorCode})"},{errorCode:e})})}function M(e,t){for(const s of t)c().In({environment:e,blockStore:s})}async function _(e,t,s){let i;const a=p().TI();if(a.debug)i=402!==a.showErrorCode;else{if(v().A.state&&v().A.state.isEligible&&"unlimited"===v().A.state.type&&!s){const e=v().A.state.lastUpdatedAt;if(Date.now()-e<10*n().Xb)return!0}const a=await o().callApi({eventName:"getAIUsageEligibility",environment:e,data:{spaceId:t},headers:(0,r().WS)({cellId:void 0,spaceId:t})});if("success"===a.type){var l,u;i=a.data.isEligible,i&&d().K.state&&d().K.setState(!1);const e=!1===(null===(l=v().A.state)||void 0===l?void 0:l.isEligible)&&(null===(u=v().A.state)||void 0===u?void 0:u.requestedAccess),t=a.data.researchModeUsage??0;v().A.setState({...a.data,lastUpdatedAt:Date.now(),researchModeUsage:t,...!1===a.data.isEligible&&{requestedAccess:e}})}}return void 0!==i&&g().P.setState(i),i}function I(e){var t;const{environment:s,stores:r,listId:n,inMemoryRecordCache:o,transaction:u}=e,c=(null===(t=r.at(0))||void 0===t?void 0:t.getSpaceId())??u.spaceId,d=new(f().pm)({environment:s,pointer:{table:i().ev,id:n||(0,m().Z1)({environment:s,table:i().ev,spaceId:c}),spaceId:c},recordStoreOptions:{inMemoryRecordCache:o,userId:s.currentUser.id},path:["content"]});for(const i of r)a().BC({parentStore:d,appendStore:i,transaction:u}),l().zv({store:i,data:{parent_id:d.id,parent_table:d.table,alive:!0},transaction:u});return d}},112412:(e,t,s)=>{s.r(t),s.d(t,{filterSmallIcon:()=>i,iconDefinition:()=>r});s(296540);const r={viewBox:"0 0 16 16",fittedViewBox:"1.69 3.69 12.61 8.61",svg:(0,s(474848).jsx)("path",{d:"M2.4 3.7a.7.7 0 1 0 0 1.4h11.2a.7.7 0 1 0 0-1.4zm9.5 3.594H4.1a.7.7 0 1 0 0 1.4h7.8a.7.7 0 1 0 0-1.4M5.8 10.9a.7.7 0 1 0 0 1.4h4.4a.7.7 0 1 0 0-1.4z"})},i=(0,s(340498).wt)("filterSmall",r)},118789:(e,t,s)=>{s.d(t,{n:()=>y});s(898992),s(354520),s(581454);var r=s(296540),i=()=>s(484714),n=()=>s(56366),o=()=>s(165358),a=()=>s(798880),l=()=>s(69708),u=()=>s(21735),c=()=>s(977870),d=()=>s(576737),p=()=>s(870092),m=()=>s(585428),h=()=>s(134217),f=()=>s(749240),v=()=>s(369955),g=()=>s(646736);function y(e){const{query:t,filter:s,limit:y,disable:b,sort:M}=e,_=(0,n().O$)(f().subscriptionDataStoreInstance),I=(0,n().K8)((()=>u().A.state.shouldUseEdgeCache),[]),x=(0,l().tz)(),C=(0,v().L)(),w=(0,i().v3)();(0,r.useEffect)((()=>{c().c.state.wasGetVisibleUsersCalled||o().log({level:"error",from:"useUsersListSource",type:"getVisibleUsersNotCalled",data:{routeName:w.RouterStore.state.route.name}})}),[w,I]);const A=(0,n().K8)((()=>{if(b||I||!_||!C)return[];return h().Be(_).map((e=>{var t,s;const r=p().L.createChildStore(C,{table:a().oo,id:e.userId}),i=(0,g().dp)(C,e.userId);return{id:e.userId,email:r.getEmail()||"",space_id:C.id,name:r.getDisplayName(x),profile_photo:null===(t=r.getModel())||void 0===t?void 0:t.profile_photo,membership_type:i.getMembershipType(),onboarding_completed:null===(s=r.getModel())||void 0===s?void 0:s.onboarding_completed,first_joined_space_time:S(e),aliases:e.aliases}}))}),[b,I,_,C,x]),k=(0,r.useMemo)((()=>b?void 0:I&&C?new(m().e)({users:void 0,environment:w,spaceId:C.id,initialMembershipFilter:s,initialSort:M,initialQuery:t,limit:y}):new(d().z)({users:A,initialMembershipFilter:s,initialSort:M,initialQuery:t,limit:y})),[b,I,C,w]);return(0,r.useEffect)((()=>{k instanceof d().z&&k.setUsers(A)}),[k,A]),(0,r.useEffect)((()=>{null==k||k.setSort(M)}),[k,M]),(0,r.useEffect)((()=>{null==k||k.setQuery(t)}),[k,t]),(0,r.useEffect)((()=>{null==k||k.setFilter(s)}),[k,s]),k}function S(e){return"firstJoinedSpaceTime"in e?e.firstJoinedSpaceTime??Date.now():Date.now()}},135599:(e,t,s)=>{s.d(t,{W:()=>z});s(944114),s(517642),s(658004),s(733853),s(845876),s(432475),s(515024),s(731698),s(898992),s(823215),s(354520),s(581454),s(737550);var r=s(296540),i=()=>s(564884),n=()=>s(242422),o=()=>s(395361),a=()=>s(484714),l=()=>s(56366),u=()=>s(721908),c=()=>s(929219),d=()=>s(474424),p=()=>s(591779),m=()=>s(206267),h=()=>s(207289),f=()=>s(519831),v=()=>s(620333),g=()=>s(245241),y=()=>s(69708),S=()=>s(496603),b=()=>s(973647),M=()=>s(534177),_=()=>s(720665),I=()=>s(559506),x=()=>s(518362),C=()=>s(148777),w=()=>s(825972),A=()=>s(71304),k=()=>s(780865),T=()=>s(470928),R=()=>s(135055),q=()=>s(406792),P=()=>s(106628),F=()=>s(361330),E=()=>s(109054),L=()=>s(765957),B=()=>s(968172),V=()=>s(20199),j=()=>s(558407),O=()=>s(148832),U=()=>s(543665),D=()=>s(645873),K=()=>s(873049),N=()=>s(606331);function z(e){var t;const{options:s,...m}=e,{overrideSearchSessionId:z,overrideSpaceStore:Z,usePrefetch_EXPERIMENTAL:$,disable:J,debug:G}=s,{type:X,query:ee="",source:te,limit:se,peopleBlocksToInclude:re}=m,ie=(0,a().v3)(),ne=(0,y().tz)(),oe=(0,p().ZC)(ee),ae=(0,p().ZC)(e.filters),le=(0,p().ZC)(e.sort),ue=(0,p().ZC)(e.options.searchExperimentOverrides),ce=(0,p().ZC)(G),de=(0,r.useRef)({number:0,query:""}),pe=(0,r.useCallback)((e=>{const t=de.current.query.trim(),s=e.trim();""!==s&&t!==s&&(de.current.number+=1,de.current.query=s)}),[]),me=(0,o().Y)(pe,F().ab),he=(0,r.useRef)(!0),fe=(0,l().O$)(c().e),ve=!fe,ge=(0,R().y6)(),[ye,Se]=(0,r.useState)(H()),be=(0,l().K8)((()=>z&&z!==ye.searchSessionId?(Se((e=>({...e,searchSessionId:z}))),z):ye.searchSessionId),[ye,z]),Me=(0,r.useRef)(),_e=(0,r.useCallback)((()=>{Me.current&&(q().default.measure(Me.current,{environment:ie,data:{query_length:ee.length,source:te,search_session_id:be}}),Me.current=void 0)}),[ie,ee.length,te,be]),{searchLocalResults:Ie,searchServerResults:xe,isResultsLoading:Ce,numTotalLocalResults:we,numTotalServerResults:Ae}=(0,l().K8)((()=>({searchLocalResults:ye.localResults,searchServerResults:ye.serverResults,isResultsLoading:ye.isResultsLoading,numTotalLocalResults:ye.numTotalLocalResults,numTotalServerResults:ye.numTotalServerResults})),[ye]),ke=(0,l().K8)((()=>Z||L().default.state.sidebarSpaceStore),[Z]),Te=(0,l().K8)((()=>{if(ve||Ce&&he.current)return Ie;let e=function(e){const{localResults:t,serverResults:s}=e,r=t.map((e=>e.store.id)),i=new Set(r),n=s.filter((e=>!i.has(e.store.id)));return[...t,...n]}({localResults:Ie,serverResults:xe});return X===g().Vz.CollectionsInSpace&&(e=Q(e)),e}),[ve,Ce,Ie,X,xe]),Re=(0,l().K8)((()=>"on"===n().default.getEligibleGroup({experimentId:"search-use-local-reranker-layered",parameter:"shouldUseLocalReranker",defaultGroup:"control"})),[]),qe=ve&&fe&&Boolean($),Pe=(0,r.useMemo)((()=>e.sort?e.sort:{field:"relevance"}),[e.sort]),Fe=(0,r.useMemo)((()=>{var t;const r=(t=>{switch(e.type){case g().Vz.BlocksInCollection:return e.collectionId;case g().Vz.BlocksInParent:return e.parentId;default:return null===(t=e.filters)||void 0===t?void 0:t.parentId}})(),i={...e.filters,navigableBlockContentOnly:void 0!==(null===(t=e.filters)||void 0===t?void 0:t.navigableBlockContentOnly)?e.filters.navigableBlockContentOnly:!0===s.isTitleOnly,parentId:r};return(0,g().N2)(i)}),[s.isTitleOnly,e]),Ee=(0,r.useCallback)(((e,t)=>{const{isSuccess:s,totalResultsCount:r,localCacheMetadata:i,query:n}=t;q().default.measure(e,{environment:ie,data:{start_time:e.startTime,success:s,surface:te,num_results:r,search_session_id:be,local_cache_metadata:i,local_cache_readiness_timings:(0,C().Yp)(),query_length:n.length}})}),[ie,te,be]),Le=(0,r.useCallback)(((e,t)=>{const{isSuccess:s,totalResultsCount:r,query:i}=t;q().default.measure(e,{environment:ie,data:{start_time:e.startTime,success:s,surface:te,num_results:r,search_session_id:be,search_session_flow_number:de.current.number,query_length:i.length}})}),[ie,te,be]),Be=(0,r.useMemo)((()=>{if(s.disableLocalSearch)return!1;const t=(0,k().Bh)(ee),r=e.options.searchExperimentOverrides,i="on"===(null==r?void 0:r["search-no-local-blending"]);return"trash"===te||(0,k().Bi)({isLocalBlendingDisabled:i,queryOperations:t,queryText:ee,querySort:Pe})}),[s.disableLocalSearch,e.options.searchExperimentOverrides,ee,Pe,te]),Ve=(0,l().K8)((()=>V().A.state.localSearchableBlocksCache),[]),je=(0,D().fJ)(P().T.searchActions),Oe=(0,r.useCallback)((t=>{var s;if(!Be)return void Se((e=>({...e,localResults:[],numTotalLocalResults:0})));const r=q().default.mark("rum.local_quick_search_query"),{query:i,spaceStore:n}=t,o=ge&&!fe&&(0,M().Xk)(g().Iy,te);if("resolved"!==je.status)return;const a=X===g().Vz.CollectionsInSpace,l=a&&0===i.length?function(e){const{spaceStore:t,environment:s}=e,r=(0,x().F)({currentUserId:s.currentUser.id,spaceId:t.id}).map((e=>{const s=U().m.createChildStore(t,{table:f().Vl,id:e}).getParentBlockStore();if(null==s?void 0:s.pathIsAccessibleAndAlive())return s}));return(0,S().oE)(r)}({environment:ie,spaceStore:n}).map(((e,t)=>({store:e,originalPosition:t,id:e.id,score:0,spaceId:e.getSpaceId(),sources:[g().Ni.Local],featureGroups:[],serverEventProperties:void 0}))):[],u=(0,C().PE)({environment:ie,overrideCurrentUserId:ie.currentUser.id,overrideSpaceId:n.id,overrideLocalSearchableBlocksCache:Ve}),c=(0,k().Er)(ie).hasPublicAccessPermission,{filters:d,excludedBlockIds:p}=(0,v().CT)({peopleBlocksToInclude:re,filters:Fe,excludedBlockIds:void 0,spaceIdCreator:ie.idCreator.getSpaceIdCreatorSync(n.id)}),h=(0,N().S6)({environment:ie,parentStore:n,spaceStore:n,isOnline:fe,requestInput:{query:{text:i,filters:{...d,blockTypes:Y({blockTypes:null===(s=e.filters)||void 0===s?void 0:s.blockTypes,queryType:X}),isOfflineOnly:o},sort:{field:"relevance"}},limit:ve?se:Math.min(se,5)},localSearchCache:Ve,forceLocalCacheUsage:"trash"===te,shouldUseNewRerankerDebugOverrideEnabled:Re,shouldLimitLocalResultsWhenOnline:!ve,hasPublicAccessPermission:c}),y=qe?W({query:i,serverResults:Xe.current}):[],_=h&&b().Q.unwrapOr(h,void 0),I=(null==_?void 0:_.results)??[],w=(null==_?void 0:_.total)??0;let A=S().hS([...l,...I,...y],(e=>(0,K().a)(e)));A=a?Q(A):A,A=A.filter((e=>!p.includes(e.id)&&!(m.excludedBlockIds??[]).includes(e.id)&&(null==ke?void 0:ke.id)===e.spaceId)),Se((e=>e.query!==i?e:(tt.current=A.map((e=>e.id)),Ee(r,{query:i,isSuccess:Boolean(_),totalResultsCount:w,localCacheMetadata:u}),me(i),{...e,localResults:A,isResultsLoading:!ve&&e.isResultsLoading,numTotalLocalResults:w})))}),[ge,fe,te,je.status,X,ie,Ve,Fe,null===(t=e.filters)||void 0===t?void 0:t.blockTypes,ve,ke,se,Re,qe,Ee,me,m.excludedBlockIds,Be,re]),Ue="mini_quick_find"===te?40:F().GR,De=(0,o().Y)(Oe,Ue),Ke=(0,r.useCallback)((t=>{const{result:s,isMetaClick:r,context:n}=t,o=void 0!==s.workflowData;let a=(0,A().Qe)(s.store,ne,ie,!1);var l;o&&(a=null===(l=s.workflowData)||void 0===l?void 0:l.name);const u=(0,E().uv)({query:ee,resultText:a??"",isLastQueryTermPartialMatchOK:!0}),c=L().default.state.sidebarSpaceStore,d=Boolean(null==c?void 0:c.getSettings().enable_ai_training);(0,i().u)({environment:ie,event:{eventName:"select_search_item",eventProperties:{...s.serverEventProperties&&s.serverEventProperties["server-query"]?{"server-query":s.serverEventProperties["server-query"]}:{},queryText:s.serverEventProperties&&s.serverEventProperties["server-query"]&&s.serverEventProperties["server-query"].query?s.serverEventProperties["server-query"].query:ee,sources:s.sources,localSources:Array.from(s.localSource||new Set),searchSessionId:be,aiSessionId:void 0,traceId:void 0,searchSessionFlowNumber:de.current.number,context:n,queryStringLength:ee.length,isTitleMatch:u,queryIfLeap:d?ee:void 0,totalSearchResultCount:we+Ae,numLocalResults:Ie.length,numTotalLocalResults:we,isMobile:ie.device.isMobile,isMetaClick:r,hasFilters:Boolean(e.filters),originalPosition:s.originalPosition,selectedItemIndex:s.originalPosition,selectedSearchResultMetadata:{blockId:s.id,blockType:o?"workflow":s.store.getModel().type},searchSource:te,verificationState:(0,T().i1)(s.store)}}})}),[ie,we,Ae,Ie,ee,be,de,e.filters,te,ne]),Ne=oe===ee,ze=S().n4(ae,e.filters),He=S().n4(le,e.sort),We=S().n4(ue,e.options.searchExperimentOverrides),Ye=ce===G,Qe=ze&&Ne&&He&&We&&Ye,Ze=!J&&ke&&!Qe,$e=Boolean(oe&&!ee)||!ze||!He||!We||!Ye,Je=(0,r.useRef)(!1),Ge=(0,r.useRef)([]),Xe=(0,r.useRef)([]),et=(0,r.useRef)([]),tt=(0,r.useRef)([]),st=(0,l().K8)((()=>{if("mention_menu"!==te)return;return j().A.getMentionedIds(ie.currentUser.id)}),[ie.currentUser.id,te]),rt=(0,r.useCallback)((async t=>{Me.current=q().default.mark("time_to_render_search_results");const s=q().default.mark("rum.server_quick_search_query"),{query:r,spaceStore:i,size:n}=t,o=i.id;if(ve&&!qe)return;const a=!he.current&&ze?Ge.current:[],l=qe?W({query:r,serverResults:Xe.current}):[];if(qe&&(r.length<=1||l.length>=5||et.current.some((e=>e===r))))return;et.current.push(r);const u=S().sb([...m.excludedBlockIds??[],...a.map((e=>e.id)),...tt.current||[],...Xe.current.map((e=>e.id))]),{filters:c,excludedBlockIds:p}=(0,v().CT)({peopleBlocksToInclude:re,filters:Fe,excludedBlockIds:u,spaceIdCreator:ie.idCreator.getSpaceIdCreatorSync(o)}),f={...m,excludedBlockIds:p,query:r,sort:Pe,filters:c,recentlyMentionedPageIds:st,spaceId:o,searchSessionFlowNumber:de.current.number,searchSessionId:be,limit:n,recentPagesForBoosting:(0,w().cs)(B().A.getWithoutSubscribing(o)),ignoresHighlight:"mini_quick_find"!==te,searchExperimentOverrides:e.options.searchExperimentOverrides,debug:G},g=await I().callApi({eventName:"search",environment:ie,data:f});if(!g||"failed"===g.type)return void Se((e=>({...e,isResultsLoading:!1})));const y=g.data.total,b=(0,_().MU)((0,M().WP)(g.data.trackEventProperties).map((([e,t])=>[`server-${e}`,t]))),x=g.data.results.slice(0,n).map(((e,t)=>{const s=O().B.createChildStore(i,{id:e.id,spaceId:e.spaceId,table:"block"}),r=qe?function(e){const{result:t,store:s,environment:r}=e;if(t.terms)return t.terms;const i=s.getModel();if(!i)return[];const n=r.defaultRecordCache.inMemoryRecordCache.makeGetRecordValueFn(r.currentUser.id),o=(0,h().KM)((0,d().g)({blockValue:i,getRecordValue:n}).text);if(!o)return[];return(0,E().Nt)(o)}({environment:ie,store:s,result:e}):e.terms;return{store:s,originalPosition:t,...e,serverEventProperties:b,terms:r}}));Je.current=!(y<n);const C=S().hS([...a,...x],(e=>(0,K().a)(e)));Ge.current=C,Xe.current=S().hS([...qe?x:[],...Xe.current],(e=>(0,K().a)(e))),qe||(Se((e=>e.query!==r?e:(Le(s,{query:r,isSuccess:"success"===g.type,totalResultsCount:y}),{...e,serverResults:C,isResultsLoading:!1,numTotalServerResults:y,debugInfo:g.data.debug}))),me(r))}),[ve,qe,ze,m,e.options.searchExperimentOverrides,Pe,Fe,st,be,te,ie,me,Le,G,re]),it=(0,r.useCallback)((e=>{!J&&ke&&Je.current&&!Ce&&fe&&(Je.current=!1,he.current=!1,Se((e=>({...e,isResultsLoading:!0}))),rt({query:ee,spaceStore:ke,size:e??20}))}),[ke,J,rt,fe,Ce,ee]),nt="mini_quick_find"===te?100:F().ab,ot=(0,u().d)(it,nt),at=(0,o().Y)(rt,qe?0:F().ab),lt=(0,r.useRef)(!1);return(0,r.useEffect)((()=>{!lt.current&&null!=ke&&ke.id&&"mini_quick_find"!==te&&(lt.current=!0,I().callApi({eventName:"warmSearchCache",environment:ie,data:{spaceId:ke.id}}))}),[null==ke?void 0:ke.id,ie,te]),(0,r.useEffect)((()=>{$e&&(Xe.current=[],et.current=[],Ge.current=[],Se((e=>({...H(),searchSessionId:e.searchSessionId})))),Ze&&(he.current=!0,Se((e=>({...e,isResultsLoading:!0,query:ee}))),De({query:ee,spaceStore:ke}),at({query:ee,spaceStore:ke,size:se}))}),[ke,De,at,se,ee,Ze,$e,te]),{results:Te,isResultsLoading:Ce,searchSessionId:be,fetchAdditionalServerResultsOnChange:!J&&!ve&&Je.current&&Qe?ot:void 0,searchSessionFlowNumber:de.current.number,hasMoreResults:Je.current,debugInfo:ye.debugInfo,searchAnalytics:{trackSelectSearchItem:Ke,endTimeToRenderServerResultsTiming:_e}}}function H(){return{query:void 0,localResults:[],numTotalLocalResults:0,serverResults:[],numTotalServerResults:0,searchSessionId:(0,m().JW)(),isResultsLoading:!1,debugInfo:void 0}}function W(e){const{query:t,serverResults:s}=e;return t?s.filter((e=>(0,E().uv)({query:t,resultText:(e.terms??[]).join(" "),isLastQueryTermPartialMatchOK:!0}))):[]}function Y(e){const{blockTypes:t,queryType:s}=e;switch(s){case g().Vz.CollectionsInSpace:return["collection_view","collection_view_page"];case g().Vz.BlocksInCollection:return["page","collection_view_page"];case g().Vz.BlocksInSpace:default:return t??[]}}function Q(e){const t=new Set;return e.filter((e=>{const s=e.store,r=(null==s?void 0:s.getCollectionStores())??[];if(r.every((e=>t.has(e.id))))return!1;for(const i of r)t.add(i.id);return!0}))}},176412:(e,t,s)=>{s.d(t,{L:()=>i});s(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"0.97 2.72 18.06 14.56",svg:(0,s(474848).jsx)("path",{d:"M3.893 2.875a.626.626 0 0 1 .79-.02l.091.088.128.148.015.033.072.105 11.27 13.148a.623.623 0 0 1-1.033.68l-1.616-1.884c-1.12.408-2.338.633-3.61.633-3.757 0-7.049-1.946-8.707-4.843l-.155-.283a1.46 1.46 0 0 1 0-1.359l.155-.283c.89-1.554 2.25-2.834 3.898-3.687L3.825 3.757l-.072-.105a.626.626 0 0 1 .14-.777M7.41 7.941a3.3 3.3 0 0 0-.717 2.056l.004.17A3.307 3.307 0 0 0 9.83 13.3l.17.004c.595 0 1.151-.161 1.634-.437l-1.52-1.773a1.104 1.104 0 0 1-1.18-1.377zM10 4.194c3.878 0 7.26 2.075 8.862 5.127l.074.164c.125.332.125.7 0 1.032l-.074.163a9.3 9.3 0 0 1-2.987 3.327l-2.69-3.138a3.3 3.3 0 0 0 .116-.702l.005-.17a3.31 3.31 0 0 0-3.136-3.303L10 6.691a3 3 0 0 0-.377.022L7.682 4.447A10.7 10.7 0 0 1 10 4.194"})},i=(0,s(340498).wt)("eyeSlashFill",r)},177148:(e,t,s)=>{s.d(t,{Y:()=>i});s(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"4.12 2.37 11.75 15.25",svg:(0,s(474848).jsx)("path",{d:"M6.25 2.375A2.125 2.125 0 0 0 4.125 4.5v11c0 1.174.951 2.125 2.125 2.125h7.5a2.125 2.125 0 0 0 2.125-2.125V8.121c0-.563-.224-1.104-.622-1.502L11.63 2.997a2.13 2.13 0 0 0-1.502-.622zM5.375 4.5c0-.483.392-.875.875-.875h3.7V6.25A2.05 2.05 0 0 0 12 8.3h2.625v7.2a.875.875 0 0 1-.875.875h-7.5a.875.875 0 0 1-.875-.875zm8.691 2.7H12a.95.95 0 0 1-.95-.95V4.184z"})},i=(0,s(340498).wt)("pageEmpty",r)},201145:(e,t,s)=>{s.d(t,{y:()=>u});var r=()=>s(726637),i=()=>s(56366),n=()=>s(762433),o=()=>s(979340),a=()=>s(369955),l=()=>s(646736);function u(e){const t=(0,l().I_)(),s=(0,i().K8)((()=>Boolean((null==t?void 0:t.isMember())&&!(null!=t&&t.isWorkspaceOwner()))),[t]),u=(0,a().L)(),c=(0,i().K8)((()=>null==u?void 0:u.getDisableMemberUpgradeRequests()),[u]);return!r().A.isMobile&&(!c&&(!!(0,o().jR)((0,n().AI)(e))&&(!(0,n().et)(e)&&s)))}},233692:(e,t,s)=>{function r(e,t="Untitled Agent"){return{name:e.getName()||t,icon:e.getIcon()||""}}s.d(t,{m:()=>r})},248730:(e,t,s)=>{s.d(t,{j:()=>r});s(898992),s(672577);function r(e,t,s){var r;if(!t||!s)return"unrequested";const i=null===(r=t[e])||void 0===r?void 0:r.find((e=>e.created_by_id===s));return i&&i.request_status||"unrequested"}},270812:(e,t,s)=>{s.d(t,{E:()=>g});var r=s(296540),i=()=>s(564884),n=()=>s(484714),o=()=>s(232802),a=()=>s(762433),l=()=>s(985529),u=()=>s(496603),c=()=>s(249847),d=()=>s(369955),p=()=>s(324561),m=()=>s(568688),h=()=>s(201145),f=()=>s(398304),v=()=>s(516116);function g(e){const{type:t,analyticsEntrypoint:s,entrypoint:g,isOptimisticUpsell:y}=e,S=(0,n().v3)(),b=(0,d().L)(),M=null==b?void 0:b.id,_=(0,c().T)(),I=(0,p().lh)({spaceId:M}),x=(0,h().y)(I);let C,w;if("product"!==t||(0,a().eh)(I,e.product)){if("feature"===t&&(y||!(0,l().e2)(e.featureAvailability))){var A;const t=null===(A=e.featureAvailability)||void 0===A?void 0:A.upsell;"product"===(null==t?void 0:t.type)&&(C=t.product)}}else C=e.product;C&&(0,o().rU)(C)&&(w=C);const{requests:k}=(0,m().I)({spaceId:M}),[T,R]=(0,v().k)({feature:w,requests:k,userId:_}),q=x&&"unrequested"===T,P=(0,r.useCallback)((()=>{if(!w||!q)return u().lQ;(0,i().u)({environment:S,event:{eventName:"upgrade_request_button_clicked",eventProperties:{feature:w,entrypoint:s}}}),f().Q.update((e=>({open:!0,feature:w,userId:_,setRequestState:R,entrypoint:g})))}),[q,S,w,s,_,R,g]);return w?{openModal:P,requestState:T,canUserRequestUpgrade:q,isUserEligibleToRequestUpgrade:x,userHasPendingRequest:"pending"===T}:{openModal:P,requestState:"unrequested",canUserRequestUpgrade:!1,isUserEligibleToRequestUpgrade:!1,userHasPendingRequest:!1}}},274894:(e,t,s)=>{s.d(t,{f:()=>n});s(296540);var r=()=>s(401497),i=s(474848);function n(e){const t=(0,r().IS)((e=>({assistantBlueLink:{color:e.blue.text.accentPrimary,cursor:"pointer",fontWeight:600}})),[]);return(0,i.jsx)("span",{style:t.assistantBlueLink,onClick:e.onClick,children:e.children})}},313171:(e,t,s)=>{s.d(t,{L:()=>o});s(296540);var r=()=>s(970236),i=()=>s(69708),n=s(474848);function o(){return(0,n.jsx)(r().E,{content:(0,n.jsx)(i().sA,{id:"spaceUserMembershipType.restrictedMember",defaultMessage:"Restricted"}),color:"yellow"})}},341694:(e,t,s)=>{s.d(t,{H:()=>u});var r=()=>s(56366),i=()=>s(21510),n=()=>s(696746),o=()=>s(765957),a=()=>s(375447);const l=["reply_menu_all_updates","reply_menu_archive","reply_menu_mentions_comments"];function u(){const e=(0,r().K8)((()=>i().A.state.open&&l.includes(i().A.state.discussionLocation)),[]),t=(0,r().K8)((()=>a().Ay.getIsMockText()),[]),s=(0,r().K8)((()=>(0,n().lU)(o().default.state.mainEditorCurrentBlockStore)),[]);return!t&&!e&&!s}},362976:(e,t,s)=>{function r(e){const t=e.getSchema();if(t)for(const[r,i]of Object.entries(t)){var s;if(i&&"text"===i.type&&"summarize"===(null===(s=i.ai_inference)||void 0===s?void 0:s.type)){const t=e.getPropertyValue(r);if(t)return t}}}s.d(t,{E:()=>r})},381379:(e,t,s)=>{s.d(t,{r:()=>I});s(898992),s(354520),s(581454);var r=()=>s(484714),i=()=>s(56366),n=()=>s(179034),o=()=>s(519831),a=()=>s(245241),l=()=>s(534177),u=()=>s(807700),c=()=>s(486674),d=()=>s(847585),p=()=>s(825972),m=()=>s(135599),h=()=>s(981342),f=()=>s(311337),v=()=>s(73199),g=()=>s(765957),y=()=>s(148832),S=()=>s(543665);const b=20;function M(e,t){return e instanceof y().B?t?!e.isPersonProfile():!e.isPersonProfile()&&!e.isPeopleCollectionViewPage():e instanceof S().m||void(0,l().HB)(e)}function _(e){return e instanceof S().m?!(0,u().l)(e)&&!(0,d().z)(e):e instanceof y().B||void(0,l().HB)(e)}function I(e){const{query:t,disabled:s,includeDataSources:l,blockStore:u}=e,d=(0,r().v3)(),y=(0,i().O$)(g().AppStoreSidebarSpaceStore),I=(0,i().K8)((()=>(0,f().y)(d)),[d]),{overriddenPublicShareLinkSpaceStore:x,furthestPublicShareAncestorId:C}=(0,v().W)(),w=(0,i().K8)((()=>Boolean(g().AppStoreSidebarSpaceStore||x||u)),[u,x]),A=(0,i().K8)((()=>{var e;return null===(e=(0,c().a)())||void 0===e?void 0:e.id}),[]),k=(0,i().K8)((()=>{if(s)return[];return p().NK.state.filter((e=>e.pageId!==A)).slice(0,b).map((e=>e.store))}),[A,s]),T=""===t,{results:R,isResultsLoading:q}=(0,m().W)({...I?{type:a().Vz.BlocksInAncestor,ancestorId:C??""}:{type:a().Vz.BlocksInSpace},source:"mention_menu",query:t,limit:b,filters:{isDeletedOnly:!1,excludeTemplates:!0,includePublicPagesWithoutExplicitAccess:I,navigableBlockContentOnly:!0,excludeSurrogateCollections:!l},options:{disable:s||!w||T||I&&!C,overrideSpaceStore:I?x:void 0},peopleBlocksToInclude:"collection_view_page"}),P=(0,i().K8)((()=>(0,h().jj)(y)),[y]),F=(0,i().K8)((()=>T?k.map((e=>({store:e,serverEventProperties:void 0}))).filter((({store:e})=>M(e,P)&&_(e))):R.map((({store:e,collectionId:t,isSurrogateCollection:s,serverEventProperties:r})=>({store:s&&t?S().m.createChildStore(e,{table:o().Vl,id:t}):e,serverEventProperties:r}))).filter((({store:e})=>M(e,P)&&_(e)))),[R,k,T,P]);return l?{results:F,isLoading:q}:{results:F.filter((e=>e.store.table===n().ev)),isLoading:q}}},398304:(e,t,s)=>{s.d(t,{Q:()=>r});const r=s(757695).Store.createValue({open:!1},{name:"UpgradeRequestFormModalStore"})},409268:(e,t,s)=>{s.d(t,{s:()=>n});s(898992),s(672577);var r=s.n(s(791611)),i=()=>s(489348);function n(e){const t=i().A.find((t=>t.store===e));if(t){const e=t.getContentWrapEl();if(e)return r()(e.innerText)}return 0}},412669:(e,t,s)=>{s.d(t,{K:()=>r});const r=s(757695).Store.createValue(!1)},421861:(e,t,s)=>{s.d(t,{i:()=>S});var r=s(296540),i=()=>s(726637),n=()=>s(56366),o=()=>s(764880),a=s(474848);const l={viewBox:"0 0 16 16",fittedViewBox:"2.49 2.19 11.01 11.97",svg:(0,a.jsx)("path",{d:"m4.145 2.922-.228-.265a.55.55 0 1 0-.835.716l1.49 1.739a3.9 3.9 0 0 0-.46 1.836v.895a2.78 2.78 0 0 1-.686 1.83l-.617.703c-.708.81-.133 2.078.943 2.078h2.2a2.081 2.081 0 0 0 4.095 0h.819l1.216 1.419a.55.55 0 0 0 .843-.707L4.152 2.931zm1.068 4.026q.002-.482.152-.912l4.558 5.318h-6.17a.153.153 0 0 1-.116-.253l.616-.705c.619-.706.96-1.614.96-2.553zm1.773 5.506h2.028a1.081 1.081 0 0 1-2.028 0m6.302-.554a1.244 1.244 0 0 0-.098-1.524l-.616-.704a2.78 2.78 0 0 1-.687-1.829v-.895a3.89 3.89 0 0 0-2.124-3.465 1.85 1.85 0 0 0-3.526 0l-.112.06.737.86.062-.027.29-.121.043-.312A.75.75 0 0 1 8 3.29c.378 0 .692.281.743.653l.042.312.29.121a2.79 2.79 0 0 1 1.712 2.572v.895c0 .513.101 1.016.294 1.482z"})},u=(0,s(340498).wt)("bellSlashSmall",l);var c=()=>s(69708),d=()=>s(534177),p=()=>s(284371),m=()=>s(486674),h=()=>s(646736),f=()=>s(765957),v=()=>s(231704),g=()=>s(313171);function y(e,t){const{user:r,focused:l}=e,d=(0,s(484714).v3)(),h=(0,c().tz)(),v=(0,s(401497).IS)((e=>({icon:{width:17,height:17,fill:e.icon.secondary},tooltip:{color:e.text.inverseSecondary,fontWeight:p().Wy.regular,maxWidth:240},tooltipHeader:{color:e.text.inversePrimary,fontWeight:p().Wy.medium}})),[]),g=(0,o().A7)(r),y=(0,o().lR)(h,g),S=(0,n().K8)((()=>{const e=(0,m().a)();return!(e&&(0,s(928074).Aj)({store:e}))||"none"!==(0,s(329443).om)(r.id)}),[r.id]),_=(0,n().K8)((()=>{var e;return r.id===(null===(e=f().default.state.currentUserStore)||void 0===e?void 0:e.id)}),[r.id]),I=(0,s(341694).H)(),x=(0,n().K8)((()=>{if(!I)return;if(!l)return;if(S)return;const e=(0,m().a)(),t=e&&Boolean(s(763884).K.get({userId:d.currentUser.id,key:(0,s(773706).T)(e.id)})),r=null==e?void 0:e.canAdmin();return!t&&r?(0,s(97835).inviteMemberIcon)(v.icon):u(v.icon)}),[I,d.currentUser.id,S,l,v.icon]),C=(0,n().K8)((()=>{if(!I)return null;const e=r.email;return(0,a.jsxs)("div",{style:v.tooltip,children:[(0,a.jsx)("header",{style:v.tooltipHeader,children:(0,a.jsx)(M,{userName:y,userHasAccessToPage:S,userIsSelf:_})}),e]})}),[I,S,_,y,r.email,v.tooltip,v.tooltipHeader]);return(0,a.jsx)(s(457688).A,{...e,ref:t,actor:g,right:x,tooltip:C,badge:(0,a.jsx)(b,{user:r}),tooltipPlacement:I?"right":void 0,useEmailAsTooltip:!I,customUserTitleStyles:i().A.isMobile?{fontSize:14}:void 0,iconSizeOverride:i().A.isMobile?24:void 0})}const S=r.forwardRef(y);function b({user:e}){const t=(0,n().O$)(f().AppStoreSidebarSpaceStore),s=(0,n().K8)((()=>{var s;if(t)return null===(s=(0,h().dp)(t,e.id))||void 0===s?void 0:s.getMembershipType()}),[t,e.id]);if(!s)return null;switch(s){case"none":case"member":case"membership_admin":case"owner":return null;case"page_guest":return(0,a.jsx)(v().w,{labelType:"guest"});case"restricted_member":return(0,a.jsx)(g().L,{});default:(0,d().HB)(s)}}function M({userName:e,userHasAccessToPage:t,userIsSelf:s}){return s?(0,a.jsx)(c().sA,{defaultMessage:"You",id:"activitySection.authorPhrase.forOneAuthorCurrentUser.label"}):t?null:(0,a.jsx)(c().sA,{id:"mentionMenu.UserMentionMenuItem.noAccessTooltip",defaultMessage:"{userName} won’t be notified because they don’t have page access",values:{userName:e}})}},461924:(e,t,s)=>{s.d(t,{o:()=>r});s(898992),s(354520);class r{constructor(e){this.rowsStore=new i,this.sort=void 0,this.filter=void 0,this.abortController=void 0,this.isFetching=!1,this.rowsStore.setState({rows:e,hasMore:!0})}async _maybeFetch(){if(!this.isFetching){this.isFetching=!0;try{return await this.fetch()}finally{this.isFetching=!1}}}async loadMore(){const e=await this._maybeFetch();e&&this.rowsStore.setState({rows:[...this.rowsStore.getState().rows??[],...e.rows??[]],hasMore:e.hasMore})}async setSort(e){this.sort=e,await this.refresh()}async setFilter(e){this.filter=e,await this.refresh()}async refresh(){var e;null===(e=this.abortController)||void 0===e||e.abort(),this.isFetching=!1;const t=await this._maybeFetch();t&&this.rowsStore.setState({rows:t.rows,hasMore:t.hasMore})}}class i extends(()=>s(757695))().Store{getInitialState(){return{rows:void 0,hasMore:!0}}}},516116:(e,t,s)=>{s.d(t,{k:()=>n});var r=s(296540),i=()=>s(248730);function n({requests:e,feature:t,userId:s}){const[n,o]=(0,r.useState)("loading");return(0,r.useEffect)((()=>{if(!t)return;const r=(0,i().j)(t,e,s);o(r)}),[e,t,s]),[n,o]}},556122:(e,t,s)=>{s.d(t,{QJ:()=>m,TI:()=>u});s(944114),s(581454);var r=()=>s(726637),i=()=>s(763824);let n=0;const o="clipboard",a={debug:Boolean(r().A.isDevelopingInAirplaneMode),responseText:o,showErrorCode:!1,delayBetweenChunks:20,chunkSize:5,numLoremIpsums:3},l="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec porta auctor sem vel efficitur. Vivamus efficitur eros sed erat efficitur efficitur. Vivamus et augue vel est efficitur efficitur.";function u(){return a}function c(e){return{async*[Symbol.asyncIterator](){for(const t of e)await(0,i().wR)(a.delayBetweenChunks),yield t}}}function d(e,t){const s=Math.ceil(e.length/t),r=new Array(s);for(let i=0,n=0;i<s;++i,n+=t)r[i]=e.substr(n,t);return r}function p(e){return e.map((e=>({type:"success",p:"padding",completion:e,inferenceId:"mock"})))}async function m({environment:e,data:t}){console.log("Retrieving fake completion for data",t);const{context:s}=t,i=s.selectedText,u=[];let{responseText:m}=a;if(m===o&&(m=await async function(){try{return await navigator.clipboard.readText()}catch(e){return}}()??"Unable to retrieve clipboard text."),void 0===m&&(u.push({type:"success",p:"padding",completion:"\n",inferenceId:"mock"},{type:"success",p:"padding",completion:"this is ",inferenceId:"mock"},{type:"success",p:"padding",completion:"fake ",inferenceId:"mock"},{type:"success",p:"padding",completion:`streaming response ${n++}.`,inferenceId:"mock"}),r().A.isDevelopingInAirplaneMode&&u.push({type:"success",p:"padding",completion:"\n\nTo see a real AI response, run the server with `--airplaneMode=false`.",inferenceId:"mock"}),"string"==typeof i)){u.push({type:"success",p:"padding",completion:"\n\nHere is the text you selected:\n\n",inferenceId:"mock"});for(const e of d(i,a.chunkSize))u.push({type:"success",completion:e,p:"padding",inferenceId:"mock"})}if(a.showErrorCode)u.push({type:"error",message:"alas",errorCode:a.showErrorCode});else if(void 0===m)for(let r=0;r<a.numLoremIpsums;r++)u.push(...p([`\n\n${r+1}. `,...d(l,0===a.delayBetweenChunks?l.length:a.chunkSize)]));else if(m.length>0){const e=d(m,a.chunkSize);u.push(...p(e))}return Promise.resolve({type:"success",data:c(u),status:200,headers:{}})}(0,s(852832).exposeDebugValue)("completionDebugSettings",a)},563884:(e,t,s)=>{s.d(t,{k:()=>i});s(296540);var r=s(474848);const i=(0,s(340498).wt)("calendar",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M3.24902 14.7764H12.6621C14.1455 14.7764 14.918 14.0107 14.918 12.5479V4.22852C14.918 2.76562 14.1455 2 12.6621 2H3.24902C1.77246 2 1 2.75879 1 4.22852V12.5479C1 14.0107 1.77246 14.7764 3.24902 14.7764ZM3.24219 13.416C2.6748 13.416 2.36035 13.1221 2.36035 12.5205V6.23145C2.36035 5.62988 2.6748 5.33594 3.24219 5.33594H12.6689C13.2363 5.33594 13.5508 5.62988 13.5508 6.23145V12.5205C13.5508 13.1221 13.2363 13.416 12.6689 13.416H3.24219ZM6.63965 7.69434H7.04297C7.28906 7.69434 7.37109 7.61914 7.37109 7.37988V6.97656C7.37109 6.73047 7.28906 6.65527 7.04297 6.65527H6.63965C6.39355 6.65527 6.31152 6.73047 6.31152 6.97656V7.37988C6.31152 7.61914 6.39355 7.69434 6.63965 7.69434ZM8.875 7.69434H9.27832C9.51758 7.69434 9.59961 7.61914 9.59961 7.37988V6.97656C9.59961 6.73047 9.51758 6.65527 9.27832 6.65527H8.875C8.62891 6.65527 8.54688 6.73047 8.54688 6.97656V7.37988C8.54688 7.61914 8.62891 7.69434 8.875 7.69434ZM11.1035 7.69434H11.5068C11.7529 7.69434 11.835 7.61914 11.835 7.37988V6.97656C11.835 6.73047 11.7529 6.65527 11.5068 6.65527H11.1035C10.8643 6.65527 10.7822 6.73047 10.7822 6.97656V7.37988C10.7822 7.61914 10.8643 7.69434 11.1035 7.69434ZM4.41113 9.89551H4.80762C5.05371 9.89551 5.13574 9.82031 5.13574 9.57422V9.1709C5.13574 8.93164 5.05371 8.85645 4.80762 8.85645H4.41113C4.16504 8.85645 4.08301 8.93164 4.08301 9.1709V9.57422C4.08301 9.82031 4.16504 9.89551 4.41113 9.89551ZM6.63965 9.89551H7.04297C7.28906 9.89551 7.37109 9.82031 7.37109 9.57422V9.1709C7.37109 8.93164 7.28906 8.85645 7.04297 8.85645H6.63965C6.39355 8.85645 6.31152 8.93164 6.31152 9.1709V9.57422C6.31152 9.82031 6.39355 9.89551 6.63965 9.89551ZM8.875 9.89551H9.27832C9.51758 9.89551 9.59961 9.82031 9.59961 9.57422V9.1709C9.59961 8.93164 9.51758 8.85645 9.27832 8.85645H8.875C8.62891 8.85645 8.54688 8.93164 8.54688 9.1709V9.57422C8.54688 9.82031 8.62891 9.89551 8.875 9.89551ZM11.1035 9.89551H11.5068C11.7529 9.89551 11.835 9.82031 11.835 9.57422V9.1709C11.835 8.93164 11.7529 8.85645 11.5068 8.85645H11.1035C10.8643 8.85645 10.7822 8.93164 10.7822 9.1709V9.57422C10.7822 9.82031 10.8643 9.89551 11.1035 9.89551ZM4.41113 12.0898H4.80762C5.05371 12.0898 5.13574 12.0146 5.13574 11.7754V11.3721C5.13574 11.126 5.05371 11.0508 4.80762 11.0508H4.41113C4.16504 11.0508 4.08301 11.126 4.08301 11.3721V11.7754C4.08301 12.0146 4.16504 12.0898 4.41113 12.0898ZM6.63965 12.0898H7.04297C7.28906 12.0898 7.37109 12.0146 7.37109 11.7754V11.3721C7.37109 11.126 7.28906 11.0508 7.04297 11.0508H6.63965C6.39355 11.0508 6.31152 11.126 6.31152 11.3721V11.7754C6.31152 12.0146 6.39355 12.0898 6.63965 12.0898ZM8.875 12.0898H9.27832C9.51758 12.0898 9.59961 12.0146 9.59961 11.7754V11.3721C9.59961 11.126 9.51758 11.0508 9.27832 11.0508H8.875C8.62891 11.0508 8.54688 11.126 8.54688 11.3721V11.7754C8.54688 12.0146 8.62891 12.0898 8.875 12.0898Z"})})},568688:(e,t,s)=>{s.d(t,{I:()=>o});var r=()=>s(484714),i=()=>s(56366),n=()=>s(920370);function o({spaceId:e}){const t=(0,r().v3)(),s=(0,i().K8)((()=>e?n().L.getData(t,{spaceId:e}):"no_space_id"),[t,e]);return"no_space_id"===s?{isLoading:!1,requests:{}}:{isLoading:void 0===s,requests:s??{}}}},576737:(e,t,s)=>{s.d(t,{z:()=>r});s(944114),s(898992),s(354520),s(581454);class r extends(()=>s(461924))().o{constructor(e){const{users:t,initialMembershipFilter:s,initialSort:r,initialQuery:i,limit:n}=e;super([]),this._allUsers=void 0,this._filteredAndSortedUsers=[],this._currentPage=0,this._limit=void 0,this._query=void 0,this._allUsers=[...t],this._limit=n??20,this._query=void 0,this.filter=s,this.sort=r,this._query=i,this._updateFilteredAndSortedUsers(),this.refresh()}_updateFilteredAndSortedUsers(){let e=this._applyMembershipFilter(this._allUsers);this._query&&(e=this._applySearch(e)),this.sort&&(e=this._applySort(e)),this._filteredAndSortedUsers=e}_applyMembershipFilter(e){return this.filter?e.filter((e=>{var t;return e.membership_type&&(null===(t=this.filter)||void 0===t?void 0:t.includes(e.membership_type))})):e}_applySearch(e){return this._query&&0!==this._query.length?(0,s(778078).Ay)(this._query,e,(e=>{const t=[e.name,e.email];return e.aliases&&e.aliases.length>0&&t.push(...e.aliases),t.filter(Boolean).join(" ")})):e}_applySort(e){if(!this.sort)return e;const{field:t,direction:s}=this.sort,r="asc"===s?1:-1,i=e.map((e=>{let s,r;switch(t){case"name_normalized":s=this._normalizeName(e.name)||e.email.toLowerCase();break;case"type":s=this._getMembershipTypeRank(e.membership_type),r=this._normalizeName(e.name)||e.email.toLowerCase();break;case"first_joined":s=e.first_joined_space_time||0;break;default:s=null}return{user:e,sortValue:s,secondarySortValue:r}}));return i.sort(((e,s)=>{if(null===e.sortValue&&null===s.sortValue);else{if(null===e.sortValue)return Number(r);if(null===s.sortValue)return-1*r;if(e.sortValue<s.sortValue)return-1*r;if(e.sortValue>s.sortValue)return Number(r)}if("type"===t&&e.secondarySortValue&&s.secondarySortValue){if(e.secondarySortValue<s.secondarySortValue)return-1;if(e.secondarySortValue>s.secondarySortValue)return 1}return(e.user.id<s.user.id?-1:1)*r})),i.map((e=>e.user))}_normalizeName(e){return null==e?void 0:e.normalize("NFKD").toLowerCase().replace(/\p{Diacritic}/gu,"")}_getMembershipTypeRank(e){switch(e){case"owner":return 6;case"membership_admin":return 5;case"member":return 4;case"restricted_member":return 3;case"page_guest":return 2;case"none":return 1;default:return 0}}async setUsers(e){this._allUsers=[...e],this._updateFilteredAndSortedUsers(),await this.refresh()}async setFilter(e){this.filter!==e&&(this._currentPage=0,this.filter=e,this._updateFilteredAndSortedUsers(),await this.refresh())}async setSort(e){var t,s;(null===(t=this.sort)||void 0===t?void 0:t.field)===(null==e?void 0:e.field)&&(null===(s=this.sort)||void 0===s?void 0:s.direction)===(null==e?void 0:e.direction)||(this._currentPage=0,this.sort=e,this._updateFilteredAndSortedUsers(),await this.refresh())}async setQuery(e){this._query!==e&&(this._query=e,this._currentPage=0,this._updateFilteredAndSortedUsers(),await this.refresh())}async fetch(){const e=this._currentPage*this._limit,t=e+this._limit,s=this._filteredAndSortedUsers.slice(e,t),r=t<this._filteredAndSortedUsers.length;return Promise.resolve({rows:s,hasMore:r})}async loadMore(){this.isFetching||(this._currentPage++,await super.loadMore())}async refresh(){this._currentPage=0,await super.refresh()}TEST_ONLY_setLimit(e){this._limit=e}}},585428:(e,t,s)=>{s.d(t,{e:()=>r});s(16280),s(898992),s(354520);class r extends(()=>s(461924))().o{constructor({users:e,environment:t,spaceId:s,initialMembershipFilter:r,initialSort:i,initialQuery:n,limit:o}){super(e),this._spaceId=void 0,this._environment=void 0,this._cursor=void 0,this._limit=void 0,this._query=void 0,this._environment=t,this._limit=o??20,this._cursor=void 0,this._query=void 0,this._spaceId=s,this.filter=r,this.sort=i,this._query=n,this.refresh()}async setFilter(e){this.filter!==e&&(this._cursor=void 0,this.filter=e,await this.refresh())}async setSort(e){var t,s;(null===(t=this.sort)||void 0===t?void 0:t.field)===(null==e?void 0:e.field)&&(null===(s=this.sort)||void 0===s?void 0:s.direction)===(null==e?void 0:e.direction)||(this._cursor=void 0,this.sort=e,await this.refresh())}async setQuery(e){this._query!==e&&(this._query=e,this._cursor=void 0,await this.refresh())}async refresh(){this._cursor=void 0,await super.refresh()}async fetch(){return await(0,s(532313).L5)({fn:async()=>{var e,t;const{callApi:r}=await Promise.resolve().then(s.bind(s,559506)),i=s(242422).default.getConfigKey("email_alias_migration","mode");this.abortController=new AbortController;const n=await r({eventName:"listUsers",environment:this._environment,data:{cursor:this._cursor,membershipFilter:this.filter,limit:this._limit,sort:null===(e=this.sort)||void 0===e?void 0:e.field,sortDirection:null===(t=this.sort)||void 0===t?void 0:t.direction,query:this._query,spaceId:this._spaceId,includeAliasSearch:(0,s(313491).K)(i)},abortSignal:this.abortController.signal});if(this.abortController=void 0,"success"===n.type)return this._cursor=n.data.nextCursor,{rows:n.data.users,hasMore:n.data.hasMore};if("failed"===n.type&&(n.offline||429===n.status||503===n.status||504===n.status))throw new Error(`RetryableError:${n.status}`)},handleError:(e,t)=>t?{status:"throw",error:e}:{status:"retry"},retryAttemptsMS:[1e3,2e3,4e3],retryAttemptRandomOffsetMS:500,initialInput:void 0})}}},661077:(e,t,s)=>{s.d(t,{P:()=>r});const r=s(757695).Store.createValue(!0,{name:"IsAiEligibleStore"})},676370:(e,t,s)=>{s.d(t,{CT:()=>n,uv:()=>i,zL:()=>o,zj:()=>r});const r=["ai_unified_find_search_modal","ai_unified_find_chat","ai_chat_with_model","ai_assistant_limit_in_app","ai_autofill_fill_all_pages","ai_autofill_bulk_fill","ai_autofill_on_page_edit","ai_autofill_try_on_view","ai_limit_in_app","ai_limit_property_autofill","ai_limit_sidebar","ai_limit_settings","ai_limited_qna_no_results","ai_limited_qna_upsell_action_button","ai_qna_waitlist","ai_qna_limit_in_app","ai_upsell_notice","ai_upsell_settings","ai_page_translation","ai_plans_page","ai_formulas"],i=["ai_research_mode"],n=["ai_meeting_notes","ai_meeting_notes_custom_transcript_retention"],o=["ai_agent"]},773706:(e,t,s)=>{s.d(t,{T:()=>i});const r="ShowMentionInvite";function i(e){return`${r}-${e}`}},788621:(e,t,s)=>{s.r(t),s.d(t,{iconDefinition:()=>i,personCircleIcon:()=>n});s(296540);var r=s(474848);const i={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.26 15.25",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M7.755 6.169C8.277 5.519 9.05 5.125 10 5.125s1.723.393 2.245 1.044c.51.635.75 1.474.75 2.346s-.24 1.71-.75 2.346c-.522.65-1.294 1.044-2.245 1.044-.95 0-1.723-.394-2.245-1.044-.51-.635-.75-1.474-.75-2.346s.24-1.711.75-2.346m.975.782c-.293.365-.475.909-.475 1.564s.182 1.198.475 1.564c.281.35.694.576 1.27.576s.989-.226 1.27-.576c.294-.366.475-.909.475-1.564s-.181-1.199-.475-1.564c-.281-.35-.693-.576-1.27-.576-.576 0-.989.225-1.27.576"}),(0,r.jsx)("path",{d:"M2.375 10a7.625 7.625 0 1 1 15.25 0 7.625 7.625 0 0 1-15.25 0M10 3.625a6.375 6.375 0 0 0-4.087 11.267c.789-1.397 2.333-2.33 4.087-2.33s3.298.933 4.087 2.33A6.375 6.375 0 0 0 10 3.625M13.049 15.6c-.547-1.049-1.697-1.789-3.05-1.789-1.351 0-2.501.74-3.048 1.789a6.35 6.35 0 0 0 3.049.775 6.34 6.34 0 0 0 3.049-.775"})]})},n=(0,s(340498).wt)("personCircle",i)},794417:(e,t,s)=>{s.r(t),s.d(t,{default:()=>et});s(898992),s(354520),s(581454),s(737550);var r=s(296540),i=()=>s(242422),n=()=>s(726637),o=()=>s(484714),a=()=>s(852507),l=()=>s(118884),u=()=>s(56366),c=()=>s(401497),d=()=>s(396896),p=()=>s(416504),m=()=>s(992437),h=()=>s(386164),f=()=>s(450648),v=()=>s(245241),g=()=>s(201980),y=()=>s(69708),S=()=>s(496603),b=()=>s(559506),M=()=>s(46497),_=()=>s(847743),I=()=>s(658883),x=()=>s(780865),C=()=>s(135599),w=()=>s(857437),A=()=>s(152197),k=()=>s(106628),T=()=>s(765957),R=()=>s(786601),q=()=>s(250484),P=()=>s(693202),F=()=>s(122058),E=()=>s(676007),L=()=>s(417392),B=()=>s(974779),V=()=>s(500251),j=(s(944114),()=>s(98126)),O=()=>s(760217),U=()=>s(939740),D=()=>s(89924),K=s(474848);const N=r.memo((function(e){const t=e.isResultsView,i=(0,o().v3)(),n=(0,u().K8)((()=>R().A.state.debug),[]),{localResults:a,serverResults:l,exposedSearchExperiments:p}=(0,r.useMemo)((()=>{const t=[],s=[];let r;for(const o of e.results){var i;var n;if((null===(i=o.sources)||void 0===i?void 0:i.includes(v().Ni.Local))?t.push(o):s.push(o),!r&&o.serverEventProperties)r=null===(n=o.serverEventProperties)||void 0===n?void 0:n["server-searchExperiments"]}return{localResults:t,serverResults:s,exposedSearchExperiments:r}}),[e.results]),m=(n.enabled,n.enabled&&n.showSecondaryPane,(0,u().K8)((()=>(0,s(148777).PE)({environment:i}).localSearchableBlocksCacheLoaded),[i])),h=(0,c().IS)((e=>({container:{paddingTop:8,paddingBottom:8,paddingInlineEnd:12,paddingInlineStart:16,color:e.text.secondary,display:"flex",justifyContent:"space-between",borderTop:`1px solid ${e.lightDividerColor}`,marginTop:1},leftSide:{display:"flex",alignItems:"center",gap:12},indexBuilding:{color:e.text.tertiary,fontSize:12,display:"flex"}})),[]);return(0,K.jsxs)("div",{style:h.container,children:[(0,K.jsxs)("div",{style:h.leftSide,children:[m?null:(0,K.jsx)("div",{style:h.indexBuilding,children:(0,K.jsxs)(d().fI,{gap:4,alignItems:"center",children:[(0,K.jsx)(j().A,{style:{height:12,width:12}}),"Building..."]})}),(0,K.jsx)(s(857744).A,{})]}),(0,K.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,K.jsx)(s(942095).c,{source:v().m2.searchModal,localResults:a,serverResults:l,debugInfo:e.debugInfo,exposedSearchExperiments:p,reportBadSearchInputRequest:e.reportBadSearchInputRequest,buttonStyles:{visibility:t?"visible":"hidden",pointerEvents:t?"auto":"none"}}),null]})]})}));(0,y().YK)({debugToggle:{id:"miniSearch.debugToggle",defaultMessage:"Debug options"}});var z=()=>s(564884),H=()=>s(252291),W=()=>s(631524),Y=()=>s(582684),Q=()=>s(112412),Z=()=>s(207207),$=()=>s(177148),J=()=>s(788621),G=()=>s(737693),X=()=>s(435644),ee=()=>s(42583),te=()=>s(476524),se=()=>s(190033),re=()=>s(792540),ie=()=>s(741198),ne=()=>s(298182),oe=()=>s(805751),ae=()=>s(712855),le=()=>s(611648),ue=()=>s(30537),ce=()=>s(159506),de=()=>s(557155),pe=()=>s(333665),me=()=>s(691298),he=()=>s(970585),fe=()=>s(354305),ve=()=>s(2143),ge=()=>s(906745),ye=()=>s(231297),Se=()=>s(574036),be=()=>s(427711);function Me(e){const{isFirstSection:t,query:s,disabled:i=!1,searchSessionId:n,menuListStore:a}=e,l=(0,y().tz)(),u=(0,o().v3)(),[c,d]=(0,r.useState)("created"),[p,m]=(0,r.useState)({starting:void 0,ending:void 0}),h=(0,r.useMemo)((()=>[{key:"today",title:l.formatMessage(_e.today),value:0},{key:"last_7_days",title:l.formatMessage(_e.last7Days),value:7},{key:"last_30_days",title:l.formatMessage(_e.last30Days),value:30}]),[l]),f=(0,r.useMemo)((()=>i?[]:h.filter((e=>e.title.toLowerCase().includes(s.toLowerCase())))),[h,s,i]);!function(e){const{disabled:t,query:s,results:i,menuListStore:n}=e,o=s.trim().length>0,a=i.length>0;(0,r.useEffect)((()=>{if(t)return;const e=o&&a?{section:0,indexLocal:1,indexGlobal:1,footerFocused:!1}:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1};n.update((t=>{const{focus:s}=t;return(0,S().n4)(s,e)?t:{...t,focus:e}}))}),[t,a,n,s,o])}({disabled:i,query:s,results:f,menuListStore:a});const v=(0,r.useCallback)((e=>{!e.error&&e.value&&m((t=>({...t,...e.value})))}),[]),b=(0,r.useCallback)((()=>{if(!p.starting||!p.ending)return;const e=(0,g().Ww9)({type:"daterange",start_date:p.starting.start_date,end_date:p.ending.start_date});ye().createAndCommit({userAction:"SearchFilterMenu.dateRangeMenuClose",environment:u,canUndo:!0,perform:t=>{ce().Ju({environment:u,annotation:(0,g().uLW)({date:e,mode:c}),transaction:t})}}),m({starting:void 0,ending:void 0})}),[p,u,c]),M=(0,r.useMemo)((()=>{if(i)return[];const e=f.map((e=>({key:e.key,render:t=>(0,K.jsx)(O().A,{...t,title:e.title}),action:t=>{const s=ge().c9.now(),r=0===e.value?s:s.minus({days:e.value}),i=[g().BQP.Date,{type:"daterange",start_date:r.toISODate(),end_date:s.toISODate()}];ye().createAndCommit({userAction:"SearchFilterMenu.dateRangeMenuItem",environment:u,canUndo:!0,perform:e=>{ce().Ju({environment:u,annotation:(0,g().uLW)({date:i,mode:c}),transaction:e})}}),(0,z().u)({environment:u,event:{eventName:"search_insert_typeable_filter",eventProperties:{type:"date",search_session_id:n}}})}}))),t=()=>d("created"===c?"lastEdited":"created");return[{key:"date-mode-toggle",action:()=>t(),render:e=>(0,K.jsx)(Se().A,{...e,focused:e.focused,title:"created"===c?l.formatMessage(_e.createdMode):l.formatMessage(_e.lastEditedMode),on:"lastEdited"===c,onClick:()=>t()})},...e]}),[i,f,u,n,c,l]),_=(0,r.useMemo)((()=>{if(!i&&0!==M.length)return{key:"date range results",render:e=>(0,K.jsx)(D().A,{...e,title:(0,K.jsx)(y().sA,{defaultMessage:"Add date filter",id:"searchFilterMenu.dateRangeSection.title"}),desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:M}}),[M,t,i]),I=(0,r.useCallback)((()=>{b()}),[b]);if(!i&&_)return{menuListSection:_,element:(0,K.jsx)(be().A,{title:"Select Date Range",value:p,onUpdate:v,onDismiss:I,disableMenuWrap:!0,hideDateInputMenuItems:!0}),onDismiss:I}}const _e=(0,y().YK)({createdMode:{id:"searchFilterMenu.dateRange.mode.created",defaultMessage:"Created"},lastEditedMode:{id:"searchFilterMenu.dateRange.mode.lastEdited",defaultMessage:"Last edited"},today:{id:"searchFilterMenu.dateRange.today",defaultMessage:"Today"},last7Days:{id:"searchFilterMenu.dateRange.last7Days",defaultMessage:"Last 7 days"},last30Days:{id:"searchFilterMenu.dateRange.last30Days",defaultMessage:"Last 30 days"}});var Ie=()=>s(778078),xe=()=>s(87529);function Ce(e){const{isFirstSection:t,query:s,disabled:i=!1,searchSessionId:n}=e,a=(0,y().tz)(),l=(0,o().v3)(),u=(0,r.useMemo)((()=>i?[]:(0,Ie().Ay)(s,xe()._9,(e=>function(e,t){switch(e){case"lastEdited.desc":return t.formatMessage(xe().Jq.lastEditedNewestFirst);case"lastEdited.asc":return t.formatMessage(xe().Jq.lastEditedOldestFirst);case"created.desc":return t.formatMessage(xe().Jq.createdNewestFirst);case"created.asc":return t.formatMessage(xe().Jq.createdOldestFirst);default:return t.formatMessage(xe().Jq.bestMatches)}}(e.key,a)))),[s,a,i]),c=(0,r.useMemo)((()=>i?[]:u.map((e=>({key:e.key,render:t=>(0,K.jsx)(O().A,{...t,title:a.formatMessage(e.formattedName)}),action:()=>{const t=xe().Bo[e.key];t&&(ye().createAndCommit({userAction:"SearchFilterMenu.sortMenuItem",environment:l,canUndo:!0,perform:e=>{ce().Ju({environment:l,annotation:(0,g().wU2)(t),transaction:e})}}),(0,z().u)({environment:l,event:{eventName:"search_insert_typeable_filter",eventProperties:{type:"sort",search_session_id:n}}}))}})))),[i,u,a,l,n]),d=(0,r.useMemo)((()=>{if(0!==c.length)return{key:"sort results",render:e=>(0,K.jsx)(D().A,{...e,title:a.formatMessage(we.sortSectionTitle),desktopTitleStyle:t?{paddingTop:4}:void 0,topBorder:!t}),items:c}}),[c,t,a]);if(d)return{menuListSection:d,element:void 0}}const we=(0,y().YK)({sortSectionTitle:{id:"searchFilterMenu.sortSection.title",defaultMessage:"Sort by"}});var Ae=()=>s(385979),ke=()=>s(62856),Te=()=>s(305390),Re=()=>s(381379);function qe({show:e}){const t=(0,ke().A)(e,500,300);return(0,K.jsx)(j().A,{style:{textAlign:"center",visibility:t?"visible":"hidden",display:"inline",marginInlineStart:8}})}const Pe=(0,y().YK)({noPageResults:{defaultMessage:"No page results",id:"searchFilterMenu.noPageSearchResults.title"},linkToPage:{defaultMessage:"Add page filter",id:"searchFilterMenu.addPageFilter.title"}});var Fe=()=>s(187174),Ee=()=>s(854150),Le=()=>s(763824),Be=()=>s(534177),Ve=()=>s(95758),je=()=>s(693176),Oe=()=>s(626822);const Ue=(0,y().YK)({searchFilterTeamSection:{defaultMessage:"Add teamspace filter",id:"searchFilterMenu.teamSection.title"},noTeamspaceResults:{defaultMessage:"No teamspace results",id:"searchFilterMenu.teamSection.noResults"}});var De=()=>s(421861),Ke=()=>s(62088);const Ne=(0,y().YK)({searchFilterPeopleSection:{defaultMessage:"Add creator filter",id:"searchFilterMenu.peopleSection.title"}});function ze(e){const{query:t,menuListStore:s}=e,i=(0,u().O$)(fe().D),n=i.open?i.targetSection:void 0,a=(0,u().K8)((()=>R().A.state.sessionId),[]),l="user"===n,{userResultsSection:c}=function(e){const{query:t,isFirstSection:s,disabled:i,searchSessionId:n}=e,a=(0,o().v3)(),l=(0,y().tz)(),c=(0,u().K8)((()=>fe().D.state.open),[]),d=c&&!i,{results:p,isLoading:m}=(0,Ke().uE)({query:t,environment:a,intl:l,disabled:!d,useMentionMenuStore:!1,open:c}),h=(0,r.useMemo)((()=>p.map((e=>{const t=e.id;return{key:t,render:s=>(0,r.createElement)(De().i,{...s,key:t,user:e}),action:t=>{ye().createAndCommit({userAction:"SearchFilterMenu.userMenuItem",environment:a,canUndo:!0,perform:t=>{ce().Ju({environment:a,annotation:(0,g().J_S)(e.id),transaction:t})}}),(0,z().u)({environment:a,event:{eventName:"search_insert_typeable_filter",eventProperties:{type:"user",search_session_id:n}}})}}}))),[p,a,n]),f=(0,Ae().h)({resultsCount:h.length,shouldShow:m,hideBorders:!1,hidePathText:!0}),v=(0,r.useMemo)((()=>{const e=[...h];return f&&e.push(...f),e}),[h,f]),S=(0,r.useMemo)((()=>{if(!d)return;const e={key:"search filter user results",render:e=>(0,K.jsx)(D().A,{...e,title:(0,K.jsx)(y().sA,{...Ne.searchFilterPeopleSection}),topBorder:!s}),items:v};return{menuListSection:e,element:void 0}}),[v,s,d]);return{userResultsSection:S,isUserResultsLoading:m}}({query:t,isFirstSection:l,disabled:!l,searchSessionId:a}),d="page"===n,{pageResultsSection:p}=function(e){const{query:t,disabled:s,searchSessionId:i}=e,n=(0,y().tz)(),a=(0,o().v3)(),l=(0,u().K8)((()=>fe().D.state.open&&!s),[s]),{results:c,isLoading:d}=(0,Re().r)({query:t,disabled:!l,includeDataSources:!1}),p=(0,r.useMemo)((()=>(0,S().oE)(c.map((({store:e,serverEventProperties:t})=>{const s=e.id;return{key:s,render:t=>(0,K.jsx)(Te().A,{...t,store:e,showVerifiedPageBadge:!0}),action:e=>{ye().createAndCommit({userAction:"SearchFilterMenu.getPageResultsMenuSection",environment:a,canUndo:!0,perform:e=>{ce().Ju({environment:a,annotation:(0,g().Umo)(s),transaction:e})}}),(0,z().u)({environment:a,event:{eventName:"search_insert_typeable_filter",eventProperties:{type:"page",search_session_id:i}}})}}})))),[a,c,i]),m=(0,Ae().h)({resultsCount:p.length,shouldShow:d,hideBorders:!0}),h=(0,r.useMemo)((()=>{const e=[...p];return d&&m&&e.push(...m),e}),[p,m,d]),f=p.length>0||d?Pe.linkToPage:Pe.noPageResults,v=(0,r.useMemo)((()=>(0,K.jsxs)(K.Fragment,{children:[n.formatMessage(f),(0,K.jsx)(qe,{show:d})]})),[n,d,f]),b=(0,r.useMemo)((()=>{if(!l)return;const e={key:"search filter page results",render:e=>(0,K.jsx)(D().A,{...e,title:v,topBorder:!1}),items:h};return{menuListSection:e,element:void 0}}),[h,v,l]);return{pageResultsSection:b,isPageResultsLoading:d}}({query:t,disabled:!d,searchSessionId:a}),m="team"===n,h=function(e){const{query:t,isFirstSection:s,disabled:i,searchSessionId:n}=e,[a,l]=(0,r.useState)([]),c=(0,o().v3)(),d=(0,A().r)(),p=(0,u().K8)((()=>fe().D.state.open&&!i),[i]),m=(0,u().O$)(T().AppStoreSidebarSpaceStore);(0,Fe().Yb)((async()=>{var e;if(!p||!m)return void l([]);const s=(null===(e=T().default.state.sidebarSpaceViewStore)||void 0===e?void 0:e.getTeamsStores().filter(Be().O9))||[];if(!t)return void l(s);const r=await(0,je().lx)({query:t,current:[]},c),i=await(0,Le().lX)(r,je().UO,(async e=>{const t=Ve().h.createChildStore(m,{table:Ee().yK,id:e,spaceId:d});return await t.load(),t}));l(i)}),[p,m,t,c,d]);const h=(0,r.useMemo)((()=>a.map((e=>{const t=e.id;return{key:t,render:s=>(0,r.createElement)(Oe().A,{...s,key:t,teamStore:e}),action:t=>{d&&(ye().createAndCommit({userAction:"SearchFilterMenu.teamMenuItem",environment:c,canUndo:!0,perform:t=>{ce().Ju({environment:c,annotation:(0,g().tPj)({teamId:e.id,spaceId:d,mentionType:"teamspace"}),transaction:t})}}),(0,z().u)({environment:c,event:{eventName:"search_insert_typeable_filter",eventProperties:{type:"team",search_session_id:n}}}))}}}))),[a,c,d,n]),f=(0,r.useMemo)((()=>{if(!p)return;const e=a.length>0?(0,K.jsx)(y().sA,{...Ue.searchFilterTeamSection}):(0,K.jsx)(y().sA,{...Ue.noTeamspaceResults});return{key:"search filter team results",render:t=>(0,K.jsx)(D().A,{...t,title:e,topBorder:!s}),items:h}}),[p,h,s,a.length]);if(f)return{menuListSection:f,element:void 0}}({query:t,isFirstSection:m,disabled:!m,searchSessionId:a}),f="sort"===n,v=Ce({query:t,disabled:!f,isFirstSection:f,searchSessionId:a}),b="date"===n,M=Me({query:t,isFirstSection:b,disabled:!b,searchSessionId:a,menuListStore:s}),_=(0,r.useMemo)((()=>({user:c,page:p,team:h,sort:v,date:M})),[c,p,h,v,M]);return(0,r.useMemo)((()=>{if(i.open&&n)return _[n]}),[i.open,_,n])}const He={width:250,maxHeight:200};function We(){const e=(0,u().O$)(fe().D),t=e.open,s=(0,u().uB)(void 0,he().A),i=(0,u().K8)((()=>{if(t)return pe().aX(e.inputTextStore,e.oldTextValue,te().D)}),[e,t]),n=ze({query:(0,u().K8)((()=>t?pe().mX(e.inputTextStore,i)??"":""),[i,e,t]),menuListStore:s}),o=(0,r.useMemo)((()=>{const e=null==n?void 0:n.menuListSection;return e?[e]:[]}),[n]),a=null==n?void 0:n.onDismiss,l=(0,r.useCallback)((()=>{null==a||a(),ce().VN()}),[a]),c=null==n?void 0:n.element;return function(e){const{inputSelections:t}=e,s=(0,u().O$)(fe().D),i=(0,u().K8)((()=>{var e;if(!s.open||!t)return!1;const r=null===(e=s.inputTextStore)||void 0===e?void 0:e.getValue();if(!r)return!1;const i=(0,g().qAZ)(r);return i.includes(te().D)&&i.length>1}),[s,t]),{getSavedSelection:n}=(0,me().A)({shouldPreserveTextSelection:!1,shouldPreserveBlockSelection:!1,shouldRestoreSelection:!1}),o=(0,u().K8)((()=>{var e;if(!s.open)return!1;const t=n().textSelectionState,r=s.inputTextStore;return Boolean(t&&"editing"===t.mode&&(null===(e=(0,de().H)(t.multiSelection))||void 0===e?void 0:e.store)===r)}),[s,n]),a=(0,u().K8)((()=>{if(!s.open)return!1;const e=P().default.state,t=s.inputTextStore,r="editing"===e.mode?(0,de().H)(e.multiSelection):void 0;return(null==r?void 0:r.store)===t}),[s]),l=(0,u().K8)((()=>{if(!s.open||!a||!t)return!1;const e=P().default.state,r="editing"===e.mode?(0,de().H)(e.multiSelection):void 0,i=null==r?void 0:r.selection;return!!i&&(i.startIndex<t.filter.startIndex||i.endIndex>t.filter.endIndex)}),[s,a,t]),c=a||o,d=!s.open||!c||l||!i;(0,r.useEffect)((()=>{d&&ce().VN()}),[d])}({inputSelections:i}),(0,K.jsx)(L().Ay,{popupType:ue().n.Popup,open:t,originRect:t?e.selectionRect:void 0,placementToOrigin:"bottom",alignmentToOrigin:"start",originGap:12,disableMouseCapture:!1,disableContentScroll:!0,onDismiss:l,keepFocus:!0,trapFocus:!1,render:()=>(0,K.jsxs)(ve().H,{type:le().A.Y,style:c?void 0:He,children:[(0,K.jsx)(U().Ay,{type:U().Oh.Vertical,initialFocus:0,resetInitialFocusOnSectionChange:!0,resetInitialFocusOnSectionChangeAlways:!0,sections:o,disableKeyboardArrowWrap:!0,onEmptyEnter:()=>ce().VN(),performHandleEnterOnTab:!0,store:s}),c]})})}function Ye(e){const{inputComboboxProps:t,queryText:s,scrollerRef:i,onEsc:a}=e,l=(0,y().tz)(),d=(0,o().Y0)(),p=n().A.isMobile,m=d.isDesktop,h=(0,u().K8)((()=>R().A.state.isNewElectronTab),[],{debugName:"SearchInput.isNewElectronTab"});(0,ie().Q7)({textStore:s.store,initialFocus:!0});const f=(0,c().IS)((e=>({searchIcon:{color:e.icon.secondary,width:20,height:20,marginInlineStart:4,marginInlineEnd:4},textContainer:{display:"flex",alignItems:"center",margin:10,gap:1},textPlaceholder:{cursor:"text"},textInput:{overflowX:"auto",overflowY:"hidden",whiteSpace:"pre"}})),[]);return(0,r.useMemo)((()=>{const r={placeholder:l.formatMessage(h?Ze.openInNewTabPlaceholder:Ze.defaultInputPlaceHolder)};return(0,K.jsx)(oe().A,{capture:!0,debugName:"SearchInput",children:(0,K.jsxs)("div",{style:f.textContainer,children:[(0,K.jsx)(H().I,{icon:Z().J,colorVariant:"tertiary",style:f.searchIcon}),(0,K.jsx)(ae().A,{...t,placeholder:r.placeholder,onClick:void 0,disabled:!1,store:s.store,inPageFind:re().Os.none,pasteBehavior:"inline",placeholderStyle:f.textPlaceholder,disableUpDownArrows:!0,disableSlashCommands:!0,disableMobileActionBar:!0,disableMentions:p,disableEmbedMenu:!0,disableInsertedDeletedAnnotations:!0,disableEmojiCommands:!0,disabledMentionTypes:ne().md,allowSearchTypeableFilters:m,disableComment:!0,style:f.textInput,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableEnter:!0,disableStyleAnnotations:!0,disableSuggestEdit:!0,disableRichTextActions:!0,onChange:()=>{var e;null===(e=i.current)||void 0===e||null===(e=e.getNode())||void 0===e||e.scrollTo({top:0,behavior:"auto"})},onEsc:a}),p?null:(0,K.jsx)(Qe,{inputStore:s.store,setInput:s.setValue,filters:e.filters}),(0,K.jsx)(We,{})]})})}),[l,h,f.searchIcon,f.textContainer,f.textPlaceholder,f.textInput,t,s.store,s.setValue,m,a,p,e.filters,i])}function Qe(e){const{inputStore:t,setInput:s,filters:i}=e,n=(0,o().v3)(),a=(0,y().tz)(),[l,c]=(0,r.useState)(!1),d=(0,u().K8)((()=>R().A.state.sessionId),[]),p=(0,r.useCallback)((()=>{const e=n.currentUser.id;if(!e)return;const r=t.getValue()||[],i=(0,g().wmz)((0,g().J_S)(e)),o=r.length>0?[...r,i]:[i];s(o),(0,se().z)({store:t}),c(!1)}),[n.currentUser.id,t,s]),m=(0,r.useCallback)((()=>{const e=t.getValue()||[],r=(0,g().wmz)((0,g().C_C)()),i=e.length>0?[...e,r]:[r];s(i),c(!1)}),[t,s]),h=Boolean(i),f=(0,r.useCallback)((e=>{te().zU({filterType:e,inputStore:t,setInput:s,intl:a}),c(!1),(0,z().u)({environment:n,event:{eventName:"search_add_filter_via_popup",eventProperties:{type:te().dY[e],search_session_id:d}}})}),[n,t,d,s,a]),v=(0,r.useMemo)((()=>({items:[{key:"my-docs-option",render:e=>(0,K.jsx)(W().p,{...e,iconLeading:J().personCircleIcon,children:(0,K.jsx)("div",{children:a.formatMessage(Ze.myDocsFilter)})}),action:()=>p()}],render:e=>(0,K.jsx)(D().A,{...e,title:a.formatMessage(Ze.suggestedSectionTitle)}),key:"suggested-filter-section"})),[p,a]),S=(0,r.useMemo)((()=>({key:"filter-button-sort-section",items:[{key:"search-filters-sort-filter-option",render:e=>(0,K.jsx)(W().p,{...e,iconLeading:Y().arrowUpDownIcon,children:a.formatMessage(Ze.sortSectionTitle)}),action:()=>f("sort")}],render:e=>(0,K.jsx)(D().A,{...e,title:a.formatMessage(Ze.sortSectionTitle)})})),[f,a]),b=(0,r.useMemo)((()=>({items:[{key:"search-filters-author-filter-option",render:e=>(0,K.jsx)(W().p,{...e,iconLeading:J().personCircleIcon,children:a.formatMessage(Ze.authorFilter)}),action:()=>f("by")},{key:"search-filters-in-filter-option",render:e=>(0,K.jsx)(W().p,{...e,iconLeading:$().Y,children:a.formatMessage(Ze.inFilter)}),action:()=>f("in")},{key:"search-filters-date-filter-option",render:e=>(0,K.jsx)(W().p,{...e,iconLeading:ee().D,children:a.formatMessage(Ze.dateFilter)}),action:()=>f("date")},{key:"title-only-option",render:e=>(0,K.jsx)(W().p,{...e,iconLeading:X().a,children:`${a.formatMessage(Ze.titleOnlyFilter)}`}),action:()=>m()},{key:"search-filters-team-filter-option",render:e=>(0,K.jsx)(W().p,{...e,iconLeading:G().V,children:a.formatMessage(Ze.teamFilter)}),action:()=>f("team")}],render:e=>(0,K.jsx)(D().A,{...e,title:a.formatMessage(Ze.addFilterSectionTitle)}),key:"filter-section"})),[m,f,a]),M=(0,r.useMemo)((()=>(0,K.jsx)(U().Ay,{type:U().Oh.Vertical,disableKeyboardArrowWrap:!0,initialFocus:0,sections:[S,b,v],style:{width:200}})),[v,b,S]);return(0,K.jsx)(L().Ay,{trapFocus:!0,open:l,popupType:L().nl.Popup,origin:(0,K.jsx)(W().p,{iconLeading:{icon:Q().filterSmallIcon,size:"sm"},colorPalette:h?"blue":"gray",onClick:()=>c(!0),children:a.formatMessage(Ze.filterButtonCaption)}),onDismiss:()=>c(!1),render:()=>M})}const Ze=(0,y().YK)({filterButtonCaption:{defaultMessage:"Filters",id:"SearchInput.filterButtonCaption"},openInNewTabPlaceholder:{defaultMessage:"Open in new tab...",id:"SearchInput.openInNewTab"},defaultInputPlaceHolder:{defaultMessage:"Search or ask anything",id:"SearchInput.defaultInputPlaceHolder"},myDocsFilter:{defaultMessage:"My docs",id:"SearchInput.myDocsFilter"},authorFilter:{defaultMessage:"Author",id:"SearchInput.authorFilter"},inFilter:{defaultMessage:"In",id:"SearchInput.inFilter"},teamFilter:{defaultMessage:"Teamspace",id:"SearchInput.teamFilter"},addFilterSectionTitle:{defaultMessage:"Add a filter",id:"SearchInput.addFilterSectionTitle"},dateFilter:{defaultMessage:"Date",id:"SearchInput.dateFilter"},suggestedSectionTitle:{defaultMessage:"Suggested",id:"SearchInput.suggestedSectionTitle"},titleOnlyFilter:{defaultMessage:"Title only",id:"SearchInput.titleOnlyFilter"},sortSectionTitle:{defaultMessage:"Sort",id:"SearchInput.sortSectionTitle"}});var $e=()=>s(604038);const Je=(0,S().sg)(F().nT,75);function Ge(){const e=(0,o().v3)(),t=(0,y().tz)(),[s,S]=(0,r.useState)("recents"),[j,O]=(0,w().$)(),U=(0,u().O$)(R().A),D=(0,u().O$)(T().AppStoreSidebarSpaceStore),z=(0,_().AI)({initialValue:[]}),H=(0,r.useRef)(null),W=(0,r.useRef)(),Y=(0,u().K8)((()=>(0,I().q)(e)),[e],{debugName:"MiniSearch.isInQuickSearchMode"}),Q=(0,r.useCallback)((()=>{z.setValue([]),R().A.update((e=>({...e,openedTimeMs:void 0,sessionId:void 0})))}),[z]);(0,r.useEffect)((()=>{U.isOpen&&clearTimeout(W.current)}),[U.isOpen]),(0,l().X)((()=>{W.current&&(clearTimeout(W.current),W.current=void 0)}));const Z=(0,u().K8)((()=>U.debug),[U.debug]),$=Z.enabled,J=Z.enabled&&Z.showSecondaryPane&&"results"===s,G=(0,r.useCallback)(((e,t)=>{R().A.update((s=>({...s,debug:s.debug.enabled?{...s.debug,..."main"===e?{mainPaneOverrides:t}:{secondaryPaneOverrides:t}}:s.debug})))}),[]),X=(0,r.useCallback)((t=>{var s;const r=null===(s=R().A.state.previousTextSelection)||void 0===s?void 0:s.multiSelection;(0,F().yM)({openedTimeMs:U.openedTimeMs??0,searchSessionId:U.sessionId??"",environment:e}),t.shouldResetQuery&&z.setValue([]),R().A.update((e=>({...e,isOpen:!1,isNewElectronTab:!1,openedTimeMs:t.shouldResetMetricsState?void 0:e.openedTimeMs,sessionId:t.shouldResetMetricsState?void 0:e.sessionId,previousTextSelection:void 0}))),Y&&(0,M().y)(),W.current&&clearTimeout(W.current),W.current=window.setTimeout(Q,B().INACTIVE_TIMEOUT_MS),r&&"editing"!==P().default.state.mode&&P().default.setState({forceExtendAnnotations:{},mode:"editing",multiSelection:r})}),[U.openedTimeMs,U.sessionId,e,z,Q,Y]);(0,a().w)((()=>{R().A.update((e=>({...e,query:z}))),k().T.customAgentSearchService.load().then((({initializeWorkflowDataCache:t})=>t(e)))}));const ee=e.currentUser.id,{query:te,queryTextValue:se,queryTextValueWithoutSearchFilters:re}=(0,u().K8)((()=>{if(!D)return{queryTextValue:[],queryTextValueWithoutSearchFilters:[],query:""};const s=z.store.getValue()??[],r=s.filter((e=>!(0,g().uPN)(e).some(g().RXL)));return{queryTextValue:s,query:(0,f().r4)({intl:t,textValue:r,userTimeZone:(0,p().P)(),deterministic:!1,disableAnnotationPrefix:!0,disableInsertedAnnotations:!1,getRecordModel:m().b.fromGetRecordValueFn(e.defaultRecordCache.inMemoryRecordCache.makeGetRecordValueFn(ee))}),queryTextValueWithoutSearchFilters:r}}),[D,z.store,t,e.defaultRecordCache.inMemoryRecordCache,ee]),{filters:ie,sort:ne}=(0,r.useMemo)((()=>{const e=(0,g().lfB)({textValue:se,annotationGroupingKey:g().Ifu.TemporarySearchFilter});return{filters:(0,x().c5)(e),sort:(0,x().db)(e)}}),[se]),oe=(0,u().K8)((()=>"on"===i().default.getEligibleGroup({experimentId:"search_quickfind_prefetch"})),[]),{mainPaneOverrides:ae,secondaryPaneOverrides:le}=(0,r.useMemo)((()=>Z.enabled?{mainPaneOverrides:Z.mainPaneOverrides,secondaryPaneOverrides:Z.secondaryPaneOverrides}:{mainPaneOverrides:{},secondaryPaneOverrides:{}}),[Z]),ue=(0,A().r)(),ce=te.trim().length>0||void 0!==ie,{results:de,searchSessionId:pe,searchSessionFlowNumber:me,isResultsLoading:he,searchAnalytics:fe,fetchAdditionalServerResultsOnChange:ve,debugInfo:ge}=(0,C().W)({type:v().Vz.BlocksInSpace,query:te,limit:q().ZK,source:"mini_quick_find",filters:ie,sort:ne,options:{disable:!ce,isTitleOnly:void 0,usePrefetch_EXPERIMENTAL:oe,overrideSearchSessionId:U.sessionId,searchExperimentOverrides:Object.keys(ae).length>0?ae:void 0,debug:$?"explain":void 0},peopleBlocksToInclude:"all"}),{results:ye,searchSessionId:Se,searchSessionFlowNumber:be,isResultsLoading:Me,searchAnalytics:_e,fetchAdditionalServerResultsOnChange:Ie,debugInfo:xe}=(0,C().W)({type:v().Vz.BlocksInSpace,query:te,limit:q().ZK,source:"mini_quick_find",filters:ie,sort:ne,options:{disable:!J,isTitleOnly:!1,usePrefetch_EXPERIMENTAL:oe,overrideSearchSessionId:U.sessionId,searchExperimentOverrides:Object.keys(le).length>0?le:void 0,debug:J?"explain":void 0},peopleBlocksToInclude:"all"}),Ce=(0,r.useRef)(Date.now());(0,r.useEffect)((()=>{ce&&D&&(Je({searchSessionId:pe,results:de.map((e=>({id:e.store.id,source:e.localSource?"local":"server"}))),searchSessionFlowNumber:me,queryLength:te.length,queryWords:te.split(" ").length,timeToResult:Date.now()-Ce.current,environment:e,query:se,spaceStore:D}),Ce.current=Date.now())}),[de,pe]),(0,r.useEffect)((()=>{U.isOpen&&ue&&(b().callApi({eventName:"warmSearchCache",environment:e,data:{spaceId:ue}}),b().callApi({eventName:"warmVectorDBCache",environment:e,data:{spaceId:ue},headers:(0,h().WS)({spaceId:ue})}))}),[U.isOpen,e,ue]);const we=n().A.isMobile,Ae=function(e){const t=(0,o().v3)(),s=n().A.isMobile?void 0:e.shouldShowSecondaryPane?1e3:750,r=(0,u().K8)((()=>(0,V().CX)({searchContentPaneType:"recents"===e.currentView?"default_body":"search_results",quickSearchMode:!1,environment:t}).maxHeight),[e.currentView,t]);return(0,c().IS)((()=>({input:{margin:"10px 10px",width:"auto",fontSize:14},container:{display:"grid",flexDirection:"column",gridTemplateColumns:"100%",gridTemplateRows:"auto minmax(0, 1fr) auto",width:s,height:r}})),[s,r])}({currentView:s,shouldShowSecondaryPane:J}),ke=(0,r.useMemo)((()=>({query:{text:te,filters:(0,v().N2)(ie),sort:ne},limit:q().ZK})),[te,ie,ne]),Te=(0,r.useMemo)((()=>(0,K.jsxs)("div",{style:Ae.container,"data-mini-search-container":!0,className:"mini-search-snapshot-container",children:[(0,K.jsx)(Ye,{inputComboboxProps:j,queryText:z,filters:ie,scrollerRef:H,onEsc:()=>X({shouldResetQuery:!1,shouldResetMetricsState:!0})}),(0,K.jsxs)(d().fI,{gap:12,height:"100%",children:[(0,K.jsx)($e().LT,{ref:H,currentView:s,isResultsLoading:he,fetchAdditionalServerResultsOnChange:ve,onDismiss:X,searchAnalytics:fe,results:de,query:te,searchSessionId:pe,searchSessionFlowNumber:me,menuListComboboxProps:O,queryTextValueWithoutSearchFilters:re,filters:ie,setCurrentView:S,debugConfig:{experimentOverrides:ae,onExperimentOverridesChange:e=>G("main",e),debugInfo:ge}}),J?(0,K.jsx)($e().LT,{ref:H,currentView:s,isResultsLoading:Me,fetchAdditionalServerResultsOnChange:Ie,onDismiss:X,searchAnalytics:_e,results:ye,query:te,searchSessionId:Se,searchSessionFlowNumber:be,menuListComboboxProps:void 0,queryTextValueWithoutSearchFilters:re,filters:ie,setCurrentView:S,debugConfig:{experimentOverrides:le,onExperimentOverridesChange:e=>G("secondary",e),debugInfo:xe}}):void 0]}),we?void 0:(0,K.jsx)(N,{results:de,debugInfo:ge,reportBadSearchInputRequest:ke,isResultsView:"results"===s})]})),[Ae.container,j,z,ie,s,he,ve,X,fe,de,te,pe,me,O,re,we,ae,G,ge,J,Me,Ie,_e,ye,Se,be,le,xe,ke]);return we?(0,K.jsx)(L().Ay,{open:U.isOpen,popupType:L().nl.BottomSheet,placementToOrigin:"bottom",alignmentToOrigin:"start",render:()=>Te,onClosed:()=>X({shouldResetQuery:!1,shouldResetMetricsState:!0}),onDismiss:()=>X({shouldResetQuery:!1,shouldResetMetricsState:!0}),trapFocus:!0,ariaLabel:t.formatMessage(Xe.ariaLabel)},"mini-search--mobile-web-popup"):(0,K.jsx)(E().a,{className:"mini-search-snapshot-container",open:U.isOpen,onDismiss:()=>X({shouldResetQuery:!1,shouldResetMetricsState:!0}),render:()=>Te,transitionAppearance:"none",isWaxPaper:!0,backgroundStyle:{background:"transparent"},ariaLabel:t.formatMessage(Xe.ariaLabel),innerStyle:{width:"max-content",height:"max-content",top:90},style:{alignItems:"start"}})}const Xe=(0,y().YK)({ariaLabel:{defaultMessage:"Search Notion",id:"MiniSearch.ariaLabel"}}),et=function(){return(0,u().K8)((()=>s(430483).zD.isMiniSearchModalEnabled()),[])?(0,K.jsx)(Ge,{}):null}},811979:(e,t,s)=>{s.d(t,{A:()=>l});var r=s(296540),i=()=>s(205262),n=()=>s(56366),o=s(474848);function a(e,t){const{onClose:a,persistOnClose:l,render:d,stopClickPropagation:p,onClick:m,disablePopup:h,disabled:f,forceInitialInbound:v,renderOrigin:g,originGap:y,borderRadius:S,popupWrapStyle:b}=e,M=(0,n().uB)(e.buttonPopupStore,s(463830).A);(0,r.useEffect)((()=>()=>{M.setState({open:!1})}),[M]);const _=(0,r.useCallback)((()=>u(a,l,M)),[a,l,M]),I=(0,r.useCallback)((()=>(0,o.jsx)(c,{onClose:a,persistOnClose:l,render:d,buttonPopupStore:M})),[a,l,d,M]),x=(0,r.useCallback)((e=>function(e,t,s,r,n){t&&(null==e||e.stopPropagation());if(e&&(0,i().V)(e))return;s&&s(e);r||n.setState({...n.state,open:!0})}(e,p,m,h,M)),[p,m,h,M]),C=(0,n().K8)((()=>g({...e,onClick:f?s(496603).D_:x})),[f,x,e,g]),w=(0,n().K8)((()=>M.state.open),[M]);return(0,o.jsx)(s(417392).Ay,{ref:t,...e,forceInitialInbound:Boolean(v),render:I,open:w,onDismiss:_,origin:C,originGap:y,borderRadius:S,popupWrapStyle:b,trapFocus:!0})}const l=r.forwardRef(a);function u(e,t,s){e&&e(),t||s.reset()}function c({onClose:e,persistOnClose:t,render:s,buttonPopupStore:i}){const a=(0,r.useCallback)((()=>u(e,t,i)),[e,t,i]),l=(0,n().K8)((()=>s({close:a})),[s,a]);return(0,o.jsx)(o.Fragment,{children:l})}},859384:(e,t,s)=>{s.d(t,{M:()=>n});s(296540);var r=s(474848);const i={viewBox:"0 0 20 20",fittedViewBox:"3.12 2.99 13.88 13.88",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"m16.774 4.341-.59.589-1.109-1.11.596-.594a.784.784 0 0 1 1.103 0c.302.302.302.8 0 1.102zM8.65 12.462l6.816-6.813-1.11-1.11-6.822 6.808a1.1 1.1 0 0 0-.236.393l-.289.932c-.052.196.131.38.315.314l.932-.288a.9.9 0 0 0 .394-.236"}),(0,r.jsx)("path",{d:"M4.375 6.25c0-1.036.84-1.875 1.875-1.875H11a.625.625 0 1 0 0-1.25H6.25A3.125 3.125 0 0 0 3.125 6.25v7.5c0 1.726 1.4 3.125 3.125 3.125h7.5c1.726 0 3.125-1.4 3.125-3.125V9a.625.625 0 1 0-1.25 0v4.75c0 1.036-.84 1.875-1.875 1.875h-7.5a1.875 1.875 0 0 1-1.875-1.875z"})]})},n=(0,s(340498).wt)("compose",i)},866515:(e,t,s)=>{s.d(t,{n:()=>i});var r=s(296540);function i(e,t,s){const i=(0,r.useRef)(e),n=(0,r.useRef)(null);(0,r.useEffect)((()=>{i.current=e}),[e]),(0,r.useEffect)((()=>{const e=async()=>{n.current&&(clearTimeout(n.current),n.current=null),s&&(await i.current(),n.current=setTimeout(e,t))};return s&&e(),()=>{n.current&&(clearTimeout(n.current),n.current=null)}}),[s,t])}},877788:(e,t,s)=>{s.d(t,{w:()=>i});s(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"2.4 2.39 15.2 14.52",svg:(0,s(474848).jsx)("path",{d:"M10 2.399c.27 0 .51.174.594.432l1.507 4.636h4.874a.625.625 0 0 1 .367 1.13L13.4 11.462l1.506 4.636a.625.625 0 0 1-.962.699L10 13.932l-3.943 2.865a.625.625 0 0 1-.962-.699L6.6 11.462 2.658 8.597a.625.625 0 0 1 .367-1.13h4.874L9.406 2.83A.625.625 0 0 1 10 2.399m0 2.648L8.948 8.285a.625.625 0 0 1-.595.432H4.95l2.754 2.001c.22.16.31.441.227.699l-1.052 3.238 2.755-2.001a.625.625 0 0 1 .734 0l2.755 2.001-1.052-3.238a.625.625 0 0 1 .227-.699l2.754-2.001h-3.405a.625.625 0 0 1-.594-.432z"})},i=(0,s(340498).wt)("star",r)},949305:(e,t,s)=>{s.d(t,{x:()=>y});var r=s(296540),i=()=>s(484714),n=()=>s(56366),o=()=>s(401497),a=()=>s(427704),l=()=>s(676370),u=()=>s(69708),c=()=>s(534177),d=()=>s(843014),p=()=>s(274894),m=()=>s(719147),h=()=>s(991249),f=()=>s(803025),v=()=>s(270812),g=s(474848);function y(e){const{featureAvailability:t,upgradeRequestAnalyticsEntrypoint:s,upgradeRequestEntrypoint:y,upsellFrom:S,sunsetCheckSource:b,showOptimisticUpsell:M}=e,_=(0,i().v3)(),I=(0,u().tz)(),x=(0,f().q)(),C=(0,o().IS)((e=>({assistantBlueLink:{color:e.blue.text.accentPrimary,cursor:"pointer",fontWeight:600,textDecoration:"none"}})),[]),w=(0,n().K8)((()=>!!t&&("available"===t.type&&void 0!==t.expiry&&"sunset"===t.expiry.type)),[t]),A=(0,n().K8)((()=>(0,c().Xk)(l().uv,S)),[S]),k="ai_formulas"===S,{userHasPendingRequest:T,canUserRequestUpgrade:R,openModal:q}=(0,v().E)({type:"feature",featureAvailability:t,entrypoint:y,analyticsEntrypoint:s,isOptimisticUpsell:Boolean(M)}),P="sales_assisted"===x;return(0,r.useMemo)((()=>{if(!t)return{upsellHeader:void 0,upsellMessage:I.formatMessage(d().D.noAccessFeatureMessage),actionButtonMsg:void 0,actionForFeatureAvailability:void 0,isSunset:w};if("available"===t.type&&!M){const e=t.expiry;if(void 0!==b&&w&&void 0!==t&&void 0!==e){const t=()=>{(0,h().K)(_,{from:S,upsell:e.upsell})};return{upsellHeader:I.formatMessage(d().D.upgradeToBusiness),upsellMessage:I.formatMessage(d().D.aiConnectorsSunsetUpsellBanner,{date:e.endDate.toFormat("MMMM d"),bold:e=>(0,g.jsx)(m().A,{external:!0,href:a().JZ.pricing,hoverColor:"blue",style:C.assistantBlueLink,children:e}),breakLine:"assistant_overflow_menu_add_connectors"===b,br:(0,g.jsx)("br",{})}),actionButtonMsg:I.formatMessage(d().D.upgradeButton),actionForFeatureAvailability:t,isSunset:w}}return{upsellHeader:void 0,upsellMessage:void 0,actionButtonMsg:void 0,actionForFeatureAvailability:void 0,isSunset:w}}const e=t.upsell;if(!e||"none"===e.type)return{upsellHeader:void 0,upsellMessage:void 0,actionButtonMsg:void 0,actionForFeatureAvailability:void 0,isSunset:w};const s=function(e){const{isMemberWithPendingUpgradeRequest:t,isMemberCanRequestUpgrade:s,salesAssistedUpgradeRequired:r}=e,i=s?"memberCanRequest":t?"memberRequested":"adminUpsell",n=r?"salesAssisted":"selfService",o=`${i}.${n}`;return d().D[o]}({isMemberWithPendingUpgradeRequest:T,isMemberCanRequestUpgrade:R,salesAssistedUpgradeRequired:P});if(T)return{upsellHeader:void 0,upsellMessage:I.formatMessage(s,{isResearchMode:A,isFormulas:k}),actionButtonMsg:void 0,actionForFeatureAvailability:void 0,isSunset:w};if(R)return{upsellHeader:void 0,upsellMessage:I.formatMessage(s,{isResearchMode:A,isFormulas:k,bold:e=>(0,g.jsx)(p().f,{onClick:q,children:e})}),actionButtonMsg:"ai_meeting_notes"===S?I.formatMessage(d().D.requestAccessButtonShort):I.formatMessage(d().D.requestAccessButton),actionForFeatureAvailability:q,isSunset:w};{const t=()=>{(0,h().K)(_,{from:S,upsell:e})},r=P?I.formatMessage(d().D.contactSalesButton):"ai_meeting_notes"===S?I.formatMessage(d().D.upgradeButton):I.formatMessage(d().D.getNotionAI);return{upsellHeader:void 0,upsellMessage:I.formatMessage(s,{isResearchMode:A,isFormulas:k,bold:e=>(0,g.jsx)(p().f,{onClick:t,children:e})}),actionButtonMsg:r,actionForFeatureAvailability:t,isSunset:w}}}),[_,I,P,S,t,T,R,q,w,b,M,A,k,C])}}}]);