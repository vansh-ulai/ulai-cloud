"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[59388,75902,90871],{53592:(e,t,o)=>{o.r(t),o.d(t,{attemptServerBackedLocalDuplicate:()=>T,serverBackedLocalDuplicate:()=>x});o(944114),o(581454);var r=()=>o(165358),a=()=>o(386164),i=()=>o(388821),n=()=>o(912720),s=()=>o(199378),c=()=>o(229833),l=()=>o(763824),u=()=>o(973647),d=()=>o(466614),p=()=>o(559506),m=()=>o(666144),g=()=>o(231297),f=()=>o(974233),h=()=>o(611191),_=()=>o(866654),v=()=>o(261450),I=()=>o(503388),b=()=>o(966152),y=()=>o(59110),k=()=>o(949653),S=()=>o(677733);function x(e){const{environment:t,sourceBlock:o,targetInMemoryRecordCache:r,transaction:a,options:n,targetSpaceId:s,installationImprint:c,templateInstallationMetadata:d={},shouldUseSynchronousDuplicationAPI:p,stopwatch:m,from:g}=e,f=performance.now();null==m||m.mark("server_duplicate_start");const h=e.copyIndicators??(0,I().U8)({environment:t,sourceBlocks:[o],targetRecordCache:r,transaction:a,spaceId:s});null==m||m.mark("create_copy_indicators");const _=l().yX();return a.postSubmitCallbacks.push((async e=>{if(null==m||m.mark("transaction_post_submit_callback"),e)return(0,b().P0)({environment:t,type:"server_duplicate_transaction_post_submit_callback_error",data:{copyIndicatorIds:h.map((e=>e.id)),error:e,targetSpaceId:s,options:n}}),void _.resolve(u().Q.fail(e));(0,I().Yj)(h),null==m||m.mark("initialize_copy_indicators_progress_state");const r=await T({environment:t,sourceBlockPointer:o,targetBlockStore:h[0],options:n,templateInstallationMetadata:d,stopwatch:m,from:g});if(u().Q.isSuccess(r))return(0,v().E)({environment:t,success:!0,time:performance.now()-f,user_action:a.getUserActionForAnalyticsPurposesOnly(),is_duplication_local:!0,duplication_size:r.value.size,method:"server_backed_local_duplication",from:g}),null==m||m.mark("server_backed_local_duplicate_success"),(0,I().dH)(h),void _.resolve(u().Q.success({}));const l=a.getUserActionForAnalyticsPurposesOnly(),y=await(0,S().performServerDuplicate)({environment:t,copyIndicators:h,sourceBlocks:[o],targetSpaceId:s,options:n,templateInstallationMetadata:d,installationImprint:c,shouldUseSynchronousDuplicationAPI:p,stopwatch:m,userAction:l});if((0,I().dH)(h),u().Q.isFail(y))return(0,I().uC)({environment:t,copyIndicators:h}),(0,b().lI)({environment:t,type:"server_duplicate_iterator_error",error:y.error,data:{}}),void _.resolve(y);(0,v().E)({environment:t,success:!0,time:performance.now()-f,user_action:a.getUserActionForAnalyticsPurposesOnly(),is_duplication_local:!0,duplication_size:y.value.size,method:"sbld_fallback_server_duplication",from:g}),null==m||m.mark("server_duplicate_success"),_.resolve(u().Q.success({recordIdMap:y.value.recordIdMapJson?i().RecordMapPolymorphic.create(y.value.recordIdMapJson):void 0}))})),u().Q.success({blockStores:h,onComplete:_.promise})}async function T(e){const{environment:t,sourceBlockPointer:o,targetBlockStore:l,options:v,templateInstallationMetadata:I,recordLimit:S=500,targetInMemoryRecordCache:x,stopwatch:T,from:C}=e;null==T||T.mark("attempt_server_backed_local_duplicate_start"),(0,b().JW)({environment:t,type:"server_duplicate_attempt_server_backed_local_duplicate",data:{sourceBlockPointer:o,targetBlockStore:l,targetSpaceId:l.getSpaceId(),options:v}});const M=(0,h().$J)(),B=await async function(e){const{environment:t,sourceBlockPointer:o,targetBlockStore:n,targetInMemoryRecordCache:s,options:l,enableLegacyTransclusionFixing:u,recordLimit:d}=e,g=s??n.inMemoryRecordCache,h={environment:t,blockId:o.id,inMemoryRecordCache:g,options:{allowCopyCollections:!0,requireFullSubtree:!0,skipTransclusionContainerChildren:!l.deepCopyTransclusionContainers,allowCopyExternalObjectInstances:!l.convertExternalObjectInstancesToPlaceholders,includeLegacyTransclusionBlockValues:u}};let v;if(v=(0,y().loadLocalSubtree)(h),!v.recordMap&&g===t.defaultRecordCache.inMemoryRecordCache)try{(0,b().JW)({environment:t,type:"performInexactPagePreload",data:{message:"No local subtree found, performing performInexactPagePreload",loadLocalSubtreeArgs:h}}),await(0,_().A$)(t,{table:"block",id:o.id,spaceId:o.spaceId}),v=(0,y().loadLocalSubtree)(h)}catch(I){r().log({level:"warning",from:"attemptServerBackedLocalDuplicate",type:"persistedRecordCachePreloadError",error:(0,c().convertErrorToLog)(I),data:{message:"Failed to preload subtree from persisted record cache"}})}v.recordMap||((0,b().JW)({environment:t,type:"loadLocalSubtreeApi",data:{message:"No local subtree found from previous attempts, attemping API call to loadBlockSubtree",currentLocalSubtreeResponse:v}}),v=await async function(e){const{environment:t,sourceBlockPointer:o,recordLimit:n,targetBlockStore:s,loadLocalSubtreeArgs:l}=e;try{const e=await p().callApi({eventName:"loadBlockSubtree",environment:t,data:{block:{id:o.id,spaceId:o.spaceId},shallow:!1,recordCountLimit:n},headers:(0,a().WS)({spaceId:o.spaceId})});if((0,b().JW)({environment:t,type:"loadBlockSubtreeApiResult",data:{message:"Result from loadBlockSubtree API call",subtreeResult:e,apiArgs:{block:{id:o.id,spaceId:o.spaceId},shallow:!1,recordCountLimit:n}}}),"success"===e.type){const o=i().RecordMapWithRole.create(e.data.subtreeRecordMap);return await m()._O({environment:t,inMemoryRecordCache:l.inMemoryRecordCache,recordMap:o,debugSource:"load_local_subtree_from_server"}),(0,y().loadLocalSubtree)(l)}{const t=(0,f().V)(e);r().log({level:"warning",from:"attemptServerBackedLocalDuplicate",type:"loadBlockSubtreeFailure",data:{message:"Error fetching subtree",miscDataToConvertToString:{error:t,sourceBlockPointer:o,cacheSize:s.inMemoryRecordCache.size,targetBlockPointer:{id:s.id,spaceId:s.getSpaceId(),type:s.getType()}}}})}}catch(I){r().log({level:"error",from:"attemptServerBackedLocalDuplicate",type:"subtreeLoadError",error:(0,c().convertErrorToLog)(I),data:{message:"Error loading subtree",miscDataToConvertToString:{sourceBlockPointer:o,cacheSize:s.inMemoryRecordCache.size,targetBlockPointer:{id:s.id,spaceId:s.getSpaceId(),type:s.getType()}}}})}}({environment:t,sourceBlockPointer:o,recordLimit:d,targetBlockStore:n,loadLocalSubtreeArgs:h}));v&&!v.recordMap&&r().log({level:"warning",from:"attemptServerBackedLocalDuplicate",type:"subtreeLoadFailure",data:{message:"Failed to load subtree",miscDataToConvertToString:{sourceBlockPointer:o,cacheSize:n.inMemoryRecordCache.size,reason:"error"===v.type?v.reason:void 0,targetBlockPointer:{id:n.id,spaceId:n.getSpaceId(),type:n.getType()},missingRecord:"error"===v.type?v.pointer:void 0}}});return v}({environment:t,sourceBlockPointer:o,targetBlockStore:l,targetInMemoryRecordCache:x,options:v,enableLegacyTransclusionFixing:M,recordLimit:S});if(null==T||T.mark("try_load_local_subtree_finished"),!B||!B.recordMap)return u().Q.fail({});if(d().Lw({sourceSpaceId:o.spaceId,targetSpaceId:l.getSpaceId(),sourceBlockSubtree:B.recordMap}))return r().log({level:"warning",from:"attemptServerBackedLocalDuplicate",type:"accessLockingWarning",data:{message:"Unable to perform local duplication",miscDataToConvertToString:{sourceBlockPointer:o,targetBlockPointer:{id:l.id,spaceId:l.getSpaceId(),type:l.getType()}}}}),null==T||T.mark("attempt_server_backed_local_duplicate_failure"),u().Q.fail({});for(const a of B.recordMap.getTables())if(a===n().yB||a===s().SC)return r().log({level:"warning",from:"attemptServerBackedLocalDuplicate",type:"invalidRecordType",data:{message:"Local duplication does not support automation tables",miscDataToConvertToString:{sourceBlockPointer:o,targetBlockPointer:{id:l.id,spaceId:l.getSpaceId(),type:l.getType()}}}}),null==T||T.mark("attempt_server_backed_local_duplicate_failure"),u().Q.fail({});try{var w;(0,b().JW)({environment:t,type:"server_backed_duplicate_start_transaction",data:{message:"Starting transactionActions.createAndCommit for localDuplicate",sourceBlockPointer:o,targetBlockPointer:{id:l.id,spaceId:l.getSpaceId(),type:l.getType()}}});const{serverCommitResult:e}=g().createAndCommit({userAction:"server_backed_local_duplicate",environment:t,canUndo:!0,isTemplateInstantiationTransaction:Boolean(I),perform:e=>(0,k().localDuplicate)({environment:t,sourceBlockId:o.id,targetBlockPointer:l.pointer,sourceBlockSubtree:B.recordMap,targetInMemoryRecordCache:l.inMemoryRecordCache,transaction:e,templateInstallationMetadata:I,stopwatch:T,options:{...v,preventLegacyTransclusions:M},from:C})});return await e,null==T||T.mark("server_backed_local_duplicate_finished"),(0,b().JW)({environment:t,type:"server_duplicate_attempt_server_backed_local_duplicate_success",data:{targetSpaceId:l.getSpaceId(),options:v}}),u().Q.success({size:null===(w=B.recordMap)||void 0===w?void 0:w.getSize(),pageStore:l,transactionPromise:e})}catch(A){return r().log({level:"error",from:"attemptServerBackedLocalDuplicate",type:"subtreeLoadError",error:(0,c().convertErrorToLog)(A),data:{message:"Failed to load subtree",miscDataToConvertToString:{sourceBlockPointer:o,targetBlockPointer:{id:l.id,spaceId:l.getSpaceId(),type:l.getType()}}}}),u().Q.fail({})}}},418375:(e,t,o)=>{o.d(t,{A:()=>r});const r=o(757695).Store.createValue({executionTarget:null},{name:"DuplicationDebuggingStore"})},568131:(e,t,o)=>{o.r(t),o.d(t,{duplicateBlock:()=>C});o(16280),o(898992),o(823215),o(581454),o(737550);var r=()=>o(929219),a=()=>o(665344),i=()=>o(854150),n=()=>o(763824),s=()=>o(973647),c=()=>o(970330),l=()=>o(901389),u=()=>o(863168),d=()=>o(972435),p=()=>o(494043),m=()=>o(406792);class g{constructor(e){this.environment=void 0,this.metricName=void 0,this.startMetric=void 0,this.prevLapMetric=void 0,this.extraData=void 0,this.environment=e.environment,this.metricName=e.metricName,this.startMetric=m().default.mark(e.metricName),this.prevLapMetric=m().default.mark(e.metricName),this.extraData=e.extraData??{}}mark(e){m().default.measure(this.prevLapMetric,{environment:this.environment,data:{type:e,...this.extraData},sampleDecision:"default"}),this.prevLapMetric=m().default.mark(this.metricName)}end(){m().default.measure(this.startMetric,{environment:this.environment,data:{type:"total",...this.extraData},sampleDecision:"default"})}}var f=()=>o(765957),h=()=>o(261358),_=()=>o(95758),v=()=>o(418375),I=()=>o(261450),b=()=>o(977529),y=()=>o(112589),k=()=>o(985284),S=()=>o(949653),x=()=>o(53592),T=()=>o(677733);function C(e){if(e.skipUserFacingMessages)return M(e);const t=k().CU({sourceBlocks:e.stores});try{const o=M({...e,onRedundantDuplicationError:()=>{(0,b().Yv)()}});return{...o,onComplete:o.onComplete.then((e=>("success"===e.status?k().MK(t):k().UO(t),e))).catch((e=>{throw k().UO(t),e}))}}catch(o){throw k().UO(t),o}}function M(e){const{environment:t,stores:o,transaction:m,targetSpaceId:b,executionTarget:k,from:C,options:M,installationImprint:B,shouldAttemptServerBackedLocalDuplication:w,templateInstallationMetadata:A,shouldUseSynchronousDuplicationAPI:P,skipUserFacingMessages:R,onRedundantDuplicationError:D}=e,V="local"===(v().A.getState().executionTarget??k)?"local_duplication":w?"server_backed_local_duplication":P?"server_synchronous_duplication":"server_duplication",L=new g({environment:t,metricName:"duplicate_block_stopwatch",extraData:{duplication_type:V,from:C}});if(0===o.length)throw new Error("Must duplicate at least one block");const F=o[0].getSpaceId();if(!o.every((e=>e.getSpaceId()===F)))throw new Error("All stores must be in the same space");if(o.length>1&&!o.every((e=>e.isTypedCollectionViewBlock())))throw new Error("Multiple source blocks only supported for grouped typed DB duplication");!function(e){const{environment:t,stores:o}=e;for(const n of o){var r,a;const e=(0,h().zH)(n).getValue();if(!e)continue;const{sidebarSpaceStore:o}=f().default.getState();let s;o&&e.parent_table===i().yK&&(s=_().h.createChildStore(o,{table:i().yK,id:e.parent_id}));const l=n.getAssociatedCollectionId()??(null===(r=n.getCollectionStore())||void 0===r?void 0:r.id),u={from:"copy",type:e.type,teamStore:s,is_toggleable:(0,p().Yt)(e.type,e.format),collection_id:n.getAssociatedCollectionId()??(null===(a=n.getCollectionStore())||void 0===a?void 0:a.id),new_page_id:"page"===e.type?n.id:void 0,creating_block_id:n.id,parent_collection_id:n.getParentCollectionIdUpToTwoLevels(),form_id:n.getFirstFormIdInCollectionViewBlock()};c().tP(e.type)?c().vH(t,{...u,type:e.type,collection_id:l||""}):c().vH(t,{...u,type:e.type})}}({environment:t,stores:o}),L.mark("track_create_blocks"),M.convertExternalObjectInstancesToPlaceholders=F!==b;const E=A&&(0,a().Fe)(A.source)&&A.isListedTemplate;if(1===o.length&&"local_duplication"===V&&!E){const e=(0,S().tryLocalDuplicateWithTransaction)({environment:t,store:o[0],options:M,sourceSpaceId:F,targetSpaceId:b,transaction:m,installationImprint:B,templateInstallationMetadata:A,stopwatch:L,from:C});if(e)return L.mark("try_local_duplication_success"),L.end(),{blockStores:[e],onComplete:Promise.resolve({status:"success"})};L.mark("try_local_duplication_failure")}const U=t.defaultRecordCache.inMemoryRecordCache;if(o.some((e=>e.inMemoryRecordCache!==U)))throw new Error("Can only server duplicate from the environment.defaultRecordCache.inMemoryRecordCache.");let j;if(r().A.state.online||l().f1(d().A.formatMessage(I().V.offlineError)),j=1===o.length&&w?(0,x().serverBackedLocalDuplicate)({environment:t,sourceBlock:{id:o[0].id,spaceId:o[0].getSpaceId()},targetInMemoryRecordCache:U,transaction:m,targetSpaceId:b,installationImprint:B,templateInstallationMetadata:A,stopwatch:L,shouldUseSynchronousDuplicationAPI:P,options:M,from:C}):(0,T().serverDuplicate)({environment:t,sourceBlocks:o.map((e=>({id:e.id,spaceId:e.getSpaceId()}))),targetInMemoryRecordCache:U,transaction:m,targetSpaceId:b,installationImprint:B,templateInstallationMetadata:A,stopwatch:L,shouldUseSynchronousDuplicationAPI:P,options:M,from:C,onRedundantDuplicationError:D}),L.mark("duplicate_block_immediate_return"),s().Q.isFail(j))throw R||(0,y().x)({environment:t,duplicateError:j.error}),j.error;const{blockStores:Z,onComplete:z}=j.value,N=n().yX();return z.then((e=>{if(L.end(),s().Q.isSuccess(e)){for(const e of Z)if("ai_block"===e.getType()){u().EF.setState(e.pointer.id);break}N.resolve({status:"success",recordIdMap:e.value.recordIdMap})}else R||(0,y().x)({environment:t,duplicateError:e.error,blockStores:Z}),N.resolve({status:"error",error:e.error,errorMessage:(0,y().eM)(e.error)})})),{blockStores:Z,onComplete:N.promise}}},663199:(e,t,o)=>{o.d(t,{W:()=>i});var r=()=>o(341136),a=()=>o(72135);function i({intl:e,propertySchema:t,value:o}){const i=t&&((0,r().A)(t)||"formula"===t.type)?t.number_format??a().C4:a().C4;return a().ZV(o,i,e)}},856197:(e,t,o)=>{o.d(t,{z:()=>S});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(581454);var r=()=>o(764880),a=()=>o(584262),i=()=>o(713998),n=()=>o(869190),s=()=>o(604995),c=()=>o(663199),l=()=>o(683259),u=()=>o(128713),d=()=>o(792071),p=()=>o(142748),m=()=>o(96330),g=()=>o(179034),f=()=>o(201980),h=()=>o(931075);const _=n().ZF;function v(e){return(0,l().vy)({...e,fromString:e=>e}).join("")}function I(e){const{textValue:t}=e;if(t){const o=[];for(const r of t)f().bHQ(r)||o.push(v({...e,textValue:[r]}));return o.join(", ")}return""}const b={[f().Ifu.Page]:({annotation:e,exportArgs:t})=>{const{getExportedPathToPage:o}=t,r=f().v55(e),a=(0,l()._z)({intl:t.intl,blockId:r,getRecordValue:t.getRecordValue,userTimeZone:t.userTimeZone}),i=o({toPageId:r});if(a&&i)return`${a} (${i})`},[f().Ifu.Collection]:({annotation:e,exportArgs:t})=>{var r;const i=f().TSJ(e);if(!i)return;const n=(0,l().R7)({intl:t.intl,collectionId:i.id,getRecordValue:t.getRecordValue,userTimeZone:t.userTimeZone}),s=(0,l().oD)({collectionPointer:i,getRecordValue:t.getRecordValue});return`${n} (${(0,o(938379).C)({collectionId:i.id,spaceId:t.root.spaceId,spaceDomain:void 0,parentCvbId:null==s||null===(r=s.getParentPointer())||void 0===r?void 0:r.id,domainBaseUrl:t.baseUrl,pageVisitSource:a().y8.Export})})`},[f().Ifu.SlackSpecialMention]:({annotation:e})=>`@${f().p5C(e)}`,[f().Ifu.CustomEmoji]:({annotation:e,exportArgs:t})=>{const{getRecordValue:o}=t,r=f().qS0(e);if(!r)return;const a=d().b4_.fromGetRecordValueFn(o)(r);return a?a.getRenderTitle():void 0},[f().Ifu.Comment]:({annotation:e,exportArgs:t})=>{const{getRecordValue:r,baseUrl:i}=t,n=d().b4_.fromGetRecordValueFn(r),s=f().MdE(e);if(!s)return;const c=n(s);if(!c)return;const l=c.getParentId(),u=c.getParentPointer(),m=(0,p().NJ)((0,p().Yn)(u,r));if(!m)return;const g=n(u);let h;if(g){const e=n(g.getParentPointer());h=e&&"table_row"===e.getType()?e.getParentId():g.getParentId()}return(0,o(921940).A)({pageId:m.id,scrollToBlockId:h,pageValue:m,baseUrl:i,discussionId:l,pageVisitSource:a().y8.Export})},[f().Ifu.Link]:({annotation:e,exportArgs:t})=>{const{getExportedPathToFile:r,getExportedPathToPage:a,navigableBlockId:i,baseUrl:n,publicDomainName:s}=t,c=f().cQR(e),l=(0,o(777447).lX)({url:c,baseUrl:n,publicDomainName:s});return l?a({toPageId:l}):r({fromBlockId:i,toFileURI:c})},[f().Ifu.User]:({annotation:e,exportArgs:t})=>{const{intl:r}=t,a=f().NcG(e),i=t.getRecordValue({table:o(798880).oo,id:a});if(i)return`@${(0,o(695608).c6)(r,i)}`},[f().Ifu.Bot]:({annotation:e,exportArgs:t})=>{const r=f().vjW(e),a=t.getRecordValue({table:o(824862).GP,id:r});if(a)return`@${(0,o(799288).Hg)(a)}`},[f().Ifu.Group]:({annotation:e,exportArgs:t})=>{const o=(0,l().Pf)({annotation:e,exportArgs:t});if(o)return o},[f().Ifu.Team]:({annotation:e,exportArgs:t})=>{const o=(0,l().nZ)({annotation:e,exportArgs:t});if(o)return o},[f().Ifu.ExternalObjectInstance]:({annotation:e,exportArgs:t})=>{var o;const r=f().T$c(e);return null===(o=t.getRecordValue({table:g().ev,id:r,spaceId:t.root.spaceId}))||void 0===o||null===(o=o.format)||void 0===o?void 0:o.original_url},[f().Ifu.LinkMention]:({annotation:e,exportArgs:t})=>{const{href:o}=f().q1R(e);return o},[f().Ifu.Date]:({annotation:e,exportArgs:t})=>{const{date_format:o,time_format:r,...a}=f().K7D(e);return`@${(0,n().ZF)({value:a,date_format:o,time_format:r,userTimeZone:t.userTimeZone,allowRelativeDates:!1,intl:t.intl})}`},[f().Ifu.Equation]:({annotation:e,exportArgs:t})=>{const o=(0,u().TG)(e),r=(0,u().oV)(e,t.getExportedPathToPage,t);return`${o}${f().U35(e)}${r}`},[f().Ifu.Place]:({annotation:e})=>(0,m().X1)(f().nG4(e)),[f().Ifu.Bold]:l().if,[f().Ifu.Italic]:l().if,[f().Ifu.Strike]:l().if,[f().Ifu.Code]:l().if,[f().Ifu.Highlight]:l().if,[f().Ifu.Discussion]:l().if,[f().Ifu.Underline]:l().if,[f().Ifu.Inserted]:l().if,[f().Ifu.Deleted]:l().if,[f().Ifu.TemporaryComment]:l().if,[f().Ifu.TemporaryCursor]:l().if,[f().Ifu.TemporaryEquation]:l().if,[f().Ifu.TemporaryPage]:l().if,[f().Ifu.TemporaryCollection]:l().if,[f().Ifu.TemporaryInput]:l().if,[f().Ifu.TemporarySelection]:l().if,[f().Ifu.TemporaryFindHighlight]:l().if,[f().Ifu.TemporarySelectedFindHighlight]:l().if,[f().Ifu.TemplateVariable]:l().if,[f().Ifu.FormulaPageProperty]:l().if,[f().Ifu.FormulaContextValue]:l().if,[f().Ifu.FormulaError]:l().if,[f().Ifu.Citation]:l().if,[f().Ifu.TemporaryCitation]:l().if,[f().Ifu.SuggestionInsertText]:l().if,[f().Ifu.SuggestionRemoveText]:l().if,[f().Ifu.SuggestionAnnotate]:l().if,[f().Ifu.SuggestionUnannotate]:l().if,[f().Ifu.TemporaryNativeMABFilter]:l().if,[f().Ifu.TemporaryDictation]:l().if,[f().Ifu.TemporaryHighlight]:l().if,[f().Ifu.AssistantInstructionsCollection]:l().if,[f().Ifu.TemporaryCommentHighlight]:l().if,[f().Ifu.TemporarySuggestionUnderline]:l().if,[f().Ifu.SearchFilterCreatedTime]:l().if,[f().Ifu.SearchFilterLastEditedTime]:l().if,[f().Ifu.TemporarySearchFilter]:l().if,[f().Ifu.TitleOnly]:l().if,[f().Ifu.Sort]:l().if};function y(){}function k(){return Promise.resolve(void 0)}const S={blockRenderers:{text:y,header:y,sub_header:y,sub_sub_header:y,quote:y,bulleted_list:y,toggle:y,to_do:y,numbered_list:y,code:y,page:y,image:y,video:y,embed:y,bookmark:y,file:y,tweet:y,maps:y,gist:y,framer:y,invision:y,mixpanel:y,drive:y,figma:y,loom:y,pdf:y,typeform:y,codepen:y,audio:y,divider:y,equation:y,collection_view:y,collection_view_page:y,column_list:y,column:y,factory:y,copy_indicator:y,breadcrumb:y,link_to_collection:y,link_to_page:y,table_of_contents:y,callout:y,whimsical:y,miro:y,abstract:y,sketch:y,excalidraw:y,replit:y,alias:y,transclusion_container:y,transclusion_reference:y,external_object_instance:y,table:y,table_row:y,tab:y,hex:y,deepnote:y,external_object_instance_page:y,button:y,ai_block:y,drawing:y,slide:y,personal_home_page:y,home_shortcuts:y,form:y,post:y,workflow:y,transcription:y,mail:y},asyncBlockRenderers:{text:k,header:k,sub_header:k,sub_sub_header:k,quote:k,bulleted_list:k,toggle:k,to_do:k,numbered_list:k,code:k,page:k,image:k,video:k,embed:k,bookmark:k,file:k,tweet:k,maps:k,gist:k,framer:k,invision:k,mixpanel:k,drive:k,figma:k,loom:k,pdf:k,typeform:k,codepen:k,audio:k,divider:k,equation:k,collection_view:k,collection_view_page:k,column_list:k,column:k,factory:k,copy_indicator:k,breadcrumb:k,link_to_collection:k,link_to_page:k,table_of_contents:k,callout:k,whimsical:k,miro:k,abstract:k,sketch:k,excalidraw:k,replit:k,alias:k,transclusion_container:k,transclusion_reference:k,external_object_instance:k,table:k,table_row:k,tab:k,hex:k,deepnote:k,external_object_instance_page:k,button:k,ai_block:k,drawing:k,slide:k,personal_home_page:k,home_shortcuts:k,form:k,post:k,workflow:k,transcription:k,mail:k},annotationRenderers:b,propertyRenderers:{title:e=>v(e),text:v,select:e=>{const{textValue:t,propertySchema:o}=e,r=o.options||[];return i().L3(t,r)},multi_select:e=>{const{textValue:t,propertySchema:o}=e,r=o.options||[],a=i().o2(t,r);return a.sort(),a.join(", ")},status:e=>{const{textValue:t,propertySchema:o}=e;return i().RZ(t,o)},relation:e=>{const{textValue:t,propertySchema:o,exportArgs:r}=e;if("relation"!==o.type)return;const a=i().bG({relationValue:i().n(t),getRecordModel:d().b4_.fromGetRecordValueFn(r.getRecordValue),propertySchema:o,includeNoAccess:!0}),n=i().Ap(a);return I({...e,textValue:n})},rollup:e=>{const t=e.exportArgs.getRecordValue,r=e.exportArgs.formulasModule,a=d().Bj6.fromValue(g().ev,e.block),i=d().b4_.fromGetRecordValueFn(t);return o(568063).I({...e,block:a,getRecordModel:i,collectionRequestContext:{userId:void 0,userTimeZone:e.exportArgs.userTimeZone,depth:0,intl:e.exportArgs.intl,visitedProperties:new Set,resultCache:e.exportArgs.resultCache,regExpCache:e.exportArgs.regExpCache,formatDateCache:e.exportArgs.formatDateCache,experimentService:e.exportArgs.experimentService,collectionFeatureGates:e.exportArgs.collectionFeatureGates},formulasModule:r,spaceIdCreator:e.exportArgs.spaceIdCreator})},url:({textValue:e})=>f().k4p(e),email:({textValue:e})=>f().k4p(e),phone_number:({textValue:e})=>f().k4p(e),checkbox:({textValue:e})=>(0,o(657970).w)(e)?"Yes":"No",person:({textValue:e,exportArgs:t,propertySchema:r,block:a})=>{const{intl:i,getRecordValue:n}=t,s=d().Bj6.fromBlock(a),c=d().b4_.fromGetRecordValueFn(n),l=(0,o(363170).e)({textValue:e,propertySchema:r,blockCreatorPointer:s.getCreatedByPointer(),convertGroupPointersToBeComposite:!0});return o(496603).oE(l.map((e=>{if("space_permission_group"===e.table){const t=c(e);return(0,o(914462).n)({intl:i,permissionGroupModel:t})}const t=n(e),r=t&&d().Bj6.fromValue(e.table,t);return null==r?void 0:r.getDisplayName(i)}))).join(", ")},number:({exportArgs:e,property:t,schema:r,textValue:a})=>{const i=r[t],n=o(302322).M(a);if(!(0,o(534177).O9)(n))return;let s=!0;var l;i&&(0,o(341136).A)(i)&&(s=(null===(l=i.show_as)||void 0===l?void 0:l.showValue)??!0);return s?(0,c().W)({intl:e.intl,propertySchema:i,value:n}):void 0},date:({textValue:e,propertySchema:t,...r})=>{const a=r.exportArgs.userTimeZone,i=(0,o(187696).b)(e),{date_format:s,time_format:c}=t;if(i)return(0,n().ZF)({allowRelativeDates:!1,value:i,date_format:s,time_format:c,userTimeZone:a,intl:r.exportArgs.intl,displayInUserTimezone:r.exportArgs.displayInUserTimezone??!1,alwaysIncludeTimezone:!0})},file:I,formula:e=>{const{property:t,schema:r,block:a,exportArgs:i}=e,{userTimeZone:n,getRecordValue:s,intl:l,resultCache:u,regExpCache:p,formatDateCache:m,formulasModule:g,spaceIdCreator:f}=i;if(!g)return;const h=r[t],v=g.primitiveFormulaValueFromPropertySchema({schema:r,property:t,blockModel:d().Bj6.fromBlock(a),getRecordModel:d().b4_.fromGetRecordValueFn(s),intl:l,userTimeZone:n,depth:0,resultCache:u,regExpCache:p,formatDateCache:m,experimentService:i.experimentService,collectionFeatureGates:i.collectionFeatureGates,spaceIdCreator:f});return"boolean"==typeof v?v?"Yes":"No":(0,o(720665).Et)(v)?(0,c().W)({intl:i.intl,propertySchema:h,value:v}):(0,o(597777).kC)(v)?_({value:v,userTimeZone:n,allowRelativeDates:!1,intl:i.intl}):v},created_time:e=>{const{block:t,exportArgs:o}=e,{userTimeZone:r}=o;if(t.created_time)return _({allowRelativeDates:!1,value:(0,s().KQ)(t.created_time,r),userTimeZone:r,intl:o.intl})},last_edited_time:e=>{const{block:t,exportArgs:o}=e,{userTimeZone:r}=o;if(t.last_edited_time)return _({allowRelativeDates:!1,value:(0,s().KQ)(t.last_edited_time,r),userTimeZone:r,intl:o.intl})},created_by:e=>{const{block:t,exportArgs:o}=e,{getRecordValue:a,intl:i}=o;if(t.created_by_table&&t.created_by_id){const e=(0,r().xC)({getRecordValue:a,pointer:{table:t.created_by_table,id:t.created_by_id,spaceId:t.space_id}});if(e.asActor)return(0,r().lR)(i,e)}},last_edited_by:e=>{const{block:t,exportArgs:o}=e,{getRecordValue:a,intl:i}=o;if(t.last_edited_by_table&&t.last_edited_by_id){const e=(0,r().xC)({getRecordValue:a,pointer:{table:t.last_edited_by_table,id:t.last_edited_by_id,spaceId:t.space_id}});if(e.asActor)return(0,r().lR)(i,e)}},button:e=>"",auto_increment_id:({textValue:e,block:t,exportArgs:r})=>{const a=i().On(e),{getRecordValue:n}=r;if(void 0!==a){const e=d().Bj6.fromBlock(t),r=e.getParentTable();if(r!==o(519831).Vl)return;const i=n((0,o(835243).aZ)({spaceId:e.getSpaceId(),parentTable:r,parentId:e.getParentId()}));return(0,o(716016).H4)(null==i?void 0:i.record_key,a)}},last_visited_time:e=>"",location:e=>"",verification:({textValue:e,exportArgs:t})=>{const o=h().U1(e);if(!o)return"";const r=h().B2(o);return t.intl.formatMessage(h().D6(r.type))},place:({textValue:e})=>{const t=(0,m().eC)(e);return t?(0,m().X1)(t):""}}}},977529:(e,t,o)=>{o.d(t,{DI:()=>u,Yv:()=>l,lq:()=>s});var r=()=>o(615234);const a=2*r().TD,i=8*r().TD,n=new Map;function s(e){return n.get(e)}function c(){return n.values().next().value}function l(){const e=Array.from(n.values());for(const t of e)t.clear()}class u{constructor(e){this.id=void 0,this.sourceBlocks=void 0,this.currentTimeout=null,this.stage=void 0,this.showInitialMessage=void 0,this.showUpdatedMessage=void 0,this.onClear=void 0,this.id=(0,o(498212).Ay)(),this.sourceBlocks=e.sourceBlocks,this.stage="started",this.showInitialMessage=e.showInitialMessage,this.showUpdatedMessage=e.showUpdatedMessage,this.onClear=e.onClear,n.set(this.id,this)}isOldestActive(){return c()===this}startSecondTimeout(){this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=null),this.currentTimeout=setTimeout((()=>{this.stage="updated_message",this.isOldestActive()&&this.showUpdatedMessage(this.sourceBlocks),this.currentTimeout=null}),i)}start(){this.currentTimeout=setTimeout((()=>{this.stage="initial_message",this.isOldestActive()&&this.showInitialMessage(this.sourceBlocks),this.startSecondTimeout()}),a)}showSnackbarForCurrentStage(){"started"===this.stage||("initial_message"===this.stage?this.showInitialMessage(this.sourceBlocks):"updated_message"===this.stage?this.showUpdatedMessage(this.sourceBlocks):(0,o(534177).HB)(this.stage))}clear(){this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=null),n.delete(this.id),this.onClear(),function(){const e=c();e&&e.showSnackbarForCurrentStage()}()}complete(){this.isOldestActive()&&this.stage,this.clear()}}},985284:(e,t,o)=>{o.d(t,{UO:()=>h,MK:()=>_,CU:()=>f});o(296540);var r=()=>o(471995),a=()=>o(69708),i=()=>o(104012),n=o(474848);function s(e){const{item:t,onDismiss:o}=e;r().D6({...t,right:(0,n.jsx)(i().Ag,{onClick:o??r().N2,children:(0,n.jsx)(a().sA,{id:"snackbar.dismiss.title",defaultMessage:"Dismiss"})})})}var c=()=>o(56366),l=()=>o(98126),u=()=>o(534177),d=()=>o(802790);const p=(0,a().YK)({pageDuplicatingMessage:{id:"duplicateProgressSnackbar.pageDuplicating",defaultMessage:"Page is duplicating"},pageStillDuplicatingMessage:{id:"duplicateProgressSnackbar.pageStillDuplicating",defaultMessage:"Page is still duplicating, but this is taking a while. Feel free to leave this page."},contentDuplicatingMessage:{id:"duplicateProgressSnackbar.contentDuplicating",defaultMessage:"Content is duplicating"},contentStillDuplicatingMessage:{id:"duplicateProgressSnackbar.contentStillDuplicating",defaultMessage:"Content is still duplicating, but this is taking a while. Feel free to leave this page."}});function m(e){const{sourceBlocks:t,stage:o}=e,r=(0,c().K8)((()=>!(!t||t.length<1)&&(null==t?void 0:t[0].isType("page"))),[t]);let i;return"initial"===o?i=r?p.pageDuplicatingMessage:p.contentDuplicatingMessage:"update"===o?i=r?p.pageStillDuplicatingMessage:p.contentStillDuplicatingMessage:(0,u().HB)(o),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,n.jsx)(l().A,{size:"sm",onDarkBackground:!0}),(0,n.jsx)("span",{children:(0,n.jsx)(a().sA,{...i})}),(0,n.jsx)("div",{style:{height:24},children:(0,n.jsx)(d().A,{type:"vertical",colorVariant:"inversePrimary",colorPalette:"gray",size:24})})]})}var g=()=>o(977529);function f(e){const{sourceBlocks:t}=e,o=new(g().DI)({sourceBlocks:t,showInitialMessage:v,showUpdatedMessage:I,onClear:b});return o.start(),o.id}function h(e){const t=(0,g().lq)(e);null==t||t.clear()}function _(e){const t=(0,g().lq)(e);null==t||t.complete()}function v(e){s({item:{label:(0,n.jsx)(m,{sourceBlocks:e,stage:"initial"}),durationMs:"keep"},onDismiss:()=>{(0,g().Yv)()}})}function I(e){s({item:{label:(0,n.jsx)(m,{sourceBlocks:e,stage:"update"}),durationMs:"keep"},onDismiss:()=>{(0,g().Yv)()}})}function b(){r().N2()}},989616:(e,t,o)=>{o.d(t,{R:()=>i});o(581454);var r=()=>o(962845),a=()=>o(792002);function i(e,t=!1){if(t){const t=(0,r().BO)(e);if(t){const e={multiSelection:t,mode:"editing",forceExtendAnnotations:{}};return(0,a().O7)(e)}}return e.map((e=>e.getTitleValue())).join("\n")}}}]);