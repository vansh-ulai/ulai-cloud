"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[70442],{47582:(e,t,r)=>{r.d(t,{V:()=>T});r(898992),r(354520);var s=r(296540),n=()=>r(56366),a=()=>r(69708),o=()=>r(534177),i=()=>r(722872),d=()=>r(463830),l=()=>r(148832),c=()=>r(404277),m=()=>r(939740),u=()=>r(221844),p=()=>r(484714),g=()=>r(179034),h=()=>r(496603),b=()=>r(231297),f=()=>r(6731),S=()=>r(89924),v=()=>r(504546),y=()=>r(944850),x=r(474848);function C({blockStore:e,filterDeletedPermissions:t}){const{mockBlockStore:r}=function({blockStore:e,filterDeletedPermissions:t}){const r=(0,p().v3)(),a=(0,n().K8)((()=>(0,h().mg)(e.inMemoryRecordCache.data)),[e]),o=(0,s.useMemo)((()=>new(u().A)({name:"adminContentSearch.deletedFromTrashPermissionsView",data:a,isTemporaryData:!0})),[a]),i=(0,f().D)({unpersistedInMemoryRecordCache:o}),d=(0,n().K8)((()=>{const s=t?t(e):[],n=new(l().B)(r,{table:g().ev,id:e.id},{inMemoryRecordCache:o});return i.createAndCommit({userAction:"adminContentSearch.restoreDeletedFromTrashPermissionsOptimistically",perform:e=>{b().applyOperation({store:n,operation:{pointer:n,command:"set",path:["permissions"],args:s},transaction:e})}}),{mockBlockStore:n}.mockBlockStore}),[r,e,o,i,t]);return{mockBlockStore:d}}({blockStore:e,filterDeletedPermissions:t}),a=(0,y().d)(r),o=(0,v().x)({permissionItems:a});return(0,x.jsx)(c().A,{menuType:i().gu.Popup,width:248,children:(0,x.jsx)(m().Ay,{type:m().Oh.Vertical,initialFocus:void 0,sections:[{key:"deletedFromTrashPermissions",render:e=>(0,x.jsx)(S().A,{...e}),items:o}]})})}var M=()=>r(621841),I=()=>r(632854);function T({store:e,getValidDeletedPermissions:t,environment:r,includeNonRestoreActions:u,onRestoreOrDeletePage:p,from:g,renderOrigin:h}){const b=(0,n().uB)(void 0,d().A),f=(0,a().tz)(),[S,v]=(0,s.useState)(!1),y=[(0,I().j9)({environment:r,deletionStatus:"deleted_from_trash",popupStore:b,store:e,from:g,handleOpenDeletedPermissionsMenu:()=>v(!0),includeNonRestoreActions:u,onRestoreOrDeletePage:p,getValidDeletedPermissions:t}),(0,I().CT)({environment:r,from:g,deletionStatus:"deleted_from_trash",popupStore:b,store:e,includeNonRestoreActions:u,onRestoreOrDeletePage:p,getValidDeletedPermissions:t})].filter(o().O9);return(0,x.jsx)(M().j,{renderOrigin:h,onClose:()=>v(!1),originAriaLabel:f.formatMessage({id:"pageCellActions.deletedFromTrash.iconButton.ariaLabel",defaultMessage:"More actions for deleted from trash page"}),popupStore:b,render:()=>S&&e instanceof l().B?(0,x.jsx)(C,{blockStore:e,filterDeletedPermissions:t}):(0,x.jsx)(c().A,{menuType:i().gu.Popup,width:248,children:(0,x.jsx)(m().Ay,{type:m().Oh.Vertical,initialFocus:void 0,sections:y})}),useShareMenuStyles:!1})}},210216:(e,t,r)=>{r.d(t,{N:()=>m});r(296540);var s=()=>r(56366),n=()=>r(68263),a=()=>r(69708),o=()=>r(765957),i=()=>r(898808),d=()=>r(678553),l=()=>r(306735),c=r(474848);function m({permissionItem:e}){const t=(0,a().tz)(),r=(0,s().O$)(o().AppStoreSidebarSpaceStore),m=(0,s().K8)((()=>{var e;return null===(e=o().default.state.sidebarSpaceStore)||void 0===e?void 0:e.getName()}),[]),u=null==e?void 0:e.role,p=(0,n().PW)(u)?(0,l().J)(t,u):void 0;return(0,c.jsx)(d().Ay,{desktopIconStyle:{alignSelf:"center",width:24},icon:r?(0,c.jsx)(i().x,{disabled:!0,store:r,size:24}):void 0,title:m,caption:(0,c.jsx)(a().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.spaceMembers",defaultMessage:"Members{maybeRoleString}",values:{maybeRoleString:p?` · ${p}`:""}})})}},245981:(e,t,r)=>{r.d(t,{L:()=>n,R:()=>a});var s=()=>r(564884);function n(e,t){(0,s().u)({environment:e,event:{eventName:"cdrr_page_delete_permanently",eventProperties:{page_id:t.pageId,from:t.from}}})}function a(e,t){(0,s().u)({environment:e,event:{eventName:"cdrr_data_source_delete_permanently",eventProperties:{collection_id:t.collectionId,from:t.from}}})}},306735:(e,t,r)=>{r.d(t,{J:()=>n});const s=(0,r(69708).YK)({editor:{id:"adminContentSearchTab.sharedWith.permissions.editor",defaultMessage:"Full access"},readAndWrite:{id:"adminContentSearchTab.sharedWith.permissions.readAndWrite",defaultMessage:"Can edit"},commentOnly:{id:"adminContentSearchTab.sharedWith.permissions.commentOnly",defaultMessage:"Can comment"},reader:{id:"adminContentSearchTab.sharedWith.permissions.reader",defaultMessage:"Can view"},none:{id:"adminContentSearchTab.sharedWith.permissions.none",defaultMessage:"None"}});function n(e,t){switch(t){case"editor":return e.formatMessage(s.editor);case"read_and_write":return e.formatMessage(s.readAndWrite);case"comment_only":return e.formatMessage(s.commentOnly);case"reader":return e.formatMessage(s.reader);case"none":return e.formatMessage(s.none)}}},482707:(e,t,r)=>{r.d(t,{k:()=>a});var s=()=>r(645873);const n=new(s().O2)("shareMenuContainer",(async()=>await Promise.all([r.e(75134),r.e(99223),r.e(9304),r.e(9773),r.e(36556),r.e(40537),r.e(55373),r.e(36192),r.e(71562),r.e(96346),r.e(44711),r.e(53321),r.e(90825),r.e(16471),r.e(37353),r.e(29151),r.e(87248),r.e(62475),r.e(3151),r.e(98629),r.e(58550),r.e(67539),r.e(42838),r.e(22900),r.e(27634),r.e(85128),r.e(49889),r.e(20108),r.e(95555),r.e(87249),r.e(71621),r.e(92845),r.e(56369),r.e(2411),r.e(89296),r.e(46414),r.e(9294),r.e(11676),r.e(91256),r.e(40563),r.e(67494),r.e(44584),r.e(53141),r.e(4422),r.e(4330),r.e(55162),r.e(71003),r.e(55753),r.e(28866),r.e(22001),r.e(71386),r.e(4351),r.e(6331),r.e(69144),r.e(42660),r.e(55997),r.e(40828),r.e(12341),r.e(96402),r.e(84166),r.e(70359),r.e(29595),r.e(16448),r.e(10442),r.e(16434),r.e(45769),r.e(46080),r.e(75902),r.e(99809),r.e(58636),r.e(78405),r.e(33675),r.e(74562),r.e(47160),r.e(37384),r.e(91598),r.e(48046),r.e(3259),r.e(13955),r.e(42056),r.e(3165),r.e(76677),r.e(31842),r.e(43223),r.e(45147),r.e(15517),r.e(94995),r.e(98339),r.e(55639),r.e(1966),r.e(35738),r.e(6642),r.e(55776),r.e(51444),r.e(40914),r.e(58209),r.e(13297),r.e(4802),r.e(65197),r.e(81768),r.e(94300),r.e(62032),r.e(72122),r.e(32487),r.e(28058),r.e(90638),r.e(75422),r.e(97859),r.e(50856),r.e(65014),r.e(49175),r.e(36359),r.e(2752),r.e(11571),r.e(92924),r.e(42525),r.e(25204),r.e(52273),r.e(52986),r.e(45732),r.e(46817),r.e(70442),r.e(28656),r.e(37160),r.e(30443),r.e(9426),r.e(76690),r.e(63248),r.e(39457),r.e(21912),r.e(80668),r.e(12507),r.e(6626),r.e(26497),r.e(61016),r.e(91629),r.e(61858),r.e(63053),r.e(34399),r.e(89379),r.e(34974),r.e(75332),r.e(95103),r.e(75681)]).then(r.bind(r,134738)))),a=(0,s()._h)(n,(e=>e.ShareMenuContainer))},504546:(e,t,r)=>{r.d(t,{o:()=>R,x:()=>_});r(944114),r(581454);var s=r(296540),n=()=>r(738418),a=()=>r(69708),o=()=>r(859428),i=()=>r(484714),d=()=>r(56366),l=()=>r(401497),c=()=>r(824862),m=()=>r(842677),u=()=>r(985405),p=()=>r(870092),g=()=>r(710149),h=()=>r(678553),b=()=>r(256863),f=r(474848);function S({botId:e}){const t=(0,a().tz)(),r=(0,i().v3)(),s=(0,d().K8)((()=>m().RecordStores.createUniqueRootStore(r,{table:c().GP,id:e})),[e,r]),n=(0,d().K8)((()=>s.getDisplayName(t)),[s,t]),o=(0,d().K8)((()=>s.getParentStore()),[s]),g=(0,d().K8)((()=>{if(o){if(o instanceof p().L)return o.getDisplayName(t);if(o instanceof u().SpaceStore)return o.getName()}}),[o,t]),S=(0,l().IS)((()=>({desktopIconStyle:{alignSelf:"center",width:24,fontSize:18}})),[]);return n?(0,f.jsx)(h().Ay,{desktopIconStyle:S.desktopIconStyle,icon:(0,f.jsx)(b().A,{botStore:s,size:24}),title:n,caption:(0,f.jsx)(a().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.botMenuItem.createdBy",defaultMessage:"Created by {creatorName}",values:{creatorName:g}})}):(0,f.jsx)(v,{})}function v(){const e=(0,l().IS)((e=>({container:{userSelect:"none",minHeight:45,fontSize:14,padding:"4px 8px",display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center"},textContainer:{display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start",gap:6},icon:{flexGrow:0,flexShrink:0,width:24,height:24,borderRadius:"0.25em",marginInlineEnd:4,marginTop:1},title:{flexGrow:0,flexShrink:0,width:80,height:14,borderRadius:"0.25em",marginInlineStart:4},byline:{flexGrow:0,flexShrink:0,width:150,height:10,borderRadius:"0.25em",marginInlineStart:4}})),[]);return(0,f.jsxs)("div",{style:e.container,children:[(0,f.jsx)(g().A,{style:e.icon}),(0,f.jsxs)("div",{style:e.textContainer,children:[(0,f.jsx)(g().A,{emphasized:!1,style:e.title}),(0,f.jsx)(g().A,{emphasized:!1,style:e.byline})]})]})}var y=()=>r(864223),x=()=>r(210216),C=()=>r(566910),M=()=>r(854150),I=()=>r(95758),T=()=>r(898808),P=()=>r(306735);function j({teamId:e,role:t,onlyOwners:r}){const s=(0,i().v3)(),n=(0,a().tz)(),o=(0,d().K8)((()=>new(I().h)(s,{table:M().yK,id:e})),[s,e]),l=(0,P().J)(n,t),c=(0,d().K8)((()=>o.getName()),[o]),m=c||(0,f.jsx)(a().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.unknownTeamName",defaultMessage:"Private teamspace"});return(0,f.jsx)(h().Ay,{desktopIconStyle:{alignSelf:"center",width:24},icon:c?(0,f.jsx)(T().x,{disabled:!0,store:o,size:24}):(0,C().e)(),title:m,caption:r?(0,f.jsx)(a().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.teamOwners",defaultMessage:"Owners{maybeRoleString}",values:{maybeRoleString:l?` · ${l}`:""}}):(0,f.jsx)(a().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.teamMembers",defaultMessage:"Members{maybeRoleString}",values:{maybeRoleString:l?` · ${l}`:""}})})}var A=()=>r(737309);const k=(0,a().YK)({sharedWithWorkspaceMembers:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithWorkspaceMembers",defaultMessage:"Workspace members"},sharedWithTeamOwners:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithTeamOwners",defaultMessage:"Teamspace owners"},sharedWithTeamMembers:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithTeamMembers",defaultMessage:"Teamspace members"},sharedWithMembers:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithMembers",defaultMessage:"{numMembers, plural, one {# member} other {# members}}"},sharedWithGroups:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithGroups",defaultMessage:"{numGroups, plural, one {# group} other {# groups}}"},sharedWithGuests:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithGuests",defaultMessage:"{numGuests, plural, one {# guest} other {# guests}}"},sharedWithBots:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithBots",defaultMessage:"{numBots, plural, one {# connection} other {# connections}}"},separator:{defaultMessage:", ",id:"adminContentSearchTab.pagesTable.sharedWithCell.separator"}});function w({blockStore:e}){const t=(0,r(944850).d)(e),s=function(e,t){const{mostPermissivePublicItem:r,spacePermission:s,groupPermissions:i,guestUserPermissions:d,memberUserPermissions:l,teamSharePermissions:c,teamOwnerSharePermissions:m,botPermissions:u}=e,p=s&&"none"!==s.permissionItem.role;if(r&&"none"!==r.permissionItem.role)return(0,f.jsx)(a().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithWeb",defaultMessage:"Shared to web"});if(!p&&0===i.length&&0===d.length&&0===l.length&&0===c.length&&0===m.length&&0===u.length)return(0,f.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[(0,f.jsx)(a().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.orphanedPage",defaultMessage:"Nobody"}),(0,f.jsx)(o().A,{render:e=>(0,f.jsx)("div",{...e,children:(0,n().G)({marginInlineStart:4,height:14,width:14,opacity:.5})}),renderTooltip:()=>(0,f.jsx)(a().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.orphanedPage.tooltip",defaultMessage:"No person, group, or teamspace has any access to this page."})})]});const g=[];p?g.push(t.formatMessage(k.sharedWithWorkspaceMembers)):(m.length>0&&0===c.length?g.push(t.formatMessage(k.sharedWithTeamOwners)):c.length>0&&g.push(t.formatMessage(k.sharedWithTeamMembers)),l.length>0&&g.push(t.formatMessage(k.sharedWithMembers,{numMembers:l.length})),i.length>0&&g.push(t.formatMessage(k.sharedWithGroups,{numGroups:i.length})));d.length>0&&g.push(t.formatMessage(k.sharedWithGuests,{numGuests:d.length}));u.length>0&&g.push(t.formatMessage(k.sharedWithBots,{numBots:u.length}));return g.join(t.formatMessage(k.separator))}(t,(0,a().tz)()),i=_({permissionItems:t});return(0,f.jsx)(r(75491).ED,{title:s,items:i,disabled:0===i.length})}function _({permissionItems:e}){return[...e.spacePermission?[{key:"space-permission",render:t=>{var r;return(0,f.jsx)(x().N,{...t,permissionItem:null===(r=e.spacePermission)||void 0===r?void 0:r.permissionItem})},action:()=>{}}]:[],...e.teamOwnerSharePermissions.map((e=>({key:`${e.team_id}-owners`,render:t=>(0,f.jsx)(j,{...t,onlyOwners:!0,teamId:e.team_id,role:e.role}),action:()=>{}}))),...e.teamSharePermissions.map((e=>({key:`${e.team_id}-members`,render:t=>(0,f.jsx)(j,{...t,teamId:e.team_id,role:e.role}),action:()=>{}}))),...e.groupPermissions.map((e=>({key:e.id,render:()=>(0,f.jsx)(y()._,{name:e.name,icon:e.icon,role:e.role}),action:()=>{}}))),...e.memberUserPermissions.map((e=>({key:e.user_id,render:t=>(0,f.jsx)(A().m,{...t,userId:e.user_id,role:e.role}),action:()=>{}}))),...e.guestUserPermissions.map((e=>({key:e.user_id,render:t=>(0,f.jsx)(A().m,{...t,isGuest:!0,userId:e.user_id,role:e.role}),action:()=>{}}))),...e.botPermissions.map((e=>({key:e.bot_id,render:t=>(0,f.jsx)(S,{...t,botId:e.bot_id}),action:()=>{}})))]}const R=s.memo(w)},570869:(e,t,r)=>{r.r(t),r.d(t,{iconDefinition:()=>n,keySmallIcon:()=>a});r(296540);var s=r(474848);const n={viewBox:"0 0 16 16",fittedViewBox:"3.99 1.37 8.01 13.26",svg:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{d:"M8 3.8a.825.825 0 1 0 0 1.65.825.825 0 0 0 0-1.65"}),(0,s.jsx)("path",{d:"M8 1.375a4 4 0 0 0-2.125 7.39v3.922c0 .18.078.352.213.47l1.5 1.313a.625.625 0 0 0 .824 0l1.5-1.312a.625.625 0 0 0 .063-.877l-.777-.906.777-.906a.63.63 0 0 0 .15-.406V8.764A4 4 0 0 0 8 1.374m-2.75 4a2.75 2.75 0 1 1 3.972 2.464.63.63 0 0 0-.347.56V9.83L7.9 10.968c-.2.234-.2.58 0 .814l.723.842L8 13.17l-.875-.765V8.399a.63.63 0 0 0-.347-.56A2.75 2.75 0 0 1 5.25 5.375"})]})},a=(0,r(340498).wt)("keySmall",n)},621841:(e,t,r)=>{r.d(t,{j:()=>m});r(296540);var s=()=>r(401497),n=()=>r(126617),a=()=>r(406699),o=()=>r(285790),i=()=>r(417392),d=()=>r(718827),l=()=>r(623275);var c=r(474848);function m(e){const{onClose:t,originAriaLabel:r,popupStore:m,render:u,useShareMenuStyles:p,renderOrigin:g}=e,{popupShareModal:h,popupMenu:b}=(0,s().IS)((e=>({destructiveMenuItemHover:{background:(0,d().i)({color:e.red.background.secondaryTranslucent,mode:e.mode})},destructiveMenuItemPressed:{background:(0,d().yZ)({color:e.red.background.secondaryTranslucent,mode:e.mode})},popupMenu:{width:248},popupShareModal:{width:l().$D,borderRadius:l().Sg}})),[]),f=(0,s().IS)((()=>({originEllipsesIcon:{width:16,height:16}})),[]);return(0,c.jsx)(a().A,{popupType:i().nl.Popup,alignmentToOrigin:"start",placementToOrigin:"bottom",style:p?h:b,render:u,onClose:t,buttonPopupStore:m,renderOrigin:g??(e=>(0,c.jsx)(o().A,{iconStyle:f.originEllipsesIcon,ariaLabel:r,icon:n().ellipsisSmallIcon,...e}))})}},632854:(e,t,r)=>{r.d(t,{j9:()=>V,CT:()=>N});r(944114),r(898992),r(354520),r(581454),r(296540);var s=()=>r(726637),n=()=>r(56366),a=()=>r(401497),o=()=>r(718827),i=()=>r(252291),d=()=>r(584262),l=()=>r(165358),c=()=>r(938379),m=()=>r(955363),u=()=>r(454503),p=()=>r(753363),g=()=>r(742852),h=()=>r(236262),b=()=>r(179034),f=()=>r(519831),S=()=>r(743246),v=()=>r(69708),y=()=>r(534177),x=()=>r(245981),C=()=>r(884107),M=()=>r(723039),I=()=>r(27579),T=()=>r(345913),P=()=>r(492414),j=(r(737550),()=>r(68263)),A=()=>r(148832),k=()=>r(543665);var w=()=>r(227894),_=()=>r(765957),R=()=>r(760217),W=()=>r(89924),B=()=>r(859428),O=r(474848);function D(e){const{getValidDeletedPermissions:t,store:r,deletionStatus:s}=e,a=(0,n().K8)((()=>{var e;if("deleted_from_trash"!==s)return;if(!(r instanceof A().B||r instanceof k().m))return;const n=function(e){for(const t of e)if(t instanceof A().B||t instanceof k().m){if(!t.isDefined())continue;if(t.getPermissionItems().some(j().Ny))return t}}((0,w().g)(r));if(Boolean((null==n?void 0:n.id)!==r.id))return{ancestorStore:n,canRestoreAncestor:!0,canRestoreOriginalAccess:!1};const a=t?t(r):[],o=Boolean(r.getParentSpaceStore()&&0===a.length);return{ancestorStore:n,canRestoreAncestor:!1,canRestoreOriginalAccess:!Boolean(null===(e=r.getParentBlockStore())||void 0===e?void 0:e.pathHasDeletedPermission())&&!o}}),[r,t,s]);return a}function V(e){const{environment:t,deletionStatus:r,popupStore:n,store:a}=e,o=D({deletionStatus:r,store:a,getValidDeletedPermissions:e.getValidDeletedPermissions});async function l(){let e;if(a.table===b().ev)e=(0,P().Ay)({store:a,pageVisitSource:d().y8.CopyLink});else if(a.table===f().Vl){var r,o;e=(0,c().C)({collectionId:a.id,spaceId:a.getSpaceId(),spaceDomain:null===(r=a.getSpaceStore())||void 0===r?void 0:r.getEditDomain(),parentCvbId:null===(o=a.getParentPointer())||void 0===o?void 0:o.id,domainBaseUrl:s().A.domainBaseUrl,pageVisitSource:d().y8.CopyLink})}else{if(a.table===S().C0)return;(0,y().HB)(a)}const i=await C().R.clipboardActions.load();await i.copyString({environment:t,stringValue:e,copiedMessage:i.clipboardMessages.copiedLinkToClipboard}),n.setState({open:!1})}const u=[];switch(r){case"alive":case"in_trash":{const{handleOpenPermissionsMenu:t}=e;a.table===b().ev&&u.push(function({action:e}){return{key:"change-permissions",render:e=>(0,O.jsx)(R().A,{...e,icon:(0,O.jsx)(i().I,{icon:p().keyIcon}),title:(0,O.jsx)(v().sA,{id:"adminContentSearchTab.pagesTable.page.actions.changePermissions",defaultMessage:"Change permissions"})}),action:e}}({action:t})),a.table!==b().ev&&a.table!==f().Vl||u.push(U({store:a,action:l}));break}case"deleted_from_trash":{const{handleOpenDeletedPermissionsMenu:r,includeNonRestoreActions:s}=e,{ancestorStore:c,canRestoreAncestor:g,canRestoreOriginalAccess:h}=o??{};if(c&&g&&c.table!==f().Vl&&c.table!==S().C0){const e=()=>{(0,I().L)({environment:t,url:(0,P().Ay)({store:c,pageVisitSource:d().y8.DeletedFromTrashPageActions})}),n.setState({open:!1})};u.push(function({action:e}){return{key:"go-to-parent-page",render:e=>(0,O.jsx)(R().A,{...e,icon:(0,O.jsx)(i().I,{icon:m().arrowDiagonalUpRightIcon}),title:(0,O.jsx)(v().sA,{id:"adminContentSearchTab.pagesTable.page.actions.navigateToParent",defaultMessage:"Open parent in new tab"})}),action:e}}({action:e}))}h&&a.table===b().ev&&u.push(function({action:e}){return{key:"view-original-permissions",render:e=>(0,O.jsx)(R().A,{...e,icon:(0,O.jsx)(i().I,{icon:p().keyIcon}),title:(0,O.jsx)(v().sA,{id:"adminContentSearchTab.pagesTable.page.actions.viewOriginalPermissions",defaultMessage:"View original permissions"})}),action:e}}({action:r})),s&&(a.table!==b().ev&&a.table!==f().Vl||u.push(U({store:a,action:l})));break}default:(0,y().HB)(r)}if(0!==u.length)return{key:"actions",render:e=>(0,O.jsx)(W().A,{...e}),items:u}}function N(e){const{from:t,deletionStatus:r,environment:s,store:a,popupStore:o,onRestoreOrDeletePage:d}=e,c=D({deletionStatus:r,store:a,getValidDeletedPermissions:e.getValidDeletedPermissions}),m=[],p=(0,n().K8)((()=>{var e;return a.table===b().ev&&(null===(e=_().default.state.mainEditorCurrentBlockStore)||void 0===e?void 0:e.id)===a.id}),[a]);switch(r){case"alive":return;case"in_trash":{async function g(){if(a.table===b().ev)await T().iN({environment:s,blockStore:a,spaceId:a.getSpaceId(),from:"adminContentSearch.restorePage",restoreWithoutNavigation:!0});else if(a.table===f().Vl)await T().Pj({environment:s,collectionStore:a,spaceId:a.getSpaceId(),from:"adminContentSearch.restoreCollection",restoreWithoutNavigation:!0});else{if(a.table===S().C0)return;(0,y().HB)(a)}null==d||d(a.pointer),o.setState({open:!1})}function C(){if(a.table===S().C0)return;const e=d?e=>{e.length>1&&l().log({level:"warning",from:"usePageCellActions",type:"multipleBlocksDeletedFromTrash",data:{blockIds:e.filter((e=>e.table===b().ev)).map((e=>e.id)),collectionIds:e.filter((e=>e.table===f().Vl)).map((e=>e.id))}}),e.length>0&&d(e[0].pointer)}:void 0;M().E({environment:s,from:"adminContentSearch",handleSuccess:e,...a.table===b().ev?{stores:[a],table:b().ev}:{stores:[a],table:f().Vl}}),o.setState({open:!1})}m.push(G({action:g,disable:!1}),function({action:e}){return{key:"delete-from-trash",render:e=>(0,O.jsx)(L,{...e,icon:(0,O.jsx)(i().I,{icon:h().trashIcon}),title:(0,O.jsx)(v().sA,{id:"adminContentSearchTab.pagesTable.page.actions.deleteFromTrash",defaultMessage:"Delete from Trash"})}),action:e}}({action:C}));break}case"deleted_from_trash":{const{includeNonRestoreActions:I}=e,{canRestoreAncestor:P,canRestoreOriginalAccess:j}=c??{},A=P||!j,k=P?(0,O.jsx)(v().sA,{id:"adminContentSearchTab.pagesTable.page.actions.restore.tooltip.restoreParent",defaultMessage:"Restore the parent page to restore the original permissions."}):j?void 0:(0,O.jsx)(v().sA,{id:"adminContentSearchTab.pagesTable.page.actions.restore.tooltip.pageCannotBeRestored",defaultMessage:"This page cannot have its original permissions restored."});m.push(G({action:async()=>{const e=a.getSpaceId();e&&(await T().fB({environment:s,store:a,spaceId:e,from:`${t}.restoreRetainedPage`}),null==d||d(a.pointer),o.setState({open:!1}))},disable:A,tooltip:k}),function({action:e}){return{key:"restore-to-private",render:e=>(0,O.jsx)(R().A,{...e,icon:(0,O.jsx)(i().I,{icon:u().arrowUTurnUpLeftIcon}),shouldWrapCaption:!0,title:(0,O.jsx)(v().sA,{id:"adminContentSearchTab.pagesTable.page.actions.restoreToPrivate",defaultMessage:"Restore to Private pages"})}),action:e}}({action:async()=>{const e=a.getSpaceId();e&&(await T().Ys({environment:s,store:a,spaceId:e,navigateToPage:p,from:`${t}.restoreRetainedPage`}),null==d||d(a.pointer),o.setState({open:!1}))}})),I&&m.push(function({action:e}){return{key:"purge",render:e=>(0,O.jsx)(L,{...e,icon:(0,O.jsx)(i().I,{icon:h().trashIcon}),title:(0,O.jsx)(v().sA,{id:"adminContentSearchTab.pagesTable.page.actions.purge",defaultMessage:"Permanently delete"})}),action:e}}({action:()=>{T().lT({environment:s,store:a,handleSuccess:e=>{null==d||d(e),e.table===b().ev?x().L(s,{pageId:e.id,from:"content_search"}):x().R(s,{collectionId:e.id,from:"content_search"})}}),o.setState({open:!1})}}));break}default:(0,y().HB)(r)}return{key:"inactive-page-actions",render:e=>(0,O.jsx)(W().A,{...e,topBorder:!0}),items:m}}function L(e){const t=(0,a().IS)((e=>({destructiveMenuItemHover:{background:(0,o().i)({color:e.red.background.secondaryTranslucent,mode:e.mode})},destructiveMenuItemPressed:{background:(0,o().yZ)({color:e.red.background.secondaryTranslucent,mode:e.mode})}})),[]);return(0,O.jsx)(R().A,{...e,isRedOnHover:!0,hoveredStyle:t.destructiveMenuItemHover,pressedStyle:t.destructiveMenuItemPressed})}function G({action:e,disable:t,tooltip:r}){const s=e=>(0,O.jsx)(R().A,{...e,disabled:t,disallowTabbing:t,disabledFeedback:!0,icon:(0,O.jsx)(i().I,{icon:u().arrowUTurnUpLeftIcon}),shouldWrapCaption:!0,title:(0,O.jsx)(v().sA,{id:"adminContentSearchTab.pagesTable.page.actions.restore",defaultMessage:"Restore to original location"})});return{key:"restore",render:e=>r?(0,O.jsx)(B().A,{textWrap:!0,renderTooltip:()=>r??null,placement:"right",render:t=>(0,O.jsx)("div",{...t,children:s(e)})}):s(e),action:e}}function U({store:e,action:t}){let r;return e.table===b().ev?r=(0,O.jsx)(v().sA,{id:"adminContentSearchTab.pagesTable.page.actions.copyLink",defaultMessage:"Copy link to page"}):e.table===f().Vl?r=(0,O.jsx)(v().sA,{id:"adminContentSearchTab.pagesTable.dataSource.actions.copyLink",defaultMessage:"Copy link to data source"}):(0,y().HB)(e),{key:"copy-link",render:e=>(0,O.jsx)(R().A,{...e,icon:(0,O.jsx)(i().I,{icon:g().linkIcon}),title:r}),action:t}}},737309:(e,t,r)=>{r.d(t,{m:()=>p});r(296540);var s=()=>r(484714),n=()=>r(56366),a=()=>r(798880),o=()=>r(695608),i=()=>r(69708),d=()=>r(870092),l=()=>r(678553),c=()=>r(453697),m=()=>r(306735),u=r(474848);function p({userId:e,role:t,isGuest:r}){const p=(0,i().tz)(),g=(0,s().v3)(),{userStore:h,userName:b}=(0,n().K8)((()=>{const t=new(d().L)(g,{table:a().oo,id:e}),r=(0,o().c6)(p,t.getModel());return{userStore:t,userName:r}}),[g,e,p]),f=(0,m().J)(p,t);return(0,u.jsx)(l().Ay,{desktopIconStyle:{alignSelf:"center",width:24},icon:(0,u.jsx)(c().A,{userStore:h,size:24}),title:b,caption:r?(0,u.jsx)(i().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.guest",defaultMessage:"Guest{maybeRoleString}",values:{maybeRoleString:f?` · ${f}`:""}}):(0,u.jsx)(i().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.member",defaultMessage:"Member{maybeRoleString}",values:{maybeRoleString:f?` · ${f}`:""}})})}},753363:(e,t,r)=>{r.r(t),r.d(t,{iconDefinition:()=>n,keyIcon:()=>a});r(296540);var s=r(474848);const n={viewBox:"0 0 20 20",fittedViewBox:"4.87 1.62 9.98 16.75",svg:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{d:"M9.86 6.61a.969.969 0 1 0 0-1.938.969.969 0 0 0 0 1.937"}),(0,s.jsx)("path",{d:"M9.86 1.625a4.984 4.984 0 0 0-2.563 9.26v5.17c0 .18.078.351.213.47l1.938 1.695a.625.625 0 0 0 .823 0l1.937-1.695a.625.625 0 0 0 .063-.877l-1.104-1.289 1.104-1.288a.63.63 0 0 0 .15-.407v-1.779a4.984 4.984 0 0 0-2.563-9.26M6.124 6.609a3.734 3.734 0 1 1 5.394 3.347.63.63 0 0 0-.347.56v1.917l-1.303 1.52c-.2.234-.2.58 0 .813l1.05 1.226-1.06.927-1.312-1.148v-5.255a.63.63 0 0 0-.347-.56 3.73 3.73 0 0 1-2.075-3.347"})]})},a=(0,r(340498).wt)("key",n)},864223:(e,t,r)=>{r.d(t,{_:()=>u});r(296540);var s=()=>r(56366),n=()=>r(252291),a=()=>r(888867),o=()=>r(69708),i=()=>r(765957),d=()=>r(678553),l=()=>r(187820),c=()=>r(306735),m=r(474848);function u({name:e,icon:t,role:r}){const u=(0,o().tz)(),p=(0,s().O$)(i().AppStoreSidebarSpaceStore),g=(0,c().J)(u,r);return(0,m.jsx)(d().Ay,{desktopIconStyle:{alignSelf:"center",width:24,fontSize:18},icon:(0,m.jsx)(l().B6,{disabled:!0,icon:t&&p?{pointer:p.pointer,icon:t}:void 0,size:20,isEmptyPage:!1,title:e,defaultIcon:(0,m.jsx)(n().I,{icon:a().s,colorVariant:"tertiary"})}),title:e||(0,m.jsx)(o().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.untitledPage",defaultMessage:"Untitled{maybeRoleString}",values:{maybeRoleString:g?` · ${g}`:""}}),caption:(0,m.jsx)(o().sA,{id:"adminContentSearchTab.pagesTable.sharedWithCell.group",defaultMessage:"Group{maybeRoleString}",values:{maybeRoleString:g?` · ${g}`:""}})})}},904671:(e,t,r)=>{r.d(t,{BX:()=>f,YL:()=>S,lE:()=>v});var s=()=>r(242422),n=()=>r(726637),a=()=>r(221844),o=()=>r(223116),i=()=>r(179034),d=()=>r(519831),l=()=>r(743246),c=()=>r(534177),m=()=>r(148832),u=()=>r(543665),p=()=>r(201718),g=()=>r(329304),h=()=>r(559506);async function b(e){const{environment:t,sudoModeStore:r,sidebarSpaceStore:a,targetPointer:i,isAlreadyLoaded:d,clearLoadedStore:l,buildStore:c,buildRequest:m}=e;if(n().A.isMobile||d||r.state.loading||r.state.error)return;await s().default.waitUntilStatsigReady();const u=a.isReady()&&a.canAdmin(),p=await function(e,t){return(0,g().Se)(e,{name:"sudo_mode",spaceId:t,userId:e.currentUser.id})}(t,a.id);if(!i.id||!u||!p)return;r.setState({...r.state,loading:!0}),l();const b=m(i),f=await h().callApi({eventName:"getPrivateRecordInfo",environment:t,data:b});if("failed"===f.type)return void r.setState({...r.state,loading:!1,error:f.error});const S=c({environment:t,recordId:i.id,privateRecordCacheName:o().Rb,ancestorData:f.data,spaceId:a.id});return r.setState({...r.state,loading:!1,error:void 0}),S}async function f(e){const{environment:t,sudoModeStore:r,pageBlockId:s,sidebarSpaceStore:n}=e,a=r.state.privatePageStore&&r.state.privatePageStore.id===s;if(!s||!n)return;const o=await b({environment:t,sudoModeStore:r,sidebarSpaceStore:n,targetPointer:{id:s,table:i().ev,spaceId:n.id},isAlreadyLoaded:Boolean(a),clearLoadedStore:()=>r.setState({...r.state,privatePageStore:void 0}),buildStore:e=>v({...e,recordTable:i().ev}),buildRequest:e=>({recordPointer:e})});o&&r.setState({...r.state,privatePageStore:o})}async function S(e){const{environment:t,sudoModeStore:r,workflowId:s,sidebarSpaceStore:n}=e,a=r.state.privateWorkflowStore&&r.state.privateWorkflowStore.id===s;if(!s||!n)return;const o=await b({environment:t,sudoModeStore:r,sidebarSpaceStore:n,targetPointer:{id:s,table:l().C0,spaceId:n.id},isAlreadyLoaded:Boolean(a),clearLoadedStore:()=>r.setState({...r.state,privateWorkflowStore:void 0}),buildStore:e=>v({...e,recordTable:l().C0}),buildRequest:e=>({recordPointer:e})});o&&r.setState({...r.state,privateWorkflowStore:o})}function v(e){const{environment:t,recordId:r,recordTable:s,privateRecordCacheName:n,ancestorData:o,spaceId:g}=e,h=new(a().A)({name:n});for(const a of o)switch(a.table){case"block":case"collection":case"workflow":case"team":h.setRecord({pointer:{spaceId:g,table:a.table,id:a.value.id},userId:t.currentUser.id},{role:"editor",value:a.value})}let b;return s===i().ev?b=new(m().B)(t,{id:r,table:i().ev},{inMemoryRecordCache:h}):s===d().Vl?b=new(u().m)(t,{id:r,table:d().Vl},{inMemoryRecordCache:h}):s===l().C0?b=new(p().N)(t,{id:r,table:l().C0,spaceId:g},{inMemoryRecordCache:h}):(0,c().HB)(s),b.inMemoryRecordCache.addCacheFallback(t.defaultRecordCache.inMemoryRecordCache),b}},944850:(e,t,r)=>{r.d(t,{d:()=>m});r(944114),r(898992),r(354520),r(672577),r(581454),r(908872);var s=()=>r(56366),n=()=>r(68263),a=()=>r(437607),o=()=>r(468006),i=()=>r(422366),d=()=>r(329443),l=()=>r(646736),c=()=>r(605402);function m(e){return(0,s().K8)((()=>{const t=(0,d().i0)(e),r=c().A.state.permissionGroupsAndMemberCounts.map((e=>e.group)),s=(0,i().U)(e),m=t.find((({permissionItem:e})=>n().FP(e))),u=t.find((({permissionItem:e})=>n().Lg(e))),p=s?t.find((({permissionItem:e})=>(0,o().O1)(e,s.id))):void 0,g=t.map((({permissionItem:e})=>e)).filter(n().gl),h=t.map((({permissionItem:e})=>e)).filter(n().nl),b=t.map((({permissionItem:e})=>e)).filter(n().Ds).reduce(((e,t)=>{const s=t.group_id,n=t.role,o=r.find((e=>e.group_id===s));if(o){const t={group_id:o.group_id,id:(0,a().gK)({spacePermissionGroupId:o.group_id,spaceId:o.space_id}),name:o.name,space_id:o.space_id,icon:o.icon,version:o.getVersion(),role:n};e.push(t)}return e}),[]),[f,S]=t.map((({permissionItem:e})=>e)).filter(n().B2).reduce(((t,r)=>{const s=(0,l().sE)(e.getSpaceStore(),r.user_id);return Boolean(s&&!s.isMember())?[t[0].concat(r),t[1]]:[t[0],t[1].concat(r)]}),[[],[]]);return{groupPermissions:b,mostPermissivePublicItem:m,spacePermission:u,teamPermission:p,teamSharePermissions:g,teamOwnerSharePermissions:h,guestUserPermissions:f,memberUserPermissions:S,botPermissions:t.map((({permissionItem:e})=>e)).filter((e=>(0,n().P3)(e)))}}),[e])}},991221:(e,t,r)=>{r.d(t,{T:()=>m});r(517642),r(658004),r(733853),r(845876),r(432475),r(515024),r(731698),r(898992),r(672577),r(803949);var s=r(296540),n=()=>r(56366),a=(r(354520),()=>r(534177)),o=()=>r(142748);var i=()=>r(68263),d=()=>r(569028),l=()=>r(605402),c=()=>r(646736);function m(){const e=(0,n().K8)((()=>{const e=new Set;l().A.state.permissionGroupsAndMemberCounts.forEach((t=>{e.add(t.group.group_id)}));return t=>e.has(t)}),[]);return(0,s.useCallback)((t=>{var r;const s=null===(r=t.getPermissionItems().find(i().Ny))||void 0===r?void 0:r.previous_permissions;return s?function({deletedPermissions:e,ancestorPath:t,userIsMember:r,permissionGroupExists:s}){var n;const i=null===(n=(0,o().vv)(t))||void 0===n?void 0:n.id;return e.filter((e=>{const t=e.type;switch(t){case"trusted_domain_permission":case"public_permission":case"deleted_permission":case"bot_permission":return!1;case"exclusive_user_permission":case"user_permission":return r(e.user_id);case"explicit_team_guest_permission":case"explicit_team_owner_permission":case"explicit_team_permission":return e.team_id===i;case"group_permission":return s(e.group_id);case"team_owner_permission":case"team_permission":case"restricted_permission":case"collection_property_permission":case"space_permission":case"space_owner_permission":return!0;default:(0,a().HB)(t)}}))}({deletedPermissions:s,ancestorPath:(0,d().E)(t),userIsMember:e=>{var r;return Boolean(null===(r=(0,c().sE)(t.getSpaceStore(),e))||void 0===r?void 0:r.isMember())},permissionGroupExists:e}):[]}),[e])}}}]);