"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[3476,97958],{3079:(e,t,o)=>{o.d(t,{H:()=>i});var n=o(296540),r=o(474848);const i=n.forwardRef((function(e,t){const{children:n,property:i,store:l}=e,a=(0,o(213828).y)({propertyId:i,store:l})||[];return(0,r.jsx)("div",{ref:t,className:a.length?a.join(" "):void 0,children:n})}))},27542:(e,t,o)=>{o.d(t,{n:()=>w});var n=o(296540),r=()=>o(726637),i=()=>o(484714),l=()=>o(56366),a=()=>o(401497),s=()=>o(718827),c=()=>o(252291),d=()=>o(493552),u=()=>o(898244),p=()=>o(416504),y=()=>o(989184),m=()=>o(69708),f=()=>o(284371),S=()=>o(733326),h=()=>o(859428),g=()=>o(405417),b=()=>o(148832),x=o(474848);const v=200,C=75,k=75;function w({blockStore:e,collectionContextStore:t,columnWidth:o}){const w=(0,i().v3)(),P=(0,l().O$)(t.currentSubitemFormatStoreForCollectionStore),I=(0,l().K8)((()=>e.getAssociatedCollectionStore()),[e]),j=(0,l().K8)((()=>{var e;return null===(e=t.collectionViewStore())||void 0===e?void 0:e.getType()}),[t]),_=(0,l().K8)((()=>{if(!P||!I)return;const e=I.getSchema()[P.property];return void 0!==e&&(0,u().nC)(e)?e:void 0}),[I,P]),R="table"===j||"list"===j||"timeline"===j,M=(0,m().tz)(),E=r().A.isMobile?C:v,B=(0,a().IS)((e=>({button:{height:20,display:"flex",alignItems:"center",gap:2,color:e.text.tertiary,borderRadius:6,padding:"0 6px"},parentTitle:{...R?{maxWidth:o?Math.min(E,o-k):E}:{},...f().RC}})),[o,R,E]),A=(0,l().K8)((()=>P&&_?(0,g().eO)({store:e,subitemFormat:P,propertySchema:_}):[]),[e,P,_]),T=(0,l().K8)((()=>{if(0===A.length)return;const t=A[0];return b().B.createChildStore(e,t)}),[e,A]),L=(0,l().K8)((()=>{var e;return null==T||null===(e=T.getModel())||void 0===e?void 0:e.getRenderTitleWithPlaceholder({getRecordModel:T.getRecordModel,userTimeZone:(0,p().P)(),intl:M})}),[T,M]),V=(0,l().K8)((()=>(0,g().xC)({collectionContextStore:t,blockStore:e})),[t,e]),F=(0,n.useCallback)((()=>(0,x.jsx)("div",{children:L})),[L]),W=(0,n.useCallback)((e=>(0,x.jsxs)(s().Ay,{ariaLabel:M.formatMessage({id:"parentItemIndicator.button.openParentSidePeek.ariaLabel",defaultMessage:"Open parent in side peek"}),onClick:()=>{T&&S().kB({relationPointers:A,relatedPageStore:T,environment:w,from:"relation_property",peekMode:"side_peek"})},style:B.button,...e,children:[(0,x.jsx)(c().I,{icon:y().Z,size:"sm",colorVariant:"secondary"}),(0,x.jsx)(d().D,{styleKey:"Body-sm/Medium",children:(0,x.jsx)("div",{style:B.parentTitle,children:L})})]})),[w,M,T,L,A,B.button,B.parentTitle]);return V&&T?(0,x.jsx)(h().A,{alignment:"start",delayThreshold:300,render:W,renderTooltip:F}):null}},32064:(e,t,o)=>{o.d(t,{p$:()=>T,Jd:()=>L,_R:()=>M,bZ:()=>V,VW:()=>A,K1:()=>E,e7:()=>R,de:()=>P,oN:()=>B,L$:()=>W,K2:()=>H,JJ:()=>_,cE:()=>F,Dd:()=>O});o(16280),o(898992),o(354520),o(430670),o(581454);var n=o(296540),r=()=>o(484714),i=()=>o(56366),l=()=>o(401497),a=()=>o(631524),s=()=>o(764880),c=()=>o(784892),d=()=>o(437607),u=()=>o(645873);const p=new(u().O2)("PropertyModulePersonProperty",(async()=>await Promise.all([o.e(55162),o.e(55753),o.e(28866),o.e(74562),o.e(47160),o.e(42056),o.e(76677),o.e(15517),o.e(94300),o.e(82120)]).then(o.bind(o,444823)))),y=(0,u()._h)(p,(e=>e.PersonPropertyModule));var m=()=>o(449412);const f={};function S(e){const{throttleSeconds:t,...o}=e,n=`${e.from}:${e.type}`,r=f[n],i=Date.now();(!r||i-r>1e3*t)&&(f[n]=i,function(e){const{error:t,...o}=e;(0,m().O8)(t,o)}(o))}var h=()=>o(802229),g=()=>o(971003),b=()=>o(795354),x=()=>o(153364),v=o(474848);function C({renderOrigin:e,actors:t,placement:n="bottom",alignment:i="start"}){const a=(0,r().WS)()||t.length<1,s=(0,l().IS)((()=>({scrollContainer:{maxHeight:"min(50vh, 300px)",overflowY:"auto"},listContainer:{display:"flex",flexDirection:"column",gap:6,paddingTop:6,paddingBottom:6},tooltip:{maxWidth:300,paddingTop:0,paddingBottom:0}})),[]);return(0,v.jsx)(o(859428).A,{placement:n,alignment:i,disableTooltip:a,render:e,style:s.tooltip,allowHover:!0,renderTooltip:e=>(0,v.jsx)("div",{...e,style:s.scrollContainer,children:(0,v.jsx)("div",{style:s.listContainer,children:t.map((e=>e instanceof o(870092).L?(0,v.jsx)(o(994006).A,{userStore:e,avatarSize:20,inline:!0,hasTooltip:!1,hasPersonHoverCard:!1},e.id):e instanceof o(258836).v?(0,v.jsx)(o(427636).A,{botStore:e,avatarSize:20},e.id):null))})})})}const k=n.memo(C);var w=()=>o(712354);const P=n.memo(n.forwardRef((function(e,t){const{buttonStyle:r,onContextMenu:i,editButtonClickProps:a,property:s,store:d,EmptyComponent:u,tokenFontSize:p,tokenLimit:y,quickActionButtons:m,width:f,formQuestionStore:S,collectionSchema:b,limitTokensToSingleTruncatedLine:x,userExpandable:C,generateButtonStyles:k}=e,{propertySchema:w,baseStyles:P,surface:_}=(0,n.useContext)(g().L8),R=(0,h().DZ)(d,s,w),M=(0,o(496645).Ug)(null==P?void 0:P.tokenFormat),E=j({store:d,property:s,propertySchema:w,surface:_}),B=0===E.length,A=(0,l().IS)((e=>({buttonStyle:{...P.buttonStyle,...r,...(null==k?void 0:k(e,B))||{}},buttonPressedStyle:P.buttonPressedStyle??{},buttonHoveredStyle:P.buttonHoveredStyle??{},tokensContainer:{...M===c().NY.Inline?{gap:0}:{},...x&&{display:"flex",...o(284371).RC}},token:{...p&&{fontSize:p}},actorTokenOverlap:{...M===c().NY.Inline?{margin:o(848401).vb[M].margin}:{}},moreToken:{margin:0,...x&&{flexShrink:0}}})),[P.buttonHoveredStyle,P.buttonPressedStyle,P.buttonStyle,r,B,x,k,M,p]);return B&&void 0===u?null:(0,v.jsx)(o(986621).P,{ref:t,editButtonClickProps:a,onContextMenu:i,style:A.buttonStyle,pressedStyle:A.buttonPressedStyle,hoveredStyle:A.buttonHoveredStyle,tooltipHide:M===c().NY.Inline,quickActionButtons:m,width:f,formQuestionStore:S,collectionSchema:b,userExpandable:C,children:B&&void 0!==u&&!R?(0,v.jsx)(u,{}):(0,v.jsx)(I,{values:E,tokenLimit:y,tokenFormat:M,styles:A,store:d,property:s,limitTokensToSingleTruncatedLine:x??!1,userExpandable:C})})})));function I({values:e,tokenLimit:t,tokenFormat:r,styles:c,store:u,property:p,limitTokensToSingleTruncatedLine:y,userExpandable:m}){const[f,S]=(0,n.useState)(!1),h=t&&e.length>t&&!f,g=e.slice(0,h?t:20),x=(0,n.useCallback)((e=>{e.preventDefault(),S(!0)}),[]),C=(0,n.useCallback)((e=>{e.preventDefault(),S(!1)}),[]),k=(0,i().K8)((()=>{if(u)return(0,o(299545).O3)(u,{includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===p))}),[u,p]),w=(0,o(358167).v)({blockId:null==u?void 0:u.id,propertyId:p}),P=k&&(null==k?void 0:k.length)>0||w,I=(0,l().IS)((e=>({personTokenStyle:{...c.token,...P?{marginInlineStart:3,marginInlineEnd:3,maxWidth:"fit-content",display:"inline-block"}:{}},wrapperStyle:{...c.tokensContainer,...P?{...(0,o(969842).sQ)(e.mode),paddingTop:9,paddingBottom:0,lineHeight:2,...y?{display:"flex"}:{flexWrap:"wrap",display:"inline"}}:{}},collapseIcon:{width:16,height:16,fill:e.text.secondary}})),[P,y,c.tokensContainer,c.token]),j=(0,o(213828).s)({propertyId:p,store:u});return(0,v.jsxs)(o(586295).h,{className:j,style:I.wrapperStyle,children:[g.map(((t,n)=>(0,o(201980).MMZ)(t)?(0,v.jsx)(o(877750).W,{templateVariableType:t},`person-property-value-${t}`):(0,s().Pu)(t)||(0,d().I6)(t)?(0,v.jsx)(o(729564).A,{actorOrGroupPointer:(0,d().I6)(t)?(0,d().S4)({spacePermissionGroupId:t.id,spaceId:t.spaceId}):t,style:{...n<e.length-1&&c.actorTokenOverlap,...I.personTokenStyle,...y&&{width:"100%",flexShrink:1}}},t.id):void 0)),h?m?(0,v.jsx)(a().p,{size:"xs",onClick:x,style:{marginInlineStart:10},children:(0,v.jsx)(b().A,{count:e.length-t,format:r,style:c.moreToken,fixedHeight:!0,isCompact:!0})}):(0,v.jsx)(b().A,{count:e.length-t,format:r,style:c.moreToken,fixedHeight:!0,isCompact:!0}):f?(0,v.jsx)(a().p,{size:"xs",onClick:C,style:{marginInlineStart:5},children:(0,o(430042).R)(I.collapseIcon)}):void 0]})}function j({property:e,store:t,propertySchema:n,surface:r}){return(0,i().K8)((()=>{const i=null==n?void 0:n.type;switch(i){case"created_by":{const e=t.getCreatedByPointer();if(e)return[e];break}case"last_edited_by":{const e=t.getLastEditedByPointer();if(e)return[e];break}case"person":{const i=t.isTemplate();return(0,o(156736).a)({value:t.getPropertyValue(e),isTemplatePage:i,propertySchema:n,blockCreatorPointer:i||(0,o(515872).J)(r)?void 0:t.getCreatedByPointer()})}case void 0:return[];default:(0,o(534177).HB)(i)}return[]}),[e,n,t,r])}const _=n.forwardRef((function(e,t){const{store:i,property:l}=e,{shouldWrap:a}=(0,n.useContext)(g().L8),s=(0,r().WS)(),c=(0,n.useMemo)((()=>(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(o(564883).qO,{store:i,property:l},"workflow-autofill"),(0,v.jsx)(x().k,{},"comment")]})),[l,i]),d=O(e,t);return(0,v.jsx)(P,{...d,EmptyComponent:w().rW,collectionStore:e.collectionStore,quickActionButtons:c,userExpandable:a,tokenFontSize:s?o(968021).hN:void 0})})),R=n.forwardRef((function(e,t){const o=O(e,t),r=(0,n.useMemo)((()=>(0,v.jsx)(x().k,{},"comment")),[]);return(0,v.jsx)(P,{...o,EmptyComponent:w().ao,collectionStore:e.collectionStore,quickActionButtons:r})})),M=n.forwardRef((function(e,t){var l;const a=O(e,t),c=(0,r().v3)(),{propertySchema:d}=(0,n.useContext)(g().L8),u=d,p=j({store:e.store,property:e.property,propertySchema:u,surface:e.surface}),y=(0,i().K8)((()=>{var t;const n=null===(t=e.store)||void 0===t?void 0:t.getRecordModel;return n?p.flatMap((e=>{if(!(0,s().Pu)(e))return[];const t=(0,s().xC)({pointer:e,getRecordModel:n});return t&&t.asActor?[o(842677).RecordStores.createUniqueRootStore(c,t.pointer)]:[]})):[]}),[c,p,null===(l=e.store)||void 0===l?void 0:l.getRecordModel]),m=(0,n.useMemo)((()=>(0,v.jsx)(x().k,{},"comment")),[]);return(0,v.jsx)(k,{actors:y,renderOrigin:e=>(0,v.jsx)("div",{...e,children:(0,v.jsx)(P,{...a,EmptyComponent:w().ao,tokenLimit:1,quickActionButtons:m,limitTokensToSingleTruncatedLine:!0})})})})),E=n.forwardRef((function(e,t){const o=O(e,t);return(0,v.jsx)(P,{...o,EmptyComponent:w().Fe,tokenLimit:1})})),B=n.forwardRef((function(e,t){const{store:r,property:i}=O(e,t),{propertySchema:l,propertyModule:a,surface:s}=(0,n.useContext)(g().L8),c=l,d=j({store:r,property:i,propertySchema:c,surface:s});return a&&(0,o(778781).E2)(a)?(0,v.jsx)(o(3079).H,{ref:t,store:r,property:i,children:(0,v.jsx)(y,{store:r,property:i,propertyValues:d,propertySchema:c,module:a,surface:e.surface})}):(S({from:"PropertyModulePersonProperty",type:"invalidModule",throttleSeconds:60,error:new Error("Expected to find a property_person module."),data:{blockId:r.id,propertyId:i,miscDataToConvertToString:{moduleType:null==a?void 0:a.type}}}),null)})),A=n.forwardRef((function(e,t){const n=O(e,t,(0,o(999943).F)(t,e.collectionStore,e.property,"person"));return(0,v.jsx)(P,{...n,EmptyComponent:e.showIfEmpty?w().Jb:void 0,tokenLimit:5,userExpandable:!0})})),T=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=O(e,t);return(0,v.jsx)(P,{...n,EmptyComponent:o?w().Jb:void 0})})),L=n.forwardRef((function(e,t){const o=O(e,t);return(0,v.jsx)(P,{...o})})),V=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=O(e,t);return(0,v.jsx)(P,{...n,EmptyComponent:o?w().Jb:void 0})})),F=n.forwardRef((function(e,t){const o=O(e,t);return(0,v.jsx)(P,{...o})})),W=n.forwardRef((function(e,t){const o=O(e,t);return(0,v.jsx)(P,{...o})})),H=n.forwardRef((function(e,t){const o=O(e,t);return(0,v.jsx)(P,{...o})}));function O(e,t,o){const{store:n,property:r,onContextMenu:i,width:l}=e;return{ref:t,store:n,property:r,editButtonClickProps:(0,h().QK)(e),onContextMenu:i,buttonStyle:null==o?void 0:o.buttonStyle,width:l}}},53528:(e,t,o)=>{o.d(t,{OH:()=>a,T2:()=>s,do:()=>c});var n=()=>o(597777),r=()=>o(869190),i=()=>o(604995),l=()=>o(416504);function a(e){const{dateTime:t,intl:o,shortenDateAndRange:n}=e,l=i().C6.toPersistedDate(t.valueOf());return r().ZF({value:l,allowRelativeDates:!0,intl:o,shortenDateAndRange:n,displayInUserTimezone:!0})}function s(e){const{dateTime:t,intl:o,userTimeZone:n,displayInUserTimezone:l,alwaysIncludeTimezone:a}=e,s=i().C6.toPersistedDateTime(t.valueOf(),t.zoneName);return r().ZF({value:s,allowRelativeDates:!0,intl:o,userTimeZone:n,displayInUserTimezone:l,alwaysIncludeTimezone:a})}function c(e){const{luxonRange:t,intl:o}=e,a=i().C6.toPersistedDateRange(t),s=r().ZF({value:a,allowRelativeDates:!1,shortenDateAndRange:!0,intl:o,displayInUserTimezone:!0}),c=t.end.setZone((0,l().P)()),d=r().fU({start_time:c.toFormat(n().GE),humanReadable:!1,intl:o});return o.formatMessage({id:"verification.timeRange",defaultMessage:"{formattedDateRange} at {formattedEndTime}"},{formattedDateRange:s,formattedEndTime:d})}},86499:(e,t,o)=>{o.d(t,{q:()=>i});var n=()=>o(645873);const r=new(n().O2)("RelationMenuRow",(async()=>{const{RelationMenuRow:e}=await Promise.all([o.e(75134),o.e(18766)]).then(o.bind(o,464125));return{RelationMenuRow:e}})),i=(0,n()._h)(r,(e=>e.RelationMenuRow))},97059:(e,t,o)=>{o.d(t,{s:()=>r});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"1.82 1.82 12.68 12.68",svg:(0,o(474848).jsx)("path",{d:"M8 1.825a.575.575 0 0 0-.575.575V4a.575.575 0 0 0 1.15 0V2.4A.575.575 0 0 0 8 1.825m4.367 1.809a.575.575 0 0 0-.814 0l-1.131 1.131a.575.575 0 1 0 .813.813l1.132-1.131a.575.575 0 0 0 0-.813m-7.92 0a.575.575 0 0 0-.813.813l1.13 1.131a.575.575 0 1 0 .814-.813zm3.248 3.071a.7.7 0 1 0-.99.99l.77.77.99-.99zm4.305.72a.575.575 0 0 0 0 1.15h1.6a.575.575 0 1 0 0-1.15zm-9.6 0a.575.575 0 1 0 0 1.15H4a.575.575 0 0 0 0-1.15zm11.895 5.88-5.37-5.37-.99.99 5.37 5.37a.7.7 0 0 0 .99-.99m-8.717-2.883a.575.575 0 0 0-.813 0l-1.131 1.131a.575.575 0 1 0 .813.813l1.131-1.131a.575.575 0 0 0 0-.813M8 11.425a.575.575 0 0 0-.575.575v1.6a.575.575 0 1 0 1.15 0V12A.575.575 0 0 0 8 11.425"})},r=(0,o(340498).wt)("magicWandSmall",n)},153364:(e,t,o)=>{o.d(t,{k:()=>S});o(898992),o(354520),o(908872);var n=o(296540),r=()=>o(484714),i=()=>o(56366),l=()=>o(575287),a=()=>o(69708),s=()=>o(534177),c=()=>o(182641),d=()=>o(254131),u=()=>o(116008),p=()=>o(285790),y=()=>o(971003),m=o(474848);const f=(0,a().YK)({comment_on_property:{defaultMessage:"Comment",id:"database.CommentButton.commentOnPropertyValue"},open_discussion:{defaultMessage:"Open discussion",id:"database.CommentButton.openDiscussion"}}),S=n.memo((function(e){const{style:t,showShadow:S}=e,h=(0,a().tz)(),g=(0,r().v3)(),{isMobile:b}=(0,r().Y0)(),{isEmptyStore:x,propertySchema:v,surface:C,collectionContextStore:k,property:w,store:P,disabled:I}=(0,n.useContext)(y().L8),j=(0,i().O$)(x),_=(0,i().K8)((()=>null==k?void 0:k.collectionStore()),[k]),R=(0,y().O2)({store:P,collectionStore:_,property:w,disabled:I,surface:C,propertySchema:v,collectionContextStore:k,writeStateType:"comment"}),M=(0,i().K8)((()=>o(372154).A.state.open),[]),E=(0,i().K8)((()=>{if(!w||!P)return 0;return(0,o(299545).O3)(P,{recursivelyLoadAllDiscussions:!1,includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===w&&(0,o(852353).q7)(e,h,P,w))).reduce(((e,t)=>{const o=t.getModel();return o?{comments:e.comments+(o.getComments()||[]).length}:e}),{comments:0}).comments}),[h,w,P]),B=E>99?"99+":`${E}`,A=(0,i().K8)((()=>{var e;return(0,s().O9)(P)&&u().A.state.open&&u().A.isPropertyComment()&&(null===(e=u().A.state)||void 0===e?void 0:e.blockId)===P.id&&u().A.getPropertyId()===w}),[w,P]),T=(0,i().K8)((()=>{if(!_)return!1;const e="compact_page"===C,t=_.canEditCollection();return!e||!t}),[_,C]),L=(0,n.useMemo)((()=>!(E<=0)&&function(e){switch(e){case"table":case"board":case"calendar":case"list":case"feed":case"gallery":case"timeline":case"mini":case"form_editor":case"form_viewer":return!1;case"property_module":case"page":case"compact_page":case"relation":case"relation_section":return!0;default:(0,s().HB)(e)}}(C)),[E,C]),V=(0,n.useMemo)((()=>E>0?h.formatMessage(f.open_discussion):h.formatMessage(f.comment_on_property)),[h,E]),F=(0,n.useCallback)((async()=>{w&&P&&(M?c().xl():P.isNavigableAncestorNonCommentableState()||(E>0?await c().B4({environment:g,blockStore:P,shouldFocusDiscussion:!0,analyticsFrom:"db_quick_action",recursivelyLoadAllDiscussions:!1,property_id:w,openFullPropertyDiscussionOnly:!0,intl:h}):A?o(555776).A.setActiveWithSource("popover_comments"):await(0,o(730307).l)({environment:g,blockStore:P,rect:o(57618).A.getRect(P,w),property_id:w})))}),[w,P,M,E,g,h,A]),W=(0,o(401497).IS)((e=>({icon:{width:16,height:16,color:e.text.secondary,fill:e.text.secondary},caption:{marginInlineStart:2,color:e.text.secondary},button:{...t,position:"relative",display:"flex"},iconButton:{minWidth:24,height:20,borderRadius:4,paddingInlineStart:3,paddingInlineEnd:3}})),[t]),H=(0,n.useCallback)((e=>(0,m.jsx)("div",{...e,style:W.button,children:E>0?(0,m.jsx)(p().A,{ariaLabel:V,hasBackground:!0,icon:e=>(0,m.jsxs)(m.Fragment,{children:[(0,l()._)(e),A?(0,m.jsx)(d().l,{color:"yellow",useOnPropertyComment:!0}):void 0]}),caption:(0,m.jsx)("span",{children:B}),showShadow:S,iconStyle:W.icon,captionStyle:W.caption,style:W.iconButton,onClick:F},`icon-btn-${E}`):(0,m.jsx)(p().A,{ariaLabel:V,hasBackground:!0,icon:e=>(0,m.jsxs)(m.Fragment,{children:[(0,l()._)(e),A?(0,m.jsx)(d().l,{color:"yellow",useOnPropertyComment:!0}):void 0]}),showShadow:S,iconStyle:W.icon,style:W.iconButton,onClick:F},`icon-btn-${E}`)})),[B,A,E,F,S,W.button,W.caption,W.icon,W.iconButton,V]),O=(0,n.useCallback)((()=>V),[V]);return!v||j||!T||L||b||!R||(0,o(898244).F_)(v.type)?null:(0,m.jsx)(o(859428).A,{renderTooltip:O,render:H})}))},163194:(e,t,o)=>{o.d(t,{A:()=>r});o(898992),o(672577);class n extends(()=>o(959180))().A{findRow(e,t,o){return this.find((n=>n.relatedPageStoreId===e&&n.rowType===t&&n.property===o))}}const r=new n},173019:(e,t,o)=>{o.d(t,{r:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("pencil",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M3.926 13.307H14.11c.183 0 .34-.066.472-.199a.644.644 0 00.198-.471.652.652 0 00-.198-.479.644.644 0 00-.472-.198H5.272l-1.346 1.347zm-.704-.636l7.683-7.684-1.312-1.319-7.69 7.684-.67 1.606c-.037.1-.017.191.06.273.083.082.174.105.274.069l1.655-.63zm8.34-8.326l.738-.732c.182-.187.278-.376.287-.567.009-.192-.068-.374-.232-.547l-.267-.267c-.169-.168-.351-.246-.547-.232-.196.014-.385.11-.567.287l-.739.732 1.327 1.326z"})})},175882:(e,t,o)=>{o.r(t),o.d(t,{exclamationMarkTriangleSmallIcon:()=>i,iconDefinition:()=>r});o(296540);var n=o(474848);const r={viewBox:"0 0 16 16",fittedViewBox:"1.49 1.87 13.01 11.75",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M7.9 5.281a.625.625 0 0 0-.625.625v2.5a.625.625 0 0 0 1.25 0v-2.5a.625.625 0 0 0-.625-.625m0 4.7a.725.725 0 1 0 0 1.45.725.725 0 0 0 0-1.45"}),(0,n.jsx)("path",{d:"M9.58 2.788c-.702-1.217-2.458-1.217-3.16 0l-4.677 8.1c-.702 1.216.176 2.737 1.58 2.737h9.354c1.405 0 2.283-1.52 1.58-2.738zm-2.078.625a.575.575 0 0 1 .996 0l4.677 8.1a.575.575 0 0 1-.498.862H3.324a.575.575 0 0 1-.498-.863z"})]})},i=(0,o(340498).wt)("exclamationMarkTriangleSmall",r)},176412:(e,t,o)=>{o.d(t,{L:()=>r});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"0.97 2.72 18.06 14.56",svg:(0,o(474848).jsx)("path",{d:"M3.893 2.875a.626.626 0 0 1 .79-.02l.091.088.128.148.015.033.072.105 11.27 13.148a.623.623 0 0 1-1.033.68l-1.616-1.884c-1.12.408-2.338.633-3.61.633-3.757 0-7.049-1.946-8.707-4.843l-.155-.283a1.46 1.46 0 0 1 0-1.359l.155-.283c.89-1.554 2.25-2.834 3.898-3.687L3.825 3.757l-.072-.105a.626.626 0 0 1 .14-.777M7.41 7.941a3.3 3.3 0 0 0-.717 2.056l.004.17A3.307 3.307 0 0 0 9.83 13.3l.17.004c.595 0 1.151-.161 1.634-.437l-1.52-1.773a1.104 1.104 0 0 1-1.18-1.377zM10 4.194c3.878 0 7.26 2.075 8.862 5.127l.074.164c.125.332.125.7 0 1.032l-.074.163a9.3 9.3 0 0 1-2.987 3.327l-2.69-3.138a3.3 3.3 0 0 0 .116-.702l.005-.17a3.31 3.31 0 0 0-3.136-3.303L10 6.691a3 3 0 0 0-.377.022L7.682 4.447A10.7 10.7 0 0 1 10 4.194"})},r=(0,o(340498).wt)("eyeSlashFill",n)},213828:(e,t,o)=>{o.d(t,{s:()=>l,y:()=>a});o(898992),o(354520),o(581454);var n=()=>o(56366),r=()=>o(451306),i=()=>o(299545);function l({store:e,propertyId:t}){const o=(0,n().K8)((()=>{var o;return e&&t?null===(o=(0,i().O3)(e,{includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===t)))||void 0===o||null===(o=o[0])||void 0===o?void 0:o.id:void 0}),[e,t]);return o?(0,r().wV)({discussionId:o}):void 0}function a({store:e,propertyId:t}){const o=(0,n().K8)((()=>e&&t?(0,i().O3)(e,{includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===t)).map((e=>e.id)):void 0),[e,t]);return o?o.map((e=>(0,r().wV)({discussionId:e}))):void 0}},289190:(e,t,o)=>{o.d(t,{m:()=>r});class n extends(()=>o(757695))().Store{getInitialState(){return{type:"uninitialized"}}isWriting(){return"filling"===this.state.type&&!this.state.haveAllBlocksCompletedAutofill&&!this.state.didInterruptStreaming}setIsWriting(e){const{propertySchema:t,stores:n,sessionIdForAnalytics:r,collectionId:i}=e,l=r||o(206267).JW();return this.setState({type:"filling",propertySchema:t,collectionId:i,numBlocksToAutofill:n.length,numBlocksAutofilled:0,sessionId:l,didInterruptStreaming:!1,haveAllBlocksCompletedAutofill:!1}),l}}const r=new n},346863:(e,t,o)=>{o.d(t,{A:()=>w});var n=o(296540),r=()=>o(726637),i=()=>o(484714),l=()=>o(56366),a=()=>o(401497),s=()=>o(929219),c=()=>o(898244),d=()=>o(97059),u=()=>o(662453),p=()=>o(68465),y=()=>o(972435),m=()=>o(747100),f=()=>o(289190),S=()=>o(411671),h=()=>o(90654),g=()=>o(468882),b=()=>o(543886),x=()=>o(405170),v=()=>o(971003),C=()=>o(527257),k=o(474848);function w(e){const{store:t,property:o,openOverlay:w}=e,I=(0,i().v3)(),{propertySchema:j,surface:_,collectionContextStore:R,isEmptyStore:M,canEdit:E}=(0,n.useContext)(v().L8),B=(0,l().O$)(M),A=(0,n.useCallback)((async()=>{if(!j)return;if(w){const e=(0,m().cq)(t)?x().A:b().A;h().ho({blockPropertyValueOverlayStore:e,collectionContextStore:R,surface:_,environment:I,store:t,property:o,readOnly:!0})}const e=f().m.setIsWriting({propertySchema:j,stores:[t],collectionId:t.getAssociatedCollectionId()}),{propertyCompletionsActions:n}=await u().aiDependency.load();n.autofillPropertyForBlocks({environment:I,stores:[t],property:o,propertySchema:j,userEventForAnalytics:"generate_from_action_button",collectionContextStore:R,sessionIdForAnalytics:e,from:g().zP(_)})}),[R,I,_,w,o,j,t]),T=(0,l().K8)((()=>E&&j&&(!r().A.isMobile||B)&&(0,p().ge)(S().A.getMode(I,t),t)&&(0,c().$M)(j)&&(0,c().om)(j)&&s().A.state.online),[I,E,B,j,t]),L=(0,a().IS)((e=>({iconStyle:{color:e.text.secondary,fill:e.text.secondary,width:16,height:16}})),[]);return T?(0,k.jsx)(C().A,{icon:d().s,tooltip:y().A.formatMessage(P.update),onClick:A,iconStyle:L.iconStyle,style:{height:20,width:24,borderRadius:4}}):null}const P=(0,o(69708).YK)({update:{defaultMessage:"Update",id:"database.editButton.autofillWithAiTooltip"}})},413987:(e,t,o)=>{o.d(t,{QE:()=>Ue,eH:()=>Qe,$s:()=>ze,iM:()=>Je,eM:()=>Ne,F1:()=>tt,hF:()=>De,bn:()=>Xe,I5:()=>Ye,$$:()=>Ze,Kr:()=>Ke,DE:()=>$e,Dd:()=>ot,Tn:()=>Ae,jD:()=>Be});o(944114),o(898992),o(354520),o(581454),o(737550);var n=o(296540),r=()=>o(484714),i=()=>o(852507),l=()=>o(56366),a=()=>o(401497),s=()=>o(718827),c=()=>o(898244),d=()=>o(713998),u=()=>o(784892),p=()=>o(969842),y=()=>o(496603),m=()=>o(899164),f=()=>o(231297),S=()=>o(939740),h=()=>o(89924),g=()=>o(859428),b=()=>o(68350),x=(o(908872),()=>o(726637)),v=()=>o(908006),C=()=>o(124092),k=()=>o(66689),w=()=>o(700500),P=()=>o(852424),I=()=>o(97889),j=()=>o(8741),_=o(474848);const R={viewBox:"0 0 16 16",fittedViewBox:"1.37 2.77 13.25 10.45",svg:(0,_.jsx)("path",{d:"M5.042 2.775c-.61 0-1.18.305-1.518.813L1.682 6.35c-.2.3-.307.652-.307 1.012V11.4c0 1.008.817 1.825 1.825 1.825h9.6a1.825 1.825 0 0 0 1.825-1.825V7.363c0-.36-.107-.712-.306-1.012l-1.843-2.763a1.83 1.83 0 0 0-1.518-.813zM4.564 4.28a.57.57 0 0 1 .478-.256h5.916c.192 0 .372.096.478.256l1.796 2.694H9.688a.625.625 0 0 0-.625.625v.38a1.063 1.063 0 0 1-2.125 0V7.6a.625.625 0 0 0-.625-.625H2.768zM8 10.293a2.313 2.313 0 0 0 2.3-2.068h3.075V11.4a.575.575 0 0 1-.575.575H3.2a.575.575 0 0 1-.575-.575V8.225H5.7A2.313 2.313 0 0 0 8 10.293"})},M=(0,o(340498).wt)("inboxSmall",R);var E=()=>o(207207),B=()=>o(617668),A=()=>o(73822),T=()=>o(179034),L=()=>o(201980),V=()=>o(69708),F=()=>o(284371),W=()=>o(970330),H=()=>o(314529);var O=()=>o(846156);var K=()=>o(557281),D=()=>o(176072),z=()=>o(44729),N=()=>o(384944),q=()=>o(899453),U=()=>o(733326),Q=()=>o(319975),J=()=>o(749804),$=()=>o(901444),Y=()=>o(895876),Z=()=>o(90654),G=()=>o(795354),X=()=>o(468882),ee=()=>o(86499),te=()=>o(645873);const oe=new(te().O2)("RelationPropertyCustomizeLayoutMenu",(async()=>{const{default:e}=await o.e(92222).then(o.bind(o,50651));return{RelationPropertyCustomizeLayoutMenu:e}})),ne=(0,te()._h)(oe,(e=>e.RelationPropertyCustomizeLayoutMenu));var re=()=>o(476492),ie=()=>o(594794),le=()=>o(478726),ae=()=>o(299545),se=()=>o(685889),ce=()=>o(671891),de=()=>o(163194),ue=()=>o(970585),pe=()=>o(148832),ye=()=>o(543665);function me(e){const t=(0,n.useContext)(o(908201).p2),i=(0,l().uB)(void 0,ue().A),a=(0,l().uB)(void 0,o(170253).A),[s,p]=(0,n.useState)(10),{schema:y,format:g,locked:w,property:P,collectionStore:I,store:j,disabled:R,visibility:M,isInPeekRenderer:E,topBorder:B,pagePropertiesStore:A,blockPropertyValueOverlayStore:L}=e,V=(0,r().v3)(),F=(0,l().K8)((()=>{const e=y[P];if(!e||"relation"!==e.type)return[];const t=j.getPropertyValue(P);return d().bG({relationValue:d().n(t),propertySchema:e,getRecordModel:j.getRecordModel,includeNoAccess:!0})}),[y,P,j],{useDeepEqual:!0}),W=F.length,K=(0,n.useCallback)(((e,t)=>function(e,t,o,n,r,i,l,a){const s=r[i];if(!s||"relation"!==s.type)return;const u=c().Nv(s);if(!u)return;const p=ye().m.createChildStore(l,u);if(!(0,ae()._p)(l)||!i)return;const y=l.getPropertyValue(i),m=d().n(y),f=[...e.map((e=>({id:e,spaceId:n.pointer.spaceId,table:T().ev}))),...m.slice(e.length)];xe({newValues:f,oldValues:m},p,l,i,o),(0,O().F)(o,{from:"relation_section"}),D().pl({store:a,focus:{section:0,indexLocal:t.endPosition,indexGlobal:t.endPosition,footerFocused:!1}})}(e,t,V,I,y,P,j,i)),[V,I,y,P,j,i]),z=(0,n.useCallback)(((o,n,r)=>ke({rowOffset:o,mode:n,originElement:r,environment:V,blockPropertyValueOverlayStore:e.blockPropertyValueOverlayStore,store:j,property:P,collectionContextStore:t,relationPropertyPageSectionRef:N})),[t,V,P,e.blockPropertyValueOverlayStore,j]),N=(0,n.useRef)(null),U=y[P],Q=(0,l().K8)((()=>null==t?void 0:t.permissionScopesStore.state),[t]),$=(0,l().K8)((()=>{if("relation"===(null==U?void 0:U.type)&&t)return U}),[t,U]),Y=(0,l().K8)((()=>{if(!$)return;const e=c().Nv($);return e?ye().m.createChildStore(j,e):void 0}),[$,j]),Z=(0,l().K8)((()=>(null==Y?void 0:Y.canEdit())??!1),[Y]),te=(0,l().K8)((()=>{const e=I.getSchema()[P];return Boolean(e&&c().UU(e))}),[I,P]),oe=(0,l().K8)((()=>j.canEdit()),[j]),ne=(0,l().K8)((()=>(0,le().fc)(j)),[j]),re=(0,n.useMemo)((()=>F.slice(0,s)),[F,s]),ie=(0,l().K8)((()=>(null==Y?void 0:Y.getFormatStore().getKeyStore("app_config_uri").getValue())===k().av),[Y]),se=1===(null==$?void 0:$.limit),de=!(x().A.isMobile||R||w||se),me=(0,ce().l)(j),be=(0,l().K8)((()=>{var e;return"hide"===(null==me||null===(e=me.getFormat())||void 0===e?void 0:e.property_icons_visibility)}),[me]),we=(0,n.useCallback)((()=>{Y&&$&&ke({rowOffset:!1,mode:void 0,originElement:void 0,environment:V,blockPropertyValueOverlayStore:L,store:j,property:P,collectionContextStore:t,relationPropertyPageSectionRef:N})}),[V,L,j,P,t,N,Y,$]),Pe=(0,l().K8)((()=>{if(!Y||!$||!I)return[];const e=Y.getFormatStore().getKeyStore("app_config_uri").getValue()===k().av;return re.reduce(((n,r,l)=>{const a=pe().B.createChildStore(j,r),d=a.getAssociatedCollectionStore(),u=!a.canRead();if((null==d?void 0:d.id)===c().zO($)||u){const r={key:a.id,render:({ref:n,...r})=>{const c=a.canEdit()?e=>{u||v().default.afterNextFlush((()=>{var e;const t=a.getBlockTitleStore();if(!t)return;const n=t.getValue(),r=n?(null===(e=n[0])||void 0===e||null===(e=e[0])||void 0===e?void 0:e.length)??0:0,i={start:{index:r,store:t},end:{index:r,store:t}};(0,o(692029).$)({environment:V,multiSelection:i,forceEmit:!0,focus:"end"}),v().default.afterNextFlush((()=>{const e=o(301421).n.findNodeFromStore(t);null==e||e.focus({preventScroll:!0})}))}))}:void 0;return(0,_.jsx)(ee().q,{...r,canDrag:de&&1!==$.limit&&j.canEdit(),schema:y,propertySchema:$,collectionStore:I,collectionId:I.id,targetCollectionStore:Y,relatedPageStore:a,disabled:R,locked:w,isSelected:!0,pageStore:j,property:P,rowType:"section",onActionButtonClick:()=>function(e,t,o,n,r,i,l,a,s,c){const d=i[l];if("relation"!==(null==d?void 0:d.type)||!c)return;if((0,le().fc)(r))return;const u=d.limit,p=u?[]:e.filter((e=>e.id!==t.id));f().createAndCommit({userAction:"RelationSection.handleRemoveRelationClick",environment:n,canUndo:!0,perform:e=>{m().Iq({store:r,propertyId:l,value:p,environment:n,relatedPageId:t.id,propertySchema:d,transaction:e,collectionContextStore:c,analyticsData:{isFromBulkActionsToolbar:X().pi(a),analyticsFrom:X().zP("page")},isUnthrottled:!1})}}),function(e,t){(0,H().DO_NOT_USE_trackLegacy)(e,"relation_remove_block",t)}(n,{from:"relation_section",collection_id:null==s?void 0:s.id,target_collection_id:null==o?void 0:o.id})}(F,a,Y,V,j,y,P,L,I,t),onMouseLeave:()=>i.unsetFocus(),onSecondaryButtonClick:()=>Ce(l+1,Y,"relation_section_inline",V,j,P,I,s,p,t,$),onInsertInline:e?()=>{(0,J().I)({environment:V})}:()=>Ce(l+1,Y,"relation_section_inline",V,j,P,I,s,p,t,$),onTitleEsc:()=>{var e;!Boolean(null===(e=a.getTitleStore())||void 0===e||null===(e=e.getValue())||void 0===e?void 0:e.length)&&"relation"===$.type?function(e){const{relatedPageStore:t,environment:o,store:n,property:r}=e;if((0,le().fc)(n))return;f().createAndCommit({userAction:"RelationSection.handleDeleteRelatedPage",environment:o,canUndo:!0,perform:e=>{const i={pointer:t.pointer,command:"update",path:[],args:{alive:!1}};f().applyOperation({store:t,operation:i,transaction:e}),q().zB({environment:o,store:n,propertyId:r,id:t.id,transaction:e})}})}({relatedPageStore:a,environment:V,store:j,property:P}):(0,J().I)({environment:V})},onEditButtonClick:c,index:l+1,propertyLimit:$.limit,collectionViewStore:null==t?void 0:t.collectionViewStore()})},action:e=>{}};n.push(r)}return n}),[])}),[Y,$,I,re,j,de,y,R,w,P,F,V,L,t,i,s]),Ie=(0,n.useCallback)((()=>{Y&&$&&Z&&Ce(F.length>=s?s:F.length+1,Y,"relation_section_footer",V,j,P,I,s,p,t,$)}),[Y,$,Z,F.length,s,V,j,P,I,t]);if(!("section_hide"!==M&&$&&Y&&t&&Q))return null;if("minimal"===M)return(0,_.jsx)(he,{property:P,propertySchema:$,numberOfRelations:W,onHandleOpenProperty:z,onHandleRelationPropertyPageSectionRefMount:e=>{e&&(N.current=e)},schema:y,format:g,disabled:R,locked:w,canConfigureCollection:Q.canConfigureCollection,blockStore:j,collectionStore:I,collectionContextStore:t,isInPeekRenderer:E,targetCollectionStore:Y,pagePropertiesStore:A,shouldHideIcon:be});const je=Pe.map((e=>e.key.toString())),_e=(0,_.jsx)(S().Ay,{type:S().Oh.Vertical,store:i,initialFocus:void 0,disableKeyboard:!0,style:{width:"100%"},sections:[{key:"section",render:e=>(0,_.jsx)(h().A,{...e,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,children:de?(0,_.jsx)(o(439264).Ay,{direction:"vertical",keys:je,renderKey:t=>e.children[je.indexOf(t)],onDrop:K,store:a}):e.children}),items:Pe}]});return(0,_.jsx)(ge,{collectionContextStore:t,isConnectedRelation:te,relationValuesCount:F.length,title:e.propertyRowName??(0,_.jsx)(b().I,{schema:y,format:g,property:P,blockStore:j,collectionStore:I,disabled:R,locked:w,canConfigureCollection:Q.canConfigureCollection,styleVariants:Se,isInPeekRenderer:E,pagePropertiesStore:A,hideIcon:be}),collectionStore:I,targetCollectionStore:Y,property:P,showRight:!0,disabled:R,schema:y,format:g,locked:w,canEditTargetCollection:Z,canConfigureCollection:Q.canConfigureCollection,canEditCurrentPage:oe,handleMouseMove:e.handleMouseMove,onHandleOpenPropertyQuickAdd:Ie,onHandleOpenProperty:()=>{ke({rowOffset:!1,mode:void 0,originElement:void 0,environment:V,blockPropertyValueOverlayStore:L,store:j,property:P,collectionContextStore:t,relationPropertyPageSectionRef:N})},onHandleRelationPropertyPageSectionRefMount:e=>{e&&(N.current=e)},onTitleEnter:()=>Ce(void 0,Y,"relation_section_inline",V,j,P,I,s,p,t,$),handleClearProperty:()=>ve(Y,j,P,F,V),topBorder:B,children:(0,_.jsxs)("div",{style:{flex:1,minWidth:0,display:"flex",flexWrap:"wrap",flexDirection:"column",width:"100%",...x().A.isMobile&&{paddingLeft:"none"}},onMouseMove:e.handleMouseMove,onMouseLeave:e.handleMouseLeave,children:[_e,F.length>s?(0,_.jsx)(C().p,{style:{width:"100%",display:"flex",alignItems:"center",borderRadius:3,fontSize:14,minHeight:30,margin:0,paddingTop:6,paddingInlineEnd:8,paddingBottom:7,paddingInlineStart:8},onClick:()=>p(s+10),children:(0,_.jsx)(G().A,{count:F.length-s,format:u().NY.Medium,style:{margin:void 0},fixedHeight:!1,isCompact:!1})}):void 0,!oe||w||ne?void 0:(0,_.jsx)(o(699143).Y1,{direction:"horizontal",style:{marginInlineStart:-4},children:(0,_.jsx)(fe,{canCreateRelatedPageInTarget:Z,disabled:R,locked:w,numberOfRelations:W,isRelationToTypedSprintsDB:ie,relationPropertySchema:$,onQuickAddButtonClick:Ie,handleAddExistingClicked:we,handleClearProperty:()=>ve(Y,j,P,F,V)})})]})},P)}function fe(e){const{canCreateRelatedPageInTarget:t,disabled:o,locked:n,numberOfRelations:r,isRelationToTypedSprintsDB:i,relationPropertySchema:l,onQuickAddButtonClick:a,handleAddExistingClicked:s,handleClearProperty:d}=e,u=c().UU(l),p=1===l.limit||i||u,y=!u&&!i&&t&&(!p||0===r),m=p&&r>0,f={colorPalette:"gray",colorVariant:"tertiary",size:"lg",disabled:o||n};return(0,_.jsxs)(_.Fragment,{children:[y?(0,_.jsx)(C().p,{iconLeading:{icon:A().plusFillIcon,colorVariant:"tertiary",size:"sm"},onClick:a,...f,children:(0,_.jsx)(V().sA,{id:"RelationPropertyPageSection.button.addNewPage",defaultMessage:"Add new"})}):void 0,i&&r>0?(0,_.jsx)(C().p,{iconLeading:{icon:M,weight:"bold",colorVariant:"tertiary",size:"sm"},onClick:d,...f,children:(0,_.jsx)(V().sA,{id:"RelationPropertyPageSection.button.replacePageSprint",defaultMessage:"Move to backlog"})}):void 0,(0,_.jsx)(C().p,{iconLeading:{icon:m?I().C:j().arrowDiagonalUpRightSmallIcon,weight:"bold",colorVariant:"tertiary",size:"sm"},onClick:s,...f,children:m?(0,_.jsx)(V().sA,{id:"database.findOrCreatePage.replace",defaultMessage:"Replace"}):i?(0,_.jsx)(V().sA,{id:"database.findOrCreatePage.sprint",defaultMessage:"Link sprint"}):(0,_.jsx)(V().sA,{id:"database.findOrCreatePage",defaultMessage:"Link existing"})})]})}const Se={width:{variant:"hug-content"},height:{variant:"small"},fontWeight:"medium",size:"small"};function he(e){const{property:t,propertySchema:o,numberOfRelations:r,schema:i,format:c,disabled:d,locked:u,canConfigureCollection:p,blockStore:y,collectionStore:m,onHandleOpenProperty:f,onHandleRelationPropertyPageSectionRefMount:S,isInPeekRenderer:h,targetCollectionStore:g,pagePropertiesStore:x,shouldHideIcon:v}=e,C=(0,a().IS)((e=>({hoverButton:{display:"flex",alignItems:"baseline",justifyContent:"normal",color:e.text.secondary,width:"100%"},minimalButton:{display:"flex",alignItems:"center",flexShrink:0,whiteSpace:"nowrap",height:28,borderRadius:4,fontSize:14,lineHeight:1.2,minWidth:0,paddingInlineStart:6,paddingInlineEnd:8,fontWeight:F().Wy.regular,color:e.text.tertiary},minimalButtonWrapper:{width:"100%",maxWidth:"100%",fontWeight:F().Wy.regular,color:e.text.tertiary},iconStyle:{width:14,height:14,fill:e.icon.tertiary,marginInlineEnd:6,alignItems:"baseline"},minmalButtonLabelStyle:{...F().RC}})),[]),w=(0,a().DP)(),I=(0,n.useCallback)((e=>{d||u||!p||(e.preventDefault(),x.setState({...x.state,openProperty:{property:t,isInPeekRenderer:h}}))}),[d,u,p,x,t,h]),j=(0,n.useCallback)((e=>{f(!0)}),[f]),R=(0,n.useMemo)((()=>({size:"medium",fontWeight:"regular",width:{variant:"hug-content",maxWidthDesktop:300,maxWidthMobile:300}})),[]),M=(0,n.useCallback)((()=>{x.setState({...x.state,hoveredProperty:t})}),[t,x]),E=(0,n.useCallback)((()=>{x.setState({...x.state,hoveredProperty:void 0})}),[x]),B=(0,l().K8)((()=>g.getFormatStore().getKeyStore("app_config_uri").getValue()),[g]),A=(0,Y().$O)(k().av),T=(0,Y().oj)(k().av);return(0,_.jsx)("div",{style:C.hoverButton,onMouseMove:M,onMouseLeave:E,children:(0,_.jsx)(b().I,{schema:i,format:c,property:t,blockStore:y,collectionStore:m,disabled:d,locked:u,canConfigureCollection:p,styleVariants:R,pagePropertiesStore:x,labelComponent:(0,_.jsx)("div",{ref:S,style:C.minimalButtonWrapper,children:(0,_.jsxs)(s().Ay,{style:C.minimalButton,onClick:j,onContextMenu:I,children:[(0,_.jsx)(P().zB,{size:14,style:C.iconStyle,theme:w,type:o.type??"relation",icon:o.icon}),(0,_.jsx)("div",{style:C.minmalButtonLabelStyle,children:B===k().av?(0,_.jsx)(V().sA,{id:"RelationPropertyPageSection.sprints.showSprintRelations",defaultMessage:"{numberOfRelations, plural, =0 {Add {propertyName}} one {1 {singleTypedItemName}} other {{numberOfRelations} {pluralTypedItemName}}}",values:{numberOfRelations:r,propertyName:o.name,singleTypedItemName:A,pluralTypedItemName:T}}):(0,_.jsx)(V().sA,{id:"RelationPropertyPageSection.showRelations",defaultMessage:"{numberOfRelations, plural, =0 {Add {propertyName}} one {1 {propertyName}} other {{numberOfRelations} {propertyName}}}",values:{numberOfRelations:r,propertyName:o.name}})})]},`minimal-section-${t}`)}),hideDragHandle:!0,isInPeekRenderer:h,hideIcon:v})})}function ge(e){const{collectionStore:t,targetCollectionStore:o,property:i,showRight:a,disabled:s,style:d,children:u,canConfigureCollection:p,isConnectedRelation:y,canEditCurrentPage:m,handleMouseMove:f,onHandleOpenProperty:S,onHandleRelationPropertyPageSectionRefMount:g,topBorder:b,collectionContextStore:v,onHandleOpenPropertyQuickAdd:C,canEditTargetCollection:w,relationValuesCount:P}=e,I=(0,l().K8)((()=>o.isSyncedCollection()),[o]),j=(0,l().K8)((()=>o.getFormatStore().getKeyStore("app_config_uri").getValue()===k().av),[o]),R=(0,l().K8)((()=>t.getSchema()[i]),[t,i]),M=(0,l().K8)((()=>v.permissionScopesStore.state.isExternallyImportedAndSyncedCollection),[v.permissionScopesStore]),{isPhone:A}=(0,r().Y0)(),[T,L]=(0,n.useState)(!1),F=x().A.isMobile?a:a&&T,W=m&&!j&&w&&R&&c().nC(R)&&(1!==R.limit||0===P);return(0,_.jsx)("div",{style:{width:"100%"},ref:g,onMouseEnter:()=>L(!0),onMouseLeave:()=>L(!1),children:(0,_.jsx)(h().A,{...e,topBorder:b,children:u,noTextOverflow:!1,disableMobilePadding:!0,right:F&&!I&&!M&&!y&&(0,_.jsxs)("div",{style:{height:"100%",display:"flex",alignItems:"center",width:"100%"},children:[W?(0,_.jsx)(be,{disabled:s,handleMouseMove:f,onClick:C,icon:{icon:B().plusIcon,weight:"bold",colorVariant:"secondary"},tooltipMessage:(0,_.jsx)(V().sA,{id:"database.RelationPropertyPageSectionHeaderButton.tooltip.quickAdd.message",defaultMessage:"Create new page"})},`quickAddIcon-${i}`):void 0,m?(0,_.jsx)(be,{disabled:s,handleMouseMove:f,onClick:S,icon:{icon:E().J,weight:"bold",colorVariant:"secondary"},tooltipMessage:j?(0,_.jsx)(V().sA,{id:"database.RelationPropertyPageSectionHeaderButton.tooltip.searchButtonSprints.message",defaultMessage:"Search for a sprint"}):(0,_.jsx)(V().sA,{id:"database.RelationPropertyPageSectionHeaderButton.tooltip.searchButton.message",defaultMessage:"Link a page"})},`searchIcon-${i}`):void 0,A?void 0:(0,_.jsx)(ne,{collectionStore:t,targetCollectionStore:o,property:i,disabled:s||!p,rowType:"section",surface:"property_module"})]}),style:{padding:0,width:"100%",...d},mobileStyle:{boxShadow:"none"},desktopTitleStyle:{marginTop:0,marginBottom:4,paddingInlineStart:0,paddingInlineEnd:8,fontWeight:"normal"},mobileTitleStyle:{paddingInlineStart:0,paddingInlineEnd:4,alignItems:"center",fontWeight:"normal"}})})}function be(e){const{disabled:t,handleMouseMove:o,onClick:n,icon:r,tooltipMessage:i}=e,l=(0,a().IS)((e=>({buttonStyle:{width:24,height:24,borderRadius:4,display:"inline-flex",alignItems:"center",justifyContent:"center",marginInlineEnd:2},iconStyle:{width:16,height:16,flexGrow:0,flexShrink:0,fill:e.icon.secondary}})),[]);return(0,_.jsx)(g().A,{renderTooltip:()=>i,render:e=>(0,_.jsx)(C().p,{iconLeading:{...r,style:l.iconStyle},style:l.buttonStyle,onMouseMove:o,onClick:n,disabled:t,...e})})}function xe(e,t,o,n,r){if(!(0,ae()._p)(o)||!n)return;let i;f().createAndCommit({userAction:"RelationToken.handleRelationPropertyMenuUpdate",environment:r,canUndo:!0,perform:l=>{const a=t.id;if(e.newPage&&a){const a=L().x9d(e.newPage.name);i=N().Wv({environment:r,id:e.newPage.id,type:w().xd.page,properties:{title:a},spaceId:e.newPage.spaceId,inMemoryRecordCache:t.inMemoryRecordCache,transaction:l}),z().X$({childStore:i,parentStore:t,transaction:l});const s=pe().B.createChildStore(o,i.pointer),c=t.getDefaultTemplatePageStore();return c&&K().n5({title:{text:a},environment:r,store:s,templateStore:c,isKeyboard:!1,isCreateIn:!1,transaction:l,from:"relation_property_page_section"}),void q().K6({store:o,propertyId:n,id:i.id,environment:r,transaction:l,position:{type:"after"}})}if(e.newValues){const t=d().Ap(e.newValues),i=o.getPropertyStore(n);Q().R9({environment:r,store:i,value:t,transaction:l})}}});const l=o.getCollectionStoreIfSingleSource();if(l){const o=l.getSchema()[n];o&&c().nC(o)&&U().id({sourcePropertySchema:o,sourcePropertyId:n,sourceCollectionPointer:l.pointer,relatedCollectionStore:t,newRelationValues:e.newValues,oldRelationValues:e.oldValues,environment:r})}v().default.afterNextFlush((()=>{if(!i)return;const e=de().A.findRow(i.id,"section",n);if(!e)return;const t=e.relationTokenBlockStoreRef.current;if(!t)return;const o=t.getBlockTitleStore(),r={start:{index:0,store:o},end:{index:0,store:o}};(0,$().setMultiSelection)({multiSelection:r})}))}function ve(e,t,o,n,r){xe({newValues:[],oldValues:n},e,t,o,r)}function Ce(e,t,o,n,r,i,l,a,s,c,u){if(!u||"relation"!==u.type)return;if(!r.canEdit())return;if((0,le().fc)(r))return;const p=l.pointer.spaceId,y=u.limit,m=(0,ie().zP)({environment:n,table:T().ev,spaceId:p}),f=m.id;if(!(0,ae()._p)(r)||!i)return;const S=r.getPropertyValue(i),h=d().n(S);e&&e+1>a&&s(e+1);xe({newPage:{id:f,spaceId:p,name:""},newValues:y?[m]:e?[...h.slice(0,e),m,...h.slice(e)]:[m,...h],oldValues:h},t,r,i,n),W().vH(n,{...(0,re().sl)(c),from:o,type:"page",target_collection_id:null==t?void 0:t.id,new_page_id:f,creating_block_id:f})}function ke(e){const{rowOffset:t,mode:o,originElement:n,environment:r,blockPropertyValueOverlayStore:i,store:l,property:a,collectionContextStore:s,relationPropertyPageSectionRef:c}=e,d=c.current;if(!(d&&d instanceof Element))return;if((0,le().fc)(l))return;const u=n?null==n?void 0:n.getBoundingClientRect():d.getBoundingClientRect(),p=t?u.top+se().d0:u.top+5,y=new DOMRect(u.left,p,u.width,u.height);Z().ho({environment:r,blockPropertyValueOverlayStore:i,store:l,property:a,rect:y,surface:"page",mode:o,collectionContextStore:s}),function(e,t){(0,H().DO_NOT_USE_trackLegacy)(e,"relation_section_link_pages",t)}(r,{from:"relation_section"})}var we=()=>o(124954),Pe=()=>o(279620),Ie=()=>o(571468),je=()=>o(802229),_e=()=>o(971003),Re=()=>o(712354),Me=()=>o(340072),Ee=()=>o(586295);function Be(e){const{store:t,property:o,propertySchema:n}=e;return(0,l().K8)((()=>{const e=t.getPropertyValue(o);return n?d().bG({relationValue:d().n(e),propertySchema:n,getRecordModel:t.getRecordModel,includeNoAccess:!0}):void 0}),[t,o,n],{useDeepEqual:!0})}function Ae(e){const{store:t,relationValue:o,propertySchema:n}=e;return(0,l().K8)((()=>{const e=null!=n&&n.limit&&o?o.slice(0,n.limit):o;if(!e)return[];const r=e.map((e=>{const o=pe().B.createChildStore(t,e);if(!(0,Ie().X)(o))return{pointer:e,pageStore:o}}));return(0,y().oE)(r)}),[n,o,t],{useDeepEqual:!0})}const Te=n.memo((0,n.forwardRef)((function(e,t){const{collectionStore:r,buttonStyle:i,editButtonClickProps:s,property:d,locked:u,EmptyComponent:p,onContextMenu:y,blockPropertyValueOverlayStore:m,store:f,surface:S,renderAs:h,quickActionButtons:g,width:b,formQuestionStore:x,userExpandable:v,inlineLimit:C}=e,{propertySchema:k,canEdit:w,baseStyles:P,collectionContextStore:I}=(0,n.useContext)(_e().L8),j=k,R=(0,o(496645).Ug)(null==P?void 0:P.tokenFormat),M=(0,l().uB)(void 0,ue().A),E=Be({store:f,propertySchema:j,property:d}),B=(0,o(358167).v)({blockId:null==f?void 0:f.id,propertyId:d}),A=(0,o(213828).s)({propertyId:d,store:f}),T=Boolean(A),L=(0,n.useMemo)((()=>{const e=j?c().Nv(j):void 0;return e?ye().m.createChildStore(f,e):void 0}),[j,f]),V=Ae({store:f,propertySchema:j,relationValue:E}),F=0===V.length,W="rows"===h&&!F,H=(0,a().IS)((e=>({buttonStyle:{...P.buttonStyle,...i,...W&&{padding:0}},buttonPressedStyle:P.buttonPressedStyle??{},buttonHoveredStyle:P.buttonHoveredStyle??{},relationItemsWrapper:{width:"100%"}})),[P.buttonHoveredStyle,P.buttonPressedStyle,P.buttonStyle,i,W]),O=(0,n.useMemo)((()=>L?"rows"===h?j&&E&&(0,_.jsx)(Le,{relationItemPointers:V,relationValue:E,collectionStore:r,menuListStore:M,store:f,targetCollectionStore:L,property:d,disabled:!w,buttonContainerRef:t,blockPropertyValueOverlayStore:m,surface:S,propertySchema:j,collectionContextStore:I}):"inline"===h?(0,_.jsx)(Ve,{relationItemPointers:V,store:f,tokenFormat:R,hasUnresolvedDiscussion:T,hasDraftComment:B,limit:C??10}):"singleWithOverflow"===h?(0,_.jsx)(Fe,{relationItemPointers:V,store:f,tokenFormat:R,hasUnresolvedDiscussion:T,hasDraftComment:B,buttonContainerRef:t,blockPropertyValueOverlayStore:m,property:d,surface:S,collectionContextStore:I,canEdit:w,isLocked:u}):void(0,o(534177).HB)(h):null),[L,h,j,E,V,r,M,f,d,w,t,m,S,I,R,T,B,u,C]),K=n.useCallback((e=>O||["property_module","page"].includes(S)?(0,_.jsx)("div",{style:H.relationItemsWrapper,className:A,children:e.children}):(0,_.jsx)(_.Fragment,{children:e.children})),[A,S,O,H.relationItemsWrapper]);return F&&void 0===p?null:(0,_.jsx)(o(986621).P,{ref:t,editButtonClickProps:W?void 0:s,forceEnableButton:"singleWithOverflow"===h&&!u,onContextMenu:y,style:H.buttonStyle,hoveredStyle:H.buttonHoveredStyle,pressedStyle:H.buttonPressedStyle,quickActionButtons:g,width:b,formQuestionStore:x,userExpandable:v,children:(0,_.jsx)(K,{children:F&&void 0!==p?(0,_.jsx)(p,{}):O})})})));function Le(e){const{collectionStore:t,targetCollectionStore:o,relationItemPointers:i,relationValue:c,property:d,store:p,disabled:y,menuListStore:g,buttonContainerRef:b,blockPropertyValueOverlayStore:x,surface:v,propertySchema:C,collectionContextStore:k}=e,w=(0,r().v3)(),{collectionSchemaStore:P}=(0,n.useContext)(_e().L8),I=(0,l().O$)(P),j=(0,l().K8)((()=>null==k?void 0:k.collectionViewStore()),[k]),R=(0,n.useCallback)(((e,t)=>{Z().ho({environment:w,blockPropertyValueOverlayStore:x,store:p,property:d,rect:null==t?void 0:t.getBoundingClientRect(),surface:v,mode:e,collectionContextStore:k})}),[x,k,w,v,d,p]),M=(0,n.useCallback)(((e,t)=>{if(!k)return;const o=e.filter((e=>e.id!==t.id));f().createAndCommit({userAction:"RelationBlockPropertyValue.handleRemoveRelationClick",environment:w,canUndo:!0,perform:e=>{m().Iq({store:p,propertyId:d,value:o,environment:w,relatedPageId:t.id,propertySchema:C,transaction:e,collectionContextStore:k,analyticsData:{isFromBulkActionsToolbar:X().pi(x),analyticsFrom:X().zP(v)},isUnthrottled:!1})}})}),[x,k,w,v,d,C,p]),E=(0,a().IS)((()=>({moreMenuItem:{width:"100%",display:"flex",alignItems:"center",justifyItems:"center",borderRadius:4,fontSize:14,minHeight:32,margin:0,padding:"6px 8px"},moreMenuItemLabel:{lineHeight:"normal",margin:0}})),[]);if(!I)return null;const B=i.slice(0,5).map((({pageStore:e},n)=>({key:e.id,render:({ref:r,...i})=>(0,_.jsx)(ee().q,{...i,canDrag:!1,collectionStore:t,collectionId:t.id,schema:I,propertySchema:C,targetCollectionStore:o,relatedPageStore:e,disabled:y,isSelected:!0,pageStore:p,property:d,rowType:"inline",onActionButtonClick:()=>{M(c,e)},onMouseLeave:()=>g.unsetFocus(),onSecondaryButtonClick:e=>{R({type:"view",index:n+1},e)},collectionViewStore:j}),action:()=>{}})));return i.length>5&&B.push({key:"add",render:e=>(0,_.jsx)(s().Ay,{...e,style:E.moreMenuItem,onClick:e=>R({type:"view"},b&&"current"in b?b.current:void 0),children:(0,_.jsx)(G().A,{style:E.moreMenuItemLabel,count:i.length-5,format:u().NY.Medium,fixedHeight:!1,isCompact:!1})}),action:()=>{R({type:"add",index:c.length},void 0)}}),(0,_.jsx)(S().Ay,{type:S().Oh.Vertical,store:g,initialFocus:void 0,disableKeyboard:!0,style:{width:"100%"},sections:[{key:"results",render:e=>(0,_.jsx)(h().A,{...e,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,children:e.children}),items:B}]})}function Ve(e){const{relationItemPointers:t,store:o,tokenFormat:n,hasUnresolvedDiscussion:r,hasDraftComment:i,limit:l}=e;return(0,_.jsx)(He,{limit:l,store:o,linkify:"whenReadOnly",relationItemPointers:t,tokenFormat:n,hasUnresolvedDiscussion:r,hasDraftComment:i,wrapTokens:!0})}function Fe(e){const{relationItemPointers:t,store:o,tokenFormat:i,hasUnresolvedDiscussion:l,hasDraftComment:c,buttonContainerRef:d,blockPropertyValueOverlayStore:u,property:p,surface:y,collectionContextStore:m,canEdit:f,isLocked:S}=e,h=(0,a().IS)((()=>({relationTokenStyle:{overflow:"hidden",width:"100%"}})),[]),g=(0,r().v3)(),b=(0,n.useCallback)((()=>{var e;Z().ho({environment:g,blockPropertyValueOverlayStore:u,store:o,property:p,rect:null===(e=d&&"current"in d?d.current:void 0)||void 0===e?void 0:e.getBoundingClientRect(),surface:y,mode:{type:"view",index:0},collectionContextStore:m})}),[u,d,m,g,y,p,o]),x=(0,_.jsx)(He,{relationTokenStyle:h.relationTokenStyle,limit:1,store:o,linkify:"never",relationItemPointers:t,tokenFormat:i,hasUnresolvedDiscussion:l,hasDraftComment:c,wrapTokens:!1});return f&&!S?(0,_.jsx)(s().Ay,{...e,ignoreLocalHoverState:!0,onClick:b,children:x}):x}function We({pageStore:e}){const t=(0,n.useRef)(null);return(0,_.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,_.jsx)(we().w,{blockStore:e,format:u().NY.ExtraSmall,isEditable:!1}),(0,_.jsx)(Pe().Y,{blockStore:e,noUnderline:!0,shouldWrap:!1,titleStyle:{fontSize:12},recordTitleRef:t,disableTooltip:!0})]},e.id)}function He({linkify:e,limit:t,hasUnresolvedDiscussion:o,hasDraftComment:r,relationItemPointers:s,tokenFormat:c,store:d,relationTokenStyle:u,wrapTokens:y}){const m=(0,a().IS)((e=>({moreToken:{margin:0},commentHighlightWrapperStyle:o||r?{...(0,p().sQ)(e.mode),padding:4,flexWrap:"wrap",lineHeight:2,display:"inline-flex"}:{},relationTokenHighlightStyle:o||r?{marginInlineStart:2,marginInlineEnd:2,maxWidth:"fit-content",display:"inline-flex"}:{}})),[r,o]),f=s.length>t,S=n.useMemo((()=>s.slice(0,t)),[s,t]);!function(e){const{store:t,relationItemPointers:o}=e,{surface:r,collectionContextStore:a,property:s}=(0,n.useContext)(_e().L8);(0,i().w)((()=>{var e;"table"===r&&s&&(null==a||null===(e=a.propertyResultDurationTracker)||void 0===e||e.trackMount({pageId:t.id,propertyId:s,propertyType:"relation"}))}));const c=(0,l().K8)((()=>!o.some((({pageStore:e})=>!e.isReady()))),[o]);(0,n.useEffect)((()=>{var e;c&&"table"===r&&s&&(null==a||null===(e=a.propertyResultDurationTracker)||void 0===e||e.trackResult({pageId:t.id,propertyId:s,propertyType:"relation"}))}),[a,r,c,s,t])}({store:d,relationItemPointers:S});const h=S.map((({pointer:t,pageStore:o})=>(0,_.jsx)(n.Fragment,{children:(0,_.jsx)(Oe,{recordPointer:t,parentStore:d,recordStore:o,style:u,propertyStyle:m.relationTokenHighlightStyle,linkify:e,noWrap:!y,disableTooltip:f})},t.id)));f&&h.push((0,_.jsx)(G().A,{style:m.moreToken,count:s.length-t,format:c,fixedHeight:!1,isCompact:!0},"more"));const b=(0,n.useCallback)((e=>(0,_.jsx)("div",{...e,style:{marginTop:2,marginBottom:2,display:"flex",flexDirection:"column",gap:1,width:"max-content",maxWidth:320},children:s.map((({pointer:e,pageStore:t})=>(0,_.jsx)(We,{pageStore:t},e.id)))})),[s]),x=(0,_.jsx)(Ee().h,{style:m.commentHighlightWrapperStyle,children:h});return f?(0,_.jsx)(g().A,{renderTooltip:b,delayThreshold:500,placement:"bottom",originGap:8,render:e=>(0,_.jsx)("div",{...e,children:x})}):x}function Oe(e){const{style:t,recordPointer:o,recordStore:n,parentStore:r,linkify:i,disableTooltip:l,propertyStyle:a,noWrap:s}=e;return(0,Ie().W)(n)?null:(0,_.jsx)("div",{style:t,children:(0,_.jsx)(Me().a,{recordPointer:o,parentStore:r,style:a,linkify:i,noWrap:s,disableTooltip:l})})}const Ke=(0,n.forwardRef)((function(e,t){const{shouldWrap:r}=(0,n.useContext)(_e().L8),i=ot(e,t),l=(0,n.useMemo)((()=>(0,_.jsx)(o(153364).k,{},"comment")),[]);return(0,_.jsx)(Te,{...i,EmptyComponent:Re().rW,renderAs:"inline",quickActionButtons:l,userExpandable:r})})),De=(0,n.forwardRef)((function(e,t){const o=ot(e,t);return(0,_.jsx)(Te,{...o,EmptyComponent:Re().ao,renderAs:"rows"})})),ze=(0,n.forwardRef)((function(e,t){const o=ot(e,t);return(0,_.jsx)(Te,{...o,EmptyComponent:Re().ao,renderAs:"singleWithOverflow"})})),Ne=(0,n.forwardRef)((function(e,t){const{showIfEmpty:n}=e,r=ot(e,t,(0,o(999943).F)(t,e.collectionStore,e.property,"relation"));return(0,_.jsx)(Te,{...r,EmptyComponent:n?Re().Jb:void 0,renderAs:"inline"})}));function qe(e){const t=(0,o(59226).X)("card_customization");return(0,l().K8)((()=>{if(!e)return;return"compact"===e.getCardLayoutMode()&&t?1:void 0}),[e,t])}const Ue=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=ot(e,t),r=qe(e.collectionViewStore);return(0,_.jsx)(Te,{...n,EmptyComponent:o?Re().Jb:void 0,renderAs:"inline",inlineLimit:r})})),Qe=(0,n.forwardRef)((function(e,t){const o=ot(e,t);return(0,_.jsx)(Te,{...o,renderAs:"inline"})})),Je=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=ot(e,t),r=qe(e.collectionViewStore);return(0,_.jsx)(Te,{...n,EmptyComponent:o?Re().Jb:void 0,renderAs:"inline",inlineLimit:r})})),$e=(0,n.forwardRef)((function(e,t){const o=ot(e,t);return(0,_.jsx)(Te,{...o,renderAs:"inline"})})),Ye=(0,n.forwardRef)((function(e,t){const o=ot(e,t);return(0,_.jsx)(Te,{...o,renderAs:"inline"})})),Ze=(0,n.forwardRef)((function(e,t){const o=ot(e,t);return(0,_.jsx)(Te,{...o,renderAs:"inline"})}));function Ge(){}const Xe=(0,n.forwardRef)((function(e,t){const{store:r,collectionStore:i,property:a,blockPropertyValueOverlayStore:s,isInPeekRenderer:d}=ot(e,t),{canEdit:u,propertyModule:p,propertySchema:y,collectionSchemaStore:m}=(0,n.useContext)(_e().L8),f=(0,l().O$)(m),S=(0,l().K8)((()=>r.isNonEditableState()),[r]),h=(0,n.useMemo)((()=>new(o(171018).YB)),[]),g=(0,l().K8)((()=>i.getFormat()),[i]),x=(0,l().K8)((()=>{const e=null==i?void 0:i.getParentStore();return!(!i||!e||"block"!==e.table)&&(0,o(33791).v)({collectionStore:i,collectionViewBlockStore:e,checkNavigableAncestorLocked:!1})}),[i]),v=(0,ce().l)(r),C=(0,l().K8)((()=>{var e;return"hide"===(null==v||null===(e=v.getFormat())||void 0===e?void 0:e.property_icons_visibility)}),[v]),k=(0,n.useMemo)((()=>{if("relation"!==(null==y?void 0:y.type))return;const e=y?c().Nv(y):void 0;return e?ye().m.createChildStore(r,e):void 0}),[y,r]),w=(0,l().K8)((()=>(null==k?void 0:k.getDatabaseType())===o(13643).av),[k]);if(!y||!f)return null;const P=(0,_.jsx)(b().I,{schema:f,format:g,hideDragHandle:!0,property:a,blockStore:r,collectionStore:i,pagePropertiesStore:h,disabled:!u,locked:S,canConfigureCollection:x,isInPeekRenderer:d??!1,styleVariants:et,layoutModule:p,hideIcon:C});return(0,_.jsx)(o(3079).H,{store:r,property:a,ref:t,children:(0,_.jsx)(me,{store:r,collectionStore:i,disabled:!u,locked:S,property:a,schema:f,handleMouseMove:Ge,handleMouseLeave:Ge,handleContextMenu:Ge,blockPropertyValueOverlayStore:s,format:g,visibility:w?"inline":e.propertyVisibility??"inline",isInPeekRenderer:Boolean(d),topBorder:!1,showIcon:!1,propertyRowName:P,pagePropertiesStore:h})})})),et={width:{variant:"hug-content"},height:{variant:"small"},fontWeight:"medium",size:"small"},tt=(0,n.forwardRef)((function(e,t){const o=ot(e,t);return(0,_.jsx)(Te,{...o,EmptyComponent:Re().Fe,renderAs:"inline"})}));function ot(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l,blockPropertyValueOverlayStore:a,surface:s,isInPeekRenderer:c,width:d,formQuestionStore:u,locked:p}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,je().QK)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle,blockPropertyValueOverlayStore:a,surface:s,isInPeekRenderer:c,width:d,formQuestionStore:u,locked:p}}},430042:(e,t,o)=>{o.d(t,{R:()=>i});o(296540);var n=o(474848);const r={viewBox:"0 0 16 16",fittedViewBox:"2.61 3.05 9.98 9.9",directional:!0,svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M8.002 3.238a.625.625 0 0 0-.884 0l-4.32 4.32a.625.625 0 0 0 0 .884l4.32 4.32a.625.625 0 0 0 .884-.884L4.124 8l3.878-3.878a.625.625 0 0 0 0-.884"}),(0,n.jsx)("path",{d:"M12.402 3.238a.625.625 0 0 0-.884 0l-4.32 4.32a.625.625 0 0 0 0 .884l4.32 4.32a.625.625 0 0 0 .884-.884L8.524 8l3.878-3.878a.625.625 0 0 0 0-.884"})]})},i=(0,o(340498).wt)("arrowChevronDoubleBackwardSmall",r)},471095:(e,t,o)=>{o.d(t,{i:()=>r});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"3.97 1.95 12.05 15.66",svg:(0,o(474848).jsx)("path",{d:"M6 5.95a4 4 0 1 1 8 0v1.433a2.426 2.426 0 0 1 2.025 2.392v5.4A2.425 2.425 0 0 1 13.6 17.6H6.4a2.425 2.425 0 0 1-2.425-2.425v-5.4c0-1.203.876-2.201 2.025-2.392zm6.75 1.4v-1.4a2.75 2.75 0 1 0-5.5 0v1.4zm-2.2 5.458a1.35 1.35 0 1 0-1.1 0v1.242a.55.55 0 0 0 1.1 0z"})},r=(0,o(340498).wt)("lockFill",n)},477660:(e,t,o)=>{function n(e){switch(null==e?void 0:e.type){case"url":case"email":case"phone_number":return e;default:return}}o.d(t,{z:()=>n})},511296:(e,t,o)=>{o.d(t,{T:()=>r});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"3.03 0.85 9.94 14.3",svg:(0,o(474848).jsx)("path",{d:"M7.47 1.07a.75.75 0 0 1 1.06 0l.003.002L12.73 5.27a.75.75 0 1 1-1.06 1.06L8 2.66 4.33 6.33a.75.75 0 1 1-1.06-1.06zm0 13.86-4.2-4.2a.75.75 0 0 1 1.06-1.06L8 13.34l3.67-3.67a.75.75 0 0 1 1.06 1.06l-4.195 4.195-.005.005a.75.75 0 0 1-1.046.014"})},r=(0,o(340498).wt)("arrowChevronDoubleUpAndDownFillSmall",n)},513996:(e,t,o)=>{o.d(t,{i:()=>c});var n=o(296540),r=()=>o(401497),i=()=>o(421107),l=()=>o(971003),a=o(474848);const s=(0,o(69708).YK)({copy:{defaultMessage:"Copy to Clipboard",id:"database.copyButton.copyToClipboard"}}),c=n.memo((function(e){const{store:t,property:c,style:d,surface:u,showShadow:p}=e,y=(0,o(484714).v3)(),m=(0,r().DP)(),f=(0,o(908201).Ks)(),{collectionSchemaStore:S}=(0,n.useContext)(l().L8),{isEmptyStore:h,propertySchema:g,canEdit:b}=(0,n.useContext)(l().L8),x=(0,o(56366).O$)(h),v=(0,r().IS)((e=>({buttonStyle:{display:"flex",position:"relative"},iconStyle:{color:e.text.secondary,fill:e.text.secondary,width:16,height:16}})),[]),C="table"===u,k=o(972435).A.formatMessage(s.copy),w=(0,n.useCallback)((()=>k),[k]),P=(0,n.useCallback)((e=>(0,a.jsx)("div",{style:{...d,...v.buttonStyle},...e,children:(0,a.jsx)(o(285790).A,{onClick:async()=>{const e=S.getState();if(!e)return;let n;C&&(n=i().A.getState(),(0,o(913747).w)()),await o(581350).E({environment:y,theme:m,store:t,schema:e,property:c,collectionContextStore:f}),C&&n&&i().A.setState(n)},ariaLabel:k,hasBackground:!0,icon:o(627503).a,showShadow:p,iconStyle:v.iconStyle,style:{height:20,width:24,borderRadius:4}})})),[f,S,y,C,c,p,t,d,v.buttonStyle,v.iconStyle,m,k]);return void 0===g||x||o(726637).A.isMobile&&!0===b||"checkbox"===(0,o(501053).c)(g)?null:(0,a.jsx)(o(859428).A,{renderTooltip:w,render:P})}))},527257:(e,t,o)=>{o.d(t,{A:()=>l});o(296540);var n=()=>o(285790),r=()=>o(859428),i=o(474848);function l(e){const{icon:t,iconStyle:o,tooltip:l,onClick:a,showShadow:s,style:c}=e;return(0,i.jsx)(r().A,{renderTooltip:()=>l,render:e=>(0,i.jsx)(n().A,{ariaLabel:l,icon:t,iconStyle:o,onClick:a,hasBackground:!0,showShadow:s,...e,style:c})})}},563884:(e,t,o)=>{o.d(t,{k:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("calendar",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M3.24902 14.7764H12.6621C14.1455 14.7764 14.918 14.0107 14.918 12.5479V4.22852C14.918 2.76562 14.1455 2 12.6621 2H3.24902C1.77246 2 1 2.75879 1 4.22852V12.5479C1 14.0107 1.77246 14.7764 3.24902 14.7764ZM3.24219 13.416C2.6748 13.416 2.36035 13.1221 2.36035 12.5205V6.23145C2.36035 5.62988 2.6748 5.33594 3.24219 5.33594H12.6689C13.2363 5.33594 13.5508 5.62988 13.5508 6.23145V12.5205C13.5508 13.1221 13.2363 13.416 12.6689 13.416H3.24219ZM6.63965 7.69434H7.04297C7.28906 7.69434 7.37109 7.61914 7.37109 7.37988V6.97656C7.37109 6.73047 7.28906 6.65527 7.04297 6.65527H6.63965C6.39355 6.65527 6.31152 6.73047 6.31152 6.97656V7.37988C6.31152 7.61914 6.39355 7.69434 6.63965 7.69434ZM8.875 7.69434H9.27832C9.51758 7.69434 9.59961 7.61914 9.59961 7.37988V6.97656C9.59961 6.73047 9.51758 6.65527 9.27832 6.65527H8.875C8.62891 6.65527 8.54688 6.73047 8.54688 6.97656V7.37988C8.54688 7.61914 8.62891 7.69434 8.875 7.69434ZM11.1035 7.69434H11.5068C11.7529 7.69434 11.835 7.61914 11.835 7.37988V6.97656C11.835 6.73047 11.7529 6.65527 11.5068 6.65527H11.1035C10.8643 6.65527 10.7822 6.73047 10.7822 6.97656V7.37988C10.7822 7.61914 10.8643 7.69434 11.1035 7.69434ZM4.41113 9.89551H4.80762C5.05371 9.89551 5.13574 9.82031 5.13574 9.57422V9.1709C5.13574 8.93164 5.05371 8.85645 4.80762 8.85645H4.41113C4.16504 8.85645 4.08301 8.93164 4.08301 9.1709V9.57422C4.08301 9.82031 4.16504 9.89551 4.41113 9.89551ZM6.63965 9.89551H7.04297C7.28906 9.89551 7.37109 9.82031 7.37109 9.57422V9.1709C7.37109 8.93164 7.28906 8.85645 7.04297 8.85645H6.63965C6.39355 8.85645 6.31152 8.93164 6.31152 9.1709V9.57422C6.31152 9.82031 6.39355 9.89551 6.63965 9.89551ZM8.875 9.89551H9.27832C9.51758 9.89551 9.59961 9.82031 9.59961 9.57422V9.1709C9.59961 8.93164 9.51758 8.85645 9.27832 8.85645H8.875C8.62891 8.85645 8.54688 8.93164 8.54688 9.1709V9.57422C8.54688 9.82031 8.62891 9.89551 8.875 9.89551ZM11.1035 9.89551H11.5068C11.7529 9.89551 11.835 9.82031 11.835 9.57422V9.1709C11.835 8.93164 11.7529 8.85645 11.5068 8.85645H11.1035C10.8643 8.85645 10.7822 8.93164 10.7822 9.1709V9.57422C10.7822 9.82031 10.8643 9.89551 11.1035 9.89551ZM4.41113 12.0898H4.80762C5.05371 12.0898 5.13574 12.0146 5.13574 11.7754V11.3721C5.13574 11.126 5.05371 11.0508 4.80762 11.0508H4.41113C4.16504 11.0508 4.08301 11.126 4.08301 11.3721V11.7754C4.08301 12.0146 4.16504 12.0898 4.41113 12.0898ZM6.63965 12.0898H7.04297C7.28906 12.0898 7.37109 12.0146 7.37109 11.7754V11.3721C7.37109 11.126 7.28906 11.0508 7.04297 11.0508H6.63965C6.39355 11.0508 6.31152 11.126 6.31152 11.3721V11.7754C6.31152 12.0146 6.39355 12.0898 6.63965 12.0898ZM8.875 12.0898H9.27832C9.51758 12.0898 9.59961 12.0146 9.59961 11.7754V11.3721C9.59961 11.126 9.51758 11.0508 9.27832 11.0508H8.875C8.62891 11.0508 8.54688 11.126 8.54688 11.3721V11.7754C8.54688 12.0146 8.62891 12.0898 8.875 12.0898Z"})})},564883:(e,t,o)=>{o.d(t,{kF:()=>i,qO:()=>l});var n=()=>o(645873);const r={contactVisitButton:new(n().O2)("contactVisitButton",(()=>o.e(82970).then(o.bind(o,837606)))),workflowAutofillButton:new(n().O2)("WorkflowAutofillButton",(()=>o.e(82690).then(o.bind(o,490378))))},i=(0,n()._h)(r.contactVisitButton,(e=>e.default)),l=(0,n()._h)(r.workflowAutofillButton,(e=>e.WorkflowAutofillButton))},573451:(e,t,o)=>{o.d(t,{C:()=>r});var n=()=>o(945895);function r(e){const{store:t,transient:o}=e;n().A.setState({isActive:!0,store:t,transient:Boolean(o)})}},581350:(e,t,o)=>{o.d(t,{E:()=>q,V:()=>$});o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(672577);var n=()=>o(314529),r=()=>o(242422),i=()=>o(726637),l=()=>o(908006),a=()=>o(187696),s=()=>o(302322),c=()=>o(581793),d=()=>o(363170),u=()=>o(716016),p=()=>o(9559),y=()=>o(898244),m=()=>o(713998),f=()=>o(597777),S=()=>o(869190),h=()=>o(604995),g=()=>o(239381),b=()=>o(416504),x=()=>o(72135),v=()=>o(201980),C=()=>o(969842),k=()=>o(496603),w=()=>o(534177),P=()=>o(720665),I=()=>o(843141),j=()=>o(299709),_=()=>o(559926),R=()=>o(884107),M=()=>o(620689),E=()=>o(319975),B=()=>o(231297),A=()=>o(417392),T=()=>o(267419),L=()=>o(862292),V=()=>o(921855),F=()=>o(476492),W=()=>o(909470),H=()=>o(761408),O=()=>o(267584),K=()=>o(972435),D=()=>o(693084),z=()=>o(468882),N=()=>o(90654);async function q(e){const{environment:t,theme:o,store:n,schema:l,property:c,collectionContextStore:y}=e,S=t.device,x=l[c],k=await R().R.clipboardActions.load();if(x){switch(x.type){case"formula":{const e=await L().T.formulas.load();"v2"===x.version?function(e){const{clipboardActions:t,environment:o,store:n,propertySchema:i,property:l,formulasModule:a}=e,s=n.getModel();if(!i.formula2||!s)return;const c=K().A.getIntl(),d=(0,b().P)(),u=a.evaluateCollectionFormula2({block:s,property:l,formulaCode:i.formula2.code,getRecordModel:n.getRecordModel,intl:c,userTimeZone:d,depth:0,visitedProperties:new Set,resultCache:new Map,regExpCache:new Map,formatDateCache:new Map,experimentService:r().default,collectionFeatureGates:(0,W().i)(),spaceIdCreator:o.idCreator.getSpaceIdCreatorSync(n.getSpaceId())});if(!u)return;const p=(0,g().Ht)(u),y=(0,V().r4)(p,n);t.copyString({stringValue:y,environment:o,copiedMessage:t.clipboardMessages.copiedPropertyToClipboard})}({clipboardActions:k,environment:t,store:n,propertySchema:x,property:c,formulasModule:e}):function(e){var t;const{clipboardActions:o,environment:n,store:i,schema:l,property:a,propertySchema:s,formulasModule:c}=e,d=i.getValue();if(!d)return;const u=c.evaluateFormulaProperty({property:a,schema:l,block:d,getRecordValue:i.getRecordValue,collectionRequestContext:{userId:void 0,userTimeZone:(0,b().P)(),depth:0,intl:K().A.getIntl(),resultCache:new Map,regExpCache:new Map,formatDateCache:new Map,visitedProperties:new Set,experimentService:r().default,collectionFeatureGates:(0,W().i)()},spaceIdCreator:n.idCreator.getSpaceIdCreatorSync(i.getSpaceId())}),p=null==s||null===(t=s.formula)||void 0===t?void 0:t.result_type;switch(p){case"number":P().Et(u)&&Q({clipboardActions:o,value:u,propertySchema:s,environment:n});break;case"date":u&&f().kC(u)&&J({clipboardActions:o,date:u,environment:n});break;case"text":u&&o.copyString({stringValue:u.toString(),environment:n,copiedMessage:o.clipboardMessages.copiedPropertyToClipboard});break;case"checkbox":case void 0:return;default:(0,w().HB)(p)}}({clipboardActions:k,environment:t,store:n,schema:l,property:c,propertySchema:x,formulasModule:e});break}case"person":{const e=n.getPropertyValue(c);U({actors:(0,d().e)({textValue:e,propertySchema:x,blockCreatorPointer:n.getCreatedByPointer()}),clipboardActions:k,environment:t,store:n});break}case"created_by":{const e=n.getCreatedByPointer();e&&U({actors:[e],clipboardActions:k,environment:t,store:n});break}case"last_edited_by":{const e=n.getLastEditedByPointer();e&&U({actors:[e],clipboardActions:k,environment:t,store:n});break}case"number":Q({clipboardActions:k,environment:t,propertySchema:x,value:s().M(n.getPropertyValue(c))});break;case"text":{const e=n.getPropertyValue(c);if(!e)return;const l=(0,C().$e)({textValue:{value:e,spaceId:n.getSpaceId()},getRecordModel:n.getRecordModel,getRecordRole:n.getRecordRole,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!0,disableSuggestionAnnotations:!1,disableLinks:!1,disabled:!1,userTimeZone:(0,b().P)(),isClient:!0,isAndroid:S.isAndroid,isSafariOrIOS:S.isSafari||S.isIOS,isFirefox:S.isFirefox,isWindows:S.isWindows,showEmojiInline:S.isWindows,emojiType:"raw",theme:o,baseUrl:i().A.domainBaseUrl,publicDomainName:i().A.publicDomainName,currentUserId:t.currentUser.id,intl:K().A.getIntl(),katex:void 0,getPublicBaseUrlForPageOrCollection:void 0,externalIntegrations:[],formulaValueTypes:[],emojiData:T().A.state,isMobileNative:S.isMobileNative,isMobileNativeExternalLinkFixEnabled:r().default.checkGate({gateName:"mobile_native_external_link_fix"})}),a=(0,V().r4)(n.getPropertyValue(c),n);k.copyHtml({stringValue:a,htmlValue:l,environment:t,copiedMessage:k.clipboardMessages.copiedPropertyToClipboard});break}case"url":case"email":case"phone_number":{const e=v().k4p(n.getPropertyValue(c));k.copyString({stringValue:e,environment:t,copiedMessage:k.clipboardMessages.copiedPropertyToClipboard});break}case"date":{const e=n.getPropertyValue(c),o=(0,a().b)(e);o&&J({clipboardActions:k,date:o,environment:t,dateFormat:x.date_format,timeFormat:x.time_format});break}case"last_edited_time":case"created_time":{const e=n.getKeyStore(x.type).getValue();if(e){J({clipboardActions:k,date:h().KQ(e,(0,b().P)()),environment:t,dateFormat:x.date_format,timeFormat:x.time_format})}break}case"auto_increment_id":{const e=n.getPropertyValue(c);!function(e){const{clipboardActions:t,value:o,environment:n,collectionContextStore:r}=e;if(o&&r){var i;const e=(null===(i=r.collectionStore())||void 0===i||null===(i=i.getRecordKeyStore())||void 0===i?void 0:i.getRecordKey())??"";t.copyString({stringValue:(0,u().H4)(e,o),environment:n,copiedMessage:t.clipboardMessages.copiedPropertyToClipboard})}}({clipboardActions:k,value:m().On(e),environment:t,collectionContextStore:y});break}case"rollup":!function(e){const{clipboardActions:t,environment:o,store:n,schema:i,property:l,formulasModule:a}=e,s=n.getModel();if(!s)return;const c=(0,p().W)({property:l,schema:i,block:s,getRecordModel:n.getRecordModel,collectionRequestContext:{userId:void 0,userTimeZone:(0,b().P)(),depth:0,intl:K().A.getIntl(),visitedProperties:new Set,resultCache:new Map,regExpCache:new Map,formatDateCache:new Map,experimentService:r().default,collectionFeatureGates:(0,W().i)()},exportedFilePaths:!1,formulasModule:a,spaceIdCreator:o.idCreator.getSpaceIdCreatorSync(n.getSpaceId())});c&&t.copyString({stringValue:c,environment:o,copiedMessage:t.clipboardMessages.copiedPropertyToClipboard})}({clipboardActions:k,environment:t,store:n,schema:l,property:c,collectionContextStore:y,formulasModule:await L().T.formulas.load()});break}(0,I().E)(t,y,{block_id:n.id,property:c,property_type:x.type})}}function U(e){const{actors:t,clipboardActions:o,environment:n,store:r}=e,i=(0,c().h)(t);o.copyString({stringValue:(0,V().r4)(i,r),environment:n,copiedMessage:o.clipboardMessages.copiedPropertyToClipboard})}function Q(e){const{clipboardActions:t,value:o,propertySchema:n,environment:r}=e;if(!k().yr(o)&&!P().pN(o)){const e=(null==n?void 0:n.number_format)||x().C4,i=(null==n?void 0:n.number_precision)||x().pS,l=x().ZV(o,e,K().A.getIntl(),void 0,i);t.copyString({stringValue:l,environment:r,copiedMessage:t.clipboardMessages.copiedPropertyToClipboard})}}function J(e){const{clipboardActions:t,date:o,environment:n,dateFormat:r,timeFormat:i}=e,l=(0,S().ZF)({value:o,date_format:r??f().vz,time_format:i??f().CE,allowRelativeDates:!0,intl:K().A.getIntl()});t.copyString({stringValue:l,environment:n,copiedMessage:t.clipboardMessages.copiedPropertyToClipboard})}async function $(e){const{element:t,rect:o,environment:r,onClick:i,store:a,additionalStores:s=[],property:c,surface:d,collectionStore:u,blockPropertyValueOverlayStore:p,disableHorizontalEdgeScroll:f,collectionContextStore:S,collectionSchema:h,mouseStore:g,setMouseEntered:b,statusSetCheckbox:x,preventClearSelection:v,collectionsBulkActionsToolbarStore:C,scrollerContext:k,sizing:w,formQuestionStore:P,onClose:I}=e,{device:R,WindowSizeStore:T}=r,L=S&&z().br({store:a,additionalStores:s,collectionContextStore:S});let V=u.getSchema();L&&(V=S.normalizedSchemaStore.state),h&&(V=h);const W=(0,H().Le)({collectionStore:u,collectionContextStore:S,property:c}),q=V[W],U=null==q?void 0:q.type;if(!U)return;if(z().F1({property:c,collectionStore:u}))return;const Q=a.getPropertyStore(W);if("checkbox"===U)Q&&B().createAndCommit({userAction:"BlockPropertyValue.handleEditButtonClick",environment:r,canUndo:!0,perform:e=>{N().qS({stores:[a,...s],property:W,transaction:e})}}),S&&(0,j().E)({environment:r,collectionContextStore:S,block_id:Q.id,property:W,property_type:U,from:z().zP(d),isFromBulkActionsToolbar:Boolean(C)});else if("status"===U&&"status"===q.type&&x){const e=a.getPropertyValue(W),t=m().MC(e,q,K().A.getIntl());var J;if(Q&&B().createAndCommit({userAction:"BlockPropertyValue.handleEditButtonClick",environment:r,canUndo:!0,perform:e=>{const o=q.groups??[],n=!0===t?o[0]:o[o.length-1],i=(q.options??[]).find((e=>{var t;return e.id===(null==n||null===(t=n.optionIds)||void 0===t?void 0:t[0])}));if(i)for(const t of[a,...s])E().R9({environment:r,store:t.getPropertyStore(W),value:m().wb(i.value),transaction:e})}}),u.isExternalSyncedCollection())_().j2(r,{property_id:W,property_type:"status",action:"property_button_click",from:d,integration:null===(J=u.getFormat())||void 0===J?void 0:J.external_collection_type,collection_id:u.id,is_notion_only_property:(0,O().sc)({collectionStore:u,propertyId:c,propertySchema:q,isExternallyImportedAndSyncedCollection:u.isExternallyImportedAndSyncedCollection()})})}else{if(-1===y().dA.indexOf(U)&&(null==b||b(!1),g&&g.setState({...g.state,mouseEntered:!1}),t&&k&&R.isMobileNative&&D().Hp[U].type===A().nl.Popup&&(M().hT({element:t,environment:r,scrollerContext:k,vertical:{reveal:"bottom",paddingToTopEdge:4,paddingToBottomEdge:T.getSafePaddingBottomPx(320)},horizontal:{reveal:"closest"}}),await l().default.afterNextFlush()),N().ho({environment:r,blockPropertyValueOverlayStore:p,store:a,additionalStores:s,property:W,surface:d,rect:o,disableHorizontalEdgeScroll:f,collectionContextStore:S,collectionSchema:h,preventClearSelection:v,collectionsBulkActionsToolbarStore:C,sizing:w,formQuestionStore:P,onClose:I}),S)){const e=(0,F().sl)(S)||{};var $;if((0,n().DO_NOT_USE_trackLegacy)(r,"collection_open_block_property_overlay",{property:W,property_type:U,property_context:void 0,from:z().zP(d),isFromBulkActionsToolbar:Boolean(C),...e}),u.isExternalSyncedCollection())_().j2(r,{property_id:W,property_type:U,action:"property_button_click",from:d,integration:null===($=u.getFormat())||void 0===$?void 0:$.external_collection_type,collection_id:u.id,is_notion_only_property:(0,O().sc)({collectionStore:u,propertyId:W,propertySchema:q,isExternallyImportedAndSyncedCollection:u.isExternallyImportedAndSyncedCollection()})})}}i&&i()}},595465:(e,t,o)=>{o.d(t,{T:()=>i,m:()=>r});var n=()=>o(645873);const r=new(n().O2)("formPropertyRenderer",(()=>Promise.all([o.e(71562),o.e(4330),o.e(59111)]).then(o.bind(o,869907)))),i=(0,n().jQ)(r,(e=>e.default))},625194:(e,t,o)=>{o.d(t,{m:()=>l});var n=o(296540),r=()=>o(96330),i=o(474848);const l=n.memo((function(e){const{textValue:t}=e,o=(0,n.useMemo)((()=>(0,r().X1)((0,r().eC)(t))),[t]);return(0,i.jsx)("span",{children:o})}))},650632:(e,t,o)=>{o.d(t,{BP:()=>E,Gx:()=>P,Qz:()=>R,RM:()=>M,UP:()=>j,g$:()=>w,nr:()=>x,v:()=>k,vy:()=>_,wW:()=>C,y9:()=>I,zI:()=>v});var n=o(296540),r=()=>o(484714),i=()=>o(56366),l=()=>o(401497),a=()=>o(187696),s=()=>o(604995),c=()=>o(416504),d=()=>o(559653),u=()=>o(359161),p=()=>o(968021),y=()=>o(802229),m=()=>o(971003),f=()=>o(153364),S=()=>o(513996),h=()=>o(712354),g=o(474848);const b=n.memo((0,n.forwardRef)((function(e,t){const{store:i,onContextMenu:a,editButtonClickProps:s,quickActionButtons:c,EmptyComponent:d,buttonStyle:u,property:p,width:f,formQuestionStore:S,userExpandable:h}=e,{baseStyles:b,propertySchema:v,propertyFormat:C}=(0,n.useContext)(m().L8),k=(0,y().DZ)(i,p,v),w=(0,r().v3)(),P=v,I=x(i,null==P?void 0:P.type,p,w.currentUser.id),j=(0,l().IS)((e=>({buttonStyle:{...b.buttonStyle,...u},buttonPressedStyle:b.buttonPressedStyle??{},buttonHoveredStyle:b.buttonHoveredStyle??{}})),[b.buttonHoveredStyle,b.buttonPressedStyle,b.buttonStyle,u]);if(!I&&void 0===d&&void 0===k)return null;let _;if(k)_=(0,g.jsx)(o(877750).e,{templateVariableType:k.templateVariable});else if(I||void 0===d){const e=(null==C?void 0:C.date_format)??(null==P?void 0:P.date_format),t=(null==C?void 0:C.time_format)??(null==P?void 0:P.time_format);_=(0,g.jsx)(o(431616).C,{children:(0,g.jsx)(o(586117).b,{dateValue:I,dateFormat:e,timeFormat:t,store:i,property:p})})}else _=(0,g.jsx)(d,{});return(0,g.jsx)(o(986621).P,{ref:t,style:j.buttonStyle,hoveredStyle:j.buttonHoveredStyle,pressedStyle:j.buttonPressedStyle,onContextMenu:a,editButtonClickProps:s,quickActionButtons:c,width:f,formQuestionStore:S,userExpandable:h,children:_})})));function x(e,t,o,n){return(0,i().K8)((()=>{switch(t){case"created_time":const t=e.getCreatedTime();return t?s().KQ(t,(0,c().P)()):void 0;case"last_edited_time":const r=e.getLastEditedTime();return r?s().KQ(r,(0,c().P)()):void 0;case"last_visited_time":if(!n)return;const i=u()._.createChildStore(e,{table:d().F9,id:(0,d().$5)({parent_id:e.id,user_id:n}),spaceId:e.getSpaceId()}).getVisitedAt();return i?s().KQ(i,(0,c().P)()):void 0;default:const l=e.getPropertyValue(o);return(0,a().b)(l)}}),[o,e,t,n])}const v=(0,n.forwardRef)((function(e,t){const{store:o,property:i,surface:a}=e,{isMobile:s,isPhone:c}=(0,r().Y0)(),d=(0,l().IS)((()=>({buttonStyle:{...(0,p()._Q)({isPhone:c}).page.text}})),[c]),u=(0,n.useMemo)((()=>{if(!s)return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(f().k,{},"comment"),(0,g.jsx)(S().i,{store:o,property:i,surface:a},"copy")]})}),[a,s,i,o]),y=B(e,t,d);return(0,g.jsx)(b,{...y,EmptyComponent:h().ao,quickActionButtons:u})})),C=(0,n.forwardRef)((function(e,t){const{store:i,property:a,surface:s}=e,{isMobile:c,isPhone:d}=(0,r().Y0)(),{shouldWrap:u}=(0,n.useContext)(m().L8),y=(0,l().IS)((()=>({buttonStyle:{...(0,p()._Q)({isPhone:d}).table.text}})),[d]),x=(0,n.useMemo)((()=>{if(!c)return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(o(564883).qO,{store:i,property:a},"workflow-autofill"),(0,g.jsx)(f().k,{},"comment"),(0,g.jsx)(S().i,{store:i,property:a,surface:s},"copy")]})}),[s,c,a,i]),v=B(e,t,y);return(0,g.jsx)(b,{...v,EmptyComponent:h().rW,quickActionButtons:x,userExpandable:u})})),k=(0,n.forwardRef)((function(e,t){const{store:o,property:i,surface:a}=e,{isMobile:s,isPhone:c}=(0,r().Y0)(),d=(0,l().IS)((()=>({buttonStyle:{...(0,p()._Q)({isPhone:c}).compact_page.text}})),[c]),u=(0,n.useMemo)((()=>{if(!s)return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(f().k,{},"comment"),(0,g.jsx)(S().i,{store:o,property:i,surface:a},"copy")]})}),[a,s,i,o]),y=B(e,t,d);return(0,g.jsx)(b,{...y,EmptyComponent:h().ao,quickActionButtons:u})})),w=(0,n.forwardRef)((function(e,t){const{showIfEmpty:n}=e,r=B(e,t,(0,o(999943).F)(t,e.collectionStore,e.property,"date"));return(0,g.jsx)(b,{...r,EmptyComponent:n?h().Jb:void 0})})),P=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=(0,r().WS)(),i=B(e,t,(0,l().IS)((()=>({buttonStyle:{...(0,p()._Q)({isPhone:n}).board.text}})),[n]));return(0,g.jsx)(b,{...i,EmptyComponent:o?h().Jb:void 0})})),I=(0,n.forwardRef)((function(e,t){const o=B(e,t);return(0,g.jsx)(b,{...o})})),j=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=B(e,t);return(0,g.jsx)(b,{...n,EmptyComponent:o?h().Jb:void 0})})),_=(0,n.forwardRef)((function(e,t){const o=B(e,t);return(0,g.jsx)(b,{...o})})),R=(0,n.forwardRef)((function(e,t){const o=B(e,t);return(0,g.jsx)(b,{...o})})),M=(0,n.forwardRef)((function(e,t){const o=B(e,t);return(0,g.jsx)(b,{...o})})),E=(0,n.forwardRef)((function(e,t){const o=B(e,t);return(0,g.jsx)(b,{...o,EmptyComponent:h().Fe})}));function B(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l,width:a}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,y().QK)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle,width:a}}},662984:(e,t,o)=>{o.r(t),o.d(t,{arrowExpandDiagonalBottomLeftToTopRightSmallIcon:()=>r,iconDefinition:()=>n});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"2.46 2.46 11.08 11.08",svg:(0,o(474848).jsx)("path",{d:"M8.912 2.463a.625.625 0 1 0 0 1.25h2.491L8.358 6.758a.625.625 0 1 0 .884.884l3.045-3.045v2.49a.625.625 0 1 0 1.25 0v-4a.625.625 0 0 0-.625-.624zM7.64 8.36a.625.625 0 0 0-.885 0l-3.042 3.043V8.912a.625.625 0 1 0-1.25 0v4c0 .345.28.625.625.625h4a.625.625 0 0 0 0-1.25H4.597l3.042-3.043a.625.625 0 0 0 0-.883"})},r=(0,o(340498).wt)("arrowExpandDiagonalBottomLeftToTopRightSmall",n)},675592:(e,t,o)=>{o.d(t,{DV:()=>s,PD:()=>a,Pr:()=>r,UB:()=>c,Wm:()=>l,Z6:()=>i});var n=o(296540);const r=n.createContext(void 0);r.displayName="ColumnVirtualizerContext";const i=n.createContext(!1);i.displayName="ColumnVirtualizerExistenceContext";const l=n.createContext({propertiesInRange:[],propertiesInRangeIndices:[],beforeWidth:0,afterWidth:0});function a(){return(0,n.useContext)(r)}function s(){return(0,n.useContext)(i)}function c(){return(0,n.useContext)(l)}l.displayName="ColumnVirtualizerVisiblePropertiesContext"},712354:(e,t,o)=>{o.d(t,{Fe:()=>S,Jb:()=>f,ao:()=>y,rW:()=>m});var n=o(296540),r=()=>o(56366),i=()=>o(401497),l=()=>o(455348),a=()=>o(852424),s=()=>o(69708),c=()=>o(971003),d=()=>o(431616),u=o(474848);const p="20px";function y(){return(0,u.jsx)(d().C,{fontColor:"light",style:{lineHeight:p},isEmpty:!0,children:(0,u.jsx)(s().sA,{defaultMessage:"Empty",id:"database.pageProperty.emptyTitle"})})}function m(){return null}function f(){const e=(0,i().DP)(),{store:t,property:o,collectionContextStore:p}=(0,n.useContext)(c().L8),y=(0,r().K8)((()=>{const e=null==p?void 0:p.normalizedSchemaStore.state,n=null==t?void 0:t.getAssociatedCollectionStore();if(!e||!n||!o)return;return e["collectionTypedView"===p.contextType?l().u9.derivePropertyUri(o,n.getPropertyMapping())??o:o]}),[p,o,t]),m=(0,i().IS)((()=>({textContainer:{display:"inline-flex",alignItems:"center"},propertyIcon:{marginInlineEnd:6}})),[]);return y?(0,u.jsxs)(d().C,{fontColor:"light",style:m.textContainer,children:[(0,u.jsx)(a().zB,{type:y.type,icon:y.icon,size:14,theme:e,style:m.propertyIcon}),(0,u.jsx)(s().sA,{defaultMessage:"Add {propertyName}",id:"database.boardProperty.fillProperty",values:{propertyName:y.name}})]}):null}function S(){const e=(0,i().DP)(),{propertySchema:t,baseStyles:o,collectionContextStore:l}=(0,n.useContext)(c().L8),s=(0,r().K8)((()=>{var e;return"hide"===(null==l||null===(e=l.collectionStore())||void 0===e||null===(e=e.getLayoutStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.property_icons_visibility)}),[l]),d=(0,i().IS)((e=>({container:{...null==o?void 0:o.textStyle,display:"inline-flex",alignItems:"center",overflow:"hidden",color:e.text.tertiary},text:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},icon:{marginInlineEnd:4}})),[o]);return t?(0,u.jsxs)("div",{style:d.container,children:[s?void 0:(0,u.jsx)(a().zB,{type:t.type,icon:t.icon,size:14,theme:e,style:d.icon}),(0,u.jsx)("div",{style:d.text,children:t.name})]}):null}},714574:(e,t,o)=>{o.d(t,{P:()=>r});var n=()=>o(996494);function r(e){const{store:t}=e;"new"===n().A.state.editMode&&n().A.state.store.id===t.id&&n().A.reset()}},726643:(e,t,o)=>{o.r(t),o.d(t,{BlockPropertyRouter:()=>Hi});var n=o(296540),r=()=>o(56366),i=()=>o(908201),l=()=>o(484714),a=()=>o(401497),s=()=>o(716016),c=()=>o(713998),d=()=>o(968021),u=()=>o(986621),p=()=>o(971003),y=()=>o(513996),m=()=>o(999943),f=()=>o(431616),S=o(474848);const h=n.memo((0,n.forwardRef)((function(e,t){const{store:o,collectionStore:i,buttonStyle:l,onContextMenu:d,quickActionButtons:y,property:m}=e,{baseStyles:h}=(0,n.useContext)(p().L8),g=(0,r().K8)((()=>{var e;const t=o.getPropertyValue(m),n=null==i||null===(e=i.getRecordKeyStore())||void 0===e?void 0:e.getRecordKey(),r=(0,c().On)(t);return void 0===r?"...":(0,s().H4)(n,r)}),[i,m,o]),b=(0,a().IS)((()=>({buttonStyle:{...h.buttonStyle,...l},buttonPressedStyle:h.buttonPressedStyle??{},buttonHoveredStyle:h.buttonHoveredStyle??{}})),[h.buttonHoveredStyle,h.buttonPressedStyle,h.buttonStyle,l]);return(0,S.jsx)(u().P,{ref:t,style:b.buttonStyle,hoveredStyle:b.buttonHoveredStyle,pressedStyle:b.buttonPressedStyle,onContextMenu:d,quickActionButtons:y,editButtonClickProps:void 0,children:(0,S.jsx)(f().C,{fontColor:"light",children:g})})}))),g=(0,n.forwardRef)((function(e,t){const{store:o,property:n,surface:r}=e,i=(0,l().WS)(),s=R(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:i}).page.text}})),[i]));return(0,S.jsx)(h,{...s,quickActionButtons:(0,S.jsx)(y().i,{store:o,property:n,surface:r})})})),b=(0,n.forwardRef)((function(e,t){const{store:o,property:n,surface:r}=e,{isMobile:i,isPhone:s}=(0,l().Y0)(),c=R(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:s}).table.text}})),[s]));return(0,S.jsx)(h,{...c,quickActionButtons:i?void 0:(0,S.jsx)(y().i,{store:o,property:n,surface:r},"copy")})})),x=(0,n.forwardRef)((function(e,t){const{store:o,property:n,surface:r}=e,{isMobile:i,isPhone:s}=(0,l().Y0)(),c=R(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:s}).compact_page.text}})),[s]));return(0,S.jsx)(h,{...c,quickActionButtons:i?void 0:(0,S.jsx)(y().i,{store:o,property:n,surface:r},"copy")})})),v=(0,n.forwardRef)((function(e,t){const o=R(e,t);return(0,S.jsx)(h,{...o})})),C=(0,n.forwardRef)((function(e,t){const o=R(e,t,(0,m().F)(t,e.collectionStore,e.property,"auto_increment_id"));return(0,S.jsx)(h,{...o})})),k=(0,n.forwardRef)((function(e,t){const o=(0,l().WS)(),n=R(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:o}).board.text}})),[o]));return(0,S.jsx)(h,{...n})})),w=(0,n.forwardRef)((function(e,t){const o=R(e,t);return(0,S.jsx)(h,{...o})})),P=(0,n.forwardRef)((function(e,t){const o=R(e,t);return(0,S.jsx)(h,{...o})})),I=(0,n.forwardRef)((function(e,t){const o=R(e,t);return(0,S.jsx)(h,{...o})})),j=(0,n.forwardRef)((function(e,t){const o=R(e,t);return(0,S.jsx)(h,{...o})})),_=(0,n.forwardRef)((function(e,t){const o=R(e,t);return(0,S.jsx)(h,{...o})}));function R(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l}=e;return{ref:t,store:n,collectionStore:r,property:i,onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle}}var M=()=>o(726637),E=()=>o(406094),B=()=>o(69708),A=()=>o(973647),T=()=>o(534177),L=()=>o(813297),V=()=>o(212395),F=()=>o(859428),W=()=>o(862292),H=()=>o(157857),O=()=>o(645873);const K=n.memo((0,n.forwardRef)((function(e,t){const{store:i,property:s,collectionStore:c,buttonStyle:d,innerButtonStyle:y,onContextMenu:m,disabled:f}=e,h=(0,B().tz)(),[g,b]=(0,n.useState)(!1),x=(0,l().v3)(),{baseStyles:v,propertySchema:C,collectionContextStore:k}=(0,n.useContext)(p().L8),w=C,P=(null==v?void 0:v.sizing)??"default",{value:I}=(0,O().fJ)(W().T.formulas),{value:j}=(0,O().fJ)(L().QV.automationTypecheck),{value:_}=(0,O().fJ)(L().QV.automationActionRegistry),R=(0,r().K8)((()=>{if(null!=w&&w.automation_id)return o(790392).d.createChildStore(c,{table:o(912720).yB,id:w.automation_id,spaceId:c.getSpaceId()})}),[c,w]),K=(0,o(76190).n)(R),D=(0,r().K8)((()=>null==k?void 0:k.settingsStore),[k]),z=(0,r().K8)((()=>{const e=x.currentUser.id;if(I&&j&&_&&k&&"button"===(null==w?void 0:w.type)&&w.automation_id&&i.isPageBlock()&&R)return{type:"button_property",persisted:!0,automationStore:R,collectionContextStore:k,property:s,propertySchema:w,intl:h,parentRecordStore:R,currentUserId:e,pageStore:i,formulasModule:I,isLoggedIn:x.currentUser.isLoggedIn(),automationTypecheckModule:j,automationActionRegistryModule:_}}),[x.currentUser,I,j,_,k,w,i,R,s,h]),N=!(0,r().O$)(o(929219).e),{isDisabled:q,hasError:U}=(0,r().K8)((()=>{if(N||!z)return{isDisabled:!0,hasError:!1};const e=(0,H().lp)({environment:x,isSubscribed:K,...z}).state,t="sufficient"===e.executionPermissionStatus;return{isDisabled:f||!t||!i.canEdit()||g,hasError:(0,T().O9)(e.typecheckResult)&&A().Q.isSuccess(e.typecheckResult)&&(0,o(352271).x4)(e.typecheckResult.value)}}),[x,f,z,i,g,K,N]),Q=(0,n.useCallback)((async()=>{if(z)if(U)k&&D&&w&&o(837570).h({environment:x,mode:"edit_button_property",collectionSettingsStore:D,collectionContextStore:k,property:s,propertySchema:w});else try{var e;b(!0);const{automationExecutionActions:t}=await L().QV.automations.load();await t.executeClientAutomation({environment:x,clientContext:z}),null!==(e=x.mobileNative)&&void 0!==e&&e.buzz?x.mobileNative.buzz():window.navigator.vibrate(20)}finally{b(!1)}}),[z,k,D,x,U,s,w]),J=(0,r().K8)((()=>(null==z?void 0:z.automationStore.getNameStore().getValue())??(null==w?void 0:w.name)),[null==z?void 0:z.automationStore,null==w?void 0:w.name]),$=(0,r().K8)((()=>{if(!M().A.isMobile)return(0,H().nD)(null==z?void 0:z.automationStore)}),[z]),Y=!J||0===J.length,Z=(0,a().IS)((e=>({buttonStyle:{...v.buttonStyle,...d},buttonPressedStyle:v.buttonPressedStyle??{},buttonHoveredStyle:v.buttonHoveredStyle??{},innerButtonStyle:{pointerEvents:"auto",overflow:"hidden",height:"small"===P?20:24,paddingInlineStart:6,paddingInlineEnd:6,...y},innerButtonLabelStyle:{overflow:"hidden",textOverflow:"ellipsis",color:Y?e.text.tertiary:void 0}})),[v.buttonHoveredStyle,v.buttonPressedStyle,v.buttonStyle,d,y,Y,P]),G=e=>(0,S.jsx)(E().A,{disabled:q,disabledFeedback:!0,size:"sm",onClick:Q,style:Z.innerButtonStyle,...e,children:(0,S.jsx)("span",{style:Z.innerButtonLabelStyle,children:Y?(0,S.jsx)(B().sA,{...V().yn.buttonPlaceholder}):J})});return(0,S.jsx)(u().P,{ref:t,style:Z.buttonStyle,hoveredStyle:Z.buttonHoveredStyle,pressedStyle:Z.buttonPressedStyle,editButtonClickProps:void 0,onContextMenu:m,tooltipHide:(0,T().O9)($),tooltipPropertyValue:N?(0,S.jsx)(B().sA,{...o(10521).AY.unavailableOfflineTooltip}):void 0,children:U?(0,S.jsx)(F().A,{placement:"right",renderTooltip:()=>(0,S.jsx)(L().Od,{content:(0,S.jsx)(B().sA,{...o(913687).A.buttonPropertyErrorTooltip}),subtitle:(0,S.jsx)(B().sA,{...V().yn.clickToEdit})}),render:G}):$?(0,S.jsx)(L().Vp,{parentStore:i,urlToPreview:$,renderOrigin:G}):G()})}))),D=(0,n.forwardRef)((function(e,t){const o=(0,l().WS)(),n=X(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:o}).table.button},innerButtonStyle:{maxWidth:"100%"}})),[o]));return(0,S.jsx)(K,{...n})})),z=(0,n.forwardRef)((function(e,t){const o=(0,l().WS)(),n=X(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:o}).page.button}})),[o]));return(0,S.jsx)(K,{...n})})),N=(0,n.forwardRef)((function(e,t){const o=(0,l().WS)(),n=X(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:o}).compact_page.button}})),[o]));return(0,S.jsx)(K,{...n})})),q=(0,n.forwardRef)((function(e,t){const o=X(e,t);return(0,S.jsx)(K,{...o})})),U=(0,n.forwardRef)((function(e,t){const o=X(e,t,(0,m().F)(t,e.collectionStore,e.property,"button"));return(0,S.jsx)(K,{...o})})),Q=(0,n.forwardRef)((function(e,t){const o=(0,l().WS)(),n=X(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:o}).board.button,paddingTop:0,paddingBottom:0},innerButtonStyle:{height:24}})),[o]));return(0,S.jsx)(K,{...n})})),J=(0,n.forwardRef)((function(e,t){const o=X(e,t);return(0,S.jsx)(K,{...o})})),$=(0,n.forwardRef)((function(e,t){const o=X(e,t,(0,a().IS)((()=>({innerButtonStyle:{height:24}})),[]));return(0,S.jsx)(K,{...o})})),Y=(0,n.forwardRef)((function(e,t){const o=X(e,t,(0,a().IS)((()=>({buttonStyle:{maxWidth:200}})),[]));return(0,S.jsx)(K,{...o})})),Z=(0,n.forwardRef)((function(e,t){const o=X(e,t,(0,a().IS)((()=>({buttonStyle:{height:void 0}})),[]));return(0,S.jsx)(K,{...o})})),G=(0,n.forwardRef)((function(e,t){const o=X(e,t);return(0,S.jsx)(K,{...o})}));function X(e,t,o){const{store:n,collectionStore:r,property:i,disabled:l,onContextMenu:a}=e;return{ref:t,store:n,collectionStore:r,property:i,disabled:l,onContextMenu:a,buttonStyle:null==o?void 0:o.buttonStyle,innerButtonStyle:null==o?void 0:o.innerButtonStyle}}var ee=()=>o(657970),te=()=>o(443239),oe=()=>o(299709),ne=()=>o(231297),re=()=>o(90654),ie=()=>o(468882),le=()=>o(802229),ae=()=>o(564883),se=()=>o(324440);const ce=n.memo(n.forwardRef((function(e,t){const{store:o,property:i,enablePointerEventsForInteractiveTypes:s,editButtonClickProps:c,onClick:d,onContextMenu:y,buttonStyle:m,showLabel:f,disabled:h,quickActionButtons:g}=e,b=(0,l().v3)(),x=(0,r().K8)((()=>(0,ee().w)(o.getPropertyValue(i))),[i,o]),{baseStyles:v,propertySchema:C,surface:k,collectionContextStore:w}=(0,n.useContext)(p().L8),P=de(o,i,h),I=C,j=(0,n.useCallback)((()=>{const e=o.getPropertyStore(i);e&&w&&(ne().createAndCommit({userAction:"BlockPropertyValue.handleEditButtonClick",environment:b,canUndo:!0,perform:e=>{re().qS({stores:[o],property:i,transaction:e})}}),(0,oe().E)({environment:b,collectionContextStore:w,block_id:e.id,property:i,property_type:"checkbox",from:(0,ie().zP)(k),isFromBulkActionsToolbar:!1})),d&&d()}),[w,b,k,d,i,o]),_=(0,a().IS)((()=>({buttonStyle:{...v.buttonStyle,...m},buttonPressedStyle:v.buttonPressedStyle??{},buttonHoveredStyle:v.buttonHoveredStyle??{}})),[v,m]);return(0,S.jsx)(u().P,{ref:t,onContextMenu:y,editButtonClickProps:c,style:_.buttonStyle,hoveredStyle:_.buttonHoveredStyle,pressedStyle:_.buttonPressedStyle,quickActionButtons:g,children:(0,S.jsx)(se().o,{propertyLabel:f?null==I?void 0:I.name:void 0,checked:x,enablePointerEventsForInteractiveTypes:s,onClick:j,disabled:P,store:o,property:i})})})));function de(e,t,o){return(0,r().K8)((()=>o||!e.canEdit()||(0,te().u)(t)||e.isNonEditableState()),[o,t,e])}const ue=n.forwardRef((function(e,t){const{store:o,property:r}=e,i=(0,l().WS)(),s=(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:i}).table.checkbox}})),[i]),c=(0,n.useMemo)((()=>(0,S.jsx)(ae().qO,{store:o,property:r},"workflow-autofill")),[r,o]),u=Ce(e,t,s);return(0,S.jsx)(ce,{...u,showLabel:!1,quickActionButtons:c})})),pe=n.forwardRef((function(e,t){const o=(0,l().WS)(),n=Ce(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:o}).page.checkbox}})),[o]));return(0,S.jsx)(ce,{...n,showLabel:!1,collectionStore:e.collectionStore})})),ye=n.forwardRef((function(e,t){const o=(0,l().WS)(),n=Ce(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:o}).compact_page.checkbox}})),[o]));return(0,S.jsx)(ce,{...n,showLabel:!1})})),me=n.forwardRef((function(e,t){const o=Ce(e,t,(0,a().IS)((()=>({buttonStyle:{minWidth:"fit-content"}})),[]));return(0,S.jsx)(ce,{...o,showLabel:!1})})),fe=n.forwardRef((function(e,t){const o=(0,l().WS)(),n=Ce(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:o}).board.checkbox,width:"unset"}})),[o]));return(0,S.jsx)(ce,{...n,showLabel:!0})})),Se=n.forwardRef((function(e,t){const o=Ce(e,t);return(0,S.jsx)(ce,{...o,showLabel:!0})})),he=n.forwardRef((function(e,t){const o=Ce(e,t,(0,a().IS)((()=>({buttonStyle:{width:"unset",minWidth:"unset"}})),[]));return(0,S.jsx)(ce,{...o,showLabel:!0})})),ge=n.forwardRef((function(e,t){const o=Ce(e,t);return(0,S.jsx)(ce,{...o,showLabel:!1})})),be=n.forwardRef((function(e,t){const o=Ce(e,t);return(0,S.jsx)(ce,{...o,showLabel:!1})})),xe=n.forwardRef((function(e,t){const o=Ce(e,t);return(0,S.jsx)(ce,{...o,showLabel:!1})})),ve=n.forwardRef((function(e,t){const o=Ce(e,t);return(0,S.jsx)(ce,{...o,showLabel:!1})}));function Ce(e,t,o){const{store:n,disabled:r,collectionStore:i,property:l,enablePointerEventsForInteractiveTypes:a,onClick:s,onContextMenu:c}=e;return{ref:t,store:n,disabled:r,collectionStore:i,property:l,editButtonClickProps:(0,le().QK)(e),enablePointerEventsForInteractiveTypes:a,onClick:s,onContextMenu:c,buttonStyle:null==o?void 0:o.buttonStyle}}var ke=()=>o(477660),we=()=>o(153364),Pe=()=>o(712354);const Ie=n.memo(n.forwardRef((function(e,t){const{onContextMenu:i,editButtonClickProps:l,property:s,store:c,buttonStyle:d,EmptyComponent:y,quickActionButtons:m=[],showIfEmpty:h,width:g,disableLinkify:b,userExpandable:x}=e,{propertySchema:v,baseStyles:C}=(0,n.useContext)(p().L8),k=(0,ke().z)(v),w=(0,r().K8)((()=>c.getPropertyValue(s)),[s,c]),P=(0,r().K8)((()=>!(!k||"url"!==k.type)&&!k.show_full_url),[k]),I=(0,a().IS)((()=>({buttonStyle:{...C.buttonStyle,...d},buttonPressedStyle:C.buttonPressedStyle??{},buttonHoveredStyle:C.buttonHoveredStyle??{}})),[C.buttonHoveredStyle,C.buttonPressedStyle,C.buttonStyle,d]);return null!=w&&w.length||void 0!==y?(0,S.jsx)(u().P,{ref:t,editButtonClickProps:l,onContextMenu:i,style:I.buttonStyle,pressedStyle:I.buttonPressedStyle,hoveredStyle:I.buttonHoveredStyle,quickActionButtons:m,width:g,userExpandable:x,children:null!=w&&w.length||void 0===y?k?(0,S.jsx)(f().C,{children:(0,S.jsx)(o(891725).LE,{type:k.type,textValue:w,useShortenedUrl:P,disableLinkify:h||b,store:c,property:s})}):null:(0,S.jsx)(y,{})}):null}))),je=n.forwardRef((function(e,t){const{store:o,property:r,surface:i}=e,{isMobile:s}=(0,l().Y0)(),{shouldWrap:c}=(0,n.useContext)(p().L8),u=(0,n.useMemo)((()=>{if(!s)return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ae().qO,{store:o,property:r},"workflow-autofill"),(0,S.jsx)(we().k,{},"comment"),(0,S.jsx)(y().i,{store:o,property:r,surface:i},"copy")]})}),[i,s,r,o]),m=(0,l().WS)(),f=We(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:m}).table.text}})),[m]));return(0,S.jsx)(Ie,{...f,EmptyComponent:Pe().rW,quickActionButtons:u,userExpandable:c})})),_e=n.forwardRef((function(e,t){const{store:o,property:r,surface:i}=e,s=(0,l().WS)(),c=(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:s}).page.text}})),[s]),u=(0,n.useMemo)((()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(we().k,{},"comment"),(0,S.jsx)(y().i,{store:o,property:r,surface:i},"copy")]})),[i,r,o]),p=We(e,t,c);return(0,S.jsx)(Ie,{...p,EmptyComponent:Pe().ao,quickActionButtons:u})})),Re=n.forwardRef((function(e,t){const{store:o,property:r,surface:i}=e,s=(0,l().WS)(),c=(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:s}).compact_page.text}})),[s]),u=(0,n.useMemo)((()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(we().k,{},"comment"),(0,S.jsx)(y().i,{store:o,property:r,surface:i},"copy"),(0,S.jsx)(ae().kF,{},"visit")]})),[i,r,o]),p=We(e,t,c);return(0,S.jsx)(Ie,{...p,EmptyComponent:Pe().ao,quickActionButtons:u,disableLinkify:!0})})),Me=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=We(e,t,(0,m().F)(t,e.collectionStore,e.property,"phone_number"));return(0,S.jsx)(Ie,{...n,EmptyComponent:o?Pe().Jb:void 0})})),Ee=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=(0,l().WS)(),r=We(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:n}).board.text}})),[n]));return(0,S.jsx)(Ie,{...r,EmptyComponent:o?Pe().Jb:void 0})})),Be=n.forwardRef((function(e,t){const o=We(e,t);return(0,S.jsx)(Ie,{...o})})),Ae=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=We(e,t);return(0,S.jsx)(Ie,{...n,EmptyComponent:o?Pe().Jb:void 0})})),Te=n.forwardRef((function(e,t){const o=We(e,t);return(0,S.jsx)(Ie,{...o})})),Le=n.forwardRef((function(e,t){const o=We(e,t);return(0,S.jsx)(Ie,{...o})})),Ve=n.forwardRef((function(e,t){const o=We(e,t);return(0,S.jsx)(Ie,{...o})})),Fe=n.forwardRef((function(e,t){const o=We(e,t);return(0,S.jsx)(Ie,{...o,EmptyComponent:Pe().Fe,showIfEmpty:!0})}));function We(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l,width:a}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,le().QK)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle,width:a}}var He=()=>o(650632),Oe=(o(581454),()=>o(969842)),Ke=()=>o(3079);const De=new(O().O2)("FilePropertyModule",(async()=>await o.e(5938).then(o.bind(o,637360)))),ze=(0,O()._h)(De,(e=>e.FilePropertyModule));var Ne=()=>o(496645),qe=()=>o(213828),Ue=()=>o(586295);const Qe=n.memo(n.forwardRef((function(e,t){const{store:i,EmptyComponent:s,onContextMenu:d,buttonStyle:y,selectableStyle:m,property:f,editButtonClickProps:h,quickActionButtons:g,width:b,shouldDisableLinks:x,shouldTruncateToSingleLine:v,shouldLockImageAspectRatio:C,userExpandable:k}=e,w=(0,l().v3)(),{baseStyles:P,collectionContextStore:I,canEdit:j}=(0,n.useContext)(p().L8),[_,R]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{R(i.clone())}),[i]);const M=(0,n.useCallback)((e=>{re().ho({environment:w,blockPropertyValueOverlayStore:h.blockPropertyValueOverlayStore,store:i,property:f,surface:h.surface,uploadFiles:e.files,disableHorizontalEdgeScroll:h.disableHorizontalEdgeScroll,collectionContextStore:I})}),[I,h.blockPropertyValueOverlayStore,h.disableHorizontalEdgeScroll,h.surface,w,f,i]),E=(0,r().K8)((()=>{const e=i.getPropertyValue(f);return c().pJ(e)}),[i,f]),B=(0,a().IS)((()=>{var e;return{buttonStyle:{...P.buttonStyle,...y},buttonPressedStyle:P.buttonPressedStyle??{},buttonHoveredStyle:P.buttonHoveredStyle??{},selectableStyle:{display:"inherit",borderRadius:null===(e=P.buttonStyle)||void 0===e?void 0:e.borderRadius,...m}}}),[P.buttonHoveredStyle,P.buttonPressedStyle,P.buttonStyle,y,m]),A=!E||0===E.length,T=A&&void 0!==s,L=!A;return _&&(T||L)?(0,S.jsx)(o(199896).Ay,{store:_,canNativeDropOnto:j,onNativeDrop:M,analyticsName:"file_property",shouldShowDropZone:j,style:B.selectableStyle,children:(0,S.jsxs)(u().P,{ref:t,onContextMenu:d,editButtonClickProps:h,style:B.buttonStyle,pressedStyle:B.buttonPressedStyle,hoveredStyle:B.buttonHoveredStyle,quickActionButtons:g,width:b,forceEnableButton:v&&!A,userExpandable:k,children:[T?(0,S.jsx)(s,{}):void 0,L?(0,S.jsx)(Je,{store:i,links:E,property:f,shouldTruncateToSingleLine:v,shouldDisableLinks:x,shouldLockImageAspectRatio:C,tokenFormat:(0,Ne().Ug)(null==P?void 0:P.tokenFormat)}):void 0]})}):null}))),Je=n.memo((function({store:e,links:t,property:n,shouldTruncateToSingleLine:r=!1,shouldDisableLinks:i=!1,shouldLockImageAspectRatio:l=!1,tokenFormat:s}){const c=r?3:void 0,d=(0,qe().s)({propertyId:n,store:e}),u=Boolean(d),p=(0,a().IS)((e=>({wrapperStyle:{...u?{...(0,Oe().sQ)(e.mode),padding:4,lineHeight:2,...!r&&{flexWrap:"wrap",display:"inline-flex"}}:{}},moreToken:{margin:0,flexShrink:0}})),[u,r]),y=c&&t.length>c?t.slice(0,c):t,m=y.length<t.length?t.length-y.length:0;return(0,S.jsxs)(Ue().h,{style:p.wrapperStyle,className:d,children:[y.map(((t,n)=>(0,S.jsx)(o(684847).X,{linkValue:t,store:e,shouldDisableLinks:i,shouldLockImageAspectRatio:l},t.url+n))),m>0?(0,S.jsx)(o(795354).A,{count:m,format:s,style:p.moreToken,fixedHeight:!0,isCompact:!0}):void 0]})})),$e=n.forwardRef((function(e,t){const{shouldWrap:o}=(0,n.useContext)(p().L8),r=(0,l().WS)(),i=at(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:r}).table.button,height:"100%"},selectableStyle:{width:"100%"}})),[r]));return(0,S.jsx)(Qe,{...i,EmptyComponent:Pe().rW,quickActionButtons:(0,S.jsx)(we().k,{},"comment"),userExpandable:o})})),Ye=n.forwardRef((function(e,t){const o=(0,l().WS)(),n=at(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:o}).page.button,height:"100%"},selectableStyle:{width:"100%"}})),[o]));return(0,S.jsx)(Qe,{...n,EmptyComponent:Pe().ao,quickActionButtons:(0,S.jsx)(we().k,{},"comment")})})),Ze=n.forwardRef((function(e,t){const o=(0,l().WS)(),r=(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:o}).compact_page.button}})),[o]),i=(0,n.useMemo)((()=>(0,S.jsx)(we().k,{},"comment")),[]),s=at(e,t,r);return(0,S.jsx)(Qe,{...s,EmptyComponent:Pe().ao,quickActionButtons:i,shouldDisableLinks:!0,shouldLockImageAspectRatio:!0,shouldTruncateToSingleLine:!0})})),Ge=n.forwardRef((function(e,t){const o=at(e,t);return(0,S.jsx)(Qe,{...o,EmptyComponent:Pe().Fe,shouldDisableLinks:!0})})),Xe=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=at(e,t,(0,m().F)(t,e.collectionStore,e.property,"file"));return(0,S.jsx)(Qe,{...n,EmptyComponent:o?Pe().Jb:void 0})})),et=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=(0,l().WS)(),r=at(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:n}).board.button,width:"100%"},selectableStyle:{width:"100%"}})),[n]));return(0,S.jsx)(Qe,{...r,EmptyComponent:o?Pe().Jb:void 0})})),tt=n.forwardRef((function(e,t){const o=at(e,t);return(0,S.jsx)(Qe,{...o})})),ot=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=at(e,t);return(0,S.jsx)(Qe,{...n,EmptyComponent:o?Pe().Jb:void 0})})),nt=n.forwardRef((function(e,t){const o=at(e,t);return(0,S.jsx)(Qe,{...o})})),rt=n.forwardRef((function(e,t){const o=at(e,t);return(0,S.jsx)(Qe,{...o})})),it=n.forwardRef((function(e,t){const o=at(e,t);return(0,S.jsx)(Qe,{...o})})),lt=n.forwardRef((function(e,t){return(0,S.jsx)(Ke().H,{...e,ref:t,children:(0,S.jsx)(ze,{...e})})}));function at(e,t,o){const{store:n,onContextMenu:r,property:i,width:l}=e;return{ref:t,store:n,property:i,editButtonClickProps:(0,le().QK)(e),onContextMenu:r,buttonStyle:null==o?void 0:o.buttonStyle,selectableStyle:null==o?void 0:o.selectableStyle,width:l}}o(16280),o(898992),o(354520);var st=()=>o(852507),ct=()=>o(708685),dt=()=>o(597777),ut=()=>o(869190),pt=()=>o(416504),yt=()=>o(284371),mt=()=>o(847743),ft=()=>o(972435),St=(o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),()=>o(242422)),ht=()=>o(496506),gt=()=>o(247331),bt=()=>o(349835),xt=()=>o(319625),vt=()=>o(909470),Ct=()=>o(991114),kt=()=>o(792415),wt=()=>o(792071),Pt=()=>o(813690);function It(e,t){let o=!1;return[t(wt().b4_.fromMonomorphicFunctionUnsafe((t=>{const n=e.getRecordStore(e,t);return n.isReady()||(o=!0),n.getModel()}),Pt().xb.fromMonomorphicFunctionUnsafe((t=>{const n=e.getRecordStore(e,t);return n.isReady()||(o=!0),n.getValue()})))),o]}function jt(e){const t=function(e){const{blockStore:t,collectionStore:o,propertyId:n,environment:l}=e,{value:a}=(0,O().fJ)(W().T.formulas),s=(0,Ct().C)(),c=(0,B().tz)(),d=(0,i().Ks)(),[u,p]=(0,r().K8)((()=>{var e;return[t.getModel(),null===(e=o.getModel())||void 0===e?void 0:e.getVersion()]}),[t,o]);if(!a)return _t;if((0,T().O9)(p)&&(0,T().O9)(u)){const e=a.getFormula2Thunk({blockModel:u,collectionVersion:p,propertyId:n});if(e)return e}const y=new(ht().ComputedStore)((()=>{var e;const r=o.getSchema(),i=null==r?void 0:r[n];if(!i||"formula"!==i.type||"v2"!==i.version)return;const u=null===(e=i.formula2)||void 0===e?void 0:e.code;if(!u)return{value:{type:"undefined"}};if(!t.isDefined())return gt().FORMULA_LOADING;const p=t.getModel(),y=kt().A.state.publicPageData,[m,f]=It(t,(e=>a.evaluateCollectionFormula2WithoutCache({block:p,collectionFeatureGates:(0,vt().i)(),depth:0,formulaCode:u,formulaTimeoutTimestampMs:Date.now()+s,getRecordModel:e,intl:c,property:n,experimentService:St().default,publicPageDataCollection:{id:null==y?void 0:y.collectionId,schema:null==y?void 0:y.collectionSchema},regExpCache:new Map,resultCache:new Map,formatDateCache:new Map,userTimeZone:(0,pt().P)(),visitedProperties:new Set,spaceIdCreator:l.idCreator.getSpaceIdCreatorSync(p.space_id)})));if(f){const e=Rt({collectionContextStore:d,blockId:t.id,propertyId:n,formulasModule:a});return e?{value:e}:gt().FORMULA_LOADING}return(0,T().O9)(m)?A().Q.isFail(m)?{type:m.error.type,error:m.error}:{value:m.value}:{error:{type:bt().uW.UnexpectedError,error:(0,xt().A)(void 0)}}}),{debugName:`formula2Evaluation${t.id}`,useDeepEqual:!0}),m=()=>y.getState();(0,T().O9)(p)&&(0,T().O9)(u)&&a.setFormula2Thunk({blockModel:u,collectionVersion:p,propertyId:n,thunkCallback:m});return m}(e);return(0,r().K8)((()=>{if(!mt().Pe&&t)return t()}),[t],{debugName:`formula2Evaluation${e.blockStore.id}`,useDeepEqual:!0})}function _t(){return gt().FORMULA_LOADING}function Rt(e){const{collectionContextStore:t,blockId:o,propertyId:n,formulasModule:r}=e,i=null==t?void 0:t.resultSetStore.state.propertyResultCache;if(!(0,T().O9)(i))return;const l=r.getFormula2ResultCache({resultCache:i,blockId:o,property:n});return(0,T().O9)(l)?r.formulaValueToCollectionFormulaValue(l):void 0}var Mt=()=>o(956394),Et=()=>o(710149);function Bt(e){const t=(0,a().IS)((t=>({container:{display:"flex",width:"100%",justifyContent:e.isRightAligned?"flex-end":void 0},shimmer:{width:"60%",marginTop:6,height:10,flexShrink:0,borderRadius:12,backgroundColor:t.lightDividerColor}})),[e.isRightAligned]);return(0,S.jsx)("div",{style:t.container,children:(0,S.jsx)(Et().A,{style:t.shimmer})})}var At=()=>o(59226),Tt=()=>o(648747);const Lt=[bt().uW.MaxEvaluationTimeExceeded,bt().uW.DepthExceeded,bt().uW.CycleDetected];function Vt(e){const{blockStore:t,formula2Result:o,legacyFormulaResult:n,propertySchema:i}=e,l=(0,At().X)("show_all_formula_errors_in_db_views");return(0,r().K8)((()=>{if(!i)return[[],"empty"];var e,r,a;if("v2"!==i.version)return n?n===gt().FORMULA_LOADING?[[],"loading"]:[eo(n),(null===(e=i.formula)||void 0===e?void 0:e.result_type)??"text"]:[[],"empty"];if(void 0===o)return[[],"empty"];if(o===gt().FORMULA_LOADING)return[[],"loading"];if(A().Q.isFail(o))return r=o.error,a=l,"offset"in r||!a&&!Lt.includes(r.type)?[[],"formula"]:[[{id:"error",type:"error",value:o.error}],"error"];if(A().Q.isSuccess(o)){var s;const e=(0,Tt().O)(o.value,t.getRecordModel,(0,pt().P)());return[e,(null===(s=e[0])||void 0===s?void 0:s.type)??"text"]}(0,T().HB)(o)}),[t,o,n,i,l])}const Ft=n.memo(n.forwardRef((function(e,t){var o,i;const{store:s,property:c,EmptyComponent:d,collectionStore:y,onContextMenu:m,editButtonClickProps:h,checkboxButtonStyle:g,textButtonStyle:b,quickActionButtons:x,checkboxShowLabel:v,userExpandable:C}=e,{baseStyles:k,propertySchema:w,surface:P}=(0,n.useContext)(p().L8),I=w,j="v2"===(null==I?void 0:I.version)?null==I||null===(o=I.formula2)||void 0===o?void 0:o.result_type.type:null==I||null===(i=I.formula)||void 0===i?void 0:i.result_type,_=!0===e.numberRightAlign&&"number"===(0,ct().getFormulaPropertySchemaBaseResultType)(I),[R,M]=function(e){const{store:t,collectionStore:o,property:i,checkboxShowLabel:a,numberRightAlign:s}=e,{propertySchema:c,surface:d,collectionSchemaStore:u}=(0,n.useContext)(p().L8),y=(0,l().v3)(),m=(0,r().O$)(u);!function(e){if(void 0===e||"formula"===e.type)return;throw new Error(`Expected a formula property schema, got ${e.type}`)}(c);const f=function(e){const{blockStore:t,collectionSchema:o,propertyId:n,propertySchema:i}=e,{value:l}=(0,O().fJ)(W().T.formulas),a=(0,Ct().C)(),s=(0,B().tz)();return(0,r().K8)((()=>{if(!i||"v2"===i.version)return;if(!l||!o||!t.isDefined())return gt().FORMULA_LOADING;const e=(0,vt().i)(),r=(0,pt().P)(),[c,d]=It(t,(i=>l.evaluateFormulaProperty({block:t.getModel(),collectionRequestContext:{collectionFeatureGates:e,depth:0,experimentService:St().default,formulaTimeoutTimestampMs:Date.now()+a,intl:s,regExpCache:new Map,resultCache:new Map,formatDateCache:new Map,userId:void 0,userTimeZone:r,visitedProperties:new Set},getRecordModel:i,property:n,schema:o,spaceIdCreator:t.environment.idCreator.getSpaceIdCreatorSync(t.getSpaceId())})));return d?gt().FORMULA_LOADING:c}),[i,l,o,t,a,s,n],{debugName:`legacyFormulaEvaluation${t.id}`})}({blockStore:t,collectionSchema:m,propertyId:i,propertySchema:c}),h=jt({blockStore:t,collectionStore:o,propertyId:i,environment:y}),g=Vt({blockStore:t,formula2Result:h,legacyFormulaResult:f,propertySchema:c}),b="loading"===g[1],x=function(e){const{blockStore:t,checkboxShowLabel:o,surface:n,formulaTokenData:i,numberRightAlign:l,propertyId:a,propertySchema:s}=e;return(0,r().K8)((()=>{const[e,r]=i;if("loading"===r)return(0,S.jsx)(Bt,{isRightAligned:l});if(0===e.length)return null;const c=o&&"checkbox"===(0,ct().getFormulaPropertySchemaResultType)(s)&&1===e.length?null==s?void 0:s.name:void 0,d=!!s&&(0,Mt().GL)(r,s),u=1===e.length;return s&&(0,S.jsx)(Mt().Ye,{propertyType:r,rootPropertySchema:s,numberRightAlign:l,store:t,property_id:a,children:e.map(((o,r)=>(0,S.jsx)(Mt().yZ,{token:o,targetPropertySchema:s,blockStore:t,checkboxPropertyLabel:c,withComma:d&&r<e.length-1,numberRightAlign:l,shouldTruncate:u&&"compact_page"===n},`${o.id}-${r}`)))})}),[i,o,s,l,t,a,n])}({blockStore:t,checkboxShowLabel:a,surface:d,formulaTokenData:g,numberRightAlign:s,propertyId:i,propertySchema:c});return[x,b]}({checkboxShowLabel:Boolean(v),collectionStore:y,numberRightAlign:Boolean(_),property:c,store:s});!function(e){const{pageId:t,propertyId:o,isLoading:r}=e,{collectionContextStore:i}=(0,n.useContext)(p().L8);(0,st().w)((()=>{var e;null==i||null===(e=i.propertyResultDurationTracker)||void 0===e||e.trackMount({pageId:t,propertyId:o,propertyType:"formula"})})),(0,n.useEffect)((()=>{if(!r){const e=performance.now();async function n(){var n;const r=await W().T.formulas.load();null==i||null===(n=i.propertyResultDurationTracker)||void 0===n||n.trackResult({pageId:t,propertyId:o,propertyType:"formula",endTime:e,context:{formula_property_cache_result_available:(0,T().O9)(Rt({collectionContextStore:i,blockId:t,propertyId:o,formulasModule:r}))}})}n()}}),[i,r,t,o])}({pageId:s.id,propertyId:c,isLoading:M});const E=(0,a().IS)((e=>({buttonStyle:{...k.buttonStyle,..."checkbox"===j?g:{},..."number"===j||"date"===j||"text"===j?b:{}},buttonPressedStyle:k.buttonPressedStyle??{},buttonHoveredStyle:k.buttonHoveredStyle??{}})),[k.buttonHoveredStyle,k.buttonPressedStyle,k.buttonStyle,g,j,b]),A=(0,qe().s)({propertyId:c,store:s}),L=null===R,V=(0,n.useMemo)((()=>!L&&(0,ie().Lo)(j)),[L,j]);return mt().Pe?(0,S.jsx)("div",{style:{padding:"5px 8px"},children:(0,S.jsx)(f().C,{fontColor:"light",children:(0,S.jsx)(B().sA,{defaultMessage:"Disabled",id:"database.pageProperty.disableFormulas"})})}):L&&void 0===d?null:(0,S.jsxs)(u().P,{ref:t,className:A,onContextMenu:m,editButtonClickProps:h,style:E.buttonStyle,pressedStyle:E.buttonPressedStyle,hoveredStyle:E.buttonHoveredStyle,quickActionButtons:!M&&x?(0,S.jsx)(Wt,{buttons:x,store:s,collectionStore:y,property:c,surface:P,isEmpty:L,isCopyable:V}):void 0,quickActionButtonsAlign:_?"left":void 0,userExpandable:C,children:[L&&d?(0,S.jsx)(d,{}):void 0,L?void 0:R]})})));function Wt(e){const{buttons:t,store:o,property:n,surface:r,isEmpty:i,isCopyable:l}=e;if(i)return null;const a=t.map((e=>{switch(e){case"copy":return l?(0,S.jsx)(y().i,{store:o,property:n,surface:r},"copy"):null;case"comment":return(0,S.jsx)(we().k,{},"comment");default:(0,T().HB)(e)}})).filter(T().Pe);return a?(0,S.jsx)(S.Fragment,{children:a}):null}const Ht=["comment","copy"],Ot=n.forwardRef((function(e,t){const{isMobile:o,isPhone:r}=(0,l().Y0)(),{shouldWrap:i}=(0,n.useContext)(p().L8),s=Xt(e,t,(0,a().IS)((()=>{const e=(0,d()._Q)({isPhone:r});return{checkboxButtonStyle:{...e.table.checkbox},textButtonStyle:{...e.table.text}}}),[r]));return(0,S.jsx)(Ft,{...s,numberRightAlign:!0,EmptyComponent:Pe().rW,quickActionButtons:o?void 0:Ht,userExpandable:i})})),Kt=["comment","copy"],Dt=n.forwardRef((function(e,t){const{isPhone:o}=(0,l().Y0)(),n=Xt(e,t,(0,a().IS)((()=>{const e=(0,d()._Q)({isPhone:o});return{checkboxButtonStyle:{...e.page.checkbox},textButtonStyle:{...e.page.text}}}),[o]));return(0,S.jsx)(Ft,{...n,EmptyComponent:Pe().ao,quickActionButtons:Kt})})),zt=["comment","copy"],Nt=n.forwardRef((function(e,t){const{isMobile:o,isPhone:n}=(0,l().Y0)(),r=Xt(e,t,(0,a().IS)((()=>{const e=(0,d()._Q)({isPhone:n});return{checkboxButtonStyle:{...e.compact_page.checkbox},textButtonStyle:{...e.compact_page.text,width:"100%",...yt().RC}}}),[n]));return(0,S.jsx)(Ft,{...r,EmptyComponent:Pe().ao,quickActionButtons:o?void 0:zt})})),qt=n.forwardRef((function(e,t){const o=Xt(e,t);return(0,S.jsx)(Ft,{...o,EmptyComponent:Pe().Fe})})),Ut=n.forwardRef((function(e,t){const o=Xt(e,t,(0,m().F)(t,e.collectionStore,e.property,"formula"));return(0,S.jsx)(Ft,{...o})})),Qt=n.forwardRef((function(e,t){const o=(0,l().WS)(),n=Xt(e,t,(0,a().IS)((()=>{const e=(0,d()._Q)({isPhone:o});return{checkboxButtonStyle:{...e.board.checkbox},textButtonStyle:{...e.board.text}}}),[o]));return(0,S.jsx)(Ft,{...n,checkboxShowLabel:!0})})),Jt=n.forwardRef((function(e,t){const o=Xt(e,t);return(0,S.jsx)(Ft,{...o,checkboxShowLabel:!0})})),$t=n.forwardRef((function(e,t){const o=Xt(e,t);return(0,S.jsx)(Ft,{...o,checkboxShowLabel:!0})})),Yt=n.forwardRef((function(e,t){const o=Xt(e,t);return(0,S.jsx)(Ft,{...o})})),Zt=n.forwardRef((function(e,t){const o=Xt(e,t);return(0,S.jsx)(Ft,{...o})})),Gt=n.forwardRef((function(e,t){const o=Xt(e,t);return(0,S.jsx)(Ft,{...o})}));function Xt(e,t,o){const{store:n,onContextMenu:r,property:i,collectionStore:l}=e;return{ref:t,store:n,property:i,collectionStore:l,editButtonClickProps:(0,le().QK)(e),onContextMenu:r,checkboxButtonStyle:null==o?void 0:o.checkboxButtonStyle,textButtonStyle:null==o?void 0:o.textButtonStyle}}function eo(e){if(void 0===e)return[];if("string"==typeof e)return 0===e.length?[]:[{id:e,type:"text",value:[[e]]}];if("number"==typeof e)return[{id:e,type:"number",value:e}];if((0,dt().kC)(e)){return[{id:(0,ut().ZF)({allowRelativeDates:!1,value:e,userTimeZone:(0,pt().P)(),intl:ft().A.getIntl()}),type:"date",value:e}]}if("boolean"==typeof e)return[{id:e,type:"checkbox",value:e}];(0,T().HB)(e)}var to=()=>o(381175),oo=()=>o(718827),no=()=>o(584262),ro=()=>o(278238),io=()=>o(176412),lo=()=>o(471095),ao=()=>o(888867),so=()=>o(100622),co=()=>o(857783),uo=()=>o(906719),po=()=>o(565049),yo=()=>o(921855),mo=()=>o(95758),fo=()=>o(898808),So=()=>o(187820);const ho=(0,B().YK)({shared:{defaultMessage:"Shared",id:"CollectionLocation.SidebarTitle.sectionShared"},private:{defaultMessage:"Private",id:"CollectionLocation.SidebarTitle.sectionPrivate"},noAccess:{defaultMessage:"No access",id:"CollectionLocation.noAccess"},emptyCollectionName:{id:"CollectionLocation.EmptyCollectionName",defaultMessage:"Untitled"}});function go(e){return(0,S.jsx)("span",{style:{paddingInlineStart:2,...e.style},children:"/"})}function bo(e){const{collectionForLocationStore:t,collectionContextStore:n,pageStore:i}=e,l=(0,B().tz)(),s=(0,r().K8)((()=>{const e=(0,o(186445).f)(t??i,{includeTeamHomeFeed:!1,includeDataSources:!1});return e.reverse(),e}),[t,i]),{collectionIsInPrivate:c,collectionIsInRestricted:d,collectionIsInShared:u}=(0,r().K8)((()=>{const e=null==n?void 0:n.groupsForTypedDatabasesStore.state;return e&&null!=t&&t.id?{collectionIsInPrivate:Boolean(e.privateDatabases[t.id]),collectionIsInRestricted:Boolean(e.restrictedDatabases[t.id]),collectionIsInShared:Boolean(e.sharedDatabases[t.id])}:{collectionIsInPrivate:!1,collectionIsInRestricted:!1,collectionIsInShared:!1}}),[null==n?void 0:n.groupsForTypedDatabasesStore,null==t?void 0:t.id],{useDeepEqual:!0}),p=(0,r().K8)((()=>(0,so().O4)({theme:"light"})),[]),y=(0,a().IS)((e=>({textStyle:{color:p.popoverWaxPaperBackground,fontWeight:"normal"},shareTypeIndicatorIcon:{width:16,height:16,marginInlineStart:2,marginInlineEnd:2,color:e.gray.icon.secondary,padding:2,backgroundColor:e.gray.background.tertiary,borderRadius:3}})),[p]),m=c||d||u;let f=null;return c?f=(0,S.jsxs)(S.Fragment,{children:[(0,lo().i)(y.shareTypeIndicatorIcon),(0,S.jsx)("span",{children:l.formatMessage(ho.private)})]}):d?f=(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)("div",{style:{...y.shareTypeIndicatorIcon,padding:0,paddingInlineStart:1,margin:0},children:(0,io().L)({...y.shareTypeIndicatorIcon,margin:0,background:void 0})}),(0,S.jsx)("span",{children:l.formatMessage(ho.noAccess)})]}):u&&(f=(0,S.jsxs)(S.Fragment,{children:[(0,ao().s)(y.shareTypeIndicatorIcon),(0,S.jsx)("span",{children:l.formatMessage(ho.shared)})]})),(0,S.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[m?(0,S.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",columnGap:4,...y.textStyle},children:[f,d?void 0:(0,S.jsx)(go,{style:{marginTop:-4,...y.textStyle}})]}):void 0,s.length>3?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(xo,{ancestorStore:s[0],showDivider:!0}),(0,S.jsx)("span",{style:{paddingInlineStart:2,...y.textStyle},children:"..."}),(0,S.jsx)(go,{style:y.textStyle}),c||u?void 0:(0,S.jsx)(xo,{ancestorStore:s[s.length-2],showDivider:!0}),(0,S.jsx)(xo,{ancestorStore:s[s.length-1],showDivider:!1})]}):s.map(((e,t)=>(0,S.jsx)(xo,{ancestorStore:e,showDivider:t<s.length-1},e.id)))]})}function xo(e){const{ancestorStore:t,showDivider:o}=e,n=(0,r().K8)((()=>(0,so().O4)({theme:"light"})),[]),i=(0,r().K8)((()=>{if(t instanceof mo().h)return t.getIcon()}),[t]),l=(0,a().IS)((e=>{let t=e.popoverWaxPaperBackground;if(i)if(i.icon){const o=(0,ro().VA)(i.icon);t="lightgray"===o?e.gray.background.secondary:(e[o]||e.gray).background.secondary}else t=e.gray.background.tertiary;return{teamIconStyle:{background:t},textStyle:{color:n.popoverWaxPaperBackground,fontWeight:"normal"}}}),[n,i]);return t instanceof mo().h?(0,S.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,S.jsx)(po().A,{store:t,showDivider:!1,maxWidth:160,iconSize:16,iconStyle:l.teamIconStyle,titleStyle:l.textStyle,disabled:!1}),o?(0,S.jsx)(go,{style:l.textStyle}):void 0]}):(0,S.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,S.jsx)(uo().A,{store:t,showDivider:!1,emojiSize:18,maxWidth:160,titleStyle:l.textStyle,disabled:!1},t.id),o?(0,S.jsx)(go,{style:l.textStyle}):void 0]})}function vo(e){const{teamStore:t,collectionStore:o}=e,n=(0,r().K8)((()=>o.getIcon()),[o]),i=(0,r().K8)((()=>t.getIcon()),[t]),l=(0,a().IS)((e=>{let t;if(null!=i&&i.icon){const o=(0,ro().VA)(i.icon);t="lightgray"===o?e.gray.background.secondary:(e[o]||e.gray).background.secondary}else t=e.gray.background.secondary;return{miniTeamSpaceIcon:{position:"absolute",bottom:-3,insetInlineEnd:-3,borderRadius:2,background:t},teamSpaceIcon:{borderRadius:3,marginInlineEnd:2}}}),[i]);return n?(0,S.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",position:"relative",marginInlineEnd:2},children:[(0,S.jsx)(So().B6,{icon:n,size:20,emojiSize:20,isEmptyPage:!1,bucket:"public",isLarge:!0,largeIcon:!0,disabled:!0}),(0,S.jsx)(fo().x,{store:t,disabled:!0,size:12,style:l.miniTeamSpaceIcon},"icon")]}):(0,S.jsx)(fo().x,{store:t,disabled:!0,size:20,style:l.teamSpaceIcon},"icon")}const Co=function(e){const{collectionContextStore:t,collectionForLocationStore:n}=e,i=(0,l().v3)(),s=(0,B().tz)(),{collectionIsInPrivate:c,collectionIsInRestricted:d,collectionIsInShared:u}=(0,r().K8)((()=>{const e=t.groupsForTypedDatabasesStore.state;return{collectionIsInPrivate:Boolean(null==e?void 0:e.privateDatabases[n.id]),collectionIsInRestricted:Boolean(null==e?void 0:e.restrictedDatabases[n.id]),collectionIsInShared:Boolean(null==e?void 0:e.sharedDatabases[n.id])}}),[t.groupsForTypedDatabasesStore,n.id],{useDeepEqual:!0}),p=(0,r().K8)((()=>(0,o(422366).U)(n)),[n]),y=(0,r().K8)((()=>(0,yo().r4)(n.getName(),n)??s.formatMessage(ho.emptyCollectionName)),[n,s]),m=(0,r().K8)((()=>n.getIcon()),[n]),f=(0,r().K8)((()=>{var e;return null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.id}),[t]),h=(0,r().K8)((()=>{let e=no().y8.LocationProperty;return f?((0,o(635462).s)(f)&&(e=t.isInHomeWidgetStore.state?no().y8.PersonalHomeTileTasks:no().y8.PersonalHomePageTasks),e):e}),[f,t]),g=(0,a().IS)((e=>({button:{color:e.palette.gray[800],cursor:"pointer"},inner:{display:"flex",flexDirection:"row",alignItems:"center",columnGap:4},shareTypeIndicatorIcon:{width:20,height:20,padding:2,marginInlineEnd:2,color:e.gray.icon.secondary,backgroundColor:e.gray.background.secondaryTranslucent,borderRadius:3},miniShareTypeIndicatorIcon:{position:"absolute",bottom:-3,insetInlineEnd:-3,width:12,height:12,color:e.gray.icon.secondary,backgroundColor:e.gray.background.secondary,borderRadius:3,paddingTop:1,paddingBottom:1},collectionTitleTextStyle:{lineHeight:1,fontWeight:yt().Wy.medium,marginTop:2,marginInlineStart:2,whiteSpace:"nowrap",...(0,ie().w_)(e)}})),[]);if(!(p||c||d||u))return null;const b=c||d||u;let x=(0,ao().s)(g.shareTypeIndicatorIcon);return m?x=(0,S.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",position:"relative"},children:[(0,S.jsx)(So().B6,{icon:m,size:20,emojiSize:20,isEmptyPage:!1,bucket:"public",isLarge:!0,largeIcon:!0,disabled:!0}),c?(0,o(338862).N)(g.miniShareTypeIndicatorIcon):(0,o(668250).R)(g.miniShareTypeIndicatorIcon)]}):d?x=(0,S.jsx)("div",{style:{...g.shareTypeIndicatorIcon,padding:0,margin:0},children:(0,io().L)({...g.shareTypeIndicatorIcon,margin:0,background:void 0})}):c&&(x=(0,lo().i)(g.shareTypeIndicatorIcon)),(0,S.jsx)(oo().Ay,{hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},style:g.button,onClick:e=>{const t=n.getParentBlockStore();if(t){const o=(0,to().V)(e);co().uK({environment:i,store:t,pageVisitSource:h,openInNew:o})}},children:(0,S.jsxs)("div",{style:g.inner,children:[p?(0,S.jsx)(vo,{teamStore:p,collectionStore:n}):void 0,b?x:void 0,(0,S.jsx)("div",{style:g.collectionTitleTextStyle,children:y})]})})};function ko(e){const{blockStore:t}=e,n=(0,l().v3)(),r=(0,a().IS)((e=>({button:{width:"100%",cursor:"pointer",color:e.text.secondary},title:{fontWeight:yt().Wy.regular,whiteSpace:"nowrap",display:"flex",justifyContent:"end",alignItems:"center"},hoveredStyle:{color:e.text.primary,background:"transparent"},pressedStyle:{background:"transparent"}})),[]);return(0,S.jsx)(oo().Ay,{hoveredStyle:r.hoveredStyle,pressedStyle:r.pressedStyle,style:r.button,onClick:e=>{co().uK({environment:n,store:t,openInNew:(0,to().V)(e),pageVisitSource:no().y8.CollectionViewLocationProperty})},children:(0,S.jsx)(o(761652).A,{store:t,useInvertedColors:!1,iconSize:20,style:r.title})})}const wo=n.memo(n.forwardRef((function(e,t){const{store:i,EmptyComponent:l,onContextMenu:s,buttonStyle:c}=e,{baseStyles:d,collectionContextStore:y}=(0,n.useContext)(p().L8),m=(0,r().K8)((()=>i.getAssociatedCollectionStore()),[i]),f=(0,r().K8)((()=>{if(y&&(0,o(384446).Id)(y))return i.getNavigableBlockStore()}),[i,y]),h=(0,a().IS)((()=>({buttonStyle:{...d.buttonStyle,minWidth:32,...c},buttonPressedStyle:d.buttonPressedStyle??{},buttonHoveredStyle:d.buttonHoveredStyle??{}})),[d.buttonHoveredStyle,d.buttonPressedStyle,d.buttonStyle,c]),g=!m&&!f;return g&&void 0===l?null:(0,S.jsx)(u().P,{ref:t,onContextMenu:s,editButtonClickProps:void 0,style:h.buttonStyle,pressedStyle:h.buttonPressedStyle,hoveredStyle:h.buttonHoveredStyle,tooltipPropertyValue:f?(0,S.jsx)(bo,{pageStore:f}):m&&y?(0,S.jsx)(bo,{collectionForLocationStore:m,collectionContextStore:y}):void 0,forceEnableButton:!0,children:g&&void 0!==l?(0,S.jsx)(l,{}):y&&m?(0,S.jsx)(Co,{collectionContextStore:y,collectionForLocationStore:m}):f?(0,S.jsx)(ko,{blockStore:f}):null})}))),Po=n.forwardRef((function(e,t){const o=(0,l().WS)(),n=Vo(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:o}).table.text}})),[o]));return(0,S.jsx)(wo,{...n,EmptyComponent:Pe().rW})})),Io=n.forwardRef((function(e,t){const o=(0,l().WS)(),n=Vo(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:o}).page.text}})),[o]));return(0,S.jsx)(wo,{...n,EmptyComponent:Pe().ao})})),jo=n.forwardRef((function(e,t){const o=(0,l().WS)(),n=Vo(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:o}).compact_page.text}})),[o]));return(0,S.jsx)(wo,{...n,EmptyComponent:Pe().ao})})),_o=n.forwardRef((function(e,t){const o=Vo(e,t);return(0,S.jsx)(wo,{...o,EmptyComponent:Pe().Fe})})),Ro=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=Vo(e,t,(0,m().F)(t,e.collectionStore,e.property,"location"));return(0,S.jsx)(wo,{...n,EmptyComponent:o?Pe().Jb:void 0})})),Mo=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=(0,l().WS)(),r=Vo(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:n}).board.text}})),[n]));return(0,S.jsx)(wo,{...r,EmptyComponent:o?Pe().Jb:void 0})})),Eo=n.forwardRef((function(e,t){const o=Vo(e,t);return(0,S.jsx)(wo,{...o})})),Bo=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=Vo(e,t);return(0,S.jsx)(wo,{...n,EmptyComponent:o?Pe().Jb:void 0})})),Ao=n.forwardRef((function(e,t){const o=Vo(e,t);return(0,S.jsx)(wo,{...o})})),To=n.forwardRef((function(e,t){const o=Vo(e,t);return(0,S.jsx)(wo,{...o})})),Lo=n.forwardRef((function(e,t){const o=Vo(e,t);return(0,S.jsx)(wo,{...o})}));function Vo(e,t,o){const{store:n,onContextMenu:r}=e;return{ref:t,store:n,onContextMenu:r,buttonStyle:null==o?void 0:o.buttonStyle}}var Fo=()=>o(880263),Wo=()=>o(302322),Ho=()=>o(399176);const Oo=n.memo((0,n.forwardRef)((function(e,t){var o,i;const{store:l,buttonStyle:s,onContextMenu:c,editButtonClickProps:d,quickActionButtons:y,EmptyComponent:m,isRightAligned:h,property:g,width:b,userExpandable:x}=e,{baseStyles:v,propertySchema:C,shouldRenderTooltip:k}=(0,n.useContext)(p().L8),w=C,P=(0,r().K8)((()=>{const e=l.getPropertyValue(g);return Wo().M(e)}),[g,l]),I=(0,ie().lh)({numberValue:P,numberFormat:null==w?void 0:w.number_format,numberShowAs:null==w?void 0:w.show_as}),j=(0,a().IS)((()=>({buttonStyle:{...v.buttonStyle,...s},buttonPressedStyle:v.buttonPressedStyle??{},buttonHoveredStyle:v.buttonHoveredStyle??{}})),[v.buttonHoveredStyle,v.buttonPressedStyle,v.buttonStyle,s]);if(void 0===P&&void 0===m)return null;const _="bar"===(null==w||null===(o=w.show_as)||void 0===o?void 0:o.type)||"ring"===(null==w||null===(i=w.show_as)||void 0===i?void 0:i.type);return(0,S.jsx)(u().P,{ref:t,style:j.buttonStyle,hoveredStyle:j.buttonHoveredStyle,pressedStyle:j.buttonPressedStyle,onContextMenu:c,editButtonClickProps:d,quickActionButtons:y,quickActionButtonsAlign:h?"left":void 0,tooltipPropertyValue:k?I:void 0,width:b,userExpandable:x,children:void 0===P&&void 0!==m?(0,S.jsx)(m,{}):_?(0,S.jsx)(Ue().h,{isRightAligned:h,children:(0,S.jsx)(Ho().E,{numberValue:P,isRightAligned:h,store:l,property:g})}):(0,S.jsx)(f().C,{isRightAligned:h,children:(0,S.jsx)(Ho().E,{numberValue:P,isRightAligned:h,store:l,property:g})})})}))),Ko=(0,n.forwardRef)((function(e,t){const{store:o,property:r,surface:i}=e,s=(0,l().WS)(),c=Go(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:s}).page.text}})),[s])),u=(0,n.useMemo)((()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(we().k,{},"comment"),(0,S.jsx)(y().i,{store:o,property:r,surface:i},"copy")]})),[i,r,o]);return(0,S.jsx)(Oo,{...c,EmptyComponent:Pe().ao,quickActionButtons:u})})),Do=(0,n.forwardRef)((function(e,t){const{store:o,property:r,surface:i}=e,{isMobile:s,isPhone:c}=(0,l().Y0)(),{shouldWrap:u}=(0,n.useContext)(p().L8),m=(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:c}).table.text}})),[c]),f=(0,n.useMemo)((()=>{if(!s)return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ae().qO,{store:o,property:r},"workflow-autofill"),(0,S.jsx)(we().k,{},"comment"),(0,S.jsx)(y().i,{store:o,property:r,surface:i},"copy")]})}),[i,s,r,o]),h=Go(e,t,m);return(0,S.jsx)(Oo,{...h,EmptyComponent:Pe().rW,quickActionButtons:f,isRightAligned:!0,userExpandable:u})})),zo=(0,n.forwardRef)((function(e,t){const{store:o,property:r,surface:i}=e,{isMobile:s,isPhone:c}=(0,l().Y0)(),u=(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:c}).compact_page.text}})),[c]),p=(0,n.useMemo)((()=>{if(!s)return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(we().k,{},"comment"),(0,S.jsx)(y().i,{store:o,property:r,surface:i},"copy")]})}),[i,s,r,o]),m=Go(e,t,u);return(0,S.jsx)(Oo,{...m,EmptyComponent:Pe().ao,quickActionButtons:p})})),No=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=Go(e,t,(0,m().F)(t,e.collectionStore,e.property,"number"));return(0,S.jsx)(Oo,{...n,EmptyComponent:o?Pe().Jb:void 0})})),qo=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=(0,l().WS)(),r=Go(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:n}).board.text}})),[n]));return(0,S.jsx)(Oo,{...r,EmptyComponent:o?Pe().Jb:void 0})})),Uo=(0,n.forwardRef)((function(e,t){const o=Go(e,t);return(0,S.jsx)(Oo,{...o})})),Qo=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=Go(e,t);return(0,S.jsx)(Oo,{...n,EmptyComponent:o?Pe().Jb:void 0})})),Jo=(0,n.forwardRef)((function(e,t){const o=Go(e,t);return(0,S.jsx)(Oo,{...o})})),$o=(0,n.forwardRef)((function(e,t){const o=Go(e,t);return(0,S.jsx)(Oo,{...o})})),Yo=(0,n.forwardRef)((function(e,t){const o=Go(e,t);return(0,S.jsx)(Oo,{...o})})),Zo=(0,n.forwardRef)((function(e,t){const o=Go(e,t);return(0,S.jsx)(Oo,{...o,EmptyComponent:Pe().Fe})}));function Go(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l,width:a}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,le().QK)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle,width:a}}var Xo=()=>o(32064),en=()=>o(96330),tn=()=>o(495748),on=()=>o(346863);function nn({placeValue:e,width:t}){const{addressFirstLine:o,addressRest:r}=(0,n.useMemo)((()=>e.address?(0,en().lS)(e.address):{addressFirstLine:"",addressRest:""}),[e.address]),i=(0,a().IS)((e=>({addressFirstLine:{fontWeight:"bold",fontSize:"14px",paddingTop:4,paddingInlineEnd:4,paddingBottom:0,paddingInlineStart:4},addressRest:{fontSize:"12px",paddingTop:0,paddingInlineEnd:4,paddingBottom:4,paddingInlineStart:4,color:e.text.secondary},container:{minWidth:t}})),[t]);return(0,S.jsxs)("div",{style:i.container,children:[(0,S.jsx)("div",{style:i.addressFirstLine,children:o}),(0,S.jsx)("div",{style:i.addressRest,children:r}),(0,S.jsx)(tn().Vt,{place:e})]})}const rn=n.memo((0,n.forwardRef)(((e,t)=>{const{store:i,buttonStyle:l,onContextMenu:s,editButtonClickProps:c,quickActionButtons:d=[],EmptyComponent:y,property:m,width:h,userExpandable:g,forceBlockPropertyButtonEnable:b=!1}=e,{baseStyles:x}=(0,n.useContext)(p().L8),v=(0,r().K8)((()=>i.getPropertyValue(m)),[m,i]),C=(0,a().IS)((()=>({buttonStyle:{...x.buttonStyle,...l},buttonPressedStyle:x.buttonPressedStyle??{},buttonHoveredStyle:x.buttonHoveredStyle??{}})),[x.buttonHoveredStyle,x.buttonPressedStyle,x.buttonStyle,l]);return null!=v&&v.length||void 0!==y?(0,S.jsx)(u().P,{ref:t,style:C.buttonStyle,hoveredStyle:C.buttonHoveredStyle,pressedStyle:C.buttonPressedStyle,onContextMenu:s,editButtonClickProps:c,quickActionButtons:d,forceEnableButton:b,width:h,userExpandable:g,children:null!=v&&v.length||void 0===y?(0,S.jsx)(f().C,{children:(0,S.jsx)(o(625194).m,{textValue:v,parentStore:i})}):(0,S.jsx)(y,{})}):null}))),ln=(0,n.forwardRef)((function(e,t){const{store:o,property:r,surface:i}=e,s=(0,l().WS)(),c=(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:s}).page.text}})),[s]),u=(0,n.useMemo)((()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(on().A,{store:o,property:r,openOverlay:!0},"autofill"),(0,S.jsx)(we().k,{},"comment"),(0,S.jsx)(y().i,{store:o,property:r,surface:i},"copy")]})),[i,r,o]),p=gn(e,t,c);return(0,S.jsx)(rn,{...p,EmptyComponent:Pe().ao,quickActionButtons:u})})),an=(0,n.forwardRef)((function(e,t){const{store:o,property:i,surface:s}=e,{isMobile:c,isPhone:u}=(0,l().Y0)(),p=(0,a().IS)((e=>({buttonStyle:{...(0,d()._Q)({isPhone:u}).table.text},tooltipStyle:{backgroundColor:e.background.primary,color:e.text.primary,boxShadow:e.shadowLG}})),[u]),m=(0,r().K8)((()=>{const e=o.getPropertyValue(i);return(0,en().eC)(e)}),[o,i]),f=(0,n.useMemo)((()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(on().A,{store:o,property:i,openOverlay:!0},"autofill"),(0,S.jsx)(we().k,{},"comment"),c?null:(0,S.jsx)(y().i,{store:o,property:i,surface:s},"copy")]})),[s,c,i,o]),h=gn(e,t,p);return(0,S.jsx)(F().A,{renderTooltip:()=>(0,S.jsx)(nn,{placeValue:m,width:h.width}),disableTooltip:!m,render:e=>(0,S.jsx)("div",{...e,style:{width:"100%"},children:(0,S.jsx)(rn,{...h,EmptyComponent:Pe().rW,quickActionButtons:f,userExpandable:!0})}),placement:"bottom",alignment:"start",style:p.tooltipStyle})})),sn=n.forwardRef((function(e,t){const{propertyModule:n}=e;if(!n||n&&!(0,o(778781).NS)(n))throw new Error("PlacePropertyModule can only be used with place property modules");const i=(0,r().K8)((()=>(0,en().eC)(e.store.getPropertyValue(e.property))),[e.store,e.property]);return(0,S.jsxs)(Ke().H,{...e,ref:t,children:[(0,S.jsx)(ln,{...e}),"map"===n.style&&i?(0,S.jsx)(tn().Vt,{place:i}):void 0]})})),cn=(0,n.forwardRef)((function(e,t){const{store:o,property:r,surface:i}=e,{isMobile:s,isPhone:c}=(0,l().Y0)(),u=(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:c}).compact_page.text,maxWidth:"300px"}})),[c]),p=(0,n.useMemo)((()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(we().k,{},"comment"),s?null:(0,S.jsx)(y().i,{store:o,property:r,surface:i},"copy")]})),[i,s,r,o]),m=gn(e,t,u);return(0,S.jsx)(rn,{...m,EmptyComponent:Pe().ao,quickActionButtons:p,linkifyUrls:!1,disableLinks:!0})})),dn=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=gn(e,t,(0,m().F)(t,e.collectionStore,e.property,"text"));return(0,S.jsx)(rn,{...n,EmptyComponent:o?Pe().Jb:void 0})})),un=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=(0,l().WS)(),r=gn(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:n}).board.text}})),[n]));return(0,S.jsx)(rn,{...r,EmptyComponent:o?Pe().Jb:void 0})})),pn=(0,n.forwardRef)((function(e,t){const o=gn(e,t);return(0,S.jsx)(rn,{...o})})),yn=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=gn(e,t);return(0,S.jsx)(rn,{...n,EmptyComponent:o?Pe().Jb:void 0})})),mn=(0,n.forwardRef)((function(e,t){const o=gn(e,t);return(0,S.jsx)(rn,{...o})})),fn=(0,n.forwardRef)((function(e,t){const o=gn(e,t);return(0,S.jsx)(rn,{...o})})),Sn=(0,n.forwardRef)((function(e,t){const o=gn(e,t);return(0,S.jsx)(rn,{...o})})),hn=(0,n.forwardRef)((function(e,t){const o=gn(e,t);return(0,S.jsx)(rn,{...o,EmptyComponent:Pe().Fe})}));function gn(e,t,o){const{store:n,collectionStore:r,property:i,disabled:l,onContextMenu:a,width:s}=e;return{ref:t,store:n,collectionStore:r,property:i,disabled:l,editButtonClickProps:(0,le().QK)(e),onContextMenu:a,buttonStyle:null==o?void 0:o.buttonStyle,width:s}}var bn=()=>o(413987),xn=(o(944114),o(672577),o(803949),()=>o(187696)),vn=()=>o(952882),Cn=()=>o(363170),kn=()=>o(898244),wn=()=>o(568063),Pn=()=>o(604995),In=()=>o(450648),jn=()=>o(559653),_n=()=>o(201980),Rn=()=>o(496603),Mn=()=>o(722372),En=()=>o(148832),Bn=()=>o(359161),An=()=>o(173019),Tn=()=>o(454305),Ln=()=>o(581350),Vn=()=>o(527257);const Fn=(0,B().YK)({rollup:{defaultMessage:"Configure rollup",id:"database.editButton.configureRollupTooltip"}});function Wn(e){const{type:t,editButtonClickProps:o}=e,i=(0,l().v3)(),{isMobile:s}=(0,l().Y0)(),{containerRef:c,collectionContextStore:d,canEdit:u}=(0,n.useContext)(p().L8),y=(0,r().uB)(void 0,Tn().A),m=(0,n.useMemo)((()=>ft().A.formatMessage(Fn[t])),[t]),f=(0,a().IS)((e=>({iconStyle:{color:e.text.secondary,fill:e.text.secondary},button:{height:20,width:20}})),[]),h=(0,n.useCallback)((async e=>{if(void 0===o)return;const{onClick:t,store:n,property:r,surface:l,collectionStore:a,blockPropertyValueOverlayStore:s,disableHorizontalEdgeScroll:u}=o,p=c&&"current"in c&&(null==c?void 0:c.current)||void 0;await Ln().V({element:p,environment:i,onClick:t,store:n,property:a.getMappedProperty(r),surface:l,collectionStore:a,blockPropertyValueOverlayStore:s,disableHorizontalEdgeScroll:u,collectionContextStore:d,mouseStore:y})}),[d,c,o,i,y]);return!u||s?null:(0,S.jsx)(Vn().A,{icon:An().r,tooltip:m,onClick:h,style:f.button,iconStyle:f.iconStyle})}const Hn=n.memo(n.forwardRef((function(e,t){const{store:s,property:d,EmptyComponent:y,collectionStore:m,onContextMenu:h,editButtonClickProps:g,checkboxButtonStyle:b,textButtonStyle:x,buttonButtonStyle:v,quickActionButtons:C,numberRightAlign:k,userExpandable:w}=e,{baseStyles:P,surface:I,collectionSchemaStore:j}=(0,n.useContext)(p().L8),_=(0,r().O$)(j),R=(0,l().v3)(),M=(0,Ct().C)(),E=(0,r().K8)((()=>{if(!_)return;const e=(0,wn().fS)({schema:_,property:d});if(e.isValid&&"people_collection"===e.type)return(0,o(981342).vT)({spaceStore:s.getSpaceStore(),environment:R});if(e.isValid&&"relation"===e.type){const t=e.relationPropertySchema,n=kn().Nv(t);return n?o(543665).m.createChildStore(s,n):void 0}}),[R,d,_,s]),B=(0,o(369955).L)(),A=(0,r().K8)((()=>R.idCreator.getSpaceIdCreatorSync((null==B?void 0:B.id)??"")),[R,B]),T=(0,r().K8)((()=>{if(void 0!==_)return(0,wn().eY)({property:d,schema:_,preLoadedTargetCollectionModel:null==E?void 0:E.getModel(),getRecordModel:m.getRecordModel,spaceIdCreator:A,block:s.getModel()})}),[_,d,E,A,s,m.getRecordModel]),{element:L,isLoading:V,aggregationType:F}=function(e){const{schema:t,property:o,blockStore:a,rollupPropertyData:s,numberRightAlign:c,clientFormulaTimeoutMs:d}=e,{value:u}=(0,O().fJ)(W().T.formulas),p=(0,i().Ks)(),y=(0,l().v3)(),m=(0,r().K8)((()=>{const e=a.getModel(),{propertySchema:n,targetPropertySchema:r}=s??{};if(null==n||!n.aggregation||"show_unique"===n.aggregation||!e||!t){const e=()=>{if(!t)return{isLoading:!0,aggregationType:"unknown"};if(!n){return(0,wn().fS)({schema:t,property:o}).isValid?{isLoading:!0,aggregationType:"unknown"}:{isLoading:!1,aggregationType:"invalid-schema"}}return n.aggregation&&"show_unique"!==n.aggregation?{isLoading:!0,aggregationType:n.aggregation}:{isLoading:!1,aggregationType:n.aggregation}};return{rollupType:null==s?void 0:s.rollupType,rollupAggregationValue:void 0,numberFormat:void 0,numberPrecision:void 0,...e()}}const i=n.aggregation,l=y.idCreator.getSpaceIdCreatorSync(e.space_id),[c,m]=function({collectionContextStore:e,blockStore:t,blockModel:o,property:n,schema:r,collectionRequestContext:i,formulasModule:l,spaceIdCreator:a}){const[s,c]=It(t,(e=>(0,wn().Pm)({block:o,property:n,schema:r,getRecordModel:e,collectionRequestContext:i,formulasModule:l,spaceIdCreator:a})));if(c){const t=(0,wn().tf)({remoteResultCache:null==e?void 0:e.resultSetStore.state.propertyResultCache,blockId:o.id,property:n});if(t){if("on"===St().default.getEligibleGroup({experimentId:"rollups_enable_forward_property_cache_server_v3",defaultGroup:"control"}))return[t,!1]}}return[s,c]}({collectionContextStore:p,blockStore:a,blockModel:e,property:o,schema:t,collectionRequestContext:{userId:void 0,userTimeZone:(0,pt().P)(),depth:0,intl:ft().A.getIntl(),visitedProperties:new Set,resultCache:new Map,regExpCache:new Map,formatDateCache:new Map,formulaTimeoutTimestampMs:Date.now()+d,experimentService:St().default,collectionFeatureGates:(0,vt().i)()},formulasModule:u,spaceIdCreator:l});if(!c)return{rollupAggregationValue:void 0,numberFormat:void 0,numberPrecision:void 0,aggregationType:i,isLoading:m};const f=(0,Mn().o_)(n.aggregation,"formula"===(null==r?void 0:r.type)||"number"===(null==r?void 0:r.type)?r.number_format:void 0),S=(0,Mn().zI)(n.aggregation,"formula"===(null==r?void 0:r.type)||"number"===(null==r?void 0:r.type)?r.number_precision:void 0);if(f){const e=void 0===(null==c?void 0:c.value)||null===(null==c?void 0:c.value)||"number"!=typeof c.value?void 0:Number(c.value);if(void 0!==e&&!isNaN(e))return{rollupAggregationValue:e,numberFormat:f,numberPrecision:S,isLoading:m,aggregationType:i}}const h=(0,Mn().Y9)({numberFormat:void 0,dateFormat:r&&"date_format"in r?r.date_format:void 0,aggregationType:n.aggregation,value:c,userTimeZone:(0,pt().P)(),numberPrecision:void 0});return void 0===h||""===h?{rollupAggregationValue:void 0,numberFormat:void 0,numberPrecision:void 0,isLoading:m,aggregationType:i}:{rollupAggregationValue:h,numberFormat:void 0,numberPrecision:void 0,isLoading:m,aggregationType:i}}),[a,s,t,o,u,d,y.idCreator,p]),h=(0,n.useMemo)((()=>{if(m.isLoading){var e,t;const o=Boolean(!0===c&&(null==s||null===(e=s.propertySchema)||void 0===e?void 0:e.aggregation)&&void 0!==(0,Mn().o_)(null==s||null===(t=s.propertySchema)||void 0===t?void 0:t.aggregation,"number"));return(0,S.jsx)(Bt,{isRightAligned:o})}const{rollupAggregationValue:o,numberFormat:n,numberPrecision:r}=m;if(void 0===o)return null;if(n){var i,l;return"bar"===(null==s||null===(i=s.propertySchema)||void 0===i||null===(i=i.show_as)||void 0===i?void 0:i.type)||"ring"===(null==s||null===(l=s.propertySchema)||void 0===l||null===(l=l.show_as)||void 0===l?void 0:l.type)?(0,S.jsx)(Ue().h,{isRightAligned:c,children:(0,S.jsx)(Ho().E,{numberFormatOverride:n,numberPrecisionOverride:r,numberValue:o,isRightAligned:c})}):(0,S.jsx)(f().C,{isRightAligned:c,children:(0,S.jsx)(Ho().E,{numberFormatOverride:n,numberPrecisionOverride:r,numberValue:o,isRightAligned:c})})}return(0,S.jsx)(f().C,{children:o})}),[c,null==s?void 0:s.propertySchema,m]);return{element:h,isLoading:m.isLoading,aggregationType:m.aggregationType}}({blockStore:s,schema:_,property:d,rollupPropertyData:T,numberRightAlign:k,clientFormulaTimeoutMs:M}),H=function(e){const{store:t,rollupPropertyData:i,numberRightAlign:a,clientFormulaTimeoutMs:s,surface:d,targetCollectionStore:u}=e,{value:p}=(0,O().fJ)(W().T.formulas),y=(0,l().v3)(),{propertySchema:m}=i||{},f=(0,r().K8)((()=>{if(!i||!m)return[];const e=new Map,n=new Map,r=new Map,l=y.idCreator.getSpaceIdCreatorSync(t.getSpaceId());if("person"===i.rollupType){const a=t.getModel();if(!a)return[];const c=(0,Cn().e)({textValue:m.person_property?a.getProperty(m.person_property):void 0,propertySchema:i.personPropertySchema,blockCreatorPointer:wt().Bj6.fromBlock(a).getCreatedByPointer(),convertGroupPointersToBeComposite:!0}),d=[];return c.forEach((a=>{const c=t.getRecordModel(a);if("notion_user"===(null==c?void 0:c.table))if((0,wn().cl)(i.targetProperty)){let e;i.targetProperty===vn().zi?e=c.getEmail():i.targetProperty===vn().Ym&&(e=c.getFullName(ft().A.getIntl())??c.getEmail()),e&&d.push({token:{id:e,type:"text",value:[[e]]},blockStore:null})}else if(i.targetCollectionSchema&&i.targetPropertySchema&&u){if(!t.getSpaceId()||null==c||!c.id)return;const a=(0,o(571595).ZH)({spaceIdCreator:l,userId:c.id}),m=En().B.createChildStore(t,a);Kn({textValue:m.getPropertyValue(i.targetProperty),blockStore:m,targetCollectionStore:u,targetPropertySchema:i.targetPropertySchema,targetProperty:i.targetProperty,currentUserId:y.currentUser.id,clientFormulaTimeoutMs:s,resultCache:e,regExpCache:n,formatDateCache:r,formulasModule:p,spaceIdCreator:l}).forEach((e=>{d.push({token:e,blockStore:m})}))}})),"show_unique"===m.aggregation?Rn().hS(d,(e=>e.token.id)):d}if("relation"===i.rollupType&&u&&i.targetPropertySchema){const o=t.getModel(),a=[];if(o&&m.relation_property&&i.relationPropertySchema&&i.targetCollectionModel){const e=c().bG({relationValue:c().n(c().yQ(o,m.relation_property)),getRecordModel:t.getRecordModel,propertySchema:i.relationPropertySchema,includeNoAccess:!0}).map((e=>En().B.createChildStore(t,e)));a.push(...e.filter((e=>{var t;return(null===(t=e.getAssociatedCollectionStore())||void 0===t?void 0:t.id)===i.targetCollectionModel.id})))}const d=[];for(const t of a){const o=Kn({textValue:t.getPropertyValue(i.targetProperty),blockStore:t,targetCollectionStore:u,targetPropertySchema:i.targetPropertySchema,targetProperty:i.targetProperty,currentUserId:y.currentUser.id,clientFormulaTimeoutMs:s,resultCache:e,regExpCache:n,formatDateCache:r,formulasModule:p,spaceIdCreator:l});for(const e of o)d.push({token:e,blockStore:t})}return"show_unique"===m.aggregation?Rn().hS(d,(e=>e.token.id)):d}return[]}),[i,m,u,t,y,s,p]);return(0,n.useMemo)((()=>{if(null==f||!f.length||!m)return null;const e=1===f.length,o=f[0].token.type,n=(0,Mt().GL)(o,m);return(0,S.jsx)(Mt().Ye,{propertyType:o,rootPropertySchema:m,numberRightAlign:a,children:f.map(((o,r)=>(0,S.jsx)(Mt().yZ,{token:o.token,targetPropertySchema:"relation"===(null==i?void 0:i.rollupType)?i.targetPropertySchema:void 0,blockStore:o.blockStore??t,withComma:n&&r<f.length-1,numberRightAlign:a,shouldTruncate:e&&"compact_page"===d},`${o.token.id}-${r}`)))})}),[f,m,a,d,t,i])}({store:s,rollupPropertyData:T,numberRightAlign:k,clientFormulaTimeoutMs:M,targetCollectionStore:E,surface:I}),K=!L&&!H;!function(e){const{store:t,property:o,isLoading:r,aggregationType:i}=e,{surface:l,collectionContextStore:a}=(0,n.useContext)(p().L8);(0,st().w)((()=>{var e;"table"===l&&(null==a||null===(e=a.propertyResultDurationTracker)||void 0===e||e.trackMount({pageId:t.id,propertyId:o,propertyType:"rollup"}))})),(0,n.useEffect)((()=>{var e;"table"!==l||r||"invalid-schema"===i||"unknown"===i||(null==a||null===(e=a.propertyResultDurationTracker)||void 0===e||e.trackResult({pageId:t.id,propertyId:o,propertyType:"rollup",context:{rollup_aggregation_type:i}}))}),[a,l,o,t,r,i])}({store:s,property:d,isLoading:V,aggregationType:F});const D=(0,n.useMemo)((()=>{if(K||!T)return!1;switch(T.rollupType){case"person":return(0,ie().Lo)(T.rollupType);case"relation":return(0,ie().Lo)(T.targetPropertySchema.type)}}),[K,T]),z=(0,r().K8)((()=>{if(K||!T)return"text";const{targetPropertySchema:e,propertySchema:t}=T;return void 0!==(null==t?void 0:t.aggregation)&&"show_unique"!==t.aggregation?void 0!==(0,Mn().o_)(t.aggregation,"number")?"number":"text":e?function(e){if(!e)return"text";if("formula"===e.type){if(e.formula2){const t=(0,o(239381).pg)(e.formula2.result_type).type;return"block"===t?"relation":"unknown"===t||"array"===t?"text":t}return"text"}return"rollup"===e.type?"text":e.type}(e):"text"}),[K,T]),N=(0,a().IS)((e=>({buttonStyle:{...P.buttonStyle,..."checkbox"===z?b:{},..."title"!==z&&(0,Ne().YX)(z)?x:{},...(0,Ne()._t)(z)?v:{}},buttonPressedStyle:P.buttonPressedStyle??{},buttonHoveredStyle:P.buttonHoveredStyle??{}})),[P.buttonHoveredStyle,P.buttonPressedStyle,P.buttonStyle,v,b,z,x]);if(K&&void 0===y)return null;const q=!0===k&&"number"===z;return(0,S.jsx)(u().P,{ref:t,onContextMenu:h,editButtonClickProps:g,style:N.buttonStyle,pressedStyle:N.buttonPressedStyle,hoveredStyle:N.buttonHoveredStyle,quickActionButtons:C?(0,S.jsx)(On,{buttons:C,editButtonClickProps:g,store:s,property:d,surface:I,isEmpty:K,isCopyable:D}):void 0,quickActionButtonsAlign:q?"left":void 0,userExpandable:w,children:K?y?(0,S.jsx)(y,{}):null:L??H})})));function On({buttons:e,editButtonClickProps:t,store:o,property:n,surface:r,isEmpty:i,isCopyable:l}){const a=e.map((e=>{switch(e){case"edit":return(0,S.jsx)(Wn,{type:"rollup",editButtonClickProps:t},e);case"copy":return l?(0,S.jsx)(y().i,{store:o,property:n,surface:r},e):null;default:(0,T().HB)(e)}})).filter(T().Pe);return a?(0,S.jsx)(S.Fragment,{children:a}):null}function Kn(e){var t;const{textValue:o,blockStore:n,targetCollectionStore:r,targetPropertySchema:i,targetProperty:l,clientFormulaTimeoutMs:a,resultCache:d,regExpCache:u,formatDateCache:p,formulasModule:y,spaceIdCreator:m}=e,{type:f}=i;switch(f){case"auto_increment_id":if(void 0===o)return[];const h=null===(t=r.getRecordKeyStore())||void 0===t?void 0:t.getRecordKey(),g=(0,s().H4)(h,c().On(o));return g?[{id:g,type:"text",value:[[g]]}]:[];case"button":case"rollup":case"location":case"verification":return[];case"checkbox":{const e=(0,ee().w)(o);return[{id:e,type:"checkbox",value:e}]}case"date":{const e=(0,xn().b)(o);if(void 0===e)return[];return[{id:ut().ZF({allowRelativeDates:!1,value:e,userTimeZone:(0,pt().P)(),intl:ft().A.getIntl()}),type:"date",value:e}]}case"email":case"phone_number":case"url":return void 0===o?[]:[{id:(0,_n().k4p)(o),type:f,value:o}];case"file":return c().pJ(o).map((e=>({id:e.url,type:"file",value:e})));case"formula":{const e=n.getModel();if(void 0===e)return[];if(!y)return[];const t=ft().A.getIntl(),o=(0,pt().P)();if("v2"===i.version){var S;if(null===(S=i.formula2)||void 0===S||!S.code)return[];const r=y.evaluateCollectionFormula2({block:e,property:l,formulaCode:i.formula2.code,getRecordModel:n.getRecordModel,intl:t,userTimeZone:o,depth:0,visitedProperties:new Set,formulaTimeoutTimestampMs:Date.now()+a,resultCache:d,regExpCache:u,formatDateCache:p,experimentService:St().default,collectionFeatureGates:(0,vt().i)(),spaceIdCreator:m});return r?(0,Tt().O)(r,n.getRecordModel,o):[]}return eo(y.evaluateFormulaProperty({property:l,schema:n.getSchema(),block:e,getRecordModel:n.getRecordModel,collectionRequestContext:{userId:void 0,userTimeZone:o,depth:0,intl:t,resultCache:d,regExpCache:u,formatDateCache:p,visitedProperties:new Set,formulaTimeoutTimestampMs:Date.now()+a,experimentService:St().default,collectionFeatureGates:(0,vt().i)()},spaceIdCreator:m}))}case"select":{const e=c().L3(o,i.options??[]);if(!i.options||!e)return[];return[{id:e,type:"select",value:e,color:(0,c().FE)(i.options??[],e)}]}case"multi_select":return c().o2(o,i.options??[]).map((e=>({id:e,type:"select",value:e,color:(0,c().FE)(i.options??[],e)})));case"number":{const e=Wo().M(o);return void 0===e?[]:[{id:e,type:"number",value:e}]}case"person":return(0,Cn().e)({textValue:o,propertySchema:i,blockCreatorPointer:n.getCreatedByPointer(),convertGroupPointersToBeComposite:!0}).map((e=>({id:e.id,type:"person",value:e})));case"title":if(void 0===r)return[];return[{id:(0,In().r4)({textValue:o,getRecordModel:n.getRecordModel,deterministic:!0,userTimeZone:(0,pt().P)(),intl:ft().A.getIntl()}),type:"relation",value:{id:n.id,table:"block",spaceId:r.getSpaceId()}}];case"relation":if(void 0===r)return[];return c().bG({relationValue:c().n(o),getRecordModel:n.getRecordModel,propertySchema:i,includeNoAccess:!0}).map((e=>({id:e.id,type:"relation",value:e})));case"status":{const e=c().RZ(o,i),{options:t,groups:n}=i,r=null==t?void 0:t.find((t=>t.value===e));if(void 0===e||void 0===r)return[];const l=null==n?void 0:n.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(r.id)}));return[{id:e,type:"select",value:e,color:r.color,groupColor:(null==l?void 0:l.color)??"default"}]}case"text":if(void 0===o)return[];const b=(0,In().r4)({textValue:o,getRecordModel:n.getRecordModel,deterministic:!0,userTimeZone:(0,pt().P)(),intl:ft().A.getIntl()});return 0===b.length?[]:[{id:b,type:"text",value:o}];case"created_by":const x=n.getCreatedByPointer();return x?[{id:x.id,type:"person",value:x}]:[];case"created_time":{const e=n.getCreatedTime();return[{id:e,type:"date",value:(0,Pn().KQ)(e,(0,pt().P)())}]}case"last_edited_by":{const e=n.getLastEditedByPointer();return e?[{id:e.id,type:"person",value:e}]:[]}case"last_edited_time":{const e=n.getLastEditedTime();return[{id:e,type:"date",value:(0,Pn().KQ)(e,(0,pt().P)())}]}case"last_visited_time":{const{currentUserId:t}=e;if(!t)return[];const o=(0,jn().$5)({parent_id:n.id,user_id:t}),r=Bn()._.createChildStore(n,{table:jn().F9,id:o,spaceId:n.getSpaceId()}).getModel(),i=null==r?void 0:r.getVisitedAt();if(!i)return[];return[{id:i,type:"date",value:(0,Pn().KQ)(i,(0,pt().P)())}]}case"place":{const e=(0,en().X1)((0,en().eC)(o));return e?[{id:e,type:"text",value:[[e]]}]:[]}default:(0,T().HB)(f)}}const Dn=n.forwardRef((function(e,t){const{shouldWrap:o}=(0,n.useContext)(p().L8),r=(0,l().WS)(),i=Xn(e,t,(0,a().IS)((()=>{const e=(0,d()._Q)({isPhone:r});return{checkboxButtonStyle:{...e.table.checkbox},textButtonStyle:{...e.table.text},buttonButtonStyle:{...e.table.button}}}),[r]));return(0,S.jsx)(Hn,{...i,numberRightAlign:!0,EmptyComponent:Pe().rW,quickActionButtons:["edit","copy"],userExpandable:o})})),zn=n.forwardRef((function(e,t){const o=(0,l().WS)(),n=Xn(e,t,(0,a().IS)((()=>{const e=(0,d()._Q)({isPhone:o});return{checkboxButtonStyle:{...e.page.checkbox},textButtonStyle:{...e.page.text},buttonButtonStyle:{...e.page.button}}}),[o]));return(0,S.jsx)(Hn,{...n,quickActionButtons:["edit","copy"],EmptyComponent:Pe().ao})})),Nn=n.forwardRef((function(e,t){const o=(0,l().WS)(),n=Xn(e,t,(0,a().IS)((()=>{const e=(0,d()._Q)({isPhone:o});return{checkboxButtonStyle:{...e.compact_page.checkbox},textButtonStyle:{...e.compact_page.text},buttonButtonStyle:{...e.compact_page.button}}}),[o]));return(0,S.jsx)(Hn,{...n,EmptyComponent:Pe().ao})})),qn=n.forwardRef((function(e,t){const o=Xn(e,t);return(0,S.jsx)(Hn,{...o,EmptyComponent:Pe().Fe})})),Un=n.forwardRef((function(e,t){const o=Xn(e,t,(0,m().F)(t,e.collectionStore,e.property,"rollup"));return(0,S.jsx)(Hn,{...o})})),Qn=n.forwardRef((function(e,t){const o=(0,l().WS)(),n=Xn(e,t,(0,a().IS)((()=>{const e=(0,d()._Q)({isPhone:o});return{checkboxButtonStyle:{...e.board.checkbox},textButtonStyle:{...e.board.text},buttonButtonStyle:{...e.board.button}}}),[o]));return(0,S.jsx)(Hn,{...n})})),Jn=n.forwardRef((function(e,t){const o=Xn(e,t);return(0,S.jsx)(Hn,{...o})})),$n=n.forwardRef((function(e,t){const o=Xn(e,t);return(0,S.jsx)(Hn,{...o})})),Yn=n.forwardRef((function(e,t){const o=Xn(e,t);return(0,S.jsx)(Hn,{...o})})),Zn=n.forwardRef((function(e,t){const o=Xn(e,t);return(0,S.jsx)(Hn,{...o})})),Gn=n.forwardRef((function(e,t){const o=Xn(e,t);return(0,S.jsx)(Hn,{...o})}));function Xn(e,t,o){const{store:n,onContextMenu:r,property:i,collectionStore:l}=e;return{ref:t,store:n,property:i,collectionStore:l,editButtonClickProps:(0,le().QK)(e),onContextMenu:r,checkboxButtonStyle:null==o?void 0:o.checkboxButtonStyle,textButtonStyle:null==o?void 0:o.textButtonStyle,buttonButtonStyle:null==o?void 0:o.buttonButtonStyle}}const er=(0,n.forwardRef)((function(e,t){return(0,S.jsx)(Fo().jd,{...e,ref:t})})),tr=(0,n.forwardRef)((function(e,t){return(0,S.jsx)(Fo().I8,{...e,ref:t})})),or=(0,n.forwardRef)((function(e,t){return(0,S.jsx)(Fo().S1,{...e,ref:t})})),nr=(0,n.forwardRef)((function(e,t){const o=(0,m().F)(t,e.collectionStore,e.property,"multi_select"),n={...e,styles:o};return(0,S.jsx)(Fo().h3,{...n,ref:t})})),rr=(0,n.forwardRef)((function(e,t){return(0,S.jsx)(Fo().Dl,{...e,ref:t})})),ir=(0,n.forwardRef)((function(e,t){return(0,S.jsx)(Fo().V6,{...e,ref:t})})),lr=(0,n.forwardRef)((function(e,t){return(0,S.jsx)(Fo().rw,{...e,ref:t})})),ar=(0,n.forwardRef)((function(e,t){return(0,S.jsx)(Fo().ej,{...e,ref:t})})),sr=(0,n.forwardRef)((function(e,t){return(0,S.jsx)(Fo().xV,{...e,ref:t})})),cr=(0,n.forwardRef)((function(e,t){return(0,S.jsx)(Fo().ER,{...e,ref:t})})),dr=(0,n.forwardRef)((function(e,t){return(0,S.jsx)(Fo()._Z,{...e,ref:t})}));const ur=n.memo(n.forwardRef((function(e,t){const{store:o,onContextMenu:i,property:l,disabled:s,enablePointerEventsForInteractiveTypes:d,editButtonClickProps:y,selectButtonStyle:m,checkboxButtonStyle:f,checkboxShowLabel:h,EmptyComponent:g,quickActionButtons:b,width:x,userExpandable:v}=e,{baseStyles:C,propertyFormat:k,propertySchema:w,shouldRenderTooltip:P}=(0,n.useContext)(p().L8),I=w,j=(0,Ne().Ug)(null==C?void 0:C.tokenFormat),_=(0,r().K8)((()=>o.getPropertyValue(l)),[l,o]),R=(0,n.useMemo)((()=>I?c().RZ(_,I)??"":""),[_,I]),M=(null==k?void 0:k.statusShowAs)??"select",E=(0,a().IS)((()=>({buttonStyle:{...C.buttonStyle,..."select"===M?m:f},buttonPressedStyle:C.buttonPressedStyle??{},buttonHoveredStyle:C.buttonHoveredStyle??{}})),[C.buttonHoveredStyle,C.buttonPressedStyle,C.buttonStyle,m,f,M]);return R||void 0!==g?(0,S.jsx)(u().P,{ref:t,onContextMenu:i,editButtonClickProps:y,style:E.buttonStyle,pressedStyle:E.buttonPressedStyle,hoveredStyle:E.buttonHoveredStyle,tooltipPropertyValue:P&&"checkbox"===M?R:void 0,quickActionButtons:b,width:x,userExpandable:v,children:"checkbox"===M?(0,S.jsx)(yr,{enablePointerEventsForInteractiveTypes:d,showLabel:h,propertyName:null==I?void 0:I.name,propertyValue:_,statusValue:R,editButtonClickProps:y,containerRef:t,store:o,property:l,disabled:s}):R||void 0===g?(0,S.jsx)(pr,{statusValue:R,tokenFormat:j,store:o,property:l,propertySchema:I,parentHasTooltip:P}):(0,S.jsx)(g,{})}):null})));function pr(e){const{statusValue:t,store:r,parentHasTooltip:i,property:l,propertySchema:s}=e,c=(0,a().eP)(),d=(0,o(358167).v)({blockId:null==r?void 0:r.id,propertyId:l}),u=(0,qe().s)({propertyId:l,store:r}),p=Boolean(u),y=(0,a().IS)((()=>({container:{...p||d?{...(0,Oe().sQ)(c),paddingTop:3}:{},maxWidth:"fit-content"}})),[d,c,p]),{foundOption:m,foundGroup:f}=(0,n.useMemo)((()=>{const e=(null==s?void 0:s.options)??[],o=e.find((e=>e.value===t)),n=(null==s?void 0:s.groups)??[],r=o&&n.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(o.id)}));return{options:e,foundOption:o,foundGroup:r}}),[s,t]);return m?(0,S.jsx)(Ue().h,{style:y.container,className:u,children:(0,S.jsx)(o(96409).X,{type:"status",value:m.value,description:m.description,color:m.color,groupColor:null==f?void 0:f.color,shouldShowTooltip:!i})}):null}function yr(e){const{propertyName:t,propertyValue:o,statusValue:r,showLabel:i,enablePointerEventsForInteractiveTypes:a,editButtonClickProps:s,containerRef:d,store:u,property:y,disabled:m}=e,f=(0,l().v3)(),{propertySchema:h,shouldRenderTooltip:g}=(0,n.useContext)(p().L8),b=h,x=de(u,y,m),v=(0,n.useMemo)((()=>!!b&&c().MC(o,b,ft().A.getIntl())),[o,b]),C=(0,n.useCallback)((async e=>{await Ln().V({...s,element:d&&"current"in d?(null==d?void 0:d.current)??void 0:void 0,environment:f,statusSetCheckbox:!e.altKey})}),[d,s,f]);return(0,S.jsx)(se().o,{onClick:C,propertyLabel:i?t:void 0,checked:v,enablePointerEventsForInteractiveTypes:a,tooltip:g?void 0:r,disabled:x,store:u,property:y})}const mr=(0,n.forwardRef)((function(e,t){const{collectionStore:o,store:r,property:i}=e,s=(0,l().WS)(),{shouldWrap:c}=(0,n.useContext)(p().L8),u=(0,a().IS)((()=>({checkboxButtonStyle:{...(0,d()._Q)({isPhone:s}).table.checkbox}})),[s]),y=(0,n.useMemo)((()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ae().qO,{store:r,property:i},"workflow-autofill"),(0,S.jsx)(we().k,{},"comment")]})),[i,r]),m=Pr(e,t,u);return(0,S.jsx)(ur,{...m,checkboxShowLabel:!1,EmptyComponent:Pe().rW,collectionStore:o,quickActionButtons:y,userExpandable:c})})),fr=(0,n.forwardRef)((function(e,t){const{collectionStore:o}=e,n=(0,l().WS)(),r=Pr(e,t,(0,a().IS)((()=>({checkboxButtonStyle:{...(0,d()._Q)({isPhone:n}).page.checkbox}})),[n]));return(0,S.jsx)(ur,{...r,checkboxShowLabel:!1,EmptyComponent:Pe().ao,collectionStore:o,quickActionButtons:(0,S.jsx)(we().k,{},"comment")})})),Sr=(0,n.forwardRef)((function(e,t){const o=(0,l().WS)(),n=Pr(e,t,(0,a().IS)((()=>({checkboxButtonStyle:{...(0,d()._Q)({isPhone:o}).compact_page.checkbox}})),[o]));return(0,S.jsx)(ur,{...n,checkboxShowLabel:!1,EmptyComponent:Pe().ao,quickActionButtons:(0,S.jsx)(we().k,{},"comment")})})),hr=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=Pr(e,t,(0,m().F)(t,e.collectionStore,e.property,"status"));return(0,S.jsx)(ur,{...n,checkboxShowLabel:!1,EmptyComponent:o?Pe().Jb:void 0})})),gr=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=(0,l().WS)(),r=Pr(e,t,(0,a().IS)((()=>({checkboxButtonStyle:{...(0,d()._Q)({isPhone:n}).board.checkbox}})),[n]));return(0,S.jsx)(ur,{...r,checkboxShowLabel:!0,EmptyComponent:o?Pe().Jb:void 0})})),br=(0,n.forwardRef)((function(e,t){const o=Pr(e,t);return(0,S.jsx)(ur,{...o,checkboxShowLabel:!0})})),xr=(0,n.forwardRef)((function(e,t){const o=Pr(e,t);return(0,S.jsx)(ur,{...o,checkboxShowLabel:!0})})),vr=(0,n.forwardRef)((function(e,t){const o=Pr(e,t);return(0,S.jsx)(ur,{...o,checkboxShowLabel:!1})})),Cr=(0,n.forwardRef)((function(e,t){const o=Pr(e,t);return(0,S.jsx)(ur,{...o,checkboxShowLabel:!1})})),kr=(0,n.forwardRef)((function(e,t){const o=Pr(e,t);return(0,S.jsx)(ur,{...o,checkboxShowLabel:!1})})),wr=(0,n.forwardRef)((function(e,t){const o=Pr(e,t);return(0,S.jsx)(ur,{...o,checkboxShowLabel:!1,EmptyComponent:Pe().Fe})}));function Pr(e,t,o){const{store:r,disabled:i,property:l,onContextMenu:a,enablePointerEventsForInteractiveTypes:s,width:c}=e,{propertyFormat:d}=(0,n.useContext)(p().L8),u="checkbox"===(null==d?void 0:d.statusShowAs),y=(0,le().QK)(e,{isStatusCheckbox:u});return{ref:t,store:r,disabled:i,property:l,selectButtonStyle:null==o?void 0:o.selectButtonStyle,checkboxButtonStyle:null==o?void 0:o.checkboxButtonStyle,editButtonClickProps:y,onContextMenu:a,enablePointerEventsForInteractiveTypes:s,width:c}}const Ir=n.memo((0,n.forwardRef)(((e,t)=>{const{store:i,buttonStyle:l,onContextMenu:s,editButtonClickProps:c,quickActionButtons:d=[],EmptyComponent:y,property:m,width:h,linkifyUrls:g,disableLinks:b,userExpandable:x,clampLines:v,forceBlockPropertyButtonEnable:C=!1}=e,{baseStyles:k}=(0,n.useContext)(p().L8),w=(0,r().K8)((()=>i.getPropertyValue(m)),[m,i]),P=(0,a().IS)((()=>({buttonStyle:{...k.buttonStyle,...l},buttonPressedStyle:k.buttonPressedStyle??{},buttonHoveredStyle:k.buttonHoveredStyle??{}})),[k.buttonHoveredStyle,k.buttonPressedStyle,k.buttonStyle,l]);if((null==w||!w.length)&&void 0===y)return null;const I=Boolean(v);return(0,S.jsx)(u().P,{ref:t,style:P.buttonStyle,hoveredStyle:P.buttonHoveredStyle,pressedStyle:P.buttonPressedStyle,onContextMenu:s,editButtonClickProps:c,quickActionButtons:d,forceEnableButton:C,width:h,userExpandable:x,children:null!=w&&w.length||void 0===y?(0,S.jsx)(f().C,{children:(0,S.jsx)(o(837622).A,{textValue:w,parentStore:i,linkifyUrls:g,disableLinks:b,shouldTruncate:I,clampLines:v})}):(0,S.jsx)(y,{})})}))),jr=(0,n.forwardRef)((function(e,t){const{store:o,property:r,surface:i}=e,s=(0,l().WS)(),c=(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:s}).page.text}})),[s]),u=(0,n.useMemo)((()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(on().A,{store:o,property:r,openOverlay:!0},"autofill"),(0,S.jsx)(we().k,{},"comment"),(0,S.jsx)(y().i,{store:o,property:r,surface:i},"copy")]})),[i,r,o]),p=Wr(e,t,c);return(0,S.jsx)(Ir,{...p,EmptyComponent:Pe().ao,quickActionButtons:u})})),_r=(0,n.forwardRef)((function(e,t){const{store:o,property:r,surface:i}=e,{isMobile:s,isPhone:c}=(0,l().Y0)(),{shouldWrap:u}=(0,n.useContext)(p().L8),m=(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:c}).table.text}})),[c]),f=(0,n.useMemo)((()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(ae().qO,{store:o,property:r},"workflow-autofill"),(0,S.jsx)(on().A,{store:o,property:r,openOverlay:!0},"autofill"),(0,S.jsx)(we().k,{},"comment"),s?void 0:(0,S.jsx)(y().i,{store:o,property:r,surface:i},"copy")]})),[i,s,r,o]),h=Wr(e,t,m);return(0,S.jsx)(Ir,{...h,EmptyComponent:Pe().rW,quickActionButtons:f,userExpandable:u})})),Rr=(0,n.forwardRef)((function(e,t){const{store:o,property:r,surface:i}=e,{isMobile:s,isPhone:c}=(0,l().Y0)(),u=(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:c}).compact_page.text,maxWidth:"300px"}})),[c]),p=(0,n.useMemo)((()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(we().k,{},"comment"),s?void 0:(0,S.jsx)(y().i,{store:o,property:r,surface:i},"copy")]})),[i,s,r,o]),m=Wr(e,t,u);return(0,S.jsx)(Ir,{...m,EmptyComponent:Pe().ao,quickActionButtons:p,linkifyUrls:!1,disableLinks:!0})})),Mr=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=Wr(e,t,(0,m().F)(t,e.collectionStore,e.property,"text"));return(0,S.jsx)(Ir,{...n,EmptyComponent:o?Pe().Jb:void 0})})),Er=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=(0,l().WS)(),r=Wr(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:n}).board.text}})),[n]));return(0,S.jsx)(Ir,{...r,EmptyComponent:o?Pe().Jb:void 0})})),Br=(0,n.forwardRef)((function(e,t){const o=Wr(e,t);return(0,S.jsx)(Ir,{...o})})),Ar=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=Wr(e,t);return(0,S.jsx)(Ir,{...n,EmptyComponent:o?Pe().Jb:void 0})})),Tr=(0,n.forwardRef)((function(e,t){const o=Wr(e,t);return(0,S.jsx)(Ir,{...o})})),Lr=(0,n.forwardRef)((function(e,t){const o=Wr(e,t);return(0,S.jsx)(Ir,{...o})})),Vr=(0,n.forwardRef)((function(e,t){const o=Wr(e,t);return(0,S.jsx)(Ir,{...o})})),Fr=(0,n.forwardRef)((function(e,t){const o=Wr(e,t);return(0,S.jsx)(Ir,{...o,EmptyComponent:Pe().Fe})}));function Wr(e,t,o){const{store:n,collectionStore:r,property:i,disabled:l,onContextMenu:a,width:s}=e;return{ref:t,store:n,collectionStore:r,property:i,disabled:l,editButtonClickProps:(0,le().QK)(e),onContextMenu:a,buttonStyle:null==o?void 0:o.buttonStyle,width:s}}var Hr=()=>o(340498),Or=()=>o(821062);function Kr(e,t){(0,o(314529).DO_NOT_USE_trackLegacy)(e,"click_block_property_url",t)}var Dr=()=>o(778417),zr=()=>o(819527),Nr=()=>o(476492),qr=()=>o(852353),Ur=()=>o(405417),Qr=()=>o(968913),Jr=()=>o(945895),$r=()=>o(735372);function Yr(e){const{store:t}=e,r=(0,l().v3)(),s=(0,i().Ks)(),c=(0,B().tz)(),d=(0,n.useCallback)((()=>{const e=t.getBlockTitleStore();(0,o(573451).C)({store:t}),Dr().hc({environment:r,store:t}),(0,o(190033).z)({store:e}),(0,o(739041).u)(r,"list_item_edit_mode_enter",{...(0,Nr().sl)(s),block_id:t.id,from:"click",view_type:"list"})}),[t,r,s]),u=(0,a().IS)((e=>({buttonStyle:{color:e.text.secondary,fill:e.text.secondary,height:20,width:26},iconStyle:{color:e.text.secondary,fill:e.text.secondary}})),[]),p=c.formatMessage({id:"collectionViewItem.edit.tooltip",defaultMessage:"Edit"});return(0,S.jsx)(F().A,{renderTooltip:()=>p,render:e=>(0,S.jsx)(o(285790).A,{icon:An().r,ariaLabel:p,onClick:d,hasBackground:!0,showShadow:!1,style:u.buttonStyle,iconStyle:u.iconStyle,...e})})}var Zr=()=>o(402014),Gr=()=>o(177618);const Xr=(0,B().YK)({openAsPageTitle:{defaultMessage:"Open",id:"database.actionButton.openAsPageTitle"}});function ei(e){const{navigate:t}=(0,n.useContext)(o(312788).E),{store:s,handleOpenPeekPage:c,showLabel:d,showIcon:u}=e,p=(0,l().v3)(),y=(0,i().Ks)(),m=(0,r().K8)((()=>{const e=void 0!==y?Gr().hH(y):"full_page";return(0,ie().lA)(e,!1)}),[y]),f=(0,n.useCallback)((()=>(0,o(492414).Ef)({environment:p,updates:{store:s,fullyQualified:!0,pageVisitSource:no().y8.LinkInPage}})),[p,s]),h=(0,n.useCallback)((()=>{const{mainEditorCurrentBlockStore:e}=o(765957).default.state;return Gr().wy({environment:p,store:s,mainEditorCurrentBlockStore:e,collectionContextStore:y,fullyQualified:!1})}),[p,y,s]),g=(0,n.useCallback)((e=>{if(e.metaKey||e.ctrlKey)t({environment:p,url:f(),openInNew:"tab"});else{const e=M().A.isMobile?f():h();if(!e)return;null==c||c(),t({environment:p,url:e})}}),[p,h,f,c,t]),b=(0,n.useCallback)((e=>{1===e.button&&t({environment:p,url:f(),openInNew:"tab"})}),[p,f,t]),x=(0,n.useCallback)((e=>{(0,Zr().SQ)({event:e,context:Zr().y$.EditorMouseDown,callback:()=>{e.preventDefault()}})}),[]),{startDwell:v,stopDwell:C}=(0,o(330297).C)(o(40524).T.short),k=(0,n.useCallback)((()=>v(p.currentUser.id,s.id)),[v,p.currentUser.id,s.id]),w=(0,n.useCallback)((()=>C()),[C]),P=(0,At().X)("title_property_peek_button_redesign"),I=M().A.isMobile,j=(0,a().IS)((e=>({buttonStyle:{color:e.text.secondary,fill:e.text.secondary,fontFamily:yt().Tf.sans,...!d&&{width:26},background:e.whiteButtonBackground,border:void 0,fontSize:12,fontWeight:yt().Wy.medium,textTransform:"uppercase",letterSpacing:.5,borderRadius:P&&I?"50%":4,height:P&&I?28:20,width:P&&I?28:void 0,display:"flex",paddingInlineStart:4,paddingInlineEnd:4},buttonHoveredStyle:{background:e.whiteButtonHoveredBackground},buttonPressedStyle:{background:e.whiteButtonPressedBackground}})),[d,P,I]),_=(0,n.useCallback)((()=>m.tooltip),[m.tooltip]),R=n.useMemo((()=>u?P&&I?{icon:o(662984).arrowExpandDiagonalBottomLeftToTopRightSmallIcon,size:"sm",colorVariant:"tertiary"}:{icon:m.icon,size:"default",colorVariant:"secondary"}:void 0),[P,I,m.icon,u]),B=(0,n.useCallback)((e=>(0,S.jsx)("div",{onAuxClick:b,onMouseDown:x,onMouseEnter:k,onMouseLeave:w,role:"button",tabIndex:0,children:(0,S.jsx)(E().A,{onClick:g,iconLeading:R,ariaLabel:m.tooltip,size:"sm",style:j.buttonStyle,hoveredStyle:j.buttonHoveredStyle,pressedStyle:j.buttonPressedStyle,...e,children:d?ft().A.formatMessage(Xr.openAsPageTitle):void 0})})),[b,g,x,k,w,m.tooltip,d,j.buttonHoveredStyle,j.buttonPressedStyle,j.buttonStyle,R]);return(0,S.jsx)(F().A,{renderTooltip:_,render:B})}const ti=(0,B().YK)({untitledBlock:{defaultMessage:"Untitled",id:"collectionViewItemTitle.untitledBlock"},typeAName:{defaultMessage:"Type a name",id:"collectionViewItemTitle.itemName.placeholder"},pageWithContentTooltip:{defaultMessage:"This {type} has content",id:"collectionViewItemTitle.pageWithContentTooltip"}}),oi=Object.freeze({property:!0}),ni=new Set(["table"]),ri=n.memo((0,n.forwardRef)((function(e,t){const{buttonStyle:i,canEdit:s,collectionStore:c,commentsIndicatorStyle:d,editButtonClickProps:y,forceMouseEntered:m,surface:f,iconActionFrom:h,iconSize:g,linkifyText:b,onContextMenu:x,onTab:v,onUntab:C,property:k,quickActionButtons:w,quickActionButtonsStyle:P,recordIconStyle:I,showIcon:j,store:_,textStyle:R,titlePropertyType:E,userExpandable:A,width:T}=e,L=(0,l().v3)(),V=(0,B().tz)(),{baseStyles:W,collectionContextStore:H,propertySchema:O}=(0,n.useContext)(p().L8),{collectionViewBlockId:K,collectionViewId:D,collectionUri:z}=(0,r().K8)((()=>{var e,t,o;return{collectionViewId:null==H||null===(e=H.collectionViewStore())||void 0===e?void 0:e.id,collectionViewBlockId:null==H||null===(t=H.collectionViewBlockStore())||void 0===t?void 0:t.id,collectionUri:null==H||null===(o=H.collectionStore())||void 0===o?void 0:o.getFormat().app_config_uri}}),[H]),N=(0,r().K8)((()=>{if("inlineEditable"!==E)return!1;const e=Jr().A.state;return Boolean(e.isActive&&e.store.id===_.id)}),[_.id,E]),q=(0,n.useMemo)((()=>({type:"page_property_value_match",collectionViewBlockId:K,collectionViewId:D,propertyId:"title"})),[K,D]),{icon:U,iconStore:Q,isPage:J,isEmptyPage:$,isEmptyTitle:Y,recordTable:Z,blockType:G,hasError:X}=(0,r().K8)((()=>{const e=_.getIconStore();return{icon:_.getIcon(),iconStore:e,isPage:_.isType("page"),isEmptyPage:_.isEmptyPage(),isEmptyTitle:_.isEmptyTitle(),recordTable:null==e?void 0:e.table,blockType:_.getType(),hasError:_.hasError()}}),[_],{useDeepEqual:!0}),ee=(0,r().K8)((()=>(0,So().Te)(_)),[_]),te=J&&!$&&!U,oe=(0,kn().cP)(k),re=(0,r().K8)((()=>{if(!oe)return b?ie().UY({store:_,propertySchema:(0,ke().z)(O),property:k}):void 0;const e=_.getFormatStore().getKeyStore("uri").getValue(),t=e&&o(939768).Jf({str:e,allowNoProtocol:!1});return t&&(0,o(493208).e)(t,_.pointer.spaceId)}),[oe,_,b,O,k]),le=(0,n.useCallback)((()=>{if(H&&oe){const e=(0,Nr().sl)(H)||{};Kr(L,{...e,block_id:_.id,property:k,from:ie().zP(f),is_external_title_property_id:!0})}}),[H,L,f,k,_.id,oe]),ae=(0,n.useCallback)((e=>{Q&&ne().createAndCommit({userAction:"TitleProperty.handleRecordIconChange",environment:L,canUndo:!0,perform:t=>{o(384944).KY({store:Q,value:e,transaction:t})}})}),[L,Q]),se=(0,a().IS)((e=>{const t=ni.has(f);return{textStyle:{...W.textStyle,display:"inline",fontWeight:yt().Wy.medium,...R,marginInlineEnd:M().A.isMobile?3:5},buttonStyle:{...W.buttonStyle,...i},quickActionButtonsStyle:{...P},buttonPressedStyle:{...W.buttonPressedStyle,background:"none"},buttonHoveredStyle:{...W.buttonHoveredStyle,background:"none"},recordIconStyle:{display:"inline-flex",verticalAlign:"text-top",...I},pageIconStyle:{fill:e.text.tertiary},link:{display:"inline"},subitemCountIndicator:{display:"inline-flex",alignItems:"center",verticalAlign:"text-top"},parentItemIndicator:{display:"inline-flex",alignItems:"center",verticalAlign:"text-top"},discussionIndicator:{display:"inline-flex",alignItems:"center",color:e.text.tertiary,fontSize:12,fontWeight:yt().Wy.medium,verticalAlign:"text-top"},errorIcon:{display:"inline-block",verticalAlign:"text-top",marginInlineStart:1,marginInlineEnd:7,paddingBottom:4,width:Hr().Ev.sm,fill:e.palette.orange[500]},content:t?{display:"flex",alignItems:"flex-start",gap:M().A.isMobile?4:1}:{display:"contents"},iconContainer:t?{flexShrink:0}:{display:"contents"},restContainer:t?{flexGrow:1,minWidth:0}:{display:"contents"}}}),[f,W.textStyle,W.buttonStyle,W.buttonPressedStyle,W.buttonHoveredStyle,R,i,P,I]),ce=(0,S.jsx)(ii,{titlePropertyType:E,store:_,environment:L,collectionContextStore:H,onTab:v,onUntab:C,textStyle:se.textStyle,memoizedInPageFindTextProp:q,property:k,isEditing:N}),de=(0,n.useMemo)((()=>({collection_id:c.id,recordTable:Z,source:h,block_type:G})),[c.id,Z,h,G]),ue=(0,n.useMemo)((()=>"never"!==j&&(("table"!==f||!Y||!$||void 0!==U)&&("always"===j||void 0!==U||!$))),[j,f,Y,$,U]),pe=(0,r().K8)((()=>H&&(0,Ur().xC)({collectionContextStore:H,blockStore:_})),[H,_]),ye=(0,r().K8)((()=>H&&(0,Ur().Kk)({collectionContextStore:H,blockStore:_})),[H,_]),me=(0,n.useMemo)((()=>{if(X)return(0,o(175882).exclamationMarkTriangleSmallIcon)(se.errorIcon);if(!ue)return null;let e;return e=J&&s?(0,S.jsx)(So().B6,{disabled:!1,icon:U,iconRecordCategory:ee,isEmptyPage:$,size:g,style:se.recordIconStyle,pageIconStyle:se.pageIconStyle,store:_,bucket:"secure",onChange:ae,iconLoggingData:de,isInCollectionView:!0}):(0,S.jsx)(So().B6,{disabled:!0,icon:U,iconRecordCategory:ee,isEmptyPage:$,size:g,style:se.recordIconStyle,pageIconStyle:se.pageIconStyle,isInCollectionView:!0,store:_}),te?(0,S.jsx)(F().A,{renderTooltip:()=>V.formatMessage(ti.pageWithContentTooltip,{type:(0,o(895876).$O)(z)}),render:t=>(0,S.jsx)("div",{...t,children:e})}):e}),[_,X,ue,s,U,ee,J,$,g,se.recordIconStyle,se.errorIcon,se.pageIconStyle,ae,de,V,z,te]);return(0,S.jsx)(u().P,{ref:t,editButtonClickProps:y,onContextMenu:x,style:se.buttonStyle,pressedStyle:se.buttonPressedStyle,hoveredStyle:se.buttonHoveredStyle,quickActionButtons:w,quickActionButtonsStyle:se.quickActionButtonsStyle,quickActionButtonsForceVisible:M().A.isMobile?void 0:m,tooltipHide:!0,userExpandable:A,children:(0,S.jsxs)("div",{style:se.content,children:[(0,S.jsx)("div",{style:se.iconContainer,children:me}),(0,S.jsxs)("div",{style:se.restContainer,children:[!N&&re?(0,S.jsx)(o(620896).A,{href:re,external:oe,onClick:le,style:se.link,children:ce}):ce,void 0!==H&&pe?(0,S.jsx)("span",{style:se.parentItemIndicator,children:(0,S.jsx)(o(27542).n,{blockStore:_,collectionContextStore:H,columnWidth:T})}):null,void 0!==H&&ye?(0,S.jsx)("span",{style:se.subitemCountIndicator,children:(0,S.jsx)(o(752773).W,{blockStore:_,collectionContextStore:H})}):null,(0,S.jsx)(o(988662).g,{store:_,iconStyle:se.discussionIndicator,buttonStyle:d})]})]})})})),Or().A),ii=n.memo((function(e){const{titlePropertyType:t,store:n,environment:r,collectionContextStore:i,onTab:l,onUntab:a,textStyle:s,memoizedInPageFindTextProp:c,property:d,isEditing:u}=e;switch(t){case"inlineEditable":return(0,S.jsx)(li,{store:n,environment:r,collectionContextStore:i,onTab:l,onUntab:a,textStyle:s,memoizedInPageFindTextProp:c,isEditing:u});case"hidePlaceholderText":return(0,S.jsx)(ai,{store:n,collectionContextStore:i,textStyle:s,property:d,memoizedInPageFindTextProp:c,environment:r});case"showPlaceholderAsTitle":return(0,S.jsx)(o(16006).A,{style:s,store:n});default:(0,T().HB)(t)}}),Or().A),li=n.memo((function(e){const{store:t,environment:i,collectionContextStore:l,onTab:a,onUntab:s,textStyle:c,memoizedInPageFindTextProp:d,isEditing:u}=e,p=(0,B().tz)(),y=(0,r().K8)((()=>(0,qr().yT)(t)),[t]),m=(0,n.useCallback)((()=>{Jr().A.setState({isActive:!1}),(0,o(749804).I)({environment:i}),Dr().Lt({environment:i,store:t})}),[t,i]),f=(0,n.useCallback)((e=>{e&&"key"in e&&"Enter"===e.key||(l&&(0,oe().E)({environment:i,collectionContextStore:l,block_id:t.id,property:"title",property_type:"text",from:"list"}),(0,o(714574).P)({store:t}))}),[i,t,l]),h=(0,n.useCallback)((e=>{e.target.scrollLeft=0}),[]),g=(0,r().K8)((()=>{var e;return u?p.formatMessage(ti.typeAName):(null===(e=t.getModel())||void 0===e?void 0:e.getEmptyTitlePlaceholder({getRecordModel:t.getRecordModel,intl:p,userTimeZone:(0,pt().P)()}))||p.formatMessage(ti.untitledBlock)}),[u,t,p]);return(0,S.jsx)(o(712855).A,{store:y,disabled:!u,disableSlashCommands:!0,disableEmojiCommands:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableEmbedMenu:!0,disableShiftEnter:!0,onEnter:m,onEsc:m,onTab:a,onUntab:s,onChange:f,onBlur:h,placeholder:g,style:c,disableSelectAllBlocks:!0,pasteBehavior:"inline",inPageFind:d,disabledMentionTypes:oi})}),Or().A),ai=n.memo((function(e){const{store:t,collectionContextStore:n,textStyle:i,property:l,memoizedInPageFindTextProp:s,environment:c}=e,d=(0,a().DP)(),u=(0,r().K8)((()=>{if(n){const e=n.searchQueryStore.state;return e.length>0?e:void 0}}),[n]),p=(0,r().K8)((()=>$r().qu.state??u),[u]),y=(0,r().K8)((()=>{const e=$r().wb.state;return(0,o(792540).wc)(e)&&e.id===t.id?e:void 0}),[t.id]),m=(0,r().K8)((()=>{var e;let o=null===(e=t.getTitleStore())||void 0===e?void 0:e.getValue();return t.isType("external_object_instance_page")&&(o=t.getPropertyValue(l)),p&&p.length>0&&o&&(o=yo().nu({textValue:o,blockId:t.id,textProps:s,find:p,currentFocusedResult:y})),o}),[y,s,l,p,t],{useDeepEqual:!0}),f=(0,r().K8)((()=>yo().S5({environment:c,textValue:m&&{value:m,spaceId:(0,o(161479).e)(t.pointer.spaceId)},parentStore:t,disableHover:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!0,disabled:!0,theme:d,emojiType:(0,o(712030).FN)(c),katex:c.KatexStore.getKatex(),formulaValueTypes:[]})),[c,t,m,d],{silenceRerenderDefender:!0});return(0,S.jsx)("span",{style:i,children:f})}),Or().A),si=(0,n.forwardRef)((function(e,t){const{store:o,handleOpenPeekPage:i,width:s}=e,c=(0,l().v3)(),{isMobile:u,isPhone:y}=(0,l().Y0)(),m=(0,At().X)("title_property_peek_button_redesign"),{collectionContextStore:f,canEdit:h,shouldWrap:g}=(0,n.useContext)(p().L8),b=(0,r().K8)((()=>(0,Qr().Wi)(c,o.id)),[c,o]),x=(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:y}).table.text},recordIconStyle:{height:Hr().Ev.lg,width:Hr().Ev.lg,marginTop:-2,marginInlineEnd:3,marginBottom:0,marginInlineStart:-2},dbCommentButton:{position:"relative",top:2,marginTop:-2.8}})),[y]),v=(0,r().K8)((()=>(null==f?void 0:f.shouldShowPageIcon())??!0),[f]),C=(!m||!u)&&(u||void 0===s||s>100),k=!(!m||!u)||!u,w=(0,n.useMemo)((()=>b?void 0:(0,S.jsx)(ei,{handleOpenPeekPage:i,store:o,showLabel:C,showIcon:k})),[i,o,b,C,k]),P=ui(e,t,x);return(0,S.jsx)(ri,{...P,iconActionFrom:"collection_table_view",showIcon:v?"always":"never",iconSize:20,titlePropertyType:"hidePlaceholderText",quickActionButtons:w,linkifyText:!h,commentsIndicatorStyle:x.dbCommentButton,userExpandable:g,canEdit:h})})),ci=(0,n.forwardRef)((function(e,t){const{store:i}=e,{isPhone:s,isMobile:c}=(0,l().Y0)(),u=(0,l().v3)(),{canEdit:y,collectionContextStore:f}=(0,n.useContext)(p().L8),h=(0,r().K8)((()=>{const e=Jr().A.state;return Boolean(e.isActive&&e.store.id===i.id)}),[i]),g=(0,r().K8)((()=>!!f&&f.isInHomeWidgetStore.state),[f]),b=(0,r().K8)((()=>(0,Qr().Wi)(u,i.id)),[u,i]),x=(0,r().K8)((()=>(null==f?void 0:f.shouldShowPageIcon())??!0),[f]),v=(0,n.useMemo)((()=>!c&&!b&&(y&&!h?(0,S.jsx)(Yr,{store:i}):(0,S.jsx)(ei,{store:i,showLabel:!1,showIcon:!0}))),[h,c,y,i,b]),C=(0,a().IS)((()=>({buttonStyle:{marginInlineStart:0,marginInlineEnd:0,paddingInlineStart:g?o(665579).VQ/2:void 0,flexGrow:1,flexShrink:1,flexBasis:"auto",maxWidth:void 0,minWidth:s?void 0:m().X},textStyle:{fontSize:s?d().hN:d().Mi,whiteSpace:h?"pre":"nowrap",pointerEvents:h?void 0:"none",cursor:h?"text":void 0,width:"auto",textOverflow:h?void 0:"ellipsis"},recordIconStyle:{marginInlineEnd:zr().mA,height:g?Hr().Ev.sm:Hr().Ev.lg,width:g?Hr().Ev.sm:Hr().Ev.lg},actionButton:{marginInlineStart:10,marginInlineEnd:1,order:3}})),[h,g,s]),k=ui(e,t,C),w=(0,m().F)(t,e.collectionStore,e.property,"title");return(0,S.jsx)(ri,{...k,iconActionFrom:"collection_list_view",showIcon:x?"always":"never",iconSize:g?16:zr().kG,editButtonClickProps:void 0,quickActionButtonsStyle:C.actionButton,quickActionButtons:v,titlePropertyType:"inlineEditable",canEdit:y,textStyle:{...C.textStyle,...w.buttonStyle}})})),di=(0,n.forwardRef)((function(e,t){o(165358).log({level:"error",from:"BlockPropertyValue",type:"BlockPropertyValue.InvalidTitlePropertyFormat"});const r=ui(e,t),{canEdit:i}=(0,n.useContext)(p().L8);return(0,S.jsx)(ri,{...r,iconActionFrom:"collection_table_view",showIcon:"always",iconSize:20,titlePropertyType:"hidePlaceholderText",canEdit:i})}));function ui(e,t,o){const{collectionStore:n,disabled:r,forceMouseEntered:i,surface:l,onContextMenu:a,onTab:s,onUntab:c,property:d,store:u,width:p}=e;return{ref:t,store:u,collectionStore:n,property:d,disabled:r,editButtonClickProps:(0,le().QK)(e),onContextMenu:a,buttonStyle:null==o?void 0:o.buttonStyle,textStyle:null==o?void 0:o.textStyle,recordIconStyle:null==o?void 0:o.recordIconStyle,quickActionButtonsStyle:null==o?void 0:o.quickActionButtonsStyle,surface:l,onTab:s,onUntab:c,forceMouseEntered:i,width:p}}var pi=()=>o(931075),yi=()=>o(310442),mi=()=>o(824862),fi=()=>o(798880),Si=()=>o(53528),hi=()=>o(448291),gi=()=>o(427636),bi=()=>o(994006);function xi(e){const{isMobile:t}=(0,l().Y0)();return(0,S.jsx)("div",{style:t?{padding:"12px 20px",fontSize:14}:{fontSize:12,display:"flex",alignItems:"center"},children:(0,S.jsx)(vi,{...e})})}function vi(e){const{verificationState:t,blockStore:o}=e,n=(0,B().tz)();switch(t.type){case"none":return null;case"verified":return t.isIndefinite?(0,S.jsx)(B().sA,{defaultMessage:"Verified by {user} on {date}",id:"VerificationSummary.verifiedIndefinitely",values:{user:(0,S.jsx)(Ci,{actorPointer:t.actorPointer,blockStore:o}),date:(0,Si().OH)({dateTime:t.startDateTime,intl:n})}}):(0,S.jsx)(B().sA,{defaultMessage:"Verified by {user} from {dateTimeRange}",id:"VerificationSummary.verified",values:{user:(0,S.jsx)(Ci,{actorPointer:t.actorPointer,blockStore:o}),dateTimeRange:(0,Si().do)({luxonRange:t.dateTimeRange,intl:n})}});case"expired":return(0,S.jsx)(B().sA,{defaultMessage:"Last verified by {user} from {dateTimeRange}",id:"VerificationSummary.verificationExpired",values:{user:(0,S.jsx)(Ci,{actorPointer:t.actorPointer,blockStore:o}),dateTimeRange:(0,Si().do)({luxonRange:t.dateTimeRange,intl:n})}});default:(0,T().HB)(t)}}function Ci(e){const{actorPointer:t,blockStore:o}=e,n=(0,r().K8)((()=>(0,hi().JQ)({parentStore:o,pointer:t})),[o,t]),i={display:"flex",marginInlineStart:4,marginInlineEnd:4};return n.table===fi().oo?(0,S.jsx)(bi().A,{userStore:n,inline:!0,style:i,avatarSize:16,avatarMarginRight:4}):n.table===mi().GP?(0,S.jsx)(gi().A,{botStore:n,style:i,avatarSize:16}):n.table===yi().yj?(0,S.jsx)(bi().A,{userStore:void 0,inline:!0,style:i,avatarSize:16,avatarMarginRight:4}):void(0,T().HB)(n)}const ki=n.memo(n.forwardRef((function(e,t){var i;const{property:l,store:s,collectionStore:c,buttonStyle:d,editButtonClickProps:y,EmptyComponent:m}=e,{canEdit:f,propertySchema:h,baseStyles:g,collectionSchemaStore:b}=(0,n.useContext)(p().L8),x=h,v=(0,r().K8)((()=>{const e=b.getState();return!(!x||!e)&&qr().E5(x,s,e)}),[x,b,s]),C=(0,r().K8)((()=>{var e;if(c.isPageTreeCollection())return!0;const t=null==s||null===(e=s.getSpaceStore())||void 0===e?void 0:e.getModel();return!!t&&(0,o(470020).X)(t)}),[c,s]),k=!f||!v||!C,w=(0,a().IS)((e=>({buttonStyle:{...g.buttonStyle,...d,cursor:k?"text":"pointer"},buttonPressedStyle:g.buttonPressedStyle??{},buttonHoveredStyle:g.buttonHoveredStyle??{}})),[g.buttonHoveredStyle,g.buttonPressedStyle,g.buttonStyle,d,k]),P=(0,r().K8)((()=>{const e=s.getPropertyValue(l);return(0,pi().U1)(e)}),[l,s]),I=(0,n.useMemo)((()=>(0,pi().B2)(P)),[P]),j=(0,n.useMemo)((()=>{if("none"!==I.type)return(0,S.jsx)(xi,{verificationState:I,blockStore:s})}),[s,I]),_=(0,r().K8)((()=>{var e;const t=!v||!C,o=b.getState();if(!t||!o)return;if(!C)return(0,S.jsx)(B().sA,{defaultMessage:"Upgrade plan to edit verification",id:"VerificationPropertyButton.tooltip.nonWikiVerificationRestrictedToBusinessTier"});const n=null==x?void 0:x.verifier_property,r=n?null===(e=o[n])||void 0===e?void 0:e.name:void 0;return(0,S.jsx)(wi,{verifierPropertyName:r})}),[v,b,C,null==x?void 0:x.verifier_property]),R="none"===I.type;return R&&void 0===m?null:(0,S.jsx)(u().P,{ref:t,editButtonClickProps:k?void 0:y,style:w.buttonStyle,hoveredStyle:w.buttonHoveredStyle,pressedStyle:w.buttonPressedStyle,tooltipPropertyValue:j,tooltipPropertyCaption:_,children:R&&void 0!==m?(0,S.jsx)(m,{}):(0,S.jsx)(o(553748).r,{verificationValue:P,fontSize:null===(i=g.buttonStyle)||void 0===i?void 0:i.fontSize})})})));function wi(e){const{verifierPropertyName:t}=e;return t?(0,S.jsx)(B().sA,{defaultMessage:"Only people listed in {verifierPropertyName} can verify this page",id:"VerificationPropertyButton.tooltip.editRestrictedToVerifier",values:{verifierPropertyName:(0,S.jsx)("span",{style:{fontWeight:yt().Wy.bold},children:t})}}):(0,S.jsx)(B().sA,{defaultMessage:"Only page owners can verify this page",id:"VerificationPropertyButton.tooltip.editRestrictedToOwner"})}const Pi=n.forwardRef((function(e,t){const o=(0,l().WS)(),n=Vi(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:o}).table.text}})),[o]));return(0,S.jsx)(ki,{...n,EmptyComponent:Pe().rW})})),Ii=n.forwardRef((function(e,t){const o=(0,l().WS)(),n=Vi(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:o}).page.text}})),[o]));return(0,S.jsx)(ki,{...n,EmptyComponent:Pe().ao})})),ji=n.forwardRef((function(e,t){const o=(0,l().WS)(),n=Vi(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:o}).compact_page.text}})),[o]));return(0,S.jsx)(ki,{...n,EmptyComponent:Pe().ao})})),_i=n.forwardRef((function(e,t){const o=Vi(e,t);return(0,S.jsx)(ki,{...o,EmptyComponent:Pe().Fe})})),Ri=n.forwardRef((function(e,t){const{collectionStore:o,store:i,showIfEmpty:l}=e,{propertySchema:a}=(0,n.useContext)(p().L8),s=a,c=(0,r().K8)((()=>o.getSchema()),[o]),d=(0,r().K8)((()=>!!s&&qr().E5(s,i,c)),[s,c,i]),u=Vi(e,t,(0,m().F)(t,e.collectionStore,e.property,"verification"));return(0,S.jsx)(ki,{...u,EmptyComponent:l&&d?Pe().Jb:void 0})})),Mi=n.forwardRef((function(e,t){const{collectionStore:o,store:i,showIfEmpty:s}=e,{propertySchema:c}=(0,n.useContext)(p().L8),u=c,y=(0,r().K8)((()=>o.getSchema()),[o]),m=(0,r().K8)((()=>!!u&&qr().E5(u,i,y)),[u,y,i]),f=(0,l().WS)(),h=Vi(e,t,(0,a().IS)((()=>({buttonStyle:{...(0,d()._Q)({isPhone:f}).board.text}})),[f]));return(0,S.jsx)(ki,{...h,EmptyComponent:s&&m?Pe().Jb:void 0})})),Ei=n.forwardRef((function(e,t){const o=Vi(e,t);return(0,S.jsx)(ki,{...o})})),Bi=n.forwardRef((function(e,t){const o=Vi(e,t);return(0,S.jsx)(ki,{...o})})),Ai=n.forwardRef((function(e,t){const o=Vi(e,t);return(0,S.jsx)(ki,{...o})})),Ti=n.forwardRef((function(e,t){const o=Vi(e,t);return(0,S.jsx)(ki,{...o})})),Li=n.forwardRef((function(e,t){const o=Vi(e,t);return(0,S.jsx)(ki,{...o})}));function Vi(e,t,o){const{store:n,collectionStore:r,property:i,onClick:l,onContextMenu:a}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,le().QK)(e),onClick:l,onContextMenu:a,buttonStyle:null==o?void 0:o.buttonStyle}}const Fi=n.memo(n.forwardRef((function(e,t){const{property:o,surface:n,propertyType:r,innerProps:i}=e;if(!r)return null;const l=Wi[n][r];return l?(0,S.jsx)(l,{ref:t,...i,property:o,surface:n}):null}))),Wi={table:{checkbox:ue,created_by:Xo().JJ,created_time:He().wW,date:He().wW,email:je,file:$e,formula:Ot,last_edited_by:Xo().JJ,last_edited_time:He().wW,last_visited_time:He().wW,location:Po,multi_select:Fo().jd,number:Do,person:Xo().JJ,phone_number:je,relation:bn().Kr,rollup:Dn,select:er,status:mr,text:_r,title:si,url:je,verification:Pi,auto_increment_id:b,button:D,place:an},board:{checkbox:fe,created_by:Xo().p$,created_time:He().Gx,date:He().Gx,email:Ee,file:et,formula:Qt,last_edited_by:Xo().p$,last_edited_time:He().Gx,last_visited_time:He().Gx,location:Mo,multi_select:Fo().Dl,number:qo,person:Xo().p$,phone_number:Ee,relation:bn().QE,rollup:Qn,select:rr,status:gr,text:Er,title:di,url:Ee,verification:Mi,auto_increment_id:k,button:Q,place:un},calendar:{checkbox:Se,created_by:Xo().Jd,created_time:He().y9,date:He().y9,email:Be,file:tt,formula:Jt,last_edited_by:Xo().Jd,last_edited_time:He().y9,last_visited_time:He().y9,location:Eo,multi_select:Fo().V6,number:Uo,person:Xo().Jd,phone_number:Be,relation:bn().eH,rollup:Jn,select:ir,status:br,text:Br,title:di,url:Be,verification:Ei,auto_increment_id:w,button:J,place:pn},list:{checkbox:me,created_by:Xo().VW,created_time:He().g$,date:He().g$,email:Me,file:Xe,formula:Ut,last_edited_by:Xo().VW,last_edited_time:He().g$,last_visited_time:He().g$,location:Ro,multi_select:Fo().h3,number:No,person:Xo().VW,phone_number:Me,relation:bn().eM,rollup:Un,select:nr,status:hr,text:Mr,title:ci,url:Me,verification:Ri,auto_increment_id:C,button:U,place:dn},gallery:{checkbox:he,created_by:Xo().bZ,created_time:He().UP,date:He().UP,email:Ae,file:ot,formula:$t,last_edited_by:Xo().bZ,last_edited_time:He().UP,last_visited_time:He().UP,location:Bo,multi_select:Fo().rw,number:Qo,person:Xo().bZ,phone_number:Ae,relation:bn().iM,rollup:$n,select:lr,status:xr,text:Ar,title:di,url:Ae,verification:Bi,auto_increment_id:P,button:$,place:yn},timeline:{checkbox:ge,created_by:Xo().cE,created_time:He().vy,date:He().vy,email:Te,file:nt,formula:Yt,last_edited_by:Xo().cE,last_edited_time:He().vy,last_visited_time:He().vy,location:Ao,multi_select:Fo().ej,number:Jo,person:Xo().cE,phone_number:Te,relation:bn().DE,rollup:Yn,select:ar,status:vr,text:Tr,title:di,url:Te,verification:Ai,auto_increment_id:I,button:Y,place:mn},page:{checkbox:pe,created_by:Xo().e7,created_time:He().zI,date:He().zI,email:_e,file:Ye,formula:Dt,last_edited_by:Xo().e7,last_edited_time:He().zI,last_visited_time:He().zI,location:Io,multi_select:Fo().I8,number:Ko,person:Xo().e7,phone_number:_e,relation:bn().hF,rollup:zn,select:tr,status:fr,text:jr,title:di,url:_e,verification:Ii,auto_increment_id:g,button:z,place:ln},compact_page:{checkbox:ye,created_by:Xo()._R,created_time:He().v,date:He().v,email:Re,file:Ze,formula:Nt,last_edited_by:Xo()._R,last_edited_time:He().v,last_visited_time:He().v,location:jo,multi_select:Fo().S1,number:zo,person:Xo()._R,phone_number:Re,relation:bn().$s,rollup:Nn,select:or,status:Sr,text:Rr,title:di,url:Re,verification:ji,auto_increment_id:x,button:N,place:cn},relation:{checkbox:be,created_by:Xo().L$,created_time:He().Qz,date:He().Qz,email:Le,file:rt,formula:Zt,last_edited_by:Xo().L$,last_edited_time:He().Qz,last_visited_time:He().Qz,location:To,multi_select:Fo().xV,number:$o,person:Xo().L$,phone_number:Le,relation:bn().I5,rollup:Zn,select:sr,status:Cr,text:Lr,title:di,url:Le,verification:Ti,auto_increment_id:j,button:Z,place:fn},relation_section:{checkbox:xe,created_by:Xo().K2,created_time:He().RM,date:He().RM,email:Ve,file:it,formula:Gt,last_edited_by:Xo().K2,last_edited_time:He().RM,last_visited_time:He().RM,location:Lo,multi_select:Fo().ER,number:Yo,person:Xo().K2,phone_number:Ve,relation:bn().$$,rollup:Gn,select:cr,status:kr,text:Vr,title:di,url:Ve,verification:Li,auto_increment_id:_,button:G,place:Sn},mini:{checkbox:ve,created_by:Xo().K1,created_time:He().BP,date:He().BP,email:Fe,file:Ge,formula:qt,last_edited_by:Xo().K1,last_edited_time:He().BP,last_visited_time:He().BP,location:_o,multi_select:Fo()._Z,number:Zo,person:Xo().K1,phone_number:Fe,relation:bn().F1,rollup:qn,select:dr,status:wr,text:Fr,title:di,url:Fe,verification:_i,auto_increment_id:v,button:q,place:hn},property_module:{checkbox:pe,created_by:Xo().oN,created_time:He().zI,date:He().zI,email:_e,file:lt,formula:Dt,last_edited_by:Xo().oN,last_edited_time:He().zI,last_visited_time:He().zI,location:Io,multi_select:Fo().I8,number:Ko,person:Xo().oN,phone_number:_e,relation:bn().bn,rollup:zn,select:tr,status:fr,text:jr,title:di,url:_e,verification:Ii,auto_increment_id:g,button:z,place:sn},feed:{checkbox:me,created_by:Xo().VW,created_time:He().g$,date:He().g$,email:Me,file:Xe,formula:Ut,last_edited_by:Xo().VW,last_edited_time:He().g$,last_visited_time:He().g$,location:Ro,multi_select:Fo().h3,number:No,person:Xo().VW,phone_number:Me,relation:bn().eM,rollup:Un,select:nr,status:hr,text:Mr,title:ci,url:Me,verification:Ri,auto_increment_id:C,button:U,place:dn}},Hi=n.memo((function(e){const{property:t,collectionStore:l,surface:a,formDataStore:s,onTab:c,onUntab:d,onEnter:u,onEsc:y,onBgClick:m,onOpenProperty:f,store:h}=e,g=(0,o(761408).yo)({collectionStore:l,property:t}),b=function(e,t,o){const n=(0,i().Ks)();return(0,r().K8)((()=>{var r;const i=e.getSchema();return(null==t||null===(r=t.getFormState())||void 0===r||null===(r=r.collectionSchema)||void 0===r?void 0:r[o])??i[o]??(null==n?void 0:n.normalizedSchemaStore.state[o])}),[n,t,e,o],{debugName:"usePropertySchema",useDeepEqual:!0})}(l,s,g),x=(0,n.useContext)(o(789550).R),v=(0,n.useRef)(null);return(0,o(790748).b)(o(57618).A,(()=>({getNode:()=>{const{current:e}=v;return e?"getNode"in e?e.getNode():e:null},props:{onTab:c,onUntab:d,onEnter:u,onEsc:y,onBgClick:m,onOpenProperty:f,property:g,surface:a,store:h},getScrollerContext:()=>x})),[x,c,d,u,y,m,f,g,a,h]),null!=b&&b.type?(0,S.jsx)(p().qN,{innerProps:e,property:g,unmappedProperty:t,propertySchema:b,containerRef:v,children:(0,o(515872).J)(a)?(0,S.jsx)(o(595465).T,{ref:v,innerProps:e,surface:a,property:g,propertyType:null==b?void 0:b.type}):(0,S.jsx)(Fi,{ref:v,innerProps:e,surface:a,property:g,propertyType:null==b?void 0:b.type})}):null}))},736230:(e,t,o)=>{o.d(t,{V:()=>r});var n=()=>o(56366);function r({collectionContextStore:e,blockId:t,property:o,featureEnabled:r=!1}){return(0,n().K8)((()=>{if(!(r&&t&&o&&e))return!1;const n=e.virtualizedModule.getBlockHeightsCache();return n&&n.propertyCanExpandStore(t,o).state}),[e,t,o,r])}},739041:(e,t,o)=>{o.d(t,{u:()=>r});var n=()=>o(314529);function r(e,t,o){(0,n().DO_NOT_USE_trackLegacy)(e,t,o)}},750559:(e,t,o)=>{o.d(t,{f:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("genericError",{viewBox:"0 0 32 32",svg:(0,n.jsx)("path",{d:"M16.0242 29.0485c7.1251 0 13.0243-5.8992 13.0243-13.0243C29.0485 8.91198 23.1365 3 16.0115 3 8.89922 3 3 8.91198 3 16.0242c0 7.1251 5.91198 13.0243 13.0242 13.0243zm-.0127-11.1089c-.6768 0-1.0471-.3959-1.0726-1.0726l-.1788-6.3078c-.0255-.70232.5108-1.20031 1.2386-1.20031.7151 0 1.2769.51076 1.2514 1.21301l-.1916 6.2951c-.0255.6895-.3958 1.0726-1.047 1.0726zm0 4.6989c-.7406 0-1.4301-.5874-1.4301-1.379 0-.7917.6767-1.3791 1.4301-1.3791.7533 0 1.4301.5746 1.4301 1.3791 0 .8044-.6895 1.379-1.4301 1.379z"})})},752773:(e,t,o)=>{o.d(t,{W:()=>p});o(296540);var n=()=>o(56366),r=()=>o(401497),i=()=>o(252291),l=()=>o(493552),a=()=>o(898244),s=()=>o(251846),c=()=>o(177618),d=()=>o(405417),u=o(474848);function p({blockStore:e,collectionContextStore:t,wrapperStyle:o}){const p=(0,n().O$)(t.currentSubitemFormatStoreForCollectionStore),y=(0,n().K8)((()=>(0,c().Dj)({store:e,collectionContextStore:t})),[t,e]),m=(0,n().K8)((()=>{if(!p||!y)return;const e=y.getSchema()[p.property];return void 0!==e&&(0,a().nC)(e)?e:void 0}),[y,p]),f=(0,r().IS)((e=>({wrapper:{display:"inline-flex",alignItems:"center",gap:2,verticalAlign:" text-top",paddingInlineEnd:8,...o}})),[o]),S=(0,n().K8)((()=>p&&m?(0,d().rt)({store:e,subitemFormat:p,propertySchema:m}).length:0),[e,p,m]);return(0,n().K8)((()=>(0,d().Kk)({collectionContextStore:t,blockStore:e})),[t,e])&&0!==S?(0,u.jsxs)("span",{style:f.wrapper,children:[(0,u.jsx)(i().I,{icon:s().F,size:"sm",colorVariant:"secondary"}),(0,u.jsx)(l().D,{colorVariant:"tertiary",styleKey:"Body-sm/Medium",children:S})]}):null}},761408:(e,t,o)=>{o.d(t,{Le:()=>i,fr:()=>a,yo:()=>l});var n=()=>o(56366),r=()=>o(908201);function i({collectionStore:e,collectionContextStore:t,property:o}){return null!=t&&t.isMultiSourceView?e.getMappedProperty(o):o}function l({collectionStore:e,property:t}){const o=(0,r().Ks)();return(0,n().K8)((()=>i({collectionStore:e,collectionContextStore:o,property:t})),[e,o,t])}function a(e,t){if(!t)return{tokenLimit:void 0,tokenLimitThreshold:void 0};return"compact"===t.getCardLayoutMode()&&e?{tokenLimit:1,tokenLimitThreshold:3}:{tokenLimit:void 0,tokenLimitThreshold:void 0}}},795354:(e,t,o)=>{o.d(t,{A:()=>a});o(296540);var n=()=>o(784892),r=()=>o(69708),i=o(474848);const l={[n().NY.ExtremeSmall]:{height:12,fontSize:8,margin:"0 4px 0 0"},[n().NY.ExtraSmall]:{height:14,fontSize:12,margin:"0 4px 0 0"},[n().NY.Small]:{height:18,fontSize:12,margin:"0 6px 6px 0"},[n().NY.CompactEssential]:{height:21,fontSize:14,margin:"0 12px 6px 0"},[n().NY.Medium]:{height:21,fontSize:14,margin:"0 12px 6px 0"},[n().NY.Inline]:{height:21,fontSize:14,margin:"0 12px 0 0"},[n().NY.Large]:{height:24,fontSize:16,margin:"0 8px 8px 0"}};const a=function(e){const{count:t,format:n,fixedHeight:a,style:s,isCompact:c}=e,{margin:d,height:u,fontSize:p}=l[n],y=(0,o(401497).IS)((e=>({wrapper:{display:"flex",alignItems:"center",lineHeight:1.2,borderRadius:4,fontSize:p,margin:d,color:e.text.secondary,...a&&{height:u},...s},compact:{whiteSpace:"nowrap"}})),[p,u,a,d,s]);return(0,i.jsx)("div",{style:y.wrapper,children:c?(0,i.jsx)("span",{style:y.compact,children:(0,i.jsx)(r().sA,{defaultMessage:"+{thinSpace}{moreItemsCount}",id:"database.tokens.moreItems.message",values:{moreItemsCount:t,thinSpace:(0,i.jsx)("span",{children:""})}})}):(0,i.jsx)("span",{children:(0,i.jsx)(r().sA,{defaultMessage:"{relationMoreItemsCount} more",id:"database.relationPropertyValue.moreItems.message",values:{relationMoreItemsCount:t}})})})}},843141:(e,t,o)=>{o.d(t,{E:()=>l});var n=()=>o(314529),r=()=>o(534177),i=()=>o(476492);function l(e,t,o){var l,a,s;let c="page_properties";const d=(0,i().sl)(t);switch(d.view_type){case void 0:case"page":case"table":c="table";break;case"list":c="list";break;case"gallery":c="gallery";break;case"board":c="board";break;case"calendar":c="calendar";break;case"timeline":c="timeline";break;case"chart":case"form_editor":case"feed":case"map":case"chat":case"custom":case"dashboard":break;default:(0,r().HB)(d.view_type)}const u={...o,collection_id:null==t||null===(l=t.collectionStore())||void 0===l?void 0:l.id,collection_view_id:null==t||null===(a=t.collectionViewStore())||void 0===a?void 0:a.id,collection_view_block_id:null==t||null===(s=t.collectionViewBlockStore())||void 0===s?void 0:s.id,from:c};(0,n().DO_NOT_USE_trackLegacy)(e,"copy_property",u)}},846156:(e,t,o)=>{o.d(t,{F:()=>r});var n=()=>o(314529);function r(e,t){(0,n().DO_NOT_USE_trackLegacy)(e,"relation_reorder",t)}},880263:(e,t,o)=>{o.d(t,{Dd:()=>M,Dl:()=>k,ER:()=>_,I8:()=>x,S1:()=>v,V6:()=>w,_Z:()=>R,ej:()=>I,h3:()=>C,jd:()=>b,rw:()=>P,xV:()=>j,zg:()=>h});o(581454);var n=o(296540),r=()=>o(59226),i=()=>o(56366),l=()=>o(401497),a=()=>o(713998),s=()=>o(761408),c=()=>o(802229),d=()=>o(346863),u=()=>o(971003),p=()=>o(153364),y=()=>o(712354),m=()=>o(96409),f=o(474848);const S=[],h=n.memo((0,n.forwardRef)((function(e,t){const{buttonStyle:r,editButtonClickProps:s,property:c,EmptyComponent:d,onContextMenu:p,tokenLimit:y,tokenLimitThreshold:m,store:h,quickActionButtons:b,width:x,limitTokensToSingleTruncatedLine:v,userExpandable:C,formQuestionStore:k,collectionSchema:w,generateButtonStyles:P}=e,{propertySchema:I,baseStyles:j,shouldRenderTooltip:_}=(0,n.useContext)(u().L8),R=(0,o(496645).Ug)(null==j?void 0:j.tokenFormat),M=I,E=(null==M?void 0:M.options)??S,B=null==M?void 0:M.type,A=(0,i().K8)((()=>h.getPropertyValue(c)),[h,c]),[T,L]=(0,n.useMemo)((()=>{let e=[];if("select"===B){const t=a().fF(A,E);e=t?[t]:[]}else e=a().J4(A,E);k&&(e=e.map((e=>({...e,color:"default"}))));const t=void 0!==y,o=void 0===m||e.length>=m,n=t&&o;return[n?e.slice(0,y):e,n?e.slice(y):[]]}),[B,y,m,A,E,k]),V=void 0!==k&&T.length>0,F=(0,l().IS)((e=>({buttonStyle:{...j.buttonStyle,...r,...(null==P?void 0:P(e,0===T.length))||{}},buttonPressedStyle:j.buttonPressedStyle??{},buttonHoveredStyle:j.buttonHoveredStyle??{},overflowIndicator:{marginInlineEnd:4,color:e.text.secondary},tooltip:{padding:8},remainderPropertiesContainer:{display:"flex",flexWrap:"wrap",fontWeight:"normal",width:"max-content",maxWidth:"240px",gap:4},selectToken:{margin:0},tokenContainer:v?{display:"flex",flexWrap:"nowrap",...o(284371).RC}:{alignItems:"center"},moreToken:{margin:0,...v?{flexShrink:0}:{}},propertyValuesWrapper:{width:"100%",display:V?"inline-flex":void 0,justifyContent:"space-between",alignItems:"center"},chevronIcon:{marginInlineEnd:-4,flexShrink:0}})),[j.buttonHoveredStyle,j.buttonPressedStyle,j.buttonStyle,r,P,v,T.length,V]);return null!=T&&T.length||void 0!==d?(0,f.jsx)(o(986621).P,{ref:t,editButtonClickProps:s,onContextMenu:p,style:F.buttonStyle,hoveredStyle:F.buttonHoveredStyle,pressedStyle:F.buttonPressedStyle,quickActionButtons:b,width:x,userExpandable:C,formQuestionStore:k,collectionSchema:w,children:null!=T&&T.length||void 0===d?(0,f.jsxs)("div",{style:F.propertyValuesWrapper,children:[(0,f.jsx)(g,{shownOptions:T,hiddenOptions:L,tokenLimit:y,tokenFormat:R,styles:F,store:h,property:c,parentHasTooltip:_}),V?(0,f.jsx)("div",{style:F.chevronIcon,children:(0,f.jsx)(o(252291).I,{icon:o(511296).T,size:"sm",colorVariant:"tertiary"})}):null]}):(0,f.jsx)(d,{})}):null})));function g({shownOptions:e,hiddenOptions:t,tokenLimit:n,styles:r,tokenFormat:i,store:a,property:s,parentHasTooltip:c}){const d=(0,l().eP)(),u=(0,o(358167).v)({blockId:null==a?void 0:a.id,propertyId:s}),p=(0,o(213828).s)({propertyId:s,store:a}),y=Boolean(p),S=(0,l().IS)((()=>{const e=y||u?{...(0,o(969842).sQ)(d),paddingTop:4,paddingBottom:4,flexWrap:"wrap",lineHeight:2,display:"inline"}:{},t=y||u?{marginInlineStart:3,marginInlineEnd:3,maxWidth:"fit-content",display:"inline-flex"}:{};return{tokenContainer:{...e,...r.tokenContainer},selectTokenHighlightStyle:t}}),[u,r.tokenContainer,d,y]);return(0,f.jsxs)(o(586295).h,{style:S.tokenContainer,className:p,children:[e.map((e=>(0,f.jsx)(m().X,{type:"select",value:e.value,description:e.description,color:e.color,shouldShrink:Boolean(n),style:S.selectTokenHighlightStyle,shouldShowTooltip:!c},e.id))),t.length>0?(0,f.jsx)(o(859428).A,{style:r.tooltip,renderTooltip:()=>(0,f.jsx)("div",{style:r.remainderPropertiesContainer,children:t.map((e=>(0,f.jsx)(m().X,{type:"select",value:e.value,color:e.color,shouldShrink:!1},e.id)))}),isLightBackground:!0,textWrap:!0,alignment:"center",placement:"bottom",render:e=>(0,f.jsx)("div",{...e,children:(0,f.jsx)(o(795354).A,{count:t.length,format:i,fixedHeight:!1,style:r.moreToken,isCompact:!0})})}):void 0]})}const b=(0,n.forwardRef)((function(e,t){const{store:r,property:i}=e,{shouldWrap:l}=(0,n.useContext)(u().L8),a=(0,n.useMemo)((()=>(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(o(564883).qO,{store:r,property:i},"workflow-autofill"),(0,f.jsx)(d().A,{store:r,property:i,openOverlay:!0},"autofill"),(0,f.jsx)(p().k,{},"comment")]})),[i,r]),s=M(e,t);return(0,f.jsx)(h,{...s,EmptyComponent:y().rW,quickActionButtons:a,userExpandable:l})})),x=(0,n.forwardRef)((function(e,t){const o=M(e,t),{store:r,property:i}=e,l=(0,n.useMemo)((()=>(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(d().A,{store:r,property:i,openOverlay:!0},"autofill"),(0,f.jsx)(p().k,{},"comment")]})),[i,r]);return(0,f.jsx)(h,{...o,EmptyComponent:y().ao,quickActionButtons:l})})),v=(0,n.forwardRef)((function(e,t){const o=M(e,t),{store:r,property:i}=e,l=(0,n.useMemo)((()=>(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(d().A,{store:r,property:i,openOverlay:!0},"autofill"),(0,f.jsx)(p().k,{},"comment")]})),[i,r]);return(0,f.jsx)(h,{...o,EmptyComponent:y().ao,tokenLimit:1,quickActionButtons:l,limitTokensToSingleTruncatedLine:!0})})),C=(0,n.forwardRef)((function(e,t){const{showIfEmpty:n}=e,r=M(e,t,(0,o(999943).F)(t,e.collectionStore,e.property,"multi_select"));return(0,f.jsx)(h,{...r,EmptyComponent:n?y().Jb:void 0})})),k=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=M(e,t),l=(0,r().X)("card_customization"),{tokenLimit:a,tokenLimitThreshold:c}=(0,i().K8)((()=>(0,s().fr)(l,e.collectionViewStore)),[e.collectionViewStore,l]);return(0,f.jsx)(h,{...n,EmptyComponent:o?y().Jb:void 0,tokenLimit:a,tokenLimitThreshold:c})})),w=(0,n.forwardRef)((function(e,t){const o=M(e,t);return(0,f.jsx)(h,{...o})})),P=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=M(e,t),l=(0,r().X)("card_customization"),{tokenLimit:a,tokenLimitThreshold:c}=(0,i().K8)((()=>(0,s().fr)(l,e.collectionViewStore)),[e.collectionViewStore,l]);return(0,f.jsx)(h,{...n,EmptyComponent:o?y().Jb:void 0,tokenLimit:a,tokenLimitThreshold:c})})),I=(0,n.forwardRef)((function(e,t){const o=M(e,t);return(0,f.jsx)(h,{...o})})),j=(0,n.forwardRef)((function(e,t){const o=M(e,t);return(0,f.jsx)(h,{...o})})),_=(0,n.forwardRef)((function(e,t){const o=M(e,t);return(0,f.jsx)(h,{...o})})),R=(0,n.forwardRef)((function(e,t){const o=M(e,t);return(0,f.jsx)(h,{...o,EmptyComponent:y().Fe,tokenLimit:1})}));function M(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l,width:a}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,c().QK)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle,width:a}}},886025:(e,t,o)=>{o.d(t,{J:()=>y,Y:()=>p});var n=o(296540),r=()=>o(59226),i=()=>o(484714),l=()=>o(401497),a=()=>o(451306),s=()=>o(236030),c=()=>o(971003),d=o(474848);const u=4;function p(e){const{children:t,align:o,sticky:p,style:y}=e,m=(0,i().WS)(),f=(0,r().X)("title_property_peek_button_redesign"),{property:S}=(0,n.useContext)(c().L8),h=(0,l().IS)((t=>{const n=e.height||24,r=m?s().Um:s().tt;return{buttonWrapperStyle:{display:"flex",justifyContent:"right"===o?"end":"start",position:"absolute",top:(r-n)/2,insetInlineEnd:0,insetInlineStart:0,zIndex:2,margin:`0 ${u}px`,pointerEvents:"none",...y},innerWrapperStyle:{position:"relative",display:"flex",pointerEvents:"auto",background:f&&m&&"title"===S?void 0:t.background.elevated,padding:"2px",height:n,boxShadow:f&&m&&"title"===S?void 0:t.shadowSM,borderRadius:6,...f&&m&&{width:48,height:48,alignItems:"center",justifyContent:"center",marginTop:-12,marginInlineEnd:-8,borderRadius:0}},stickyStyle:{position:"sticky",insetInlineEnd:u},buttonHitBoxStyle:{position:"absolute",top:10,bottom:10,insetInlineStart:10,insetInlineEnd:10,zIndex:-1,background:t.background.elevated,boxShadow:t.shadowSM,borderRadius:"50%",pointerEvents:"auto"}}}),[o,m,e.height,y,f,S]);return t?(0,d.jsx)("div",{style:h.buttonWrapperStyle,children:(0,d.jsxs)("div",{...(0,a().AH)(h.innerWrapperStyle,p&&h.stickyStyle),className:"quickActionContainer",children:[f&&m&&"title"===S?(0,d.jsx)("div",{style:h.buttonHitBoxStyle}):void 0,t]})}):null}function y(e){const{surface:t,align:o}=e;switch(t){case"table":return(0,d.jsx)(b,{...e,align:o??"right"});case"property_module":case"page":return(0,d.jsx)(f,{...e,align:o??"right"});case"compact_page":return(0,d.jsx)(S,{...e,align:o??"right"});case"board":return(0,d.jsx)(m,{...e,align:o??"right"});case"gallery":return(0,d.jsx)(h,{...e,align:o??"right"});case"list":return(0,d.jsx)(g,{...e,align:o??"right"});default:return(0,d.jsx)(p,{...e,align:o??"right"})}}function m(e){const t=(0,l().IS)((()=>({buttonWrapperStyle:{top:0,...e.style}})),[e.style]);return(0,d.jsx)(p,{...e,style:t.buttonWrapperStyle})}function f(e){const{propertyModule:t}=(0,n.useContext)(c().L8),o=(0,l().IS)((()=>({buttonWrapperStyle:{top:t&&"style"in t&&"large"===t.style?10:5,...e.style}})),[t,e.style]);return(0,d.jsx)(p,{...e,style:o.buttonWrapperStyle})}function S(e){const t=(0,l().IS)((()=>({buttonWrapperStyle:{top:"unset",...e.style}})),[e.style]);return(0,d.jsx)(p,{...e,style:t.buttonWrapperStyle})}function h(e){const t=(0,l().IS)((()=>({buttonWrapperStyle:{top:-1,...e.style}})),[e.style]);return(0,d.jsx)(p,{...e,style:t.buttonWrapperStyle})}function g(e){const t=(0,l().IS)((()=>({buttonWrapperStyle:{position:void 0,margin:0,...e.style}})),[e.style]);return(0,d.jsx)(p,{...e,style:t.buttonWrapperStyle})}function b(e){const{align:t="right"}=e,{isMobile:o}=(0,i().Y0)(),{shouldWrap:r,propertyFormat:a}=(0,n.useContext)(c().L8),s=null==a?void 0:a.width,y=(0,n.useMemo)((()=>s&&s<=32?u-4:s&&s<50?u-2:u),[s]),m=(0,l().IS)((()=>({buttonWrapperStyle:{...e.style,...o&&r?{position:"sticky",float:t,marginInlineEnd:0,marginInlineStart:2,insetInlineEnd:y}:{margin:`0 ${y}px`}}})),[t,y,o,e.style,r]);return(0,d.jsx)(p,{...e,style:m.buttonWrapperStyle,sticky:!0})}},913687:(e,t,o)=>{o.d(t,{A:()=>n});const n=(0,o(69708).YK)({inputPlaceholder:{defaultMessage:"Property name",id:"database.viewSettings.propertyTab.propertyName"},autofillOffLabel:{defaultMessage:"Off",id:"database.viewSettings.propertyTab.autofillOffLabel"},autofillOnLabel:{defaultMessage:"On",id:"database.viewSettings.propertyTab.autofillOnLabel"},keptUpToDateWithNotionAITooltip:{defaultMessage:"Auto-updated by AI",id:"database.tableHeaderCell.tooltipAiAutofillDescription"},buttonPropertyErrorTooltip:{defaultMessage:"Button property has an error",id:"database.tableHeaderCell.tooltipButtonPropertyError"},offlineWarningFormula:{id:"database.tableHeaderCell.offlineWarning.formula",defaultMessage:"Formula results may not be accurate when offline"},offlineWarningAutoUpdate:{id:"database.tableHeaderCell.offlineWarning.autoUpdate",defaultMessage:"Content will not auto-update when offline"},usersAndGroups:{defaultMessage:"Users and groups",id:"database.personProperty.notifications.usersAndGroups"},usersOnly:{defaultMessage:"Users only",id:"database.personProperty.notifications.usersOnly"},none:{defaultMessage:"None",id:"database.personProperty.notifications.none"}})},986621:(e,t,o)=>{o.d(t,{P:()=>M});o(898992),o(737550);var n=o(296540),r=()=>o(402014),i=()=>o(484714),l=()=>o(56366),a=()=>o(401497),s=()=>o(929219),c=()=>o(471095),d=()=>o(534177),u=()=>o(675592),p=()=>o(267584),y=()=>o(252833),m=()=>o(236030);function f(e){const{propertySchema:t,isPhone:o}=e;if(!t)return o?m().A4:m().Nh;switch(function(e){switch(e){case"auto_increment_id":case"created_by":case"created_time":case"date":case"email":case"formula":case"last_edited_by":case"last_edited_time":case"last_visited_time":case"location":case"multi_select":case"number":case"phone_number":case"place":case"rollup":case"text":case"title":case"url":case"verification":return"text";case"button":case"file":return"button";case"checkbox":return"checkbox";case"person":case"relation":case"select":case"status":return"token";default:(0,d().HB)(e)}}(t.type)){case"default":return o?m().A4:m().Nh;case"text":return o?m().Wh:m().Zs;case"token":return o?m().Sh:m().hB;case"checkbox":return o?m().IH:m().Nl;case"button":return o?m().DX:m().Mk}}var S=()=>o(971003),h=o(474848);function g({children:e,blockPropertyValueOverlayStore:t}){const r=(0,i().WS)(),l=(0,n.useRef)(null),{collectionContextStore:a,store:s,property:c,propertySchema:d}=(0,n.useContext)(S().L8),p=(0,u().PD)(),y=null==a?void 0:a.virtualizedModule.getBlockHeightsCache(),m=(0,n.useRef)(!1),g=(0,n.useCallback)((e=>{y&&s&&!e.state.isOpen&&(y.expandHeightToTallestCached(s.id),e.removeListener(g),m.current=!1)}),[y,s]),b=(0,n.useCallback)((e=>{if(!(y&&s&&c&&e))return;const n=y.getPropertyHeightStore(s.id,c).state,i=f({isPhone:r,propertySchema:d}),l=0===e.height?0:e.height+i+i;y.cachePropertyHeight(s.id,c,l),n!==l&&!1===(null==p?void 0:p.isScrolling)&&!0!==o(230062).A.state&&(null!=t&&t.state.isOpen&&!m.current?(t.addListener(g),m.current=!0):y.expandHeightToTallestCached(s.id))}),[y,s,c,r,d,null==p?void 0:p.isScrolling,t,g]);return(0,o(828634).tK)(l,b),(0,h.jsx)("div",{ref:l,children:e})}function b(){const e=(0,a().IS)((e=>({outer:{display:"inline-flex",overflow:"hidden",position:"relative",width:"100%"},inner:{width:"60%",height:10,borderRadius:12,backgroundColor:e.lightDividerColor}})),[]);return(0,h.jsx)("div",{style:e.outer,children:(0,h.jsx)(o(710149).A,{style:e.inner})})}var x=()=>o(488173),v=()=>o(69708),C=()=>o(765957);const k=(0,v().YK)({upgrade_to_enterprise:{defaultMessage:"Upgrade to Enterprise to edit this property",id:"BlockPropertyButtonExternalPropertyTooltip.upgradeToEnterprise"},two_way_sync_not_enabled:{defaultMessage:"Enable 2-way sync to edit",id:"BlockPropertyButtonExternalPropertyTooltip.twoWaySyncRequired"},property_not_editable:{defaultMessage:"This property can only be edited in {integration}",id:"BlockPropertyButtonExternalPropertyTooltip.propertyNotEditable"},connect_to_integration:{defaultMessage:"Connect to {integration} to edit",id:"BlockPropertyButtonExternalPropertyTooltip.connectToIntegration"},full_access:{defaultMessage:"You have full access to this property",id:"BlockPropertyButtonExternalPropertyTooltip.fullAccess"},read_only:{defaultMessage:"Re-authorize with {integration} to allow editing from Notion",id:"BlockPropertyButtonExternalPropertyTooltip.onlyReadPermission"},sync_failed:{defaultMessage:"Cannot be edited for failed sync",id:"BlockPropertyButtonExternalPropertyTooltip.syncFailed"},sync_in_progress:{defaultMessage:"Cannot be edited while sync is in progress",id:"BlockPropertyButtonExternalPropertyTooltip.syncInProgress"},offline:{defaultMessage:"Cannot be edited while offline",id:"BlockPropertyButtonExternalPropertyTooltip.offline"}}),w=(0,v().YK)({dataCannotBeEdited:{defaultMessage:"Data synced from {integration} cannot be edited",id:"BlockPropertyButtonExternalPropertyTooltip.dataCannotBeEdited"},notionOnlyProperty:{defaultMessage:"This property is only visible in Notion",id:"BlockPropertyButtonExternalPropertyTooltip.notionOnlyProperty"}});function P({collectionContextStore:e,propertySchema:t,baseTooltip:o}){const r=(0,n.useContext)(S().L8),i=(0,l().K8)((()=>{var e;return"enterprise"===(null===(e=C().default.getState().sidebarSpaceStore)||void 0===e?void 0:e.getSubscriptionTier())}),[]),a=(0,l().K8)((()=>{const o=null==e?void 0:e.collectionStore();if(!o||!t||!r.property)return!1;const n=o.getFormat(),i=Boolean((null==n?void 0:n.external_collection_type)&&(null==n?void 0:n.sync_state));return(0,p().sc)({propertyId:r.property,collectionStore:o,propertySchema:t,isExternallyImportedAndSyncedCollection:i})}),[e,t,r.property]),c=(0,l().K8)((()=>{var o,n,r,l,a;const c=null==e?void 0:e.collectionStore(),d=null==c?void 0:c.getFormat().external_collection_type;if(!(c&&(0,y().cd)(d)&&(0,p().JD)(c)&&(0,y().fo)({collectionStore:c})))return{twoWaySyncUserState:void 0,integration:d};const u="read_write"===(null==t?void 0:t.synced_permissions);if(!i)return{twoWaySyncUserState:(0,x().fW)({isUserOnEnterprisePlan:i,isEditableProperty:u}),integration:d};const m=null==e||null===(o=e.collectionStore())||void 0===o?void 0:o.getFormat(),f=Boolean(null==m||null===(n=m.sync_state)||void 0===n?void 0:n.enable_two_way_sync);if(!f)return{twoWaySyncUserState:(0,x().fW)({isUserOnEnterprisePlan:i,twoWaySyncEnabled:f,isEditableProperty:u}),integration:d};const S=Boolean(null==m||null===(r=m.sync_state)||void 0===r?void 0:r.syncing),h=Boolean(null==m?void 0:m.error),g=Boolean(null==e||null===(l=e.externalSyncStore)||void 0===l||null===(l=l.state)||void 0===l?void 0:l.doesUserHaveOnlyReadPermission()),b=Boolean(null==e||null===(a=e.externalSyncStore)||void 0===a||null===(a=a.state)||void 0===a?void 0:a.shouldAllowUserToEditSyncedCollection()),v=!s().A.state.online;return{twoWaySyncUserState:(0,x().fW)({isUserOnEnterprisePlan:i,twoWaySyncEnabled:f,canEdit:b,isEditableProperty:u,doesUserHaveOnlyReadPermission:g,isSyncing:S,isFailedSync:h,isOffline:v}),integration:d}}),[i,e,t]);if(a)return(0,h.jsx)(v().sA,{...w.notionOnlyProperty});if(c.twoWaySyncUserState){if("full_access"===c.twoWaySyncUserState)return o;if("connect_to_integration"===c.twoWaySyncUserState||"two_way_sync_not_enabled"===c.twoWaySyncUserState||"read_only"===c.twoWaySyncUserState){const e={...k[c.twoWaySyncUserState],values:{integration:c.integration??"integration"}};return(0,h.jsx)("div",{children:(0,h.jsx)(v().sA,{...e})})}return(0,h.jsx)(v().sA,{...k[c.twoWaySyncUserState],values:{integration:c.integration??"integration"}})}{const e={...w.dataCannotBeEdited,values:{integration:c.integration??"integration"}};return(0,h.jsx)(v().sA,{...e})}}function I(e){const{propertyValue:t,propertyCaption:r,render:i}=e,{propertySchema:l,surface:s,shouldRenderTooltip:c,isExternallyImportedAndSyncedPage:d,collectionContextStore:u}=(0,n.useContext)(S().L8),p=null==l?void 0:l.name,y=!c||"location"===(null==l?void 0:l.type),m="board"===s||"gallery"===s,f=(null==p?void 0:p.length)&&!y,g=void 0!==t,b=void 0!==r,x=f||g||b,v=(0,a().IS)((e=>({value:{color:f?e.text.inverseSecondary:void 0},caption:{color:f||g?e.text.inverseSecondary:void 0}})),[f,g]),C=(0,n.useCallback)((()=>{const e=(0,h.jsxs)(h.Fragment,{children:[f?(0,h.jsx)("div",{children:p}):void 0,g?(0,h.jsx)("div",{style:v.value,children:t}):void 0,b?(0,h.jsx)("span",{style:v.caption,children:r}):void 0]}),n=null==u?void 0:u.collectionStore();return d&&n&&!(0,o(202775).r)(n)?(0,h.jsx)(P,{collectionContextStore:u,propertySchema:l,baseTooltip:e}):e}),[b,f,g,r,p,t,v,d,u,l]);return x?(0,h.jsx)(o(859428).A,{renderTooltip:C,render:e=>i(e),tooltipClassName:o(38337).Efz,placement:m?"left":"bottom"}):i()}const j=(0,o(340498).wt)("arrowUpDown",{viewBox:"0 0 20 20",directional:!0,svg:(0,h.jsx)("path",{d:"M10 16.8662C9.89518 16.8662 9.79492 16.848 9.69922 16.8115C9.60807 16.7751 9.52604 16.7181 9.45312 16.6406L5.90527 13.0244C5.75488 12.874 5.67969 12.6986 5.67969 12.498C5.67969 12.2839 5.74577 12.1107 5.87793 11.9785C6.01009 11.8464 6.18099 11.7803 6.39062 11.7803C6.49544 11.7803 6.58887 11.8008 6.6709 11.8418C6.75293 11.8828 6.82585 11.9352 6.88965 11.999L8.33203 13.4756L9.33008 14.6514L9.26855 13.1133V7.01562L9.33008 5.47754L8.33203 6.64648L6.88965 8.12988C6.82585 8.19368 6.75293 8.24609 6.6709 8.28711C6.58887 8.32357 6.49544 8.3418 6.39062 8.3418C6.18099 8.3418 6.01009 8.27799 5.87793 8.15039C5.74577 8.01823 5.67969 7.84277 5.67969 7.62402C5.67969 7.42806 5.75488 7.25488 5.90527 7.10449L9.45312 3.48828C9.52604 3.41081 9.60807 3.35384 9.69922 3.31738C9.79492 3.28092 9.89518 3.2627 10 3.2627C10.0957 3.2627 10.1891 3.28092 10.2803 3.31738C10.376 3.35384 10.4626 3.41081 10.54 3.48828L14.0879 7.10449C14.2383 7.25488 14.3135 7.42806 14.3135 7.62402C14.3135 7.84277 14.2451 8.01823 14.1084 8.15039C13.9762 8.27799 13.8076 8.3418 13.6025 8.3418C13.4977 8.3418 13.4043 8.32357 13.3223 8.28711C13.2402 8.24609 13.165 8.19368 13.0967 8.12988L11.6611 6.64648L10.6562 5.47754L10.7246 7.01562V13.1133L10.6562 14.6514L11.6611 13.4756L13.0967 11.999C13.165 11.9352 13.2402 11.8828 13.3223 11.8418C13.4043 11.8008 13.4977 11.7803 13.6025 11.7803C13.8076 11.7803 13.9762 11.8464 14.1084 11.9785C14.2451 12.1107 14.3135 12.2839 14.3135 12.498C14.3135 12.6986 14.2383 12.874 14.0879 13.0244L10.54 16.6406C10.4626 16.7181 10.376 16.7751 10.2803 16.8115C10.1891 16.848 10.0957 16.8662 10 16.8662Z"})});const _=(0,v().YK)({expand_property:{defaultMessage:"Expand",id:"database.ExpandButton"}});function R({store:e,property:t,showHoverColor:r}){const i=(0,v().tz)(),s=(0,o(908201).Ks)(),c=null==s?void 0:s.virtualizedModule.getBlockHeightsCache(),d=(0,l().K8)((()=>null==c?void 0:c.propertyCanExpandStore(e.id,t).state),[c,t,e]),u=(0,n.useCallback)((()=>{null==c||c.expandHeightToTallestCached(e.id)}),[c,e.id]),p=(0,a().IS)((e=>({icon:{color:r?e.icon.secondary:e.icon.tertiary,fill:r?e.icon.secondary:e.icon.tertiary,height:16,width:16},iconButton:{height:20,width:20}})),[r]);return s&&d?(0,h.jsx)(o(527257).A,{onClick:u,icon:j,tooltip:i.formatMessage(_.expand_property),iconStyle:p.icon,style:p.iconButton}):null}const M=n.memo((0,n.forwardRef)((function(e,t){const{tooltipPropertyValue:o,tooltipPropertyCaption:n,tooltipHide:r}=e,i=o=>(0,h.jsx)(E,{ref:t,...e,tooltipEvents:o});return r?i():(0,h.jsx)(I,{propertyValue:o,propertyCaption:n,render:i})}))),E=(0,n.forwardRef)((function(e,t){const{style:m,quickActionButtons:f,quickActionButtonsAlign:x,quickActionButtonsForceVisible:v,editButtonClickProps:C,width:k,forceEnableButton:w,collectionSchema:P,onContextMenu:I,formQuestionStore:j,userExpandable:_}=e,M=(0,i().v3)(),{isAndroid:E,isMobile:B,isPhone:A}=(0,i().Y0)(),[T,L]=(0,n.useState)(!1),[V,F]=(0,n.useState)(!1),{collectionContextStore:W,surface:H,canEdit:O,store:K,property:D,baseStyles:z,propertySchema:N}=(0,n.useContext)(S().L8),q=(0,l().O$)(s().e),U=(0,l().K8)((()=>Boolean(null==W?void 0:W.viewsModuleContextStore.isInLayoutBuilder())),[W]),Q="text"===(null==N?void 0:N.type)&&!(null!=N&&N.ai_inference),J=(0,l().K8)((()=>!!Q&&(!!K&&(0,o(299545).O3)(K,{includePropertyDiscussions:!0}).some((e=>e.getPropertyId()===D)))),[Q,D,K]),{isLoading:$,isExternalUpdateInProgress:Y,shouldShowLockIcon:Z}=(0,l().K8)((()=>{var e;const t=null==W?void 0:W.collectionStore(),n=null==K?void 0:K.getFormat(),r=!(null!=n&&null!==(e=n.attributes)&&void 0!==e&&e.length)&&!(null!=n&&n.error)&&Boolean(null==t?void 0:t.isSyncedCollection());if(!(null==t?void 0:t.isExternallyImportedAndSyncedCollection())||null==K||!K.id||!D)return{isLoading:r,isExternalUpdateInProgress:!1,shouldShowLockIcon:!1};const i=o(485634).A.getState();return{isLoading:r,isExternalUpdateInProgress:Boolean(i.syncingProperties.size>0&&i.syncingProperties.has((0,y().vT)({pageId:K.id,propertyId:D}))),shouldShowLockIcon:(0,o(802229).FH)({collectionStore:t,propertySchema:N,isJiraTwoWaySyncEnabled:(0,p().JD)(t),surface:H,propertyId:D})}}),[W,K,D,N,H]),G=(0,o(106412).Zp)(),X=q||!q&&(0,d().O9)(N)&&!(0,o(334684).$)({propertyType:null==N?void 0:N.type,propertySchema:N,allowAIProperty:!0}),ee=(w||O&&void 0!==C||J)&&!U&&!(null!=G&&G.disableContentPointerEvents)&&X,te=(0,a().IS)((()=>({buttonStyle:{position:"relative",...m,display:Y?"flex":null==m?void 0:m.display,...ee?{}:{cursor:"default"}},expandButtonPosition:{position:"relative",insetInlineStart:"left"===x?-2:2,float:"left"===x?"inline-start":"inline-end"},lockIconContainer:{position:"absolute",insetInlineEnd:8,top:"50%",transform:"translateY(-50%)",zIndex:1,pointerEvents:"none",opacity:T?1:0,transition:"opacity 0.15s ease"}})),[m,Y,x,ee,T]),oe=(0,n.useRef)(null),ne=(0,n.useCallback)((()=>{F(!0)}),[]),re=(0,n.useCallback)((e=>{oe.current&&e.relatedTarget&&(!e.relatedTarget||oe.current.contains(e.relatedTarget))||F(!1)}),[]),ie=(0,n.useCallback)((()=>{L(!0)}),[]),le=(0,n.useCallback)((()=>{L(!1)}),[]),ae=(0,n.useCallback)((e=>{E&&A?e.preventDefault():I&&(0,r().SQ)({event:e,context:r().y$.EditorContextMenu,callback:()=>{I(e)}})}),[E,A,I]),se=(0,u().DV)(),ce=_&&se,de=(0,n.useCallback)((async e=>{if(void 0===C)return;const{onClick:t,store:n,property:r,surface:i,collectionStore:l,blockPropertyValueOverlayStore:a,disableHorizontalEdgeScroll:s,isStatusCheckbox:c,focusButtonAfterClose:d}=C;await o(581350).V({element:oe.current??void 0,environment:M,onClick:t,store:n,property:r,surface:i,collectionStore:l,blockPropertyValueOverlayStore:a,disableHorizontalEdgeScroll:s,collectionContextStore:W,collectionSchema:P,setMouseEntered:L,statusSetCheckbox:c?!e.altKey:void 0,sizing:"large"===(null==z?void 0:z.sizing)?"large":"default",formQuestionStore:j,onClose:()=>{var e;d&&(null===(e=oe.current)||void 0===e||e.focus())}})}),[C,M,W,P,null==z?void 0:z.sizing,j]),ue=(0,n.useCallback)((e=>{var o;null===(o=oe.current)||void 0===o||o.removeEventListener("focusout",re),oe.current=e,null==e||e.addEventListener("focusout",re),"function"==typeof t?t(e):t&&(t.current=e)}),[re,t]),pe=(0,o(736230).V)({collectionContextStore:W,blockId:null==K?void 0:K.id,property:D,featureEnabled:ce}),ye=U||(null==G?void 0:G.disablePageLinks),me=(0,n.useMemo)((()=>{if(ye||!f||Array.isArray(f)&&0===f.length)return null;const t=void 0!==v?v||V:(!k||k>80)&&(T||V||B);if(!t)return pe&&K&&D?(0,h.jsx)("div",{style:te.expandButtonPosition,children:(0,h.jsx)(R,{store:K,property:D})}):null;const n=pe?(0,h.jsxs)(h.Fragment,{children:["left"===x&&K&&D?(0,h.jsx)(R,{store:K,property:D,showHoverColor:!0}):void 0,f,x&&"right"!==x||!K||!D?void 0:(0,h.jsx)(R,{store:K,property:D,showHoverColor:!0})]}):f;return(0,h.jsxs)(h.Fragment,{children:[!B&&pe&&K&&D?(0,h.jsx)("div",{style:te.expandButtonPosition,children:(0,h.jsx)(R,{store:K,property:D})}):void 0,t?(0,h.jsx)(o(886025).J,{align:x,style:e.quickActionButtonsStyle,surface:H,containerRef:oe,children:n}):null]})}),[ye,f,k,v,V,T,B,pe,x,K,D,te.expandButtonPosition,e.quickActionButtonsStyle,H]);if($)return(0,h.jsx)("div",{style:te.buttonStyle,children:(0,h.jsx)(b,{})});const fe=(0,o(553965).A)({onMouseMove:ie,onMouseLeave:le},e.tooltipEvents);return ee?(0,h.jsxs)(o(718827).Ay,{className:e.className,ref:ue,hoveredStyle:e.hoveredStyle,pressedStyle:e.pressedStyle,style:te.buttonStyle,onContextMenu:ae,onClick:de,onFocus:ne,testId:"property-value",...fe,children:[me,ce?(0,h.jsx)(g,{blockPropertyValueOverlayStore:null==C?void 0:C.blockPropertyValueOverlayStore,children:e.children}):e.children,Y?(0,h.jsx)(o(98126).A,{style:{alignSelf:"center",marginInlineEnd:8,marginInlineStart:8}}):null,Z?(0,h.jsx)("div",{style:te.lockIconContainer,children:(0,c().i)({width:14,height:14})}):null]}):(0,h.jsxs)("div",{className:e.className,ref:ue,style:te.buttonStyle,onFocus:ne,...fe,children:[me,ce?(0,h.jsx)(g,{children:e.children}):e.children,Z?(0,h.jsx)("div",{style:te.lockIconContainer,children:(0,c().i)({width:16,height:16})}):null]})}))},988662:(e,t,o)=>{o.d(t,{g:()=>m});var n=o(296540),r=()=>o(484714),i=()=>o(56366),l=()=>o(401497),a=()=>o(631524),s=()=>o(575287),c=()=>o(340498),d=()=>o(182641),u=()=>o(299545),p=()=>o(372154),y=o(474848);function m({store:e,iconStyle:t,size:o,buttonStyle:m}){const f=(0,r().v3)(),S=(0,n.useRef)(null),h=(0,i().K8)((()=>u().oC(e,{recursivelyLoadAllDiscussions:!1})),[e]),{menuOpen:g,menuStoreId:b}=(0,i().K8)((()=>{const e=p().A.state.open;return{menuOpen:e,menuStoreId:e?p().A.state.blockStore.id:void 0}}),[]),x=(0,n.useCallback)((()=>{var t;g&&b===e.id?d().xl():(d().xl(),d().B4({environment:f,blockStore:e,shouldFocusDiscussion:!0,analyticsFrom:"db_page_comments",rect:null===(t=S.current)||void 0===t?void 0:t.getBoundingClientRect(),recursivelyLoadAllDiscussions:!1}))}),[g,b,f,e]),v=(0,l().IS)((e=>({iconStyle:{fill:e.icon.secondary}})),[]);return 0===h?null:(0,y.jsx)(a().p,{"aria-label":"Open comments",ref:S,size:"xs",style:m,onClick:x,children:(0,y.jsxs)("div",{style:t,children:[(0,s()._)({width:o??c().Ev.sm,height:o??c().Ev.sm,marginInlineEnd:3,fill:v.iconStyle.fill}),h]})})}},989184:(e,t,o)=>{o.d(t,{Z:()=>r});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"2.85 1.57 9.98 12.06",directional:!0,svg:(0,o(474848).jsx)("path",{d:"M7.442 1.758a.625.625 0 0 0-.884 0l-3.52 3.52a.625.625 0 1 0 .884.884l2.453-2.453V11.8c0 1.008.817 1.825 1.825 1.825h4a.625.625 0 1 0 0-1.25h-4a.575.575 0 0 1-.575-.575V3.709l2.453 2.453a.625.625 0 0 0 .884-.884z"})},r=(0,o(340498).wt)("arrowTurnLeftUpSmall",n)},996494:(e,t,o)=>{o.d(t,{A:()=>r});class n extends(()=>o(757695))().Store{getInitialState(){return{editMode:void 0,store:void 0}}cloneState(){return o(496603).o8(this.state)}}const r=new n},999943:(e,t,o)=>{o.d(t,{F:()=>d,X:()=>s});o(898992),o(354520),o(581454);var n=o(296540),r=()=>o(56366),i=()=>o(401497),l=()=>o(761408),a=()=>o(971003);const s=120,c={title:[s,400],text:[100,300],number:[100,150],select:[100,150],multi_select:[100,200],date:[100,150],person:[100,350],file:[100,150],checkbox:[40,100],phone_number:[100,150],formula:[100,150],relation:[100,150],rollup:[100,150],created_time:[100,150],created_by:[100,150],last_edited_time:[100,150],last_edited_by:[100,150],last_visited_time:[100,150],button:[100,150],status:[100,150],auto_increment_id:[100,150],location:[100,200],verification:[100,150],place:[100,150]};function d(e,t,o,d){const[u,p]=c[d],{collectionContextStore:y}=(0,n.useContext)(a().L8),{isBeforeTitle:m,propertyIndex:f,titleIndex:S,visibleProperties:h}=(0,r().K8)((()=>{var e,n;if(!t)return{isBeforeTitle:!1,propertyIndex:-1,titleIndex:-1,visibleProperties:[]};const r=((null===(n=((null==y||null===(e=y.collectionViewStore())||void 0===e?void 0:e.getFormat())??{}).list_properties)||void 0===n?void 0:n.filter((e=>e.visible)))??[]).map((e=>(0,l().Le)({collectionStore:t,collectionContextStore:y,property:e.property})));if(void 0===r)return{isBeforeTitle:!1,propertyIndex:-1,titleIndex:-1,visibleProperties:[]};const i=r.findIndex((e=>"title"===e)),a=r.findIndex((e=>e===o));return-1===i||-1===a?{isBeforeTitle:!1,propertyIndex:-1,titleIndex:-1,visibleProperties:[]}:{isBeforeTitle:a<i,propertyIndex:a,titleIndex:i,visibleProperties:r}}),[y,t,o]),[g,b]=(0,n.useState)(null);return(0,n.useEffect)((()=>{if(!e||!("current"in e)||!e.current)return;const t=e.current,o=new ResizeObserver((e=>{var t;const o=null===(t=e[0])||void 0===t?void 0:t.contentRect.width;o&&b(o)}));return o.observe(t),()=>{o.disconnect()}}),[e]),(0,i().IS)((()=>{if(void 0===o||void 0===d)return{};const e={};0===f?e.marginInlineStart=0:f===h.length-1&&(e.marginInlineEnd=0);const t=Math.floor(100/h.length),n=S;return f!==S&&m&&n>0?e.maxWidth=`calc((100% - ${s}px) / ${n})`:"location"===d?e.maxWidth=p:f===S||(null!==g&&g>=u&&(e.minWidth=u),e.maxWidth=`max(${p}px, ${t}%)`),"rollup"===d?{textButtonStyle:e,buttonButtonStyle:e}:{buttonStyle:e}}),[o,d,f,h.length,S,m,g,u,p])}}}]);