"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[96402],{20179:(e,t,o)=>{o.r(t),o.d(t,{addSquareRoundedSmallIcon:()=>n,iconDefinition:()=>i});o(296540);var r=o(474848);const i={viewBox:"0 0 16 16",fittedViewBox:"2.37 2.37 11.25 11.25",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M8 5a.625.625 0 0 0-.625.625v1.75h-1.75a.625.625 0 1 0 0 1.25h1.75v1.75a.625.625 0 1 0 1.25 0v-1.75h1.75a.625.625 0 1 0 0-1.25h-1.75v-1.75A.625.625 0 0 0 8 5"}),(0,r.jsx)("path",{d:"M4.25 2.375c-1.036 0-1.875.84-1.875 1.875v7.5c0 1.036.84 1.875 1.875 1.875h7.5c1.036 0 1.875-.84 1.875-1.875v-7.5c0-1.036-.84-1.875-1.875-1.875zM3.625 4.25c0-.345.28-.625.625-.625h7.5c.345 0 .625.28.625.625v7.5c0 .345-.28.625-.625.625h-7.5a.625.625 0 0 1-.625-.625z"})]})},n=(0,o(340498).wt)("addSquareRoundedSmall",i)},52404:(e,t,o)=>{o.d(t,{J:()=>i});o(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"2.12 3.72 15.76 12.56",directional:!0,svg:(0,o(474848).jsx)("path",{d:"M2.381 10.619a.875.875 0 0 1 0-1.238l5.4-5.4A.875.875 0 1 1 9.02 5.22L5.112 9.125H17.05c.456 0 .826.392.826.875s-.37.875-.826.875H5.112l3.907 3.906A.875.875 0 1 1 7.78 16.02z"})},i=(0,o(340498).wt)("arrowStraightLeftFill",r)},113507:(e,t,o)=>{o.d(t,{A:()=>r});const r=new(o(463830).A)},180328:(e,t,o)=>{o.d(t,{mD:()=>fe,n3:()=>me,Od:()=>he,U7:()=>ye,lD:()=>pe,ZB:()=>ue,lF:()=>ve,MW:()=>ge,un:()=>de,DZ:()=>le});o(16280),o(944114),o(898992),o(354520),o(803949),o(581454);var r=()=>o(564884),i=()=>o(242422),n=()=>o(662303),a=()=>o(584262),s=()=>o(700500),l=()=>o(869190),c=()=>o(165358),d=()=>o(416504),p=()=>o(416845),m=()=>o(206267),u=()=>o(490884),f=()=>o(72135),g=()=>o(179034),y=()=>o(161479),h=()=>o(69708),v=()=>o(319625),I=()=>o(496603),S=()=>o(229833),w=()=>o(763824),x=()=>o(578194),b=()=>o(609316),C=()=>o(583835);const T=(0,C().Dv)("importGoogleDoc"),A=(0,C().Dv)("importTrello");var k=()=>o(290913);const M=(0,C().Dv)("parallelImportConfluenceExport"),_=(0,C().Dv)("parallelImportConfluenceViaApi"),F=(0,C().Dv)("parallelImportConfluenceViaApiMigrations"),j=(0,C().Dv)("partitionedUniversalImport");var P=()=>o(654534);const E=(0,h().YK)({upload_file_size_exceeded:{id:"confluenceImportErrors.uploadFileSizeExceeded.message",defaultMessage:"Import file cannot exceed {maxSize}."},failed_to_extract_zip:{id:"confluenceImportErrors.failedToExtractZip.message",defaultMessage:"Failed to extract ZIP file."},no_index_html_file:{id:"confluenceImportErrors.noIndexHtmlFile.message",defaultMessage:"Your import failed because the index.html file is missing. Please include it and retry."},index_html_missing_available_pages:{id:"confluenceImportErrors.indexHtmlMissingAvailablePages.message",defaultMessage:"Your import failed because the index page doesn’t list any available pages. Please check your file and retry."},no_confluence_id_in_page_link:{id:"confluenceImportErrors.noConfluenceIdInPageLink.message",defaultMessage:"Your import failed because we couldn’t find a Confluence ID on the index page. Please check your file and retry."},failed_to_find_element:{id:"confluenceImportErrors.failedToFindElement.message",defaultMessage:"Failed to parse upload."},found_element_is_incorrect_type:{id:"confluenceImportErrors.foundElementIsIncorrectType.message",defaultMessage:"Failed to parse upload."},buffer_upload_failed:{id:"confluenceImportErrors.bufferUploadFailed.message",defaultMessage:"Failed to upload attachment from buffer."},attachment_not_found:{id:"confluenceImportErrors.attachmentNotFound.message",defaultMessage:"Failed to find attachment in ZIP file."},attachment_upload_failed:{id:"confluenceImportErrors.attachmentUploadFailed.message",defaultMessage:"Failed to upload attachment from file."},failed_to_build_page:{id:"confluenceImportErrors.failedToBuildPage.message",defaultMessage:"Failed to import page."},macro_processing_failed:{id:"confluenceImportErrors.macroProcessingFailed.message",defaultMessage:"Failed to process macro."},api_error:{id:"confluenceImportErrors.apiError.message",defaultMessage:"Failed to fetch data from api."},invalid_site_url_format:{id:"confluenceImportErrors.invalidSiteUrlFormat.message",defaultMessage:"Please enter a valid site URL. Example: https://example.com"},invalid_file_extension:{id:"confluenceImportErrors.invalidFileExtension.message",defaultMessage:"Your import failed because the file doesn’t have a .html extension. Please use an .html file and try again."}});var V=()=>o(672616);const B=(0,h().YK)({file_size_exceeded:{id:"importActions.fileImportFailedError.customSizeTooLarge.message",defaultMessage:"File is too large. Please upload a file smaller than {maxSize}"},row_limit_exceeded:{id:"row_limit_exceeded",defaultMessage:"Row limit cannot exceed {maxRows}"},column_limit_exceeded:{id:"column_limit_exceeded",defaultMessage:"Column limit cannot exceed {maxColumns}"}});var R=()=>o(155936),z=()=>o(310795),D=()=>o(492414),N=()=>o(974233);const O=1073741824;var L=()=>o(972435),U=()=>o(574209),W=()=>o(981265),H=()=>o(390181),$=()=>o(214437),Y=()=>o(113507),K=()=>o(313961),Z=()=>o(712505),G=()=>o(148832),q=()=>o(404141),J=()=>o(559926),X=()=>o(559506),Q=()=>o(901389),ee=()=>o(357625),te=()=>o(722101),oe=()=>o(496414),re=()=>o(384944),ie=()=>o(564746),ne=()=>o(185544),ae=()=>o(231297),se=()=>o(892632);const le=(0,h().YK)({uploadingOneFile:{id:"importActions.uploadingOneFile.loadingMessage",defaultMessage:"Uploading… ({percentComplete}%)"},uploadingMultipleFilesNotStarted:{id:"importActions.uploadingMultipleFilesNotStarted.loadingMessage",defaultMessage:"Uploaded 0 of {totalNumberOfFiles}"},uploadingMultipleFilesInProgress:{id:"importActions.uploadingMultipleFilesInProgress.loadingMessage",defaultMessage:"Uploaded {numberOfUploadedFiles} of {totalNumberOfFiles}"},uploadingMultipleFilesComplete:{id:"importActions.uploadingMultipleFilesComplete.loadingMessage",defaultMessage:"Uploaded {totalNumberOfFiles} of {totalNumberOfFiles}"},importingOneFile:{id:"importActions.importingOneFile.loadingMessage",defaultMessage:"Importing…"},importingMultipleFilesNotStarted:{id:"importActions.importingMultipleFilesNotStarted.loadingMessage",defaultMessage:"Imported 0 of {totalNumberOfFiles}"},importingMultipleFilesInProgress:{id:"importActions.importingMultipleFilesInProgress.loadingMessage",defaultMessage:"Imported {numberOfImportedFiles} of {totalNumberOfFiles}"},importingMultipleFilesComplete:{id:"importActions.importingMultipleFilesComplete.loadingMessage",defaultMessage:"Imported {totalNumberOfFiles} of {totalNumberOfFiles}"},importingFromTrelloMessage:{id:"importActions.importingFromTrello.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} board from Trello} other {Importing {importingCount} boards from Trello}}"},importingFromAsanaMessage:{id:"importActions.importingFromAsana.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} project from Asana} other {Importing {importingCount} projects from Asana}}"},importingFromEvernoteMessage:{id:"importActions.importingFromEvernote.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} notebook from Evernote} other {Importing {importingCount} notebooks from Evernote}}"},importingFromConfluenceViaAPIMessage:{id:"importActions.importingFromConfluenceViaAPI.loadingMessage",defaultMessage:"Importing confluence space: {confluenceSpaceKey}."},importFailed:{id:"importActions.importFailedError.message",defaultMessage:"Import failed"},importFailedWithError:{id:"importActions.importFailedWithError.message",defaultMessage:"Import failed: {error}"},fileImportFailedSizeTooLarge:{id:"importActions.fileImportFailedError.sizeTooLarge.message",defaultMessage:"Import failed: file exceeds 5MB."},fileImportFailedCustomSizeTooLarge:{id:"importActions.fileImportFailedError.customSizeTooLarge.message",defaultMessage:"File is too large. Please upload a file smaller than {maxSize}"},trelloImportFailed:{id:"importActions.trelloImportFailedError.message",defaultMessage:"Trello import failed."},asanaImportFailed:{id:"importActions.asanaImportFailedError.message",defaultMessage:"Asana import failed."},evernoteImportFailed:{id:"importActions.evernoteImportFailedError.message",defaultMessage:"Evernote import failed."},confluenceImportViaAPIFailed:{id:"importActions.confluenceImportViaAPIFailedError.message",defaultMessage:"Confluence space import failed."},importTitle:{id:"importActions.importTitle",defaultMessage:"Import {date}"},importTitleWithImportName:{id:"importActions.importTitleWithImportName",defaultMessage:"{name}"},importTitleForGenericFileImporter:{id:"importActions.importTitleForGenericFileImporter",defaultMessage:"{fileName} Import {date}"},importTitleForMondayV2:{id:"importActions.importTitleForMondayV2",defaultMessage:"Import from Monday - {date}"},onlyDocxExtensionSupported:{id:"importErrors.onlyDocxExtensionSupported.message",defaultMessage:"Import failed: file type not supported."},csvImportFailedColumnsTooLarge:{id:"importActions.csvImportFailedColumnsTooLargeError.message",defaultMessage:"Import failed: CSV file has too many columns."},csvImportFailedRowsTooLarge:{id:"importActions.csvImportFailedRowsTooLargeError.message",defaultMessage:"Your file has too many rows. The maximum allowed is 100000"},xlsxImportFailedColumnsTooLarge:{id:"importActions.xlsxImportFailedColumnsTooLargeError.message",defaultMessage:"Import failed: XLSX file has too many columns."},xlsxImportFailedRowsTooLarge:{id:"importActions.xlsxImportFailedRowsTooLargeError.message",defaultMessage:"Import failed: XLSX file has too many rows."}}),ce=1073741824;async function de(e){const{uploadType:t,allowMultiple:o}=e;return pe(e,await se().dA({environment:e.environment,supportsMobileNativeFileUpload:!1,multiple:o??!0,accept:u().k2[t].join(",")}))}async function pe(e,t){const{environment:o,pageStore:n,spaceStore:s,isTeamPage:l,spaceViewStore:u,uploadType:y,flowId:h,analyticsFrom:I}=e;let w;try{if(0===t.length)return;const v=1===t.length,S=performance.now(),x={};if("confluence"===y){const r=(Number((0,P().xc)(o))||15)*ce;if(t[0].size>r)throw J()._$(e.environment,{import_source:"confluence",data:{import_type:"file",status:"failure",error:"Maximum upload size exceeded",fileSize:t[0].size},flowId:h}),new(p().ic)("Maximum upload size exceeded",{clientData:{type:"upload_file_size_exceeded",messageValues:{maxSize:f().z3(r,1)}}})}else if("genericImporter"===y){const r=(0,z().qr)(o)||15,i=r*ce;if(t[0].size>i)throw J()._$(e.environment,{import_source:"file",data:{import_type:"file",status:"failure",error:"Maximum upload size exceeded",fileSize:t[0].size},flowId:h}),new(p().yI)("Maximum upload size exceeded",{clientData:{type:"upload_file_size_exceeded",messageValues:{maxSize:`${r} GB}`}}})}else if("pdf"===y){const o=Number(i().default.getEligibleGroup({experimentId:"special_case_pdf_file_size",defaultGroup:O.toString()})),r=o;for(const i of t)if(i.size>r)throw J()._$(e.environment,{import_source:"file",data:{import_type:"file",status:"failure",error:"Maximum upload size exceeded",fileSize:i.size},flowId:h}),new(p().yI)("Maximum upload size exceeded",{clientData:{type:"upload_file_size_exceeded",messageValues:{maxSize:`${o} GB}`}}})}const C=await new Promise(((e,r)=>{se().Zn({environment:o,uploadType:y,files:t,bucket:"temporary",bypassFreeFileUploadLimitCheck:!0,flowId:h,spaceId:s.id,onBatchStart:()=>{oe().m({message:v?le.uploadingOneFile:le.uploadingMultipleFilesNotStarted,interpolatedValues:{totalNumberOfFiles:t.length,percentComplete:0}})},onBatchProgress:({uploadedFiles:e,progressPercent:o})=>{oe().m({message:v?le.uploadingOneFile:le.uploadingMultipleFilesInProgress,interpolatedValues:{numberOfUploadedFiles:e,totalNumberOfFiles:t.length,percentComplete:o}})},onBatchCompleteWithToken:o=>{oe().m({message:v?le.uploadingOneFile:le.uploadingMultipleFilesComplete,interpolatedValues:{totalNumberOfFiles:t.length,percentComplete:100}}),e(o)},onBatchError:r})})),T=performance.now();x.uploadTimeTaken=T-S;const A="slash_command"===I&&!["googleDocs","confluence","genericImporter"].includes(y),k=await me(o,s,u,y,(null==t?void 0:t.length)??0,null==t?void 0:t[0].name,n,l,A);w=k.createdPage;const _=k.importType,F=k.pageId,E=C.map(((e,o)=>({fileURL:e.fileUrl,fileName:t[o].name,signedToken:e.signedToken}))),V=i().default.checkGate({gateName:"csvimport_faster_navigate_to_page_enabled"});let B=0;oe().m({message:v?le.importingOneFile:le.importingMultipleFilesInProgress,interpolatedValues:{numberOfImportedFiles:B,totalNumberOfFiles:t.length}});const R=(0,d().P)();if(V&&("ReplaceBlock"===_||"AppendToBlock"===_)&&"csv"===y){const e=G().B.createChildStore(s,{table:g().ev,id:F}),t=(0,D().Ay)({store:e,preferPublicLink:!1,pageVisitSource:a().y8.Import});(0,ie().navigateOnBaseUrl)({environment:o,url:t})}const N=H().R.getOrCreateImportId();for(const{fileURL:e,fileName:r,signedToken:n}of E){if("confluence"===y){J()._$(o,{import_source:"confluence",data:{import_type:"file",status:"success",fileSize:t[0].size},flowId:h});const i=fe({environment:o,spaceStore:s,spaceViewStore:u});await i.deferred.promise;const a=i.pageId;J().Pd(o,{import_source:"confluence",flowId:h});const l=ee().UT(o,M,{fileURL:e,fileName:r,page:{id:F,spaceId:s.id},loggerPageId:a,flowId:h||m().JW(),importId:N,signedToken:n},{spaceIds:[s.id]});for await(const e of l){if(e.error)throw e.error;e.value.isComplete||oe().m(e.value.status)}}else if("AppendToBlock"===_){const t={fileURL:e,fileName:r,importType:_,block:{id:F,spaceId:k.spaceId},spaceId:k.spaceId,flowId:h,userTimeZone:R,signedToken:n,importEntryPoint:I,importId:N};J().mM(o,{import_source:"genericImporter"===y?"universal":y,data:t,flowId:h});const a=i().default.checkGate({gateName:"partitioned_universal_importer"}),s={fileURL:e,fileName:r,importType:"ReplaceBlock",spaceId:k.spaceId,rootId:F,userTimeZone:R,signedToken:n,importId:N};J().Pd(o,{import_source:"genericImporter"===y?"universal":y,flowId:h});const l="genericImporter"===y&&a?ee().UT(o,j,s,{spaceIds:[]}):ee().UT(o,b().V,t,{spaceIds:[k.spaceId]});let c=!1;for await(const e of l){if(e.error)throw e.error;V&&"csv"===y&&"status"in e.value&&"created_collection"===e.value.status.message&&!c&&(c=!0,oe().V(),q().A.reset(),x.importingSpinnerSpan||=performance.now()-T)}}else if("ReplaceBlock"===_){const t={fileURL:e,fileName:r,importType:_,block:{id:F,spaceId:k.spaceId},flowId:h,importId:N,spaceId:k.spaceId,userTimeZone:R,signedToken:n,importEntryPoint:I};J().mM(o,{import_source:"genericImporter"===y?"universal":y,data:t,flowId:h}),J().Pd(o,{import_source:"genericImporter"===y?"universal":y,flowId:h});const a=i().default.checkGate({gateName:"partitioned_universal_importer"}),s={fileURL:e,fileName:r,importType:"ReplaceBlock",spaceId:k.spaceId,rootId:F,userTimeZone:R,signedToken:n,importId:N},l="genericImporter"===y&&a?ee().UT(o,j,s,{spaceIds:[]}):ee().UT(o,b().V,t,{spaceIds:[k.spaceId]});let c=!1;for await(const e of l){if(e.error)throw e.error;V&&"csv"===y&&"status"in e.value&&"created_collection"===e.value.status.message&&(c||(c=!0,oe().V(),q().A.reset(),x.importingSpinnerSpan||=performance.now()-T))}}B++,V&&"csv"===y||oe().m({message:v?le.importingOneFile:le.importingMultipleFilesInProgress,interpolatedValues:{numberOfImportedFiles:B,totalNumberOfFiles:t.length}})}return oe().V(),x.overallTimeTaken=performance.now()-S,function(e,t){const{uploadType:o,importType:i,importLatencies:n,fileNames:a}=t;if(("ReplaceBlock"===i||"AppendToBlock"===i)&&"csv"===o){const e=n.uploadTimeTaken,t=n.importingSpinnerSpan,o=t&&e?t+e:n.overallTimeTaken;n.firstTimeNavigateToCollection=o}c().log({level:"info",from:"importActions",type:"importFiles",data:{miscDataToConvertToString:{fileNames:a,importLatencies:n,uploadType:o,importType:i},message:"Finished importing file"}});for(const[s,l]of Object.entries(n))(0,r().u)({environment:e,event:{eventName:"import_file_finished",eventProperties:{importUploadType:o,importType:i,importLatency:l,importSource:"file",importLatencyType:s,importFileCount:a.length}}})}(o,{uploadType:y,importType:_,importLatencies:x,fileNames:t.map((e=>e.name))}),G().B.createChildStore(s,{table:g().ev,id:F})}catch(T){var x,C;let e;c().log({level:"error",from:"importFiles",type:"importFilesFailure",error:(0,S().convertErrorToLog)(T),data:{spaceId:s.id}}),oe().V(),ae().createAndCommit({userAction:"importActions.importFiles",environment:o,canUndo:!0,perform:e=>{w&&te().TF({parentStore:s.getPagesStore(),childToRemoveStore:w,transaction:e})}});let t=null,r=null;if(T instanceof p().mv&&T.clientData?(t=T.clientData,B[T.clientData.type]&&"ImportFileSizeTooLargeError"===(0,v().A)(T).message?r=B[T.clientData.type]:V().m[T.clientData.type]&&"CsvImportError"===(0,v().A)(T).message?r=V().m[T.clientData.type]:E[T.clientData.type]?r=E[T.clientData.type]:R()._[T.clientData.type]&&(r=R()._[T.clientData.type])):T instanceof p().ic&&"upload_file_size_exceeded"===(null===(x=T.body)||void 0===x||null===(x=x.clientData)||void 0===x?void 0:x.type)&&E[T.body.clientData.type]?(t=T.body.clientData,r=E[t.type]):T instanceof N().C?(t={messageValues:{error:"You've reached the maximum number of file uploads for a 12-hour period. We suggest uploading a ZIP file that includes all your files."}},r=le.importFailedWithError):T instanceof p().yI&&"upload_file_size_exceeded"===(null===(C=T.body)||void 0===C||null===(C=C.clientData)||void 0===C?void 0:C.type)&&(t=T.body.clientData,r=R()._[T.body.clientData.type]),t&&r){const o="messageValues"in t?t.messageValues:void 0;e=L().A.formatMessage(r,o)}else e=t&&"code"in t&&("fileImportError"===t.code||"confluenceImportError"===t.code)?L().A.formatMessage(le.importFailedWithError,{error:(0,v().A)(T).message}):"ImportFileSizeTooLargeError"===(0,v().A)(T).message?L().A.formatMessage(le.fileImportFailedSizeTooLarge):"ImportcsvTooManyColumns"===(0,v().A)(T).message?L().A.formatMessage(le.csvImportFailedColumnsTooLarge):"ImportcsvTooManyRows"===(0,v().A)(T).message?L().A.formatMessage(le.csvImportFailedRowsTooLarge):"ImportxlsxTooManyColumns"===(0,v().A)(T).message?L().A.formatMessage(le.xlsxImportFailedColumnsTooLarge):"ImportxlsxTooManyRows"===(0,v().A)(T).message?L().A.formatMessage(le.xlsxImportFailedRowsTooLarge):L().A.formatMessage(le.importFailed);throw Q().f1(e),T}}async function me(e,t,o,r,i,a,s,c,d){var p;let m,u,f,g=t.id;if(Z().default.isSidePeekOpen()&&Z().default.peekTargetStore.state&&d)u=Z().default.peekTargetStore.state.id,f="AppendToBlock";else if(Z().default.isSidePeekOpen()&&null!==(p=Z().default.peekTargetStore.state)&&void 0!==p&&p.isEmptyPage())u=Z().default.peekTargetStore.state.id,f="ReplaceBlock";else if(s&&(s.isEmptyPage()||d))i>1||s.isInsideCollection()||d?(u=s.id,f="AppendToBlock"):(u=s.id,f="ReplaceBlock");else{const s={date:(0,l().W_)(Date.now(),"medium",n().locale)};"genericImporter"===r&&(s.fileName=a?a.replace(".zip",""):"Universal File");const{performResult:d}=ae().createAndCommit({userAction:"importActions.result",environment:e,canUndo:!0,perform:n=>{const a=L().A.formatMessage("genericImporter"===r?le.importTitleForGenericFileImporter:le.importTitle,s),l=ne().IT({environment:e,spaceStore:t,spaceViewStore:o,parent:c?"none":"private",prepend:!c,title:a,transaction:n}),d=i>1?"AppendToBlock":"ReplaceBlock",p=w().yX();return n.postSubmitCallbacks.push((e=>{e?p.reject(e):p.resolve(void 0)})),{deferred:p,createdPage:l,pageId:l.id,importType:d,spaceId:l.getSpaceId()}}});m=d.createdPage,u=d.pageId,f=d.importType,g=d.spaceId,await d.deferred.promise}return{createdPage:m,pageId:u,importType:f,spaceId:g}}async function ue(e){const{environment:t,fileId:o,token:r,spaceStore:i,spaceViewStore:n,pageStore:a,analyticsFrom:s,flowId:l}=e;let c;try{oe().m({message:le.importingOneFile});const e="link_paste"===s||"slash_command"===s,d=await me(t,i,n,"googleDocs",1,void 0,a,void 0,e);c=d.createdPage;const p=d.importType,m=d.pageId,u={fileId:o,tokenId:r.id,importType:p,block:{id:m,spaceId:i.id},flowId:l,importId:H().R.getOrCreateImportId()};J().mM(t,{import_source:"googleDocs",data:u,flowId:l}),J().Pd(t,{import_source:"googleDocs",flowId:l});const{value:f}=await ee().UT(t,T,u,{spaceIds:[]}).next();if(f.error)throw f.error;return oe().V(),G().B.createChildStore(i,{table:g().ev,id:m})}catch(d){ae().createAndCommit({userAction:"importActions.importFiles",environment:t,canUndo:!0,perform:e=>{c&&te().TF({parentStore:i.getPagesStore(),childToRemoveStore:c,transaction:e})}});let e=L().A.formatMessage(le.importFailed);throw d instanceof p().mv&&d.clientData&&("only_docx_extension_supported"===d.clientData.type?e=L().A.formatMessage(le.onlyDocxExtensionSupported):"file_size_exceeded"===d.clientData.type&&(e=L().A.formatMessage(le.fileImportFailedCustomSizeTooLarge,{maxSize:d.clientData.messageValues.maxSize}))),Q().f1(e),oe().V(),new Error((0,v().A)(d).message)}}function fe(e){const{environment:t,spaceStore:o,spaceViewStore:r,append:i,mondayV2:a}=e,{performResult:s}=ae().createAndCommit({userAction:"importActions.result",environment:t,canUndo:!0,perform:e=>{const s=a?L().A.formatMessage(le.importTitleForMondayV2,{date:(0,l().W_)(Date.now(),"medium",n().locale)}):L().A.formatMessage(le.importTitle,{date:(0,l().W_)(Date.now(),"medium",n().locale)}),c=ne().IT({environment:t,spaceStore:o,spaceViewStore:r,parent:"private",prepend:!i,title:a?s:`${s} Logs`,transaction:e}),d=w().yX();return e.postSubmitCallbacks.push((e=>{e?d.reject(e):d.resolve(void 0)})),{deferred:d,pageId:c.id}}});return s}async function ge(e){const{environment:t,boards:o,spaceStore:r,spaceViewStore:i,flowId:n}=e;oe().m({message:le.importingFromTrelloMessage,interpolatedValues:{importingCount:o.length}}),K().A.setState({open:!1});const{performResult:{deferred:a,pages:s}}=ae().createAndCommit({userAction:"importActions.importTrello",environment:t,canUndo:!0,perform:e=>{const n=o.map((o=>ne().IT({environment:t,spaceStore:r,spaceViewStore:i,parent:"private",prepend:!0,loading:!0,title:o.name,transaction:e}))),a=w().yX();return e.postSubmitCallbacks.push((e=>{e?a.reject(e):a.resolve(void 0)})),{deferred:a,pages:n}}});await a.promise;try{return await Promise.all(s.map((async(e,r)=>{const i=o[r],{value:a}=await ee().UT(t,A,{boardId:i.id,block:{id:e.id,spaceId:(0,y().e)(e.pointer.spaceId)},importId:H().R.getOrCreateImportId(),flowId:n},{spaceIds:e.pointer.spaceId?[e.pointer.spaceId]:[]}).next();if(a.error)throw a.error}))),oe().V(),s[0]}catch(l){ae().createAndCommit({userAction:"importActions.importTrello",environment:t,canUndo:!0,perform:e=>{for(const t of s)te().TF({parentStore:r.getPagesStore(),childToRemoveStore:t,transaction:e})}});let e=L().A.formatMessage(le.trelloImportFailed);const o=l instanceof p().lV?l.body.clientData:void 0;throw o&&"code"in o&&"trelloImportError"===o.code&&(e=L().A.formatMessage(le.importFailedWithError,{error:(0,v().A)(l).message})),Q().f1(e),oe().V(),new Error((0,v().A)(l).message)}}async function ye(e){const{environment:t,spaceStore:o,spaceViewStore:r,notebooks:i,userSettingsStore:n,flowId:a}=e;if(0===i.length)throw new Error("Expected at least one notebook");oe().m({message:le.importingFromEvernoteMessage,interpolatedValues:{importingCount:i.length}}),Y().A.setState({open:!1});const l=await async function(e){const{environment:t,spaceStore:o,spaceViewStore:r,notebooks:i}=e,{serverCommitResult:n,performResult:{blockStores:a}}=ae().createAndCommit({userAction:"importActions.createStacks",environment:t,canUndo:!0,perform:e=>{const n=I().sb(I().oE(i.map((e=>e.stack)))).sort().reverse(),a={};let l=e=>!0;return i.length>1&&n.length>0&&(n.forEach((n=>{const l=ne().IT({environment:t,spaceStore:o,spaceViewStore:r,parent:"private",prepend:!0,loading:!1,title:n,transaction:e}),c=l.getContentStore();i.filter((e=>e.stack===n)).forEach((o=>{const r=re().Wv({environment:t,type:s().xd.copyIndicator,inMemoryRecordCache:l.inMemoryRecordCache,transaction:e,spaceId:c.pointer.spaceId});te().BC({parentStore:c,appendStore:r,transaction:e}),a[o.guid]=r}))})),l=e=>!Boolean(e.stack)),i.filter(l).reverse().forEach((i=>{const n=ne().IT({environment:t,spaceStore:o,spaceViewStore:r,parent:"private",prepend:!0,loading:!0,title:i.title,transaction:e});a[i.guid]=n})),{blockStores:a}}});return await n,a}({environment:t,spaceStore:o,spaceViewStore:r,notebooks:i}),c=l[i[0].guid];try{return await async function(e){const{environment:t,spaceStore:o,spaceViewStore:r,notebooks:i,waitForNotebookStore:n,notebookMapping:a,userSettingsStore:s,flowId:l}=e;let c;if(w().vA(i,Ie,(async e=>{await Promise.all(e.map((async e=>{const o=a[e.guid];if(!o)throw new Error(`Missing notebook page ${e.guid}`);const r=w().yX();o===n&&(c=r),await async function(e){const{environment:t,notebookStore:o,notebook:r,firstCompleted:i,flowId:n}=e,a=ee().UT(t,x().r,{notebookId:r.guid,block:{id:o.id,spaceId:(0,y().e)(o.pointer.spaceId)},timestamp:Date.now(),parentTable:g().ev,importId:H().R.getOrCreateImportId(),flowId:n},{spaceIds:[o.getSpaceId()]}),{value:s}=await a.next();if(s.error){console.error(s.error),ae().createAndCommit({userAction:"importActions.importEvernoteNotebook",environment:t,canUndo:!0,perform:e=>{const t=o.getParentBlockStore();if(t){const r=t.getContentStore();te().TF({parentStore:r,childToRemoveStore:o,transaction:e})}}});let e=L().A.formatMessage(le.evernoteImportFailed);const r=s.error instanceof p().Df?s.error.body.clientData:void 0;r&&"code"in r&&"evernoteImportError"===r.code&&(e=L().A.formatMessage(le.importFailedWithError,{error:(0,v().A)(s.error).message})),Q().f1(e),i.resolve(void 0)}i.resolve(void 0)}({environment:t,notebookStore:o,notebook:e,firstCompleted:r,flowId:l})})))})),!c)throw new Error("waitForNotebookFirstCompleted not defined.");const d=s.getSettings();if(null==d||!d.created_evernote_getting_started){const e=(0,W().nH)("evernote");await(0,U().U)({environment:t,spaceStore:o,spaceViewStore:r,userSettingsStore:s,template:e})}await c.promise}({environment:t,waitForNotebookStore:c,notebookMapping:l,notebooks:i,spaceStore:o,spaceViewStore:r,userSettingsStore:n,flowId:a}),oe().V(),c}catch(d){throw oe().V(),Q().f1(L().A.formatMessage(le.evernoteImportFailed)),d}}async function he(e){const{environment:t,spaceStore:o,spaceViewStore:r,space:i,flowId:n}=e;if(!t.currentUser.id)throw new Error("User does not exist.");oe().m({message:le.importingFromConfluenceViaAPIMessage,interpolatedValues:{confluenceSpaceKey:i.name}}),$().A.setState({open:!1});const a=fe({environment:t,spaceStore:o,spaceViewStore:r});await a.deferred.promise;const s=a.pageId;let l;if((0,P().vY)(t)){const e=await X().callApi({eventName:"createTeam",environment:t,data:{spaceId:o.id,name:i.name,accessLevel:"closed"}});if("failed"===e.type)throw new Error("Cannot create teamspace");l=e.data.teamId}const{performResult:d}=ae().createAndCommit({userAction:"importActions.importConfluenceViaApi",environment:t,canUndo:!0,perform:e=>{const n=L().A.formatMessage(le.importTitleWithImportName,{name:i.name}),a=ne().IT({environment:t,spaceStore:o,spaceViewStore:r,parent:"private",prepend:!0,title:n,transaction:e}),s=w().yX();return e.postSubmitCallbacks.push((e=>{e?s.reject(e):s.resolve(void 0)})),{deferred:s,createdPage:a,pageId:a.id}}});await d.deferred.promise;const m=d.createdPage;try{if(!m)throw new Error("No root page");J().Pd(t,{import_source:"confluence",flowId:n});const e=(0,P().u4)(t,o)?F:_,r=ee().UT(t,e,{userId:t.currentUser.id,confluenceSpaceKey:i.key,confluenceSpaceId:i.id,confluenceSpaceName:i.name,page:{id:d.pageId,spaceId:o.id},loggerPageId:s,flowId:n,teamId:l,importId:H().R.getOrCreateImportId()},{spaceIds:[o.id]});for await(const t of r){if(t.error)throw t.error;t.value.isComplete||oe().m(t.value.status)}return oe().V(),m}catch(u){c().log({level:"error",from:"importConfluenceViaAPI",type:"importConfluenceViaAPIFailure",error:(0,S().convertErrorToLog)(u),data:{spaceId:o.id}}),ae().createAndCommit({userAction:"importActions.importConfluenceViaApi",environment:t,canUndo:!0,perform:e=>{m&&te().TF({parentStore:o.getPagesStore(),childToRemoveStore:m,transaction:e})}});let e=L().A.formatMessage(le.confluenceImportViaAPIFailed);const r=u instanceof p().ic?u.body.clientData:void 0;throw r&&"code"in r&&"confluenceImportError"===r.code&&(e=L().A.formatMessage(le.importFailedWithError,{error:(0,v().A)(u).message})),Q().f1(e),oe().V(),new Error((0,v().A)(u).message)}}async function ve(e){const{environment:t,spaceStore:o,spaceViewStore:r,spaces:i,flowId:a}=e;if(!t.currentUser.id)throw new Error("User does not exist.");oe().m({message:le.importingFromConfluenceViaAPIMessage,interpolatedValues:{confluenceSpaceKey:`${i.length} spaces`}}),$().A.setState({open:!1});const{performResult:s}=ae().createAndCommit({userAction:"importActions.importMultiSpaceConfluenceViaAPI",environment:t,canUndo:!0,perform:e=>{const i=`Confluence Spaces Import Log - ${(0,l().W_)(Date.now(),"medium",n().locale)}`,a=ne().IT({environment:t,spaceStore:o,spaceViewStore:r,parent:"private",prepend:!0,title:i,transaction:e}),s=w().yX();return e.postSubmitCallbacks.push((e=>{e?s.reject(e):s.resolve(void 0)})),{deferred:s,createdPage:a,pageId:a.id}}});await s.deferred.promise;const d=s.createdPage;try{J().Pd(t,{import_source:"confluence",import_sub_type:"multispace",flowId:a});const e=i.map((e=>({confluenceSpaceId:e.id,confluenceSpaceKey:e.key,confluenceSpaceName:e.name,targetTeamSpaceId:e.targetTeamSpaceId}))),r=ee().UT(t,k().k,{userId:t.currentUser.id,spaceConfigs:e,page:{id:void 0,spaceId:o.id},loggerPageId:s.pageId,flowId:a,importId:H().R.getOrCreateImportId()},{spaceIds:[o.id]});for await(const t of r){if(t.error)throw t.error;t.value.isComplete||oe().m(t.value.status)}return oe().V(),d}catch(p){ae().createAndCommit({userAction:"importActions.importMultiSpaceConfluenceViaAPI",environment:t,canUndo:!0,perform:e=>{d&&te().TF({parentStore:o.getPagesStore(),childToRemoveStore:d,transaction:e})}}),c().log({type:"error",level:"error",from:"importMultiSpaceConfluenceViaAPI",error:(0,S().convertErrorToLog)(p)});let e=L().A.formatMessage(le.importFailed);throw"object"==typeof p&&null!==p&&"message"in p&&(e=L().A.formatMessage(le.importFailedWithError,{error:(0,v().A)(p).message})),Q().rG({message:e}),oe().V(),new Error((0,v().A)(p).message)}}const Ie=2},214437:(e,t,o)=>{o.d(t,{A:()=>r});const r=new(o(463830).A)},290913:(e,t,o)=>{o.d(t,{k:()=>i,w:()=>r});const r=10,i=(0,o(583835).Dv)("multiSpaceConfluenceImportViaApi")},296402:(e,t,o)=>{o.r(t),o.d(t,{CsvImportModal:()=>It});var r=o(296540),i=()=>o(56366),n=()=>o(699143),a=()=>o(534177),s=()=>o(107683),l=()=>o(765957),c=()=>o(398391),d=(o(16280),o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(672577),o(430670),o(803949),o(581454),o(737550),()=>o(484714)),p=()=>o(401497),m=()=>o(757695),u=()=>o(98126),f=()=>o(406094),g=()=>o(631524),y=()=>o(160432),h=()=>o(493552),v=()=>o(584262),I=()=>o(898244),S=()=>o(258035),w=()=>o(165358),x=()=>o(416504),b=()=>o(187174),C=()=>o(52404),T=()=>o(940563),A=()=>o(754199),k=()=>o(179034),M=()=>o(519831),_=()=>o(869558),F=()=>o(69708),j=()=>o(319625),P=()=>o(229833),E=()=>o(498212),V=()=>o(183558),B=()=>o(284371);const R=(0,o(583835).Dv)("importCSVPartial");var z=()=>o(609316),D=()=>o(559926),N=()=>o(362441),O=()=>o(357625),L=()=>o(180328),U=()=>o(722101),W=()=>o(44729),H=()=>o(384944),$=()=>o(564746),Y=()=>o(231297),K=()=>o(147503),Z=()=>o(58415),G=()=>o(581369),q=()=>o(586481),J=()=>o(73848),X=()=>o(672616),Q=()=>o(492414),ee=()=>o(390181),te=()=>o(522094),oe=()=>o(148832),re=()=>o(543665),ie=()=>o(913530),ne=()=>o(404141),ae=()=>o(712341),se=()=>o(609819),le=()=>o(21140),ce=()=>o(611648),de=()=>o(252291),pe=()=>o(566910),me=()=>o(421559),ue=()=>o(106065),fe=()=>o(2143),ge=()=>o(125565),ye=()=>o(106412),he=o(474848);const ve=36;function Ie({previewCollection:e,onSetCollectionContextStore:t,validationState:o}){const a=(0,i().O$)(c().f),s=(0,r.useMemo)((()=>({location:"csv_import",isPreviewing:!0,disableHeaderPointerEvents:!0,disableEditsAndConfiguration:!0,disableContentPointerEvents:!0,disablePageLinks:!0,hideAggregation:!0,hideViewBlockSource:!0,enableHorizontalScroll:!1})),[]),l=(0,r.useCallback)((e=>{t&&t(e)}),[t]),d=(0,p().IS)((e=>({container:{position:"relative",backgroundColor:e.background.primary,height:"100%",paddingTop:ve,overflowY:"auto",borderRadius:12,border:`1px solid ${e.border.primary}`},titleWrapper:{display:"flex",alignItems:"center",paddingInlineStart:ve,marginTop:4,marginInlineEnd:0,marginBottom:12,marginInlineStart:0,gap:12},titleText:{fontSize:20,fontWeight:600,lineHeight:"26px",whiteSpace:"pre-line",marginInlineStart:0},previewScroller:{height:"100%",paddingBottom:ve-8},errorPreview:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"calc(100% - 60px)",color:e.text.secondary,fontSize:16,gap:9},errorMessage:{textAlign:"center",maxWidth:"80%",color:e.text.secondary},errorTitle:{color:e.text.secondary,textAlign:"center",fontSize:14,fontWeight:B().Wy.medium,lineHeight:"20px"}})),[]);return a.open?o?(0,he.jsx)(n().Y1,{height:"fill",style:d.container,children:(0,he.jsxs)(le().wt,{style:d.errorPreview,children:[(0,he.jsx)(de().I,{icon:pe().e,size:"xl",colorPalette:"gray",colorVariant:"disabled"}),(0,he.jsx)(ge().A,{style:d.errorTitle,children:(0,he.jsx)(F().sA,{id:"csv-import-preview.error.title",defaultMessage:"Preview Unavailable"})}),(0,he.jsx)(ge().A,{style:d.errorMessage,children:o.multipleTitle?(0,he.jsx)(F().sA,{id:"csv-import-preview.error.multipleTitle",defaultMessage:"You can only have one Title property."}):o.noTitle?(0,he.jsx)(F().sA,{id:"csv-import-preview.error.noTitle",defaultMessage:"At least one column must be set as a Title property."}):(0,he.jsx)(F().sA,{id:"csv-import-preview.error.invalidPropertyConfiguration",defaultMessage:"Invalid property configuration. Please check your column mappings."})})]})}):e?(0,he.jsxs)(n().Y1,{height:"fill",style:d.container,children:[(0,he.jsxs)("div",{style:d.titleWrapper,children:[(0,he.jsx)(de().I,{icon:me().T,size:"xl",colorVariant:"primary"}),(0,he.jsx)(ge().A,{style:d.titleText,children:a.fileName.replace(/\.csv$/i,"")||"Preview"})]}),(0,he.jsx)(fe().H,{type:ce().A.All,style:d.previewScroller,children:(0,he.jsx)(ye().tx,{value:s,children:(0,he.jsx)(ue().dN,{store:e.collectionViewBlockStore,disabled:!0,forceLocalQueryCollection:!0,headerActionsBehavior:"hidden",overridePaddingLeft:ve,overridePaddingRight:ve,setCollectionContextStore:l,productUseCase:"preview_collection"})})})]}):(0,he.jsx)(n().Y1,{height:"fill",style:d.container,children:(0,he.jsxs)("div",{style:d.titleWrapper,children:[(0,he.jsx)(de().I,{icon:me().T,size:"xl",colorVariant:"primary"}),(0,he.jsx)(ge().A,{style:d.titleText,children:a.fileName.replace(/\.csv$/i,"")||"Preview"})]})}):null}o(823215);var Se=()=>o(688742),we=()=>o(342),xe=()=>o(507807);function be(e,t,o,r){if(!e||!t)return[];const i=t.findIndex((e=>e===o));if(void 0===i||-1===i||0===e.length)return[];const n=e.map((e=>e[i])).filter((e=>"string"==typeof e&&""!==e));return("multi_select"===r?Array.from(new Set(n.flatMap((e=>e.split(","))).map((e=>e.trim())).filter((e=>""!==e)))):Array.from(new Set(n.map((e=>e.trim())).filter((e=>""!==e))))).map((e=>({id:(0,V().Ay)(),value:e,color:(0,I().Zd)([])})))}function Ce(){const e=(0,d().v3)(),t=(0,i().O$)(c().f),[o,n]=(0,r.useState)(void 0),a=(0,xe().S)(we().o8,{canUndo:!0}),s=(0,r.useRef)(void 0),p=(0,r.useRef)(void 0),[m,u]=(0,r.useState)(void 0),f=(0,r.useRef)([]),g=(0,r.useRef)(!1),[y,h]=(0,r.useState)(void 0),v=(0,r.useCallback)(((e=[])=>{const t=f.current.find((e=>"title"===e.propertyType)),o=e.find((e=>"title"===e.propertyType));return(null==t?void 0:t.headerName)!==(null==o?void 0:o.headerName)||t&&e.find((e=>e.headerName===t.headerName&&"dont_import"===e.propertyType))}),[]),I=(0,r.useCallback)((()=>{s.current=void 0,g.current=!1,u(void 0),a.reset(),c().f.setPreviewCollectionInfo(void 0)}),[a]);return(0,r.useEffect)((()=>{if(!t.open)return void h(void 0);const o=t;if("merge"!==o.importType||!o.importLocation||!o.spaceId)return void h(void 0);let r=!1;return(async()=>{try{const t=new(re().m)(e,{id:o.importLocation,spaceId:o.spaceId,table:M().Vl});if(await t.load(),!r){const e=t.getSchema(),o={};for(const[t,r]of Object.entries(e))r&&(o[t]=r);h(o)}}catch(t){r||h(void 0)}})(),()=>{r=!0}}),[t,e]),(0,r.useEffect)((()=>{if(!t.open||!t.csvHeaders||!t.csvSampleRows||0===t.csvHeaders.length)return;const o=t.userPropertyMapping||[],r=o.filter((e=>"title"===e.propertyType)),i=0===r.length,d=r.length>1;if(i&&"merge"!==t.importType||d)return n({noTitle:"merge"!==t.importType&&i,multipleTitle:d}),void I();n(void 0);const m=v(o),h="merge"===t.importType&&Boolean(y),S=h&&!g.current,w=t.userPropertyMapping||[];let x=!1;const b=p.current;if(b)if(w.length!==b.length)x=!0;else for(const e of w){const t=b.find((t=>t.headerName===e.headerName));if(!t){x=!0;break}const o="dont_import"===t.propertyType,r="dont_import"===e.propertyType;if(t.propertyId!==e.propertyId||o!==r){x=!0;break}}f.current=[...o];const C=!s.current||m||S||x;if(t.csvHeaders.every((e=>{const t=o.find((t=>t.headerName===e));return"dont_import"===(null==t?void 0:t.propertyType)})))return void I();if(s.current&&!C)return;C&&s.current&&I();const{performResult:T}=Y().createAndCommit({userAction:"csvImport.previewCollection",environment:e,perform:o=>{const r=H().Wv({environment:e,type:"collection_view_page",inMemoryRecordCache:a.cache,transaction:o}),i=l().default.state.sidebarSpaceStore;if(!i)throw new Error("No current space store");const n=i.id,{parentId:s,parentTable:c}=t,d=s||n,p=c||"space";let m;H().zv({store:r,data:{parent_id:d,parent_table:p,space_id:n,alive:!0},transaction:o});const u=t.userPropertyMapping||[];if("merge"===t.importType&&y){var f;m={};const e=new Set,o=t=>{if(!e.has(t)){const o=y[t];o&&(m[t]=o,e.add(t))}};null===(f=t.csvHeaders)||void 0===f||f.forEach((r=>{const i=u.find((e=>e.headerName===r));if("dont_import"===(null==i?void 0:i.propertyType))return;if(null!=i&&i.propertyId&&y[i.propertyId])return void o(i.propertyId);const n=Object.entries(y).find((([e,t])=>(null==t?void 0:t.name)===r));if(n)return void o(n[0]);const a=(null==i?void 0:i.propertyType)||"text",s=(0,V().Ay)(),l="select"===a||"multi_select"===a?{name:r,type:a,options:be(t.csvSampleRows,t.csvHeaders,r,a)}:{name:r,type:a};m[s]=l,e.add(s)})),Object.keys(y).forEach((e=>{o(e)}))}else{var g;m={};const e=u.find((e=>"title"===e.propertyType));let o=null==e?void 0:e.headerName;!o&&t.csvHeaders&&t.csvHeaders.length>0&&(o=t.csvHeaders[0]),m.title={name:o||"Title",type:"title"},null===(g=t.csvHeaders)||void 0===g||g.forEach((e=>{if(e===o)return;const r=u.find((t=>t.headerName===e)),i=(null==r?void 0:r.propertyType)||"text";if("dont_import"===i)return;const n=(0,V().Ay)();let a;switch(i){case"select":case"multi_select":a={name:e,type:i,options:be(t.csvSampleRows,t.csvHeaders,e,i)};break;case"checkbox":case"number":case"date":case"email":case"phone_number":case"url":case"person":a={name:e,type:i};break;default:a={name:e,type:"text"}}m[n]=a}))}const h=(0,Z().E)({environment:e,collectionViewBlockStore:r,transaction:o,collectionValue:{name:[["CSV Preview"]],schema:m}}),v=(0,E().Ay)(),I=ie().p.createChildStore(r,{table:_().Gy,id:v});H().zv({store:I,data:{id:v,version:1,type:"table",name:"Table view",format:{table_wrap:!0,table_properties:Object.entries(m).map((([e,t])=>({property:e,visible:!0,width:250}))),collection_pointer:{id:h.id,table:M().Vl,spaceId:n}},parent_id:r.id,parent_table:"block",space_id:n,alive:!0,query2:{aggregations:[],sort:[],filter:{operator:"and",filters:[]}}},transaction:o}),U().BC({parentStore:r.getCollectionViewsStore(),appendStore:I,transaction:o});const S=[];if(new(Se().B)(e).setContext({type:"collectionView",collectionViewBlockStore:r,collectionStore:h,collectionViewStore:I,pageVisitSourceOverride:void 0}),t.csvSampleRows&&t.csvSampleRows.length>0){t.csvSampleRows.slice(0,5).forEach(((r,i)=>{const s=(0,E().Ay)();S.push(s);const l=new(oe().B)(e,{table:k().ev,id:s},{inMemoryRecordCache:a.cache}),c=function(e,t,o,r){const i={},n=new Map;return r.forEach((e=>{n.set(e.headerName,{propertyId:e.propertyId})})),o.forEach(((o,r)=>{if(r>=t.length)return;const a=t[r];if(!a||""===a.trim())return;let s,l;const c=n.get(o);if(null!=c&&c.propertyId&&e[c.propertyId])s=c.propertyId,l=e[s];else{const t=Object.entries(e).find((([e,t])=>t.name===o));t&&(s=t[0],l=t[1])}if(s&&l)try{switch(l.type){case"title":case"text":case"date":default:i[s]=[[a]];break;case"number":const e=parseFloat(a);i[s]=isNaN(e)?[[a]]:[[e.toString()]];break;case"select":{const e=a.trim();i[s]=[[e]];break}case"multi_select":{const e=a.split(",").map((e=>e.trim())).filter((e=>""!==e));e.length>0&&(i[s]=e.map((e=>[e])));break}case"checkbox":const t=a.toLowerCase().trim(),o="true"===t||"yes"===t||"1"===t||"✓"===t||"checked"===t;i[s]=o?[["Yes"]]:[["No"]];break;case"url":let r=a.trim();r&&!r.match(/^[a-zA-Z]+:\/\//)&&(r=`https://${r}`),i[s]=[[r]];break;case"email":case"phone_number":case"person":i[s]=[[a.trim()]]}}catch(d){i[s]=[[a]]}})),i}(m,r,t.csvHeaders||[],t.userPropertyMapping||[]);H().zv({store:l,data:{id:s,version:1,type:"page",parent_id:h.id,parent_table:"collection",space_id:n,alive:!0},transaction:o}),c&&Object.keys(c).length>0&&(0,q().L)({environment:e,store:l,properties:c,transaction:o}),W().X$({parentStore:h,childStore:l,transaction:o})}))}return{collectionStore:h,collectionViewBlockStore:r,collectionViewStore:I}},canUndo:!0});T&&(s.current=T,g.current=h,u(T),c().f.setPreviewCollectionInfo(T),p.current=JSON.parse(JSON.stringify(w)))}),[t,e,a,I,v,y]),{previewCollection:m,validationState:o}}var Te=()=>o(852424),Ae=()=>o(597777),ke=()=>o(340498),Me=()=>o(406699),_e=()=>o(722872),Fe=()=>o(760217),je=()=>o(419357),Pe=()=>o(404277),Ee=()=>o(939740),Ve=()=>o(89924),Be=()=>o(662971);const Re=(0,F().YK)({searchPlaceholder:{id:"csvImport.mapFieldsStep.searchPlaceholder",defaultMessage:"Search property types..."},titleBadge:{id:"csvImport.mapFieldsStep.titleBadge",defaultMessage:"Title"},existingPropertyHeader:{id:"csvImport.mapFieldsStep.existingPropertyHeader",defaultMessage:"Existing property"}});function ze(e,t){const o=t.find((t=>t.type===e&&!t.isExistingProperty));return(null==o?void 0:o.name)||"Text"}const De=r.memo((function({index:e,header:t,selectedType:i,selectedPropertyId:n,inferredType:a,onSelectType:s,allPropertyTypes:l=S().Pl,isMergeFlow:c,selectedFormat:d}){const m=(0,p().DP)(),u=(0,F().tz)(),f=(()=>{if(n){const e=l.find((e=>e.propertyId===n&&e.isExistingProperty));if(e)return e.name}const e=i?ze(i,l):a?ze(a,l):"Don't import";if(("date"===i||!i&&"date"===a)&&d){return`${e} • ${u.formatMessage(Ae().xz[d])}`}return e})(),[y,h]=(0,r.useState)(""),v=(0,r.useMemo)((()=>y?l.filter((({name:e})=>e.toLowerCase().includes(y.toLowerCase()))):l),[l,y]);function I(){if("dont_import"===i)return(0,he.jsx)(de().I,{icon:pe().e,size:16,colorVariant:"tertiary"});if(n){const e=l.find((e=>e.propertyId===n&&e.isExistingProperty));if(e)return"dont_import"===e.type?(0,he.jsx)(de().I,{icon:pe().e,size:16,colorVariant:"tertiary"}):(0,he.jsx)(Te().zB,{type:e.type,size:ke().Ev.sm,icon:void 0,theme:m})}return(0,he.jsx)(Te().zB,{type:i||a||"text",size:ke().Ev.sm,icon:void 0,theme:m})}return(0,he.jsx)(Me().A,{popupType:Me().z.Popup,placementToOrigin:"right",renderOrigin:e=>(0,he.jsxs)(g().p,{...e,style:{width:"100%",padding:"2px 6px",border:`1px solid ${m.border.primary}`,borderRadius:4,justifyContent:"space-between",height:32,background:m.background.elevated},children:[(0,he.jsxs)(le().Ye,{style:{gap:8,flex:1,overflow:"hidden"},children:[I(),(0,he.jsx)("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"dont_import"===i?m.text.tertiary:void 0},children:f})]}),(0,o(324254).arrowChevronSingleDownSmallIcon)({width:12,height:12,fill:m.icon.secondary})]}),render:t=>{const r={menuType:_e().gu.Popup,width:240},l=v.find((e=>"dont_import"===e.type&&!e.isExistingProperty)),d=v.filter((e=>!(e.isExistingProperty||"dont_import"===e.type||!c&&"status"===e.type||!c&&"person"===e.type||c&&"title"===e.type))).map((({type:o,name:r})=>({key:o,action:()=>{"date"!==o&&(s(e,r),t.close())},render:l=>"date"===o?(0,he.jsx)(Be().A,{...l,renderOrigin:(e,t)=>(0,he.jsx)(Fe().A,{...e,ref:t,title:r,icon:(0,he.jsx)(Te().zB,{type:o,size:ke().Ev.sm,icon:void 0,theme:m}),isChecked:!n&&(i===o||!i&&a===o)}),renderExtension:(o,i)=>{const n=Ae().wJ.filter((e=>"relative"!==e)).map((o=>({key:o,action:()=>{s(e,r,void 0,o),i.close(),t.close()},render:e=>(0,he.jsx)(Fe().A,{...e,title:u.formatMessage(Ae().xz[o])})})));return(0,he.jsx)(Pe().A,{menuType:_e().gu.Popup,width:240,...o,children:(0,he.jsx)(Ee().Ay,{type:Ee().Oh.Vertical,initialFocus:0,sections:[{key:"dateFormats",render:e=>(0,he.jsx)(Ve().A,{...e}),items:n}]})})},onFocus:()=>{}}):(0,he.jsx)(Fe().A,{...l,title:r,icon:(0,he.jsx)(Te().zB,{type:o,size:ke().Ev.sm,icon:void 0,theme:m}),isChecked:!n&&(i===o||!i&&a===o)})}))),p=l?{key:"dont_import",action:()=>{s(e,l.name),t.close()},render:e=>(0,he.jsx)(Fe().A,{...e,title:l.name,titleStyle:{color:m.text.primary},icon:(0,he.jsx)(de().I,{icon:pe().e,size:16,colorVariant:"secondary"}),isChecked:!n&&"dont_import"===i})}:null,f=v.filter((e=>e.isExistingProperty&&null!==e)).map((({type:r,name:i,propertyId:a})=>({key:`existing-${a}`,action:()=>{s(e,i,a),t.close()},render:e=>(0,he.jsx)(Fe().A,{...e,title:i,icon:"dont_import"===r?(0,he.jsx)(de().I,{icon:pe().e,size:16,colorVariant:"tertiary"}):(0,he.jsx)(Te().zB,{type:r,size:ke().Ev.sm,icon:void 0,theme:m}),isChecked:n===a,badge:"title"===r?(0,he.jsx)(o(970236).E,{content:u.formatMessage(Re.titleBadge),color:"gray"}):void 0})}))),g=[];if(c){const e=[];p&&e.push(p),e.push(...f),e.length>0&&g.push({key:"existingProperties",render:e=>(0,he.jsx)(Ve().A,{...e,title:u.formatMessage(Re.existingPropertyHeader)}),items:e});const t={key:"add-new-property",action:()=>{},render:e=>(0,he.jsx)(Be().A,{...e,renderOrigin:(e,t)=>(0,he.jsx)(Fe().A,{...e,ref:t,icon:(0,he.jsx)(de().I,{icon:o(617668).plusIcon}),title:"Add new property"}),renderExtension:(e,t)=>{const o=d.map((e=>({...e,action:()=>{e.action(),t.close()}})));return(0,he.jsx)(Pe().A,{menuType:_e().gu.Popup,width:240,...e,children:(0,he.jsx)(Ee().Ay,{type:Ee().Oh.Vertical,initialFocus:0,sections:[{key:"newPropertyTypes",render:e=>(0,he.jsx)(Ve().A,{...e}),items:o}]})})},onFocus:()=>{}})};g.push({key:"addNewPropertySection",render:t=>(0,he.jsx)(Ve().A,{...t,topBorder:e.length>0}),items:[t]})}else{const e=[];p&&e.push(p),e.push(...d),g.push({key:"basePropertyTypes",render:e=>(0,he.jsx)(Ve().A,{...e}),items:e})}return(0,he.jsxs)(Pe().A,{...r,children:[(0,he.jsx)(Ve().A,{shouldShowBottomDivider:!1,children:(0,he.jsx)(je().Ay,{focusInitial:!0,value:y,onChange:e=>h(e.target.value),placeholder:o(972435).A.formatMessage(Re.searchPlaceholder),showClearButton:!0})}),(0,he.jsx)(Ee().Ay,{type:Ee().Oh.Vertical,initialFocus:0,sections:g})]})}})})),Ne=(0,F().YK)({heading:{id:"csvImport.mapFieldsStep.heading",defaultMessage:"Setup CSV columns"},description:{id:"csvImport.mapFieldsStep.description",defaultMessage:"Choose the property type for each column\nin your CSV file"},useFirstRowAsHeaders:{id:"csvImport.mapFieldsStep.useFirstRowAsHeaders",defaultMessage:"Use first row as headers"},importButton:{id:"csvImport.mapFieldsStep.importButton",defaultMessage:"Import CSV"},cancelButton:{id:"csvImport.mapFieldsStep.cancelButton",defaultMessage:"Cancel"}}),Oe=100;function Le(e){const{schema:t,rowData:o,headers:r,userPropertyMapping:i,selectOptionTracker:n,collectionStore:a,transaction:s}=e,l={},c=new Map(i.map((e=>[e.headerName,e])));return r.forEach(((e,r)=>{const i=o[r];if(!i||""===i.trim())return;const d=c.get(e);if("dont_import"===(null==d?void 0:d.propertyType))return;let p,m=null==d?void 0:d.propertyId;if(m&&(p=t[m]),!p){const o=Object.entries(t).find((([,t])=>(null==t?void 0:t.name)===e));o&&(m=o[0],p=o[1])}if(!p&&"title"===(null==d?void 0:d.propertyType)){const e=Object.entries(t).find((([,e])=>"title"===(null==e?void 0:e.type)));e&&(m=e[0],p=e[1])}if(!m||!p)return;const u=i.trim();if(""!==u)switch(p.type){case"multi_select":{const e=u.split(",").map((e=>e.trim())).filter(Boolean);if(0===e.length)break;Ue({propertyId:m,propertySchema:p,optionValues:e,collectionStore:a,selectOptionTracker:n,transaction:s}),l[m]=e.map((e=>[e]));break}case"select":case"status":Ue({propertyId:m,propertySchema:p,optionValues:[u],collectionStore:a,selectOptionTracker:n,transaction:s}),l[m]=[[u]];break;case"checkbox":{const e=u.toLowerCase(),t=new Set(["true","yes","1","✓","checked"]);l[m]=t.has(e)?[["Yes"]]:[["No"]];break}case"number":{const e=Number(u);l[m]=[[Number.isNaN(e)?u:String(e)]];break}case"url":{const e=/^(?:[a-z]+:\/\/)/i.test(u)?u:`https://${u}`;l[m]=[[e]];break}default:l[m]=[[u]]}})),l}function Ue(e){const{propertyId:t,propertySchema:o,optionValues:r,collectionStore:i,selectOptionTracker:n,transaction:a}=e;if(!("options"in o))return;if(!Array.isArray(o.options))return;const s=i.getSchema()[t];if(!s||!("options"in s)||!Array.isArray(s.options))return;const l=s.options,c=n.get(t)??new Set(l.map((e=>e.value))),d=[...l];let p=!1;r.forEach((e=>{const t=e.trim();t&&!c.has(t)&&(d.push({id:(0,V().Ay)(),value:t,color:(0,I().Zd)(d)}),c.add(t),p=!0)})),p&&(Y().applyOperation({store:i,operation:{pointer:i.pointer,path:["schema",t,"options"],command:"set",args:d},transaction:a}),n.set(t,c))}function We(e){const t=(0,i().O$)(c().f),o=(0,d().v3)(),n=(0,r.useMemo)((()=>m().Store.createValue({open:!1,stack:[],closeOnEscape:!0})),[]),[a,s]=(0,r.useState)([]),[l,I]=(0,r.useState)({}),[ce,de]=(0,r.useState)({}),[pe,me]=(0,r.useState)(""),[ue,fe]=(0,r.useState)(!0),[ge,ye]=(0,r.useState)(!1),[ve,Se]=(0,r.useState)(void 0),[we,xe]=(0,r.useState)(void 0),[Te,Ae]=(0,r.useState)(!1),[ke,Me]=(0,r.useState)({}),[_e,Fe]=(0,r.useState)({}),je=(0,r.useRef)(!1),Pe=(0,F().tz)(),Ee=(0,J()._)(),Ve=(0,r.useRef)(!0);(0,r.useEffect)((()=>()=>{Ve.current=!1}),[]);const Be=(0,r.useRef)(void 0),Re=(0,r.useRef)(void 0),{previewCollection:ze,validationState:Ue}=Ce(),{pageStore:We,spaceStore:He,spaceViewStore:$e,analyticsFrom:Ye}=e,Ke=t.open?t:void 0,Ze=null==Ke?void 0:Ke.csvHeaders,Ge=null==Ke?void 0:Ke.csvSampleRows;(0,b().Yb)((async()=>{await(async()=>{if("merge"===(null==Ke?void 0:Ke.importType)&&Ke.importLocation&&Ke.spaceId)try{Ae(!0);const e=new(re().m)(o,{id:Ke.importLocation,spaceId:Ke.spaceId,table:M().Vl});await e.load();const t=e.getSchema();xe(t)}catch(e){me(`Failed to load target collection properties: ${(0,j().A)(e).message}`)}finally{Ae(!1)}})()}),[null==Ke?void 0:Ke.importType,null==Ke?void 0:Ke.importLocation,null==Ke?void 0:Ke.spaceId,o]),(0,r.useEffect)((()=>{if(t.open&&Ze&&!je.current)try{const e=(null==Ke?void 0:Ke.userPropertyMapping)||[];if(void 0!==(null==Ke?void 0:Ke.firstRowAsHeader)&&fe(Ke.firstRowAsHeader),Ze&&Ze.length>0){if(s(Ze),!Ge)return;const t=(0,S().HL)({body:Ge.map((e=>e.map((e=>({text:e}))))),intl:Pe,randomShortID:V().Ay,isPhoneNumber:A().W,useCsvAdaptiveSchema:!1});let o=!1;const r={};Ze.forEach(((e,i)=>{let n=t.types[i].schema.type||"text";o||"text"!==n||(n="title",o=!0),r[e]=n})),de(r);const i={},n={},a={};e.length>0?Ze.forEach(((t,o)=>{const s=e.find((e=>e.headerName===t));if(s){const e=S().Pl.find((e=>e.type===s.propertyType));e&&(i[o]=e.type,s.propertyId&&(n[o]=s.propertyId),s.format&&(a[o]=s.format))}else{const e=r[t];"date"===e?(i[o]="date",a[o]="ll",c().f.updatePropertyMapping(t,"date",void 0,"ll")):e&&(i[o]=e)}})):Ze.forEach(((e,t)=>{const o=r[e];"date"===o?(i[t]="date",a[t]="ll",c().f.updatePropertyMapping(e,"date",void 0,"ll")):o&&(i[t]=o,c().f.updatePropertyMapping(e,o))})),I(i),Me(n),Fe(a),je.current=!0}}catch(pe){s([]),I({}),de({})}}),[t,Ze,Ge,Ke,Pe]);const qe=(0,p().IS)((e=>({container:{height:"100%",overflow:"hidden"},headerContainer:{display:"flex",width:"100%",flexDirection:"column",alignItems:"flex-start",gap:24,overflow:"hidden",paddingInlineStart:24,paddingInlineEnd:24,paddingBottom:24,paddingTop:40},header:{color:e.text.primary,textAlign:"center",fontSize:26,fontStyle:"normal",fontWeight:B().Wy.semibold,letterSpacing:.208},description:{alignSelf:"stretch",color:e.text.secondary,fontFeatureSettings:"case on",fontSize:14,fontStyle:"normal",fontWeight:B().Wy.regular},headerToggleRow:{display:"flex",alignItems:"center",width:"100%"},toggleLabel:{color:e.text.secondary,fontSize:14,fontWeight:B().Wy.regular,paddingInlineStart:8},mappingFrame:{flex:1,overflowY:"auto",padding:"0px 24px",width:"100%"},customGrid:{display:"grid",gridTemplateColumns:"1fr 16px 1fr",gap:8,width:"100%",height:28},arrowCell:{display:"flex",alignItems:"center",justifyContent:"center"},headerButton:{width:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",height:32,border:`1px solid ${e.border.primary}`,justifyContent:"flex-start",background:"rgba(0, 0, 0, 0.1)"},headerButtonText:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block",color:e.text.secondary,fontSize:B().J.UIRegular.desktop,fontWeight:B().Wy.regular,lineHeight:B().K_.UIRegular.desktop},arrowIcon:{width:16,height:16,fill:e.icon.secondary},buttonContainer:{marginTop:16,display:"flex",justifyContent:"center",gap:8,width:"100%",paddingInlineStart:24,paddingInlineEnd:24,paddingBottom:24},leftContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:8,position:"relative",height:"100%",minHeight:0,width:"37%",paddingTop:10},rightContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:8,padding:8,paddingInlineStart:0,height:"100%",flex:1,width:"58%"},columnHeading:{width:"100%",fontSize:12,fontWeight:B().Wy.regular,color:e.text.secondary},backButton:{borderRadius:"100%",top:1,insetInlineStart:1},backButtonContainer:{position:"absolute",top:12,insetInlineStart:12,display:"flex",width:24,height:24,justifyContent:"center",alignItems:"center",gap:8,flexShrink:0,borderRadius:12,backdropFilter:"blur(16px)",zIndex:10}})),[]),Je=(0,r.useCallback)((()=>{const e=!ue;fe(e),c().f.updateUseFirstRowAsHeaders(e)}),[ue]),Xe=(0,r.useCallback)((async()=>{let e;D().eH(o,{from:Ye,import_source:"csv",flowId:te().A.getOrCreateFlowId()});try{if(ye(!0),Se(void 0),!Ke)return me("Something went wrong. Please close the modal and try again."),void ye(!1);const i=Ke.userPropertyMapping||[];let n=0;const s={columnHeaders:a.flatMap((e=>{const t=i.find((t=>t.headerName===e)),o=(null==t?void 0:t.propertyType)||ce[e]||"text";if(e=ue||"dont_import"===o?e:"Column "+ ++n,"dont_import"===o)return[{headerName:e,doNotImport:!0}];if("place"===o)return[];if("date"===o){const r=(null==t?void 0:t.format)||"ll";return[{headerName:e,propertyType:o,format:r,doNotImport:!1,...(null==t?void 0:t.propertyId)&&{mapTo:t.propertyId}}]}return[{headerName:e,propertyType:o,doNotImport:!1,...(null==t?void 0:t.propertyId)&&{mapTo:t.propertyId}}]})),useFirstRowAsHeaders:Ke.firstRowAsHeader??ue},l="merge"===Ke.importType,d=Ke.csvFullFileData||[],p=ue?d.slice(1):d,m=p.slice(0,c().E),u=p.length>c().E,f=Boolean(ze&&a.length>0),g=Boolean(Ke.fileUrl&&Ke.signedToken&&Ke.spaceId);if(!(!l&&Ee&&f&&d.length>0&&(!u||g))){const i=te().A.getOrCreateFlowId(),n=ee().R.getOrCreateImportId();let l,d=null;if("merge"===Ke.importType){if(!Ke.importLocation||!Ke.spaceId)return me("Collection ID or Space ID is missing for merge operation."),void ye(!1);l={importType:"MergeIntoCollection",collection:{id:Ke.importLocation,spaceId:Ke.spaceId},fileName:Ke.fileName||"",fileURL:Ke.fileUrl||"",spaceId:Ke.spaceId,metadata:{csv:s},flowId:i,importId:n,userTimeZone:(0,x().P)(),signedToken:Ke.signedToken||""},d={pageId:Ke.importLocation,spaceId:Ke.spaceId}}else{const t="slash_command"===Ye,r=await L().n3(o,He,$e,"csv",1,Ke.fileName,We,void 0,t);e=r.createdPage,d={pageId:r.pageId,spaceId:r.spaceId},l={fileURL:Ke.fileUrl||"",fileName:Ke.fileName||"",importType:r.importType,block:{id:r.pageId,spaceId:r.spaceId},spaceId:r.spaceId,metadata:{csv:s},flowId:i,importId:n,userTimeZone:(0,x().P)(),signedToken:Ke.signedToken||""}}D().mM(o,{import_source:"csv",flowId:i,data:l}),D().Pd(o,{import_source:"csv",flowId:i,first_row_as_headers:ue,num_of_properties:a.length,collection_id:"merge"===Ke.importType?Ke.importLocation:void 0,import_sub_type:"merge"===Ke.importType?"merge":"new"});const p=(0,O().UT)(o,z().V,l,{spaceIds:[l.spaceId]});let m=!1;for await(const e of p){var t,r;if(e.error)throw e.error;if(("merge"!==Ke.importType&&"status"in e.value&&"created_collection"===(null===(t=e.value.status)||void 0===t?void 0:t.message)||"merge"===Ke.importType&&"status"in e.value&&"updated_collection"===(null===(r=e.value.status)||void 0===r?void 0:r.message)||"success"===e.taskStatus)&&!m&&d){const e=d.pageId,t=oe().B.createChildStore(He,{table:k().ev,id:e}),r=(0,Q().Ay)({store:t,preferPublicLink:!1,pageVisitSource:v().y8.Import});"merge"!==Ke.importType&&(0,$().navigateOnBaseUrl)({environment:o,url:r}),m=!0,c().f.close({type:"merge"===Ke.importType?"merged":"imported"}),ne().A.reset()}}return}if(!ze)return me("Preview is not ready. Please go back and re-open the modal."),void ye(!1);if(0===m.length)return me("This file does not contain any rows to import."),void ye(!1);const y=te().A.getOrCreateFlowId(),h=ee().R.getOrCreateImportId(),I=ze.collectionStore.getSchema(),S="slash_command"===Ye,b=await L().n3(o,He,$e,"csv",1,Ke.fileName,We,void 0,S);e=b.createdPage;const C=Y().createAndCommit({userAction:"csvImport.initializeCollectionPage",environment:o,canUndo:!0,perform:t=>{var r,i;const n=H().Wv({environment:o,type:"collection_view_page",spaceId:b.spaceId,inMemoryRecordCache:He.inMemoryRecordCache,transaction:t}),a=(null===(r=e)||void 0===r?void 0:r.getParentId())||Ke.parentId||He.id,s=(null===(i=e)||void 0===i?void 0:i.getParentTable())||Ke.parentTable||"space";if(H().zv({store:n,data:{id:n.id,space_id:b.spaceId,parent_id:a,parent_table:s,alive:!0},transaction:t}),e&&W().zz({parentStore:He.getPagesStore(),childStore:e,transaction:t}),"block"===s){const e=oe().B.createChildStore($e,{table:k().ev,id:a});W().NI({parentStore:e.getContentStore(),childStore:n,transaction:t})}else"space"===s&&W().NI({parentStore:He.getPagesStore(),childStore:n,transaction:t});(0,q().L)({environment:o,store:n,properties:{title:[[Ke.fileName||"Imported CSV"]]},transaction:t});const l=(0,Z().E)({environment:o,collectionViewBlockStore:n,transaction:t,collectionValue:{name:[[Ke.fileName||"Imported CSV"]],schema:I}}),c=(0,E().Ay)(),d=ie().p.createChildStore(n,{table:_().Gy,id:c});return H().zv({store:d,data:{id:c,version:1,type:"table",name:"Table view",format:{table_wrap:!0,table_properties:Object.entries(I).map((([e,t])=>({property:e,visible:!0,width:250}))),collection_pointer:{id:l.id,table:M().Vl,spaceId:b.spaceId}},parent_id:n.id,parent_table:"block",space_id:b.spaceId,alive:!0,query2:{aggregations:[],sort:[],filter:{operator:"and",filters:[]}}},transaction:t}),U().BC({parentStore:n.getCollectionViewsStore(),appendStore:d,transaction:t}),{collectionStore:l,collectionViewStore:d,collectionViewBlockStore:n}}}),T=C.performResult;if(!T)throw new Error("Failed to initialize collection page");const{collectionStore:A,collectionViewBlockStore:F}=T,j=new Map;Object.entries(A.getSchema()).forEach((([e,t])=>{t&&"options"in t&&Array.isArray(t.options)&&j.set(e,new Set((t.options||[]).map((e=>e.value))))}));const V={importType:b.importType,block:{id:b.pageId,spaceId:b.spaceId},fileName:Ke.fileName||"",fileURL:Ke.fileUrl||"",spaceId:b.spaceId,metadata:{csv:s},flowId:y,importId:h,userTimeZone:(0,x().P)(),signedToken:Ke.signedToken||""};D().mM(o,{import_source:"csv",flowId:y,data:V}),D().Pd(o,{import_source:"csv",flowId:y,first_row_as_headers:ue,num_of_properties:a.length,import_sub_type:"new",is_client_side_import:!0});for(let e=0;e<m.length;e+=Oe){const t=m.slice(e,e+Oe);Se(`Processing rows ${e+1}–${Math.min(e+t.length,m.length)} of ${m.length}`),await new Promise((e=>setTimeout(e,0))),Y().createAndCommit({userAction:"csvImport.clientBatch",environment:o,canUndo:!0,perform:e=>{t.forEach((t=>{const r=H().Wv({environment:o,spaceId:b.spaceId,type:"page",inMemoryRecordCache:He.inMemoryRecordCache,transaction:e});H().zv({store:r,data:{id:r.id,parent_id:A.id,parent_table:"collection",space_id:b.spaceId,alive:!0},transaction:e});const n=Le({schema:A.getSchema(),rowData:t,headers:a,userPropertyMapping:i,selectOptionTracker:j,collectionStore:A,transaction:e});Object.keys(n).length>0&&(0,q().L)({environment:o,store:r,properties:n,transaction:e}),W().X$({parentStore:A,childStore:r,transaction:e})}))}})}if(Se(void 0),u&&Ke.fileUrl&&Ke.signedToken){const e=m.length+(ue?1:0),t={fileURL:Ke.fileUrl,collectionId:A.id,spaceId:b.spaceId,startRow:e,metadata:s,importId:h,flowId:y,userTimeZone:(0,x().P)(),signedToken:Ke.signedToken};(async()=>{try{const e=(0,O().UT)(o,R,t,{spaceIds:[b.spaceId]});for await(const t of e);}catch(e){w().log({level:"error",from:"CsvImportMapFieldsStep",type:"importCSVPartial.enqueueFailed",error:(0,P().convertErrorToLog)(e)})}})()}const B=(0,Q().Ay)({store:F,preferPublicLink:!1,pageVisitSource:v().y8.Import});(0,$().navigateOnBaseUrl)({environment:o,url:B}),c().f.close({type:"imported"}),ne().A.reset()}catch(pe){w().log({level:"error",from:"CsvImportMapFieldsStep",type:"handleImport",error:(0,P().convertErrorToLog)(pe),data:{importType:null==Ke?void 0:Ke.importType}}),e&&Y().createAndCommit({userAction:"importActions.importFiles",environment:o,canUndo:!0,perform:t=>{e&&W().zz({parentStore:He.getPagesStore(),childStore:e,transaction:t})}});let r=Pe.formatMessage(L().DZ.importFailed);const i=(0,j().A)(pe);"CsvImportError"===i.message?r=Pe.formatMessage(X().m.csv_import_inconsistent_columns):"ImportFileSizeTooLargeError"===i.message?r=Pe.formatMessage(L().DZ.fileImportFailedSizeTooLarge):"ImportcsvTooManyColumns"===i.message?r=Pe.formatMessage(L().DZ.csvImportFailedColumnsTooLarge):"ImportcsvTooManyRows"===i.message&&(r=Pe.formatMessage(L().DZ.csvImportFailedRowsTooLarge)),me(r)}finally{ye(!1),Se(void 0)}}),[a,ce,Ke,o,We,He,$e,Ye,ue,Pe,ze,Ee]),Qe=(0,r.useCallback)((()=>{me(""),c().f.close({type:"canceled"})}),[]),et=(0,r.useCallback)(((e,t)=>{if(!ze)return;const{collectionStore:r}=ze,i=r.getSchema();let n;const a=e.trim().toLowerCase();for(const[o,c]of Object.entries(i)){if(!c||"object"!=typeof c)continue;const t=c,r=String(t.name||"");if(t.name===e||r.trim().toLowerCase()===a){n=[o,c];break}}if(!n)return;const[s,l]=n;l&&l.type!==t&&(Y().createAndCommit({userAction:"csvImport.updatePropertyType",environment:o,perform:i=>{if("select"===t||"multi_select"===t){const n=be((null==Ke?void 0:Ke.csvSampleRows)||[],(null==Ke?void 0:Ke.csvHeaders)||[],e,t);(0,N().H)({environment:o,collectionStore:r,property:s,type:t,transaction:i}),Y().applyOperation({store:r,operation:{pointer:r.pointer,path:["schema",s,"options"],command:"set",args:n},transaction:i})}else(0,N().H)({environment:o,collectionStore:r,property:s,type:t,transaction:i})},canUndo:!0}),Be.current&&setTimeout((()=>{(0,se().c)({propertyId:s,collectionContextStore:Be.current,environment:o,padding:50})}),100))}),[ze,o,null==Ke?void 0:Ke.csvSampleRows,null==Ke?void 0:Ke.csvHeaders]),tt=(0,r.useCallback)(((e,t)=>{if(!ze)return;const{collectionStore:r,collectionViewStore:i}=ze,n=r.getSchema(),a=Object.entries(n).find((([t,o])=>(null==o?void 0:o.name)===e));if(!a||!a[1])return;const[s]=a;Y().createAndCommit({userAction:"csvImport.updatePropertyVisibility",environment:o,perform:e=>{const o=i.getFormat()||{},r=o.table_properties||[],n=r.findIndex((e=>e.property===s));if(-1===n)return;const a=[...r];a[n]={...a[n],visible:t},H().zv({store:i,data:{format:{...o,table_properties:a}},transaction:e})},canUndo:!0})}),[ze,o]),ot=(0,r.useCallback)((()=>{const e=[...S().Pl];if("merge"===(null==Ke?void 0:Ke.importType)&&we){const t=we,o=Object.entries(t).map((([e,t])=>{if(!t||"object"!=typeof t)return null;const o=t;if(!o.type||"string"!=typeof o.type)return null;const r=o.type;if(!rt(r))return null;return{type:r,name:`${String(o.name||"")}`,propertyId:e,isExistingProperty:!0}})).filter((e=>null!==e));if(o.length>0)return[...e,...o]}return e}),[null==Ke?void 0:Ke.importType,we]),rt=e=>"status"===e||S().Pl.some((t=>t.type===e)),it=(0,r.useCallback)(((e,t,o,r)=>{const i=ot().find((e=>e.name===t));if(!i)return;const s=a[e];if(!s)return;const d=l[e];let p=o;if(!p&&"title"===i.type&&"merge"===(null==Ke?void 0:Ke.importType)&&we){const e=Object.entries(we).find((([e,t])=>"title"===(null==t?void 0:t.type)));e&&(p=e[0])}if(p){var m;const t=null===(m=Object.entries(ke).find((([t,o])=>o===p&&Number(t)!==e)))||void 0===m?void 0:m[0];if(t){const o=Number(t),n=a[o],d=ke[e];d?(Me((t=>({...t,[e]:p,[o]:d}))),I((t=>({...t,[e]:i.type,[o]:l[e]||"text"}))),c().f.updatePropertyMapping(s,i.type,p,r),c().f.updatePropertyMapping(n,l[e]||"text",d)):(Me((t=>{const r={...t,[e]:p};return delete r[o],r})),c().f.updatePropertyMapping(s,i.type,p,r),c().f.updatePropertyMapping(n,l[e]||"text",void 0))}else Me((t=>({...t,[e]:p}))),c().f.updatePropertyMapping(s,i.type,p,r)}else ke[e]&&Me((t=>{const{[e]:o,...r}=t;return r})),c().f.updatePropertyMapping(s,i.type,void 0,r);I((t=>({...t,[e]:i.type}))),r?Fe((t=>({...t,[e]:r}))):"date"!==i.type&&Fe((t=>{const o={...t};return delete o[e],o})),ze&&("dont_import"===i.type?tt(s,!1):("dont_import"===d&&tt(s,!0),setTimeout((()=>{const e=function(e){if("dont_import"!==e)return e}(i.type);e&&et(s,e)}),100))),Re.current=s,K().os({collectionSettingsStore:n})}),[n,a,ze,et,l,ke,tt,ot,null==Ke?void 0:Ke.importType,we]),nt=(0,r.useCallback)((e=>{Be.current=e}),[]),at=(0,r.useRef)(!1);return(0,r.useEffect)((()=>{if(at.current||"merge"!==(null==Ke?void 0:Ke.importType)||!we||0===a.length)return;const e=Object.entries(we),t={},o={};a.forEach(((r,i)=>{const n=r.trim().toLowerCase(),a=e.find((([e,t])=>{if(!t||"object"!=typeof t)return!1;return String(t.name||"").trim().toLowerCase()===n}));if(a){const[e,n]=a;if(!n)return;const s=n.type;if(!rt(s))return;c().f.updatePropertyMapping(r,s,e),t[i]=e,o[i]=s}}));const r=e.find((([,e])=>"title"===(null==e?void 0:e.type)));if(r){const[e]=r;for(let r=0;r<a.length;r++){if(ke[r])continue;const i=a[r];if("title"===l[r]||"title"===ce[i]){c().f.updatePropertyMapping(i,"title",e),t[r]=e,o[r]="title";break}}}Object.keys(t).length>0&&(Me((e=>({...e,...t}))),I((e=>({...e,...o})))),at.current=!0}),[null==Ke?void 0:Ke.importType,we,a,ze,ce,ke,l]),(0,r.useEffect)((()=>{if(!Re.current||!Be.current||!ze)return;const e=Re.current,{collectionStore:t}=ze,r=t.getSchema(),i=Object.entries(r).find((([t,o])=>{if(!o||"object"!=typeof o)return!1;return o.name===e}));if(!i)return void(Re.current=void 0);const[n]=i;setTimeout((()=>{Be.current&&(0,se().c)({propertyId:n,collectionContextStore:Be.current,environment:o,padding:50}),Re.current=void 0}),200)}),[ze,o]),(0,he.jsxs)(le().Ye,{style:qe.container,children:[(0,he.jsxs)(le().wt,{style:qe.leftContainer,children:[(0,he.jsx)(le().Ye,{style:qe.backButtonContainer,children:(0,he.jsx)(ae().n9,{iconFn:C().J,onClick:()=>{me(""),c().f.previousStep()},style:qe.backButton})}),(0,he.jsxs)(le().wt,{style:qe.headerContainer,children:[(0,he.jsx)(h().D,{styleKey:"Title-2xl/Semibold",style:qe.header,children:Pe.formatMessage(Ne.heading)}),(0,he.jsx)(h().D,{styleKey:"Body/Medium",style:qe.description,children:Pe.formatMessage(Ne.description)}),(0,he.jsxs)(le().Ye,{style:qe.headerToggleRow,children:[(0,he.jsx)(G().A,{on:ue,onClick:Je}),(0,he.jsx)(h().D,{styleKey:"Body/Medium",style:qe.toggleLabel,children:Pe.formatMessage(Ne.useFirstRowAsHeaders)})]})]}),(0,he.jsx)(le().wt,{style:qe.mappingFrame,children:(0,he.jsxs)("div",{style:qe.customGrid,children:[(0,he.jsx)("div",{style:qe.columnHeading,children:"CSV File Columns"}),(0,he.jsx)("div",{children:null}),(0,he.jsx)("div",{style:qe.columnHeading,children:"Property Type"}),a.map(((e,t)=>(0,he.jsxs)(r.Fragment,{children:[(0,he.jsx)(f().A,{disabled:!0,style:qe.headerButton,children:(0,he.jsx)("span",{style:qe.headerButtonText,children:e})}),(0,he.jsx)("div",{style:qe.arrowCell,children:(0,T().arrowStraightRightIcon)(qe.arrowIcon)}),(0,he.jsx)(De,{index:t,header:e,selectedType:l[t],selectedPropertyId:ke[t],inferredType:ce[e],onSelectType:it,allPropertyTypes:ot(),isMergeFlow:"merge"===(null==Ke?void 0:Ke.importType),selectedFormat:_e[t]})]},t)))]})}),(0,he.jsxs)(le().wt,{style:qe.buttonContainer,children:[pe?(0,he.jsx)(le().wt,{children:(0,he.jsx)(h().D,{styleKey:"Caption/Regular",colorPalette:"yellow",colorVariant:"secondary",children:pe})}):void 0,ve?(0,he.jsx)(h().D,{styleKey:"Caption/Regular",colorPalette:"gray",colorVariant:"secondary",children:ve}):void 0,(0,he.jsx)(y().A,{colorPalette:"blue",disabled:ge||void 0!==Ue||Te,onClick:Xe,style:{height:36,fontWeight:B().Wy.regular},children:ge||Te?(0,he.jsx)(u().k,{}):Pe.formatMessage(Ne.importButton)}),(0,he.jsx)(g().p,{colorPalette:"gray",style:{paddingInlineStart:"44%",height:32},onClick:Qe,disabled:ge||Te,children:Pe.formatMessage(Ne.cancelButton)})]})]}),(0,he.jsx)(le().wt,{style:qe.rightContainer,children:(0,he.jsx)(Ie,{previewCollection:ze,onSetCollectionContextStore:nt,validationState:Ue})})]})}var He=()=>o(124092),$e=()=>o(373009),Ye=()=>o(416845),Ke=()=>o(20179),Ze=()=>o(212050),Ge=()=>o(920495),qe=()=>o(609616),Je=()=>o(721479);const Xe={viewBox:"0 0 16 16",fittedViewBox:"2.57 1.02 10.86 12.6",svg:(0,he.jsxs)(he.Fragment,{children:[(0,he.jsx)("path",{d:"M7.96 1.025a.625.625 0 0 0-.624.625v6.421l-.914-.913a.625.625 0 1 0-.884.884l2 2c.244.244.64.244.884 0l2-2a.625.625 0 0 0-.884-.884l-.952.953V1.65a.625.625 0 0 0-.625-.625"}),(0,he.jsx)("path",{d:"M4.4 3.975A1.825 1.825 0 0 0 2.575 5.8v6c0 1.008.817 1.825 1.825 1.825h7.2a1.825 1.825 0 0 0 1.825-1.825v-6A1.825 1.825 0 0 0 11.6 3.975H9.386v1.25H11.6c.318 0 .575.257.575.575v6a.575.575 0 0 1-.575.575H4.4a.575.575 0 0 1-.575-.575v-6c0-.318.258-.575.575-.575h2.135v-1.25z"})]})},Qe=(0,ke().wt)("squareAndArrowDownSmall",Xe);var et=()=>o(599813),tt=()=>o(72135),ot=()=>o(979340),rt=()=>o(892632),it=()=>o(10984),nt=()=>o(484595);const at=(0,F().YK)({title:{id:"csvImport.uploadStep.title",defaultMessage:"Import CSV into Notion"},description:{id:"csvImport.uploadStep.description",defaultMessage:"Create a new database with your CSV or merge it into an existing one"},uploadButton:{id:"csvImport.uploadStep.uploadButton",defaultMessage:" Choose file"},mapHeadersButton:{id:"csvImport.uploadStep.mapHeadersButton",defaultMessage:"Map CSV headers"},uploadHeader:{id:"csvImport.uploadStep.uploadHeader",defaultMessage:"Upload CSV"},uploadProgress:{id:"csvImport.uploadStep.uploadProgress",defaultMessage:"Uploading... {percentComplete}%"},learnAboutImports:{id:"csvImport.uploadStep.learnAboutImports",defaultMessage:"Learn about imports"},selectDatabase:{id:"csvImport.uploadStep.selectDatabase",defaultMessage:"Select database"},selectDatabaseHeader:{id:"csvImport.uploadStep.selectDatabaseHeader",defaultMessage:"Import Location"},importMethodHeader:{id:"csvImport.uploadStep.importMethodHeader",defaultMessage:"Import method"},createNewDatabase:{id:"csvImport.uploadStep.createNewDatabase",defaultMessage:"Create a new database"},createNewDatabaseSubtitle:{id:"csvImport.uploadStep.createNewDatabaseSubtitle",defaultMessage:"Start fresh with a new database from your CSV data"},importIntoExisting:{id:"csvImport.uploadStep.importIntoExisting",defaultMessage:"Import into existing database"},importIntoExistingSubtitle:{id:"csvImport.uploadStep.importIntoExistingSubtitle",defaultMessage:"Add your CSV data to an existing database"},csvEmptyFile:{id:"csvImport.uploadStep.errors.emptyFile",defaultMessage:"Your file is empty. Please upload a file that contains data"},csvHeadersOnly:{id:"csvImport.uploadStep.errors.headersOnly",defaultMessage:"Your file has headers but no data rows. Add rows and try again"},csvParseError:{id:"csvImport.uploadStep.errors.parseError",defaultMessage:"We couldn’t read the file. Please make sure it’s in a valid CSV format"},csvTooManyColumns:{id:"csvImport.uploadStep.errors.tooManyColumns",defaultMessage:"Your file has too many columns. The maximum allowed is 999"},databaseRequired:{id:"csvImport.uploadStep.errors.databaseRequired",defaultMessage:"Please select a database to merge with"},invalidFileFormat:{id:"csvImport.uploadStep.errors.invalidFileFormat",defaultMessage:"Invalid file type. Only .csv files are supported"}}),st=20480,lt=100,ct=30,dt=999;function pt(e){return e?e.length<=ct?e:`${e.slice(0,ct-3)}...`:""}function mt({isMergeMode:e,onSelectCollection:t,selectedCollection:n,onMenuOpenChange:a,selectedCollectionViewBlockStore:s}){const c=(0,d().v3)(),[m,u]=(0,r.useState)(""),[f,g]=(0,r.useState)(!1),[y,h]=(0,r.useState)([]),v=(0,r.useRef)(crypto.randomUUID()).current,I=(0,i().uB)(void 0,o(463830).A),S=(0,i().uB)(void 0,o(970585).A),w=(0,i().K8)((()=>I.state.open),[I]);(0,r.useEffect)((()=>{null==a||a(w)}),[w,a]);const x=(0,r.useCallback)((async t=>{if(e){const e=(null==s?void 0:s.getOwnedAndLinkedCollectionStores().map((e=>{var t;return{id:e.id,title:(null===(t=e.getName())||void 0===t?void 0:t.toString())||"Untitled",icon:e.getIcon(),store:e}})))??[],r=e.find((e=>e.id===(null==n?void 0:n.id)));return t?(0,o(778078).Ay)(t,e,(e=>e.title)):[...r?[r]:[],...e.filter((e=>e.id!==(null==n?void 0:n.id)))]}const r=l().default.state.mainEditorCurrentBlockStore;if(!r)return[];const i=await o(106628).T.searchActions.load(),a=await i.searchCollectionsWithRecents({environment:c,collectionViewBlockStore:void 0,parentStore:r,spaceStore:l().default.state.sidebarSpaceStore,query:t,limit:10,requireEditPermissions:!0,searchSessionId:v,peopleBlocksToInclude:"none"}),d=[];for(const e of a.results){const t=re().m.createChildStore(r,{table:"collection",id:e});if(!t)continue;const o=t.getName()||"Untitled";d.push({id:e,title:o.toString(),icon:t.getIcon(),store:t})}return d}),[c,e,s,v,null==n?void 0:n.id]),b=(0,r.useCallback)((async e=>{g(!0);try{const t=await x(e);h(t)}catch(t){h([])}finally{g(!1)}}),[x]);(0,r.useEffect)((()=>{const e=setTimeout((()=>{w&&b(m)}),300);return()=>clearTimeout(e)}),[m,w,b]),(0,r.useEffect)((()=>{w&&b("")}),[w,b]);const[C,T]=(0,r.useState)(!1);(0,r.useEffect)((()=>{x("").then((e=>{T(e.length<=1)}))}),[x]);const A=(0,p().IS)((e=>({container:{width:"100%",position:"relative",zIndex:10},selectedDataSourceButton:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",minHeight:36,padding:"6px 12px",borderRadius:6,border:`1px solid ${e.border.primary}`,background:e.background.elevated,overflow:"hidden",opacity:C?.4:1},placeholder:{color:e.text.secondary,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},subheader:{color:e.text.secondary,fontSize:12,fontStyle:"normal",fontWeight:B().Wy.regular,marginBottom:6},menuItemWrapper:{width:"100%",paddingInlineStart:8,paddingInlineEnd:8,boxSizing:"border-box"}})),[C]),k=(0,r.useCallback)((e=>{t(e),I.setState({open:!1}),u("")}),[I,t]),M={key:"results",items:f?[{key:"loading",render:()=>(0,he.jsx)("div",{style:{...A.subheader,textAlign:"center"},children:(0,he.jsx)(F().sA,{defaultMessage:"Searching...",id:"database.csvImport.searchingDatabases"})}),action:()=>{}}]:0===y.length?[{key:"noResults",render:()=>(0,he.jsx)("div",{style:{...A.subheader,textAlign:"center"},children:(0,he.jsx)(F().sA,{defaultMessage:"No databases found",id:"database.csvImport.noDatabasesFound"})}),action:()=>{}}]:y.map((e=>({key:e.id,render:t=>(0,he.jsx)("div",{style:A.menuItemWrapper,children:(0,he.jsx)(o(305390).A,{...t,store:e.store,isChecked:e.id===(null==n?void 0:n.id)})}),action:()=>{k(e)}}))),render:e=>(0,he.jsx)(Ve().A,{...e})};return(0,he.jsxs)("div",{style:A.container,children:[(0,he.jsx)(ge().A,{style:A.subheader,children:(0,he.jsx)(F().sA,{...at.selectDatabaseHeader})}),(0,he.jsx)(Me().A,{buttonPopupStore:I,placementToOrigin:"bottom",popupType:o(726637).A.isMobile?Me().z.BottomSheet:Me().z.Popup,originGap:4,sameWidthAsOrigin:!0,disabled:C,renderOrigin:e=>(0,he.jsxs)(He().p,{disabled:C,style:A.selectedDataSourceButton,...e,children:[n?(0,he.jsx)(o(649320).G,{collectionStore:n.store}):(0,he.jsx)("span",{style:A.placeholder,children:(0,he.jsx)(F().sA,{...at.selectDatabase})}),(0,he.jsx)(de().I,{icon:o(515187).w,size:"sm",colorVariant:"secondary"})]}),render:()=>{const e={menuType:_e().gu.Popup,maxHeight:350};return(0,he.jsx)(Pe().A,{...e,children:(0,he.jsxs)("div",{style:{width:"100%"},children:[(0,he.jsx)(Ve().A,{shouldShowBottomDivider:!1,children:(0,he.jsx)(je().Ay,{value:m,onChange:e=>{u(e.target.value),S.setState({focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})},focusInitial:!0,placeholder:"Search databases...",showClearButton:!0})}),(0,he.jsx)("div",{style:{maxHeight:300,overflowY:"auto"},children:(0,he.jsx)(Ee().Ay,{type:Ee().Oh.Vertical,initialFocus:0,sections:[M]})})]})})}})]})}const ut=r.memo(mt);function ft({spaceStore:e,collectionViewBlockStore:t,analyticsFrom:o}){const n=(0,i().O$)(c().f),a=(0,d().v3)(),s=(0,F().tz)(),[l,m]=(0,r.useState)(0),[u,f]=(0,r.useState)(!1),[g,v]=(0,r.useState)(!1),[I,w]=(0,r.useState)(!1),[x,b]=(0,r.useState)(""),C=r.useRef(!0),[T,A]=(0,r.useState)(null),[k,M]=(0,r.useState)("create"),_="slash_command"===o||"space_switcher"===o,P=n.open&&n.fileName?n.fileName:"",E=(0,r.useMemo)((()=>pt(P)),[P]);(0,r.useEffect)((()=>{C.current=n.open}),[n.open]);const V=n.open&&"merge"===n.importType,R=(0,r.useMemo)((()=>V&&"database_create_empty_state"!==o?"create"!==k:!V&&"existing"===k),[V,o,k]),z=(0,r.useMemo)((()=>{const e=n.open&&n.isLoading;if(!P||e||g||!I)return!0;return!(!V&&"existing"!==k||T)}),[P,n,g,I,V,k,T]);(0,r.useEffect)((()=>{V&&M("existing")}),[V]);const N=n.open&&n.importLocation?n.importLocation:void 0;(0,r.useEffect)((()=>{V&&!T&&N&&(async()=>{const t=await async function(){try{const t=re().m.createChildStore(e,{table:"collection",id:N,spaceId:e.id});return await t.load(),t}catch{return}}();t&&A({id:t.id,title:(t.getName()||"Untitled").toString(),icon:t.getIcon(),store:t})})()}),[V,N,T,e,a]),(0,r.useEffect)((()=>{n.open&&n.csvHeaders&&n.csvSampleRows&&w(!0)}),[n]),(0,r.useEffect)((()=>{T&&V&&c().f.setImportLocation(T.id)}),[T,V]);const O=(0,r.useCallback)((e=>{}),[]),U=(0,r.useCallback)((async()=>{try{w(!1),D().Df(a,{import_source:"csv",flowId:te().A.getOrCreateFlowId()});const t=await rt().dA({environment:a,supportsMobileNativeFileUpload:!1,multiple:!1,accept:".csv"});if(b(""),0===t.length||!(t[0]instanceof File))return;const o=t[0];f(!0);const r=o.name.toLowerCase();if("csv"!==r.split(".").pop())return b(s.formatMessage(at.invalidFileFormat)),f(!1),void D().lJ(a,{import_source:"csv",flowId:te().A.getOrCreateFlowId(),is_success:!1,error_type:"invalid_file_format"});const i=(0,it().AI)();if(o.size>(0,ot().HG)(i))throw D().lJ(a,{import_source:"csv",flowId:te().A.getOrCreateFlowId(),is_success:!1,error_type:"file_size_too_large"}),new(Ye().s7)("ImportFileSizeTooLargeError",{clientData:{type:"upload_file_size_exceeded",code:"fileImportError",messageValues:{maxSize:tt().z3((0,ot().HG)(i),1)}}});v(!0);const n=new FileReader,l=new Promise((e=>{n.onload=t=>{try{var o;const r=null===(o=t.target)||void 0===o?void 0:o.result;if("string"==typeof r){const t=(0,S().CO)(r);if(t.length>0){const o=t[0],r=t.slice(1,Math.min(t.length,lt+1)),i=o.map(((e,t)=>""===e.trim()?`column ${t+1}`:e));return void e({headers:i,sampleRows:r})}}e(null)}catch(x){e(null)}},n.onerror=()=>{e(null)}})),d=o.slice(0,st);n.readAsText(d);const p=await new Promise(((t,r)=>{rt().Zn({environment:a,uploadType:"csv",files:[o],bucket:"temporary",bypassFreeFileUploadLimitCheck:!0,spaceId:e.id,onBatchStart:()=>{m(0)},onBatchProgress:({progressPercent:e})=>{m(e??0)},onBatchCompleteWithToken:e=>{m(100),t(e)},onBatchError:e=>{r(e)}})})),u=await l;if(v(!1),0===o.size)return b(s.formatMessage(at.csvEmptyFile)),void f(!1);if(!u)return b(s.formatMessage(at.csvParseError)),f(!1),void D().lJ(a,{import_source:"csv",flowId:te().A.getOrCreateFlowId(),is_success:!1,error_type:"csv_parse_error"});if(0===u.headers.length)return b(s.formatMessage(at.csvEmptyFile)),f(!1),void D().lJ(a,{import_source:"csv",flowId:te().A.getOrCreateFlowId(),is_success:!1,error_type:"csv_empty_file"});if(0===u.sampleRows.length)return b(s.formatMessage(at.csvHeadersOnly)),f(!1),void D().lJ(a,{import_source:"csv",flowId:te().A.getOrCreateFlowId(),is_success:!1,error_type:"csv_header_row_only"});if(u.headers.length>dt)return b(s.formatMessage(at.csvTooManyColumns)),f(!1),void D().lJ(a,{import_source:"csv",flowId:te().A.getOrCreateFlowId(),is_success:!1,error_type:"csv_too_many_columns"});if(!C.current)return f(!1),v(!1),void D().lJ(a,{import_source:"csv",flowId:te().A.getOrCreateFlowId(),is_success:!1,error_type:"csv_modal_closed"});C.current&&c().f.setFileMetadata(o.name,p[0].fileUrl,o.size,p[0].signedToken),u&&(c().f.setCsvData(u.headers,u.sampleRows),w(!0),D().lJ(a,{import_source:"csv",flowId:te().A.getOrCreateFlowId(),is_success:!0}),C.current&&(async()=>{try{const e=await o.text(),t=(0,S().CO)(e);if(!C.current)return;c().f.setCsvFullFileData(t)}catch(x){}})()),f(!1)}catch(x){if(!C.current)return;const t=(0,j().A)(x);if(t instanceof Ye().s7&&"upload_file_size_exceeded"===t.body.clientData.type&&"messageValues"in t.body.clientData){const e=s.formatMessage(L().DZ.fileImportFailedCustomSizeTooLarge,{maxSize:t.body.clientData.messageValues.maxSize});b(e)}else{const e=s.formatMessage(L().DZ.importFailedWithError);b(e)}f(!1),v(!1),w(!1),D().lJ(a,{import_source:"csv",flowId:te().A.getOrCreateFlowId(),is_success:!1,error_type:"csv_upload_error"})}}),[a,e.id,s]),W=(0,r.useCallback)((()=>{const e="create"===k,t="existing"===k&&T;"existing"!==k||T?(D().ZW(a,{import_source:"csv",flowId:te().A.getOrCreateFlowId(),import_sub_type:V?"merge":"new"}),n.open&&(e?c().f.setState({...n,importType:"import",importLocation:"new"}):t&&c().f.setState({...n,importType:"merge",importLocation:T.id})),c().f.nextStep()):b(s.formatMessage(at.databaseRequired))}),[T,k,s,n,a,V]),H=(0,r.useCallback)((()=>{c().f.close({type:"canceled"})}),[]),$=(0,p().IS)((e=>({container:{display:"flex",width:"87%",flexDirection:"column",alignItems:"flex-start",gap:8,marginInlineStart:24,marginInlineEnd:24,flexShrink:0},title:{color:e.text.primary,textAlign:"center",fontSize:26,fontStyle:"normal",fontWeight:B().Wy.semibold,letterSpacing:.208},description:{alignSelf:"stretch",color:e.text.secondary,fontFeatureSettings:"case on",fontStyle:"normal",fontWeight:B().Wy.regular},closeButton:{position:"absolute",top:12,insetInlineStart:12,display:"flex",width:24,height:24,justifyContent:"center",alignItems:"center",gap:8,flexShrink:0,borderRadius:12,backdropFilter:"blur(16px)",zIndex:10},leftContainer:{display:"flex",flexDirection:"column",height:"100%",width:"37%",position:"relative",overflow:"hidden"},leftContentArea:{display:"flex",flexDirection:"column",flex:1,minHeight:0,overflowY:"auto",overflowX:"hidden",paddingBottom:16,paddingTop:52},subheader:{color:e.text.secondary,fontSize:12,fontStyle:"normal",fontWeight:B().Wy.regular,marginBottom:6},buttonContainer:{display:"flex",justifyContent:"center",gap:8,width:"87%",marginInlineStart:24,marginInlineEnd:24,paddingTop:16,paddingBottom:24,flexShrink:0},databaseSelectorContainer:{width:"87%",marginInlineStart:24,marginInlineEnd:24,flexDirection:"column"},fileNameDisplayButton:{height:32,minWidth:0,overflow:"hidden",display:"flex",alignItems:"center",gap:8},fileNameDisplayButton_NoHoverEffect:{background:e.background.tertiaryTranslucent},iconHoverWrapper:{padding:4,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"background-color 0.15s ease",outline:"none"},iconHoverWrapperHovered:{backgroundColor:"rgba(0, 0, 0, 0.1)"}})),[]);return n.open?(0,he.jsxs)(le().Ye,{style:{height:"100%",minHeight:0,overflow:"hidden"},children:[(0,he.jsxs)(le().wt,{style:$.leftContainer,children:[(0,he.jsx)(le().Ye,{style:$.closeButton,children:(0,he.jsx)(ae().n9,{iconFn:Ze().u,onClick:H,style:{insetInlineStart:1,top:1}})}),(0,he.jsxs)(le().wt,{style:{...$.leftContentArea,gap:24},children:[(0,he.jsxs)(le().Ye,{style:$.container,children:[(0,he.jsx)(h().D,{styleKey:"Title-2xl/Semibold",colorVariant:"primary",style:$.title,children:(0,he.jsx)(F().sA,{...at.title})}),(0,he.jsx)(h().D,{styleKey:"Body/Medium",colorVariant:"secondary",style:$.description,children:(0,he.jsx)(F().sA,{...at.description})})]}),(0,he.jsxs)(le().Ye,{style:{width:"87%",marginInlineStart:24,marginInlineEnd:24,flexDirection:"column"},children:[(0,he.jsx)(ge().A,{style:$.subheader,children:(0,he.jsx)(F().sA,{...at.uploadHeader})}),(0,he.jsxs)("div",{style:{position:"relative",width:"100%"},children:[P&&!u?(0,he.jsxs)($e().E,{style:{...$.fileNameDisplayButton,width:"100%",justifyContent:"space-between",borderRadius:6,cursor:"default"},hoveredStyle:$.fileNameDisplayButton_NoHoverEffect,disabled:!P||u,children:[(0,he.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1,minWidth:0},children:[(0,he.jsx)(de().I,{icon:Ge().n,size:"default",colorVariant:"primary"}),(0,he.jsx)("span",{style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",display:"block",minWidth:0,flex:1},children:E})]}),(0,he.jsx)("div",{style:$.iconHoverWrapper,onClick:e=>{e.stopPropagation(),c().f.setState({...n,fileName:"",fileUrl:"",fileSize:0,csvHeaders:void 0,csvSampleRows:void 0,userPropertyMapping:[]})},onMouseEnter:e=>{Object.assign(e.currentTarget.style,$.iconHoverWrapperHovered)},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},role:"button",tabIndex:0,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),c().f.setState({...n,fileName:"",fileUrl:"",fileSize:0,csvHeaders:void 0,csvSampleRows:void 0,userPropertyMapping:[]}))},children:(0,he.jsx)(de().I,{icon:et().xMarkIcon,size:"sm",colorVariant:"secondary"})})]}):(0,he.jsx)($e().E,{style:{width:"100%",height:32},onClick:U,disabled:u||g,children:u?(0,he.jsx)(F().sA,{...at.uploadProgress,values:{percentComplete:l}}):g?"Processing CSV...":(0,he.jsxs)(le().Ye,{children:[(0,he.jsx)(de().I,{icon:qe().o,size:"default",colorVariant:"primary"}),(0,he.jsx)(F().sA,{...at.uploadButton})]})}),u?(0,he.jsx)("div",{style:{position:"absolute",insetInlineStart:0,top:0,height:"100%",width:`${l}%`,backgroundColor:"rgba(0,0,0,0.1)",borderRadius:4,transition:"width 0.3s ease"}}):void 0]}),x?(0,he.jsx)(le().wt,{style:{paddingTop:4},children:(0,he.jsx)(h().D,{styleKey:"Caption/Regular",colorPalette:"yellow",colorVariant:"secondary",children:x})}):void 0]}),_?(0,he.jsxs)(le().Ye,{style:{width:"87%",marginInlineStart:24,marginInlineEnd:24,flexDirection:"column"},children:[(0,he.jsx)(ge().A,{style:$.subheader,children:(0,he.jsx)(F().sA,{...at.importMethodHeader})}),(0,he.jsxs)(le().wt,{style:{gap:8},children:[(0,he.jsx)(gt,{radioItem:{key:"create",title:s.formatMessage(at.createNewDatabase),subtitle:s.formatMessage(at.createNewDatabaseSubtitle),icon:Ke().addSquareRoundedSmallIcon},isSelected:"create"===k,onSelectRadio:()=>M("create")}),(0,he.jsx)(gt,{radioItem:{key:"existing",title:s.formatMessage(at.importIntoExisting),subtitle:s.formatMessage(at.importIntoExistingSubtitle),icon:Qe},isSelected:"existing"===k,onSelectRadio:()=>M("existing")})]})]}):void 0,R?(0,he.jsx)(le().Ye,{style:$.databaseSelectorContainer,children:(0,he.jsx)(ut,{isMergeMode:!_,selectedCollection:T,onSelectCollection:A,onMenuOpenChange:O,selectedCollectionViewBlockStore:t})}):void 0]}),(0,he.jsxs)(le().wt,{style:$.buttonContainer,children:[(0,he.jsx)(y().A,{colorPalette:"blue",onClick:W,disabled:z,style:{gap:6,height:36,fontWeight:B().Wy.regular},children:(0,he.jsx)(F().sA,{...at.mapHeadersButton})}),(0,he.jsxs)(He().p,{colorPalette:"gray",style:{paddingInlineStart:"27%",gap:6,height:32},onClick:()=>window.open("https://www.notion.com/help/import-data-into-notion#csv","_blank"),children:[(0,Je().questionMarkCircleSmallIcon)({width:16,height:16}),(0,he.jsx)(F().sA,{...at.learnAboutImports})]})]})]}),(0,he.jsx)(ht,{fileName:P})]}):null}function gt({radioItem:e,isSelected:t,onSelectRadio:o,isDisabled:r}){const i=(0,p().IS)((e=>({button:{display:"flex",justifyContent:"space-between",gap:10,height:"auto",minHeight:70,borderRadius:8,paddingTop:12,paddingBottom:12,paddingInlineStart:14,paddingInlineEnd:14-nt().p,border:void 0,boxShadow:t?`inset 0 0 0 1px ${e.blue.icon.accentPrimary}`:`inset 0 0 0 1px ${e.border.primary}`,overflow:"hidden"},buttonText:{display:"flex",flexDirection:"column",gap:2,minWidth:0,overflow:"hidden"},optionTitle:{fontWeight:B().Wy.medium,fontSize:14,fontStyle:"normal",color:e.text.primary,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},optionSubtitle:{whiteSpace:"normal",color:e.text.secondary,fontSize:12,fontStyle:"normal",fontWeight:B().Wy.regular,overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},iconAndText:{display:"flex",alignItems:"flex-start",gap:8,flex:1,minWidth:0,overflow:"hidden"},iconContainer:{flexShrink:0},radioIconContainer:{flexShrink:0,marginInlineStart:8}})),[t]);return(0,he.jsxs)(f().A,{size:"lg",onClick:()=>o(e.key),style:i.button,disabled:r,children:[(0,he.jsxs)("div",{style:i.iconAndText,children:[e.icon?(0,he.jsx)("div",{style:i.iconContainer,children:(0,he.jsx)(de().I,{icon:e.icon,size:"default",colorVariant:"secondary"})}):void 0,(0,he.jsxs)("div",{style:i.buttonText,children:[(0,he.jsx)(ge().A,{style:i.optionTitle,children:e.title}),e.subtitle?(0,he.jsx)(ge().A,{isSmall:!0,isMultiline:!0,style:i.optionSubtitle,children:e.subtitle}):void 0]})]}),(0,he.jsx)("div",{style:i.radioIconContainer,children:(0,he.jsx)(nt().A,{isSelected:t})})]})}const yt={type:"spring",stiffness:150,damping:20,delay:.5},ht=r.memo((function({fileName:e}){const t=(0,p().IS)((e=>({rightContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:8,height:"100%",flex:1,paddingTop:8,paddingBottom:8,paddingInlineEnd:8},shimmerContainer:{borderRadius:12,border:`1px solid ${e.border.secondary}`,backgroundColor:"dark"===e.mode?e.popoverWaxPaperBackground:void 0,backgroundImage:`url(${o(148307).A.images.workflowTemplates.bgDotsPng})`,backgroundRepeat:"repeat",backgroundSize:"70px 70px",backgroundPosition:"0% 0%",backgroundBlendMode:"multiply",position:"absolute",userSelect:"none",inset:0,zIndex:10,padding:36},header:{opacity:.6,paddingBottom:20,borderBottom:`1px solid ${e.border.primary}`},columns:{display:"grid",gridTemplateColumns:"3fr 2fr 2fr",gap:45},shimmer:{width:"50%",height:9,borderRadius:5,background:"#A6A6A6"},shimmerWide:{width:"100%",height:9,borderRadius:5,background:"#A6A6A6"}})),[]),i=(0,r.useMemo)((()=>pt(e.replace(/\.csv$/i,"")||"New table")),[e]);return(0,he.jsx)(le().wt,{style:t.rightContainer,children:(0,he.jsx)(o(153321).P.div,{initial:{opacity:0,x:30},animate:{opacity:1,x:0},transition:yt,style:{width:"100%",height:"100%",position:"relative"},children:(0,he.jsxs)(n().Y1,{direction:"vertical",height:"fill",width:"fill",padding:"36px 38px",style:t.shimmerContainer,gap:30,children:[(0,he.jsxs)(n().Y1,{direction:"horizontal",align:"center-left",gap:12,height:50,style:t.header,children:[(0,he.jsx)(de().I,{icon:me().T,size:"xl",colorVariant:"secondary"}),(0,he.jsx)(h().D,{styleKey:"Title-lg/Bold",colorVariant:"secondary",style:{fontWeight:B().Wy.semibold},children:i})]}),(0,he.jsx)("div",{style:t.columns,children:Array.from({length:3}).map(((e,o)=>(0,he.jsxs)(n().Y1,{direction:"vertical",gap:25,children:[(0,he.jsx)($e().E,{disabled:!0,style:t.shimmer}),Array.from({length:5}).map(((e,o)=>(0,he.jsx)($e().E,{disabled:!0,style:t.shimmerWide},o)))]},o)))})]})})})}));function vt(){return null}function It(e){const t=(0,i().O$)(c().f);(0,r.useEffect)((()=>{if(t.open){const t=l().default.state.sidebarSpaceStore;if(!t)return;const o=t.id;c().f.setSpaceId(o),e.pageStore?c().f.setParent(e.pageStore.id,"block"):c().f.setParent(o,"space")}}),[t.open,e.pageStore]);const o=(0,r.useCallback)((()=>{t.open&&c().f.close({type:"canceled"})}),[t]),a=(0,i().K8)((()=>t.open?c().f.getCurrentStep():void 0),[t]),d=(0,r.useCallback)((()=>{c().f.close({type:"canceled"})}),[]),p=(0,r.useMemo)((()=>({width:{type:"fixed",length:1e3},height:{type:"fixed",length:650}})),[]);return a&&t.open?(0,he.jsx)(s().s,{isOpen:!0,areaConstraint:p,onDismiss:o,onClosed:d,backgroundAppearance:"wash",render:({sizeRange:o})=>(0,he.jsx)(n().Y1,{style:o,children:(0,he.jsx)(St,{currentModalStep:a,pageStore:e.pageStore,spaceStore:e.spaceStore,spaceViewStore:e.spaceViewStore,analyticsFrom:e.analyticsFrom,collectionViewBlockStore:t.collectionViewBlockStore})})}):null}function St({currentModalStep:e,pageStore:t,spaceStore:o,spaceViewStore:r,analyticsFrom:n,collectionViewBlockStore:s}){if(!(0,i().K8)((()=>c().f.state.open),[]))return null;switch(e){case"uploadFile":return(0,he.jsx)(ft,{spaceStore:o,collectionViewBlockStore:s,analyticsFrom:n});case"mapFieldsForImport":case"mapFieldsForMerge":return(0,he.jsx)(We,{pageStore:t,spaceStore:o,spaceViewStore:r,analyticsFrom:n});case"importing":return(0,he.jsx)(vt,{});default:(0,a().HB)(e)}}},313961:(e,t,o)=>{o.d(t,{A:()=>r});const r=new(o(463830).A)},484595:(e,t,o)=>{o.d(t,{A:()=>s,p:()=>n});var r=o(296540),i=o(474848);const n=8;function a({isSelected:e,radioButtonColor:t="blue"},r){const{radioButtonStyle:a,dotStyle:s}=(0,o(401497).IS)((o=>{const r="blue"===t?o.blue.icon.accentPrimary:o.red.icon.accentPrimary;return{radioButtonStyle:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:16,height:16,borderRadius:16,marginInlineEnd:n,background:e?r:o.whiteButtonBackground,border:e?"none":`1px solid ${o.radioButtonBorder}`,transition:"background 100ms ease-out"},dotStyle:{width:6,height:6,borderRadius:6,background:o.text.inversePrimary,transition:"opacity 100ms ease-out",opacity:e?1:0}}}),[e,t]);return(0,i.jsx)("div",{ref:r,style:a,children:(0,i.jsx)("div",{style:s})})}const s=r.forwardRef(a)},490884:(e,t,o)=>{o.d(t,{fF:()=>a,k2:()=>n});const r=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.ms-word.document.macroEnabled.12","application/vnd.ms-word.template.macroEnabled.12"],i=["text/plain",".md",".mdown",".markdown",".mkdn",".mkd",".Rmd",".md.txt"],n={markdown:i,csv:["text/plain",".csv"],html:["text/html"],docx:r,googleDocs:r,dropbox:r,quip:["text/html",i],workflowy:["text/plain"],confluence:["application/zip"],genericImporter:["application/zip"],pdf:["application/pdf"]},a=Object.keys(n)},515187:(e,t,o)=>{o.d(t,{w:()=>i});o(296540);const r={viewBox:"0 0 16 16",fittedViewBox:"3.17 0.97 9.66 14.06",svg:(0,o(474848).jsx)("path",{d:"M8.442 1.158a.625.625 0 0 0-.884 0l-4.2 4.2a.625.625 0 0 0 .884.884L8 2.484l3.758 3.758a.625.625 0 0 0 .884-.884L8.445 1.16zm4.2 8.6a.625.625 0 0 0-.884 0L8 13.516 4.242 9.758a.625.625 0 1 0-.884.884l4.2 4.2c.244.244.64.244.884 0l.005-.005 4.195-4.195a.625.625 0 0 0 0-.884"})},i=(0,o(340498).wt)("arrowChevronDoubleUpAndDownSmall",r)},566910:(e,t,o)=>{o.d(t,{e:()=>n});o(296540);var r=o(474848);const i={viewBox:"0 0 20 20",fittedViewBox:"0.97 2.72 18.06 14.56",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M3.893 2.875a.626.626 0 0 1 .79-.02l.092.088.126.146.016.035.072.105 11.273 13.15a.624.624 0 0 1-1.036.678l-1.615-1.884c-1.12.408-2.339.633-3.611.633-3.757 0-7.049-1.946-8.707-4.843l-.155-.283a1.46 1.46 0 0 1 0-1.359l.155-.283c.89-1.554 2.249-2.835 3.898-3.688L3.826 3.757l-.072-.105a.626.626 0 0 1 .14-.777M6.031 6.33c-1.564.744-2.842 1.913-3.653 3.33l-.134.243a.21.21 0 0 0 0 .197l.134.243c1.426 2.49 4.292 4.214 7.622 4.214.958 0 1.877-.144 2.734-.406l-1.1-1.284a3.3 3.3 0 0 1-1.634.438l-.17-.004a3.307 3.307 0 0 1-3.132-3.133l-.004-.17c0-.777.269-1.492.718-2.056zm2.904 3.387q-.037.135-.038.281a1.104 1.104 0 0 0 1.218 1.097zM10 4.194c3.878 0 7.26 2.075 8.862 5.127l.074.164c.125.332.125.7 0 1.032l-.074.163a9.3 9.3 0 0 1-2.987 3.327l-.82-.955c1.15-.764 2.084-1.779 2.7-2.953l.02-.048a.2.2 0 0 0 0-.1l-.02-.049C16.382 7.282 13.438 5.445 10 5.445q-.705 0-1.378.1l-.94-1.098A10.7 10.7 0 0 1 10 4.194"}),(0,r.jsx)("path",{d:"M10.17 6.694a3.307 3.307 0 0 1 3.136 3.303l-.005.17a3.3 3.3 0 0 1-.116.702L9.624 6.713A3 3 0 0 1 10 6.691z"})]})},n=(0,o(340498).wt)("eyeSlash",i)},609316:(e,t,o)=>{o.d(t,{V:()=>r});const r=(0,o(583835).Dv)("importFile")},649320:(e,t,o)=>{o.d(t,{G:()=>u});o(296540);var r=()=>o(56366),i=()=>o(401497),n=()=>o(416504),a=()=>o(792071),s=()=>o(69708),l=()=>o(284371),c=()=>o(697650),d=()=>o(265665),p=()=>o(187820),m=o(474848);function u({collectionStore:e,hideCollectionViewBlockIcon:t}){const o=(0,s().tz)(),u=(0,c().useCollectionNameOrDefault)(e),{collectionIcon:f,collectionViewBlockStore:g}=(0,r().K8)((()=>({collectionIcon:e.getIcon(),collectionViewBlockStore:e.getParentCollectionViewBlockStore()})),[e]),y=(0,r().K8)((()=>!(null!=g&&g.hasSingleSourceAndNoLinkedCollections())),[g]),h=(0,r().K8)((()=>({title:(null==g?void 0:g.getRenderTitleWithPlaceholder({userTimeZone:(0,n().P)(),intl:o}))??o.formatMessage(a().zgg.messages.untitled),icon:null==g?void 0:g.getIcon()})),[g,o]),v=(0,i().IS)((e=>({container:{display:"flex",alignItems:"center",gap:8,flex:1,minWidth:0,overflow:"hidden"},pathDivider:{color:e.text.tertiary},collectionViewBlockTitle:{...l().RC,minWidth:50,flexShrink:1,flexGrow:1,flexBasis:0,maxWidth:"fit-content"},collectionName:{...l().RC,flexShrink:1,minWidth:100},blockTooltipTitle:{maxWidth:200}})),[]);return(0,m.jsxs)("div",{style:v.container,children:[y?(0,m.jsxs)(m.Fragment,{children:[t?void 0:(0,m.jsx)(p().B6,{icon:h.icon,iconRecordCategory:"collectionViewBlock",size:20,disabled:!0,isEmptyPage:!1}),(0,m.jsx)("span",{style:v.collectionViewBlockTitle,children:(0,m.jsx)(d().j,{tooltipStyle:v.blockTooltipTitle,children:h.title})}),(0,m.jsx)("span",{style:v.pathDivider,children:"/"})]}):void 0,(0,m.jsx)(p().B6,{icon:f,iconRecordCategory:"collection",size:20,disabled:!0,isEmptyPage:!0}),(0,m.jsx)("span",{style:v.collectionName,children:u})]})}},672616:(e,t,o)=>{o.d(t,{m:()=>r});const r=(0,o(69708).YK)({csv_import_inconsistent_columns:{id:"csvImportErrors.inconsistentColumns.message",defaultMessage:"Inconsistent number of columns in CSV file, {numBadRows} rows had problems. Header row had {numTitleColumns} columns. Row {firstBadRowIndex} was first inconsistent row with {firstBadRowLength} columns. Parsed row {firstBadRowIndex}: {firstBadRow}"}})},754199:(e,t,o)=>{function r(e){return/^(\+\d{1,2}[\s.-])?\(?\d{3}\)?[\s.-]\d{3}[\s.-]\d{4}$/.test(e)}function i(e){return/^[0-9 .()\-\+]{7,}$/.test(e)}o.d(t,{W:()=>r,e:()=>i})}}]);