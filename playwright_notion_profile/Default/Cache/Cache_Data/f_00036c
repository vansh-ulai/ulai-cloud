"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[22542,63053,65741],{8802:(e,t,o)=>{o.d(t,{d:()=>d});o(296540);var n=()=>o(484714),r=()=>o(56366),i=()=>o(764880),a=()=>o(53528),l=()=>o(69708),s=()=>o(125565),c=o(474848);function d(e){const{getRecordModel:t,actorPointer:o,lastVerifiedDate:d}=e,u=(0,n().Y0)(),p=(0,l().tz)(),m=(0,r().K8)((()=>(0,i().lR)(p,(0,i().xC)({pointer:o,getRecordModel:t}))),[t,p,o]);return(0,c.jsxs)("div",{style:{padding:"8px 14px"},children:[(0,c.jsx)(s().A,{isSmall:!0,isSecondaryColor:!0,isMobile:u.isMobile,isMultiline:!0,style:{marginBottom:4},children:(0,c.jsx)(l().sA,{defaultMessage:"Last verified by {user}",id:"VerificationMetadata.lastVerified",values:{user:m}})}),(0,c.jsx)(s().A,{isSmall:!0,isSecondaryColor:!0,isMobile:u.isMobile,children:(0,a().OH)({dateTime:d,intl:p})})]})}},22102:(e,t,o)=>{o.d(t,{k:()=>n});const n=new(o(645873).O2)("isTemplate",(async()=>await o.e(6993).then(o.bind(o,826880))))},33050:(e,t,o)=>{o.d(t,{P:()=>i});var n=()=>o(645873);const r=new(n().O2)("topbarMoreMenu",(async()=>await Promise.all([o.e(75134),o.e(99223),o.e(9304),o.e(9773),o.e(36556),o.e(40537),o.e(55373),o.e(36192),o.e(71562),o.e(96346),o.e(44711),o.e(53321),o.e(90825),o.e(16471),o.e(37353),o.e(29151),o.e(87248),o.e(62475),o.e(3151),o.e(98629),o.e(58550),o.e(67539),o.e(42838),o.e(22900),o.e(27634),o.e(85128),o.e(49889),o.e(20108),o.e(95555),o.e(87249),o.e(71621),o.e(92845),o.e(56369),o.e(2411),o.e(89296),o.e(46414),o.e(9294),o.e(11676),o.e(91256),o.e(40563),o.e(67494),o.e(44584),o.e(53141),o.e(4422),o.e(4330),o.e(55162),o.e(71003),o.e(55753),o.e(28866),o.e(22001),o.e(71386),o.e(4351),o.e(6331),o.e(69144),o.e(42660),o.e(55997),o.e(40828),o.e(12341),o.e(96402),o.e(84166),o.e(70359),o.e(29595),o.e(16448),o.e(10442),o.e(16434),o.e(45769),o.e(46080),o.e(75902),o.e(99809),o.e(58636),o.e(78405),o.e(33675),o.e(74562),o.e(47160),o.e(37384),o.e(91598),o.e(48046),o.e(3259),o.e(13955),o.e(42056),o.e(3165),o.e(76677),o.e(31842),o.e(43223),o.e(45147),o.e(15517),o.e(94995),o.e(98339),o.e(55639),o.e(1966),o.e(35738),o.e(6642),o.e(55776),o.e(51444),o.e(21727),o.e(58209),o.e(13297),o.e(4802),o.e(65197),o.e(81768),o.e(94300),o.e(62032),o.e(72122),o.e(32487),o.e(28058),o.e(90638),o.e(75422),o.e(97859),o.e(50856),o.e(65014),o.e(49175),o.e(36359),o.e(2752),o.e(11571),o.e(92924),o.e(42525),o.e(25204),o.e(52273),o.e(52986),o.e(45732),o.e(46817),o.e(70442),o.e(28656),o.e(37160),o.e(30443),o.e(9426),o.e(76690),o.e(63248),o.e(39457),o.e(21912),o.e(80668),o.e(12507),o.e(6626),o.e(26497),o.e(61016),o.e(91629),o.e(61858),o.e(63053),o.e(34399),o.e(89379),o.e(34974),o.e(75332),o.e(95103),o.e(75681)]).then(o.bind(o,444393)))),i=(0,n()._h)(r,(e=>e.TopbarMoreMenu))},51493:(e,t,o)=>{o.d(t,{q:()=>i,y:()=>a});var n=()=>o(564884),r=()=>o(534177);function i(e){const{environment:t,blockStore:o,update:i}=e,a=function(e){switch(e){case"add":return"page_verification_enabled";case"update":return"page_verification_edited";case"remove":return"page_verification_disabled";default:(0,r().HB)(e)}}(i.metadata.action),l=o.id,s=o.getAssociatedCollectionId(),c=o.getSpaceId(),d=i.metadata.entrypoint;let u=s?"db":"non_db";if(s){const e=o.getAssociatedCollectionStore();null!=e&&e.isPageTreeCollection()&&(u="wiki")}"page_verification_enabled"===a&&(0,n().u)({environment:t,event:{eventName:a,eventProperties:{entrypoint:d,page_type:u,page_id:l,collection_id:s,space_id:c,expiration:i.metadata.expiration??void 0,expiration_date:i.metadata.expiration_date??void 0}}}),"page_verification_edited"===a&&(0,n().u)({environment:t,event:{eventName:a,eventProperties:{entrypoint:d,page_type:u,page_id:l,collection_id:s,space_id:c,expiration:i.metadata.expiration??void 0,expiration_date:i.metadata.expiration_date??void 0}}}),"page_verification_disabled"===a&&(0,n().u)({environment:t,event:{eventName:a,eventProperties:{entrypoint:d,page_type:u,page_id:l,collection_id:s,space_id:c}}})}function a(e){const{environment:t,blockStore:o,entrypoint:r,action:i}=e,a=o.id,l=o.getAssociatedCollectionId(),s=o.getSpaceId();let c=l?"db":"non_db";if(l){const e=o.getAssociatedCollectionStore();null!=e&&e.isPageTreeCollection()&&(c="wiki")}(0,n().u)({environment:t,event:{eventName:"page_verification_owner_edited",eventProperties:{entrypoint:r,page_type:c,action:i,page_id:a,collection_id:l,space_id:s}}})}},98205:(e,t,o)=>{o.d(t,{DG:()=>p,Yg:()=>d,Yx:()=>m,_N:()=>u,fY:()=>y,h8:()=>f,wG:()=>c});o(944114),o(898992),o(803949);var n=()=>o(31503),r=()=>o(500993),i=()=>o(37165),a=()=>o(131448),l=()=>o(597368),s=()=>o(237775);const c="forms_add_conditional_logic_tooltip";function d({currentModule:e,nestedModules:t,includePlaceholders:o}){const n=[{currentModule:e,depth:1}],r=[];let i=0;for(;n.length>0;){const e=n.shift();if(!e)continue;const{currentModule:l,depth:s}=e;var a;if(r.push(l),s>i&&(i=s),"formQuestion"===l.type)null===(a=l.conditionalGroups)||void 0===a||a.forEach((e=>{const r=e.children??[];for(const i of r){const e=t[i];e&&("formQuestion"===e.type||o&&"placeholder"===e.type)&&n.push({currentModule:e,depth:s+1})}}))}return{formQuestionDescendants:r,maxDepth:i}}function u(e,t,o){if(!e)return;const n=(0,r().A)(e,t.getModules());if(!n)return;const a=s().c.createChildStore(t,{table:i().lo,id:n.module.formQuestionId,spaceId:t.getSpaceId()??""}).getPropertyId();if(!a)return;const l=o.getSchema()[a],c=null==l?void 0:l.type;return"select"===c||"multi_select"===c||"checkbox"===c?c:void 0}function p({mouseEntered:e,currentQuestionModule:t,modulesByArea:o,featureAvailable:r,inputFocused:i,isDragging:a,showTutorialTooltip:l}){if(void 0===o)return!1;const s=(0,n().Cg)({moduleId:null==t?void 0:t.id,modulesByArea:o}).length>=n().mh,c=(e||l)&&!s&&!i&&!a;return c}function m(e){const{formQuestionId:t,formAddConditionalLogicTooltipStore:o}=e;if(l().A.state.open||!t||!o)return!1;if("multi_select"===e.type){const n=e.optionValue;if(!n||o.state.openTooltip!==y({formQuestionId:t,optionValue:n}))return!1}else if(o.state.openTooltip!==y({formQuestionId:t}))return!1;return a().default.isVisible(c)}function y({formQuestionId:e,optionValue:t}){return t?`fqid:${e} value:${t}`:`fqid:${e}`}function f(e,t){return`${e}:${t}`}},103674:(e,t,o)=>{o.d(t,{A:()=>r});class n extends(()=>o(757695))().Store{getInitialState(){return{permissionsInviteStore:(0,o(406999)._P)(),contextualInviteStore:new(o(159026).Ay)}}get stage(){return this.state.contextualInviteStore.state.inviteStage}}const r=n},136805:(e,t,o)=>{o.r(t),o.d(t,{TopbarShareButton:()=>O,messages:()=>w});var n=o(296540),r=()=>o(726637),i=()=>o(56366),a=()=>o(401497),l=()=>o(929219),s=()=>o(631524),c=()=>o(328347),d=()=>o(864896),u=()=>o(69708),p=()=>o(100622),m=()=>o(904671),y=()=>o(38337),f=()=>o(553965),g=()=>o(321172),h=()=>o(623275),v=()=>o(437487),b=()=>o(326589),S=()=>o(406699),x=()=>o(35392),C=()=>o(859428),k=()=>o(21140),A=()=>o(978578),M=()=>o(863059),I=o(474848);const w=(0,u().YK)({share:{defaultMessage:"Share",id:"topbar.share"}});function T({store:e,buttonPopupStore:t}){const l=(0,o(484714).v3)(),{isMobile:s,isTablet:c}=(0,i().K8)((()=>({isMobile:r().A.isMobile,isTablet:l.device.isTablet})),[l]),d=(0,i().uB)(void 0,o(103674).A),u=(0,i().uB)(void 0,o(529183).Ay),p=(0,i().uB)(void 0,o(454354).A),y=(0,i().K8)((()=>function(e,t){if(t.shouldUserHaveAccessToPrivatePageBlock()&&t.state.changePermissionsEnabled&&t.state.privatePageStore&&t.state.privatePageStore.id===e.id)return t.state.privatePageStore;return e}(e,p)),[e,p]),f=(0,i().K8)((()=>e.canAdmin()),[e]),x=(0,i().K8)((()=>!s&&function(e,t){const{permissionsInviteStore:o}=e.state;return o.state.inviteTargets.length>0||t.state.inviteTargets.length>0}(d,u)),[u,s,d]),C=(0,i().K8)((()=>{var e;return null===(e=p.state.privatePageStore)||void 0===e?void 0:e.id}),[p]),k=(0,i().O$)(o(765957).AppStoreSidebarSpaceStore);(0,n.useEffect)((()=>{!function({environment:e,store:t,sudoModeStore:o,canAdmin:n,currentSpaceStore:r}){var i;null!==(i=o.state.privatePageStore)&&void 0!==i&&i.id&&o.state.privatePageStore.id!==t.id&&o.reset();n||m().BX({environment:e,sudoModeStore:o,pageBlockId:t.id,sidebarSpaceStore:r})}({environment:l,sudoModeStore:p,store:e,canAdmin:f,currentSpaceStore:k})}),[f,l,e,p,C,k]),(0,n.useEffect)((()=>{v().Ay.setState({...v().Ay.state,isInitialized:!0})}));const{isOnGettingStartedPage:A}=(0,o(978510).R)(),M=(0,n.useCallback)((()=>{t.reset()}),[t]),w=(0,n.useCallback)((()=>{_({buttonPopupStore:t,universalMemberInviteStore:d,inviteTargetsStore:u}),o(778417).IU({environment:l}),g().Tk({environment:l,store:e}),(0,b().g)()||o(224701).x(l)}),[t,d,u,l,e]),T=(0,i().K8)((()=>{const t=e.getPublicPermission();if(!t||!(0,o(68263).W8)(t))return!1;const n=e.getSpaceStore();return!!n&&n.getSettings().hide_sites_banner}),[e]),j=(0,n.useCallback)((e=>(0,I.jsx)(P,{buttonPopupEvents:e,handleClick:w,shouldShowGlobeIcon:T,disabled:A})),[w,T,A]),O=(0,n.useCallback)((async()=>{if(u.state.inviteTargets.length>0){return void(await g().T({environment:l,inviteTargetsStore:u})&&(g().XP({environment:l,store:e}),_({buttonPopupStore:t,universalMemberInviteStore:d,inviteTargetsStore:u})))}const{permissionsInviteStore:n}=d.state;"invitee"===n.state.inputFocus&&n.setState({...n.state,inputFocus:"none"});await(0,o(743260).iQ)({environment:l,permissionsInviteStoreState:n.state,from:"share_menu"})||(g().XP({environment:l,store:e}),_({buttonPopupStore:t,universalMemberInviteStore:d,inviteTargetsStore:u}))}),[t,l,u,d,e]),B=(0,a().IS)((e=>({buttonPopup:{...s?{width:"100%"}:c?{width:460}:{width:h().$D,overflow:"hidden",borderRadius:h().Sg,boxShadow:e.shadowMD}}})),[s,c]);return(0,I.jsx)(S().A,{popupType:s?S().z.SlideUp:S().z.Popup,forceInitialInbound:!0,buttonPopupStore:t,renderOrigin:j,originGap:s?void 0:8,alignmentToOrigin:"end",style:B.buttonPopup,onClick:w,render:()=>(0,I.jsx)(o(482707).k,{buttonPopupStore:t,sudoModeStore:p,store:y,inviteTargetsStore:u,universalMemberInviteStore:d,onUpgradeButtonClick:M,location:s?"topbar_mobile":"topbar_share_button",onClose:O}),disabled:A,persistOnClose:x,onDismiss:O,onClose:O})}function P({buttonPopupEvents:e,handleClick:t,shouldShowGlobeIcon:o,disabled:s}){const c=!(0,i().O$)(l().e),d=(0,i().K8)((()=>(0,b().g)()),[]),p=(0,a().IS)((e=>({shortcut:{color:e.text.inverseSecondary}})),[]),m=s||c,y=(0,n.useCallback)((()=>{const e=c?(0,I.jsx)(u().sA,{defaultMessage:"Unavailable while offline",id:"topbar.shareButton.offlineTooltip"}):(0,I.jsx)(u().sA,{defaultMessage:"Create or join a workspace to share",id:"topbar.shareButton.createOrJoinWorkspaceTooltip"});return m?e:(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("div",{children:d?(0,I.jsx)(u().sA,{defaultMessage:"Share",id:"topbar.shareButton.tooltipAWTL"}):(0,I.jsx)(u().sA,{defaultMessage:"Share or publish to the web",id:"topbar.shareButton.tooltip"})}),(0,I.jsx)(x().A,{style:p.shortcut,name:"openShareMenu"})]})}),[d,p.shortcut,m,c]);return(0,I.jsx)(C().A,{disableTooltip:r().A.isMobile,renderTooltip:y,placement:"bottom",delayThreshold:400,render:n=>(0,I.jsx)(j,{events:(0,f().A)(n,e),handleClick:t,disabled:m,shouldShowGlobeIcon:o})})}function j({events:e,handleClick:t,disabled:o,shouldShowGlobeIcon:n}){const i=r().A.isMobile,l=(0,u().tz)(),m=(0,a().IS)((e=>{const t=(0,A().aD)(e),o=(0,M().Hh)(e);return{mobileIconStyle:t.iconStyle,globeIconStyle:{...o.icon,fill:p().Tj.blue,paddingInlineEnd:4},shareButton:{...i?t.iconContainer:{marginInlineEnd:o.iconButton.marginInlineEnd,marginInlineStart:6}}}}),[i]);const f=i?(0,d().Y)(m.mobileIconStyle):(0,I.jsxs)(k().Ye,{alignItems:"center",children:[n?(0,c().h)(m.globeIconStyle):void 0,(0,I.jsx)(u().sA,{defaultMessage:"Share",id:"topbar.shareButton.title"})]});return(0,I.jsx)(s().p,{id:void 0,className:y().voG,...e,style:m.shareButton,"aria-label":l.formatMessage(w.share),disabled:o,disabledFeedback:o,onClick:t,children:f})}function _({buttonPopupStore:e,universalMemberInviteStore:t,inviteTargetsStore:o}){e.reset(),t.reset(),o.reset()}const O=n.memo(T)},160095:(e,t,o)=>{o.d(t,{i8:()=>m,VW:()=>y,fr:()=>h,Ox:()=>f,LI:()=>g});var n=o.n(o(794148)),r=()=>o(534177),i=(o(898992),o(354520),o(581454),()=>o(165358)),a=()=>o(229833),l=()=>o(559506);o(16280);var s=()=>o(496603);const c=new(o(754869).aH)({apiKey:o(726637).A.google.mapsApiKey,version:"weekly"});let d;async function u(){const e=await c.importLibrary("places");return d||(d=new e.AutocompleteSessionToken),e}async function p(e){var t,o;const{latitude:n,longitude:r}=e,l=new((await async function(){return await c.importLibrary("geocoding")}()).Geocoder);let s;try{var d;s=null===(d=(await l.geocode({location:{lat:n,lng:r}})).results)||void 0===d?void 0:d[0]}catch(u){i().log({level:"error",from:"GoogleLocationService",type:"getGoogleLocationWithReverseGeocoding",error:(0,a().convertErrorToLog)(u)})}return{lat:n,lon:r,address:null===(t=s)||void 0===t?void 0:t.formatted_address,googlePlaceId:null===(o=s)||void 0===o?void 0:o.place_id}}function m(e){return`https://www.google.com/maps/search/?api=1&query=${s().oE([e.name,e.address]).map((e=>encodeURIComponent(e))).join(",")}`}async function y(e,t,o,s){switch(t){case"google":return async function(e,t){const o={input:e,sessionToken:d,locationBias:t?{lat:t.latitude,lng:t.longitude}:void 0},n=await u(),{suggestions:r}=await n.AutocompleteSuggestion.fetchAutocompleteSuggestions(o);return r.filter((e=>{var t;return null===(t=e.placePrediction)||void 0===t?void 0:t.placeId})).map((e=>{var t,o,n;const r=null===(t=e.placePrediction)||void 0===t?void 0:t.placeId;if(!r)throw new Error("Place ID unexpectedly missing after filter");return{type:"google",title:(null===(o=e.placePrediction)||void 0===o||null===(o=o.text)||void 0===o?void 0:o.toString())||"",address:(null===(n=e.placePrediction)||void 0===n||null===(n=n.text)||void 0===n?void 0:n.toString())||"",googlePlaceId:r}}))}(e,s);case"aws":return async function(e,t,o){try{const r=await l().callApi({eventName:"getLocationSuggestions",environment:t,data:{text:e,biasPosition:o}});return r&&"success"===r.type?r.data.suggestions.filter((e=>e.placeId)).map((e=>(n()(e.placeId),{type:"aws",title:e.title||"",address:e.address||"",awsPlaceId:e.placeId}))):[]}catch(r){return i().log({level:"error",from:"AwsLocationService",type:"getAwsLocationSuggestions",error:(0,a().convertErrorToLog)(r)}),[]}}(e,o,s);default:(0,r().HB)(t)}}async function f(e,t,o){n()(e.type===t,`Suggestion type "${e.type}" doesn't match provided service "${t}"`);const s=e.type;switch(s){case"google":return async function(e){try{var t,o;const n=new((await u()).Place)({id:e});return await n.fetchFields({fields:["location","displayName","formattedAddress","id"]}),{lat:(null===(t=n.location)||void 0===t?void 0:t.lat())??0,lon:(null===(o=n.location)||void 0===o?void 0:o.lng())??0,name:n.displayName||void 0,address:n.formattedAddress||void 0,googlePlaceId:n.id}}catch(n){return void i().log({level:"error",from:"GoogleLocationService",type:"getGooglePlace",error:(0,a().convertErrorToLog)(n)})}}(e.googlePlaceId);case"aws":return async function(e,t){try{const o=await l().callApi({eventName:"getPlace",environment:t,data:{placeId:e}});if(!o||"success"!==o.type||!o.data.place)return;return o.data.place}catch(o){return void i().log({level:"error",from:"AwsLocationService",type:"getAwsPlace",error:(0,a().convertErrorToLog)(o)})}}(e.awsPlaceId,o);default:(0,r().HB)(s)}}function g(e){const t=e.type;switch(t){case"google":return e.googlePlaceId;case"aws":return e.awsPlaceId;default:(0,r().HB)(t)}}async function h(e,t,o){switch(t){case"google":return p(e);case"aws":return async function(e,t){const{latitude:o,longitude:n}=e;try{const e=await l().callApi({eventName:"getLocationWithReverseGeocoding",environment:t,data:{latitude:o,longitude:n}});return e&&"success"===e.type&&e.data.place?e.data.place:{lat:o,lon:n}}catch(r){return i().log({level:"error",from:"AwsLocationService",type:"getAwsLocationWithReverseGeocoding",error:(0,a().convertErrorToLog)(r)}),{lat:o,lon:n}}}(e,o);default:(0,r().HB)(t)}}},180332:(e,t,o)=>{o.d(t,{C4:()=>qo,IB:()=>yn,_H:()=>Mn});o(18107),o(944114),o(967357),o(898992),o(354520),o(672577),o(581454),o(737550);var n=o(296540),r=()=>o(726637),i=()=>o(908006),a=()=>o(484714),l=()=>o(792485),s=()=>o(56366),c=()=>o(401497),d=()=>o(929219),u=()=>o(988083),p=()=>o(252291),m=()=>o(998531),y=()=>o(396896),f=()=>o(631524),g=()=>o(66689),h=()=>o(700500),v=()=>o(998687),b=()=>o(443239),S=()=>o(31503),x=()=>o(898244),C=()=>o(713998),k=()=>o(452540),A=()=>o(597777),M=()=>o(448801),I=()=>o(116089),w=()=>o(96330),T=()=>o(179034),P=()=>o(519831),j=()=>o(437607),_=()=>o(201980),O=()=>o(931075),B=()=>o(69708),F=()=>o(496603),R=()=>o(534177),E=()=>o(284371),D=()=>o(720665),L=()=>o(299709),V=()=>o(559926),N=()=>o(193722),U=()=>o(557281),W=()=>o(44729),z=()=>o(384944),K=()=>o(899453),H=()=>o(733326),X=()=>o(319975),$=()=>o(231297),Y=()=>o(312540),q=()=>o(465364),Q=()=>o(908201),G=()=>o(724456),J=()=>o(797535),Z=()=>o(312296),ee=()=>o(33791),te=()=>o(116008),oe=()=>o(135221),ne=()=>o(417392),re=()=>o(125565),ie=()=>o(522419),ae=()=>o(901389),le=()=>o(383594),se=()=>o(892632),ce=()=>o(722872),de=()=>o(663173),ue=()=>o(274652),pe=()=>o(439264),me=()=>o(805751),ye=()=>o(404277),fe=()=>o(45552),ge=()=>o(89924),he=()=>o(304740),ve=()=>o(641007),be=()=>o(767499),Se=()=>o(437219),xe=()=>o(161773),Ce=()=>o(35622),ke=()=>o(465741);class Ae extends(()=>o(757695))().Store{getInitialState(){return{open:!1}}}const Me=Ae;var Ie=()=>o(911706),we=()=>o(760217),Te=()=>o(406699),Pe=()=>o(623580),je=()=>o(939740),_e=()=>o(360083),Oe=o(474848);function Be(e){const{disabled:t,store:o,name:r,url:i,onChange:l,onDelete:d}=e,u=he().rS({url:e.url}),m=(0,n.useRef)(null),y=(0,a().v3)(),{device:f}=y,g=(0,s().uB)(void 0,Me),h=(0,s().O$)(g),v=(0,n.useCallback)((e=>{if(!h.open)return;g.setState({...h,inputValue:e});const t=ie().SB({title:e,source:i});l({url:i,name:t})}),[g,h,l,i]),b=(0,n.useCallback)((()=>{g.setState({open:!0,inputValue:r})}),[g,r]),S=(0,n.useCallback)((()=>{g.setState({open:!1})}),[g]),x=(0,n.useCallback)((()=>{d(i)}),[d,i]),C=(0,n.useCallback)((()=>{const e=()=>{Se().uR(y,{url:i,from:"FilePropertyMenuItem"}),xe().KE(y,{url:i,download:!0,downloadName:r,permissionRecord:o.pointer})};o.getCreatedById()===ve().xY.id?(0,ke().TW)({propertyType:"file",onConfirm:e}):e()}),[y,r,i,o]),k=(0,n.useCallback)((()=>{xe().OG(y,{url:i,type:"file",from:"view_original",downloadName:r,permissionRecord:o.pointer})}),[y,r,o.pointer,i]),A=(0,n.useCallback)((()=>{if(!m.current)return;const e=m.current.getBoundingClientRect(),t=e.width/e.height;Ce().o9({environment:y,renderFullScreenNode:()=>(0,Oe.jsx)(_e().A,{url:i,isAuthenticated:!0,permissionRecord:o.pointer,width:window.innerWidth,render:(e,t)=>(0,Oe.jsx)("img",{src:t,style:{position:"relative",maxHeight:"100%",maxWidth:"100%",margin:0,alignSelf:"center",width:"100%"}})}),fullScreenNodeRect:e,contentAspectRatio:t,blockStore:o,imageUrl:i})}),[y,o,i]),M=(0,n.useCallback)((()=>{if(h.open)return(0,Oe.jsx)(Ee,{url:e.url,inputValue:h.inputValue,isOpen:h.open,handleFileRename:v,handleCloseRenamePopover:S})}),[h,S,v,e.url]),I=(0,c().IS)((()=>({imageInner:{display:"block",maxWidth:"100%",maxHeight:180,cursor:"zoom-in"},imageInnerWrapper:{flex:"auto",overflow:"hidden"}})),[]),w=(0,Oe.jsx)(Fe,{fileIsImage:u,fileUrl:i,disabled:t,handleOpenFullscreenPreviewOfFile:A,handleDownloadFile:C,handleViewOriginalFile:k,handleOpenRenamePopover:b,handleDeleteFile:x});return u?(()=>{const o=(0,Oe.jsx)(_e().A,{url:i,isAuthenticated:!0,permissionRecord:e.store.pointer,width:300,render:(e,t)=>(0,Oe.jsx)("div",{style:I.imageInnerWrapper,children:(0,Oe.jsx)("img",{src:t,style:I.imageInner,onClick:A,ref:m})})}),n={paddingTop:f.isMobile?12:8,paddingBottom:f.isMobile?12:8,alignItems:"flex-start"};return(0,Oe.jsx)(we().A,{focused:!1,showDragHandle:!t&&!f.isMobile,style:n,title:o,right:w,dontShrinkRight:!0})})():(()=>{const t=(0,Oe.jsx)(we().A,{focused:!1,showDragHandle:!e.disabled&&!f.isMobile,onClick:k,title:r,icon:(0,Oe.jsx)(p().I,{icon:be().B}),right:w,dontShrinkRight:!0});return(0,Oe.jsx)(ne().Ay,{open:h.open,popupType:f.isMobile?Te().z.SlideUp:Te().z.Popup,origin:t,render:M,onDismiss:S})})()}function Fe(e){const{disabled:t,fileIsImage:o,fileUrl:r,handleOpenFullscreenPreviewOfFile:i,handleDownloadFile:l,handleViewOriginalFile:s,handleOpenRenamePopover:c,handleDeleteFile:d}=e,u=(0,a().v3)(),{isMobile:p}=u.device,m=(0,n.useCallback)((e=>(0,Oe.jsx)(Ie().A,{isMobile:p,...e})),[p]),y=(0,n.useCallback)((e=>(0,Oe.jsx)(Re,{fileIsImage:o,fileUrl:r,disabled:t,parent:e,handleOpenFullscreenPreviewOfFile:i,handleDownloadFile:l,handleViewOriginalFile:s,handleOpenRenamePopover:c,handleDeleteFile:d})),[o,r,t,i,l,s,c,d]);return(0,Oe.jsx)(Te().A,{popupType:p?Te().z.SlideUp:Te().z.Popup,renderOrigin:m,render:y})}function Re(e){const{parent:t,disabled:o,fileUrl:r,fileIsImage:i,handleOpenFullscreenPreviewOfFile:l,handleDownloadFile:s,handleViewOriginalFile:c,handleOpenRenamePopover:d,handleDeleteFile:u}=e,p=(0,a().v3)(),{isMobile:m,isNative:y}=p.device,f=(0,n.useMemo)((()=>{const e=[];i&&e.push({key:"fullscreen",render:e=>(0,Oe.jsx)(we().A,{...e,title:(0,Oe.jsx)(B().sA,{defaultMessage:"Full screen",id:"database.actionMenu.fileProperty.fullscreen.title"})}),action:l});return(ie()._J(r)||y)&&e.push({key:"download",render:e=>(0,Oe.jsx)(we().A,{...e,title:(0,Oe.jsx)(B().sA,{defaultMessage:"Download",id:"database.actionMenu.fileProperty.download.title"})}),action:s}),e.push({key:"original",render:e=>(0,Oe.jsx)(we().A,{...e,title:(0,Oe.jsx)(B().sA,{defaultMessage:"View original",id:"database.actionMenu.fileProperty.viewOriginal.title"})}),action:()=>c()}),o||i||e.push({key:"rename",render:e=>(0,Oe.jsx)(we().A,{...e,title:(0,Oe.jsx)(B().sA,{defaultMessage:"Rename",id:"database.actionMenu.fileProperty.rename.title"})}),action:d}),o||e.push({key:"delete",render:e=>(0,Oe.jsx)(we().A,{...e,title:(0,Oe.jsx)(B().sA,{defaultMessage:"Delete",id:"database.actionMenu.fileProperty.delete.title"})}),action:u}),e}),[o,i,r,u,l,d,c,s,y]),g=(0,n.useMemo)((()=>[{key:"section",render:e=>(0,Oe.jsx)(ge().A,{...e}),items:f}]),[f]),h=m?{menuType:ce().gu.ActionSheet}:{menuType:ce().gu.Popup,width:200};return(0,Oe.jsx)(ye().A,{...h,children:(0,Oe.jsx)(je().Ay,{type:je().Oh.Vertical,initialFocus:0,onAccept:t.close,sections:g})})}function Ee(e){const{url:t,handleFileRename:o,handleCloseRenamePopover:r,isOpen:i,inputValue:l}=e,s=(0,a().v3)(),{device:d}=s,u=(0,n.useCallback)((e=>{const t=e.target.value;o(t)}),[o]),p=(0,c().IS)((e=>({renameInputWrapper:{display:"flex",alignItems:"center",color:e.text.primary,fontSize:"13px",padding:"4px 8px"},renameInput:{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingInlineStart:10,paddingInlineEnd:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}})),[]),m=d.isMobile?{menuType:ce().gu.ActionSheet}:{menuType:ce().gu.Popup,width:380};return i?(0,Oe.jsx)(ye().A,{...m,children:(0,Oe.jsx)("div",{style:p.renameInputWrapper,children:(0,Oe.jsx)(Pe().A,{style:p.renameInput,value:l,placeholder:ie().Jt(t),onChange:u,onSubmit:r,focusInitial:!0,selectAll:!0})})}):null}const De=function(e){return(0,Oe.jsx)(o(678553).Ay,{title:(0,Oe.jsxs)("div",{style:{display:"flex"},children:[(0,Oe.jsx)(o(98126).A,{style:{marginTop:1,marginInlineEnd:6}}),e.progressPercent?(0,Oe.jsx)(o(773382).A,{percentage:e.progressPercent}):e.progressText?(0,Oe.jsx)("span",{children:e.progressText}):null]})})};function Le(e){const{store:t,uploadFiles:o,value:i,disabled:l,onChange:c,onDismiss:d}=e,u=Ve(i),p=(0,a().v3)(),m=(0,B().tz)(),y=(0,n.useRef)(),f=(0,n.useRef)(null),g=(0,s().uB)(void 0,de().A),{isLoading:h,progressPercent:v,progressText:b}=(0,s().O$)(g),S=(0,n.useCallback)((e=>{g.setState({isLoading:!0,progressPercent:0}),y.current=e}),[g]),x=(0,n.useCallback)((e=>{const{progressPercent:t,progressText:o}=e;g.setState({...g.state,progressPercent:t,progressText:o})}),[g]),C=(0,n.useCallback)((e=>{if(!y.current)return;const t=y.current.map(((t,o)=>{const n=e[o];return{name:t.name||n,url:n}}));c({value:[...t,...i]}),g.reset()}),[g,c,i]),k=(0,n.useCallback)((()=>{g.reset(),ae().f1((0,Oe.jsx)(B().sA,{id:"filePropertyMenu.uploadFileFailedError.message",defaultMessage:"Upload failed."}))}),[g]),A=(0,n.useCallback)((e=>{le().I(),g.setState({isLoading:!0,progressPercent:0}),y.current=[e]}),[g]),M=(0,n.useCallback)((e=>{if(!y.current)return;const t=y.current[0];if(!t)return;const o={name:t.name||e,url:e};c({value:[...i,o]}),g.reset(),le().I()}),[g,c,i]),I=(0,n.useCallback)((e=>{const{originUrl:t,pastedSecureFile:o}=e,n={name:t,url:o?(0,ie().xm)(o):t};c({value:[...i,n],pastedSecureFile:o}),g.reset(),le().I()}),[g,c,i]),w=(0,n.useCallback)((()=>{const e=f.current;e&&e instanceof Element&&le().W(p,{originRect:e.getBoundingClientRect(),originGap:3,isSmallWidth:!0,showArrow:!0,title:m.formatMessage({id:"filePropertyMenu.header",defaultMessage:"File"}),currentTab:"file",tabs:[{type:"file",fileUpload:!0,imageUpload:!1,videoUpload:!1,onUpload:e=>{se().QM({environment:p,file:e[0],bucket:"secure",record:t.pointer,isFileBlock:!1,reportRichUploadMetrics:!0,onStart:A,onProgress:x,onComplete:M,onError:k})}},{type:"embed",onChange:I}]})}),[p,I,M,A,k,x,t.pointer,m]),T=(0,n.useCallback)((()=>{w()}),[w]),P=(0,n.useCallback)((e=>{se().Zn({environment:p,files:e,bucket:"secure",record:t.pointer,isFileBlock:!1,onBatchStart:S,onBatchProgress:x,onBatchComplete:C,onBatchError:k})}),[p,t.pointer,S,x,C,k]),j=()=>{le().I()};(0,n.useEffect)((()=>(o?se().Zn({environment:p,files:o,bucket:"secure",record:t.pointer,isFileBlock:!1,onBatchStart:S,onBatchProgress:x,onBatchComplete:C,onBatchError:k}):Ve(i)&&!r().A.isMobile&&w(),j)),[]);const _=r().A.isMobile?{menuType:ce().gu.Modal,title:(0,Oe.jsx)(B().sA,{defaultMessage:"File property",id:"database.fileProperty.mobileMenu.title"}),right:(0,Oe.jsx)(fe().DoneMenuText,{}),onClickRight:d}:{menuType:ce().gu.Popup};return(0,Oe.jsx)(me().A,{debugName:"FilePropertyMenu",capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!0,children:(0,Oe.jsxs)(ye().A,{..._,children:[(0,Oe.jsx)(ze,{value:i,disabled:l,store:t,onChange:c,onDropFile:P}),(0,Oe.jsxs)(ge().A,{topBorder:!u&&!l,desktopStyle:{...u&&{paddingTop:3,paddingBottom:3}},children:[h?(0,Oe.jsx)(De,{progressPercent:v,progressText:b}):void 0,h||l?void 0:(0,Oe.jsx)(ue().o,{focused:!1,color:"secondary",onClick:T,title:(0,Oe.jsx)(B().sA,{id:"database.fileProperty.focusedLabel",defaultMessage:"Add a file or image"}),ref:f})]})]})})}function Ve(e){return 0===e.length}function Ne(e,t,o){o({value:t.map((t=>t.url===e.url?{name:e.name,url:e.url}:t))})}function Ue(e,t,o){o({value:t.filter((t=>t.url!==e))})}function We({url:e,value:t,disabled:o,store:n,onChange:i}){const a=t.find((t=>t.url===e));if(a){const e=a.url,l=a.name;return r().A.isMobile?(0,Oe.jsx)(ge().A,{children:(0,Oe.jsx)(Be,{store:n,name:l,url:e,onDelete:e=>Ue(e,t,i),onChange:e=>Ne(e,t,i),disabled:o})}):(0,Oe.jsx)(Be,{store:n,name:l,url:e,onDelete:e=>Ue(e,t,i),onChange:e=>Ne(e,t,i),disabled:o})}return null}function ze({value:e,disabled:t,store:o,onChange:i,onDropFile:a}){const l=F().oE(e.map((e=>e.url))),[s,d]=(0,n.useState)(!1),u=(0,c().IS)((e=>({dropZone:{width:"100%",outline:s?`2px solid ${e.blue.border.accentPrimary}`:void 0,borderRadius:s?8:void 0}})),[s]);return 0===l.length?null:r().A.isMobile||t?(0,Oe.jsx)(n.Fragment,{children:l.map((n=>(0,Oe.jsx)(We,{url:n,value:e,disabled:t,store:o,onChange:i},n)))}):(0,Oe.jsx)(ge().A,{children:(0,Oe.jsx)("div",{onDragOver:e=>{e.preventDefault(),e.dataTransfer.dropEffect="copy",d(!0)},onDragLeave:e=>{e.preventDefault(),d(!1)},onDrop:e=>{e.preventDefault(),d(!1);const t=Array.from(e.dataTransfer.files);a(t)},style:u.dropZone,children:(0,Oe.jsx)(pe().Ay,{direction:"vertical",keys:l,renderKey:n=>(0,Oe.jsx)(We,{url:n,value:e,disabled:t,store:o,onChange:i}),onDrop:t=>function(e,t,o){t({value:F().Ul(o,(t=>{const o=t.url;return o?e.indexOf(o):1/0}))})}(t,i,e),disabled:t})})})}var Ke=()=>o(51493),He=()=>o(712855),Xe=o.n(o(844751)),$e=()=>o(97294),Ye=()=>o(784892),qe=()=>o(846523),Qe=()=>o(206267),Ge=()=>o(183558),Je=()=>o(515872),Ze=()=>o(968021),et=()=>o(177618),tt=()=>o(173868),ot=()=>o(476492),nt=()=>o(267584),rt=()=>o(252833);function it(e){return(0,s().K8)((()=>{var t;return(null==e||null===(t=e.collectionStore())||void 0===t?void 0:t.isExternalSyncedCollection())??!1}),[e])}var at=()=>o(857437),lt=()=>o(838364),st=()=>o(970585),ct=()=>o(64e3),dt=()=>o(460292),ut=()=>o(673730),pt=()=>o(553965),mt=()=>o(859428),yt=()=>o(399762);const ft=n.forwardRef((function(e,t){var o;const{locked:n,option:i,actionMenuOpen:a,property:l,collectionId:s,analyticsFrom:d,onChange:u,onCloseActionMenu:p,focused:y,propertySchema:f,onOpenActionMenu:g,removeBackground:h}=e,v=(0,c().DP)();return(0,Oe.jsx)(m().N,{debugName:"SelectPropertyMenuItem",capture:a,onEnter:F().D_,children:(0,Oe.jsx)(mt().A,{renderTooltip:e=>(0,Oe.jsxs)("div",{...e,style:ut().Q$,children:[(0,Oe.jsx)("div",{children:i.value}),(0,Oe.jsx)("div",{style:{color:v.text.inverseSecondary},children:i.description})]}),placement:"left",disableTooltip:!(null!==(o=i.description)&&void 0!==o&&o.length),render:o=>(0,Oe.jsx)(we().A,{...(0,pt().A)(o,e),ref:t,title:(0,Oe.jsx)(yt().O,{format:r().A.isMobile?Ye().NY.Large:Ye().NY.Medium,value:i.value,color:i.color,hideTooltip:!0,showRemoveButton:!1,isSingle:!0,showEllipsis:!0,removeBackground:h}),desktopTitleStyle:{marginInlineEnd:6},isTokenTitle:!0,right:!n&&(0,Oe.jsx)(gt,{property:l,collectionId:s,analyticsFrom:d,onChange:u,onCloseActionMenu:p,actionMenuOpen:a,focused:y,option:i,propertySchema:f,onOpenActionMenu:g})})})})}));function gt({property:e,collectionId:t,analyticsFrom:n,onChange:r,onCloseActionMenu:i,actionMenuOpen:l,focused:s,option:c,propertySchema:d,onOpenActionMenu:u}){const p=(0,a().v3)(),{device:m}=p;return(0,Oe.jsx)(o(814777).h,{open:l,origin:(0,Oe.jsx)(Ie().A,{onClick:()=>u(c.value),isMobile:m.isMobile,style:{opacity:s||m.isMobile?1:0}}),option:c,propertySchema:d,property:e,collectionId:t,analyticsFrom:n,onChange:r,onClose:i})}var ht=()=>o(856952);function vt(e){const{allowMultiple:t,analyticsFrom:o,autofillExplanation:r,bulkAutofillButton:i,canConfigureCollection:l,collectionId:d,disabled:u,insertChar:p,onAccept:m,onChange:y,property:f,schema:g,value:h,additionalStores:v,surface:b,formQuestionStore:C}=e,k=(0,a().v3)(),{isMobile:A,isMobileNative:M}=(0,a().Y0)(),I=(0,n.useRef)(void 0),w=(0,Q().Ks)(),T=(0,s().uB)(void 0,st().A),[j,_]=(0,at().$)(),[O,B]=(0,n.useState)(""),[F,E]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{Tt(g,f,I),p&&B(p)}),[p,f,g]);const D=(0,n.useCallback)((e=>function(e){const{change:t,allowMultiple:o,analyticsFrom:n,collectionContextStore:r,collectionId:i,createSelectColorRef:a,environment:l,onChange:s,property:c,schema:d,setInputValue:u}=e;u("");const p=d[c];if(!p)return;if(!x().lx(p))return;const m=p.options||[];let y;if("removeToken"===t.type)y={type:"selectPropertyMenuUpdateRemoveOption",removeOption:t.removedToken};else if("addTokens"===t.type){let e;o?(e=t.newTokens,y={type:"selectPropertyMenuUpdateAddOptions",addOptions:e}):(e=t.newTokens.length>0?[t.newTokens[t.newTokens.length-1]]:[],y={type:"selectPropertyMenuUpdateReplaceOptions",options:e});const s=e.find((e=>!m.find((t=>t.value.toLowerCase()===e.toLowerCase()))));if(s){const e={id:(0,Qe().JW)(),value:s,color:a.current};let t;t="alphabetical"===p.auto_sort_options||"reverse_alphabetical"===p.auto_sort_options?[(0,et().og)({collectionId:i,property:c,propertySchema:p,newOption:e,isAscending:"alphabetical"===p.auto_sort_options})]:[{pointer:{table:P().Vl,id:i},command:"keyedObjectListAfter",path:["schema",c,"options"],args:{value:e}}],y.schemaOperations=t,Tt(d,c,a),r&&(0,N().L)(l,{...(0,ot().sl)(r),property_type:p.type,action:"select_add_option",from:n})}}else(0,R().HB)(t);if(r){const e=r.collectionStore();var f;if(e&&e.isExternalSyncedCollection())V().j2(l,{property_id:c,property_type:p.type,action:"option_select",integration:null===(f=e.getFormat())||void 0===f?void 0:f.external_collection_type,collection_id:e.id,is_notion_only_property:(0,nt().sc)({collectionStore:e,propertyId:c,propertySchema:p,isExternallyImportedAndSyncedCollection:e.isExternallyImportedAndSyncedCollection()})})}s(y)}({allowMultiple:t,analyticsFrom:o,collectionContextStore:w,collectionId:d,createSelectColorRef:I,environment:k,onChange:y,property:f,schema:g,setInputValue:B,...e})),[t,o,w,d,k,y,f,g]),L=(0,n.useCallback)((e=>{E(e)}),[]),U=(0,s().K8)((()=>{if(!(0,Je().J)(b)||!C)return!1;const e=(0,S().hm)(g[f],C.getModel());return void 0!==e&&h.length>=e}),[C,b,f,g,h]),W=it(w),z=(0,s().K8)((()=>!(0,nt().RL)({isExternallyImportedAndSyncedCollection:W,propertyId:f,collectionStore:null==w?void 0:w.collectionStore(),propertySchema:g[f]})),[W,f,w,g]),K=(0,s().K8)((()=>{var e;if(!w)return!1;const t=null===(e=w.collectionStore())||void 0===e?void 0:e.getFormat(),o=g[f];return(0,rt().dn)(t,o)}),[w,f,g]),H=(0,c().IS)((e=>({footerMessage:{padding:"8px 12px",fontSize:"12px",color:e.text.secondary,borderTop:`1px solid ${e.border.secondary}`}})),[]),X=(0,n.useMemo)((()=>{const e=g[f];if(!K||!e||!x().lx(e))return null;const t=(0,Oe.jsx)("div",{style:H.footerMessage,children:(0,Oe.jsx)(At,{environment:k,property:f,propertySchema:e,collectionContextStore:w})});return i&&t?(0,Oe.jsxs)("div",{children:[i,t]}):i||t}),[i,K,H.footerMessage,k,f,g,w]),$=g[f],Y=(0,s().K8)((()=>{if(!C||!$||!x().lx($))return!1;return"dropdown"===(0,ke().KU)({formQuestionStore:C,propertySchema:$})}),[C,$]);if(!$)return null;if(!x().lx($))return null;const q=void 0!==C?($.options||[]).map((e=>({...e,color:"default"}))):$.options||[],G=function(e,t,o,n){const r=t.map((e=>e.value));let i;if(e){i=Xe().filter(e,r).map((e=>e.original));!t.find((t=>t.value.toLowerCase()===e.toLowerCase()))&&e.trim().length>0&&o&&!n&&i.push(e.trim().replace(/,/g,""))}else i=r;return i}(O,q,l,z),J=0===G.length,Z=(0,Oe.jsx)(bt,{inputComboboxProps:j,openPropertyActionMenu:F,disabled:u,value:h,inputValue:O,handleOnTokenInputChange:D,setInputValue:B,options:q,propertySchema:$,autofillExplanation:r});let ee;return ee=A?{menuType:ce().gu.Modal,title:$.name,header:Z,footer:X,includeFixedHeaderSpacing:!0,scrollerStyle:{paddingBottom:lt().Hc}}:{menuType:ce().gu.Popup,header:Z,tokenInputHeader:!0,footer:X},u?(0,Oe.jsx)(ye().A,{...ee}):(0,Oe.jsx)(ye().A,{...ee,children:J?(0,Oe.jsx)(ge().A,{title:!l||z?(0,Oe.jsx)(St,{}):(0,Oe.jsx)(Ct,{}),children:M?(0,Oe.jsx)(ct().A,{title:(0,Oe.jsx)(St,{})}):void 0}):(0,Oe.jsx)(je().Ay,{type:je().Oh.Vertical,initialFocus:O.length>0?0:void 0,sections:[{key:1,render:e=>(0,Oe.jsx)(It,{collectionId:d,property:f,schema:g,onChange:y,canConfigureCollection:l,shouldHideCreateNewOption:z,menuListStore:T,args:e,tokens:G}),items:Pt({analyticsFrom:o,canConfigureCollection:l,collectionId:d,createSelectColorRef:I,handleOnTokenInputChange:D,handleSetOpenPropertyActionMenu:L,onChange:y,openPropertyActionMenu:F,options:q,property:f,schema:g,tokens:G,value:h,additionalStores:v,isLimitReached:U,allowMultiple:t,shouldRemoveTokenBackground:Y})}],onAccept:(e,t,o)=>{m(o)},store:T,comboboxProps:_})})}function bt({inputComboboxProps:e,openPropertyActionMenu:t,disabled:o,value:r,inputValue:i,handleOnTokenInputChange:l,setInputValue:s,options:d,propertySchema:u,autofillExplanation:p}){const{isMobile:m,isAndroid:y,isPhone:f}=(0,a().Y0)(),g=(0,B().tz)(),h=(0,n.useCallback)((e=>F().oE(r.map((t=>{const n=(0,C().jy)(e,t);if(n)return(0,Oe.jsx)(yt().O,{value:n.value,color:n.color,showRemoveButton:!o,isSingle:!0,format:m?Ye().NY.Large:Ye().NY.Medium,shouldShrink:!0,onClickRemove:()=>{l({change:{type:"removeToken",removedToken:t}})},showEllipsis:!0},n.id)})))),[o,l,r,m]),v=h(d),b=u.select_ai_inference,S=(0,c().IS)((()=>({tokenWrapStyle:{...(0,Ze()._Q)({isPhone:f}).table.token,gap:6}})),[f]),x=(0,n.useCallback)((()=>{r.length>0&&l({change:{type:"removeToken",removedToken:r[r.length-1]}})}),[l,r]);return(0,Oe.jsxs)(ge().A,{disableDesktopPadding:!0,children:[(0,Oe.jsx)(ht().Ay,{focus:m?void 0:!t,focusAfterAnimation:!0,format:ht().le.Select,tokens:v,tokenWrapStyle:S.tokenWrapStyle,placeholder:null!=b&&b.auto_update_on_edit?g.formatMessage({id:"database.selectPropertyEditMenu.searchPlaceholder.aiAutoUpdate",defaultMessage:"Empty"}):g.formatMessage({id:"database.selectPropertyEditMenu.searchPlaceholder",defaultMessage:"Search for an option..."}),onRemoveLastToken:x,value:i,disabled:o,hideInput:!1,onChange:e=>s(e.target.value),dontShowBorderBottom:y||m,...e,suppressFocusRing:!0}),p]})}function St(){return(0,Oe.jsx)(B().sA,{id:"database.selectPropertyEditMenu.noResults",defaultMessage:"No options found"})}function xt(){return(0,Oe.jsx)(B().sA,{id:"database.selectPropertyEditMenu.selectOnlyPrompt",defaultMessage:"Select an option"})}function Ct(){return(0,Oe.jsx)(B().sA,{id:"database.selectPropertyEditMenu.selectOrCreatePrompt",defaultMessage:"Select an option or create one"})}const kt=(0,B().YK)({limitedOptions:{id:"database.selectPropertyEditMenu.externalCollection.limitedOptions",defaultMessage:"Only options already assigned to issues in your Jira project are available"},limitedStatuses:{id:"database.selectPropertyEditMenu.externalCollection.limitedStatuses",defaultMessage:"Only statuses already assigned to issues in your Jira project are available"}});function At({environment:e,property:t,propertySchema:o,collectionContextStore:r}){const i=(0,c().IS)((e=>({helpLink:{display:"inline-flex",alignItems:"center",marginInlineStart:"2px",verticalAlign:"middle",cursor:"pointer"}})),[]),a=(0,n.useCallback)((()=>{var n;const i=null==r?void 0:r.collectionStore();V().j2(e,{property_id:t,property_type:o.type,action:"help_link_click_for_options_limitation",integration:null==i||null===(n=i.getFormat())||void 0===n?void 0:n.external_collection_type,collection_id:null==i?void 0:i.id})}),[e,t,o.type,r]),l="status"===o.type?"limitedStatuses":"limitedOptions";return(0,Oe.jsxs)("span",{children:[(0,Oe.jsx)(B().sA,{...kt[l]}),(0,Oe.jsx)($e().N,{href:"https://notion.notion.site/Alpha-Jira-2-way-Sync-23eefdeead058051b90df8f45cd29dc9#23eefdeead058009b3a0cf7bc06ef7c6",style:i.helpLink,onClick:a,children:(0,Oe.jsx)(dt().Q,{iconGroup:qe().u,variantName:"small"})})]})}function Mt({props:e,newOption:t,token:o}){const{isMobile:n}=(0,a().Y0)();return(0,Oe.jsx)(we().A,{...e,title:(0,Oe.jsxs)("div",{style:{display:"flex",minWidth:0},children:[(0,Oe.jsx)("div",{style:{marginInlineEnd:6,lineHeight:1.3},children:(0,Oe.jsx)(B().sA,{id:"database.selectPropertyEditMenu.createLabel",defaultMessage:"Create"})}),(0,Oe.jsx)(yt().O,{value:t.value,color:t.color,showRemoveButton:!1,isSingle:!0,format:n?Ye().NY.Large:Ye().NY.Medium,showEllipsis:!0})]}),isTokenTitle:!0})}function It({args:e,tokens:t,collectionId:o,property:r,schema:i,onChange:a,canConfigureCollection:l,shouldHideCreateNewOption:s,menuListStore:c}){const d=(0,n.useCallback)((e=>function(e,t,o,n,r,i){const a=(0,tt().o)({newOptions:e,collectionId:t,property:o,schema:n});if(a){const e=n[o];e&&x().lx(e)&&"manual"!==(e.auto_sort_options||"manual")&&a.push({pointer:{table:P().Vl,id:t},command:"update",path:["schema",o],args:{auto_sort_options:"manual"}}),r({type:"selectPropertyMenuUpdateSchema",schemaOperations:a})}i.reset()}(e,o,r,i,a,c)),[o,r,i,a,c]);return!l||s?(0,Oe.jsx)(ge().A,{...e,title:(0,Oe.jsx)(xt,{}),children:e.children}):(0,Oe.jsx)(ge().A,{...e,title:(0,Oe.jsx)(Ct,{}),children:(0,Oe.jsx)(pe().Ay,{direction:"vertical",keys:t,renderKey:o=>e.children[t.indexOf(o)],onDrop:d})})}function wt({analyticsFrom:e,canConfigureCollection:t,collectionId:o,handleSetOpenPropertyActionMenu:r,onChange:i,openPropertyActionMenu:l,option:s,property:c,props:d,schema:u,value:p,shouldRemoveTokenBackground:m}){const y=(0,a().Y0)(),f=(0,n.useMemo)((()=>s.value===l),[l,s.value]),g=u[c];return g&&x().lx(g)?(0,Oe.jsx)(ft,{...d,option:s,showDragHandle:t&&!y.isMobile,locked:!t,property:c,analyticsFrom:e,collectionId:o,onChange:e=>function(e,t,o,n,r){const i=o[t];if(!i)return;if(!x().lx(i))return;const a=i.options||[],l=[...a];let s;const c=n.filter((e=>{const t=a.find((t=>t.value===e));return!t||l.some((e=>e.id===t.id))}));s=F().n4(c,n)?{type:"selectPropertyMenuUpdateSchema",schemaOperations:e}:{type:"selectPropertyMenuUpdateReplaceOptions",options:c,schemaOperations:e};r(s)}(e,c,u,p,i),actionMenuOpen:f,propertySchema:g,onCloseActionMenu:r,onOpenActionMenu:r,removeBackground:m}):null}function Tt(e,t,o){const n=e[t];if(!n)return;if(!x().lx(n))return;const r=n.options||[],i=(0,x().Zd)(r);o.current=i}function Pt(e){const{analyticsFrom:t,canConfigureCollection:o,collectionId:n,createSelectColorRef:r,handleOnTokenInputChange:i,handleSetOpenPropertyActionMenu:a,onChange:l,openPropertyActionMenu:s,options:c,property:d,schema:u,tokens:p,value:m,additionalStores:y,isLimitReached:f,allowMultiple:g,shouldRemoveTokenBackground:h}=e;return p.map((e=>{let p=c.find((t=>t.value===e));p||(p=c.find((t=>t.value.toLowerCase()===e.toLowerCase())));return{key:e,render:i=>{if(p)return(0,Oe.jsx)(wt,{analyticsFrom:t,canConfigureCollection:o,collectionId:n,handleSetOpenPropertyActionMenu:a,onChange:l,openPropertyActionMenu:s,option:p,property:d,props:i,schema:u,value:m,shouldRemoveTokenBackground:h});{const t={id:(0,Ge().Ay)(),value:e,color:r.current};return(0,Oe.jsx)(Mt,{props:i,newOption:t,token:e})}},action:()=>{if(g&&f)return;!(y&&y.length>0)&&m.find((t=>t.toLowerCase()===e.toLowerCase()))||i({change:{type:"addTokens",newTokens:[e]}})}}}))}var jt=()=>o(13643),_t=()=>o(416504),Ot=()=>o(187174),Bt=()=>o(799829),Ft=()=>o(559506),Rt=()=>o(59226),Et=()=>o(735790),Dt=()=>o(468882),Lt=()=>o(147503),Vt=()=>o(447453),Nt=()=>o(673964),Ut=(o(16280),()=>o(744419)),Wt=()=>o(686504);function zt(e){var t;if(!e.collectionStore||!e.collectionType)return!1;const o=e.collectionStore.getFormat();return Boolean((null==o?void 0:o.external_collection_type)&&(null==o||null===(t=o.sync_state)||void 0===t?void 0:t.enable_two_way_sync))}var Kt=()=>o(308631);function Ht(e){var t,o,i;const{propertySchema:l,blockPropertyValueOverlayStore:d,onChange:u}=e,m=(0,a().v3)(),{isPhone:y,isAndroid:f}=(0,a().Y0)(),[g,h]=(0,n.useState)(e.initialValue??""),[v,b]=(0,n.useState)(""),S=(0,B().tz)(),x=(0,s().K8)((()=>{const e=d.state;if(e.isOpen)return e.collectionContextStore}),[d]),k=(0,s().K8)((()=>{const e=d.state;if(e.isOpen)return e.store}),[d]),A=(0,s().K8)((()=>null==x?void 0:x.collectionStore()),[x]),M=(0,s().K8)((()=>(null==x?void 0:x.permissionScopesStore.state.canConfigureCollection)&&"collectionPage"!==(null==x?void 0:x.contextType)),[x]),I=it(x),w=(0,Rt().X)("use_dynamic_options_for_jira_sync_status_field"),T=function(e){const{propertySchema:t,collectionStore:o,blockStore:r,property:i}=e,l=(0,a().v3)(),[c,d]=(0,n.useState)(null),[u,p]=(0,n.useState)(!1),[m,y]=(0,n.useState)(null),f=(0,s().K8)((()=>(0,Wt().ot)({collectionStore:o,blockStore:r})),[o,r]),g=(0,s().K8)((()=>{const e=i&&(0,nt().sc)({propertyId:i,collectionStore:o,propertySchema:t,isExternallyImportedAndSyncedCollection:null==o?void 0:o.isExternallyImportedAndSyncedCollection()});return zt(f)&&!e}),[f,o,i,t]),h=(0,s().K8)((()=>(0,nt().CS)()&&(0,nt()._M)()&&g&&r&&o),[g,r,o]);return(0,n.useEffect)((()=>{if(!h)return d(null),p(!1),void y(null);let e=!1;return async function(){p(!0),y(null);try{const t=await Ut().nR({environment:l,blockStore:r,collectionStore:o});e||(d(t),p(!1))}catch(t){if(!e){const e=t instanceof Error?t:new Error(String(t));y(e),d(null),p(!1)}}}(),()=>{e=!0}}),[h,r,o,l,i]),{...(0,n.useMemo)((()=>{if(!g)return{externalOptions:null,isLoading:!1,error:null};if(u)return{externalOptions:null,isLoading:!0,error:m};if(m)return{externalOptions:null,isLoading:!1,error:m};try{return{externalOptions:(0,Wt().WS)({context:f,staticOptions:t.options??[],staticGroups:t.groups??[],externalStatusOptions:c}),isLoading:!1,error:null}}catch(e){return{externalOptions:null,isLoading:!1,error:e instanceof Error?e:new Error(String(e))}}}),[g,f,t,c,u,m]),isExternalStatusProperty:g}}({propertySchema:l,collectionStore:A,blockStore:k,property:e.property}),P=(0,s().K8)((()=>{const e=d.state;return!!e.isOpen&&(0,Dt().br)({store:e.store,additionalStores:e.additionalStores,collectionContextStore:e.collectionContextStore})}),[d]),j=P?[]:(null===(t=T.externalOptions)||void 0===t?void 0:t.options)??l.options??[],_=(0,C().jy)(j,g),O=(null===(o=T.externalOptions)||void 0===o?void 0:o.groups)??l.groups??[],E=_&&O.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(_.id)})),[D,L]=(0,at().$)(),V=_?[(0,Oe.jsx)(yt().q,{value:_.value,color:_.color,groupColor:null==E?void 0:E.color,isSingle:!0,format:r().A.isMobile?Ye().NY.Large:Ye().NY.Medium,onClickRemove:()=>{h(""),u(void 0,void 0)},showRemoveButton:void 0===l.defaultOption,shouldShrink:!0,showEllipsis:!0,tooltipPlacement:"left",hideTooltip:Boolean(null===(i=_.description)||void 0===i?void 0:i.length)},"status")]:[],N=(0,c().IS)((e=>({tokenWrapStyle:{...(0,Ze()._Q)({isPhone:y}).table.token,gap:6},description:{color:e.text.inverseSecondary},footerMessage:{padding:"8px 12px",fontSize:"12px",color:e.text.secondary,borderTop:`1px solid ${e.border.secondary}`}})),[y]),U=P?null:(0,Oe.jsx)(ht().Ay,{focus:!r().A.isMobile||void 0,focusAfterAnimation:!0,format:ht().le.Select,tokens:V,tokenWrapStyle:N.tokenWrapStyle,placeholder:S.formatMessage({id:"database.selectPropertyEditMenu.searchStatusPlaceholder",defaultMessage:"Search for an option"}),onRemoveLastToken:F().lQ,value:v,disabled:e.disabled,hideInput:e.disabled,onChange:e=>{b(e.target.value)},dontShowBorderBottom:f,...D,suppressFocusRing:!0}),W=(0,n.useMemo)((()=>I&&!w?(0,Oe.jsx)("div",{style:N.footerMessage,children:(0,Oe.jsx)(At,{environment:m,property:e.property,propertySchema:l,collectionContextStore:x})}):null),[I,w,N.footerMessage,m,e.property,l,x]),z=r().A.isMobile?{menuType:ce().gu.Modal,title:l.name,footer:W,scrollerStyle:{paddingBottom:lt().Hc}}:{menuType:ce().gu.Popup,header:U,footer:W,tokenInputHeader:!0};if(e.disabled)return(0,Oe.jsx)(ye().A,{...z});let K=j;if(""!==v){const e=Xe().filter(v,j.map((e=>e.value))).map((e=>e.original));K=j.filter((t=>e.includes(t.value)))}const H=O.map((e=>{const t=K.filter((t=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)}));if(0!==t.length)return{group:e,groupOptions:t}})).filter(R().O9),X=H.length>1,$=function(e){const{isLoading:t,descriptionColor:o}=e;if(t)return{items:[{key:"loading",render:e=>(0,Oe.jsx)(we().A,{...e,disabled:!0,disabledFeedback:!1,focused:!1,title:(0,Oe.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"8px 0"},children:[(0,Oe.jsx)("span",{style:{fontSize:14,color:o},children:(0,Oe.jsx)(B().sA,{defaultMessage:"Loading",id:"database.selectPropertyEditMenu.loading"})}),(0,Oe.jsx)(oe().A,{})]})}),action:()=>{}}],key:"loading-section",render:e=>(0,Oe.jsx)(ge().A,{...e})}}({isLoading:T.isLoading,descriptionColor:N.description.color}),Y=P?[{items:O.map((t=>({key:t.name,render:e=>(0,Oe.jsx)(we().A,{...e,disabledFeedback:!0,focused:e.focused,title:(0,Oe.jsx)(Kt().RS,{style:{fontWeight:500,marginTop:2},group:t,showIcon:!0,showColor:!0})}),action:()=>{Xt({environment:m,collectionContextStore:x,property:e.property,propertySchema:l}),e.onChange(void 0,t.name)}}))),key:"all-groups",render:e=>(0,Oe.jsx)(ge().A,{...e})}]:H.map((({group:t,groupOptions:o},n)=>({items:o.map((o=>{const n=e.shouldDisableOption?e.shouldDisableOption(o.id):{disabled:!1};return{key:o.value,render:e=>{var i;return(0,Oe.jsx)(mt().A,{disableTooltip:n.disabled&&!(null!==(i=o.description)&&void 0!==i&&i.length),placement:"left",renderTooltip:e=>n.disabled?n.disableReasonMessage:(0,Oe.jsxs)("div",{...e,style:ut().Q$,children:[(0,Oe.jsx)("div",{children:o.value}),(0,Oe.jsx)("div",{style:N.description,children:o.description})]}),render:i=>{var a;return(0,Oe.jsx)(we().A,{...(0,pt().A)(i,e),disabled:n.disabled,disabledFeedback:!0,focused:e.focused,title:(0,Oe.jsx)(yt().q,{...i,value:o.value,color:o.color,hideTooltip:Boolean(null===(a=o.description)||void 0===a?void 0:a.length),tooltipPlacement:"left",groupColor:t.color,showRemoveButton:!1,isSingle:!0,format:r().A.isMobile?Ye().NY.Large:Ye().NY.Medium}),isTokenTitle:!0})}})},action:()=>{Xt({environment:m,collectionContextStore:x,property:e.property,propertySchema:l}),e.onChange(o.value,t.name)}}})),key:`group-${n}`,render:e=>(0,Oe.jsx)(ge().A,{...e,topBorder:e.index>0,title:X?(0,Oe.jsx)(Kt().RS,{group:t,showColor:!1,style:{fontSize:12}}):null})}))),q=x&&M&&!I?{items:[{key:"edit property",render:e=>(0,Oe.jsx)(we().A,{...e,title:(0,Oe.jsx)(B().sA,{defaultMessage:"Edit property",id:"database.tableHeaderCell.editProperty"}),icon:(0,Oe.jsx)(p().I,{icon:Et().M})}),action:()=>{const t=x.settingsStore;x.collectionStore()&&(e.onDismiss(),(0,Nt().j)({environment:m,collectionContextStore:x,fit:"settings"}),(0,Vt().O)({collectionContextStore:x,collectionSettingsStore:t}),Lt().a2({collectionSettingsStore:t,item:{type:"property",formatKey:x.getPropertyFormatKey(),property:e.property}}))}}],key:"edit-property",render:e=>(0,Oe.jsx)(ge().A,{...e,topBorder:e.index>0})}:void 0;return(0,Oe.jsx)(ye().A,{...z,children:(0,Oe.jsx)(je().Ay,{type:je().Oh.Vertical,initialFocus:v.length>0?0:void 0,sections:F().oE([$,...T.isLoading?[]:Y,q]),onAccept:(t,o,n)=>{e.onAccept(n)},comboboxProps:L})})}function Xt(e){var t;const{environment:o,collectionContextStore:n,property:r,propertySchema:i}=e,a=null==n?void 0:n.collectionStore();a&&a.isExternalSyncedCollection()&&V().j2(o,{property_id:r,property_type:"status",action:"option_select",integration:null===(t=a.getFormat())||void 0===t?void 0:t.external_collection_type,collection_id:a.id,is_notion_only_property:(0,nt().sc)({collectionStore:a,propertyId:r,propertySchema:i,isExternallyImportedAndSyncedCollection:a.isExternallyImportedAndSyncedCollection()})})}const $t=(0,B().YK)({cannotSetSprintToCurrentTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToCurrentTooltip",defaultMessage:"Current sprint already exists"},cannotSetSprintToNextTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToNextTooltip",defaultMessage:"Next sprint already exists"},cannotSetSprintToLastTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToLastTooltip",defaultMessage:"Last sprint already exists"}});function Yt(e){const{blockPropertyValueOverlayStore:t}=e,o=(0,a().v3)(),r=(0,Q().ET)(),i=(0,s().O$)(r.normalizedSchemaStore),l=function({sprintCollectionStore:e,environment:t,normalizedBlockSchema:o}){const[{value:n,status:r}]=(0,Ot().Yb)((async()=>{var n;if(!e)return;const r=e.getSchema(),i=e.getFormat().app_config_uri;if(!i||i!==jt().av)return;const a=(0,Bt().qk)(r,i).includes("last"),l=Bt().n$[i],s=l.current.reducer.get(o),c=l.next.reducer.get(o),d=l.last.reducer.get(o);if(!s||!c)return;const u={userId:t.currentUser.id,userTimeZone:(0,_t().P)(),searchQuery:void 0,reducers:{[g().Xk]:s,[g().tO]:c,...a&&d?{[g().el]:d}:{}},currentPageInRelatedCollection:void 0},p=null===(n=e.getParentBlockStore())||void 0===n?void 0:n.getCollectionViewStores()[0],m=e.getSpaceId();if(!p)return;const y=await Ft().callApi({eventName:"queryCollection",environment:t,data:{source:{type:"collection",id:e.id,spaceId:m},collectionView:{id:p.id,spaceId:m},loader:u},tracking:{src:"sprint_status_overlay_check"}});if("success"!==y.type)return;const f=y.data.result.reducerResults[g().Xk],h=y.data.result.reducerResults[g().tO];if("results"!==f.type||"results"!==h.type)return;const v=f.blockIds.length>0,b=h.blockIds.length>0;if(!a)return{hasCurrentSprint:v,hasNextSprint:b,hasLastSprint:!1};const S=y.data.result.reducerResults[g().el];if("results"!==S.type)return;return{hasCurrentSprint:v,hasNextSprint:b,hasLastSprint:S.blockIds.length>0}}),[t,o,e]);if("resolved"!==r||!n)return;return n}({sprintCollectionStore:(0,s().K8)((()=>{const e=t.state;if(e.isOpen)return e.store.getAssociatedCollectionStore()}),[t]),environment:o,normalizedBlockSchema:i}),c=(0,B().tz)(),d=(0,n.useCallback)((e=>void 0===l&&[g().tO,g().Xk,g().el].includes(e)?{disabled:!0}:e===g().tO&&null!=l&&l.hasNextSprint?{disabled:!0,disableReasonMessage:c.formatMessage($t.cannotSetSprintToNextTooltip)}:e===g().Xk&&null!=l&&l.hasCurrentSprint?{disabled:!0,disableReasonMessage:c.formatMessage($t.cannotSetSprintToCurrentTooltip)}:e===g().el&&null!=l&&l.hasLastSprint?{disabled:!0,disableReasonMessage:c.formatMessage($t.cannotSetSprintToLastTooltip)}:{disabled:!1}),[l,c]);return(0,Oe.jsx)(Ht,{...e,shouldDisableOption:d})}var qt=()=>o(68465),Qt=()=>o(792540),Gt=()=>o(693689),Jt=()=>o(249847),Zt=()=>o(645873),eo=()=>o(968913),to=()=>o(406792),oo=()=>o(246219),no=()=>o(289190),ro=()=>o(148832),io=()=>o(543665),ao=()=>o(878710),lo=()=>o(502438),so=()=>o(329304),co=()=>o(90654),uo=()=>o(802229),po=()=>o(72135),mo=()=>o(693084);const yo=n.memo((function(e){const{disabled:t,value:i,insertChar:l,format:s,onChange:d,isTable:u,size:p}=e,[y,f]=(0,n.useState)(""),g=(0,B().tz)(),h=(0,n.useCallback)((e=>{let t=(0,o(668766).q)(e,g);return"percent"===s&&void 0!==t&&(t/=100),t}),[g,s]),v=(0,n.useRef)(!1);(0,n.useEffect)((()=>{v.current||(f(po().ZV(i,s,g)||""),v.current=!0)}),[s,g,i]);const b=(0,o(600871).GN)();(0,n.useEffect)((()=>{if(!b)return;const e=po().$J(y,g);e&&i===-1*e&&f(i>0?y.replace("-",""):`-${y}`)}),[b,s,g,i,y]),(0,n.useEffect)((()=>{l&&(f(l),d(h(l)))}),[l,d,h]);const S=(0,n.useCallback)((e=>{const t=e.target.value;f(t),d(h(t))}),[d,h]),x=(0,c().IS)((()=>{const e=r().A.isMobile?"large"===p?mo().vM:mo().Zz:"large"===p?mo().qi:mo().qs;return{input:{textAlign:u?"end":"start"},inputContainer:{...e,display:"block"}}}),[u,p]),C=(0,a().Y0)(),k=C.isIOS&&!C.isIpad?b?"decimal":void 0:"decimal";return(0,Oe.jsx)(m().N,{debugName:"NumberPropertyValue",capture:!t,onDelete:F().D_,onSpace:F().D_,onBackspace:F().D_,onLeft:F().D_,onRight:F().D_,onUp:F().D_,onDown:F().D_,onSelectAll:F().D_,onRedo:F().D_,onUndo:F().D_,onCut:F().D_,onCopy:F().D_,onPaste:F().D_,onKeypress:F().D_,children:(0,Oe.jsx)(Pe().A,{style:x.inputContainer,value:y,format:Pe().C.Transparent,onChange:S,inputStyle:x.input,focus:!t,disabled:t,inputMode:k})})})),fo=n.memo((function(e){const{disabled:t,inputType:o,onChange:i,value:a}=e,l=(0,c().IS)((()=>({input:{...r().A.isMobile?mo().Zz:mo().qs,display:"block"}})),[]),s=(0,n.useCallback)((e=>{i(e.target.value)}),[i]);return(0,Oe.jsx)(m().N,{debugName:"URLPropertyValue",capture:!t,onBackspace:F().D_,onCopy:F().D_,onCut:F().D_,onDelete:F().D_,onDown:F().D_,onKeypress:F().D_,onLeft:F().D_,onPaste:F().D_,onRedo:F().D_,onRight:F().D_,onSelectAll:F().D_,onSpace:F().D_,onUndo:F().D_,onUp:F().D_,children:(0,Oe.jsx)(Pe().A,{disabled:t,focus:!t,format:Pe().C.Transparent,onChange:s,style:l.input,type:o,value:a})})}));var go=()=>o(993905),ho=()=>o(165358),vo=()=>o(97059),bo=()=>o(617837);function So(e,t){const[o,r]=(0,n.useState)();return{feedbackState:o,setFeedbackState:r,inferenceId:(0,s().K8)((()=>{var t;return null===(t=e.store)||void 0===t||null===(t=t.getFormat())||void 0===t||null===(t=t.ai_property_inference_map)||void 0===t||null===(t=t[e.property])||void 0===t?void 0:t.inference_id}),[e])}}function xo({autofillBlockPropertyValueFeedbackButtonsState:e}){return e.inferenceId?(0,Oe.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,Oe.jsx)(bo().j,{traceId:e.inferenceId,feedbackState:e.feedbackState,setFeedbackState:e.setFeedbackState,feature:"ai_autofill"})}):(function(e){const{autofillBlockPropertyValueFeedbackButtonsState:t}=e;ho().log({from:"AutofillUpdateButtonFailedToFetchFeedbackIndicators",level:"error",type:"Autofill",data:{miscDataToConvertToString:{...t}}})}({autofillBlockPropertyValueFeedbackButtonsState:e}),null)}function Co({overlayState:e,theme:t,propertySchema:o}){const n=(0,s().K8)((()=>no().m.isWriting()),[]),r=(0,a().v3)(),i=So(e),l=!(0,s().O$)(d().e);return r.device.isMobile||l||n?null:(0,Oe.jsx)(go().s,{allowSelectionWithin:!1,children:(0,Oe.jsxs)("div",{style:{position:"absolute",top:-36,insetInlineEnd:0,borderRadius:6,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",background:t.popoverBackground,boxShadow:t.shadowMD,zIndex:-1,padding:2},children:[(0,Oe.jsx)(ko,{overlayState:e,propertySchema:o}),(0,Oe.jsx)(xo,{autofillBlockPropertyValueFeedbackButtonsState:i})]})})}function ko({overlayState:e,propertySchema:t}){const o=(0,a().v3)(),n=(0,c().IS)((e=>({buttonStyle:{display:"flex",height:28,borderRadius:4},updateTextStyle:{fontWeight:500,color:e.purple.text.accentPrimary}})),[]);return(0,Oe.jsx)(f().p,{style:n.buttonStyle,onClick:()=>{t&&Y().autofillPropertyForBlocks({environment:o,stores:[e.store],property:e.property,propertySchema:t,userEventForAnalytics:"generate_from_overlay_button",collectionContextStore:e.collectionContextStore,from:Dt().zP(e.surface)})},children:(0,Oe.jsxs)(y().fI,{gap:4,children:[(0,Oe.jsx)(p().I,{icon:vo().s,size:"sm",colorPalette:"purple",colorVariant:"accentPrimary"}),(0,Oe.jsx)("span",{style:n.updateTextStyle,children:(0,Oe.jsx)(B().sA,{defaultMessage:"Update",id:"database.propertyValues.reGenerateAiAutofill"})})]})})}function Ao({overlayState:e,propertySchema:t,showSeparator:o}){const n=So(e),r=(0,c().IS)((e=>({dot:{color:e.text.tertiary}})),[]);return(0,Oe.jsxs)(Oe.Fragment,{children:[o?(0,Oe.jsx)("div",{style:r.dot,children:""}):null,(0,Oe.jsx)(xo,{autofillBlockPropertyValueFeedbackButtonsState:n})]})}function Mo({overlayState:e,propertySchema:t,style:o}){const n=(0,a().v3)(),r=(0,c().IS)((e=>({linkStyle:{color:e.aiPurpleColor,fontSize:12,...o}})),[o]);return(0,Oe.jsx)("div",{style:r.linkStyle,onClick:()=>{t&&Y().autofillPropertyForBlocks({environment:n,stores:[e.store],property:e.property,propertySchema:t,userEventForAnalytics:"generate_from_overlay_button",collectionContextStore:e.collectionContextStore,from:Dt().zP(e.surface)})},children:(0,Oe.jsx)(B().sA,{defaultMessage:"Update",id:"database.propertyValues.reGenerateAiAutofill"})})}function Io(e){const{store:t,additionalStores:o,collectionContextStore:n,collectionSchema:r}=e;return n&&(0,Dt().br)({store:t,additionalStores:o,collectionContextStore:n})?n.normalizedSchemaStore.state:r||t.getSchema()||{}}function wo(e){if(!(0,Dt().br)({store:e.store,additionalStores:e.additionalStores,collectionContextStore:e.collectionContextStore}))return e.store.getAssociatedCollectionStore()}function To(e){const t=wo(e),o=t?t.getMappedProperty(e.property):e.property;return Io(e)[o]}function Po({overlayState:e,pageContext:t}){const{store:o}=e,n=To(e);return n&&(0,qt().ge)(null==t?void 0:t.publicEditModeStore.state,o)&&x().$M(n)&&x().om(n)&&!e.collectionsBulkActionsToolbarStore}var jo=()=>o(13966);const _o=(0,o(340498).xh)("pointer",{default:{loader:()=>o.e(20684).then(o.bind(o,711621))},small:{loader:()=>o.e(20684).then(o.bind(o,548551))},fill:{loader:()=>o.e(20684).then(o.bind(o,482645))},fillSmall:{loader:()=>o.e(20684).then(o.bind(o,83756))}},["location","gps","cursor","arrow","map"]);var Oo=()=>o(297813),Bo=()=>o(932779),Fo=()=>o(495748),Ro=()=>o(285790),Eo=()=>o(229833);async function Do({isElectron:e}){if(e)return Lo;if(!navigator.geolocation||!navigator.permissions)return"unsupported";try{return(await navigator.permissions.query({name:"geolocation"})).state}catch(t){return"unsupported"}}const Lo="electronThereforeUnknown";var Vo=()=>o(707069),No=o.n(o(794148));async function Uo({isElectron:e}){const t=await Do({isElectron:e});if("unsupported"===t||"denied"===t)return;const o=function(e){if(No()("denied"!==e),"granted"===e)return;if("electronThereforeUnknown"===e)return 1;return 1e4}(t);let n;try{n=await new Promise(((e,t)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e,t,{enableHighAccuracy:!0,timeout:o,maximumAge:0}):t(new Error("Geolocation is not supported by this browser"))}))}catch(r){ho().log({level:"error",from:"getCurrentLocation",type:"getCurrentPosition",error:(0,Eo().convertErrorToLog)(r)})}return n?{latitude:n.coords.latitude,longitude:n.coords.longitude}:void 0}var Wo=()=>o(160095);function zo({propertyName:e,placeValue:t,onChange:o,onClose:r,insertChar:i}){const l=(0,a().Y0)(),s=l.isElectron,c=(0,a().v3)(),d=(0,Vo().S)(),[u,p]=(0,n.useState)(i||""),[{value:y=[]}]=(0,Ot().Yb)((async()=>{if(!u)return[];const e=await Uo({isElectron:s});return(0,Wo().VW)(u,d,c,e)}),[c,u,d,s]),f=(0,n.useCallback)((async e=>{if("current-location"===e){const e=await Uo({isElectron:s}),t=e&&await(0,Wo().fr)(e,d,c);return void(t&&(o({value:t,placeLocationSource:"current_location"}),p("")))}const t=await(0,Wo().Ox)(e,d,c);t&&(p(""),o({value:t,placeLocationSource:"autocomplete_search"}))}),[o,c,d,s]),g=(0,n.useCallback)((()=>{o({value:void 0})}),[o]),h=(0,n.useCallback)((e=>{!t||1!==e.key.length||e.ctrlKey||e.metaKey||e.altKey||(g(),p(e.key))}),[t,g]),v={menuType:ce().gu.Popup,...l.isMobile&&{title:e,menuType:ce().gu.Modal,right:(0,Oe.jsx)(fe().DoneMenuText,{}),onClickRight:r},...!l.isMobile&&{tokenInputHeader:!0,maxHeight:333}};return(0,Oe.jsx)(m().N,{debugName:"PlacePropertyValueOverlay",capture:!0,priority:1,onKeypress:h,children:(0,Oe.jsx)(ye().A,{...v,header:(0,Oe.jsx)(Ko,{placeValue:t,onClearLocationClick:g,setQuery:p,query:u}),footer:!t&&u&&(0,Oe.jsx)(Xo,{}),disableHeaderBorder:!y.length&&!t,children:t?(0,Oe.jsx)(Fo().Vt,{place:t}):(0,Oe.jsx)($o,{results:y,onSuggestionClick:f,query:u})})})}function Ko(e){const t=(0,a().Y0)(),o=t.isElectron,n=(0,B().tz)(),{placeValue:r,onClearLocationClick:i,setQuery:l,query:s}=e,d=(0,c().IS)((e=>({tokenInputMenuItem:{background:e.background.secondary,borderBottom:`1px solid ${e.border.secondary}`,borderEndStartRadius:0,borderEndEndRadius:0},tooltipIcon:{marginTop:5},tooltip:{minWidth:150}})),[]);return(0,Oe.jsx)(ht().Ay,{focus:!t.isMobile||void 0,focusAfterAnimation:!0,hideInput:Boolean(r),format:ht().le.Place,disabled:Boolean(r),right:o&&!r?(0,Oe.jsx)(mt().A,{placement:"right",style:d.tooltip,textWrap:!0,renderTooltip:()=>n.formatMessage({id:"placePropertyValueOverlay.currentLocation.grantLocationPermissionOnDesktop",defaultMessage:"For best results, ensure location permissions are granted in your computer settings"}),render:e=>(0,Oe.jsx)("div",{...e,style:d.tooltipIcon,children:(0,Oe.jsx)(dt().Q,{iconGroup:jo().H,style:d.tooltipIcon,variantName:"default"})})}):void 0,tokens:r?[(0,Oe.jsx)(Ho,{placeValue:r,onClearLocationClick:i},"placeValue")]:[],tokenWrapStyle:{padding:"4px 6px",gap:4},placeholder:n.formatMessage({id:"placePropertyValueOverlay.search.placeholder",defaultMessage:"Search for a location..."}),value:s,onChange:e=>l(e.target.value),dontShowBorderBottom:t.isAndroid,onRemoveLastToken:i,style:d.tokenInputMenuItem})}function Ho({placeValue:e,onClearLocationClick:t}){const o=(0,B().tz)(),n=(0,c().IS)((()=>({header:{display:"flex",alignItems:"center",fontSize:Ze().Mi},closeIconButton:{width:20,height:20,borderRadius:100,marginInlineEnd:2,marginInlineStart:2}})),[]);return(0,Oe.jsxs)("div",{style:n.header,children:[(0,Oe.jsx)("div",{children:(0,Bo().H)({placeAnnotation:(0,_().ZW1)(e),index:0})}),(0,Oe.jsx)(Ro().A,{style:n.closeIconButton,icon:Oo().xMarkFillIcon,onClick:t,ariaLabel:o.formatMessage({id:"placePropertyValueOverlay.clear",defaultMessage:"Clear location field"})})]})}function Xo(){const e=(0,B().tz)(),t=(0,c().IS)((e=>({disclaimerContainer:{padding:"8px 12px",borderTop:`1px solid ${e.border.secondary}`,backgroundColor:e.background.primary},disclaimerText:{fontSize:12,color:e.text.tertiary,lineHeight:1.5},disclaimerLink:{color:e.text.tertiary,textDecoration:"underline",cursor:"pointer"}})),[]);return(0,Oe.jsx)("div",{style:t.disclaimerContainer,children:(0,Oe.jsxs)("div",{style:t.disclaimerText,children:[e.formatMessage({id:"placePropertyValueOverlay.disclaimer",defaultMessage:"Results may be limited. "}),(0,Oe.jsx)("a",{href:"https://www.notion.com/help/maps",target:"_blank",rel:"noopener noreferrer",style:t.disclaimerLink,children:e.formatMessage({id:"placePropertyValueOverlay.disclaimer.learnMore",defaultMessage:"Learn more"})}),"."]})})}function $o(e){const{results:t,onSuggestionClick:o,query:r}=e,i=(0,B().tz)(),l=function(){const e=(0,a().Y0)().isElectron,[t,o]=(0,n.useState)("pending");return(0,n.useEffect)((()=>{let t;return async function(){const n=await Do({isElectron:e});if(o(n),navigator.permissions)try{const n=await navigator.permissions.query({name:"geolocation"}),r=()=>{o(e?Lo:n.state)};n.addEventListener("change",r),t=()=>{n.removeEventListener("change",r)}}catch(r){ho().log({level:"error",from:"useGeolocationPermissionStatus",type:"geolocationPermissionStatus",error:(0,Eo().convertErrorToLog)(r)})}}(),()=>{var e;null===(e=t)||void 0===e||e()}}),[e]),t}(),s="granted"===l||"prompt"===l||"electronThereforeUnknown"===l,c=(0,n.useCallback)((()=>{s&&o("current-location")}),[s,o]),d=t.map((e=>{const t=(0,Wo().LI)(e),{matching:n,nonMatching:i}=(0,w().Sd)({suggestionTitle:e.title,query:r}),a=(0,Oe.jsxs)(Oe.Fragment,{children:[(0,Oe.jsx)("span",{style:{fontWeight:"bold"},children:n}),(0,Oe.jsx)("span",{children:i})]});return{key:t,action:()=>o(e),render:t=>(0,Oe.jsx)(we().A,{...t,title:a,caption:e.title!==e.address?e.address:void 0})}}));return d.unshift({key:"current-location",action:c,render:e=>(0,Oe.jsx)(mt().A,{disableTooltip:s,placement:"right",renderTooltip:()=>i.formatMessage({id:"placePropertyValueOverlay.currentLocation.disabledTooltip",defaultMessage:"No permission to get current location"}),render:t=>(0,Oe.jsx)(we().A,{...e,...t,disabled:!s,disabledFeedback:!s,title:i.formatMessage({id:"placePropertyValueOverlay.currentLocation",defaultMessage:"Current Location"}),icon:(0,Oe.jsx)(dt().Q,{iconGroup:_o,variantName:"small"})})})}),(0,Oe.jsx)(je().Ay,{type:je().Oh.Vertical,initialFocus:0,sections:[{items:d,key:"results",render:e=>(0,Oe.jsx)(ge().A,{...e})}]})}const Yo=Object.freeze({property:!0}),qo=n.memo((function(e){const{store:t}=e,i=(0,a().v3)(),c=(0,l().S)();(0,o(852507).l)((()=>{gn({isFirstRender:!0},t,i)})),o(17022).e.withListenerIgnored((()=>{gn({isFirstRender:!1},t,i)}));const d=(0,n.useRef)(void 0),p=(0,s().O$)(t),{originRect:y,mobileStyle:f,style:g,placementToOrigin:h}=(0,s().K8)((()=>{let e,t,n;if(p.isOpen){const s="page"===p.surface,d=To(p),m=d?d.type:void 0,y=p.store.canEdit();let f=p.rect.top,g=p.rect.left,h=p.rect.width,v=p.rect.height;if(s?(g-=1,h+=1):(f-=1,g-=1,h+=1,v+=2),("number"===m||C().DY(m))&&r().A.isMobile){const e=(0,o(272053).y)(i,u().A.state.estimatedKeyboardWebViewOverlap,u().A.state.nativeBottomBarHeight)+24;n={overflowY:"auto",WebkitOverflowScrolling:"touch",width:Math.max(240,h),maxHeight:`calc(100vh - ${e}px)`}}if("number"===m)t={width:Math.max(240,h)};else if("date"===m)f+=v-1,t={};else if("relation"===m){const e=oo().Qd;t={width:Math.max(e,h),minHeight:y?65:void 0,overflow:"hidden"}}else if("person"===m)t={width:Math.max(240,h)};else if("formula"===m)f+=v-1,t={borderRadius:12};else if("select"===m||"multi_select"===m)t={width:Math.max(300,h),overflow:"visible"};else if("rollup"===m)f+=v-1,t={};else if("file"===m)t={minWidth:Math.max(240,h)};else if("verification"===m)t={width:F().qE(h,265,270)};else{const e=24+(Po({overlayState:p,pageContext:c})?28:0);t={width:Math.max(240,h),minHeight:Math.min(v,window.innerHeight-e),maxHeight:window.innerHeight-e,overflow:"visible",display:"flex",flexDirection:"column"},"status"===m&&Dt().br({store:p.store,additionalStores:p.additionalStores,collectionContextStore:p.collectionContextStore})&&(f+=v-1)}const b=p.collectionContextStore;if(b){var a,l;const e=b.subitemTreeStore.state,n=(0,o(708830).Qe)(e.children,(e=>e.value.store===p.store)),r=null==n?void 0:n.length,i=null===(a=b.normalizedFormatStore.state)||void 0===a||null===(a=a.table_properties)||void 0===a?void 0:a.filter((e=>e.visible)),s=i&&(null===(l=i[0])||void 0===l?void 0:l.property)===p.property;r&&s&&(t={...t,...m&&x().YW(m)&&{width:Math.max(90,h)}})}e=new DOMRect(g,f,h,0)}return{originRect:e,style:t,mobileStyle:n,placementToOrigin:"bottom"}}),[p,i,c]),v=(0,s().K8)((()=>{const e=function(e){const{store:t}=e;if(!r().A.isMobile)return{type:ne().nl.Popup};const o=t.state;if(!o.isOpen)return{type:ne().nl.SlideUp};const n=To(o);if(!n)return{type:ne().nl.SlideUp};const i=mo().Hp[n.type];return i}({store:t}),n=!r().A.isMobile||e.type===ne().nl.Popup,a={key:fn(t),popupType:e.type,bottomSheetInitialState:e.type===ne().nl.BottomSheet?e.bottomSheetInitialState:void 0,open:p.isOpen,originRect:y,style:r().A.isMobile?f:g,borderRadius:6,alignmentToOrigin:"start",placementToOrigin:h,preventScaleTransition:n,preventOpacityTransition:n,render:()=>function(e){const{overlayState:t,store:o,environment:n}=e;if(!t.isOpen)return null;return(0,Oe.jsx)(m().N,{debugName:"BlockPropertyValueOverlay",capture:!0,onTab:e=>xn(e,o,n),onUntab:e=>Cn(e,o,n),onEnter:()=>kn(o,n),onDelete:F().D_,onBackspace:F().D_,children:(0,Oe.jsxs)(Q().RI,{value:t.collectionContextStore,children:[(0,Oe.jsx)(Qo,{overlayState:t}),(0,Oe.jsx)("div",{style:{display:"flex",flexDirection:"column",overflowY:"auto",flexGrow:1,height:"100%"},children:(0,Oe.jsx)(Go,{overlayState:t,store:o})})]})},`${t.store.id}${t.property}`)}({overlayState:p,store:t,environment:i}),onDismiss:()=>function(e,t){o(182641).xl(),co().vF({environment:t,blockPropertyValueOverlayStore:e})}(t,i)};return d.current=a,a}),[i,f,y,p,h,t,g]);return p.isOpen||!d.current?(0,Oe.jsx)(ne().Ay,{...v}):(0,Oe.jsx)(ne().Ay,{...d.current,open:!1})}));function Qo({overlayState:e}){const t=(0,l().S)(),o=(0,c().DP)(),n=(0,s().K8)((()=>Po({overlayState:e,pageContext:t})),[e,t]),r=(0,s().K8)((()=>n?To(e):void 0),[n,e]);return n?(0,Oe.jsx)(Co,{theme:o,propertySchema:r,overlayState:e}):null}function Go({overlayState:e,store:t}){const o=(0,s().K8)((()=>To(e)),[e]);if(!o)return null;const n=Jo[o.type];return n?(0,Oe.jsx)(n,{store:t,overlayState:e,propertySchema:o,propertyType:o.type}):null}const Jo={title:function({overlayState:e,propertyType:t,store:o}){const i=(0,a().v3)(),{clonedStore:l}=e,c=(0,n.useCallback)((()=>kn(o,i)),[o,i]),d=(0,n.useCallback)((()=>Sn(o,i)),[o,i]),u=(0,n.useCallback)((e=>xn(e,o,i)),[o,i]),p=(0,n.useCallback)((e=>Cn(e,o,i)),[o,i]),m=(0,n.useCallback)((()=>Tn(e,t,i,o)),[e,t,i,o]),y=(0,s().K8)((()=>l.getTitleStore()||l.getPropertyStore(e.property)),[l,e.property]),f=(0,s().K8)((()=>vn(e,i)),[e,i]),g=(0,n.useMemo)((()=>r().A.isMobile?en:Zo),[]);return(0,Oe.jsx)("div",{style:g,children:(0,Oe.jsx)(He().A,{store:y,disableSlashCommands:!0,onEnter:c,onEsc:d,onTab:u,onUntab:p,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableShiftEnter:!0,onChange:m,disabled:f,pasteBehavior:"inline",inPageFind:Qt().Os.none,disabledMentionTypes:Yo})})},text:function({overlayState:e,propertySchema:t,propertyType:o,store:i}){var l;const c=(0,a().v3)(),d=(0,B().tz)(),{clonedStore:u}=e,p="text"===(null==t?void 0:t.type)&&(null===(l=t.ai_inference)||void 0===l?void 0:l.auto_update_on_edit);let m;p&&(m=d.formatMessage({id:"BlockPropertyValueOverlay.textProperty.placeholder",defaultMessage:"Empty"}));const y=(0,s().K8)((()=>i.state.isOpen&&te().A.getPropertyId()===i.state.property&&te().A.getBlockStore()===i.state.store),[i]),f=(0,n.useCallback)((()=>kn(i,c)),[i,c]),g=(0,n.useCallback)((()=>Sn(i,c)),[i,c]),h=(0,n.useCallback)((e=>xn(e,i,c)),[i,c]),v=(0,n.useCallback)((e=>Cn(e,i,c)),[i,c]),b=(0,n.useCallback)((()=>Tn(e,o,c,i)),[e,o,c,i]),S=(0,s().K8)((()=>u.getPropertyStore(e.property)),[u,e.property]),x=(0,s().K8)((()=>vn(e,c)),[e,c]),C=(0,n.useMemo)((()=>r().A.isMobile?mo().Zz:mo().qs),[]);return(0,Oe.jsxs)(Oe.Fragment,{children:[(0,Oe.jsxs)("div",{style:C,children:[(0,Oe.jsx)(He().A,{store:S,disableSlashCommands:!0,onEnter:f,onEsc:g,onTab:h,onUntab:v,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onChange:b,disabled:x,disableStyleAnnotations:p,pasteBehavior:"inline",placeholder:m,inPageFind:Qt().Os.none,hasTemporaryDiscussionOnProperty:y,disabledMentionTypes:Yo}),(0,Oe.jsx)(tn,{overlayState:e,propertySchema:t})]}),(0,Oe.jsx)(on,{overlayState:e,propertySchema:t})]})},relation:function({overlayState:e,store:t}){const o=(0,a().v3)(),r=rn(e),i=(0,s().K8)((()=>C().n(un(e))),[e]),l=an(e),c=sn(e),d=(0,s().K8)((()=>e.store.getParentId()),[e]),u=cn(e),p=(0,n.useCallback)((()=>bn(t,o)),[t,o]),m=(0,n.useCallback)((async e=>{const n=t.state;n.isOpen&&await async function({update:e,environment:t,blockStore:o,property:n,propertySchema:r,inMemoryRecordCache:i,editStores:a,collectionContextStore:l,surface:s}){var c;if(!r||"relation"!==r.type)return;const d="relation"===r.type&&x().zO(r),u=d&&new(io().m)(t,{table:P().Vl,id:d});u&&await u.load();$().createAndCommit({userAction:"BlockPropertyValueOverlay.handleRelationPropertyMenuUpdate",environment:t,canUndo:!0,perform:c=>{if(e.newPage&&d&&u){const o=_().x9d(e.newPage.name),n=u.getRootPagePointer()??u.pointer,r=z().Wv({environment:t,id:e.newPage.id,type:h().xd.page,properties:{title:o},spaceId:e.newPage.spaceId,inMemoryRecordCache:i,transaction:c});if(n.table===T().ev){const e=new(ro().B)(t,n);W().NI({parentStore:e,childStore:r,transaction:c})}else n.table===P().Vl?W().X$({parentStore:u,childStore:r,transaction:c}):(0,R().HB)(n);const a=u.getDefaultTemplatePageStore();a&&U().n5({title:{text:o},environment:t,store:ro().B.createChildStore(u,r.pointer),templateStore:a,isKeyboard:!1,isCreateIn:!1,transaction:c,from:"relation_property_menu_update"})}const p=e.newValues,m=e.oldValues,y=(0,M().i)(m.map(k().jV),p.map(k().jV)),f=F().oE(Array.from(y.removeOps).map((e=>{if(!p.find((t=>(0,k().jV)(t)===e)))return m.find((t=>(0,k().jV)(t)===e))}))),g=[];for(const e in y.beforeOps){const t=p.find((t=>(0,k().jV)(t)===e));if(!t)continue;const o=y.beforeOps[e];if(!o){g.push({relationToAdd:t});continue}const n=p.find((e=>(0,k().jV)(e)===o));g.push({relationToAdd:t,before:n})}for(const e of a){for(const o of f)K().zB({environment:t,store:e,propertyId:n,id:o.id,transaction:c});for(const o of g)o.before?K().K6({environment:t,store:e,propertyId:n,id:o.relationToAdd.id,position:{type:"before",before:o.before.id},transaction:c}):K().K6({environment:t,store:e,propertyId:n,id:o.relationToAdd.id,position:{type:"after"},transaction:c})}In({environment:t,blockStore:o,collectionContextStore:l,propertyId:n,propertySchema:r,surface:s,isOpenFromBulkActionsToolbar:!1})}});const p=null==l||null===(c=l.collectionStore())||void 0===c?void 0:c.pointer;u&&p&&x().nC(r)&&H().id({sourcePropertySchema:r,sourcePropertyId:n,sourceCollectionPointer:p,relatedCollectionStore:u,newRelationValues:e.newValues,oldRelationValues:e.oldValues,environment:t})}({update:e,environment:o,blockStore:n.store,property:n.property,propertySchema:To(n),inMemoryRecordCache:n.store.inMemoryRecordCache,editStores:mn(n),collectionContextStore:n.collectionContextStore,surface:n.surface})}),[o,t]),y=(0,s().K8)((()=>{var t;return(null===(t=e.collectionContextStore)||void 0===t?void 0:t.collectionViewStore())||void 0}),[e]);if(d)return(0,Oe.jsx)(oo().PF,{blockPointers:i,property:e.property,collectionStore:l,collectionId:d,schema:r,isDisabled:u,canConfigureCollection:c,onChange:m,analyticsFrom:pn(e),onClose:p,blockStore:e.store,overlayMode:e.mode,insertChar:e.insertChar,surface:e.surface,formQuestionStore:e.formQuestionStore,collectionViewStore:y});return null},rollup:function({overlayState:e,store:t}){const r=(0,a().v3)(),i=(0,s().K8)((()=>Io(e)),[e]),l=nn(e),c=(0,s().K8)((()=>{const t=wo(e),o=null==t?void 0:t.getParentBlockStore();return vn(e,r)||!(0,ee().v)({collectionStore:t,collectionViewBlockStore:o,checkNavigableAncestorLocked:!1})||l}),[e,r,l]),d=(0,n.useCallback)((()=>bn(t,r)),[t,r]),u=(0,n.useCallback)((e=>function(e,t,o){const n=t.state;if(!n.isOpen)return;$().createAndCommit({userAction:"BlockPropertyValueOverlay.handleRollupPropertyMenuUpdate",environment:o,canUndo:!0,perform:r=>{!function(e,t,o,n){const r=o.state;if(!r.isOpen)return;if(r.isOpen){const o=wo(r);o&&(0,Z().F)({environment:n,collectionStore:o,update:e,transaction:t})}}({[n.property]:e.propertySchema},r,t,o)}})}(e,t,r)),[t,r]);return(0,Oe.jsx)(o(798174).R,{context:"bpvOverlay",property:e.property,schema:i,disabled:c,onChange:u,parentStore:e.store,analyticsFrom:pn(e),onDismiss:d})},select:function({overlayState:e,store:t}){const o=(0,a().v3)(),r=rn(e),i=an(e),l=function(e){return(0,s().K8)((()=>To(e)),[e])}(e),c=ln(e),d=cn(e),u=sn(e),p=(0,n.useCallback)((e=>An(e,t,o)),[t,o]),m=(0,n.useCallback)((()=>bn(t,o)),[t,o]),y=(0,n.useCallback)((e=>wn(e,o,t)),[o,t]),f=(0,s().K8)((()=>(null==i?void 0:i.id)||e.store.getSpaceId()||""),[i,e.store]);if(!f||!l||"select"!==l.type)return null;const g=C().L3(c,l.options||[]);return(0,Oe.jsx)(vt,{allowMultiple:!1,value:g?[g]:[],property:e.property,collectionId:f,schema:r,disabled:d,canConfigureCollection:u,onChange:y,analyticsFrom:pn(e),insertChar:e.insertChar,onAccept:p,onDismiss:m,blockStore:e.store,additionalStores:e.additionalStores,autofillExplanation:(0,Oe.jsx)(tn,{overlayState:e,propertySchema:l}),bulkAutofillButton:(0,Oe.jsx)(on,{overlayState:e,propertySchema:l}),surface:e.surface,formQuestionStore:e.formQuestionStore})},multi_select:function({overlayState:e,store:t,propertySchema:o}){const r=(0,a().v3)(),i=rn(e),l=an(e),c=ln(e),d=cn(e),u=sn(e),p=(0,s().K8)((()=>{if(!e.formQuestionStore)return!1;const t=e.formQuestionStore.getModel();return!!t&&(0,S().Fi)({formQuestionModel:t,propertySchema:o})}),[e.formQuestionStore,o]),m=(0,n.useCallback)((e=>wn(e,r,t)),[r,t]),y=(0,n.useCallback)((e=>An(e,t,r,p)),[t,r,p]),f=(0,n.useCallback)((()=>bn(t,r)),[t,r]),g=(0,s().K8)((()=>(null==l?void 0:l.id)||e.store.getSpaceId()),[l,e.store]);if(!g||!o||"multi_select"!==o.type)return null;const h=C().o2(c,o.options||[]);return(0,Oe.jsx)(vt,{allowMultiple:!p,value:h,property:e.property,collectionId:g,schema:i,disabled:d,canConfigureCollection:u,onChange:m,analyticsFrom:pn(e),insertChar:e.insertChar,onAccept:y,onDismiss:f,blockStore:e.store,additionalStores:e.additionalStores,autofillExplanation:(0,Oe.jsx)(tn,{overlayState:e,propertySchema:o}),bulkAutofillButton:(0,Oe.jsx)(on,{overlayState:e,propertySchema:o}),surface:e.surface,formQuestionStore:e.formQuestionStore})},status:function({overlayState:e,propertySchema:t,store:r}){const i=(0,a().v3)(),l=ln(e),s=cn(e),c=(0,n.useMemo)((()=>{if(!t||"status"!==t.type)return;return{initialValue:C().RZ(l,t),property:e.property,propertySchema:t,disabled:s,onDismiss:()=>bn(r,i),onChange:(n,a)=>{if(n){(()=>{const l=r.state;if(!l.isOpen||!l.store)return;const s=l.store,c=l.collectionContextStore,d=null==c?void 0:c.collectionStore();if(!s||!d)return;if(!zt((0,Wt().ot)({collectionStore:d,blockStore:s})))return;if((t.options||[]).some((e=>e.value===n)))return;const u=a??"To-do",p=(t.groups??[]).findIndex((e=>e.name===u));-1!==p&&o(596359).Uk({modification:{type:"keyedObjectListAfter",newValue:n},property:e.property,propertySchema:t,environment:i,collectionStore:d,groupIndex:p})})(),wn({type:"selectPropertyMenuUpdateReplaceOptions",options:[n]},i,r)}else a?function(e,t,o){const n=o.state;if(!n.isOpen)return;$().createAndCommit({userAction:"BlockPropertyValueOverlay.handleStatusGroupPropertyMenuUpdate",environment:t,canUndo:!0,perform:r=>{if(e.groupType){for(const o of mn(n)){var i;const a=o.getAssociatedCollectionStore();if(!a)continue;const l=a.getSchema(),s=a.getMappedProperty(n.property),c=l[s];if("status"!==(null==c?void 0:c.type))continue;const d=(c.groups??[]).find((t=>{var o;return t.name.toLowerCase()===(null===(o=e.groupType)||void 0===o?void 0:o.toLowerCase())})),u=null==d||null===(i=d.optionIds)||void 0===i?void 0:i.at(0);if(!u)continue;const p=(c.options??[]).find((e=>e.id===u));if(!p)continue;const m=o.getPropertyStore(s);X().R9({environment:t,store:m,value:[[p.value]],transaction:r})}Mn(n,t,o)}}})}({groupType:a},i,r):t.defaultOption?wn({type:"selectPropertyMenuUpdateReplaceOptions",options:[t.defaultOption]},i,r):wn({type:"selectPropertyMenuUpdateReplaceOptions",options:[]},i,r)},onAccept:e=>An(e,r,i),blockPropertyValueOverlayStore:r}}),[t,l,s,e,r,i]);if(!t||"status"!==t.type||!c)return null;return e.property===g().Hx.StatusV2?(0,Oe.jsx)(Yt,{...c}):(0,Oe.jsx)(Ht,{...c})},person:function({overlayState:e,propertySchema:t,store:r}){const i=(0,a().v3)(),l=rn(e),c=ln(e),d=(0,s().K8)((()=>{var t;return null===(t=e.collectionContextStore)||void 0===t?void 0:t.collectionStore()}),[e.collectionContextStore]),u=(0,s().K8)((()=>e.store.isTemplate()),[e]),p=cn(e),m=(0,n.useCallback)((()=>bn(r,i)),[r,i]),y=(0,n.useCallback)((e=>function(e,t,o){const n=o.state;if(!n.isOpen)return;const{collectionContextStore:r,property:i,surface:a}=n,l=null==r?void 0:r.collectionStore(),s=null==l?void 0:l.getSchema()[i];var c;l&&s&&l.isExternalSyncedCollection()&&V().j2(t,{property_id:i,property_type:(null==s?void 0:s.type)??"person",action:"person_select",from:a,integration:null===(c=l.getFormat())||void 0===c?void 0:c.external_collection_type,collection_id:l.id,is_notion_only_property:(0,nt().sc)({collectionStore:l,propertyId:i,propertySchema:s,isExternallyImportedAndSyncedCollection:l.isExternallyImportedAndSyncedCollection()})});$().createAndCommit({userAction:"BlockPropertyValueOverlay.handlePersonPropertyMenuUpdate",environment:t,canUndo:!0,perform:r=>{if(D().pN(e.schema)||hn(e.schema,r,o,t),"personPropertyMenuUpdateAddPerson"===e.type){for(const t of yn(n))for(const o of e.newValues)$().applyOperation({transaction:r,store:t,operation:{path:t.path,pointer:t.pointer,command:"addPersonAfter",args:{pointer:o}}});Mn(n,t,o,{personAddedGroupMention:e.newValues.some((e=>!(0,_().MMZ)(e)&&(0,j().I6)(e)))}),n.property!==O()._e.Owner&&"notion://wiki/owner_property"!==n.property||(0,Ke().y)({environment:t,blockStore:n.store,entrypoint:"property_menu",action:"add"})}else if("personPropertyMenuUpdateRemovePerson"===e.type){for(const t of yn(n))$().applyOperation({transaction:r,store:t,operation:{path:t.path,pointer:t.pointer,command:"removePerson",args:{pointer:e.removedValue}}});Mn(n,t,o),n.property!==O()._e.Owner&&"notion://wiki/owner_property"!==n.property||(0,Ke().y)({environment:t,blockStore:n.store,entrypoint:"property_menu",action:"remove"})}else if("personPropertyMenuUpdateReplacePerson"===e.type){const i=(0,v().R)([e.newValue]);for(const e of yn(n))X().R9({environment:t,store:e,value:i,transaction:r});Mn(n,t,o),n.property!==O()._e.Owner&&"notion://wiki/owner_property"!==n.property||(0,Ke().y)({environment:t,blockStore:n.store,entrypoint:"property_menu",action:"replace"})}else(0,R().HB)(e)}})}(e,i,r)),[i,r]),f=(0,s().K8)((()=>e.store.getCreatedByPointer()),[e]);if(!t||"person"!==t.type)return null;const g=(0,o(156736).a)({value:c,isTemplatePage:u,propertySchema:t,blockCreatorPointer:u||(0,Je().J)(e.surface)?void 0:f}),h=(0,R().O9)(t.default)&&!c&&1===g.length;return(0,Oe.jsx)(o(232376).gw,{value:g,surface:e.surface,valueIsUnpersistedDefaultValue:h,propertySchema:t,schema:l,disabled:p,onChange:y,insertChar:e.insertChar,onDismiss:m,parentStore:e.store,isTemplatePage:u,formQuestionStore:e.formQuestionStore,collectionStore:d})},number:function({overlayState:e,store:t,propertySchema:r}){const i=(0,a().v3)(),l=ln(e),s=cn(e),c=(0,n.useCallback)((e=>function(e,t,o){const n=o.state;if(!n.isOpen)return;(0,uo().YX)(e,t,yn(n)),Mn(n,t,o)}(e,i,t)),[i,t]);if(!r||"number"!==r.type)return null;const d="table"===e.surface,u=o(302322).M(l),p="large"===(null==e?void 0:e.sizing)?"large":"default";return(0,Oe.jsx)(yo,{size:p,value:u,isTable:d,format:r.number_format||"number",disabled:s,insertChar:e.insertChar,onChange:c})},date:function({overlayState:e,store:t,propertySchema:r}){const i=(0,a().v3)(),l=ln(e),c=cn(e),d=sn(e),u=(0,n.useCallback)((e=>function(e,t,o){const n=o.state;if(!n.isOpen)return;$().createAndCommit({userAction:"BlockPropertyValueOverlay.handleDatePropertyValueChange",environment:t,canUndo:!0,perform:r=>{for(const i of mn(n))!e||A().kC(e)?(q().D5({environment:t,store:i,type:"dateValue",dateValue:e,propertyId:n.property,transaction:r}),e||bn(o,t)):(z().zv({store:i.getPropertiesStore(),transaction:r,data:{[n.property]:[_().wmz(_().Ii$({type:e}))]}}),bn(o,t)),Mn(n,t,o)}})}(e,i,t)),[i,t]),p=(0,n.useCallback)((e=>function(e,t,o){const n=t.state;if(!n.isOpen)return;const r=To(n);if(!r||"date"!==r.type)return;const i=Io(n),a={...r,date_format:e},l={...i,[n.property]:a};if($().createAndCommit({userAction:"BlockPropertyValueOverlay.handleDatePropertyDateFormatChange",environment:o,canUndo:!0,perform:e=>{hn(l,e,t,o)}}),a){var s;pn(n),(0,N().L)(o,{property_type:a.type,action:"date_change_format",from:pn(n),collection_id:null===(s=wo(n))||void 0===s?void 0:s.id})}}(e,t,i)),[i,t]),m=(0,n.useCallback)((e=>function(e,t,o){const n=t.state;if(!n.isOpen)return;const r=To(n);if(!r||"date"!==r.type)return;const i=Io(n),a={...r,time_format:e},l={...i,[n.property]:a};if($().createAndCommit({userAction:"BlockPropertyValueOverlay.handleDatePropertyTimeFormatChange",environment:o,canUndo:!0,perform:e=>{hn(l,e,t,o)}}),a){var s;pn(n),(0,N().L)(o,{property_type:a.type,action:"date_change_format",from:pn(n),collection_id:null===(s=wo(n))||void 0===s?void 0:s.id})}}(e,t,i)),[i,t]),y=(0,n.useCallback)((()=>bn(t,i)),[t,i]),f=(0,s().K8)((()=>e.store.isTemplate()),[e]);if(!r||"date"!==r.type)return null;const g=(0,o(187696).b)(l),h=r.default_reminder,v=["form_editor","form_viewer"].includes(e.surface);return(0,Oe.jsx)(Zt().u2,{dependency:o(75858).cm,children:({DatePropertyMenu:t})=>(0,Oe.jsx)(t,{firstDayOfWeek:o(180252).XX.state,value:g,surface:e.surface,onChangeValue:u,dateFormat:r.date_format,onChangeDateFormat:p,timeFormat:r.time_format,defaultReminder:h,disabled:c,canConfigureCollection:d,onChangeTimeFormat:m,onDismiss:y,shouldShowReminder:!v,shouldShowControls:!v,isTemplatePage:f,formQuestionStore:e.formQuestionStore})})},file:function({overlayState:e,store:t}){const o=(0,a().v3)(),r=rn(e),i=ln(e),l=cn(e),s=C().pJ(i),c=(0,n.useCallback)((()=>bn(t,o)),[t,o]),d=(0,n.useCallback)((n=>$().createAndCommit({userAction:"BlockPropertyValueOverlay.renderFile",environment:o,canUndo:!0,perform:r=>{if(D().pN(n.schema)||hn(n.schema,r,t,o),!D().pN(n.value)){const i=C().eQ(n.value);for(const t of yn(e))X().R9({environment:o,store:t,value:i,transaction:r});Mn(e,o,t)}n.pastedSecureFile&&z().Bn({store:e.store,source:n.pastedSecureFile.copiedSource,fileIds:[n.pastedSecureFile.fileId],transaction:r})}})),[o,t,e]);return(0,Oe.jsx)(Le,{store:e.store,value:s,property:e.property,schema:r,onDismiss:c,uploadFiles:e.uploadFiles,disabled:l,onChange:d})},url:dn,phone_number:dn,email:dn,formula:function({overlayState:e,propertySchema:t,store:r}){const i=(0,a().v3)(),l=nn(e),c=cn(e),d=sn(e),u=an(e),p=(0,s().K8)((()=>e.store.getModel()),[e.store]),m=(0,n.useCallback)((()=>bn(r,i)),[r,i]),y=(0,n.useCallback)((e=>function(e,t){const{newValue:o,newType:n,propertySchema:r,property:i,collectionStore:a}=e,l=!o||F().Im(o)?{...r,formula2:void 0,version:"v2"}:{...r,formula2:{code:o,result_type:n},version:"v2"};$().createAndCommit({userAction:"CollectionFormulaOptions.handleFormulaChange",environment:t,canUndo:!0,perform:e=>{(0,Z().F)({environment:t,collectionStore:a,update:{[i]:l},transaction:e})}})}(e,i)),[i]),f=c||!d||l;if(p&&u&&t&&"formula"===t.type)return(0,Oe.jsx)(Zt().u2,{dependency:o(862292).T.formulas,children:n=>(0,Oe.jsx)(o(490696).C,{handleClose:m,property:e.property,getRecordModel:e.store.getRecordModel,propertySchema:t,collectionStore:u,handleSave:y,formulas:n,disabled:f,blockStore:e.store,analyticsFrom:pn(e)})});return null},verification:function({overlayState:e,propertySchema:t,store:r}){const i=(0,a().v3)(),l=ln(e),s=(0,n.useCallback)((t=>{$().createAndCommit({userAction:"BlockPropertyValueOverlay.verification",environment:i,canUndo:!0,perform:o=>{const n=C().j2(t.value);for(const t of yn(e))X().R9({environment:i,store:t,value:n,transaction:o});Mn(e,i,r)}}),(0,Ke().q)({environment:i,blockStore:e.store,update:t})}),[i,e,r]),c=(0,n.useCallback)((()=>bn(r,i)),[r,i]),d=(0,O().U1)(l);if("verification"!==(null==t?void 0:t.type))return null;return(0,Oe.jsx)(o(921227).y,{propertyName:t.name,onChange:s,verificationValue:d,getRecordModel:e.store.getRecordModel,blockId:e.store.id,onClose:c,showTitle:!0,showCurrentStatusHeader:!0,showRemoveVerificationButton:!0,showVerificationFooter:!0,showCustomHeader:!1,entrypoint:"db_property_menu"})},place:function({overlayState:e,propertySchema:t,propertyType:r,store:i}){const l=(0,a().v3)(),s=ln(e),c=(0,n.useCallback)((t=>{const{store:n,property:r}=e;$().createAndCommit({userAction:"BlockPropertyValueOverlay.handlePlaceChange",environment:l,canUndo:!0,perform:e=>{(0,o(454099).WQ)({environment:l,store:n,property:r,place:t.value,transaction:e})}}),Mn(e,l,i,{placeLocationSource:t.placeLocationSource})}),[l,e,i]),d=(0,n.useCallback)((()=>{bn(i,l)}),[i,l]);if("place"!==(null==t?void 0:t.type))return null;const u=(0,w().eC)(s);return(0,Oe.jsx)(zo,{placeValue:u,propertyName:t.name,onChange:c,onClose:d,insertChar:e.insertChar})},checkbox:void 0,created_by:void 0,created_time:void 0,last_edited_by:void 0,last_edited_time:void 0,last_visited_time:void 0,button:void 0,auto_increment_id:void 0,location:void 0},Zo={...mo().qs,fontWeight:E().Wy.medium},en={...mo().Zz,fontWeight:E().Wy.medium};function tn({overlayState:e,propertySchema:t}){const o=(0,l().S)(),n=(0,s().K8)((()=>(0,qt().O0)()),[]),i=(0,s().K8)((()=>no().m.isWriting()),[]),a=!(0,s().O$)(d().e),u=t&&x().$M(t)?(0,x().om)(t):void 0,p=(0,s().K8)((()=>(0,qt().ge)(null==o?void 0:o.publicEditModeStore.state,e.store)),[o,e]),m=(0,c().IS)((e=>({aiWritingLabel:{fontSize:12,color:e.aiPurpleColor,display:"flex",alignItems:"inline",fontWeight:500,padding:"8px 12px"},editContainer:{display:"flex",alignItems:"center",padding:"8px 12px"},dot:{color:e.text.tertiary},autoUpdatingLinkContainer:{paddingInlineStart:2,display:"flex",alignItems:"center"},autoUpdatingMobileLink:{paddingInlineStart:2,paddingInlineEnd:2},editMobileLink:{marginTop:6,marginBottom:2}})),[]);return n?a?null:i?(0,Oe.jsxs)(re().A,{isSecondaryColor:!0,style:m.aiWritingLabel,isSmall:!0,isMultiline:!0,children:[(0,Oe.jsx)(B().sA,{defaultMessage:"AI is writing",id:"BlockPropertyValueOverlay.AIActionText.overlay"}),(0,Oe.jsx)("div",{style:{marginInlineStart:4},children:(0,Oe.jsx)(oe().A,{})})]}):null!=u&&u.auto_update_on_edit?(0,Oe.jsxs)("div",{style:m.editContainer,children:[(0,Oe.jsx)(re().A,{isSecondaryColor:!0,style:{fontSize:12},isSmall:!0,isMultiline:!0,children:(0,Oe.jsx)(B().sA,{defaultMessage:"Auto-updated by AI",id:"BlockPropertyValueOverlay.helpText.overlay"})}),r().A.isMobile&&p?(0,Oe.jsxs)("div",{style:m.autoUpdatingLinkContainer,children:[(0,Oe.jsx)("div",{style:m.dot,children:""}),(0,Oe.jsx)(Mo,{overlayState:e,propertySchema:t,style:m.autoUpdatingMobileLink}),(0,Oe.jsx)(Ao,{overlayState:e,propertySchema:t,showSeparator:!0})]}):void 0]}):r().A.isMobile&&u&&p?(0,Oe.jsx)(Mo,{overlayState:e,propertySchema:t,style:m.editMobileLink}):null:null}function on({overlayState:e,propertySchema:t}){const{store:o}=e,r=null==t?void 0:t.name,i=(0,a().v3)(),u=(0,l().S)(),m=(0,s().K8)((()=>(0,qt().ge)(null==u?void 0:u.publicEditModeStore.state,o)),[u,o]),g=!(0,s().O$)(d().e),h=(0,s().K8)((()=>{var t;return Math.max((null===(t=e.collectionsBulkActionsToolbarStore)||void 0===t?void 0:t.getNumberOfTextStoresBeingEdited())??0,lo().default.state.stores.length)}),[e]),v=(0,c().IS)((e=>({button:{width:"100%",height:"auto",borderTop:`1px solid ${e.regularDividerColor}`},titleContainer:{fontSize:14,whiteSpace:"normal"},descriptionContainer:{fontSize:12,color:e.text.secondary,whiteSpace:"normal",lineHeight:"1.4em"}})),[]),b=(0,s().K8)((()=>o.getSpaceId()),[o]),S=(0,Jt().T)(),C=(0,so()._X)({name:"collection_property_autofill",spaceId:b,userId:S,amount:h}),k=(0,n.useCallback)((()=>{C&&((0,so().e2)(C)?function(e,t,o){const{collectionsBulkActionsToolbarStore:n}=e;if(!n)return;if((0,so().e2)(t)){let t=n.state.textStoresBeingEdited;if(0===t.length&&(t=lo().default.state.stores),!(0,R().EI)(t))return;const r=To(e);if(!r)return;Y().autofillPropertyForBlocks({environment:o,stores:t,property:e.property,propertySchema:r,userEventForAnalytics:"generate_from_overlay_button",isBulkAction:!0,from:Dt().zP(e.surface),collectionContextStore:e.collectionContextStore})}else Y().triggerAiAutofillUpsell({environment:o,from:"ai_autofill_bulk_fill",upsell:t.upsell})}(e,C,i):Y().triggerAiAutofillUpsell({environment:i,from:"ai_autofill_bulk_fill",upsell:C.upsell}))}),[e,C,i]);if(t&&m&&x().$M(t)&&(0,x().om)(t)){if(h<=1||g||!C)return null;const e=C.limit.amount;return(0,Oe.jsx)(f().p,{style:v.button,onClick:()=>k(),children:(0,Oe.jsxs)(y().fI,{gap:8,padding:"8px 0px",alignItems:"start",children:[(0,Oe.jsx)(p().I,{icon:I().x,colorPalette:"purple",colorVariant:"accentPrimary"}),(0,Oe.jsxs)(y().VP,{gap:4,children:[(0,Oe.jsx)("div",{style:v.titleContainer,children:r?(0,Oe.jsx)(B().sA,{defaultMessage:"Update {propertyName} with AI",id:"BlockPropertyValueOverlay.bulkAiAutofillButton.titleWithPropertyName",values:{propertyName:r}}):(0,Oe.jsx)(B().sA,{defaultMessage:"Update with AI",id:"BlockPropertyValueOverlay.bulkAiAutofillButton.title"})}),(0,Oe.jsx)("div",{style:v.descriptionContainer,children:(0,so().e2)(C)?(0,Oe.jsx)(B().sA,{defaultMessage:"{numPages, select, 1 {Update {numPages} page} other {Update {numPages} pages}}",id:"BlockPropertyValueOverlay.bulkAiAutofillButton.countAndDescription",values:{numPages:h}}):0===e?(0,Oe.jsx)(B().sA,{defaultMessage:"Upgrade Notion AI to update properties with AI",id:"BlockPropertyValueOverlay.bulkAiAutofillButton.largeBulkFillUpsellMessage.zeroPagesV2"}):(0,Oe.jsx)(B().sA,{defaultMessage:"Upgrade Notion AI to update more than {maxItems} pages at once",id:"BlockPropertyValueOverlay.bulkAiAutofillButton.largeBulkFillUpsellMessageV2",values:{maxItems:C.limit.amount}})})]})]})})}return null}function nn(e){return(0,s().K8)((()=>{var t;if(!e.isOpen)return!1;const o=null===(t=e.collectionContextStore)||void 0===t?void 0:t.collectionStore();if(!o)return!1;const n=e.property;return Boolean(o.getDatabaseType()&&o.isTypedProperty(n))}),[e])}function rn(e){return(0,s().K8)((()=>Io(e)),[e])}function an(e){return(0,s().K8)((()=>wo(e)),[e])}function ln(e){return(0,s().K8)((()=>un(e)),[e])}function sn(e){return(0,s().K8)((()=>{if("form_viewer"===e.surface)return!1;const t=wo(e),o=null==t?void 0:t.getParentBlockStore();return(0,ee().v)({collectionStore:t,collectionViewBlockStore:o,checkNavigableAncestorLocked:!1})}),[e])}function cn(e){const t=(0,a().v3)();return(0,s().K8)((()=>vn(e,t)),[e,t])}function dn({overlayState:e,propertyType:t,store:o}){const r=ln(e),i=_().k4p(r),l=cn(e),s=(0,a().v3)(),c=(0,n.useCallback)((e=>function(e,t,o){const n=o.state;if(!n.isOpen)return;const r=C().jw(e);$().createAndCommit({userAction:"BlockPropertyValueOverlay.handleURLValueChange",environment:t,canUndo:!0,perform:e=>{for(const o of yn(n))X().R9({environment:t,store:o,value:r,transaction:e})}}),Mn(n,t,o),V().oF(t,{pastedText:e,source:"url_property"})}(e,s,o)),[s,o]),d=(0,n.useCallback)((()=>bn(o,s)),[o,s]);let u="url";return"phone_number"===t?u="tel":"email"===t&&(u="email"),(0,Oe.jsx)(fo,{value:i,inputType:u,disabled:l,onChange:c,onDismiss:d})}function un(e){return e.store.getPropertyValue(e.property)}function pn(e){return Dt().zP(e.surface)}function mn(e){return[e.store,...e.additionalStores]}function yn(e){return mn(e).map((t=>{const o=t.getAssociatedCollectionStore(),n=o?o.getMappedProperty(e.property):e.property;return t.getPropertyStore(n)}))}function fn(e){const t=e.state;if(!t.isOpen)return"ignore";const o=To(t);return o?o.type:"ignore"}function gn({isFirstRender:e},t,o){const n=t.state;if(!n.isOpen||!n.collectionContextStore)return;const r=to().default.DO_NOT_USE_markLegacy("collections.block_property_value_overlay_render");to().default.DO_NOT_USE_measureAfterNextFlushLegacy(r,{environment:o,getData:()=>{var t;return{...ot().kz(n.collectionContextStore),is_first_render:e,property_type:null===(t=To(n))||void 0===t?void 0:t.type,from:Dt().zP(n.surface)}}})}function hn(e,t,o,n){const r=o.state;if(r.isOpen&&r.isOpen){const o=wo(r);o&&(0,J().I)({environment:n,collectionStore:o,update:{schema:e},transaction:t})}}function vn(e,t){if((0,eo().Wi)(t,e.store.id))return!0;const o=To(e),n=o&&x().$M(o)&&(0,x().om)(o);if(n&&n.auto_update_on_edit&&(0,qt().O0)())return!0;const r=wo(e);return!(!r||(0,nt().RL)({isExternallyImportedAndSyncedCollection:r.isExternallyImportedAndSyncedCollection(),propertyId:e.property,collectionStore:r,propertySchema:o})||(0,nt().JD)(r)&&"read_write"===(null==o?void 0:o.synced_permissions))||(e.readOnly||(0,Gt().Y)(t,e.store)||(0,b().u)(e.property))}function bn(e,t){co().VN({environment:t,blockPropertyValueOverlayStore:e})}function Sn(e,t){co().tY({environment:t,blockPropertyValueOverlayStore:e})}function xn(e,t,o){e.preventDefault(),co().XQ({environment:o,blockPropertyValueOverlayStore:t})}function Cn(e,t,o){e.preventDefault(),co().gu({environment:o,blockPropertyValueOverlayStore:t})}function kn(e,t){co().iF({environment:t,blockPropertyValueOverlayStore:e})}function An(e,t,o,n){const r=t.state;if(!r.isOpen)return;const a=To(r);a&&("select"===a.type||"status"===a.type||"multi_select"===a.type&&n)&&i().default.afterNextFlush((()=>{e?co().iF({environment:o,blockPropertyValueOverlayStore:t}):co().tY({environment:o,blockPropertyValueOverlayStore:t})}))}function Mn(e,t,o,n){In({environment:t,blockStore:e.store,collectionContextStore:e.collectionContextStore,propertyId:e.property,propertySchema:To(e),surface:e.surface,isOpenFromBulkActionsToolbar:Dt().pi(o),...n})}function In(e){const{environment:t,blockStore:o,collectionContextStore:n,propertyId:r,propertySchema:i,surface:a,isOpenFromBulkActionsToolbar:l,placeLocationSource:s,personAddedGroupMention:c}=e,d=o.getType(),u=o.getAssociatedCollectionId();if(d&&i&&n){const e=Dt().zP(a);(0,L().E)({environment:t,collectionContextStore:n,block_id:o.id,property:r,property_type:i.type,from:e,collection_id:u,isFromBulkActionsToolbar:l,value_count:C().o6(o.getModel(),r,i),...s&&{place_location_source:s},...c&&{person_added_group_mention:c}})}}function wn(e,t,o){const n=o.state;n.isOpen&&$().createAndCommit({userAction:"BlockPropertyValueOverlay.handleSelectPropertyMenuUpdate",environment:t,canUndo:!0,perform:r=>{if(D().pN(e.schemaOperations)||function(e,t,o,n){const r=o.state;if(r.isOpen&&r.isOpen){const o=wo(r);if(o){const r=o.getSchema();for(const n of e)$().applyOperation({store:(0,ao().v3)(o,n.pointer),operation:n,transaction:t});const i=o.getSchema();(0,G().H)({environment:n,collectionStore:o,oldSchema:r,newSchema:i,transaction:t})}}}(e.schemaOperations,r,o,t),"selectPropertyMenuUpdateReplaceOptions"===e.type){const i=C().rK(e.options);for(const e of yn(n))X().R9({environment:t,store:e,value:i,transaction:r});Mn(n,t,o)}else if("selectPropertyMenuUpdateAddOptions"===e.type){for(const t of yn(n))for(const o of e.addOptions)$().applyOperation({transaction:r,store:t,operation:{path:t.path,pointer:t.pointer,command:"addSelectOptionAfter",args:{option:o}}});Mn(n,t,o)}else if("selectPropertyMenuUpdateRemoveOption"===e.type){for(const t of yn(n))$().applyOperation({transaction:r,store:t,operation:{path:t.path,pointer:t.pointer,command:"removeSelectOption",args:{option:e.removeOption}}});Mn(n,t,o)}else"selectPropertyMenuUpdateSchema"===e.type||(0,R().HB)(e)}})}function Tn(e,t,o,n){!function(e,t,o){const n=to().default.DO_NOT_USE_markLegacy("collections.property_overlay_typing_lag");to().default.DO_NOT_USE_measureAfterNextFlushLegacy(n,{environment:o,getData:()=>({...ot().kz(e.collectionContextStore),property_type:t,from:Dt().zP(e.surface)})})}(e,t,o);const{store:r,property:i,additionalStores:a}=e,l=r.getPropertyStore(i).getValue();$().createAndCommit({userAction:"BlockPropertyValueOverlay.handleTextChange",environment:o,canUndo:!0,perform:e=>{for(const t of a)X().R9({environment:o,store:t.getPropertyStore(i),value:l,transaction:e})}}),Mn(e,o,n)}},189158:(e,t,o)=>{o.d(t,{f:()=>a});var n=()=>o(564884),r=()=>o(186445),i=()=>o(457717);function a(e,t){const o=(0,r().f)(t,{includeTeamHomeFeed:!1,includeDataSources:!1});(0,n().u)({environment:e,event:{eventName:"topbar_breadcrumb_menu_click",eventProperties:{has_parent_pages:o.length>1}}}),i().F.setState({open:!0})}},206837:(e,t,o)=>{o.d(t,{o:()=>p});o(296540);var n=()=>o(484714),r=()=>o(401497),i=()=>o(149375),a=()=>o(69708),l=()=>o(284371),s=()=>o(115512),c=()=>o(398208),d=()=>o(285790),u=o(474848);function p(e){const{label:t,onClickBackButton:o,onClose:p,width:m,showBottomBorder:y}=e,f=(0,n().v3)(),g=(0,a().tz)(),h=(0,r().IS)((e=>({container:{display:"flex",alignItems:"center",gap:4,height:40,width:m??320,paddingInlineStart:8,paddingInlineEnd:8,borderBottom:y?`1px solid ${e.regularDividerColor}`:void 0},backButton:{width:24,height:24},closeButton:{position:"absolute",insetInlineEnd:0,marginInlineEnd:8,borderRadius:"100%"},menuTitle:{flexGrow:1,fontWeight:l().Wy.semibold,fontSize:(0,s().ny)(f,"UIRegular")}})),[f,y,m]);return(0,u.jsxs)("div",{style:h.container,children:[(0,u.jsx)(d().A,{icon:i().v,ariaLabel:g.formatMessage({id:"verificationMenuHeader.backButton.ariaLabel",defaultMessage:"Back"}),onClick:()=>o(),style:h.backButton}),(0,u.jsx)("div",{style:h.menuTitle,children:t}),(0,u.jsx)(c().A,{onClose:()=>p(),style:h.closeButton})]})}},213799:(e,t,o)=>{o.d(t,{A:()=>w});o(581454);var n=o(296540),r=()=>o(17022),i=()=>o(484714),a=()=>o(56366),l=()=>o(401497),s=()=>o(201980),c=()=>o(69708),d=()=>o(100622),u=()=>o(284371),p=()=>o(21869),m=()=>o(906590),y=()=>o(750627),f=()=>o(722872),g=()=>o(77272),h=()=>o(693202),v=()=>o(491073),b=()=>o(406699),S=()=>o(404277),x=()=>o(939740),C=()=>o(45552),k=()=>o(89924),A=o(474848);const M=n.Fragment;function I({parent:e,shouldShowUpdatedColorPicker:t,textSelectionColor:o,backgroundSelectionColor:s}){const u=(0,i().v3)(),{isMobile:h}=u.device,[b,M]=(0,n.useState)((()=>r().e.withListenerIgnored((()=>g().A.state.recentlyUsedColors)))),I=(0,n.useCallback)((e=>{m().Q(e),y().po({environment:u,annotation:["h",g().A.getMostRecentlyUsedColor()]}),(0,p().s)(u,{action:"h",color:g().A.getMostRecentlyUsedColor()})}),[u]),w=(0,n.useCallback)(((e,o,n,r)=>({key:o||e,action:()=>{I(e),h&&n.close()},render:n=>(0,A.jsx)(v().Ay,{...n,color:e,overrideDisplayName:o,selected:r,shouldShowUpdatedColorPicker:t})})),[I,t,h]);let T;T=h?{menuType:f().gu.Modal,title:(0,A.jsx)(c().sA,{defaultMessage:"Text color",id:"highlightSelectionButton.mobileTextColor.label"}),right:(0,A.jsx)(C().CancelMenuText,{}),onClickRight:()=>{e.close()}}:t?{menuType:f().gu.Popup,width:190}:{menuType:f().gu.Popup,width:220};const P=b.map((t=>w(t,void 0,e,!1))),j=(0,a().K8)((()=>g().A.getMostRecentlyUsedColor()),[]),_=d().N.map((t=>w(t,void 0,e,o||s?t===o:"default"===t))),O=d().AQ.map((t=>w(t,void 0,e,t===s))),B=(0,l().IS)((e=>({blockColorMenuItemContainer:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:4,paddingTop:0,paddingBottom:0,paddingInlineStart:8,paddingInlineEnd:8},sectionMenuItemOverride:{display:"block"}})),[]);return(0,A.jsx)(S().A,{...T,children:(0,A.jsx)(x().Ay,{type:x().Oh.Vertical,sections:[{key:0,items:t?P:[{key:0,action:()=>{I(j),h&&e.close()},render:e=>(0,A.jsx)(v().Ay,{...e,color:j,shortcuts:["toggleHighlight"]})}],render:e=>(0,A.jsx)(k().A,{...e,title:(0,A.jsx)(c().sA,{defaultMessage:"Recently used",id:"highlightSelectionButton.lastUsedSection.label"}),desktopStyle:B.sectionMenuItemOverride,children:t?(0,A.jsx)("div",{style:B.blockColorMenuItemContainer,children:e.children}):e.children})},{key:1,items:_,render:e=>(0,A.jsx)(k().A,{...e,title:(0,A.jsx)(c().sA,{defaultMessage:"Text color",id:"highlightSelectionButton.colorSection.label"}),desktopStyle:B.sectionMenuItemOverride,children:t?(0,A.jsx)("div",{style:B.blockColorMenuItemContainer,children:e.children}):e.children})},{key:2,items:O,render:e=>(0,A.jsx)(k().A,{...e,title:(0,A.jsx)(c().sA,{defaultMessage:"Background color",id:"highlightSelectionButton.backgroundSection.label"}),desktopStyle:B.sectionMenuItemOverride,children:t?(0,A.jsx)("div",{style:{...B.blockColorMenuItemContainer,paddingBottom:8},children:e.children}):e.children})}],initialFocus:void 0})})}const w=function(e){const{disabled:t,style:r,blockStore:m}=e,y=(0,i().v3)(),f=(0,l().DP)(),g=(0,n.useCallback)((e=>{(0,p().s)(y,{action:"h"})}),[y]),S=(0,n.useCallback)((()=>{h().default.emit()}),[]),x=!y.device.isMobile,{textSelectionColor:C,backgroundSelectionColor:k}=(0,a().K8)((()=>{if("editing"!==h().default.state.mode)return{textSelectionColor:void 0,backgroundSelectionColor:void 0};const e=(0,o(792002).x7)(["hf","hb"],h().default.state.multiSelection,h().default.state.forceExtendAnnotations),t=e.hf,n=e.hb;let r="default",i="default_background";if(t&&s().YuY(t))r=s().uIc(t);else if(m){const{block_color:e}=m.getFormat();e&&(0,o(534177).Xk)(d().N,e)&&(r=e)}return n&&s().YuY(n)&&(i=s().uIc(n)),{textSelectionColor:r,backgroundSelectionColor:i}}),[m]),w=(0,l().IS)((e=>{const t=(0,d().D$)(C??"default",e),o=(0,d().D$)(k??"default_background",e),n="default"!==C||void 0===o.background?t:o,r=(0,v().Nc)(k??"default_background",!1,e);return{colorIcon:{display:"inline-flex",alignItems:"center",justifyContent:"center",height:18,textAlign:"center",fontSize:15,borderRadius:2,...!y.device.isMobile&&{width:18,fontWeight:u().Wy.medium,marginBottom:2},...o,...t},colorIconCircle:x?{display:"inline-flex",alignItems:"center",justifyContent:"center",width:24,height:24,textAlign:"center",padding:8,margin:0,fontSize:16,borderRadius:6,fontWeight:u().Wy.medium,color:t.color,background:o.background,boxShadow:(0,v().Yr)(r,!1)}:{width:16,height:16,borderRadius:8,background:n.color??n.fill??n.background}}}),[C,k,y.device.isMobile,x]);return(0,A.jsx)(b().A,{popupType:y.device.isMobile?b().z.SlideUp:b().z.Popup,originGap:4,onClose:S,onClick:g,renderOrigin:e=>(0,A.jsx)(o(859428).A,{renderTooltip:()=>(0,A.jsxs)(M,{children:[(0,A.jsx)("div",{children:(0,A.jsx)(c().sA,{defaultMessage:"Text color",id:"highlightSelectionButton.textColor.tooltip"})}),(0,A.jsx)("div",{children:(0,A.jsx)(o(35392).A,{style:{color:f.text.inverseSecondary},name:"toggleHighlight"})})]}),render:n=>(0,A.jsxs)(o(718827).Ay,{style:{display:"flex",alignItems:"center",paddingInlineStart:7,paddingInlineEnd:6,whiteSpace:"nowrap",borderRadius:6,gap:6,...r},disabled:t,disabledFeedback:t,...(0,o(553965).A)(e,n),children:[y.device.isMobile?(0,A.jsx)("div",{style:w.colorIcon,children:(0,A.jsx)(c().sA,{defaultMessage:"Color",id:"highlightSelectionButton.mobileColorIcon.label"})}):(0,A.jsx)("div",{style:w.colorIconCircle,children:x?"A":""}),(0,A.jsx)(o(252291).I,{icon:o(324254).arrowChevronSingleDownSmallIcon,size:"xs",colorVariant:"tertiary",fitToViewBox:"horizontal"})]})}),render:e=>(0,A.jsx)(I,{parent:e,shouldShowUpdatedColorPicker:x,textSelectionColor:C,backgroundSelectionColor:k})})}},236228:(e,t,o)=>{o.d(t,{A:()=>a});var n=o(296540),r=()=>o(56366),i=o(474848);const a=function(e){const{disabled:t,type:a,tooltipLabel:l,children:s,style:c,onClick:d}=e,u=(0,o(484714).v3)(),p=(0,n.useCallback)((e=>{a!==o(201980).Ifu.TemporarySuggestionUnderline&&(o(750627).po({environment:u,annotation:[a]}),d&&d(),(0,o(21869).s)(u,{action:a}))}),[u,a,d]),m=(0,r().K8)((()=>t||"editing"!==o(693202).default.state.mode),[t]),y=(0,r().K8)((()=>Boolean((0,o(792002).B1)(a))),[a]),f=(0,o(401497).IS)((e=>({button:{display:"flex",alignItems:"center",fill:y?e.blue.icon.accentPrimary:e.icon.primary,borderRadius:6,height:28,width:28,padding:6,...c}})),[y,c]);return(0,i.jsx)(o(859428).A,{renderTooltip:()=>l,render:e=>(0,i.jsx)(o(718827).Ay,{style:f.button,disabled:m,disabledFeedback:m,onClick:p,...e,children:s})})}},318890:(e,t,o)=>{o.d(t,{K:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("aiTranslate",{viewBox:"0 0 16 16",svg:(0,n.jsxs)("g",{children:[(0,n.jsx)("path",{d:"M0.990263 11.9374C1.50923 11.9374 1.80048 11.6727 1.98582 11.0266L2.2453 10.2111H4.86129L5.12077 11.0584C5.29023 11.6833 5.58149 11.9374 6.14281 11.9374C6.70943 11.9374 7.11719 11.5509 7.11719 11.0054C7.11719 10.8042 7.08012 10.6241 6.9901 10.3753L5.089 5.19623C4.79775 4.4019 4.33174 4.06299 3.53212 4.06299C2.77486 4.06299 2.30355 4.41779 2.02289 5.19623L0.137684 10.3753C0.0529553 10.6083 0 10.8466 0 11.0107C0 11.5879 0.375982 11.9374 0.990263 11.9374ZM2.63188 8.74423L3.50034 5.79992H3.54271L4.43765 8.74423H2.63188Z"}),(0,n.jsx)("path",{d:"M9.92506 8.57591C9.38887 8.91351 9.12077 9.32393 9.12077 9.80717C9.12077 10.0653 9.18035 10.2672 9.29951 10.4129C9.42528 10.5519 9.59739 10.6214 9.81584 10.6214C9.82908 10.6214 9.84563 10.6214 9.86549 10.6214C9.88535 10.6148 9.89859 10.6115 9.9052 10.6115C9.96478 10.6115 9.99457 10.5817 9.99457 10.5221V8.6057C9.99457 8.55274 9.9714 8.54281 9.92506 8.57591ZM12.3776 7.97021C12.0864 7.97021 11.805 7.99007 11.5336 8.02979C11.4807 8.04303 11.4542 8.07282 11.4542 8.11915V9.68801C11.4542 9.70125 11.4608 9.71118 11.4741 9.7178C11.4939 9.72442 11.5072 9.72111 11.5138 9.70787C11.9441 9.25773 12.3081 8.70499 12.606 8.04965C12.6126 8.02979 12.6093 8.01324 12.5961 8C12.5829 7.98014 12.5663 7.97021 12.5464 7.97021H12.3776ZM9.64704 11.9718C9.03141 11.9718 8.53493 11.7931 8.15761 11.4356C7.78691 11.0781 7.60156 10.5916 7.60156 9.97597C7.60156 9.30738 7.80346 8.71492 8.20726 8.19859C8.61106 7.67564 9.18366 7.27846 9.92506 7.00705C9.9714 6.98719 9.99457 6.95078 9.99457 6.89783V6.03396C9.99457 5.981 9.96809 5.95452 9.91513 5.95452H8.6243C8.47205 5.95452 8.33966 5.89826 8.22712 5.78572C8.11459 5.67319 8.05832 5.54079 8.05832 5.38854V5.2396C8.05832 5.08735 8.11459 4.95496 8.22712 4.84242C8.33966 4.72989 8.47205 4.67362 8.6243 4.67362H9.91513C9.96809 4.67362 9.99457 4.64714 9.99457 4.59418V4.17715C9.99457 4.02489 10.0508 3.89581 10.1634 3.7899C10.2759 3.67736 10.4083 3.62109 10.5606 3.62109H10.8882C11.0405 3.62109 11.1729 3.67736 11.2854 3.7899C11.3979 3.89581 11.4542 4.02489 11.4542 4.17715V4.59418C11.4542 4.64714 11.484 4.67362 11.5436 4.67362H14.9792C15.1314 4.67362 15.2638 4.72989 15.3764 4.84242C15.4889 4.95496 15.5452 5.08735 15.5452 5.2396V5.38854C15.5452 5.54079 15.4889 5.67319 15.3764 5.78572C15.2638 5.89826 15.1314 5.95452 14.9792 5.95452H11.5436C11.484 5.95452 11.4542 5.981 11.4542 6.03396V6.58008C11.4542 6.62642 11.4807 6.64959 11.5336 6.64959C11.7719 6.62311 12.0533 6.60987 12.3776 6.60987C13.5427 6.60987 14.4364 6.86473 15.0586 7.37444C15.6875 7.87754 16.0019 8.56598 16.0019 9.43978C16.0019 10.1216 15.7934 10.7174 15.3764 11.2271C14.9659 11.7302 14.3966 12.0976 13.6685 12.3293C13.5228 12.3756 13.3805 12.359 13.2415 12.2796C13.1025 12.2002 13.0098 12.0843 12.9635 11.9321L12.8741 11.6541C12.8278 11.515 12.841 11.3793 12.9138 11.2469C12.9867 11.1079 13.0959 11.0086 13.2415 10.9491C13.6188 10.7902 13.92 10.575 14.1451 10.3036C14.3702 10.0322 14.4827 9.74428 14.4827 9.43978C14.4827 9.00288 14.3437 8.66197 14.0657 8.41704C14.0326 8.38394 14.0028 8.39718 13.9763 8.45676C13.5063 9.57548 12.8807 10.4427 12.0996 11.0583C11.3251 11.6673 10.5076 11.9718 9.64704 11.9718Z"})]})})},398208:(e,t,o)=>{o.d(t,{A:()=>a});var n=o(296540),r=o(474848);function i({onClose:e,style:t}){const n=(0,o(69708).tz)(),{isMobile:i}=(0,o(484714).Y0)(),a=(0,o(401497).IS)((()=>({closeButton:{borderRadius:"100%",width:i?28:22,height:i?28:22,...t},closeButtonIconStyle:i?{width:18,height:18}:{}})),[i,t]);return(0,r.jsx)(o(285790).A,{iconStyle:a.closeButtonIconStyle,style:a.closeButton,hovered:!0,icon:o(66913).V,onClick:e,ariaLabel:n.formatMessage({id:"circleCloseButton.ariaLabel",defaultMessage:"Close"})})}const a=n.memo(i)},417123:(e,t,o)=>{o.d(t,{z:()=>s});var n=()=>o(842599),r=()=>o(798880),i=()=>o(495989),a=()=>o(519979),l=()=>o(870092);async function s({userId:e,spaceStore:t,environment:o}){var s,c;if(!e||!t)return;const d=new(a().G)(o,{table:i().xM,id:e}),u=new(l().L)(o,{table:r().oo,id:e});await Promise.all([d.load(),u.load()]);const p=u.getEmail(),m=p?(0,n().zN)(p):void 0,y=null===(s=d.getSettings())||void 0===s?void 0:s.domain_type,f=m&&(0,n().Ff)(m),g=y?"professional"!==y:f,h=null===(c=t.getPublicSpaceData())||void 0===c?void 0:c.createdByDomain;return g||m!==h?"personal":"work"}},446027:(e,t,o)=>{o.d(t,{A:()=>n});const n=new(o(463830).A)},448360:(e,t,o)=>{o.d(t,{W:()=>n});const n=o(757695).Store.createValue(!1,{name:"AiPageTranslationCalloutStore"})},454099:(e,t,o)=>{o.d(t,{Mj:()=>b,WQ:()=>S,gh:()=>x});var n=()=>o(726637),r=()=>o(584262),i=()=>o(96330),a=()=>o(201980),l=()=>o(970330),s=()=>o(857783),c=()=>o(281948),d=()=>o(319975),u=()=>o(231297),p=()=>o(755199),m=()=>o(766854),y=()=>o(357643),f=()=>o(177618),g=()=>o(476492),h=()=>o(765957),v=()=>o(50764);function b(e){const{environment:t,place:o,collectionContextStore:i,query:a,schema:d,isFullScreen:p,store:h}=e,b="map_add_item";u().createAndCommit({userAction:"CollectionMapView.handleClick",environment:t,canUndo:!0,perform:e=>{const u=function(e){const{environment:t,transaction:o,place:i,query:a,isFullScreen:l,groupFormat:d,collectionContextStore:u,from:p}=e;if(!(0,v().E)(t))return;const g=d?[d]:[],h=u.groupsStore.getGroupState(g);if(!h)return;u.searchQueryStore.state&&(0,y().S)({searchQuery:"",collectionContextStore:u,isFullScreen:l});const b=(0,m().Q)({environment:t,collectionContextStore:u,groupsPointer:g,shouldCoerce:!0,templateStore:u.defaultPageTemplateStore.state,transaction:o,from:{createBlock:p},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache});if(!b)return;const x=b.newStore,C=a.map_by;if(!C)return;S({environment:t,store:x,property:C,place:i,transaction:o}),n().A.isMobile?s().uK({environment:t,store:x,pageVisitSource:r().y8.Create}):c().VU({environment:t,store:x,peekMode:(0,f().hH)(u),resultsStore:null==h?void 0:h.resultsStore,collectionContextStore:u,pageVisitSource:r().y8.Create});return x}({environment:t,transaction:e,store:h,query:a,schema:d,place:o,isFullScreen:p,groupFormat:void 0,collectionContextStore:i,from:b});l().vH(t,{from:b,type:"page",new_page_id:null==u?void 0:u.id,creating_block_id:null==u?void 0:u.id,...(0,g().sl)(i)})}})}function S(e){const{environment:t,store:o,place:n,transaction:r,property:l}=e,s=o.getAssociatedCollectionStore(),c=(null==s?void 0:s.getMappedProperty(l))??l,u=o.getPropertyStore(c),p=o.getTitleStore(),m=(null==n?void 0:n.name)??(null==n?void 0:n.address),y=null==p?void 0:p.getValue(),f=(0,i().eC)(u.getValue()),g=(0,i().X1)(f),h=!y&&m||(0,a().AGB)(y,[[String(g)]]);return p&&h&&d().R9({environment:t,store:p,value:m?[[m]]:void 0,transaction:r}),d().R9({environment:t,store:u,value:(0,i().tk)(n),transaction:r}),o}function x(e){const{environment:t,transaction:o}=e,{currentUserSettingsStore:n}=h().default.state;if(!n)return;const r=e=>{p().mJ({userSettingsStore:n,transaction:e,data:{map_view_new_button_clicked_at:Date.now()}})};o?r(o):u().createAndCommit({environment:t,userAction:"collectionMapActions.markMapViewNewButtonClicked",canUndo:!1,cellTarget:"main",perform:e=>r(e)})}},465741:(e,t,o)=>{o.d(t,{C0:()=>I,CK:()=>B,Dx:()=>j,Fc:()=>R,Gi:()=>C,Hd:()=>D,KU:()=>L,TW:()=>O,Vm:()=>E,YA:()=>P,d0:()=>S,eb:()=>x,ls:()=>w,mY:()=>A,px:()=>T});o(16280),o(296540);var n=()=>o(56366),r=()=>o(584262),i=()=>o(31503),a=()=>o(898244),l=()=>o(713998),s=()=>o(69708),c=()=>o(284371),d=()=>o(720665),u=()=>o(901389),p=()=>o(476492),m=()=>o(492414),y=()=>o(972435),f=()=>o(329443),g=()=>o(543665),h=()=>o(808655),v=()=>o(98205),b=o(474848);const S=5e3,x=500,C=(0,s().YK)({characterLimitReached:{defaultMessage:"Character limit reached.",id:"form.characterLimitReached"},questionLimitReachedTitle:{defaultMessage:"Question limit reached",id:"form.questionLimitReached.title"},questionLimitReachedSubtitle:{defaultMessage:"Please delete a question before creating a new one.",id:"form.questionLimitReached.subtitle"},questionLimitReachedFullMessage:{defaultMessage:"Question limit reached. Please delete a question before creating a new one.",id:"form.questionLimitReached.fullMessage"}}),k=(0,s().YK)({title:{defaultMessage:"Title",id:"database.questionTypeName.title"},text:{defaultMessage:"Text",id:"database.questionTypeName.text"},number:{defaultMessage:"Number",id:"database.questionTypeName.numberTypeLabel"},url:{defaultMessage:"URL",id:"database.questionTypeName.url"},multi_select:{defaultMessage:"Multiple choice",id:"database.questionTypeName.multi_select"},person:{defaultMessage:"Person",id:"database.questionTypeName.person"},email:{defaultMessage:"Email",id:"database.questionTypeName.email"},phone_number:{defaultMessage:"Phone",id:"database.questionTypeName.phone_number"},date:{defaultMessage:"Date",id:"database.questionTypeName.dateTypeLabel"},file:{defaultMessage:"Files & media",id:"database.questionTypeName.file"},checkbox:{defaultMessage:"Checkbox",id:"database.questionTypeName.checkbox"},relation:{defaultMessage:"Relation",id:"database.questionTypeName.relation"},place:{defaultMessage:"Place",id:"database.questionTypeName.place"}}),A={title:y().A.formatMessage(k.title),text:y().A.formatMessage(k.text),number:y().A.formatMessage(k.number),url:y().A.formatMessage(k.url),multi_select:y().A.formatMessage(k.multi_select),person:y().A.formatMessage(k.person),email:y().A.formatMessage(k.email),phone_number:y().A.formatMessage(k.phone_number),date:y().A.formatMessage(k.date),file:y().A.formatMessage(k.file),checkbox:y().A.formatMessage(k.checkbox),relation:y().A.formatMessage(k.relation),place:y().A.formatMessage(k.place)},M=["relation","person"];function I(e,t){return t?"closed":e?"shared_to_web":"shared_to_space"}function w(e){const{formSharingState:t,isOverBlockLimit:o,spaceName:n}=e;if(o)return(0,b.jsx)(s().sA,{id:"editorFormResponderWarning.overBlockLimit.message",defaultMessage:"You are over the block limit. No new responses can be submitted through this form."});switch(t){case"closed":return(0,b.jsx)(s().sA,{id:"editorFormResponderWarning.closed.message",defaultMessage:"This form is closed. No new responses can be submitted."});case"shared_to_web":return(0,b.jsx)(s().sA,{id:"editorFormResponderWarning.public.message",defaultMessage:"This form is public. Anyone with the link can submit a response."});case"shared_to_space":return(0,b.jsx)(s().sA,{id:"editorFormResponderWarning.internal.message",defaultMessage:"Only members at {spaceName} can fill out this form.",values:{spaceName:n}})}}function T(e,t=!1){return e.getIsFormPublic()?(0,m().Ay)({store:e,preferPublicLink:!0,pageVisitSource:r().y8.FormPublicPage}):(0,m().Ay)({store:e,openInCenterPeek:t,pageVisitSource:r().y8.FormInternalPage})}function P({collectionContextStore:e,propertyId:t,questionId:o,area:n,parentModuleId:r,layoutStore:i}){var a,l;const s=e?(0,p().sl)(e):void 0,c=null==e?void 0:e.collectionViewStore(),d=null==e?void 0:e.collectionStore(),u=null==c?void 0:c.getFormat(),m=null==u||null===(a=u.form_block_pointer)||void 0===a?void 0:a.id,y=null==e||null===(l=e.normalizedSchemaStore.state)||void 0===l||null===(l=l[t])||void 0===l?void 0:l.type;if(!d)throw new Error("Collection store is undefined");return{question_type:y,question_id:o,form_id:m,is_conditional:"form_conditional_modules"===n,parent_question_type:(0,v()._N)(r,i,d),...s??{}}}function j(e){const t=null==e?void 0:e.getFormat().form_layout_pointer;if(t)return h().K.createChildStore(e,t)}const _=new(o(178624).R)({key:"opt_out_form_content_warning",namespace:o(553737).cd,important:!1,trackingType:"preference"});function O(e){const t=_.getState(),o=void 0===t||Date.now()-t>d().nD,n="file"===e.propertyType?(0,b.jsx)(s().sA,{id:"collectionFormHelpers.maybeWarnAboutMaliciousContent.file.message",defaultMessage:"Download file?"}):(0,b.jsx)(s().sA,{id:"collectionFormHelpers.maybeWarnAboutMaliciousContent.url.message",defaultMessage:"Open link?"}),r=(0,b.jsx)(s().sA,{id:"collectionFormHelpers.maybeWarnAboutMaliciousContent.description",defaultMessage:"This content was submitted anonymously. Only proceed if you trust the source."}),i="file"===e.propertyType?(0,b.jsx)(s().sA,{id:"collectionFormHelpers.maybeWarnAboutMaliciousContent.file.confirmLabel",defaultMessage:"Download anyway"}):(0,b.jsx)(s().sA,{id:"collectionFormHelpers.maybeWarnAboutMaliciousContent.url.confirmLabel",defaultMessage:"Open anyway"});o?u().ui({showCancel:!1,showCloseButton:!0,keepFocus:!0,mode:"wide",message:(0,b.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"center",fontWeight:c().Wy.medium},children:n}),description:(0,b.jsx)("div",{style:{textAlign:"center",fontSize:14},children:r}),items:[{label:i,onAccept:e.onConfirm,color:"red",buttonType:"solid"}],selectionItems:[{key:"opt_out",showBelowButtons:!0,text:(0,b.jsx)("span",{style:{fontWeight:c().Wy.regular},children:(0,b.jsx)(s().sA,{id:"collectionFormHelpers.maybeWarnAboutMaliciousContent.optOut",defaultMessage:"Dont show again for 24 hours"})}),onSelect:e=>{!0===e?_.setState(Date.now()):_.setState(void 0)}}]}):e.onConfirm()}function B(e){const{environment:t,propertyType:o,propertySchema:n,isPublicForm:r}=e;if(r&&M.includes(o)){if("person"===o)return"invalid_property_type_for_public_form";if("relation"===(null==n?void 0:n.type)){const e=(0,a().Nv)(n);if(e){const o=new(g().m)(t,e);if(o.isDefined()){if(!(0,f().qw)(o))return"related_collection_not_public"}}}}}const F=(0,s().YK)({checkboxYes:{id:"FormResponseSnapshotModal.Checkbox.Yes",defaultMessage:"Yes"},checkboxNo:{id:"FormResponseSnapshotModal.Checkbox.No",defaultMessage:"No"}});function R(e){return"true"===e?y().A.formatMessage(F.checkboxYes):y().A.formatMessage(F.checkboxNo)}function E(e){const{formQuestionStore:t,propertySchema:o}=e;return(0,n().K8)((()=>{const e=null==t?void 0:t.getModel();return!(!e||!o)&&((0,i().Fi)({formQuestionModel:e,propertySchema:o})||"select"===(null==o?void 0:o.type))}),[t,o])}function D(e){const{draftFormBlockStore:t,formQuestionStore:o,propertyId:n,propertySchema:r}=e;if(!t||!n||!r)return;if("multi_select"!==r.type&&"select"!==r.type)return;const a=t.getPropertyValue(n);if("select"===r.type)return(0,l().L3)(a,r.options??[]);const s=o.getModel();if(s&&!(0,i().Fi)({formQuestionModel:s,propertySchema:r}))return;const c=(0,l().o2)(a,r.options??[]);return 1===c.length?c[0]:void 0}function L(e){var t;const{formQuestionStore:o,propertySchema:n}=e;if(n&&(0,a().lx)(n))return(null===(t=o.getPropertyTypeSpecificConfig(n.type))||void 0===t?void 0:t.displayMode)??"list"}},563015:(e,t,o)=>{o.d(t,{eJ:()=>f,ew:()=>y,ml:()=>d,rA:()=>p,yI:()=>m,zf:()=>u});o(581454);var n=()=>o(496603),r=()=>o(534177),i=()=>o(708685),a=()=>o(145076),l=()=>o(349835),s=()=>o(239381);function c(e){switch(e){case"checkbox":return"boolean";case"number":return"number";case"text":return"text";case"date":return"date";case"array":return"array";case"block":return"block";case"person":return"person";case"select":return"select";case"function":return"function";case"unknown":return"unknown";case"undefined":return"undefined";default:(0,r().HB)(e)}}function d(e){switch(e.type){case l().M9.InvalidCharacter:return{...a().x0.InvalidCharacter,values:{errorCharacter:e.character}};case l().M9.UnclosedStringLiteral:return a().x0.UnclosedStringLiteral;case l().M9.UnclosedComment:return a().x0.UnclosedComment;case l().M9.TokenExpected:return{...a().x0.TokenExpected,values:{expectedToken:e.token}};case l().M9.StringLiteralContainsToken:return a().x0.StringLiteralContainsToken;case l().M9.ExpressionExpected:return a().x0.ExpressionExpected;case l().M9.PropertyTokenOrFunctionExpected:return a().x0.PropertyTokenOrFunctionExpected;case l().M9.EndOfInputExpected:return a().x0.EndOfInputExpected;case l().M9.UnexpectedError:return a().x0.UnexpectedError;case l().M9.TooDeeplyNested:return a().x0.TooDeeplyNested;default:(0,r().HB)(e)}}function u(e){switch(e.type){case l().IA.FunctionCallArgumentWrongType:case l().IA.FunctionCallUnexpectedArgument:return e.argument;default:return e.node}}function p(e,t){let o;switch(t.type){case l().IA.ThisRowTypeNotFound:o=a().Xz.ThisRowTypeNotFound;break;case l().IA.ThisRowNotBlockWithCollection:o=a().Xz.ThisRowNotBlockWithCollection;break;case l().IA.MissingPropertyOnThisRow:o={...a().Xz.MissingPropertyOnThisRow,values:{propertyName:t.property}};break;case l().IA.MissingContextVariable:{const e=(0,s().ix)(t.token)?t.token.contextValueId:t.token.valueId;o={...a().Xz.MissingContextVariable,values:{valueId:e}}}break;case l().IA.MissingBlock:o={...a().Xz.MissingBlock,values:{blockId:t.token.blockId}};break;case l().IA.CallingNotFunction:o={...a().Xz.CallingNotFunction,values:{expressionType:c(t.callee.type.type)}};break;case l().IA.FunctionCallTooFewArguments:o={...a().Xz.FunctionCallTooFewArguments,values:{minNumParameters:t.minNumParameters,functionName:t.libraryFunction.name,numArguments:t.numArguments}};break;case l().IA.FunctionCallUnexpectedArgument:o={...a().Xz.FunctionCallUnexpectedArgument,values:{functionName:t.libraryFunction.name}};break;case l().IA.FunctionCallArgumentWrongType:o={...a().Xz.FunctionCallArgumentWrongType,values:{argumentType:c(t.argument.type.type),functionName:t.libraryFunction.name}};break;case l().IA.MemberPropertyMismatchCollection:o={...a().Xz.MemberPropertyMismatchCollection,values:{propertyName:t.token.property}};break;case l().IA.MemberPropertyMissing:o={...a().Xz.MemberPropertyMissing,values:{propertyName:t.property}};break;case l().IA.MemberPropertyTargetNotBlock:o=a().Xz.MemberPropertyTargetNotBlock;break;case l().IA.MemberPropertyTypeInvalid:o={...a().Xz.MemberPropertyTypeInvalid,values:{propertyName:t.propertyName,propertyType:t.propertyType}};break;case l().IA.UndefinedIdentifier:o={...a().Xz.UndefinedIdentifier,values:{identifier:t.node.text}};break;case l().IA.InvalidPropCall:o={...a().Xz.InvalidPropCall,values:{propertyName:t.name}};break;case l().IA.InvalidContextCall:o={...a().Xz.InvalidContextCall,values:{variableName:t.name}};break;case l().IA.InvalidVariableCall:o={...a().Xz.InvalidVariableCall,values:{variableName:t.name}};break;case l().IA.UnifiedFunctionCannotFindFunction:o={...a().Xz.UnifiedFunctionCannotFindFunction,values:{functionName:t.name}};break;case l().IA.UnifiedFunctionNoArguments:o={...a().Xz.UnifiedFunctionNoArguments,values:{functionName:t.libraryFunction.name}};break;case l().IA.UnifiedFunctionTargetWrongType:o={...a().Xz.UnifiedFunctionTargetWrongType,values:{functionName:t.libraryFunction.name,targetType:c(t.expression.type.type)}};break;case l().IA.CannotRelativelyCompareTypes:o={...a().Xz.CannotRelativelyCompareTypes,values:{lhsType:c(t.lhsType.type),rhsType:c(t.rhsType.type)}};break;case l().IA.CannotDoMathOnType:o={...a().Xz.CannotDoMathOnType,values:{lhsType:c(t.lhsType.type),rhsType:c(t.rhsType.type)}};break;case l().IA.UnaryMinusOnNonNumber:o={...a().Xz.UnaryMinusOnNonNumber,values:{type:c(t.expression.type.type)}};break;case l().IA.IdentifierExpected:o=a().Xz.IdentifierExpected;break;case l().IA.FunctionCallExpected:o={...a().Xz.FunctionCallExpected,values:{functionName:t.functionName}};break;case l().IA.RenamedIdentifier:o={...a().Xz.RenamedIdentifier,values:{identifier:t.identifier,renamedTo:t.renamedTo}};break;case l().IA.RemovedFunction:o={...a().Xz.RemovedFunction,values:{functionName:t.functionName,alternative:t.alternative}};break;case l().IA.ContextVariableNotBlockWithCollection:o={...a().Xz.ContextVariableNotBlockWithCollection,values:{valueId:t.token.contextValueId}};break;case l().IA.MissingPropertyOnContextVariable:o={...a().Xz.MissingPropertyOnContextVariable,values:{propertyName:t.property,valueId:t.token.contextValueId}};break;case l().IA.BlockPropertyTypeInvalid:o={...a().Xz.BlockPropertyTypeInvalid,values:{propertyName:t.propertyName}};break;case l().IA.DisallowedReturnType:{const n=t.allowedReturnTypes.map((t=>e.formatMessage((0,i().getHumanReadableType)(t)).toLocaleLowerCase()));o={...a().Xz.DisallowedReturnType,values:{allowedReturnType:e.formatList(n,{style:"long",type:"conjunction"}),allowedReturnTypeCount:t.allowedReturnTypes.length,returnType:e.formatMessage((0,i().getHumanReadableType)(t.returnType)).toLocaleLowerCase()}};break}case l().IA.CrossSpacePropertyNotSupported:o={...a().Xz.CrossSpacePropertyNotSupported};break;case l().IA.CalledFunctionOnEmptyValue:o={...a().Xz.CalledFunctionOnEmptyValue};break;default:(0,r().HB)(t)}return{...o,values:{...o.values,startOffset:t.node.startOffset,endOffset:t.node.endOffset+1}}}function m(e,t){let o;switch(t.type){case l().uW.MissingThisRow:o=a().X8.MissingThisRow;break;case l().uW.MissingSchemaPropertyOnThisRow:o={...a().X8.MissingSchemaPropertyOnThisRow,values:{propertyName:t.property}};break;case l().uW.ThisRowBlockPropertyMismatchCollection:o=a().X8.ThisRowBlockPropertyMismatchCollection;break;case l().uW.MissingContextVariable:o={...a().X8.MissingContextVariable,values:{valueId:t.valueId}};break;case l().uW.IdentifierNotFound:o={...a().X8.IdentifierNotFound,values:{identifier:t.node.text}};break;case l().uW.CannotRelativelyCompareTypes:o={...a().X8.CannotRelativelyCompareTypes,values:{lhsType:c(t.lhsType),rhsType:c(t.rhsType)}};break;case l().uW.CannotDoMathOnType:o={...a().X8.CannotDoMathOnType,values:{valueType:c(t.valueType)}};break;case l().uW.CannotCallNonFunction:o={...a().X8.CannotCallNonFunction,values:{calleeType:c(t.calleeType)}};break;case l().uW.UnifiedFunctionPropertyNotFound:o={...a().X8.UnifiedFunctionPropertyNotFound,values:{functionName:t.node.name}};break;case l().uW.LibraryFunctionExecutionError:const n=t.error instanceof l().x4?t.error:void 0;o=(null==n?void 0:n.info.type)===l().v3.DateInvalidDurationUnit?{...a().gW.DateInvalidDurationUnit,values:{functionName:t.libraryFunction.name,invalidUnit:n.info.invalidUnit}}:(null==n?void 0:n.info.type)===l().v3.CannotUseToNumberOnList?{...a().gW.CannotUseToNumberOnList}:(null==n?void 0:n.info.type)===l().v3.CannotRoundToNonInteger?{...a().gW.CannotRoundToNonInteger,values:{precision:n.info.precision}}:(null==n?void 0:n.info.type)===l().v3.CannotRoundToTooManyDecimalPlaces?{...a().gW.CannotRoundToTooManyDecimalPlaces,values:{precision:n.info.precision}}:(null==n?void 0:n.info.type)===l().v3.NumberFormatInvalid?{...a().gW.NumberFormatInvalid,values:{invalidFormat:n.info.invalidFormat}}:{...a().X8.LibraryFunctionExecutionError,values:{functionName:t.libraryFunction.name}};break;case l().uW.FunctionCallTooFewArguments:o={...a().X8.FunctionCallTooFewArguments,values:{functionName:t.libraryFunction.name}};break;case l().uW.FunctionCallUnexpectedArgument:o={...a().X8.FunctionCallUnexpectedArgument,values:{functionName:t.libraryFunction.name}};break;case l().uW.FunctionCallArgumentWrongType:o={...a().X8.FunctionCallArgumentWrongType,values:{functionName:t.libraryFunction.name,argumentType:c(t.argumentType)}};break;case l().uW.AccessingPropertyOnNonBlock:o=a().X8.AccessingPropertyOnNonBlock;break;case l().uW.MissingDataDependencyBlock:o={...a().X8.MissingDataDependencyBlock,values:{blockId:t.blockPointer.id}};break;case l().uW.MissingDataDependencyPerson:o={...a().X8.MissingDataDependencyPerson,values:{personId:t.personPointer.id}};break;case l().uW.MemberPropertyMismatchCollection:o=a().X8.MemberPropertyMismatchCollection;break;case l().uW.MissingPropertyOnSchemaForMemberProperty:o=a().X8.MissingPropertyOnSchemaForMemberProperty;break;case l().uW.UnaryMinusOnNonNumber:o={...a().X8.UnaryMinusOnNonNumber,values:{expressionType:c(t.expressionType)}};break;case l().uW.UnexpectedRecoveryNode:o=a().X8.UnexpectedRecoveryNode;break;case l().uW.UnexpectedError:o=a().X8.UnexpectedError;break;case l().uW.DepthExceeded:o=a().X8.DepthExceeded;break;case l().uW.CycleDetected:o=a().X8.CycleDetected;break;case l().uW.DownstreamParseFailure:o=a().X8.DownstreamParseFailure;break;case l().uW.MaxEvaluationTimeExceeded:o=a().X8.MaxEvaluationTimeExceeded;break;case l().uW.MissingSchemaPropertyOnCollection:o={...a().X8.MissingSchemaPropertyOnCollection,values:{collectionId:t.collectionId,propertyName:t.property}};break;case l().uW.ContextVariableWrongType:o={...a().X8.ContextVariableWrongType,values:{expectedType:t.expectedType,propertyType:t.resultType,valueId:t.valueId}};break;case l().uW.DisallowedValueType:{const n=t.allowedValueTypes.map((t=>e.formatMessage((0,i().getHumanReadableType)(t)).toLocaleLowerCase()));o={...a().Xz.DisallowedReturnType,values:{allowedValueType:e.formatList(n,{style:"long",type:"conjunction"}),allowedValueTypeCount:t.allowedValueTypes.length,valueType:e.formatMessage((0,i().getHumanReadableValueType)(t.expressionValue)).toLocaleLowerCase()}};break}default:(0,r().HB)(t)}return(0,s().li)(t)?{...o,values:{...o.values,startOffset:t.node.startOffset,endOffset:t.node.endOffset+1}}:o}function y(e){const t=null==e?void 0:e.values;return[n().cJ(e,"values"),t]}function f(e){return e.type===l().uW.DepthExceeded||e.type===l().uW.CycleDetected||e.type===l().uW.MaxEvaluationTimeExceeded||e.type===l().uW.LibraryFunctionExecutionError}},617837:(e,t,o)=>{o.d(t,{j:()=>b});var n=o(296540),r=()=>o(564884),i=()=>o(484714),a=()=>o(56366),l=()=>o(401497),s=()=>o(929219),c=()=>o(163749),d=()=>o(340266),u=()=>o(322972),p=()=>o(557943),m=()=>o(69708),y=()=>o(534177),f=()=>o(272200),g=()=>o(966106),h=()=>o(285790),v=o(474848);function b(e){const{traceId:t,feedbackState:o,setFeedbackState:r,feature:c,iconHeight:d}=e,u=(0,l().IS)((e=>({wrapper:{...d?{height:d}:{}},iconButton:{...d?{height:d}:{}}})),[d]),{thumbsUpType:p,thumbsDownType:f}=(0,n.useMemo)((()=>{switch(c){case"ai_block":return{thumbsDownType:"ai_block_thumbs_down",thumbsUpType:"ai_block_thumbs_up"};case"ai_autofill":return{thumbsDownType:"ai_autofill_thumbs_down",thumbsUpType:"ai_autofill_thumbs_up"};default:(0,y().HB)(c)}}),[c]),b=(0,m().tz)(),C=(0,i().v3)(),k=!(0,a().O$)(s().e),A=(0,n.useCallback)((()=>{g().A.setState({...g().A.state,open:!0,type:f,traceId:t,thumbsUpOrDown:"down"}),r({type:"thumbsdown",userContent:"",shareWithNotion:!0}),S({environment:C,feature:c,inferenceId:t,feedbackType:"thumbsdown",userContent:"",shareWithNotion:!0})}),[C,r,f,t,c]),M=(0,n.useCallback)((()=>{g().A.setState({...g().A.state,open:!0,type:p,traceId:t,thumbsUpOrDown:"up"}),r({type:"thumbsup",userContent:"",shareWithNotion:!0}),S({environment:C,feature:c,inferenceId:t,feedbackType:"thumbsup",userContent:"",shareWithNotion:!0})}),[C,r,p,t,c]);return(0,v.jsxs)("div",{onClick:e=>{e.stopPropagation(),e.preventDefault()},style:u.wrapper,children:[(0,v.jsx)(h().A,{onClick:M,icon:x("thumbsup","thumbsup"===(null==o?void 0:o.type)),ariaLabel:b.formatMessage({id:"AiFeatureFeedbackButtons.thumbsUp",defaultMessage:"Helpful"}),disabled:k,style:u.iconButton}),(0,v.jsx)(h().A,{icon:x("thumbsdown","thumbsdown"===(null==o?void 0:o.type)),onClick:A,ariaLabel:b.formatMessage({id:"AiFeatureFeedbackButtons.thumbsDown",defaultMessage:"Not helpful"}),disabled:k,style:u.iconButton})]})}function S(e){const{environment:t,feature:o,inferenceId:n,feedbackType:i,userContent:a,shareWithNotion:l}=e;let s;s="thumbsup"===i?"thumbs_up":"thumbs_down",(0,r().u)({environment:t,event:{eventName:"ai_feedback_given",eventProperties:{feature:o,inference_id:n,sentiment:s}}}),f().trackAIAction(t,{type:"property_autofill",inference_id:n,feedback_type:i,timestamp:(new Date).toUTCString(),user_comment:a,share_with_notion:l})}function x(e,t){switch(e){case"thumbsup":return t?u().P:p().s;case"thumbsdown":return t?c().m:d().d}}},673964:(e,t,o)=>{o.d(t,{j:()=>i});var n=()=>o(953418),r=()=>o(129522);function i(e){const{collectionContextStore:t,environment:o,fit:i}=e,a=t.collectionViewBlockStore();if(a){const e=r().K.findCollectionViewBlockFromStore(a);if(e){var l;const t=null===(l=e.getNode())||void 0===l?void 0:l.firstChild;t instanceof HTMLElement&&(0,n().$v)({blockAlignment:"start",element:t,environment:o,behavior:"instant",additionalPadding:{top:"filtersBar"===i?64:128},verticalVisibilityRequirement:"topVisible",horizontalVisibilityRequirement:"none"})}}}},693689:(e,t,o)=>{o.d(t,{Y:()=>l,k:()=>s});var n=()=>o(411671),r=()=>o(148832),i=()=>o(834316),a=()=>o(329443);function l(e,t){const o=t.getRecordStoreUIRoot(),l=o instanceof r().B&&o.isPageBlock()&&o.isNonEditableState(),s=(0,i().W)(o)&&n().A.getMode(e,o),c=Boolean((0,a().QT)(s));return!t.canEdit()||c||l}function s(e,t){return!l(e,t)}},707069:(e,t,o)=>{o.d(t,{S:()=>i});o(16280);var n=()=>o(165358),r=()=>o(477293);function i(){const e=(0,r().r)("location_search_service_rollout",{disableExposureLogging:!1,enableEventTrailLogging:!1});switch(n().log({from:"useLocationServiceType",level:"debug",type:"location_search_service_rollout",data:{miscDataToConvertToString:{experimentValue:e}}}),e){case"control":return"aws";case"google":return"google";default:throw new Error(`Unsupported location service: ${e}`)}}},720263:(e,t,o)=>{o.d(t,{A:()=>S});var n=o(296540),r=()=>o(484714),i=()=>o(401497),a=()=>o(718827),l=()=>o(252291),s=()=>o(49621),c=()=>o(69708),d=()=>o(21869),u=()=>o(543886),p=()=>o(405170),m=()=>o(441467),y=()=>o(862292),f=()=>o(857048),g=()=>o(693202),h=()=>o(35392),v=()=>o(859428),b=o(474848);function S(e){const t=(0,r().v3)(),{isMobile:o}=(0,r().Y0)(),S=(0,i().IS)((e=>({keyboardShorcut:{color:e.text.inverseSecondary}})),[]),x=async()=>{let o;const n=g().default.state;if("empty"!==n.mode){o=f().wg();const r=await y().T.formulas.load();m().hN({environment:t,blockStore:e.blockStore,multiSelection:n.multiSelection,property_id:u().A.state.isOpen?u().A.state.property:p().A.state.isOpen?p().A.state.property:void 0,formulasModule:r})}(0,d().s)(t,{action:"comment",from:o?"simple_table_cell":void 0})};return(0,b.jsx)(v().A,{renderTooltip:()=>(0,b.jsxs)(n.Fragment,{children:[(0,b.jsx)("div",{children:(0,b.jsx)(c().sA,{defaultMessage:"Comment",id:"inlineCommentButton.tooltip"})}),(0,b.jsx)("div",{children:(0,b.jsx)(h().A,{style:S.keyboardShorcut,name:"comment"})})]}),render:t=>(0,b.jsxs)(a().Ay,{style:{display:"flex",alignItems:"center",padding:e.iconOnly?6:"0 6px",whiteSpace:"nowrap",gap:4,...e.style},disabled:e.disabled,disabledFeedback:e.disabled,onClick:x,ariaLabel:e.ariaLabel,...t,children:[(0,b.jsx)(l().I,{icon:s().h}),o||e.iconOnly?void 0:(0,b.jsx)(c().sA,{defaultMessage:"Comment",id:"inlineCommentButton.commentLabel"})]})})}},746630:(e,t,o)=>{o.d(t,{A:()=>s});var n=o(296540),r=()=>o(484714),i=()=>o(69708),a=o(474848);function l(e){const t=(0,r().v3)(),{isMobile:l}=(0,r().Y0)(),s=(0,n.useRef)(null),c=async()=>{const n=o(693202).default.state;if("empty"===n.mode)return;const r=await o(862292).T.formulas.load();o(441467).of({environment:t,blockStore:e.blockStore,multiSelection:n.multiSelection,formulasModule:r})};return(0,a.jsx)(o(859428).A,{renderTooltip:()=>(0,a.jsx)("div",{children:(0,a.jsx)(i().sA,{defaultMessage:"React to selected text",id:"inlineReactionButton.tooltip"})}),render:t=>(0,a.jsxs)(o(718827).Ay,{ref:s,style:{display:"flex",justifyContent:"center",alignItems:"center",padding:e.iconOnly?6:"0 6px",gap:4,whiteSpace:"nowrap",...e.style},disabled:e.disabled,disabledFeedback:e.disabled,onClick:c,...t,children:[(0,a.jsx)(o(252291).I,{icon:o(546703).r}),l||e.iconOnly?void 0:(0,a.jsx)(i().sA,{defaultMessage:"React",id:"inlineReactionButton.reactLabel"})]})})}l.displayName="InlineReactionButton";const s=l},754869:(e,t,o)=>{function n(e,t,o,n){return new(o||(o=Promise))((function(r,i){function a(e){try{s(n.next(e))}catch(t){i(t)}}function l(e){try{s(n.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,l)}s((n=n.apply(e,t||[])).next())}))}function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}o.d(t,{aH:()=>s}),"function"==typeof SuppressedError&&SuppressedError;var i=r((function e(t,o){if(t===o)return!0;if(t&&o&&"object"==typeof t&&"object"==typeof o){if(t.constructor!==o.constructor)return!1;var n,r,i;if(Array.isArray(t)){if((n=t.length)!=o.length)return!1;for(r=n;0!=r--;)if(!e(t[r],o[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===o.source&&t.flags===o.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===o.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===o.toString();if((n=(i=Object.keys(t)).length)!==Object.keys(o).length)return!1;for(r=n;0!=r--;)if(!Object.prototype.hasOwnProperty.call(o,i[r]))return!1;for(r=n;0!=r--;){var a=i[r];if(!e(t[a],o[a]))return!1}return!0}return t!=t&&o!=o}));const a="__googleMapsScriptId";var l;!function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.LOADING=1]="LOADING",e[e.SUCCESS=2]="SUCCESS",e[e.FAILURE=3]="FAILURE"}(l||(l={}));class s{constructor({apiKey:e,authReferrerPolicy:t,channel:o,client:n,id:r=a,language:l,libraries:c=[],mapIds:d,nonce:u,region:p,retries:m=3,url:y="https://maps.googleapis.com/maps/api/js",version:f}){if(this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.apiKey=e,this.authReferrerPolicy=t,this.channel=o,this.client=n,this.id=r||a,this.language=l,this.libraries=c,this.mapIds=d,this.nonce=u,this.region=p,this.retries=m,this.url=y,this.version=f,s.instance){if(!i(this.options,s.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(s.instance.options)}`);return s.instance}s.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url,authReferrerPolicy:this.authReferrerPolicy}}get status(){return this.errors.length?l.FAILURE:this.done?l.SUCCESS:this.loading?l.LOADING:l.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let e=this.url;return e+="?callback=__googleMapsCallback&loading=async",this.apiKey&&(e+=`&key=${this.apiKey}`),this.channel&&(e+=`&channel=${this.channel}`),this.client&&(e+=`&client=${this.client}`),this.libraries.length>0&&(e+=`&libraries=${this.libraries.join(",")}`),this.language&&(e+=`&language=${this.language}`),this.region&&(e+=`&region=${this.region}`),this.version&&(e+=`&v=${this.version}`),this.mapIds&&(e+=`&map_ids=${this.mapIds.join(",")}`),this.authReferrerPolicy&&(e+=`&auth_referrer_policy=${this.authReferrerPolicy}`),e}deleteScript(){const e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise(((e,t)=>{this.loadCallback((o=>{o?t(o.error):e(window.google)}))}))}importLibrary(e){return this.execute(),google.maps.importLibrary(e)}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){var e,t;if(document.getElementById(this.id))return void this.callback();const o={key:this.apiKey,channel:this.channel,client:this.client,libraries:this.libraries.length&&this.libraries,v:this.version,mapIds:this.mapIds,language:this.language,region:this.region,authReferrerPolicy:this.authReferrerPolicy};Object.keys(o).forEach((e=>!o[e]&&delete o[e])),(null===(t=null===(e=null===window||void 0===window?void 0:window.google)||void 0===e?void 0:e.maps)||void 0===t?void 0:t.importLibrary)||(e=>{let t,o,r,i="The Google Maps JavaScript API",a="google",l="importLibrary",s="__ib__",c=document,d=window;d=d[a]||(d[a]={});const u=d.maps||(d.maps={}),p=new Set,m=new URLSearchParams,y=()=>t||(t=new Promise(((l,d)=>n(this,void 0,void 0,(function*(){var n;for(r in yield o=c.createElement("script"),o.id=this.id,m.set("libraries",[...p]+""),e)m.set(r.replace(/[A-Z]/g,(e=>"_"+e[0].toLowerCase())),e[r]);m.set("callback",a+".maps."+s),o.src=this.url+"?"+m,u[s]=l,o.onerror=()=>t=d(Error(i+" could not load.")),o.nonce=this.nonce||(null===(n=c.querySelector("script[nonce]"))||void 0===n?void 0:n.nonce)||"",c.head.append(o)})))));u[l]?console.warn(i+" only loads once. Ignoring:",e):u[l]=(e,...t)=>p.add(e)&&y().then((()=>u[l](e,...t)))})(o);const r=this.libraries.map((e=>this.importLibrary(e)));r.length||r.push(this.importLibrary("core")),Promise.all(r).then((()=>this.callback()),(e=>{const t=new ErrorEvent("error",{error:e});this.loadErrorCallback(t)}))}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){const e=this.errors.length*Math.pow(2,this.errors.length);console.error(`Failed to load Google Maps script, retrying in ${e} ms.`),setTimeout((()=>{this.deleteScript(),this.setScript()}),e)}else this.onerrorEvent=e,this.callback()}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach((e=>{e(this.onerrorEvent)})),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),!this.loading)if(this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version)return console.warn("Google Maps already loaded outside @googlemaps/js-api-loader. This may result in undesirable behavior as options and script parameters may not match."),void this.callback();this.loading=!0,this.setScript()}}}},777849:(e,t,o)=>{o.d(t,{A:()=>f});var n=o(296540),r=()=>o(56366),i=()=>o(401497),a=()=>o(201980),l=()=>o(69708),s=()=>o(448619),c=()=>o(792002),d=()=>o(569777),u=()=>o(693202),p=()=>o(35392),m=o(474848);const y={display:"flex",alignItems:"center",borderRadius:6,padding:6,width:28,height:28};const f=function({style:e,children:t,disabled:n,onClick:l}){const p=(0,i().DP)(),f=(0,o(484714).v3)(),v=(0,r().K8)((()=>g(p).equationButton),[p]),b=(0,r().K8)((()=>function(e){if(e)return!0;if("editing"!==u().default.state.mode&&!d().A.isOpen())return!0;const t={[a().Ifu.User]:a().Ifu.User,[a().Ifu.Page]:a().Ifu.Page,[a().Ifu.Collection]:a().Ifu.Collection,[a().Ifu.CustomEmoji]:a().Ifu.CustomEmoji,[a().Ifu.Comment]:a().Ifu.Comment,[a().Ifu.Bot]:a().Ifu.Bot,[a().Ifu.Date]:a().Ifu.Date,[a().Ifu.ExternalObjectInstance]:a().Ifu.ExternalObjectInstance,[a().Ifu.TemporaryPage]:a().Ifu.TemporaryPage,[a().Ifu.TemporaryCollection]:a().Ifu.TemporaryCollection,[a().Ifu.TemplateVariable]:a().Ifu.TemplateVariable,[a().Ifu.FormulaPageProperty]:a().Ifu.FormulaPageProperty,[a().Ifu.FormulaContextValue]:a().Ifu.FormulaContextValue,[a().Ifu.Group]:a().Ifu.Group,[a().Ifu.Team]:a().Ifu.Team,[a().Ifu.Citation]:a().Ifu.Citation,[a().Ifu.TemporaryCitation]:a().Ifu.TemporaryCitation,[a().Ifu.LinkMention]:a().Ifu.LinkMention,[a().Ifu.AssistantInstructionsCollection]:a().Ifu.AssistantInstructionsCollection,[a().Ifu.Place]:a().Ifu.Place,[a().Ifu.SlackSpecialMention]:a().Ifu.SlackSpecialMention,[a().Ifu.TemporarySearchFilter]:a().Ifu.TemporarySearchFilter,[a().Ifu.TitleOnly]:a().Ifu.TitleOnly,[a().Ifu.Sort]:a().Ifu.Sort,[a().Ifu.SearchFilterCreatedTime]:a().Ifu.SearchFilterCreatedTime,[a().Ifu.SearchFilterLastEditedTime]:a().Ifu.SearchFilterLastEditedTime};for(const o of Object.values(t))if((0,c().y_)(o))return!0;return!1}(n)),[n]);return(0,m.jsx)(o(859428).A,{renderTooltip:()=>(0,m.jsx)(h,{}),render:n=>(0,m.jsx)(o(718827).Ay,{style:{...y,...v,...e},disabled:b,disabledFeedback:b,onClick:e=>function(e,t,o){s().Wx({environment:t,analyticsFrom:"rich_text_menu"}),o&&o(e)}(e,f,l),...n,children:t})})};function g(e){return{equationButton:{fill:(0,c().B1)(a().Ifu.Equation)?e.blue.icon.accentPrimary:e.icon.primary},keyboardShortcut:{color:e.text.inverseSecondary}}}function h(){const e=(0,i().DP)(),t=(0,r().K8)((()=>g(e).keyboardShortcut),[e]);return(0,m.jsxs)(n.Fragment,{children:[(0,m.jsx)("div",{children:(0,m.jsx)(l().sA,{id:"richTextMenu.equationButton.tooltip",defaultMessage:"Mark as equation"})}),(0,m.jsx)("div",{children:(0,m.jsx)(p().A,{style:t,name:"openEquationMenu"})})]})}},780243:(e,t,o)=>{o.d(t,{A:()=>v});var n=o(296540),r=()=>o(484714),i=()=>o(56366),a=()=>o(401497),l=()=>o(718827),s=()=>o(201980),c=()=>o(69708),d=()=>o(21869),u=()=>o(501666),p=()=>o(792002),m=()=>o(711319),y=()=>o(693202),f=()=>o(35392),g=()=>o(859428),h=o(474848);function v(e){const t=(0,a().DP)(),o=(0,r().v3)(),v=(0,i().K8)((()=>(0,p().B1)(s().Ifu.Link)),[]),b=(0,i().K8)((()=>function(e){if(e)return!0;if("editing"!==y().default.state.mode&&!m().A.state.open)return!0;if((0,p().y_)(s().Ifu.User)||(0,p().y_)(s().Ifu.Bot)||(0,p().y_)(s().Ifu.Date)||(0,p().y_)(s().Ifu.Page)||(0,p().y_)(s().Ifu.Group))return!0;return!1}(e.disabled)),[e.disabled]);return(0,h.jsx)(g().A,{renderTooltip:()=>(0,h.jsxs)(n.Fragment,{children:[(0,h.jsx)("div",{children:(0,h.jsx)(c().sA,{defaultMessage:"Add link",id:"selectionLinkButton.addLink.tooltip"})}),(0,h.jsx)("div",{children:(0,h.jsx)(f().A,{style:{color:t.text.inverseSecondary},name:"openLinkMenuOrOpenSearch"})})]}),render:n=>(0,h.jsx)(l().Ay,{style:{display:"flex",alignItems:"center",borderRadius:6,paddingInlineStart:7,paddingInlineEnd:6,...v&&{color:t.blue.text.accentPrimary},whiteSpace:"nowrap",...e.style},disabled:b,disabledFeedback:b,...n,onClick:()=>function(e){u().fi({type:"focusOnly",focus:!0}),(0,d().s)(e,{action:s().Ifu.Link})}(o),children:e.children})})}},782473:(e,t,o)=>{o.d(t,{Nu:()=>a,Sw:()=>n,gO:()=>r,j$:()=>i});const n=220,r=24,i=-7,a=-3},816013:(e,t,o)=>{o.d(t,{r:()=>n});const n=o(757695).Store.createValue({showConvertTooltip:!1,forceShow:!1},{name:"WikiPromoStore"})},905246:(e,t,o)=>{o.r(t),o.d(t,{TopbarMoreButton:()=>P,messages:()=>j});var n=o(296540),r=()=>o(484714),i=()=>o(56366),a=()=>o(401497),l=()=>o(589407),s=()=>o(340498),c=()=>o(69708),d=()=>o(741496),u=()=>o(314529);var p=()=>o(778417),m=()=>o(33050),y=()=>o(544198),f=()=>o(494043),g=()=>o(12314),h=()=>o(448360),v=()=>o(765957),b=()=>o(816013),S=()=>o(318890),x=()=>o(594607),C=()=>o(953006),k=o(474848);function A(e){const{originRef:t}=e,o=(0,a().IS)((e=>({aiTranslateIcon:{height:18,width:18,fill:e.blue.text.accentPrimary}})),[]);return(0,k.jsx)(x().U,{calloutId:"ai_page_translation",children:(0,k.jsx)(C().k,{origin:t,placementToOrigin:"bottom",header:(0,k.jsxs)("div",{style:{display:"flex",fontSize:14,gap:12,paddingInlineStart:4,paddingInlineEnd:4},children:[(0,S().K)(o.aiTranslateIcon),(0,k.jsx)(c().sA,{id:"aiPageTranslationTooltip.header",defaultMessage:"You can always find translation in the top right menu"})]}),showPointer:!1,pointerOffset:6,content:null,onCloseClick:()=>{h().W.reset()},style:{width:300},onPrimaryButtonClick:()=>{h().W.reset()},nextButtonContent:(0,k.jsx)(c().sA,{id:"aiPageTranslationTooltip.dismiss",defaultMessage:"Got it"})})})}var M=()=>o(406699),I=()=>o(612900),w=()=>o(782473);function T({originRef:e}){return(0,k.jsx)(x().U,{calloutId:"wiki_promo",children:(0,k.jsx)(C().k,{origin:e,placementToOrigin:"bottom",header:"Upgrade your existing wikis",content:"Look for the Turn into wiki action here",onCloseClick:()=>{b().r.reset()},pointerPosition:"98%",pointerLength:24,pointerOffset:-3,style:{width:w().Sw}})})}function P({buttonPopupStore:e,store:t,isLastButton:o,renderOrigin:l}){const s=(0,r().v3)(),{device:c}=s,[S,x]=(0,n.useState)(void 0),C=(0,n.useRef)(null),w=(0,n.useCallback)((()=>{b().r.reset(),h().W.reset(),p().IU({environment:s});const e=C.current;e&&x(e.getBoundingClientRect()),function(e){(0,u().DO_NOT_USE_trackLegacy)(e,"open_more_menu")}(s)}),[C,s]),P=(0,i().K8)((()=>b().r.state.showConvertTooltip),[]),j=(0,i().O$)(h().W),_=(0,g().vP)(),F=(0,a().IS)((e=>({mobilePopupStyle:{borderRadius:12,backgroundColor:e.background.secondary}})),[]),R=(0,k.jsxs)(k.Fragment,{children:[P?(0,k.jsx)(T,{originRef:C}):j?(0,k.jsx)(A,{originRef:C}):_?(0,k.jsx)(g().QB,{originRef:C}):null,(0,k.jsx)(M().A,{popupType:c.isMobile?M().z.BottomSheet:M().z.Popup,buttonPopupStore:e,renderOrigin:l||(e=>(0,k.jsx)(B,{ref:C,buttonPopupEvents:e,isLastButton:o})),onClick:w,render:()=>(0,k.jsx)(m().P,{blockStore:t,onClickOriginRect:S,handleAccept:t=>function(e,t,o){const{mainEditorCurrentBlockStore:n}=v().default.state;if(n){const t=n.getType();if(t){const{collectionId:r,ownedCollectionCount:i,linkedCollectionCount:a}=(0,y().P)(n,{skipPages:!0});(0,d().N)(o,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"topbar_more_menu",block_id:n.id,block_type:t,is_toggleable:(0,f().Yt)(t,n.getFormat()),collection_id:r,owned_collection_count:i,linked_collection_count:a,parent_collection_id:n.getParentCollectionIdUpToTwoLevels(),form_id:n.getFirstFormIdInCollectionViewBlock()})}}e.closeParentMenu&&O(t)}(t,e,s),handleDismiss:()=>O(e)}),originGap:c.isElectronWindows?12:8,alignmentToOrigin:"end",forceInitialInbound:!0,style:c.isMobile?F.mobilePopupStyle:{width:256,maxHeight:"80vh"}})]}),E=(0,i().K8)((()=>v().default.state.inAppCalloutStore.getCalloutVisibility("ai_page_translation").canShow),[]);return j&&E?(0,k.jsx)(I().u,{shape:"square",borderRadius:6,children:R}):R}const j=(0,c().YK)({actions:{defaultMessage:"Actions",id:"topbar.actions"}});function _(e,t,n){const{device:r}=e;if(!r.isMobile){const{iconButton:{width:e,height:n}}=(0,o(863059).Hh)(t);return{display:"flex",alignItems:"center",justifyContent:"center",width:e,height:n,borderRadius:6}}const i=(0,o(978578).aD)(t).iconContainer;return n?{...i,marginInlineStart:r.isTablet?-6:void 0,marginInlineEnd:0}:{...i,marginInlineStart:r.isTablet?-6:void 0,marginInlineEnd:r.isTablet?-6:i.marginInlineEnd}}function O(e){e.setState({...e.state,open:!1})}const B=n.forwardRef((function({buttonPopupEvents:e,isLastButton:t},n){const i=(0,a().DP)(),d=(0,r().v3)(),{device:u}=d,p=(0,c().tz)();return(0,k.jsx)(o(859428).A,{renderTooltip:()=>d.currentUser.isLoggedIn()?(0,k.jsx)(c().sA,{defaultMessage:"Style, export, and more",id:"topbarMoreButton.tooltip"}):(0,k.jsx)(c().sA,{defaultMessage:"More",id:"topbarMoreButton.loggedOut.tooltip"}),placement:"bottom",originGap:u.isElectronWindows?10:void 0,delayThreshold:400,render:r=>(0,k.jsx)(o(718827).Ay,{ref:n,style:_(d,i,t),className:o(38337).ug9,ariaLabel:p.formatMessage(j.actions),...(0,o(553965).A)(e,r),children:u.isMobile?(0,l().ellipsisIcon)({height:s().lD.lg,width:s().lD.lg,fill:i.icon.primary}):(0,l().ellipsisIcon)({width:s().Ev.lg,height:s().Ev.lg,fill:i.icon.primary})})})}))},921227:(e,t,o)=>{o.d(t,{y:()=>K});var n=o(296540),r=()=>o(314529),i=()=>o(242422),a=()=>o(484714),l=()=>o(401497),s=()=>o(604995),c=()=>o(416504),d=()=>o(798880),u=()=>o(931075),p=()=>o(69708),m=()=>o(284371),y=()=>o(722872),f=()=>o(404277),g=()=>o(45552),h=()=>o(206837),v=()=>o(212050),b=()=>o(760217),S=()=>o(89924),x=o(474848);function C(e){const{onClick:t}=e,o=(0,a().v3)().device.isMobile,n=(0,l().IS)((e=>({buttonStyle:{color:e.red.text.accentPrimary,fontSize:o?m().J.UIRegular.mobile:m().J.UIRegular.desktop}})),[o]);return(0,x.jsx)(S().A,{topBorder:!0,children:(0,x.jsx)(b().A,{focused:!1,icon:(0,v().u)({width:14,marginInlineStart:0}),title:(0,x.jsx)(p().sA,{defaultMessage:"Remove verification",id:"VerificationPropertyOverlayMenu.removeVerificationButton"}),onClick:t,style:n.buttonStyle})})}var k=()=>o(906745),A=()=>o(56366),M=()=>o(180252),I=()=>o(972435),w=()=>o(712677),T=()=>o(573351);const P=(0,p().YK)({placeholder:{id:"VerificationExpiryMenu.pickSpecificDate.placeholder",defaultMessage:"Pick a date"}});function j(e){const{onChange:t,clearCustomDatePicker:o,verificationState:r,addExtraTopPadding:i}=e,c=(0,n.useRef)(e.today),d=(0,n.useRef)(e.today.plus({days:1})),[u,p]=(0,n.useState)(!1),m=(0,A().O$)(M().XX),y="verified"!==r.type||r.isIndefinite?void 0:r.dateTimeRange.end,f=(0,a().Y0)().isMobile,g=(0,l().IS)((e=>({containerStyle:{paddingTop:i?12:4,paddingBottom:12},mobileContainerStyle:{paddingBottom:10},calendar:f?{padding:"16px 14px 16px",borderBottom:`1px solid ${e.regularDividerColor}`,background:e.popoverBackground,marginTop:27,boxShadow:`0 -1px 0 ${e.regularDividerColor}`}:{},input:f?{padding:"16px 0",marginTop:0}:{}})),[i,f]);return(0,x.jsxs)(S().A,{mobileStyle:g.mobileContainerStyle,style:g.containerStyle,disableMobilePadding:!0,children:[(0,x.jsx)(w().A,{placeholder:I().A.formatMessage(P.placeholder),focused:u,value:"verified"!==e.verificationState.type||e.verificationState.isIndefinite?void 0:s().lN(e.verificationState.dateTimeRange.end),onUpdate:e=>{if(e.error)return;const n=e.value&&s().Dz(e.value);n?t({range:{start:c.current,end:n.start}}):o()},onFocus:()=>p(!0),onBlur:()=>p(!1),onClearButtonClick:o,hideClearButton:!0,style:g.input}),(0,x.jsx)("div",{style:g.calendar,children:(0,x.jsx)(T().A,{firstDayOfWeek:m,value:(null==y?void 0:y.toMillis())||d.current.toMillis(),selectValue:Boolean(y),onChange:e=>{t({range:{start:c.current,end:k().c9.fromMillis(e)},option:"custom"})},disabledDays:{before:new Date(d.current.toMillis())},className:"notion-date-property-menu"})})]})}o(581454);var _=()=>o(718827),O=()=>o(252291),B=()=>o(68913);const F={viewBox:"0 0 20 20",fittedViewBox:"1.37 6.18 17.25 7.64",svg:(0,x.jsx)("path",{d:"M17.375 10c0-2.206-2.602-3.38-4.256-1.92L10.944 10l2.175 1.92c1.654 1.46 4.256.286 4.256-1.92m-14.75 0c0 2.206 2.602 3.38 4.256 1.92L9.055 10 6.88 8.08C5.227 6.62 2.625 7.794 2.625 10m16 0c0 3.282-3.873 5.03-6.333 2.857L10 10.833l-2.292 2.024c-2.46 2.172-6.333.425-6.333-2.857s3.872-5.03 6.333-2.857L10 9.166l2.292-2.023c2.46-2.172 6.333-.425 6.333 2.857"})},R=(0,o(340498).wt)("infinity",F);var E=()=>o(42583),D=()=>o(53528),L=()=>o(991249),V=()=>o(645109),N=()=>o(118849);function U(e){const{verificationState:t,onChange:o,onCustomDateClick:r,showTitle:i,showUpsell:s,isEligibleForBusinessTrial:c}=e,d=(0,a().v3)(),y=(0,p().tz)(),f=d.device.isMobile,g=(0,n.useRef)(e.today),h=(0,l().IS)((e=>({title:{fontSize:f?m().J.UIRegular.mobile:m().J.UIRegular.desktop,color:e.text.primary},disabledTitle:{color:e.text.secondary},disabledCaption:{color:e.text.tertiary},disabledButton:{color:e.text.tertiary},upsellContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 12px",gap:8,border:`1px solid ${e.regularDividerColor}`,borderRadius:6,margin:"8px 8px 4px",height:36},upsellText:{fontSize:14,color:e.text.primary,fontWeight:m().Wy.medium,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",flex:1}})),[f]),v="expired"===t.type||"none"===t.type?(0,x.jsx)(p().sA,{defaultMessage:"Verify page",id:"VerificationExpiryPicker.verify.header"}):(0,x.jsx)(p().sA,{defaultMessage:"Reverify page",id:"VerificationExpiryPicker.reverify.header"}),C="verified"===t.type&&t.isIndefinite,k="verified"===t.type&&!t.isIndefinite&&t.dateTimeRange.end,A=Boolean(s),M="verification_upsell_item_page_entrypoint",I=(0,n.useCallback)((()=>{(0,L().K)(d,{from:M,upsell:{type:"product",product:"business",limit:{type:"none"},trialability:"none"}})}),[d,M]);return(0,x.jsxs)("div",{children:[!c&&s?(0,x.jsxs)(_().Ay,{style:h.upsellContainer,onClick:I,children:[(0,x.jsx)("div",{style:h.upsellText,children:(0,x.jsx)(p().sA,{defaultMessage:"Upgrade to unlock",id:"VerificationExpiryPicker.upsellExperience"})}),(0,x.jsx)(N().A,{subscriptionTier:"business",analyticsName:M})]}):void 0,c?(0,x.jsx)(V().c,{openedFrom:"business_trial_verify_pages_upsell",styleOverrides:{margin:"12px 12px 0px 12px"}}):void 0,(0,x.jsxs)(S().A,{title:i&&v,children:[u().yj.map((e=>{const t=k&&u().gj({start:g.current,end:k})===e;return(0,x.jsx)(b().A,{buttonStyle:A?h.disabledButton:void 0,disabled:A,focused:!1,icon:(0,x.jsx)(O().I,{icon:B().alarmIcon}),inline:!1,title:(0,x.jsx)("span",{style:A?h.disabledTitle:h.title,children:(0,x.jsx)(p().sA,{defaultMessage:"For {numDays} days",id:"VerificationExpiryMenu.preset.title",values:{numDays:e}})}),caption:y.formatMessage({defaultMessage:"Until {date}",id:"VerificationExpiryMenu.preset.subtitle"},{date:D().OH({dateTime:u().RD(e,g.current).end,intl:y,shortenDateAndRange:!0})}),captionStyle:A?h.disabledCaption:void 0,isChecked:Boolean(t),onClick:()=>{return t=e,void o({range:{start:g.current,end:g.current.plus({days:t})},option:`${t}d`});var t}},e)})),(0,x.jsx)(b().A,{buttonStyle:A?h.disabledButton:void 0,disabled:A,focused:!1,icon:(0,x.jsx)(O().I,{icon:R}),inline:!1,title:(0,x.jsx)("span",{style:A?h.disabledTitle:h.title,children:(0,x.jsx)(p().sA,{defaultMessage:"Indefinitely",id:"VerificationExpiryPicker.option.indefinitely"})}),onClick:()=>o({option:"indefinite"}),isChecked:C},"indefinite"),(0,x.jsx)(b().A,{buttonStyle:A?h.disabledButton:void 0,disabled:A,focused:!1,icon:(0,x.jsx)(O().I,{icon:E().D}),title:(0,x.jsx)("span",{style:A?h.disabledTitle:h.title,children:(0,x.jsx)(p().sA,{defaultMessage:"Pick a date",id:"VerificationExpiryPicker.option.customDate"})}),onClick:r},"custom")]})]})}var W=()=>o(8802),z=()=>o(553748);function K(e){const{verificationValue:t,getRecordModel:o,onChange:r,blockId:i,propertyName:v,onClose:b,showTitle:S,showRemoveVerificationButton:k,showVerificationFooter:A,showCurrentStatusHeader:M,showCustomHeader:I,customHeader:w,showUpsell:T,entrypoint:P,isEligibleForBusinessTrial:_}=e,O=(0,a().v3)(),B=(0,a().Y0)(),F=(0,p().tz)(),[R,E]=(0,n.useState)(!1),D=(0,n.useMemo)((()=>u().B2(t)),[t]),L="verified"===D.type,V=(0,n.useRef)(s().ah((0,c().P)())),N=(0,n.useRef)(s().ah((0,c().P)()).plus({days:1})),K=e=>{var t;const{range:o,option:n}=e,a=null===(t=O.currentUser)||void 0===t?void 0:t.id;if(!a)return;if(null!=o&&o.end&&o.end.toMillis()<N.current.toMillis())return;const l={table:d().oo,id:a},c=o?s().C6.toPersistedDateTimeRange(o):s().C6.toPersistedDateTime(V.current.toMillis()),u="none"===D.type?"add":"update";H(O,{action:u,verification_page_id:i,verification_expiry:o?o.end.toMillis():void 0}),r({value:[l,c],metadata:{action:u,entrypoint:P,expiration:n,expiration_date:o?o.end.toMillis():void 0}})},X=(0,l().IS)((e=>({footerStyle:{borderTop:`1px solid ${e.regularDividerColor}`},headerStyle:{padding:B.isMobile?10:7,paddingInlineStart:B.isMobile?20:7,background:B.isMobile?e.popoverBackground:e.tokenInputMenuItemBackground,display:"flex",alignItems:"center",borderBottom:`1px solid ${e.regularDividerColor}`}})),[B.isMobile]);let $={menuType:y().gu.Popup,footer:A&&"none"!==D.type&&!R&&(0,x.jsx)("div",{style:X.footerStyle,children:(0,x.jsx)(W().d,{lastVerifiedDate:L&&D.isIndefinite?D.startDateTime:D.dateTimeRange.start,getRecordModel:o,actorPointer:D.actorPointer})})};B.isMobile&&($={...$,title:v,menuType:y().gu.Modal,right:(0,x.jsx)(g().DoneMenuText,{}),onClickRight:R?()=>E(!1):b});return(0,x.jsxs)(x.Fragment,{children:[I&&w&&!R?w:I&&R?(0,x.jsx)(h().o,{label:F.formatMessage({id:"verificationPropertyOverlay.verificationMenuHeader.pickDate",defaultMessage:"Pick a date"}),onClickBackButton:()=>E(!1),onClose:()=>b(),width:265,showBottomBorder:!1}):null,(0,x.jsx)(f().A,{...$,header:!R&&M&&"none"!==D.type&&(0,x.jsx)("div",{style:X.headerStyle,children:(0,x.jsx)(z().r,{verificationValue:t,fontSize:B.isMobile?m().J.UIRegular.mobile:void 0})}),children:R?(0,x.jsx)(j,{today:V.current,verificationState:D,onChange:e=>K(e),clearCustomDatePicker:()=>E(!1),addExtraTopPadding:!I}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(U,{today:V.current,verificationState:D,onChange:e=>K(e),onCustomDateClick:()=>E(!0),showTitle:S,showUpsell:T,isEligibleForBusinessTrial:_}),k&&(L||"expired"===D.type)?(0,x.jsx)(C,{onClick:()=>{H(O,{action:"remove",verification_page_id:i}),r({value:void 0,metadata:{action:"remove",entrypoint:P}})}}):void 0]})})]})}function H(e,t){(0,r().DO_NOT_USE_trackLegacy)(e,"verification_update",t),i().default.logEvent("verification_update",t.action)}},978510:(e,t,o)=>{o.d(t,{R:()=>d});var n=()=>o(484714),r=()=>o(56366),i=()=>o(187174),a=()=>o(588703),l=()=>o(765957),s=()=>o(417123),c=()=>o(266615);function d(){const e=(0,r().O$)(l().AppStoreSidebarSpaceStore),t=(0,n().v3)(),o=(0,r().K8)((()=>(0,c().J)({environment:t})),[t]),[{value:d,status:u}]=(0,i().Yb)((async()=>await(0,s().z)({userId:t.currentUser.id,spaceStore:e,environment:t})),[e,t]),p=(0,r().K8)((()=>!(!l().default.state.mainEditorCurrentBlockStore||!o)&&(0,a().r)({environment:t,store:l().default.state.mainEditorCurrentBlockStore})),[t,o]);return"pending"===u?{showNoWorkspaceExperience:o,userType:void 0}:{showNoWorkspaceExperience:o,userType:d,isOnGettingStartedPage:p&&o}}}}]);