"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[28156,29486,99171],{87017:(e,t,n)=>{n.r(t),n.d(t,{duplicateBlocks:()=>T,duplicateBlocksWithMaybeConfirmation:()=>w,insertBlockAbove:()=>I,insertBlockAndEdit:()=>C,insertBlockBelow:()=>S,insertTextAbove:()=>x,insertTextBelow:()=>B});n(18107),n(944114),n(967357);var o=()=>n(908006),i=()=>n(206267),a=()=>n(496603),s=()=>n(855801),r=()=>n(60867),l=()=>n(669548),c=()=>n(620689),d=()=>n(391214),u=()=>n(231297),m=()=>n(838256),g=()=>n(962910),f=()=>n(807700),p=()=>n(799832),v=()=>n(516430),_=()=>n(405417),h=()=>n(495506),y=()=>n(393255),M=()=>n(77246),k=()=>n(502438),b=()=>n(50764);async function w(e){const{environment:t,blocks:n,duplicateOnlyCollectionSchema:i,callback:a,from:l}=e;if(!(0,b().E)(t))return;const d=await s().VI.duplicateActions.load();let m=n;if(1===n.length){const e=await g().rW({environment:t,block:n[0],action:"duplicate"});if("user_canceled"===e)return void(null==a||a());m=e}const f=m.at(0);if(!f)return;const v=(0,p().U)(f);if(v&&(0,_().ls)(f,v))await r().un({blocks:m,environment:t,analyticsFrom:"subitem_duplication",callback:a,collectionContextStore:v});else{const{serverCommitResult:e}=u().createAndCommit({userAction:"actionRegistry.duplicateToSelection",environment:t,canUndo:!0,perform:e=>{T({environment:t,blocks:m,transaction:e,executionTarget:"local",duplicateOnlyCollectionSchema:i,duplicateActions:d,from:l})},transactionTooBigFallback:e=>{T({environment:t,blocks:m,transaction:e,executionTarget:"server",duplicateOnlyCollectionSchema:i,duplicateActions:d,from:l})}});e.then(a)}o().default.afterNextFlush((()=>{c().BM({environment:t})}))}function T(e){const{environment:t,blocks:n,transaction:o,executionTarget:i,lastTopLevelBlockStore:s,preventSetSelection:r,duplicateOnlyCollectionSchema:l,duplicateActions:c,from:u}=e,m=a().$z(n,(e=>e.getFormat().app_id??e.id)),g=[];return a().jJ(m,(e=>{const n=e[0],{blockStores:a}=c.duplicateBlock({environment:t,stores:e,transaction:o,targetSpaceId:n.getSpaceId(),executionTarget:i,from:u,options:{addCopyName:!0,allowRedundancy:!1,deepCopyTransclusionContainers:!n.isTransclusionType(),resolveTemplateVariables:!(0,f().l)(n),duplicateOnlyCollectionSchema:l},skipUserFacingMessages:!1});g.push(...a)})),d().LE({blocksToInsert:g,target:s?[s]:n,environment:t,transaction:o,replaceEmptyTextBlock:!1,preventSetSelection:r}),g}function S(e){const{environment:t,createBlockItem:n,selection:o,transaction:i,analyticsFrom:a,preventSetSelection:s}=e,r=k().default.getCurrentRecordCache(),c=new(m().UF)({environment:t,userFlow:"page"===(null==n?void 0:n.blockType)?"user_flow_create_page":"user_flow_create_block",succeedOnEnqueue:!0});let u;if((0,b().E)(t)&&n&&r){const e=l().w({environment:t,createBlockItem:n,transaction:i,inMemoryRecordCache:r,from:a,selection:o});c.track(e.pointer,i),u=d().LE({environment:t,blocksToInsert:[e],target:o,transaction:i,replaceEmptyTextBlock:!1,preventSetSelection:s})[0]}else c.fail("invalid_state");return u}function I(e){const{environment:t,createBlockItem:n,selection:o,transaction:i,analyticsFrom:a,preventSetSelection:s}=e,r=k().default.getCurrentRecordCache();let c;if((0,b().E)(t)&&n&&r){const e=l().w({environment:t,createBlockItem:n,transaction:i,inMemoryRecordCache:r,from:a,selection:o});c=d().t1({environment:t,blocks:[e],selection:o,transaction:i,preventSetSelection:s})[0]}return c}function C(e){const{environment:t,selection:n,transaction:o}=e,a=S({...e,preventSetSelection:!0});if(a){var s;d().x5({environment:t,insertedStores:[a],isCreated:!0});const e=M().Uv.getMode(a);if("suggest"===e){const e=v().RR(t,o,a);v().tM(o,a,{id:i().JW(),type:"insert",discussionId:e.id}),v().c3({environment:t,transaction:o,discussionStore:e,addModifiedBlockIdsAfter:[a.id]})}"suggest"===e&&null!==(s=a.getNavigableBlockStore({skipCurrent:!0}))&&void 0!==s&&s.isCommentOnly()||d().um({transaction:o,blocks:n})}return a}function B(e){const{blocks:t,transaction:n,environment:i,skipAnalytics:a}=e,s=a?void 0:"text_insert_below",r=S({environment:i,selection:t,createBlockItem:h().ry.text,analyticsFrom:s,transaction:n});return r&&o().default.afterNextFlush((()=>{y().zz({environment:i,blockStore:r,insertedTextBlockLocation:"below"})})),r}function x(e){const{blocks:t,transaction:n,environment:i,skipAnalytics:a}=e,s=a?void 0:"text_insert_below",r=I({environment:i,selection:t,createBlockItem:h().ry.text,analyticsFrom:s,transaction:n});return r&&o().default.afterNextFlush((()=>{y().zz({environment:i,blockStore:r,insertedTextBlockLocation:"above"})})),r}},338931:(e,t,n)=>{n.d(t,{Gj:()=>c,RN:()=>p,_X:()=>v,sR:()=>g,vZ:()=>d,xy:()=>h,y6:()=>f});n(944114),n(898992),n(823215),n(354520),n(672577);var o=()=>n(906745),i=()=>n(726637),a=()=>n(761940),s=()=>n(651784),r=()=>n(179034),l=()=>n(148832);function c(e){const t=o().c9.fromMillis(e.startUnixTimestampMS),n=e.endUnixTimestampMS?o().c9.fromMillis(e.endUnixTimestampMS):void 0,i=o().c9.fromMillis(e.startOfWeekUnixTimestampMS),a=o().c9.fromMillis(e.endOfWeekUnixTimestampMS),s=t.startOf("day"),r=o().c9.max(i,s),l=Math.ceil(r.diff(i,"days").get("days"));let c=1;if(n){const e=n.endOf("day"),t=o().c9.min(a,e);c=Math.ceil(t.diff(r,"days").get("days"))}return{start:t,end:n,startOfWeek:i,endOfWeek:a,startColumn:l,columnCount:c}}function d(e){const t=(e.attendees||[]).filter((e=>!e.self&&!e.resource));return e.hasParticipants&&t.length>0&&t.every((e=>"declined"===e.responseStatus))}const u={upcomingMinsThreshold:10,startingMinsThreshold:5,startedMinsThreshold:15},m={upcomingMinsThreshold:10,startingMinsThreshold:5,startedMinsThreshold:5},g={upcomingMinsThreshold:10,startingMinsThreshold:15,startedMinsThreshold:15};function f(e){const{events:t,accounts:n,thresholds:i=u,filters:s}=e,r=t.filter((e=>{if(!e.conferencing)return!1;const t=n.find((t=>t.id===e.accountId));return!(null==t||!t.email)&&(!!(0,a().Ko)(e,t.email)&&(!function(e){if("declined"===e)return!0;return!1}(e.responseStatus??"declined")&&!e.isAllDay))}));if(0===r.length)return[];const{upcomingMinsThreshold:l,startingMinsThreshold:c,startedMinsThreshold:d}=i,m=[],g=[],f=[],p=[],v=[];for(const a of r){if(a.isAllDay)continue;const e=_(a),t=o().c9.now();if(null!=s&&s.excludeEventsOnDifferentDays){if(o().c9.now().setZone(e.start.zone).toISODate()!==e.start.toISODate())continue}const n=e.start.diff(t,"minutes").minutes;if(n>=0&&n<=l)m.push(a);else if(n<0){const o=-n;o>0&&o<=c?f.push(a):o>c&&o<=d?p.push(a):e.contains(t)&&g.push(a)}else v.push(a)}g.sort(((e,t)=>{const n=o().c9.fromISO(e.start.dateTime,{zone:e.start.timeZone});return o().c9.fromISO(t.start.dateTime,{zone:t.start.timeZone}).diff(n).toMillis()}));return[...m,...f,...p,...null!=s&&s.excludeInProgressEvents?[]:g,...null!=s&&s.excludeUpcomingLaterEvents?[]:v]}function p(e,t){return f({events:e,accounts:t,thresholds:u,filters:void 0})[0]}function v(e,t){return f({events:e,accounts:t,thresholds:m,filters:{excludeUpcomingLaterEvents:!0}})[0]}function _(e){const t=o().c9.fromISO(e.start.dateTime,{zone:e.start.timeZone}),n=o().c9.fromISO(e.end.dateTime,{zone:e.end.timeZone});return o().IX.fromDateTimes(t,n)}function h(e){const{environment:t,spaceStore:n}=e;let o=e.fileUrl;if(!n)return;const a=(0,s().parseRoute)({url:o,isMobile:t.device.isMobile,baseUrl:i().A.domainBaseUrl,publicDomainName:i().A.publicDomainName,protocol:i().A.protocol,currentUrl:window.location.href}),c="page"===a.name?a.blockId:void 0;if(!c)return;const d=l().B.createChildStore(n,{table:r().ev,id:c});return d.load(),d}},669548:(e,t,n)=>{n.d(t,{w:()=>u});n(16280),n(18107),n(967357);var o=()=>n(388821),i=()=>n(179034),a=()=>n(824438),s=()=>n(544198),r=()=>n(594794),l=()=>n(765957),c=()=>n(970330),d=()=>n(863168);function u(e){var t,n;const{environment:u,createBlockItem:m,from:g,inMemoryRecordCache:f,transaction:p,selection:v}=e;if(!m.templateRootBlockId||!m.createTemplate)throw new Error("Invalid createBlock item.");const _=(v.length>0?v[0].getSpaceId():void 0)??e.spaceId??(null===(t=l().default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.getSpaceId()),h=_?u.idCreator.getSpaceIdCreatorSync(_):void 0,{targetBlockStore:y}=(0,a().j)({environment:u,sourceBlockId:m.templateRootBlockId,targetBlockPointer:(0,r().zP)({environment:u,table:i().ev,spaceId:_}),sourceBlockSubtree:(0,o().partialRecordMapToRecordMap)(m.createTemplate(u)),targetRecordCache:f,transaction:p,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,spaceIdCreator:h});null===(n=m.postCreateCallback)||void 0===n||n.call(m,y,u,p);const[M]=v;if(d().eY({environment:u,store:y,transaction:p,previousStore:M}),g&&m.blockType){var k;const e=m.collectionViewType,t="full_page"===e,n=0!==v.length?null===(k=v[0])||void 0===k?void 0:k.getParentCollectionIdUpToTwoLevels():void 0;let o,i,a,r;if("chart"===e){var b,w;const e=null===(b=y.getCollectionViewStores())||void 0===b?void 0:b.at(0);o=null==e||null===(w=e.getChartConfig())||void 0===w?void 0:w.type,i=null==e?void 0:e.getChartPlaceholderType()}if("form_editor"===e){var T;const e=null===(T=y.getCollectionViewStores())||void 0===T?void 0:T.at(0),t=null==e?void 0:e.getFormBlockStore();a=null==t?void 0:t.id,r=null==e?void 0:e.id}const{collectionId:l,ownedCollectionCount:d,linkedCollectionCount:f}=(0,s().P)(y,{skipPages:!1}),p={from:g,collection_id:l,owned_collection_count:d,linked_collection_count:f,view_type:"inline"===e||"full_page"===e?"table":e,is_toggleable:m.isToggleable,automation_id:y.getAutomationId(),new_page_id:"page"===m.blockType?y.id:void 0,creating_block_id:y.id,parent_collection_id:n,is_full_screen:t,chart_type:"placeholder"===o?i:o,is_chart_placeholder:"placeholder"===o,form_id:a,view_id:r},_=m.blockType;c().tP(_)?c().vH(u,{...p,type:_,collection_id:l||""}):c().vH(u,{...p,type:_})}return y}},812109:(e,t,n)=>{function o(e){return"string"==typeof e?e:"calendarId"in e?`${e.accountId}:${e.calendarId}`:`${e.accountId}:${e.id}`}function i({id:e,accountId:t,calendarId:n}){return`${t}:${n}:${e}`}n.d(t,{N:()=>o,z:()=>i})},852517:(e,t,n)=>{n.d(t,{$:()=>l});n(944114),n(581454);var o=()=>n(56366),i=()=>n(765957),a=()=>n(540144),s=()=>n(964345),r=()=>n(748197);function l(){return(0,o().K8)((()=>{var e;const t=Object.values(s().Ay.state.passiveBlockMap).map((({rootBlockStore:e})=>e)),n=s().ei.state,o=[];n&&n.isTranscriptionBlock()&&o.push(n);for(const i of t)i.isTranscriptionBlock()&&o.push(i);const l=null===(e=i().default.state.currentUserStore)||void 0===e?void 0:e.id;if(l)for(const i of o){const e=(0,a().by)(i);if(i.pathIsDead()||"transcribing"!==e.state||e.transcriber_id!==l)continue;if(!r().c.getVisibilityStatus(i.id))return i}}),[])}},863960:(e,t,n)=>{n.r(t),n.d(t,{useMeetingKeywordToast:()=>A,useMeetingKeywordToastEligibility:()=>O});n(898992),n(354520);var o=n(296540),i=()=>n(59226),a=()=>n(242422),s=()=>n(726637),r=()=>n(908006),l=()=>n(484714),c=()=>n(56366),d=()=>n(798880),u=()=>n(985529),m=()=>n(69708),g=()=>n(778078),f=()=>n(720665),p=()=>n(620689),v=()=>n(812182),_=()=>n(755199),h=()=>n(533336),y=()=>n(540144),M=()=>n(852517),k=()=>n(486674),b=()=>n(921855),w=()=>n(680074),T=()=>n(249847),S=()=>n(329304),I=()=>n(564884);function C(e){const{environment:t,...n}=e;a().default.logEvent("ai_meeting_notes_entrypoint_cta",n.action),(0,I().u)({environment:t,event:{eventName:"ai_meeting_notes_entrypoint_cta",eventProperties:n}})}var B=()=>n(152197);const x=3,K=1,E=(0,m().YK)({meeting:{id:"meetingKeyword.meeting",defaultMessage:"meeting"},oneOnOne:{id:"meetingKeyword.oneOnOne",defaultMessage:"1:1"},sync:{id:"meetingKeyword.sync",defaultMessage:"sync"},standup:{id:"meetingKeyword.standup",defaultMessage:"standup"},retro:{id:"meetingKeyword.retro",defaultMessage:"retro"},checkIn:{id:"meetingKeyword.checkIn",defaultMessage:"check-in"},huddle:{id:"meetingKeyword.huddle",defaultMessage:"huddle"},brainstorm:{id:"meetingKeyword.brainstorm",defaultMessage:"brainstorm"},workshop:{id:"meetingKeyword.workshop",defaultMessage:"workshop"},discussion:{id:"meetingKeyword.discussion",defaultMessage:"discussion"},call:{id:"meetingKeyword.call",defaultMessage:"call"},videoCall:{id:"meetingKeyword.videoCall",defaultMessage:"video call"},zoom:{id:"meetingKeyword.zoom",defaultMessage:"zoom"},kickoff:{id:"meetingKeyword.kickoff",defaultMessage:"kickoff"},debrief:{id:"meetingKeyword.debrief",defaultMessage:"debrief"},postmortem:{id:"meetingKeyword.postmortem",defaultMessage:"postmortem"},townHall:{id:"meetingKeyword.townHall",defaultMessage:"town hall"},touchBase:{id:"meetingKeyword.touchBase",defaultMessage:"touch base"},catchUp:{id:"meetingKeyword.catchUp",defaultMessage:"catch up"},interview:{id:"meetingKeyword.interview",defaultMessage:"interview"}});function A(){const e=(0,m().tz)(),t=(0,l().v3)(),n=(0,i().X)("adoption_ai_meeting_note_page_title_logging"),s=(0,i().X)("adoption_ai_meeting_note_page_title_landing_page"),{isEligible:d,isEligibleForLogging:u,matchedKeyword:g,titleValue:f}=O({isLoggingEnabled:n}),M=(0,c().K8)((()=>a().default.getEligibleGroup({experimentId:"adoption_ai_meeting_note_page_title",defaultGroup:"control",disableExposureLogging:!d})),[d]),b=!!d&&"toast"===M,w=u&&n,T=(0,o.useRef)(!1),S=(0,o.useRef)(!1),I=(0,o.useRef)(""),[B,x]=(0,o.useState)(!1),K=(0,c().K8)(k().a,[]);(0,o.useEffect)((()=>{const e=f||"";I.current!==e&&(""!==I.current&&(x(!0),T.current=!1,S.current=!1),I.current=e)}),[f]);const E=(0,o.useMemo)((()=>!!b&&(!!s||B)),[b,s,B]);(0,o.useEffect)((()=>{if(E&&!T.current){C({environment:t,action:"view",from:"ai_meeting_notes_page_title_toast",meeting_keyword:g,trigger_type:B?"user_typing":"landing_on_page"}),T.current=!0}}),[E,t,g,B]),(0,o.useEffect)((()=>{if(w&&!S.current){C({environment:t,action:"log",from:"ai_meeting_notes_page_title_toast",meeting_keyword:g,trigger_type:B?"user_typing":"landing_on_page"}),S.current=!0}}),[w,t,g,B]),(0,o.useEffect)((()=>{S.current=!1,T.current=!1,x(!1),I.current=""}),[K]),(0,o.useEffect)((()=>{E&&(v().Iz({id:"ai-meeting-notes-suggestion-toast",title:e.formatMessage({id:"aiMeetingNotes.toast.titleMeeting",defaultMessage:"Is this for a {keyword}?"},{keyword:g}),onUserDismiss:()=>{v().UW("ai-meeting-notes-suggestion-toast"),C({environment:t,action:"dismiss",from:"ai_meeting_notes_page_title_toast"})},message:e.formatMessage({id:"aiMeetingNotes.toast.message",defaultMessage:"Let Notion AI handle the notes. You can always type /meet anywhere on the page to get started."}),presentationType:"persistent",actions:{primary:{title:e.formatMessage({id:"aiMeetingNotes.toast.action.addNotes",defaultMessage:"Add AI Meeting Notes"}),onAction:()=>{h().appendTranscriptionBlockToPage({environment:t,from:"ai_meeting_notes_page_title_toast"}),r().default.afterNextFlush((()=>{let e=0;const n=()=>{if(!K||e>=30)return;e++;const o=(0,y().Ql)(K);if(o.length>0){const e=o[o.length-1];p().BL([e.id],!0,t)}else setTimeout(n,100)};n()})),C({environment:t,action:"click",from:"ai_meeting_notes_page_title_toast"}),v().UW("ai-meeting-notes-suggestion-toast")}},secondary:{title:e.formatMessage({id:"aiMeetingNotes.toast.action.dismiss",defaultMessage:"Dismiss"}),onAction:()=>{_().JC({environment:t,experimentId:"adoption_ai_meeting_note_page_title"}),C({environment:t,action:"dismiss_permanently",from:"ai_meeting_notes_page_title_toast"}),v().UW("ai-meeting-notes-suggestion-toast")}}}}),_().jN({environment:t,experimentId:"adoption_ai_meeting_note_page_title"}))}),[E,e,t,g,K])}function O({isLoggingEnabled:e}){const t=(0,m().tz)(),n=(0,l().Y0)(),o=(0,l().v3)(),i=(0,c().K8)(k().a,[]),a=(0,c().K8)((()=>null==i?void 0:i.getTitleStore()),[i]),r=(0,B().r)(),p=(0,T().T)(),v=(0,S()._X)({name:"ai_meeting_notes",spaceId:r??"",userId:p??"",amount:1}),_=(0,u().e2)(v),h=(0,c().K8)((()=>!(!i||!p)&&(i.getCreatedById()===p&&i.getCreatedByTable()===d().oo)),[i,p]),I=(0,c().K8)((()=>{if(a&&i)return(0,b().r4)(a.getValue(),i)}),[a,i]),C=(null==I?void 0:I.toLowerCase())||"",A=(0,c().K8)((()=>{if(!i)return!1;const e=i.getCreatedTime();return Math.floor((Date.now()-e)/f().nD)<=1}),[i]),O=[t.formatMessage(E.meeting),t.formatMessage(E.oneOnOne),t.formatMessage(E.sync),t.formatMessage(E.retro),t.formatMessage(E.checkIn),t.formatMessage(E.huddle),t.formatMessage(E.brainstorm),t.formatMessage(E.workshop),t.formatMessage(E.discussion),t.formatMessage(E.call),t.formatMessage(E.videoCall),t.formatMessage(E.zoom),t.formatMessage(E.standup),t.formatMessage(E.kickoff),t.formatMessage(E.debrief),t.formatMessage(E.postmortem),t.formatMessage(E.townHall),t.formatMessage(E.touchBase),t.formatMessage(E.catchUp),t.formatMessage(E.interview)],R=(e=>{if(!e)return[];const t=O.filter((t=>e.toLowerCase().includes(t.toLowerCase())));return t.length>0?t:(0,g().Ay)(e,O,(e=>e),{minThreshold:g().tb,normalizeFuzzyScore:!0})||[]})(C),U=R.length>0,z=R[0],N=(0,c().K8)((()=>{var e;const t=(0,w().R$)(o);if(!t||!t.isReady())return!0;const n=null===(e=t.getSettings())||void 0===e?void 0:e.exposed_to_adoption_feature_experiment,i=(null==n?void 0:n.adoption_ai_meeting_note_page_title)??[];if(i.length>=x)return!0;if(i.length>0){const e=parseInt(i[i.length-1],10);if(isNaN(e))return!1;const t=Date.now()-e;if(Math.floor(t/f().nD)<K)return!0}return!1}),[o]),F=(0,c().K8)((()=>{var e;const t=(0,w().R$)(o);if(!t||!t.isReady())return!1;const n=null===(e=t.getSettings())||void 0===e?void 0:e.dismissed_adoption_feature_experiment;return Boolean(null==n?void 0:n.adoption_ai_meeting_note_page_title)}),[o]),L=!I||!U||!_||!A||!e&&N||F||s().A.isMobile||n.isTablet,D=(0,c().K8)((()=>!(L||!i)&&(0,y().Ql)(i).length>0),[L,i]),$=(0,M().$)(),P=Boolean($);return{isEligible:Boolean(I&&U&&_&&A&&h&&!N&&!F&&!s().A.isMobile&&!n.isTablet&&!D&&!P),isEligibleForLogging:Boolean(I&&U&&_&&A&&h&&!F&&!s().A.isMobile&&!n.isTablet&&!D&&!P),matchedKeyword:z,titleValue:I}}}}]);