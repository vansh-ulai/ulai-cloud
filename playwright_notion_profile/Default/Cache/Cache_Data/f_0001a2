"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[14358,29802],{288864:(e,n,t)=>{t.d(n,{_:()=>a});t(296540);var o=()=>t(401497),s=()=>t(284371),i=()=>t(719147),r=t(474848);function a({href:e,external:n,onClick:t,children:a}){const c=(0,o().IS)((e=>({link:{color:e.blue.icon.accentPrimary,fontWeight:s().Wy.medium}})),[]);return(0,r.jsx)(i().A,{disableUnderline:!0,href:e,external:n,onClick:t,color:c.link.color,hoverColor:"blue",style:c.link,children:a})}},438177:(e,n,t)=>{function o(e){const n=e.getSubscriptionTier();return"plus"===n||"business"===n||"enterprise"===n}t.d(n,{o:()=>o})},508700:(e,n,t)=>{t.d(n,{T:()=>s});t(296540);const o={viewBox:"0 0 16 16",fittedViewBox:"1.62 2.87 12.76 10.25",svg:(0,t(474848).jsx)("path",{d:"M2.25 5.531h5.692a2.126 2.126 0 0 0 4.116 0h1.692a.625.625 0 1 0 0-1.25H12a2.126 2.126 0 0 0-4 0H2.25a.625.625 0 1 0 0 1.25M10 4.125a.875.875 0 1 1 0 1.75.875.875 0 0 1 0-1.75m-4 9c.921 0 1.706-.586 2-1.406h5.75a.625.625 0 0 0 0-1.25H8.058a2.126 2.126 0 0 0-4.116 0H2.25a.625.625 0 1 0 0 1.25H4a2.13 2.13 0 0 0 2 1.406m0-1.25a.875.875 0 1 1 0-1.75.875.875 0 0 1 0 1.75"})},s=(0,t(340498).wt)("slidersSmall",o)},596009:(e,n,t)=>{t.r(n),t.d(n,{arrowUpRightSquareFillIcon:()=>s,iconDefinition:()=>o});t(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"3.12 3.12 13.75 13.75",svg:(0,t(474848).jsx)("path",{d:"M5.25 3.125A2.125 2.125 0 0 0 3.125 5.25v9.5c0 1.174.951 2.125 2.125 2.125h9.5a2.125 2.125 0 0 0 2.125-2.125v-9.5a2.125 2.125 0 0 0-2.125-2.125zM7.875 7c0-.345.28-.625.625-.625H13c.345 0 .625.28.625.625v4.5a.625.625 0 1 1-1.25 0V8.509l-5.12 5.12a.625.625 0 1 1-.884-.883l5.12-5.121H8.5A.625.625 0 0 1 7.875 7"})},s=(0,t(340498).wt)("arrowUpRightSquareFill",o)},696012:(e,n,t)=>{t.r(n),t.d(n,{UniversalQnaModals:()=>Si});var o=t(296540),s=()=>t(59226),i=()=>t(242422),r=()=>t(484714),a=()=>t(56366),c=()=>t(187174),l=()=>t(576590),d=()=>t(634877),u=()=>t(249847),g=()=>t(152197),p=()=>t(291075),m=()=>t(963702),h=()=>t(765957),v=()=>t(430483),f=()=>t(756315),y=()=>t(99254),_=()=>t(329304),S=()=>t(604018),x=()=>t(235195),j=()=>t(174636),b=(t(581454),()=>t(564884)),C=()=>t(836095),I=()=>t(401497),w=()=>t(718827),k=()=>t(654777),A=()=>t(921997),M=()=>t(69708),T=()=>t(284371),N=()=>t(890494),D=()=>t(676007),W=()=>t(21140),B=()=>t(232930),P=()=>t(941541),F=()=>t(51218),U=t(474848);function E(){const e=(0,r().v3)(),n=(0,I().IS)((e=>({wrapper:{width:400,gap:16,alignContent:"center"},waitingForConnectionWrapper:{gap:4},note:{fontWeight:T().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginInlineStart:8},noteHeading:{fontWeight:T().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:T().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px"},learnMoreButton:{gap:4,alignItems:"center",fontSize:14,color:e.text.secondary,justifyContent:"center",padding:4},buttonContainer:{justifyContent:"center"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"}})),[]),t=(0,a().K8)((()=>"connecting"===p().o.state.currentScreen),[]),s=(0,g().r)(),i=(0,u().T)(),c=(0,a().K8)((()=>p().o.state.sessionId),[]),d=(0,o.useCallback)((async()=>{if(!s)return;if("connecting"!==p().o.state.currentScreen)return;"success"===(await(0,l().updateGithubAIConnectorStatus)({environment:e,spaceId:s})).status&&p().o.setState({...p().o.state,currentScreen:"confirmation"})}),[s,e]),m=(0,o.useCallback)((({key:e,value:n})=>{"connected"===n&&d()}),[d]);(0,o.useEffect)((()=>{if(!s||!i||!c)return;const n=P().Ay.addListener((0,A().Vz)({spaceId:s,connectorType:"github",userId:i,sessionId:c}),void 0,m,void 0,e);return()=>{n&&P().Ay.removeListener(n,e)}}),[e,m,s,i,c]),(0,o.useEffect)((()=>{"connecting"===p().o.state.currentScreen&&d()}),[d]);const h=(0,o.useCallback)((()=>[(0,U.jsxs)(W().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:n.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalQna.github.waitingForConnectionNoteHeading1",defaultMessage:"GitHub should open automatically on a new tab."},"note1-1")}),(0,U.jsx)("div",{style:n.noteBody,children:(0,U.jsx)(M().sA,{id:"universalSearch.github.waitingForConnectionNoteBody1",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,U.jsx)("a",{style:n.link,href:p().o.state.authUrl,target:"_blank",children:(0,U.jsx)(M().sA,{id:"universalQna.github.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,U.jsxs)(W().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:n.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.github.workspaceAdminHeading",defaultMessage:"If you are a GitHub organization administrator:"},"note2-2")}),(0,U.jsx)("div",{style:n.noteBody,children:(0,U.jsx)(M().sA,{id:"universalSearch.github.workspaceAdminBody",defaultMessage:"Follow GitHub’s instructions to connect. Return to this window, and the process will continue automatically."},"note2-3")}),(0,U.jsxs)(W().wt,{style:{marginTop:16,gap:4},children:[(0,U.jsx)("div",{style:n.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.github.notWorkspaceAdminHeading",defaultMessage:"If you are not authorized to install external apps:"},"note2-4")}),(0,U.jsx)("div",{style:n.noteBody,children:(0,U.jsx)(M().sA,{id:"universalSearch.github.notWorkspaceAdminBody",defaultMessage:"Follow the instructions to request access to install the app. Then, revisit the connect menu to continue setup."},"note2-5")})]})]},"note-2")]),[n]),v=(0,o.useCallback)((()=>{const n=(0,B().x)("guides.aiConnectorGithub");(0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_connecting_modal",integration_type:"github",setup_session_id:p().o.state.sessionId,from:p().o.state.analyticsFrom}}}),e.device.isElectron?(0,C().P)(n):window.open(n,"_blank")}),[e]),f=(0,o.useCallback)((()=>{p().o.reset(),(0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_github_connecting_modal",integration_type:"github",setup_session_id:p().o.state.sessionId,from:p().o.state.analyticsFrom}}})}),[e]);return(0,U.jsx)(D().a,{open:t,showCloseIcon:!0,onDismiss:f,render:()=>(0,U.jsxs)(W().wt,{style:n.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"github",title:(0,U.jsx)(M().sA,{id:"universalQnA.github.followInstructionsFromGithub",defaultMessage:"Follow instructions from GitHub in your browser"})}),(0,U.jsxs)(W().wt,{style:n.waitingForConnectionWrapper,children:[h().map(((e,t)=>(0,U.jsxs)(W().Ye,{gap:8,style:{marginTop:4,marginBottom:6,justifyContent:"center"},children:[(0,U.jsx)(N().A,{number:t+1}),(0,U.jsx)("div",{style:n.note,children:e})]},t))),(0,U.jsx)(W().Ye,{style:n.buttonContainer,children:(0,U.jsx)(w().Ay,{style:{marginTop:16,marginBottom:16,width:120,borderRadius:4},onClick:v,children:(0,U.jsxs)(W().Ye,{style:n.learnMoreButton,children:[(0,U.jsx)(M().sA,{id:"universalSearch.github.waitingForConnection.learnMore",defaultMessage:"Learn More"}),(0,k().X)({width:16,height:16})]})})})]})]})})}var z=()=>t(624820),L=()=>t(693954),K=()=>t(987267),H=()=>t(406094),R=()=>t(160432),G=()=>t(852219);function q(e){const{notes:n,connectorType:t,openLearnMoreUrl:s,open:i,onDismiss:r,title:a,subText:c,onClickPrimaryButton:l,primaryButtonText:d,warningMessage:u}=e,[g,p]=(0,o.useState)(!1),m=(0,I().IS)((e=>({wrapper:{width:400},selectionContainer:{padding:20,width:400,paddingTop:12},waitingForConnectionWrapper:{display:"flex",flexDirection:"column",alignItems:"center"},note:{fontWeight:T().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginInlineStart:8},buttonContainer:{width:"100%",marginTop:"16px"},primaryButton:{width:"100%"},learnMoreButton:{width:"100%"}})),[]),h=(0,M().tz)();return(0,U.jsx)(D().a,{ariaLabel:h.formatMessage({id:"universalSearch.waitingForConnection.ariaLabel",defaultMessage:"Authentication modal"}),showCloseIcon:!0,open:i,onDismiss:r,render:()=>(0,U.jsxs)("div",{style:m.wrapper,children:[(0,U.jsx)(F().b,{connectorType:t,title:a,subtext:c}),(0,U.jsx)(W().Ye,{style:m.selectionContainer,children:(0,U.jsx)(W().wt,{children:(0,U.jsxs)(W().wt,{style:m.waitingForConnectionWrapper,children:[n.map(((e,n)=>(0,U.jsxs)(W().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:[(0,U.jsx)(N().A,{number:n+1}),(0,U.jsx)("div",{style:m.note,children:e})]},n))),(0,U.jsxs)(W().wt,{style:m.buttonContainer,gap:6,children:[u,l?(0,U.jsx)(R().A,{colorPalette:"blue",size:"xl",isLoading:g,disabled:g,style:m.primaryButton,onClick:async()=>{p(!0),await l(),p(!1)},children:d}):void 0,s?(0,U.jsx)(H().A,{size:"lg",iconLeading:{icon:G().bookSmallIcon,size:"xs"},style:m.learnMoreButton,onClick:s,children:(0,U.jsx)(M().sA,{id:"universalSearch.integrations.learnMore",defaultMessage:"Read our step-by-step guide"})}):void 0]})]})})})]})})}function O(e){const{connector:n,learnMoreUrl:t,troubleShootingUrl:s,staticConnectorAuthUrl:i,setConnectionStateAsConnected:c,callConnectionApi:l,screenName:u,connectorSpecificSetupNote:p,nextScreens:m,setConnectionConflictSpaceId:h}=e,[v,f]=o.useState(!1),y=(0,I().IS)((e=>({noteHeading:{fontWeight:T().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:T().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{width:18,height:17,color:"#D7813A",marginTop:2},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingInlineStart:14,fontweight:T().Wy.regular},warningContainer:{marginInlineStart:5,marginInlineEnd:5,marginBottom:15}})),[]),_=(0,r().v3)(),S=(0,g().r)(),x=(0,d().nB)({connector:n,authorizationType:"workspace",existingAuthorizationUrl:i}),j=(0,K().G6)(n),C=(0,a().O$)(d().NT[n]),{sessionId:w,currentScreen:k,analyticsFrom:A}=C,N=(0,o.useCallback)((async()=>{if(!S)return;var e;await(e=5e3,new Promise((n=>setTimeout(n,e))));const t=await l();(0,d().getAiConnectorRefreshFunction)(n)({environment:_,spaceId:S});const o=e=>{(0,b().u)({environment:_,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:e,integration_type:n,setup_session_id:w,from:A}}})};var s,i,r,a;"success"===t.type?null!==(s=t.data)&&void 0!==s&&s.connectionSuccess?(o("auth_screen_connected"),d().NT[n].setState({...C,currentScreen:m.connectionSuccess}),c()):((e,t,s)=>{switch(e){case 401:o("auth_screen_not_connected_warning"),f(!0);break;case 403:o("info_screen_connect_not_admin_screen"),d().NT[n].setState({...C,currentScreen:m.notAdminOfConnectorAccount});break;case 400:"GOOGLE_MAPPING_EXIST"===t&&s?(o("workspace_already_connected"),d().NT[n].setState({...C,currentScreen:m.connectionConflict}),null==h||h(s)):d().NT[n].setState({...C,currentScreen:m.error});break;default:d().NT[n].setState({...C,currentScreen:m.error})}})(null==t||null===(i=t.data)||void 0===i||null===(i=i.errorResponse)||void 0===i?void 0:i.status,null==t||null===(r=t.data)||void 0===r||null===(r=r.errorResponse)||void 0===r?void 0:r.errorCode,null==t||null===(a=t.data)||void 0===a||null===(a=a.errorResponse)||void 0===a||null===(a=a.data)||void 0===a?void 0:a.spaceId):d().NT[n].setState({...C,currentScreen:m.error})}),[A,_,w,S,n,C,c,l,m,h]),D=(0,o.useCallback)((()=>[(0,U.jsxs)(W().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:y.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.authModal.waitingForConnectionNoteHeading1",defaultMessage:"{connectorName} should open automatically on a new browser tab.",values:{connectorName:j}},"note1-1")}),(0,U.jsx)("div",{style:y.noteBody,children:(0,U.jsx)(M().sA,{id:"universalSearch.authModal.authWaiting",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,U.jsx)("a",{style:y.link,href:x,target:"_blank",onClick:()=>{(0,b().u)({environment:_,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_open_auth_url",integration_type:n,setup_session_id:w,from:A}}})},children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,U.jsxs)(W().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:y.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.authModal.workspaceAdminHeading",defaultMessage:"Follow {connectorName}’s setup instructions",values:{connectorName:j}},"note2-1")}),(0,U.jsx)("div",{style:y.noteBody,children:p?(0,U.jsx)(M().sA,{...p}):(0,U.jsx)(M().sA,{id:"universalSearch.authModal.workspaceAdminBody",defaultMessage:"For better AI answers, we recommend selecting the option “All users in my organization”."},"note2-2")})]},"note-2"),(0,U.jsx)(W().wt,{style:{gap:4},children:(0,U.jsx)("div",{style:y.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.authModal.done",defaultMessage:"When you’re done, click the button below"},"note3-1")})},"note-3")]),[y,x,_,w,A,n,j,p]),B=v?(0,U.jsxs)(W().Ye,{style:y.warningContainer,children:[(0,L().Q)(y.icon),(0,U.jsx)("div",{style:y.warningText,children:(0,U.jsx)(M().sA,{id:"universalQnA.authScreen.warning",defaultMessage:"We couldn’t connect to {connectorName}. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{connectorName:j,TroubleshootingGuide:(0,U.jsx)("a",{style:{...y.link,color:"#D7813A"},href:s,target:"_blank",onClick:()=>{(0,b().u)({environment:_,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"troubleshooting_guide_opened",integration_type:n,setup_session_id:w,from:A}}})},children:(0,U.jsx)(M().sA,{id:"universalSearch.authModal.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,U.jsx)(q,{title:(0,U.jsx)(M().sA,{id:"universalQnA.AuthScreen",defaultMessage:"Follow instructions from {connectorName} in your browser",values:{connectorName:j}}),open:k===u,onDismiss:()=>{f(!1),(0,b().u)({environment:_,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_dismiss",integration_type:n,setup_session_id:w,from:A}}}),d().NT[n].setState({...C,currentScreen:"none"})},warningMessage:B,notes:D(),openLearnMoreUrl:()=>{window.open(t)},connectorType:n,primaryButtonText:(0,U.jsx)(M().sA,{id:"universalSearch.connector.Button.finishedSetup",defaultMessage:"Confirm connection"},"note3-1"),onClickPrimaryButton:N})}function Y(){const e=(0,r().v3)(),n=(0,g().r)(),{learnMoreUrl:t,troubleShootingUrl:o}=(0,d().hP)("asana");return n?(0,U.jsx)(O,{connector:"asana",screenName:"auth",nextScreens:{notAdminOfConnectorAccount:"error",connectionConflict:"error",connectionSuccess:"settings",error:"error"},learnMoreUrl:t,troubleShootingUrl:o,setConnectionStateAsConnected:()=>{z().P0.setState({...z().P0.state,connectionStatus:"completed",syncProgressPercentage:100,isConnected:!0,isLoaded:!0})},callConnectionApi:async()=>(await(0,l().updateAsanaAIConnectorStatus)({environment:e,spaceId:n}),{type:"success",data:{connectionSuccess:!0}})}):null}t(944114);var J=()=>t(471995),Q=()=>t(508700);const $=(0,M().YK)({defaultTitle:{id:"universalQna.connectionComplete.defaultTitle",defaultMessage:"You’re done!"},defaultSubText:{id:"universalQna.connectionComplete.defaultSubText",defaultMessage:"What happens next:"},defaultPrimaryButton:{id:"universalQna.connectionComplete.defaultPrimaryButton",defaultMessage:"Got it"},connectionInProgressTitle:{id:"universalQna.connectionComplete.connectionInProgressTitle",defaultMessage:"We’re connecting your {appName} content"},defaultConnectionTime:{id:"universalQna.connectionComplete.defaultConnectionTime",defaultMessage:"This may take up to 36 hours"},defaultPermissionsWillBeRespected:{id:"universalQna.connectionComplete.defaultPermissionsWillBeRespected",defaultMessage:"{appName} permissions are strictly respected and members will only see content they have access to."},defaultNotionAiWillBeAbleToAnswerQuestions:{id:"universalQna.connectionComplete.defaultNotionAiWillBeAbleToAnswerQuestions",defaultMessage:"Notion AI will be able to search and answer questions across Notion and {appName} knowledge."}});function V(e){const{open:n,connectorType:t,notes:s,onDismiss:i,onPrimaryButtonClick:r,onEditSettingsClick:a,title:c,subText:l,primaryButtonText:d}=e,u=1===s.length,[g,p]=(0,o.useState)(!1),[m,h]=(0,o.useState)(!1),v=(0,M().tz)(),f=(0,I().IS)((e=>({wrapper:{width:400},notesContainer:{marginTop:u?0:24,font:T().Tf.sans,paddingInlineStart:20,paddingInlineEnd:20,textAlign:u?"center":"start",justifyContent:"center"},singleNoteText:{fontSize:14,fontWeight:T().Wy.regular,color:e.text.secondary,textAlign:"center",paddingInlineStart:8,paddingInlineEnd:8,textWrap:"balance"},buttonsContainer:{margin:20,display:"flex",flexDirection:"column",gap:8}})),[u]),y=c||(0,U.jsx)(M().sA,{...$.defaultTitle}),_=u?void 0:l||(0,U.jsx)(M().sA,{...$.defaultSubText}),S=d||(0,U.jsx)(M().sA,{...$.defaultPrimaryButton});return(0,U.jsx)(D().a,{overlayZIndex:999,ariaLabel:v.formatMessage({id:"universalQnAConnectionCompleteModal.title",defaultMessage:"You’re done!"}),open:n,onDismiss:()=>{i()},render:()=>(0,U.jsxs)("div",{style:f.wrapper,children:[(0,U.jsx)(F().b,{connectorType:t,title:y,subtext:_}),(0,U.jsx)(W().wt,{gap:12,style:f.notesContainer,className:"notes-Container",children:u&&s.length>0?(0,U.jsx)("div",{style:f.singleNoteText,children:(0,U.jsx)(M().sA,{...s[0].props.title?s[0].props.title:$.defaultTitle})}):s.map(((e,n)=>e))}),r||a?(0,U.jsxs)("div",{style:f.buttonsContainer,children:[a?(0,U.jsx)(H().A,{iconLeading:{icon:Q().T,size:"sm"},isLoading:m,style:{width:"100%"},onClick:async()=>{h(!0),await a(),h(!1)},children:(0,U.jsx)(M().sA,{id:"universalSearch.connectionComplete.customizeConnectedContent",defaultMessage:"Customize connected content"})}):void 0,r?(0,U.jsx)(R().A,{colorPalette:"blue",isLoading:g,style:{fontSize:14,fontWeight:T().Wy.semibold,width:"100%"},onClick:async()=>{p(!0),await r(),p(!1)},children:S}):void 0]}):void 0]})})}function X({title:e,description:n,number:t}){const s=(0,I().IS)((e=>({title:{fontSize:T().J.UIRegular.desktop,color:e.text.primary,fontWeight:T().Wy.medium},body:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.regular,color:e.text.secondary}})),[]);return(0,U.jsxs)(W().Ye,{gap:8,style:{marginBottom:8},children:[(0,U.jsx)(N().A,{number:t}),(0,U.jsxs)(W().wt,{gap:4,children:[(0,U.jsx)("div",{style:s.title,children:(0,U.jsx)(M().sA,{...e})}),n?(0,U.jsx)("div",{style:s.body,children:o.isValidElement(n)?n:(0,U.jsx)(M().sA,{...n})}):void 0]})]})}function Z(e){const{connector:n,screenName:t,nextScreens:s,onStartIngestion:i,ingestionNotNeeded:c,noSelectionAllowed:u}=e,p=(0,I().IS)((e=>({link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"}})),[]),m=(0,r().v3)(),h=(0,g().r)(),v=(0,a().O$)(d().NT[n]),{sessionId:f,currentScreen:y,analyticsFrom:_}=v,x=y===t,j=K().w0[n],C=(0,a().K8)((()=>(0,S().XY)(n)),[n]);(0,o.useEffect)((()=>{x&&(0,l().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:m,connector:n,moment:"finished"})}),[x,n,m]);const k=(0,o.useCallback)((()=>{(0,b().u)({environment:m,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_dismiss",integration_type:n,setup_session_id:f,from:_}}}),d().NT[n].setState({...v,currentScreen:"none"})}),[_,m,f,n,v]),A=(0,o.useCallback)((async()=>{if(!h)return;(0,b().u)({environment:m,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"shared_drive_settings",integration_type:n,setup_session_id:f,from:_}}});const{status:e}=await(0,d().getAiConnectorRefreshFunction)(n)({environment:m,spaceId:h});if("success"===e){const e=(0,S().XY)(n);"in_progress"===e?d().NT[n].setState({...v,currentScreen:s.inProgress}):"not_started"===e?d().NT[n].setState({...v,currentScreen:s.notStarted}):d().NT[n].setState({...v,currentScreen:s.error})}else d().NT[n].setState({...v,currentScreen:s.error})}),[_,m,n,h,v,s,f]),T="in_progress"===C,N=(0,o.useMemo)((()=>{const e=[];return c||e.push((0,U.jsx)(X,{number:1,title:$.defaultConnectionTime,description:u||T?void 0:(0,U.jsx)("div",{children:(0,U.jsx)(M().sA,{id:"universalSearch.connectionComplete.waitingForConnectionNoteBody1",defaultMessage:"If you want to choose content, {clickHere}",values:{clickHere:(0,U.jsx)("a",{style:p.link,onClick:A,children:(0,U.jsx)(M().sA,{id:"universalSearch.connectionCompleteModal.settings",defaultMessage:"click here."})})}})})},"ingestionDelayNotice")),e.push((0,U.jsx)(X,{number:e.length+1,title:{...{...$.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:j}}}},"notionAiAnswerQuestions")),e}),[j,c,u,T,p.link,A]);return h?(0,U.jsx)(V,{open:x,connectorType:n,notes:N,onPrimaryButtonClick:async()=>{if((0,b().u)({environment:m,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_done",integration_type:n,setup_session_id:f,from:_}}}),d().NT[n].setState({...v,currentScreen:"none"}),T)return;await(null==i?void 0:i())&&function(e){J().D6({label:(0,U.jsx)(M().sA,{id:"ingestionConfirmation.ingestion.acknowledge",defaultMessage:"Started syncing from {connectorName}. This can take up to 36 hours.",values:{connectorName:e}}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(w().Ay,{onClick:J().N2,children:(0,U.jsx)(M().sA,{id:"ingestionConfirmation.ingestion.startedMessageDismiss",defaultMessage:"Close"})})})}(j)},onDismiss:k}):null}function ee(){return(0,U.jsx)(Z,{connector:"asana",screenName:"connection_complete",nextScreens:{notStarted:"auth",inProgress:"settings",alreadyConnected:"intro",error:"error"},ingestionNotNeeded:!0,onStartIngestion:void 0})}var ne=()=>t(902006),te=()=>t(498474);const oe=function(e){const{onDismiss:n,onClickGotItBtn:t,open:o,title:s,descriptionMessage:i,connectorType:r,message:a}=e,c=(0,I().IS)((e=>({modal:{width:400,alignItems:"center"},contentWrapper:{paddingTop:0,paddingInlineEnd:20,paddingBottom:24,paddingInlineStart:20,gap:8},messageWrapper:{gap:19},gotItButton:{width:"100%"}})),[]);return(0,U.jsx)(D().a,{showCloseIcon:!0,open:o,onDismiss:n,render:()=>(0,U.jsxs)("div",{style:c.modal,children:[(0,U.jsx)(F().b,{connectorType:r,title:s,subtext:i}),(0,U.jsxs)("div",{style:c.contentWrapper,children:[(0,U.jsx)("div",{style:c.messageWrapper,children:a}),(0,U.jsx)("div",{children:(0,U.jsx)(H().A,{size:"lg",style:c.gotItButton,onClick:t,children:(0,U.jsx)(M().sA,{id:"aiConnectors.common.disconnectModal.confirmDisconnect",defaultMessage:"Got it"})})})]})]})})};function se(e){const{connector:n,showGoogleWorkspaceNote:t,postDisconnectScreenName:s,disconnectScreenName:i,settingsScreenName:c,errorScreenName:u,setStatusAsDisconnected:p}=e,m=(0,a().O$)(d().NT[n]),{analyticsFrom:h,sessionId:v,currentScreen:f}=m,y=K().w0[n],_=(0,g().r)(),S=(0,r().v3)(),x=(0,M().tz)(),j=(0,I().IS)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:T().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:T().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:T().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:T().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:14,fontWeight:T().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{paddingTop:12,paddingInlineEnd:12,paddingBottom:12,paddingInlineStart:12,gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:T().Wy.regular,fontSize:14,lineHeight:"18px"},noteHeading:{fontWeight:T().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:T().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{rotate:"45deg",width:12,height:12,cursor:"pointer",display:"inline",padding:0,margin:0}})),[]),C=(0,o.useCallback)((()=>{const{noteBlockWrapper:o,noteHeading:s,noteBody:i,link:r}=j,a=[];return a.push((0,U.jsxs)(W().wt,{style:o,children:[(0,U.jsx)("div",{style:s,children:(0,U.jsx)(M().sA,{id:"aiConnectors.post_disconnect_screen.note_1.heading",defaultMessage:"{workspaceConnectorDisplayName} data will be permanently deleted from Notion",values:{workspaceConnectorDisplayName:K().w0[(0,K().uV)(n)]}},"note1-1")}),(0,U.jsx)("div",{style:i,children:(0,ne().Gb)(n)?(0,U.jsx)(M().sA,{id:"aiConnectors.post_disconnect_screen.note_1.bodyVectorless",defaultMessage:"{connector} is now fully disconnected.",values:{connector:K().w0[n]}},"note1-2"):(0,U.jsx)(M().sA,{id:"aiConnectors.post_disconnect_screen.note_1.body",defaultMessage:"This process can take up to 3 hours. You’ll only be able to reconnect after disconnecting is complete."},"note1-2")})]},"note-1")),t&&a.push((0,U.jsxs)(W().wt,{style:o,children:[(0,U.jsx)("div",{style:s,children:"google-drive"===n||"gmail"===n?(0,U.jsx)(M().sA,{id:"aiConnectors.post_disconnect_screen.note_2.headingForGoogle",defaultMessage:"Uninstall the Notion AI app from your Google Workspace (optional)"},"note2-1-google"):(0,U.jsx)(M().sA,{id:"aiConnectors.post_disconnect_screen.note_2.heading",defaultMessage:"Uninstall the Notion AI app from your {connectorParentOrganization} workspace (optional)",values:{connectorParentOrganization:(0,K().G6)(n)}},"note2-1")}),(0,U.jsx)("div",{style:i,children:(0,U.jsx)(M().sA,{id:"aiConnectors.post_disconnect_screen.note_2.body",defaultMessage:"Go to your {NavigateToWorkspaceAppsSettings} and uninstall the Notion AI app.",values:{marketplaceAppName:e.marketplaceAppName,NavigateToWorkspaceAppsSettings:(0,U.jsx)("a",{style:r,href:e.marketplaceAppConfigureUrl,target:"_blank",onClick:()=>{(0,b().u)({environment:S,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_screen_marketplace_app_disconnect_btn",integration_type:n,setup_session_id:v,from:h}}})},children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.post_disconnect_screen.disconnect_workspace_app",defaultMessage:"{connectorSettings} {ArrowIcon}",values:{connectorSettings:(0,K().I6)(n),ArrowIcon:(0,te().q)(j.icon)}})})}},"note2-2")})]},"note-2")),a}),[n,j,e,t,S,v,h]);return f===s?(0,U.jsx)(oe,{onClickGotItBtn:()=>{d().NT[n].setState({...m,currentScreen:"none"})},onDismiss:()=>{d().NT[n].setState({...m,currentScreen:"none"})},open:f===s,connectorType:n,title:(0,ne().Gb)(n)?(0,U.jsx)(M().sA,{id:"aiConnectors.post_disconnect_modal.titleVectorless",defaultMessage:"{displayName} is disconnected from Notion",values:{displayName:y}}):(0,U.jsx)(M().sA,{id:"aiConnectors.post_disconnect_modal.title",defaultMessage:"{displayName} is disconnecting from Notion",values:{displayName:y}}),descriptionMessage:(0,U.jsx)(M().sA,{id:"aiConnectors.post_disconnect_modal.description",defaultMessage:"Here’s what’s next:"}),message:(0,U.jsx)("div",{style:j.notesSectionWrapper,children:C().map(((e,n)=>(0,U.jsxs)(W().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:[(0,U.jsx)(N().A,{number:n+1}),(0,U.jsx)("div",{style:j.note,children:e})]},n)))})}):(0,U.jsx)(D().a,{ariaLabel:x.formatMessage({id:"aiConnectors.disconnectModal.label",defaultMessage:"Disconnect {displayName} from Notion"},{displayName:y}),showCloseIcon:!0,open:f===i,onDismiss:()=>{(0,b().u)({environment:S,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_close",integration_type:n,setup_session_id:v,from:h}}}),d().NT[n].setState({...m,currentScreen:"none"})},render:()=>(0,U.jsx)("div",{style:j.confirmWrapper,children:(0,U.jsxs)("div",{style:j.confirmContainer,children:[(0,U.jsx)("div",{style:j.confirmModalTitle,children:(0,U.jsx)(M().sA,{id:"aiConnectors.disconnectModal.title",defaultMessage:"Are you sure?"})}),(0,U.jsx)("div",{style:j.confirmModalSubTitle,children:(0,U.jsx)(M().sA,{id:"aiConnectors.disconnectModal.subTitle",defaultMessage:"{workspaceConnectorDisplayName} data will be permanently deleted from Notion.",values:{workspaceConnectorDisplayName:K().w0[(0,K().uV)(n)]}})}),(0,U.jsx)("div",{style:j.confirmModalDescription,children:(0,ne().Gb)(n)?(0,U.jsx)(M().sA,{id:"aiConnectors.disconnectModal.descriptionVectorless",defaultMessage:"This process should be instant."}):(0,U.jsx)(M().sA,{id:"aiConnectors.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."})}),(0,U.jsxs)(W().wt,{style:j.confirmModalActionButtons,children:[(0,U.jsx)(R().A,{colorPalette:"red",style:j.confirmDisconnectButton,disabled:d().NT[n].state.isDisconnecting??!1,onClick:async()=>{(0,b().u)({environment:S,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_confirm_disconnect_button",integration_type:n,setup_session_id:v,from:h}}}),await(async()=>{if(!_)return;const{type:e}=await(0,l().disconnectConnector)({connector:n,spaceId:_,environment:S,disconnectReason:"admin_disconnect"});(0,d().getAiConnectorRefreshFunction)(n)({environment:S,spaceId:_}),"failed"===e?d().NT[n].setState({...m,currentScreen:u}):p()})(),d().NT[n].setState({...m,currentScreen:s})},children:(0,ne().q1)(n)?(0,U.jsx)(M().sA,{id:"aiConnectors.disconnectModal.confirmDisconnectPersonal",defaultMessage:"Disconnect"}):(0,U.jsx)(M().sA,{id:"aiConnectors.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"})}),(0,U.jsx)(w().Ay,{style:j.goBackButton,onClick:()=>{(0,b().u)({environment:S,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_back_button",integration_type:n,setup_session_id:v,from:h}}}),d().NT[n].setState({...m,currentScreen:c})},children:(0,U.jsx)(M().sA,{id:"aiConnectors.disconnectModal.goBack",defaultMessage:"Go back"})})]})]})})})}function ie(){return(0,U.jsx)(se,{connector:"asana",postDisconnectScreenName:"intro",disconnectScreenName:"disconnect",settingsScreenName:"settings",errorScreenName:"error",setStatusAsDisconnected:()=>{z().P0.setState({...z().P0.state,connectionStatus:"not_started",isConnected:!1,isLoaded:!0,syncProgressPercentage:0})},showGoogleWorkspaceNote:!1})}function re(e){const{connector:n,title:t,subtext:s,handleErrorDismissClick:i}=e,c=(0,M().tz)(),l=(0,a().O$)(d().NT[n]),{currentScreen:u,sessionId:g,analyticsFrom:p}=l,m=(0,r().v3)(),h=(0,I().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{fontSize:14,fontWeight:T().Wy.semibold,width:"100%"}})),[]),v="error"===u;(0,o.useEffect)((()=>{v&&(0,b().u)({environment:m,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect_error",integration_type:n,setup_session_id:g,from:p}}})}),[v,p,g,m,n]);const f=(0,o.useCallback)((()=>{d().NT[n].setState({...l,currentScreen:"none"}),null==i||i()}),[l,n,i]);return(0,U.jsx)(D().a,{ariaLabel:c.formatMessage({defaultMessage:"Ai Connector Error Modal",id:"aiConnectorOnboarding.errorModal.ariaLabel"}),showCloseIcon:!0,onDismiss:f,open:v,render:()=>(0,U.jsxs)("div",{style:h.wrapper,children:[(0,U.jsx)(F().b,{connectorType:n,title:t||(0,U.jsx)(M().sA,{id:"universalSearch.errorModal.title",defaultMessage:"Oops! Something went wrong"}),subtext:s||(0,U.jsx)(M().sA,{id:"universalSearch.errorModal.description",defaultMessage:"Something went wrong, please try again later."})}),(0,U.jsx)(W().wt,{style:h.footer,children:(0,U.jsx)(R().A,{colorPalette:"blue",style:h.connectButton,onClick:f,children:(0,U.jsx)(M().sA,{id:"universalSearch.error.Dismiss",defaultMessage:"Close"})})})]})})}function ae(){return(0,U.jsx)(re,{connector:"asana",screenName:"error"})}var ce=()=>t(383466),le=()=>t(96563),de=()=>t(176983),ue=()=>t(596009),ge=()=>t(821983);const pe={viewBox:"0 0 20 20",fittedViewBox:"1.77 1.69 16.42 16.61",svg:(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("path",{d:"M17.22 11.956a.626.626 0 0 1 .753.998l-6.377 4.815a2.65 2.65 0 0 1-3.012.125l-.18-.125-6.378-4.815-.093-.086a.626.626 0 0 1 .739-.977l.108.065 6.376 4.816.096.065a1.4 1.4 0 0 0 1.592-.065z"}),(0,U.jsx)("path",{d:"M8.403 2.232a2.65 2.65 0 0 1 3.193 0l5.553 4.192.106.085a2.2 2.2 0 0 1-.106 3.427l-5.553 4.192a2.65 2.65 0 0 1-3.193 0L2.85 9.936a2.2 2.2 0 0 1 0-3.512z"})]})},me=(0,t(340498).wt)("layerMultipleFill",pe);var he=()=>t(471095);function ve(e){const n=(0,K().G6)(e);if("notion-mail"===e){const t=K().w0[(0,K().uV)(e)];return(0,U.jsx)(M().sA,{id:"universalQna.connector.introModalTitleNotionMail",defaultMessage:"Connect your {workspaceConnectorName} account using {connectorName}",values:{workspaceConnectorName:t,connectorName:n}})}return(0,U.jsx)(M().sA,{id:"universalQna.connector.introModalTitle",defaultMessage:"To start, install the Notion AI app in {connectorName}",values:{connectorName:n}})}function fe(e){const n=(0,K().G6)(e),t=K().w0[(0,K().uV)(e)],o=[{icon:ue().arrowUpRightSquareFillIcon,title:(0,U.jsx)(M().sA,{id:"universalQna.connector.introModalNewTabNoteTitle",defaultMessage:"{connectorName} will open in a new tab",values:{connectorName:n}},"newTabNoteTitle"),description:"notion-mail"===e?(0,U.jsx)(M().sA,{id:"universalQna.connector.introModalNewTabNoteDescriptionNotionMail",defaultMessage:"Authenticate or create a Notion Mail account"},"newTabNoteDescriptionNotionMail"):(0,U.jsx)(M().sA,{id:"universalQna.connector.introModalNewTabNoteDescription",defaultMessage:"Click “Start connection” below, then authenticate and accept terms in the new tab"},"newTabNoteDescription")},{icon:ge().keyFillIcon,title:(0,U.jsx)(M().sA,{id:"universalQna.connector.introModalPermissionNoteTitle",defaultMessage:"{workspaceConnectorName} permissions are strictly respected",values:{workspaceConnectorName:t}},"permissionNoteTitle"),description:(0,U.jsx)(M().sA,{id:"universalQna.connector.introModalPermissionNoteDescription",defaultMessage:"Members can only get AI answers about content they are authorized to see in {connectorName}.",values:{connectorName:n}},"permissionNoteDescription")},{icon:he().i,title:(0,U.jsx)(M().sA,{id:"universalQna.connector.introModalWeDoNotTrainModelNoteTitle",defaultMessage:"Notion does not train models on your {workspaceConnectorName} data",values:{workspaceConnectorName:t}},"weDoNotTrainModelNoteTitle")}],s={icon:(0,U.jsx)(F().E,{size:20}),title:(0,U.jsx)(M().sA,{id:"universalQna.connector.introModalSharePointAndOneDriveNoteTitle",defaultMessage:"SharePoint and OneDrive content are connected through a single setup"},"sharepointAndOneDriveNoteTitle")},i={icon:me,title:(0,U.jsx)(M().sA,{id:"universalQna.connector.introModalJiraV2NoteTitle",defaultMessage:"We’ll help you create an Atlassian Forge App"},"jiraV2NoteTitle"),description:(0,U.jsx)(M().sA,{id:"universalQna.connector.introModalJiraV2NoteDescription",defaultMessage:"We’ll need admin information to create and connect your app. This might take a few minutes."},"jiraV2NoteDescription")};switch(e){case"sharepoint":return[s,...o];case"jira":return[i,...o.slice(1)];default:return o}}var ye=()=>t(970023);function _e(e){const{connectorType:n,open:t,onClosed:o,learnMoreUrl:s}=e,i=(0,I().IS)((e=>({wrapper:{width:"100vw",height:"100vh",justifyContent:"center",alignItems:"center"},container:{gap:16,alignItems:"center"},learnMoreText:{gap:4,alignItems:"center",fontSize:14,color:e.text.secondary,justifyContent:"center"},actionsContainer:{gap:4,width:240,alignItems:"center"},learnMoreButton:{marginTop:16,borderRadius:6,width:"100%"},primaryButton:{width:"100%"},learnMoreWrapper:{width:"100%"}})),[]);return(0,r().v3)().device.isMobile?(0,U.jsx)(D().a,{showCloseIcon:!0,onDismiss:o,open:t,render:()=>(0,U.jsx)(W().Ye,{style:i.wrapper,children:(0,U.jsxs)(W().wt,{style:i.container,children:[(0,U.jsx)(F().b,{connectorType:n,title:(0,U.jsx)(M().sA,{id:"universalQna.notAvailableOnMobile.heading",defaultMessage:"Connecting {appName} and Notion is only available on desktop",values:{appName:K().w0[n]}})}),(0,U.jsxs)(W().wt,{style:i.actionsContainer,children:[(0,U.jsx)(R().A,{colorPalette:"blue",style:i.primaryButton,onClick:o,children:(0,U.jsx)(M().sA,{id:"universalQna.notAvailableOnMobile.close",defaultMessage:"Got it"})}),(0,U.jsx)(W().Ye,{style:i.learnMoreWrapper,children:(0,U.jsx)(w().Ay,{style:i.learnMoreButton,onClick:()=>{window.open(s,"_blank")},children:(0,U.jsxs)(W().Ye,{style:i.learnMoreText,children:[(0,U.jsx)(M().sA,{id:"universalSearch.slack.waitingForConnection.learnMore",defaultMessage:"Learn More"}),(0,k().X)({width:16,height:16})]})})})]})]})})}):(0,U.jsx)(U.Fragment,{})}var Se=()=>t(453202),xe=()=>t(270812),je=()=>t(162850);const be=(0,M().YK)({title:{defaultMessage:"Find anything across all of your apps with Notion AI",id:"NotionAIConnectorNonadminModal.title"},subtitleForAnnouncement:{defaultMessage:"Notify your workspace owner to use AI connectors.",id:"NotionAIConnectorNonadminModal.subtitleForAnnouncement"},learnMoreLink:{defaultMessage:"Learn more about",id:"NotionAIConnectorNonadminModal.learnMoreLink"},toast:{defaultMessage:"We will send a notification to your workspace owner",id:"NotionAIConnectorNonadminModal.toast"},alreadyRequestedToast:{defaultMessage:"You’ve previously notified your workspace owner - your request is in review.",id:"NotionAIConnectorNonadminModal.alreadyRequestedToast"}});function Ce(){const e=(0,a().K8)((()=>Se().O.state.open&&"nonadmin_request"===Se().O.state.modal?{open:!0,analyticsFrom:Se().O.state.analyticsFrom}:{open:!1}),[]),n=(0,o.useCallback)((()=>{Se().O.setState({open:!1})}),[]);return e.open?(0,U.jsx)(Ie,{connector:"generic",handleClose:n,open:!0,analyticsFrom:e.analyticsFrom,setupSessionId:"none",messages:{...be,betaDisclaimer:{...ye().gp.betaDisclaimer},ctaButtonLabelWithAddon:{...ye().gp.ctaButtonLabelWithAddon},ctaButtonLabelWithoutAddon:{...ye().gp.ctaButtonLabelWithoutAddon}}}):null}function Ie(e){const{open:n,handleClose:t,connector:s,analyticsFrom:i,setupSessionId:a,messages:c}=e,l=(0,M().tz)(),d=(0,r().v3)(),u=(0,de().J)(),p=(0,g().r)(),m=d.currentUser.id,h=(0,_()._X)({name:"ai_connectors",spaceId:p,userId:m}),{openModal:v,canUserRequestUpgrade:f}=(0,xe().E)({type:"feature",featureAvailability:h,entrypoint:"ai_connectors_request_modal",analyticsEntrypoint:"ai_request_modal",isOptimisticUpsell:!1}),y=(0,o.useCallback)((({source:e,upsell:n})=>{"closeButton"!==e?(i&&(0,b().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"contact_workspace_owners",integration_type:s,setup_session_id:a,from:i}}}),n?f?(v(),t()):(t(),J().D6({label:(0,U.jsx)(M().sA,{...be.alreadyRequestedToast})})):(t(),J().D6({label:(0,U.jsx)(M().sA,{...be.toast})}))):t()}),[t,s,d,v,f,i,a]);return h?(0,U.jsx)(D().a,{showCloseIcon:!0,onDismiss:()=>y({source:"closeButton",upsell:void 0}),open:n,ariaLabel:l.formatMessage(be.title),render:()=>(0,U.jsx)(je().Y,{aiConnectorsFeatureAvailability:h,calloutKey:void 0,eventName:"ai_connector_nonadmin_request_modal_shown",messages:c,onDismiss:y,connector:s,showNarrowCta:u})}):null}var we=()=>t(125565);const ke=function(e){const{title:n,open:s,notes:i,connectorType:r,onDismiss:a,onConnect:c,onLearnMore:l,isLoading:u,overridePrimaryMessage:g,centerNotes:p,noteStyleOverrides:m,subtitle:h}=e,v=(0,M().tz)(),f=(0,I().IS)((e=>({wrapper:{width:400,paddingTop:8},dataSafetyWrapper:{width:"100%",justifyContent:"center",marginTop:8,padding:"0px 20px"},notes:{display:"flex",flexDirection:"column",marginTop:12,gap:12,font:T().Tf.sans,listStylePosition:"outside",paddingInlineStart:2,listStyleType:"none",...p&&{textAlign:"center",justifyContent:"center"}},note:{display:"flex",alignItems:"start",fontSize:T().J.UIRegular.desktop,lineHeight:T().K_.UIRegular.desktop,color:`${e.text.secondary}`,padding:2,gap:12,listStylePosition:"outside",marginBottom:4,...p&&{alignItems:"center",textAlign:"center",justifyContent:"center"},...m},noteIconWrapper:{display:"flex",alignItems:"center",justifyContent:"center"},noteTextWrapper:{display:"flex",flexDirection:"column",alignItems:"start",justifyContent:"center",gap:4},noteIcon:{width:20,height:20,color:e.palette.uiBlue[600]},noteTitle:{fontWeight:T().Wy.medium,textWrap:"pretty"},footer:{justifyContent:"center",alignItems:"center",width:"100%",paddingTop:12,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{width:"100%"},learnMoreButton:{width:"100%"}})),[p,m]),y=(0,o.useCallback)((()=>{const e=d().NT[r];e.setState({...e.state,currentScreen:"none"})}),[r]);return(0,U.jsx)(D().a,{ariaLabel:v.formatMessage({id:"universalSearch.integrations.introModalAriaLabel",defaultMessage:"AI connector introduction"}),showCloseIcon:!0,onDismiss:a,open:s,render:()=>(0,U.jsxs)("div",{style:f.wrapper,children:[(0,U.jsx)(F().b,{connectorType:r,title:n,subtext:h}),(0,U.jsx)(t(900615).f,{upgradeRequestAnalyticsEntrypoint:"ai_connector_modal",upgradeRequestEntrypoint:"ai_connectors_request_modal",sunsetCheckSource:"ai_connectors_modal",additionalOnClickUpgrade:y}),i?(0,U.jsx)(W().Ye,{style:f.dataSafetyWrapper,children:(0,U.jsx)("ul",{style:f.notes,children:i.map(((e,n)=>(0,U.jsxs)("li",{style:f.note,children:[(0,U.jsx)("div",{style:f.noteIconWrapper,children:e.icon?"function"==typeof e.icon?e.icon(f.noteIcon):e.icon:void 0}),(0,U.jsxs)("div",{style:f.noteTextWrapper,children:[(0,U.jsx)(we().A,{isMultiline:!0,style:f.noteTitle,children:e.title}),e.description?(0,U.jsx)(we().A,{isMultiline:!0,isSecondaryColor:!0,children:e.description}):void 0]})]},`note-${n}`)))})}):void 0,(0,U.jsxs)(W().wt,{style:f.footer,children:[(0,U.jsx)(R().A,{colorPalette:"blue",size:"xl",isLoading:u,disabled:u,style:f.connectButton,onClick:c,children:g||(0,U.jsx)(M().sA,{id:"universalSearch.integration.startConnection",defaultMessage:"Start connection"})}),l?(0,U.jsx)(H().A,{size:"lg",iconLeading:{icon:G().bookSmallIcon,size:"xs"},style:f.learnMoreButton,onClick:l,children:(0,U.jsx)(M().sA,{id:"universalSearch.integrations.learnMore",defaultMessage:"Read our step-by-step guide"})}):void 0]})]})})};function Ae(e){return`${(0,ne().aK)(e)}_connect_button`}const Me=(0,M().YK)({oauthPopupTitle:{defaultMessage:"Connect {connector} AI Connector",id:"AIConnectorIntroModal.oauthPopupTitle"}});function Te(e){const{connector:n,learnMoreUrl:t,staticAuthUrl:s,openAuthUrl:i}=e,[c,u]=o.useState(!1),p=(0,r().v3)(),m=(0,o.useMemo)((()=>fe(n)),[n]),h=(0,o.useMemo)((()=>ve(n)),[n]),f=(0,g().r)(),y=(0,a().O$)(d().NT[n]),{currentScreen:x,analyticsFrom:j,sessionId:I}=y,w=(0,a().K8)((()=>v().zD.canUseAiConnectorSearchScope(n)),[n]),k="introduction"===x,A=(0,de().J)(),M=p.currentUser.id,T=(0,_().P9)({name:"ai_connectors",spaceId:f,userId:M}),N=(0,d().nB)({connector:n,authorizationType:"workspace",existingAuthorizationUrl:s,openAuthUrl:i});return(0,o.useEffect)((()=>{k&&w&&(0,b().u)({environment:p,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:n,setup_session_id:I,from:j,is_space_admin:A,is_ai_eligible:T??!1}}})}),[p,j,T,k,A,I,n,w]),w&&"sharepoint"!==n?p.device.isMobile?(0,U.jsx)(_e,{connectorType:n,open:k,onClosed:()=>d().NT[n].reset(),learnMoreUrl:t}):A||(0,ne().q1)(n)?(0,U.jsx)(ke,{connectorType:n,notes:m,onLearnMore:()=>{window.open(t,"_blank")},onConnect:async()=>{f&&(N||i)&&(u(!0),await async function(e){const{connector:n,environment:t,spaceId:o,setupSessionId:s,from:i,authUrl:r,openAuthUrl:a,onConnectNotStarted:c,nextScreens:u,usesPopup:g,onNavigateToInProgressScreen:p}=e,m=d().NT[n].state;(0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect",integration_type:n,setup_session_id:s,from:i}}}),(0,l().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:t,connector:n,moment:"started"});const h=await(0,_().Bw)(t,{name:"ai_connectors",spaceId:o,userId:t.currentUser.id}),v=(0,ne().q1)(n);if(!(0,_().e2)(h)&&!v)return void(0,le().pp)({connector:n,environment:t,analyticsFrom:i,connectorsFeatureAvailability:h});const{status:f}=await(0,d().getAiConnectorRefreshFunction)(n)({environment:t,spaceId:o});if("failed"===f)return void d().NT[n].setState({...m,currentScreen:u.error});const y=(0,S().XY)(n);if("in_progress"===y)return(0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connection_complete_screen",integration_type:n,setup_session_id:s,from:i}}}),d().NT[n].setState({...m,currentScreen:u.inProgress}),void(null==p||p());if("completed"===y)return(0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"already_connected_screen",integration_type:n,setup_session_id:s,from:i}}}),void d().NT[n].setState({...m,currentScreen:u.alreadyConnected});(0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen",integration_type:n,setup_session_id:s,from:i}}}),d().NT[n].setState({...m,currentScreen:u.notStarted}),a?a():g&&r?t.device.isElectron?(0,C().P)(r):ce().P(t,{width:800,height:600,url:r,titleMessage:Me.oauthPopupTitle,titleMessageValues:{connector:n}}):r&&window.open(r,"_blank");null==c||c()}({environment:p,spaceId:f,setupSessionId:I,from:Ae(n),authUrl:N,...e}),u(!1))},onDismiss:()=>{(0,b().u)({environment:p,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_dismiss",integration_type:n,setup_session_id:I,from:j}}}),d().NT[n].setState({...y,analyticsFrom:j,sessionId:I,currentScreen:"none"})},title:h,isLoading:c,open:k}):(0,U.jsx)(Ie,{connector:n,handleClose:()=>(0,l().resetAiConnectorStatus)(n),open:k,analyticsFrom:j,setupSessionId:I,messages:ye().vc[n]}):null}function Ne(){const{learnMoreUrl:e}=(0,d().hP)("asana");return(0,U.jsx)(Te,{connector:"asana",screenName:"introduction",nextScreens:{notStarted:"auth",inProgress:"settings",alreadyConnected:"introduction",error:"error"},usesPopup:!0,learnMoreUrl:e})}var De=()=>t(252291),We=()=>t(98126),Be=()=>t(373009),Pe=()=>t(218275),Fe=()=>t(859428);function Ue(e){const{connector:n,screenName:t,nextScreens:s,onDismiss:i,learnMoreUrl:c,settings:l}=e,u=(0,a().O$)(d().NT[n]),g=(0,de().J)(),{analyticsFrom:p,sessionId:m,currentScreen:h}=u,v=K().w0[n],f=(0,a().K8)((()=>(0,S().XY)(n)),[n]),[y,_]=(0,o.useState)(!!l),[x,j]=(0,o.useState)(!l),C=function(e){return(0,I().IS)((n=>({wrapper:{width:400,padding:"0 24px 16px",minHeight:e?478:void 0},settingsWrapper:{justifyContent:"center",gap:12},footer:{justifyContent:"center",alignItems:"center",width:"100%",gap:8},disconnectButton:{fontSize:14,fontWeight:T().Wy.medium,width:"100%"},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:T().Wy.semibold,color:n.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:T().Wy.regular,color:n.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:T().Wy.regular,color:n.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:T().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:14,fontWeight:T().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,justifyContent:"center",alignItems:"center"},learnMoreSection:{padding:"24px 0"},learnMoreButton:{fontSize:14,fontWeight:T().Wy.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:T().Wy.medium,fontSize:12,gap:5,justifyContent:"center",alignItems:"center",paddingTop:4,paddingInlineEnd:8,paddingBottom:4,paddingInlineStart:8,color:`${n.text.secondary}`}})),[e])}(y),k=(0,r().v3)(),A=(0,M().tz)();return(0,U.jsx)(D().a,{ariaLabel:A.formatMessage({id:"aiConnectors.settingsModalAriaLabel",defaultMessage:"AI Connector Settings"}),showCloseIcon:!0,open:h===t,onDismiss:()=>{(0,b().u)({environment:k,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_close",integration_type:n,setup_session_id:m,from:p}}}),null==i||i(),d().NT[n].setState({...u,currentScreen:"none"})},render:()=>(0,U.jsxs)("div",{style:C.wrapper,children:[(0,U.jsx)(F().b,{connectorType:n,title:"completed"===f?(0,U.jsx)(M().sA,{id:"aiConnectors.settingsModalTitle",defaultMessage:"{displayName} is connected to Notion AI",values:{displayName:v}}):(0,U.jsx)(M().sA,{id:"aiConnectors.settingsModalTitleNotCompleted",defaultMessage:"{displayName} is connecting to Notion AI",values:{displayName:v}}),subtext:(0,ne().q1)(n)&&g?(0,U.jsx)(M().sA,{id:"aiConnectors.settingsModalSubtext",defaultMessage:"Disconnect {connectorName} to connect your {workspaceConnectorParentName}",values:{connectorName:K().w0[n],workspaceConnectorParentName:(0,K().G6)((0,K().uV)(n))}}):void 0}),y?(0,U.jsx)(W().Ye,{style:C.spinner,children:(0,U.jsx)(We().k,{})}):(0,U.jsxs)(U.Fragment,{children:[l?(0,U.jsx)(W().Ye,{style:C.settingsWrapper,children:l({setIsLoading:_,setIsDisconnectButtonEnabled:j})}):void 0,(0,U.jsx)(W().wt,{style:C.footer,children:x?(0,U.jsx)(Ee,{connector:n,styles:C.disconnectButton,isDisconnectButtonEnabled:x,nextScreens:s}):(0,U.jsx)(Fe().A,{allowHover:!0,textWrap:!0,renderTooltip:()=>(0,U.jsx)("div",{style:{width:240},children:(0,U.jsx)(M().sA,{id:"aiConnector.disconnectDisabled.tooltip",defaultMessage:"You can cancel or modify {displayName} when the connection is complete. ",values:{displayName:v}})}),render:e=>(0,U.jsx)(Ee,{connector:n,events:e,styles:C.disconnectButton,isDisconnectButtonEnabled:x,nextScreens:s})})}),c?(0,U.jsx)(W().Ye,{style:C.learnMoreSection,children:(0,U.jsx)(w().Ay,{style:C.learnMoreButton,onClick:()=>{(0,b().u)({environment:k,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_learn_more_url_click",integration_type:n,setup_session_id:m,from:p}}}),window.open(c,"_blank")},children:(0,U.jsxs)(W().Ye,{style:C.learnMoreText,children:[(0,U.jsx)(M().sA,{id:"aiConnectors.integration.learnMore",defaultMessage:"Learn more"}),(0,U.jsx)(De().I,{icon:Pe().arrowUpRightSquareSmallIcon,size:"sm"})]})})}):void 0]})]})})}function Ee(e){const{connector:n,styles:t,events:o,isDisconnectButtonEnabled:s,nextScreens:i}=e,c=(0,r().v3)(),u=(0,a().O$)(d().NT[n]),{sessionId:p,analyticsFrom:m}=u,h=(0,g().r)(),v=(0,a().K8)((()=>(0,S().XY)(n)),[n]);return(0,U.jsx)(Be().E,{...o,style:t,disabled:!s,onClick:async()=>{if(h)if((0,b().u)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_disconnect_button",integration_type:n,setup_session_id:p,from:m}}}),"completed"!==v){if("not_started"===v){const e=await(0,l().disconnectConnector)({connector:n,spaceId:h,environment:c,disconnectReason:"admin_disconnect"});if(await(0,d().getAiConnectorRefreshFunction)(n)({environment:c,spaceId:h}),"success"===e.type)return void d().NT[n].setState({...u,currentScreen:"none"})}d().NT[n].setState({...u,currentScreen:i.error})}else d().NT[n].setState({...u,currentScreen:i.disconnect})},children:(0,U.jsx)(M().sA,{id:"aiConnectors.settingsModal.disconnect",defaultMessage:"Disconnect"})})}function ze(){return(0,U.jsx)(Ue,{connector:"asana",screenName:"settings",nextScreens:{disconnect:"disconnect",error:"error"},settings:void 0})}var Le=()=>t(953911),Ke=()=>t(46986),He=()=>t(571851);const Re={github:{analyticsFrom:"github_ai_connector_already_connected",primedTextInput:"Find a GitHub PR/Issue/Code file about: ",contentType:"repositories"},slack:{analyticsFrom:"slack_already_connected",primedTextInput:"Search for messages in Slack: ",contentType:"conversations"},"microsoft-teams":{analyticsFrom:"microsoft_teams_ai_connector_already_connected",primedTextInput:"Search for messages in Microsoft Teams",contentType:"messages"},"google-drive":{analyticsFrom:"google_drive_already_connected",primedTextInput:"Find a Google Drive file about: ",contentType:"content"},jira:{analyticsFrom:"jira_already_connected",primedTextInput:"Find a Jira issue about: ",contentType:"issues"},gmail:{analyticsFrom:"gmail_already_connected",primedTextInput:"Find a Gmail email about: ",contentType:"email"},"google-calendar":{analyticsFrom:"google-calendar_already_connected",primedTextInput:"Find a Google Calendar event about: ",contentType:"events"},"notion-calendar":{analyticsFrom:"notion-calendar_already_connected",primedTextInput:"Find a Notion Calendar event about: ",contentType:"events"},salesforce:{analyticsFrom:"salesforce_already_connected",primedTextInput:"Find a Salesforce object about: ",contentType:"objects"},discord:{analyticsFrom:"discord_already_connected",primedTextInput:"Search for messages in Discord: ",contentType:"messages"},"notion-mail":{analyticsFrom:"notion-mail_already_connected",primedTextInput:"Find a Notion Mail email about: ",contentType:"emails"},sharepoint:{analyticsFrom:"sharepoint_already_connected",primedTextInput:"Search for documents in SharePoint",contentType:"content"},linear:{analyticsFrom:"linear_already_connected",primedTextInput:"Search for issues in Linear",contentType:"issues"},outlook:{analyticsFrom:"outlook_already_connected",primedTextInput:"Search for emails in Outlook",contentType:"emails"},asana:{analyticsFrom:"asana_already_connected",primedTextInput:"Search for tasks in Asana",contentType:"tasks"},box:{analyticsFrom:"box_already_connected",primedTextInput:"Search for documents in Box",contentType:"content"}},Ge=(0,M().YK)({alreadyConnected:{id:"universalQna.connector.alreadyConnected.title",defaultMessage:"{connector} is already connected to Notion AI"},tryIt:{id:"universalQna.connector.alreadyConnected.subtitle",defaultMessage:"You’re fully set up. Try asking AI about your {connector} {contentType}!"},tryAskingAQuestion:{id:"universalQna.connector.alreadyConnected.tryAskingAQuestionButton",defaultMessage:"Try asking a question"}});function qe({open:e,onDismiss:n,connector:t}){const s=(0,r().v3)(),i=(0,M().tz)(),a=Re[t],c=(0,I().IS)((e=>({container:{padding:16,maxWidth:400},tryItButton:{marginTop:16}})),[]),l=(0,Ke().i7)(),d=(0,o.useCallback)((()=>{n(),l&&He().agentActions.openNewAgentSidebarFromMainBlock({environment:s,primeTextInput:a.primedTextInput})}),[s,n,a,l]),u=i.formatMessage(Ge.alreadyConnected,{connector:K().w0[t]});return(0,U.jsx)(D().a,{showCloseIcon:!0,onDismiss:n,open:e,ariaLabel:u,render:()=>(0,U.jsxs)(W().wt,{style:c.container,children:[(0,U.jsx)(F().b,{titleSubtitleGap:!0,fullWidthTitle:!0,subtext:(0,U.jsx)(M().sA,{...Ge.tryIt,values:{connector:K().w0[t],contentType:a.contentType}}),connectorType:t,title:(0,U.jsx)(M().sA,{...Ge.alreadyConnected,values:{connector:K().w0[t]}})}),(0,U.jsx)(R().A,{colorPalette:"blue",size:"lg",style:c.tryItButton,onClick:d,children:(0,U.jsx)(M().sA,{...Ge.tryAskingAQuestion})})]})})}const Oe={"google-drive":"Google Workspace Super Admin","google-calendar":"Google Workspace Super Admin",gmail:"Google Workspace Super Admin"};function Ye(e){return Oe[e]??""}function Je(e){const{connector:n,learnMoreUrl:t,screenName:o}=e,s=(0,M().tz)(),i=(0,a().O$)(d().NT[n]),{currentScreen:r}=i,c=(0,I().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{fontSize:14,fontWeight:T().Wy.semibold,width:"100%"},iconWrapper:{width:16,height:16}})),[]);return(0,U.jsx)(D().a,{showCloseIcon:!0,ariaLabel:s.formatMessage({defaultMessage:"Ai Connector Not External Admin",id:"aiConnectorOnboarding.notExternalAdmin.ariaLabel"}),onDismiss:()=>d().NT[n].setState({...i,currentScreen:"none"}),open:r===o,render:()=>(0,U.jsxs)("div",{style:c.wrapper,children:[(0,U.jsx)(F().b,{connectorType:n,title:(0,U.jsx)(M().sA,{id:"universalSearch.notAdmin.title",defaultMessage:"Only a {externalAdminName} can connect",values:{externalAdminName:Ye(n)}}),subtext:(0,U.jsx)(M().sA,{id:"universalSearch.notAdmin.description",defaultMessage:"We can’t verify that this account is a {externalAdminName}. Please contact your admin to link Notion using their account.",values:{externalAdminName:Ye(n)}})}),(0,U.jsx)(W().wt,{style:c.footer,children:(0,U.jsxs)(R().A,{colorPalette:"blue",style:c.connectButton,onClick:()=>{window.open(t,"_blank")},children:[(0,U.jsx)(M().sA,{id:"universalSearch.notAdmin.learnMore",defaultMessage:"Learn more"}),(0,U.jsx)("div",{style:c.iconWrapper,children:(0,k().X)()})]})})]})})}function Qe(){const e=(0,a().K8)((()=>i().default.getConfigKey("box_ingestion","learnMoreUrl")),[]);return(0,U.jsx)(Te,{connector:"box",screenName:"introduction",nextScreens:{notStarted:"connecting",inProgress:"none",alreadyConnected:"already_connected",error:"none"},usesPopup:!0,learnMoreUrl:e})}function $e(){const e=(0,r().v3)(),n=(0,g().r)(),t=(0,a().K8)((()=>i().default.getConfigKey("box_ingestion","learnMoreUrl")),[]);if(!n)return null;const o=(0,M().YK)({"boxAiConnector.authModal.captionForFollowBoxInstructions":{id:"boxAiConnector.authModal.captionForFollowBoxInstructions",defaultMessage:"Follow Box’s instructions to connect. Return to this window, and click “Confirm connection” below."}});return(0,U.jsx)(O,{connector:"box",screenName:"connecting",nextScreens:{notAdminOfConnectorAccount:"not_admin_screen",connectionConflict:"none",connectionSuccess:"connection_complete_screen",error:"error"},learnMoreUrl:t,troubleShootingUrl:t,setConnectionStateAsConnected:()=>{Le().M.setState({...Le().M.state,status:"in_progress",ingestionProgress:1,isConnected:!1})},callConnectionApi:async()=>(await(0,l().updateBoxAIConnectorStatus)({environment:e,spaceId:n}),Le().M.state.ingestionProgress?(Le().M.setState({...Le().M.state,currentScreen:"connection_complete_screen"}),{type:"success",data:{connectionSuccess:!0}}):{type:"success",data:{connectionSuccess:!1,errorResponse:{status:401}}}),connectorSpecificSetupNote:o["boxAiConnector.authModal.captionForFollowBoxInstructions"]})}function Ve(){const e=(0,a().K8)((()=>Le().M.state.currentScreen),[]);return(0,U.jsx)(qe,{connector:"box",open:"already_connected"===e,onDismiss:()=>{Le().M.reset()}})}function Xe(){const e=(0,a().K8)((()=>i().default.getConfigKey("box_ingestion","learnMoreUrl")),[]);return(0,U.jsx)(Je,{connector:"box",screenName:"not_admin_screen",learnMoreUrl:e})}function Ze(){return(0,U.jsx)(Z,{connector:"box",screenName:"connection_complete_screen",nextScreens:{notStarted:"none",inProgress:"none",alreadyConnected:"already_connected",error:"none"},ingestionNotNeeded:!1,onStartIngestion:async()=>(J().D6({label:(0,U.jsx)(M().sA,{id:"boxAiConnector.connectionStarted.acknowledge",defaultMessage:"Started syncing from Box. This can take up to 36 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(w().Ay,{onClick:J().N2,children:(0,U.jsx)(M().sA,{id:"boxAiConnector.connectionStarted.startedMessageDismiss",defaultMessage:"Close"})})}),Promise.resolve({status:"success"})),noSelectionAllowed:!0})}function en(){return(0,U.jsx)(Ue,{connector:"box",screenName:"settings",nextScreens:{disconnect:"disconnect",error:"error"},settings:void 0})}function nn(){return(0,U.jsx)(se,{connector:"box",postDisconnectScreenName:"post_disconnect_screen",disconnectScreenName:"disconnect",settingsScreenName:"settings",errorScreenName:"error",setStatusAsDisconnected:()=>{Le().M.setState({...Le().M.getInitialState(),status:"disconnecting",currentScreen:"post_disconnect_screen",isConnected:!1,isLoaded:!0})},showGoogleWorkspaceNote:!1})}var tn=()=>t(991249);const on={...ye().gp,...be,...(0,M().YK)({subtitleForAnnouncement:{defaultMessage:"Upgrade your plan to use AI Connectors.",id:"NotionAIConnectorUpsellIntroModal.subtitleForAnnouncement"}})};function sn(){const e=(0,r().v3)(),n=(0,de().J)(),t=(0,g().r)(),s=e.currentUser.id,i=(0,_()._X)({name:"ai_connectors",spaceId:t,userId:s}),c=(0,M().tz)(),l=(0,a().O$)(Se().O),d=l.open&&"ai_plan_upsell_admin_intro"===l.modal,u=(0,o.useCallback)((({source:n,upsell:t})=>{Se().O.setState({open:!1}),"closeButton"!==n&&t&&l.open&&"ai_plan_upsell_admin_intro"===l.modal&&(tn().K(e,{from:"ai_connector_ai_upsell_intro_modal",upsell:t}),"generic"!==l.connector&&x().A.setState({...x().A.state,connectorTriggeringUpsell:l.connector,upsellTriggeredAt:Date.now()}))}),[e,l]);if(!d||!i)return null;const p=l.connector;return(0,U.jsx)(D().a,{ariaLabel:c.formatMessage(ye().vK.title),open:d,render:()=>(0,U.jsx)(je().Y,{messages:on,aiConnectorsFeatureAvailability:i,onDismiss:u,calloutKey:void 0,eventName:"ai_connector_ai_plan_upsell_intro_modal_opened",learnMoreHref:(0,B().x)("guides.aiConnectors"),connector:p,showNarrowCta:n})})}var rn=()=>t(534177),an=()=>t(917791);function cn(e){const n=(0,M().tz)(),{open:t,onDismiss:o,onConfirm:s,ariaLabel:i,title:r,subtitle:a,buttonLabel:c,connectorType:l}=e,d=(0,I().IS)((e=>({wrapper:{width:400,paddingTop:0,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20},button:{marginTop:20,width:"100%"}})),[]);return(0,U.jsx)(D().a,{ariaLabel:n.formatMessage(i),showCloseIcon:!0,onDismiss:o,open:t,render:()=>(0,U.jsxs)("div",{style:d.wrapper,children:[(0,U.jsx)(F().b,{connectorType:l,title:r,subtext:a}),(0,U.jsx)(R().A,{colorPalette:"blue",size:"xl",style:d.button,onClick:s,children:c})]})})}const ln=(0,M().YK)({title:{id:"universalSearch.authNeededModal.authNeededModalTitle",defaultMessage:"Authentication needed"},subtitle:{id:"universalSearch.authNeededModal.authNeededModalSubtitle",defaultMessage:"We couldn’t verify your {appName} e-mail. To get {appName} answers and results, please authenticate."},buttonLabel:{id:"universalSearch.authNeededModal.authNeededModalButtonLabel",defaultMessage:"Connect your account"}});function dn(){const{open:e,connector:n}=(0,a().K8)((()=>({open:Se().O.state.open&&"auth_needed"===Se().O.state.modal,connector:Se().O.state.open&&"auth_needed"===Se().O.state.modal?Se().O.state.connector:"slack"})),[]),t=(0,r().v3)(),o=(0,g().r)(),s=(0,M().tz)();return(0,U.jsx)(cn,{ariaLabel:ln.title,title:s.formatMessage(ln.title,{appName:K().w0[n]}),subtitle:s.formatMessage(ln.subtitle,{appName:K().w0[n]}),buttonLabel:s.formatMessage(ln.buttonLabel),connectorType:n,onDismiss:()=>{Se().O.setState({open:!1})},onConfirm:()=>(async e=>{o&&("github"===e||"linear"===e||"salesforce"===e||"asana"===e?await(0,an().t)({connector:e,environment:t,spaceId:o,analyticsProperties:{buttonName:"user_auth_connect",analyticsFrom:"ai_chat_scoped_search_menu"},onAuthSuccess:()=>{Se().O.setState({open:!1})}}):"slack"===e?((0,an().t)({connector:e,environment:t,spaceId:o,analyticsProperties:{buttonName:"user_auth_connect",analyticsFrom:"ai_chat_scoped_search_menu"}}),Se().O.setState({open:!1})):"discord"===e?(0,an().t)({connector:e,environment:t,spaceId:o,analyticsProperties:{buttonName:"user_auth_connect",analyticsFrom:"ai_chat_scoped_search_menu"}}):(0,rn().HB)(e))})(n),open:e})}function un(){const{open:e,connector:n}=(0,a().K8)((()=>({open:Se().O.state.open&&"progress"===Se().O.state.modal,connector:Se().O.state.open&&"progress"===Se().O.state.modal?Se().O.state.connector:"slack"})),[]),t=K().w0[n],o=()=>{Se().O.setState({open:!1})};return(0,U.jsx)(ke,{onConnect:o,onDismiss:o,title:(0,U.jsx)(M().sA,{id:"universalSearchProgressModal.generalizedTitle",defaultMessage:"{connector} is connecting to Notion AI",values:{connector:t}}),connectorType:n,subtitle:(0,U.jsx)(M().sA,{id:"universalSearchProgressModal.subtitle",defaultMessage:"This can take up to 36hr.{br}You’ll be able to get answers soon.",values:{br:(0,U.jsx)("br",{})}}),overridePrimaryMessage:(0,U.jsx)(M().sA,{id:"universalSearchProgressModal.ctaMessage",defaultMessage:"Got it"}),centerNotes:!0,noteStyleOverrides:{fontSize:"14px"},open:e})}var gn=()=>t(19575);const pn={...ye().gp,...(0,M().YK)({title:{defaultMessage:"Find anything across all of your apps with Notion AI",id:"NotionAIConnectorSalesAssistedRequestModal.title"},subtitleForAnnouncement:{defaultMessage:"Get search results, AI answers, summaries and more without leaving Notion.",id:"NotionAIConnectorSalesAssistedRequestModal.subtitleForAnnouncement"},notifyWorkspaceOwner:{defaultMessage:"Notify your sales representative for access",id:"NotionAIConnectorSalesAssistedRequestModal.notifyWorkspaceOwners"}})};function mn(){const e=(0,r().v3)(),n=(0,g().r)(),t=e.currentUser.id,s=(0,_()._X)({name:"ai_connectors",spaceId:n,userId:t}),i=(0,M().tz)(),c=(0,a().O$)(Se().O),l=c.open&&"sales_assisted_admin_request"===c.modal,d=(0,o.useCallback)((({source:e})=>{Se().O.setState({open:!1}),"closeButton"!==e&&c.open&&"sales_assisted_admin_request"===c.modal&&(0,gn().cz)()}),[c]);if(!l||!s)return null;const u=c.connector;return(0,U.jsx)(D().a,{ariaLabel:i.formatMessage(ye().vK.title),open:l,render:()=>(0,U.jsx)(je().Y,{messages:pn,aiConnectorsFeatureAvailability:s,onDismiss:d,calloutKey:void 0,eventName:"ai_connector_sales_assisted_intro_modal_opened",learnMoreHref:void 0,connector:u,showNarrowCta:!1,isSalesAssisted:!0})})}t(898992),t(737550);var hn=()=>t(559506),vn=()=>t(822460),fn=()=>t(262246);const yn=(0,M().YK)({popupTitle:{id:"discord.auth.popup.title",defaultMessage:"Discord Authorization"}});function _n(){const e=(0,o.useMemo)((()=>ve("discord")),[]),n=(0,o.useMemo)((()=>fe("discord")),[]),t=(0,r().v3)(),[s,i]=(0,o.useState)("CLOSED"),u=(0,g().r)(),p=(0,a().O$)(fn().l),m=(0,a().K8)((()=>fn().l.state.sessionId),[]),h=(0,a().K8)((()=>fn().l.state.analyticsFrom),[]),v=(0,de().J)(),f=(0,_().P9)({name:"ai_connectors",spaceId:u,userId:t.currentUser.id}),{learnMoreUrl:y}=(0,d().hP)("discord"),S=(0,o.useCallback)((()=>{t.device.isElectron?vn().P(y):window.open(y,"_blank")}),[t,y]),x=(0,o.useCallback)((async()=>{if(!u||"introduction"!==p.currentScreen)return null;const e=await hn().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:t,data:{connector:"discord",authorizationType:"workspace",spaceId:u,client:t.device.isElectron?"desktop":"web",sessionId:fn().l.state.sessionId}});if("success"!==e.type)return null;const n=e.data.authorizationUrl;t.device.isElectron?vn().P(n):ce().P(t,{width:800,height:600,url:n,titleMessage:yn.popupTitle})}),[u,t,p.currentScreen]),[j]=(0,c().Yb)((async()=>{if(!u||"introduction"!==p.currentScreen)return;const e=await hn().callApi({eventName:"listAIConnectors",environment:t,data:{spaceId:u}});return"success"===e.type?{isDiscordConnected:e.data.connectedConnectors.map((e=>e.id)).some((e=>"discord"===e))}:void 0}),[t,p.currentScreen,u]);(0,o.useEffect)((()=>{"introduction"===p.currentScreen?"resolved"===j.status?i("OPEN"):i("LOADING"):i("CLOSED")}),[j.status,p.currentScreen]);const b=(0,o.useCallback)((()=>{(0,l().resetAiConnectorStatus)("discord")}),[]),C=(0,o.useCallback)((async()=>{u&&((0,l().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:t,connector:"discord",moment:"started"}),await x(),(0,l().navigateToDiscordUniversalScreen)("check_connection_screen"))}),[t,u,x]);return u&&f?p.isConnected?null:v?(0,U.jsx)(ke,{onConnect:C,onDismiss:b,onLearnMore:S,title:e,connectorType:"discord",notes:n,open:"OPEN"===s}):(0,U.jsx)(Ie,{connector:"discord",analyticsFrom:h,setupSessionId:m,handleClose:()=>(0,l().resetAiConnectorStatus)("discord"),open:"OPEN"===s,messages:ye().FH}):null}function Sn(){return(0,U.jsx)(_n,{})}function xn(){const e=(0,r().v3)(),n=(0,g().r)(),{learnMoreUrl:t,troubleShootingUrl:o}=(0,d().hP)("discord");return n?(0,U.jsx)(O,{connector:"discord",screenName:"check_connection_screen",nextScreens:{notAdminOfConnectorAccount:"error_screen",connectionConflict:"error_screen",connectionSuccess:"settings",error:"error_screen"},learnMoreUrl:t,troubleShootingUrl:o,setConnectionStateAsConnected:()=>{fn().l.setState({...fn().l.state,connectionStatus:"completed",syncProgressPercentage:100,isConnected:!0,isLoaded:!0})},callConnectionApi:async()=>(await(0,l().updateDiscordAIConnectorStatus)({environment:e,spaceId:n}),{type:"success",data:{connectionSuccess:!0}})}):null}function jn(){return(0,U.jsx)(Z,{connector:"discord",screenName:"connection_complete_screen",nextScreens:{notStarted:"check_connection_screen",inProgress:"settings",alreadyConnected:"already_connected_screen",error:"error_screen"},ingestionNotNeeded:!0,onStartIngestion:void 0})}function bn(){return(0,U.jsx)(Ue,{connector:"discord",screenName:"settings",nextScreens:{disconnect:"disconnect_screen",error:"error_screen"},settings:void 0})}function Cn(){return(0,U.jsx)(se,{connector:"discord",postDisconnectScreenName:"post_disconnect_screen",disconnectScreenName:"disconnect_screen",settingsScreenName:"settings",errorScreenName:"error_screen",setStatusAsDisconnected:()=>{fn().l.setState({...fn().l.state,connectionStatus:"not_started",isConnected:!1,isLoaded:!0,syncProgressPercentage:0})},showGoogleWorkspaceNote:!1})}function In(){return(0,U.jsx)(re,{connector:"discord",screenName:"error_screen"})}function wn(e){const{open:n}=e;return(0,U.jsx)(qe,{open:n,onDismiss:()=>{p().o.reset()},connector:"github"})}const kn=(0,M().YK)({githubAIConnectorOauthPopupTitle:{defaultMessage:"Connect GitHub AI Connector",id:"githubAIConnector.oauthPopupTitle"}});function An(){const e=(0,o.useMemo)((()=>ve("github")),[]),n=(0,o.useMemo)((()=>fe("github")),[]),t=(0,r().v3)(),[s,d]=(0,o.useState)("CLOSED"),u=(0,g().r)(),m=(0,a().O$)(p().o),h=(0,a().K8)((()=>p().o.state.sessionId),[]),v=(0,a().K8)((()=>p().o.state.analyticsFrom),[]),f=(0,I().IS)((()=>({loadingWrapper:{padding:20,fontSize:12,fontWeight:T().Wy.regular,justifyContent:"center",gap:8,alignItems:"center"}})),[]),y=(0,de().J)(),S=(0,_().P9)({name:"ai_connectors",spaceId:u,userId:t.currentUser.id}),x=(0,o.useCallback)((()=>{const e=(0,B().x)("guides.aiConnectorGithub");(0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_intro_modal",integration_type:"github",setup_session_id:p().o.state.sessionId,from:p().o.state.analyticsFrom}}}),t.device.isElectron?(0,C().P)(e):window.open(e,"_blank")}),[t]),j=(0,o.useCallback)((async()=>{if(!u)return;const e=await hn().callApi({eventName:"getGithubOrgAuthUrl",environment:t,data:{spaceId:u,isDesktop:t.device.isElectron,sessionId:p().o.state.sessionId}});if("success"!==e.type)return;(0,l().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:t,connector:"github",moment:"started"});const n=e.data.url;t.device.isElectron?(0,C().P)(n):ce().P(t,{width:800,height:600,url:n,titleMessage:kn.githubAIConnectorOauthPopupTitle}),p().o.setState({...p().o.state,authUrl:n,currentScreen:"connecting"})}),[u,t]),[w]=(0,c().Yb)((async()=>{if(u&&"introduction"===m.currentScreen){if(m.githubOrg)return{isGithubConnected:!0};if(i().default.checkGate({gateName:"ai_connector_unification_github"})){if("success"===(await(0,l().updateGithubAIConnectorStatus)({environment:t,spaceId:u})).status)return{isGithubConnected:p().o.state.isConnected}}else{const e=await hn().callApi({eventName:"getGithubAIConnectorStatus",environment:t,data:{spaceId:u}});if("success"===e.type)return{isGithubConnected:e.data.isConnected}}}}),[t,m.currentScreen,m.githubOrg,u]);(0,o.useEffect)((()=>{"introduction"===m.currentScreen?"resolved"===w.status?d("OPEN"):d("LOADING"):d("CLOSED")}),[w.status,m.currentScreen]);const k=(0,o.useRef)(!1),A=(0,o.useCallback)((()=>{p().o.reset(),(0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_github_intro_modal",integration_type:"github",setup_session_id:p().o.state.sessionId,from:p().o.state.analyticsFrom}}}),k.current=!1}),[t]),N=(0,o.useCallback)((async()=>{await j(),(0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"github_ai_connector_auth_url_open",integration_type:"github",setup_session_id:p().o.state.sessionId,from:p().o.state.analyticsFrom}}}),p().o.setState({...p().o.state,currentScreen:"connecting"})}),[t,j]);return(0,o.useEffect)((()=>{u&&y&&"resolved"===w.status&&"introduction"===m.currentScreen&&(k.current||((0,b().u)({environment:t,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"github",setup_session_id:m.sessionId,from:m.analyticsFrom,is_space_admin:y,is_ai_eligible:S??!1}}}),k.current=!0))}),[u,t,w.status,m.sessionId,m.analyticsFrom,y,S,m.currentScreen]),u&&"CLOSED"!==s?t.device.isMobile?(0,U.jsx)(_e,{connectorType:"github",open:"introduction"===m.currentScreen,onClosed:()=>{p().o.reset()},learnMoreUrl:(0,B().x)("guides.aiConnectorGithub")}):"LOADING"===s?(0,U.jsx)(D().a,{open:"LOADING"===s,render:()=>(0,U.jsxs)(W().Ye,{style:f.loadingWrapper,children:[(0,U.jsx)(M().sA,{id:"universalQna.github.isFetchingConnection",defaultMessage:"Getting connection status"}),(0,U.jsx)(We().k,{})]})}):m.isConnected?(0,U.jsx)(wn,{open:!0}):y?(0,U.jsx)(ke,{onConnect:N,onDismiss:A,onLearnMore:x,title:e,connectorType:"github",notes:n,open:"OPEN"===s}):(0,U.jsx)(Ie,{connector:"github",analyticsFrom:v,setupSessionId:h,handleClose:()=>(0,l().resetAiConnectorStatus)("github"),open:"OPEN"===s,messages:ye().Sn}):(0,U.jsx)(U.Fragment,{})}var Mn=()=>t(972435);const Tn=function(){const e=(0,a().O$)(p().o),[n,t]=(0,o.useState)(!1),s=(0,r().v3)(),i=(0,g().r)(),c=(0,o.useCallback)((()=>{(0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"close_settings",integration_type:"github",setup_session_id:p().o.state.sessionId,from:p().o.state.analyticsFrom}}}),p().o.setState({...p().o.state,currentScreen:"none"})}),[s]),l=(0,o.useCallback)((()=>{t(!1)}),[]),d=(0,I().IS)((e=>({wrapper:{width:400},channelDetailsContainer:{width:352,fontSize:14,fontWeight:T().Wy.regular,color:e.text.secondary},channelDetailsSubtitle:{textAlign:"center",marginBottom:"16px"},channelDetailsWrapper:{justifyContent:"center",paddingTop:"12px",paddingBottom:"12px"},channelNamesContainer:{gap:2,color:e.text.primary},footer:{justifyContent:"center",alignItems:"center",width:"100%",paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:8},disconnectButton:{fontSize:14,fontWeight:T().Wy.medium,width:"100%"},moreChannelsContainer:{paddingTop:8},learnMoreButton:{fontSize:14,fontWeight:T().Wy.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:T().Wy.medium,fontSize:12,gap:5,justifyContent:"center",alignItems:"center",paddingTop:4,paddingInlineEnd:8,paddingBottom:4,paddingInlineStart:8,color:`${e.text.secondary}`},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:T().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:T().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:T().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:T().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:14,fontWeight:T().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,paddingBottom:40,justifyContent:"center",alignItems:"center"},editChannelsButton:{width:"100%"}})),[]);return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(D().a,{showCloseIcon:!0,onDismiss:l,open:n,render:()=>(0,U.jsx)("div",{style:d.confirmWrapper,children:(0,U.jsxs)("div",{style:d.confirmContainer,children:[(0,U.jsx)("div",{style:d.confirmModalTitle,children:(0,U.jsx)(M().sA,{id:"githubAIConnector.settings.confirmation.title",defaultMessage:"Are you sure?"})}),(0,U.jsx)("div",{style:d.confirmModalSubTitle,children:(0,U.jsx)(M().sA,{id:"githubAIConnector.settings.confirmation.subTitle",defaultMessage:"Your GitHub data will be permanently deleted from Notion."})}),(0,U.jsx)("div",{style:d.confirmModalDescription,children:(0,U.jsx)(M().sA,{id:"githubAIConnector.settings.confirmation.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."})}),(0,U.jsxs)(W().wt,{style:d.confirmModalActionButtons,children:[(0,U.jsx)(R().A,{colorPalette:"red",style:d.confirmDisconnectButton,onClick:async()=>{i&&((0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"account_disconnect_confirmation",integration_type:"github",setup_session_id:p().o.state.sessionId,from:p().o.state.analyticsFrom}}}),await hn().callApi({eventName:"disconnectGithub",environment:s,data:{spaceId:i}}),p().o.reset(),t(!1),J().D6({label:Mn().A.getIntl().formatMessage({defaultMessage:"GitHub disconnected. This can take up to 3 hours.",id:"githubAIConnector.settings.confirmation.disconnected"}),position:"bottom"}))},children:(0,U.jsx)(M().sA,{id:"githubAIConnector.settings.confirmDisconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"})}),(0,U.jsx)(w().Ay,{style:d.goBackButton,onClick:l,children:(0,U.jsx)(M().sA,{id:"githubAIConnector.settings.confirmDisconnectModal.goBack",defaultMessage:"Go back"})})]})]})})}),(0,U.jsx)(D().a,{showCloseIcon:!0,onDismiss:c,open:"settings"===e.currentScreen,render:()=>(0,U.jsxs)("div",{style:d.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"github",title:(0,U.jsx)(M().sA,{id:"githubAIConnector.settings.settingsModalTitle",defaultMessage:"GitHub is connected to Notion AI"}),subtext:(0,U.jsx)(M().sA,{id:"githubAIConnector.settings.canAnswerFrom",defaultMessage:"Notion AI can answer questions about your GitHub repositories."})}),(0,U.jsxs)(W().wt,{style:d.footer,children:[(0,U.jsx)(H().A,{size:"lg",style:d.editChannelsButton,onClick:()=>{var n,t;(0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"open_github_for_edit_selection",integration_type:"github",setup_session_id:p().o.state.sessionId,from:p().o.state.analyticsFrom}}}),window.open(`https://github.com/organizations/${null===(n=e.githubOrg)||void 0===n?void 0:n.name}/settings/installations/${null===(t=e.githubOrg)||void 0===t?void 0:t.installationId}`,"_blank")},children:(0,U.jsx)(M().sA,{id:"githubAIConnector.settings.editRepos",defaultMessage:"Edit Selected Repositories"})}),(0,U.jsx)(Be().E,{style:d.disconnectButton,onClick:()=>{(0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"account_disconnect",integration_type:"github",setup_session_id:p().o.state.sessionId,from:"connection_settings"}}}),t(!0)},children:(0,U.jsx)(M().sA,{id:"githubAIConnector.settings.disconnectGithub",defaultMessage:"Disconnect"})}),(0,U.jsx)(w().Ay,{style:d.learnMoreButton,onClick:()=>{(0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_settings_modal",integration_type:"github",setup_session_id:p().o.state.sessionId,from:"connection_settings"}}});const e=(0,B().x)("guides.aiConnectorGithub");window.open(e,"_blank")},children:(0,U.jsxs)(W().Ye,{style:d.learnMoreText,children:[(0,U.jsx)(M().sA,{id:"githubAIConnector.settings.learnMore",defaultMessage:"Learn more"}),(0,U.jsx)(De().I,{icon:Pe().arrowUpRightSquareSmallIcon,size:"sm"})]})})]})]})})]})},Nn=(0,M().YK)({durationForIngestion:{id:"githubAiConnector.connectionComplete.durationForIngestion",defaultMessage:"This may take up to 72 hours"},githubAIConnectorConnectionCompleteListpoint2:{id:"githubAIConnector.connectionComplete.listpoint2",defaultMessage:"Each member of your workspace will be prompted to authenticate to GitHub."}});const Dn=function(){const e=(0,r().v3)(),n=(0,a().K8)((()=>p().o.state.currentScreen),[]),t=(0,o.useCallback)((n=>{p().o.setState({...p().o.getInitialState(),isPersonalAuthComplete:!1,status:"in_progress",isConnected:!0}),(0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:`github_ai_connector_got_it_${n}_click`,integration_type:"github",setup_session_id:p().o.state.sessionId,from:p().o.state.analyticsFrom}}}),J().D6({label:(0,U.jsx)(M().sA,{id:"aiConnectors.github.acknowledge",defaultMessage:"Started syncing from GitHub. This can take up to 72 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(w().Ay,{onClick:J().N2,children:(0,U.jsx)(M().sA,{id:"aiConnectors.github.startedMessageDismiss",defaultMessage:"Close"})})})}),[e]);return(0,o.useEffect)((()=>{"confirmation"===n&&(0,l().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"github",moment:"finished"})}),[e,n]),(0,U.jsx)(V,{open:"confirmation"===n,connectorType:"github",notes:[(0,U.jsx)(X,{number:1,title:Nn.durationForIngestion},"item1"),(0,U.jsx)(X,{number:2,title:Nn.githubAIConnectorConnectionCompleteListpoint2,description:{...{...$.defaultPermissionsWillBeRespected,values:{appName:"GitHub"}}}},"item2")],onDismiss:()=>t("dismiss"),onPrimaryButtonClick:()=>t("dismiss")})};var Wn=()=>t(771624),Bn=()=>t(8870),Pn=(t(354520),()=>t(584262)),Fn=()=>t(601866);function Un(e){const{connector:n,connectedSpaceId:t,screenName:s,nextScreens:i}=e,c=(0,M().tz)(),l=(0,a().O$)(d().NT[n]),{currentScreen:u,sessionId:g,analyticsFrom:p}=l,m=u===s,v=K().w0[n],f=(0,r().v3)(),y=(0,I().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{fontSize:14,fontWeight:T().Wy.semibold,width:"100%"}})),[]),_=(0,o.useCallback)((async()=>{const e=h().default.state.currentUserRootStore;if(!e)return;(0,b().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"visit_other_workspace",integration_type:n,setup_session_id:g,from:p}}});const o=e.getSpaceViewStores().filter((e=>e.getSpaceId()===t))[0];await Fn().tR({environment:f,navigationType:"switchingToOrLoadingSpace",pageVisitSource:Pn().y8.AIGoogleDriveQna,spaceViewStore:o,userRootStore:h().default.state.currentUserRootStore,userSettingsStore:h().default.state.currentUserSettingsStore}),d().NT[n].setState({...l,currentScreen:i.settings,analyticsFrom:"google_other_workspace",sessionId:g})}),[p,t,f,g,n,l,i]);return(0,U.jsx)(D().a,{ariaLabel:c.formatMessage({defaultMessage:"Ai Connector Connection Conflict Modal",id:"aiConnectorOnboarding.connectionConflictModal.ariaLabel"}),showCloseIcon:!0,onDismiss:()=>d().NT[n].setState({...l,currentScreen:"none"}),open:m,render:()=>(0,U.jsxs)("div",{style:y.wrapper,children:[(0,U.jsx)(F().b,{connectorType:n,title:(0,U.jsx)(M().sA,{id:"universalSearch.connectionExistModal.title",defaultMessage:"You’ve already connected {connectorName} to another Notion workspace.",values:{connectorName:v}}),subtext:(0,U.jsx)(M().sA,{id:"universalSearch.connectionExistModal.description",defaultMessage:"Currently, only one workspace can be connected to {connectorName}. To connect this workspace, please disconnect the existing connection.",values:{connectorName:v}})}),(0,U.jsx)(W().wt,{style:y.footer,children:(0,U.jsx)(R().A,{colorPalette:"blue",style:y.connectButton,onClick:_,children:(0,U.jsx)(M().sA,{id:"universalSearch.connectionExistModal.navigateButton",defaultMessage:"Visit the other workspace"})})})]})})}function En(){const{learnMoreUrl:e,googleAuthUrl:n}=(0,d().hP)("gmail");return(0,U.jsx)(Te,{connector:"gmail",screenName:"introduction",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},usesPopup:!1,learnMoreUrl:e,staticAuthUrl:n})}function zn(){const e=(0,a().K8)((()=>Wn().XS.state.currentScreen),[]);return(0,U.jsx)(qe,{connector:"gmail",open:"already_connected"===e,onDismiss:()=>{Wn().XS.reset()}})}function Ln(){const{learnMoreUrl:e}=(0,d().hP)("gmail");return(0,U.jsx)(Je,{connector:"gmail",screenName:"not_admin_screen",learnMoreUrl:e})}function Kn(){return(0,U.jsx)(Z,{connector:"gmail",screenName:"connection_complete_screen",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},ingestionNotNeeded:!0,onStartIngestion:void 0})}function Hn(){const e=(0,a().K8)((()=>Wn().XS.state.connectionConflictSpaceId),[]);return(0,U.jsx)(Un,{connector:"gmail",screenName:"connection_exist_screen",nextScreens:{settings:"none"},connectedSpaceId:e??""})}function Rn(){const e=(0,r().v3)(),n=(0,g().r)(),{learnMoreUrl:t,googleAuthUrl:o,troubleShootingUrl:s}=(0,d().hP)("gmail");return n?(0,U.jsx)(O,{connector:"gmail",screenName:"authentication",nextScreens:{notAdminOfConnectorAccount:"not_admin_screen",connectionConflict:"connection_exist_screen",connectionSuccess:"connection_complete_screen",error:"error"},learnMoreUrl:t,troubleShootingUrl:s,staticConnectorAuthUrl:o,setConnectionStateAsConnected:()=>{Wn().XS.setState({...Wn().XS.state,status:"authenticated",isConnected:!0,isPersonalAuthComplete:!0}),Bn().L.setState({...Bn().L.state,status:"not_started",isConnected:!1,isPersonalAuthComplete:!1})},setConnectionConflictSpaceId:e=>{Wn().XS.setState({...Wn().XS.state,connectionConflictSpaceId:e})},callConnectionApi:async()=>{const t=await hn().callApi({eventName:"connectAiConnector",environment:e,data:{spaceId:n,connector:"gmail"}});if("success"!==t.type)return Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:400}}});const o=t.data;return o.success?(Wn().XS.setState({...Wn().XS.state,externalSourceName:o.externalSourceName}),Promise.resolve({type:"success",data:{connectionSuccess:!0}})):"3p_connected_to_another_workspace"===o.failureReason?Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:400,errorCode:"GOOGLE_MAPPING_EXIST",data:{spaceId:o.alreadyConnectedSpaceId}}}}):"not_3p_admin"===o.failureReason?Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:403}}}):"not_connected"===o.failureReason?Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:401}}}):void(0,rn().HB)(o.failureReason)}}):null}function Gn(){return(0,U.jsx)(Ue,{connector:"gmail",screenName:"settings",nextScreens:{disconnect:"disconnect_screen",error:"error"},settings:void 0})}function qn(){const{marketplaceAppConfigureUrl:e,marketplaceAppName:n}=(0,d().hP)("gmail");return(0,U.jsx)(se,{connector:"gmail",postDisconnectScreenName:"post_disconnect_screen",disconnectScreenName:"disconnect_screen",settingsScreenName:"settings",errorScreenName:"error",setStatusAsDisconnected:()=>{Wn().XS.setState({...Wn().XS.state,status:"not_started",isConnected:!1,isLoaded:!0})},showGoogleWorkspaceNote:!0,marketplaceAppConfigureUrl:e,marketplaceAppName:n})}function On(){return(0,U.jsx)(re,{connector:"gmail",screenName:"error"})}var Yn=()=>t(575922),Jn=()=>t(702327);function Qn(){const{learnMoreUrl:e,googleAuthUrl:n}=(0,d().hP)("google-calendar");return(0,U.jsx)(Te,{connector:"google-calendar",screenName:"introduction",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},usesPopup:!1,learnMoreUrl:e,staticAuthUrl:n})}function $n(){const e=(0,a().K8)((()=>Yn().W.state.currentScreen),[]);return(0,U.jsx)(qe,{connector:"google-calendar",open:"already_connected"===e,onDismiss:()=>{Yn().W.reset()}})}function Vn(){const{learnMoreUrl:e}=(0,d().hP)("google-calendar");return(0,U.jsx)(Je,{connector:"google-calendar",screenName:"not_admin_screen",learnMoreUrl:e})}function Xn(){return(0,U.jsx)(Z,{connector:"google-calendar",screenName:"connection_complete_screen",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},ingestionNotNeeded:!0,onStartIngestion:void 0})}function Zn(){const e=(0,a().K8)((()=>Yn().W.state.connectionConflictSpaceId),[]);return(0,U.jsx)(Un,{connector:"google-calendar",screenName:"connection_exist_screen",nextScreens:{settings:"none"},connectedSpaceId:e??""})}function et(){const e=(0,r().v3)(),n=(0,g().r)(),{learnMoreUrl:t,googleAuthUrl:o,troubleShootingUrl:s}=(0,d().hP)("google-calendar");return n?(0,U.jsx)(O,{connector:"google-calendar",screenName:"authentication",nextScreens:{notAdminOfConnectorAccount:"not_admin_screen",connectionConflict:"connection_exist_screen",connectionSuccess:"connection_complete_screen",error:"error"},learnMoreUrl:t,troubleShootingUrl:s,staticConnectorAuthUrl:o,setConnectionStateAsConnected:()=>{Yn().W.setState({...Yn().W.state,status:"authenticated",isConnected:!0,isPersonalAuthComplete:!0}),Jn().g.setState({...Jn().g.state,status:"not_started",isConnected:!1,isPersonalAuthComplete:!1})},setConnectionConflictSpaceId:e=>{Yn().W.setState({...Yn().W.state,connectionConflictSpaceId:e})},callConnectionApi:async()=>{const t=await hn().callApi({eventName:"connectAiConnector",environment:e,data:{spaceId:n,connector:"google-calendar"}});if("success"!==t.type)return Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:400}}});const o=t.data;return o.success?(Yn().W.setState({...Yn().W.state,externalSourceName:o.externalSourceName}),Promise.resolve({type:"success",data:{connectionSuccess:!0}})):"3p_connected_to_another_workspace"===o.failureReason?Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:400,errorCode:"GOOGLE_MAPPING_EXIST",data:{spaceId:o.alreadyConnectedSpaceId}}}}):"not_3p_admin"===o.failureReason?Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:403}}}):"not_connected"===o.failureReason?Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:401}}}):void(0,rn().HB)(o.failureReason)}}):null}function nt(){return(0,U.jsx)(Ue,{connector:"google-calendar",screenName:"settings",nextScreens:{disconnect:"disconnect_screen",error:"error"},settings:void 0})}function tt(){const{marketplaceAppConfigureUrl:e,marketplaceAppName:n}=(0,d().hP)("google-calendar");return(0,U.jsx)(se,{connector:"google-calendar",postDisconnectScreenName:"post_disconnect_screen",disconnectScreenName:"disconnect_screen",settingsScreenName:"settings",errorScreenName:"error",setStatusAsDisconnected:()=>{Yn().W.setState({...Yn().W.state,status:"not_started",isConnected:!1,isLoaded:!0})},showGoogleWorkspaceNote:!0,marketplaceAppConfigureUrl:e,marketplaceAppName:n})}function ot(){return(0,U.jsx)(re,{connector:"google-calendar",screenName:"error"})}function st(){const e=(0,a().K8)((()=>f().d.state.currentScreen),[]);return(0,U.jsx)(qe,{open:"already_connected"===e,onDismiss:()=>{f().d.reset()},connector:"google-drive"})}function it(){const[e,n]=o.useState(!1),t=(0,I().IS)((e=>({noteHeading:{fontWeight:T().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:T().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{width:18,height:17,color:"#D7813A",marginTop:2},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingInlineStart:14,fontweight:T().Wy.regular},warningContainer:{marginInlineStart:5,marginInlineEnd:5,marginBottom:15}})),[]),s=(0,r().v3)(),c=(0,g().r)(),d=(0,a().K8)((()=>f().d.state.sessionId),[]),u=(0,a().K8)((()=>f().d.state.currentScreen),[]),p=(0,a().K8)((()=>f().d.state.analyticsFrom),[]),m=(0,a().K8)((()=>i().default.getConfigKey("ingestion","googleDrive").googleAuthUrl),[]),h=(0,a().K8)((()=>i().default.getConfigKey("ingestion","googleDrive").troubleShootingUrl),[]),v=(0,a().K8)((()=>i().default.getConfigKey("ingestion","googleDrive").learnMoreUrl),[]),y=(0,o.useCallback)((async()=>{if(!c)return;var e;await(e=5e3,new Promise((n=>setTimeout(n,e))));const t=await hn().callApi({eventName:"connectGoogleDriveForAIIngestion",environment:s,data:{spaceId:c}}),o=e=>{(0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:e,integration_type:"google-drive",setup_session_id:d,from:p}}})};var i,r,a;"success"===t.type?t.data.connectionSuccess?(o("auth_screen_connected"),f().d.setState({...f().d.state,currentScreen:"connection_complete_screen",availableSyncControlOptions:t.data.syncControlOptions})):((e,t,s)=>{switch(e){case 401:o("auth_screen_not_connected_warning"),n(!0);break;case 403:o("info_screen_connect_not_admin_screen"),(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"not_admin_screen",analyticsFrom:p,sessionId:d});break;case 400:"GOOGLE_MAPPING_EXIST"===t&&s?(o("workspace_already_connected"),f().d.setState({...f().d.state,connectedSpaceId:s}),(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"connection_exist_screen",analyticsFrom:p,sessionId:d})):(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:p,sessionId:d});break;default:(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:p,sessionId:d})}})(null==t||null===(i=t.data)||void 0===i||null===(i=i.errorResponse)||void 0===i?void 0:i.status,null==t||null===(r=t.data)||void 0===r||null===(r=r.errorResponse)||void 0===r?void 0:r.errorCode,null==t||null===(a=t.data)||void 0===a||null===(a=a.errorResponse)||void 0===a||null===(a=a.data)||void 0===a?void 0:a.spaceId):(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:p,sessionId:d})}),[p,s,d,c]),_=(0,o.useCallback)((()=>[(0,U.jsxs)(W().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:t.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.waitingForConnectionNoteHeading1",defaultMessage:"Google should open automatically on a new browser tab."},"note1-1")}),(0,U.jsx)("div",{style:t.noteBody,children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.authWaiting",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,U.jsx)("a",{style:t.link,href:m,target:"_blank",onClick:()=>{(0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_open_auth_url",integration_type:"google-drive",setup_session_id:d,from:p}}})},children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,U.jsxs)(W().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:t.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.workspaceAdminHeading",defaultMessage:"Follow Google’s setup instructions"},"note2-1")}),(0,U.jsx)("div",{style:t.noteBody,children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.workspaceAdminBody",defaultMessage:"For better AI answers, we recommend selecting the option “All users in my organization”. In the next steps, you’ll be able to exclude specific Drives and can always update your selection."},"note2-2")})]},"note-2"),(0,U.jsx)(W().wt,{style:{gap:4},children:(0,U.jsx)("div",{style:t.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.done",defaultMessage:"When you’re done, click the button below"},"note3-1")})},"note-3")]),[t,m,s,d,p]),S=e?(0,U.jsxs)(W().Ye,{style:t.warningContainer,children:[(0,L().Q)(t.icon),(0,U.jsx)("div",{style:t.warningText,children:(0,U.jsx)(M().sA,{id:"universalQnA.googleDrive.AuthScreen.warning",defaultMessage:"We couldn’t connect to Google. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{TroubleshootingGuide:(0,U.jsx)("a",{style:{...t.link,color:"#D7813A"},href:h,target:"_blank",onClick:()=>{(0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"troubleshooting_guide_opened",integration_type:"google-drive",setup_session_id:d,from:p}}})},children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,U.jsx)(q,{title:(0,U.jsx)(M().sA,{id:"universalQnA.googleDrive.AuthScreen",defaultMessage:"Follow instructions from Google in your browser"}),open:"auth_screen"===u,onDismiss:()=>{n(!1),(0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_dismiss",integration_type:"google-drive",setup_session_id:d,from:p}}}),(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:p,sessionId:d})},warningMessage:S,notes:_(),openLearnMoreUrl:()=>{window.open(v)},connectorType:"google-drive",primaryButtonText:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.Button.finishedSetup",defaultMessage:"Confirm connection"},"note3-1"),onClickPrimaryButton:y})}var rt=()=>t(386164),at=(t(672577),t(803949),()=>t(729108)),ct=()=>t(701545),lt=()=>t(802790),dt=()=>t(297872);function ut(e){const{onPrimaryButtonClick:n,setShowConfirmModal:t}=e,s=(0,r().v3)(),i=(0,a().O$)(f().d),c=(0,a().K8)((()=>f().d.state.currentScreen),[]),[l,d]=(0,o.useState)(!1),u=(0,I().IS)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:T().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:T().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:T().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:14,fontWeight:T().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20}})),[]),g=e=>{f().d.setState({...i,currentScreen:e})};return(0,U.jsx)(D().a,{showCloseIcon:!0,open:"select_shared_drives_screen"===c,onDismiss:()=>{(0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_confirm_modal_close",integration_type:"google-drive",setup_session_id:i.sessionId,from:i.analyticsFrom}}}),g("none"),t(!1)},render:()=>(0,U.jsx)("div",{style:u.confirmWrapper,children:(0,U.jsxs)("div",{style:u.confirmContainer,children:[(0,U.jsx)("div",{style:u.confirmModalTitle,children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.confirmModal.title",defaultMessage:"Are you sure?"})}),(0,U.jsx)("div",{style:u.confirmModalSubTitle,children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.confirmModal.subTitle",defaultMessage:"Google Drive content will be disconnected and re-connected. This can take up to 36h and AI answers will be unavailable until it’s complete."})}),(0,U.jsxs)(W().wt,{style:u.confirmModalActionButtons,children:[(0,U.jsx)(R().A,{colorPalette:"blue",isLoading:l,style:u.confirmDisconnectButton,disabled:i.isDisconnecting,onClick:async()=>{(0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_modal_confirm_button",integration_type:"google-drive",setup_session_id:i.sessionId,from:i.analyticsFrom}}}),d(!0),await n(),d(!1),t(!1),g("none")},children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.editModal.confirmDisconnect",defaultMessage:"Confirm"})}),(0,U.jsx)(w().Ay,{style:u.goBackButton,onClick:()=>{(0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_modal_cancel_button",integration_type:"google-drive",setup_session_id:i.sessionId,from:i.analyticsFrom}}}),t(!1)},children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.editModal.cancel",defaultMessage:"Cancel"})})]})]})})})}function gt(e){const{drive:n,styles:t,onToggle:o}=e;return(0,U.jsxs)(W().Ye,{gap:8,style:{alignItems:"center",paddingTop:10,paddingInlineEnd:18,paddingBottom:6,paddingInlineStart:0},children:[(0,U.jsx)(at().S,{checked:n.checked,size:14,onClick:()=>o(n.id)}),(0,U.jsx)("div",{style:t.drivesRow,children:`${n.name}`},`${n.id}#3`)]})}function pt(e){const{styles:n,onPrimaryButtonClick:t,setShowConfirmModal:s,isFutureItemsChecked:i,setDriveCheckboxItems:l,sharedDriveCheckboxItems:d,setFutureItemsChecked:u}=e,p=(0,a().O$)(f().d),m=(0,a().K8)((()=>f().d.state.sessionId),[]),h=(0,a().K8)((()=>f().d.state.initialSyncState),[]),v=(0,a().K8)((()=>f().d.state.analyticsFrom),[]),y=(0,a().K8)((()=>f().d.state.currentScreen),[]),_=(0,g().r)(),[S,x]=(0,o.useState)(!1),j=(0,r().v3)(),C=(0,o.useRef)(!1);if((0,c().Yb)((async()=>{if(!_)return;if("pending_selection"===p.initialSyncState&&!C.current)return x(!0),await(async()=>{if(!_)return;const e=await hn().callApi({eventName:"getSyncControlsForGoogleDriveAIIngestion",environment:j,data:{spaceId:_}});if("success"===(null==e?void 0:e.type)){const n=e.data;f().d.setState({...f().d.state,availableSyncControlOptions:n.options,syncControlSelection:n.selection})}C.current=!0})(),void x(!1);const e=p.availableSyncControlOptions.filter((e=>"shared_drive"===e.type));0===e.length&&"select_shared_drives_screen"===y&&(0,b().u)({environment:j,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"no_shared_drives",integration_type:"google-drive",setup_session_id:m,from:v}}});const n=p.syncControlSelection;if(!n)return l(e.map((e=>({...e,checked:!0})))),void u(!0);l(e.map((e=>({...e,checked:!n.driveIds||n.driveIds.includes(e.id)})))),u(n.enableSyncingFutureUsersAndDrives)}),[v,j,p,y,l,u,m,_]),!_)return null;const I=d.find((e=>e.checked))||i,w=e=>{(0,b().u)({environment:j,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"individual_drive_checkbox",integration_type:"google-drive",setup_session_id:p.sessionId,from:p.analyticsFrom}}}),l(d.map((n=>n.id===e?{...n,checked:!n.checked}:n)))},k=d.map((e=>(0,U.jsx)(gt,{drive:e,styles:n,onToggle:w},e.id))).filter(rn().O9);return(0,U.jsxs)(W().wt,{children:[(0,U.jsx)(W().Ye,{style:n.selectionWrapper,children:(0,U.jsxs)(W().wt,{style:n.scrollContainer,children:[(0,U.jsx)(lt().A,{style:{paddingBottom:4},size:4}),(0,U.jsx)(W().Ye,{style:n.rowTitle,children:(0,U.jsxs)(W().Ye,{children:[(0,U.jsx)(W().wt,{children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.allItemsTitle",defaultMessage:"Content owned by users"})}),(0,U.jsx)(W().wt,{style:{paddingInlineStart:200},children:(0,ct().p)(n.checkMark)})]})}),(0,U.jsx)(W().Ye,{style:n.rowAdditionalText,children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.allItemsSubtext",defaultMessage:"Includes all files owned by users selected in Google Workspace Settings"})}),(0,U.jsx)(lt().A,{style:{paddingTop:10,paddingBottom:10},size:4}),(0,U.jsx)(W().Ye,{style:n.rowTitle,children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.allSharedDrivesTitle",defaultMessage:"Content in Shared Drives"})}),(0,U.jsx)(W().Ye,{style:n.rowAdditionalText,children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.allSharedDrivesSubtext",defaultMessage:"Includes files in Shared Drives as long as they are owned by users selected in the setting above."})}),(0,U.jsx)(W().Ye,{children:(0,U.jsx)(W().wt,{children:0===k.length?(0,U.jsx)(W().Ye,{style:{...n.rowAdditionalText,fontSize:14,paddingTop:10},children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.noSharedDrivesSubtext",defaultMessage:"No Shared Drives found"})}):k})})]})}),(0,U.jsxs)(W().wt,{style:n.footer,children:[(0,U.jsxs)(W().Ye,{style:{gap:4,alignItems:"center",width:"inherit"},children:[(0,U.jsx)(at().S,{checked:i,size:14,onClick:()=>{(0,b().u)({environment:j,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:`future_items_checkbox_${(!i).toString()}`,integration_type:"google-drive",setup_session_id:p.sessionId,from:p.analyticsFrom}}}),u(!i)}}),(0,U.jsx)("div",{style:{fontSize:12,lineHeight:"16px",paddingBottom:2},children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.allSharedDrives",defaultMessage:"Include Drives created in the future"})})]}),(0,U.jsx)(R().A,{colorPalette:"blue",style:n.continueButton,isLoading:S,disabled:!I,onClick:async()=>{x(!0),"completed"!==h?(await t(),x(!1)):s(!0)},children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.confirm",defaultMessage:"Confirm selection"})})]})]})}async function mt(e){const{environment:n,spaceId:t}=e,{analyticsFrom:o,sessionId:s}=f().d.state;return"success"===(await hn().callApi({eventName:"startGoogleDriveSyncForAIIngestion",environment:n,data:{spaceId:t,setupSessionId:s}})).type?(f().d.setState({...f().d.state,initialSyncState:"in_progress",ingestionProgress:1}),(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:o,sessionId:s}),!0):((0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:o,sessionId:s}),!1)}const ht=function(){const[e,n]=(0,o.useState)(!1),t=(0,a().K8)((()=>f().d.state.currentScreen),[]),s=(0,r().v3)(),i=(0,g().r)(),c=(0,a().O$)(f().d),d=(0,I().IS)((e=>({wrapper:{width:400},scrollContainer:{overflow:"scroll",paddingInlineEnd:20,height:350},rowTitle:{fontSize:12,lineHeight:"16px",fontWeight:510,paddingBottom:4},rowAdditionalText:{fontSize:12,lineHeight:"16px",color:e.text.secondary},drivesRow:{fontSize:14,lineHeight:"18px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},footer:{justifyContent:"center",alignItems:"center",bottom:0,width:"100%",height:75,boxShadow:e.shadowMD,paddingTop:16,paddingInlineEnd:20,paddingBottom:16,paddingInlineStart:20,gap:6},continueButton:{fontSize:14,fontWeight:T().Wy.semibold,width:360},selectionWrapper:{marginTop:24,paddingInlineStart:20,justifyContent:"center",overflow:"auto"},selection:{width:360,height:263,marginBotton:12},checkMark:{width:14,color:e.text.secondary}})),[]),u=(0,a().K8)((()=>f().d.state.sessionId),[]),p=(0,a().K8)((()=>f().d.state.analyticsFrom),[]),[m,h]=(0,o.useState)(!0),[v,y]=(0,o.useState)([]),_=()=>{f().d.setState({...f().d.state,syncControlSelection:{driveIds:[],enableSyncingFutureUsersAndDrives:!1},availableSyncControlOptions:[]})},S=(0,o.useCallback)((async()=>{let e=!0;m&&(e=!1);const n=[];if(v.forEach((t=>{if(t.checked===e){const{checked:e,...o}=t;n.push({...o})}})),(0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drive_and_user_selector_primary_button",integration_type:"google-drive",setup_session_id:c.sessionId,from:c.analyticsFrom}}}),!i)return;const t=n,o=await hn().callApi({eventName:"patchSyncControlsForGoogleDriveAIIngestion",environment:s,data:{spaceId:i,exclusionList:m?t:[],inclusionList:m?[]:t}}),r="in_progress"===f().d.state.initialSyncState||"completed"===f().d.state.initialSyncState;if("failed"===o.type)return void J().D6({label:(0,U.jsx)(M().sA,{id:"googleIngestionConfirmation.ingestion.failed",defaultMessage:"Cannot edit Google shared drives now. Please try again later."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(w().Ay,{onClick:J().N2,children:(0,U.jsx)(M().sA,{id:"googleIngestionConfirmation.ingestion.failedMessageDismiss",defaultMessage:"Close"})})});const a="success"===o.type&&o.data.syncControlsUpdated||!r&&"success"===o.type&&!o.data.syncControlsUpdated,d=r&&"success"===o.type&&!o.data.syncControlsUpdated;if(a){const e=await mt({environment:s,spaceId:i});_(),e&&J().D6({label:(0,U.jsx)(M().sA,{id:"googleIngestionConfirmation.ingestion.acknowledge",defaultMessage:"Started syncing from Google drive. This can take up to 36 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(w().Ay,{onClick:J().N2,children:(0,U.jsx)(M().sA,{id:"googleIngestionConfirmation.ingestion.startedMessageDismiss",defaultMessage:"Close"})})})}else d?(J().D6({label:(0,U.jsx)(M().sA,{id:"googleIngestionConfirmation.ingestion.skip",defaultMessage:"No change made to Google Drive Connection."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(w().Ay,{onClick:J().N2,children:(0,U.jsx)(M().sA,{id:"googleIngestionConfirmation.ingestion.noConfigChangeDismiss",defaultMessage:"Close"})})}),_(),f().d.setState({...f().d.state,initialSyncState:"completed"}),(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:p,sessionId:u})):(_(),(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:p,sessionId:u}))}),[p,s,c,m,u,v,i]);return e?(0,U.jsx)(ut,{onPrimaryButtonClick:S,setShowConfirmModal:n}):(0,U.jsx)(D().a,{showCloseIcon:!0,onDismiss:()=>{(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",sessionId:u,analyticsFrom:p})},open:"select_shared_drives_screen"===t,render:()=>(0,U.jsxs)("div",{style:d.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"google-drive",title:(0,U.jsx)(M().sA,{defaultMessage:"Select Drives to Connect",id:"googleAiConnector.universalQnaSharedDriveSelectorPopup.selectDrivesToConnect"})}),(0,U.jsx)(dt().A,{capture:!0,allowEsc:!0,render:()=>(0,U.jsx)(pt,{styles:d,onPrimaryButtonClick:S,setShowConfirmModal:n,isFutureItemsChecked:m,setFutureItemsChecked:h,sharedDriveCheckboxItems:v,setDriveCheckboxItems:y})})]})})},vt=K().w0["google-drive"];function ft(){const e=(0,r().v3)(),n=(0,a().K8)((()=>f().d.state.sessionId),[]),t=(0,g().r)(),s=(0,a().K8)((()=>f().d.state.initialSyncState),[]),c=(0,a().K8)((()=>f().d.state.currentScreen),[]),d=(0,a().K8)((()=>f().d.state.analyticsFrom),[]),u=(0,o.useCallback)((()=>{(0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_dismiss",integration_type:"google-drive",setup_session_id:n,from:d}}}),(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:d,sessionId:n})}),[d,e,n]);if((0,o.useEffect)((()=>{"connection_complete_screen"===c&&(0,l().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"google-drive",moment:"finished"})}),[e,c]),"completed"===s||!t)return(0,U.jsx)(U.Fragment,{});const p="in_progress"===s;return(0,U.jsx)(V,{open:"connection_complete_screen"===c,connectorType:"google-drive",notes:[(0,U.jsx)(X,{number:1,title:{...{...$.connectionInProgressTitle,values:{appName:vt}}},description:$.defaultConnectionTime},"item1"),(0,U.jsx)(X,{number:2,title:{...{...$.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:vt}}}},"item2")],onEditSettingsClick:p?void 0:async()=>{if((0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"shared_drive_settings",integration_type:"google-drive",setup_session_id:n,from:d}}}),i().default.checkGate({gateName:"ai_connector_unification_google_drive"})){if("success"===(await(0,l().updateGoogleDriveConnectionStatus)({environment:e,spaceId:t})).status){const e=f().d.getState().initialSyncState;"in_progress"===e?(0,l().navigateToGoogleDriveUniversalScreen)({analyticsFrom:d,sessionId:n,screenToShow:"settings"}):"not_started"===e||"pending_selection"===e?(0,l().navigateToGoogleDriveUniversalScreen)({analyticsFrom:d,sessionId:n,screenToShow:"select_shared_drives_screen"}):(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:d,sessionId:n})}else(0,l().navigateToGoogleDriveUniversalScreen)({analyticsFrom:d,sessionId:n,screenToShow:"error"})}else{const s=await hn().callApi({eventName:"getGoogleDriveSyncProgress",environment:e,data:{spaceId:t},headers:(0,rt().WS)({spaceId:t})});if("success"===s.type){var o;const e=(0,S().HB)((null===(o=s.data)||void 0===o?void 0:o.status)||"not_started");f().d.setState({...f().d.state,initialSyncState:e}),"in_progress"===e?(0,l().navigateToGoogleDriveUniversalScreen)({analyticsFrom:d,sessionId:n,screenToShow:"settings"}):"not_started"===e||"pending_selection"===e?(0,l().navigateToGoogleDriveUniversalScreen)({analyticsFrom:d,sessionId:n,screenToShow:"select_shared_drives_screen"}):(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:d,sessionId:n})}else(0,l().navigateToGoogleDriveUniversalScreen)({analyticsFrom:d,sessionId:n,screenToShow:"error"})}},onPrimaryButtonClick:async()=>{if((0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_done",integration_type:"google-drive",setup_session_id:n,from:d}}}),!t)return;if(p)return void(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:d,sessionId:n});await mt({environment:e,spaceId:t})&&J().D6({label:(0,U.jsx)(M().sA,{id:"googleIngestionConfirmation.ingestion.acknowledge",defaultMessage:"Started syncing from Google drive. This can take up to 36 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(w().Ay,{onClick:J().N2,children:(0,U.jsx)(M().sA,{id:"googleIngestionConfirmation.ingestion.startedMessageDismiss",defaultMessage:"Close"})})})},onDismiss:u})}function yt(){const e=(0,a().K8)((()=>f().d.state.currentScreen),[]),n=(0,a().K8)((()=>f().d.state.sessionId),[]),t=(0,a().K8)((()=>f().d.state.analyticsFrom),[]),s=(0,a().K8)((()=>f().d.state.connectedSpaceId),[]),i=(0,r().v3)(),c=(0,I().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{fontSize:14,fontWeight:T().Wy.semibold,width:"100%"}})),[]),d="connection_exist_screen"===e,u=(0,o.useCallback)((async()=>{const e=h().default.state.currentUserRootStore;if(!e)return;(0,b().u)({environment:i,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"visit_other_workspace",integration_type:"google-drive",setup_session_id:n,from:t}}});const o=e.getSpaceViewStores().filter((e=>e.getSpaceId()===s))[0];await Fn().tR({environment:i,navigationType:"switchingToOrLoadingSpace",pageVisitSource:Pn().y8.AIGoogleDriveQna,spaceViewStore:o,userRootStore:h().default.state.currentUserRootStore,userSettingsStore:h().default.state.currentUserSettingsStore}),f().d.reset(),f().d.setState({...f().d.state,currentScreen:"settings",analyticsFrom:"google_other_workspace",sessionId:n})}),[t,s,i,n]);return(0,U.jsx)(D().a,{showCloseIcon:!0,onDismiss:()=>(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:t,sessionId:n}),open:d,render:()=>(0,U.jsxs)("div",{style:c.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"google-drive",title:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.connectionExist.title",defaultMessage:"You’ve already connected Google Drive to another Notion workspace."}),subtext:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.connectionExist.description",defaultMessage:"Currently, only one workspace can be connected to Google Drive. To connect this workspace, please disconnect the existing connection."})}),(0,U.jsx)(W().wt,{style:c.footer,children:(0,U.jsx)(R().A,{colorPalette:"blue",style:c.connectButton,onClick:u,children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.connectionExist.navigateButton",defaultMessage:"Visit the other workspace"})})})]})})}function _t(){const e=(0,a().O$)(f().d),n=(0,a().K8)((()=>f().d.state.currentScreen),[]),t=(0,g().r)(),s=(0,a().K8)((()=>i().default.getConfigKey("ingestion","googleDrive").marketplaceAppConfigureUrl),[]),c=(0,a().K8)((()=>f().d.state.sessionId),[]),l=(0,a().K8)((()=>f().d.state.analyticsFrom),[]),d=(0,r().v3)(),u=async()=>{if(!t)return;const e=await async function(e){const{environment:n,spaceId:t}=e,o=await hn().callApi({eventName:"disconnectGoogleDriveAIIngestion",environment:n,data:{spaceId:t,disconnectReason:"admin_disconnect"}});if("success"===o.type&&o.data.deletionInitiated)return f().d.setState({...f().d.state,currentScreen:"none",isDisconnecting:!0}),!0;return f().d.setState({...f().d.state,currentScreen:"error",isDisconnecting:!1}),!1}({environment:d,spaceId:t});e?J().D6({label:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.acknowledgeDisconnect",defaultMessage:"Started disconnecting Google Drive. This can take up to 3 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(w().Ay,{onClick:J().N2,children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.dismissAcknowledgeDisconnect",defaultMessage:"Close"})})}):J().D6({label:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.disconnectError",defaultMessage:"Failed to disconnect Google Drive. Please try again later."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(w().Ay,{onClick:J().N2,children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.closeSnackbarError",defaultMessage:"Close"})})})},p=n=>{f().d.setState({...e,currentScreen:n})},m=(0,I().IS)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:T().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:T().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:T().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:T().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:14,fontWeight:T().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{paddingTop:12,paddingInlineEnd:12,paddingBottom:12,paddingInlineStart:12,gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:T().Wy.regular,fontSize:14,lineHeight:"18px"},noteHeading:{fontWeight:T().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:T().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{rotate:"45deg",width:12,height:12,cursor:"pointer",display:"inline",padding:0,margin:0}})),[]),h=(0,o.useCallback)((()=>{const{noteBlockWrapper:e,noteHeading:n,noteBody:t,link:o}=m;return[(0,U.jsxs)(W().wt,{style:e,children:[(0,U.jsx)("div",{style:n,children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.post_disconnect_screen.note_1.heading",defaultMessage:"Google Drive data will be permanently deleted from Notion"},"note1-1")}),(0,U.jsx)("div",{style:t,children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.post_disconnect_screen.note_1.body",defaultMessage:"This process can take up to 3 hours. You’ll only be able to reconnect after disconnecting is complete."},"note1-2")})]},"note-1"),(0,U.jsxs)(W().wt,{style:e,children:[(0,U.jsx)("div",{style:n,children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.post_disconnect_screen.note_2.heading",defaultMessage:"Uninstall the Notion AI app from your Google Workspace (optional)"},"note2-1")}),(0,U.jsx)("div",{style:t,children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.post_disconnect_screen.note_2.body",defaultMessage:"Go to your {NavigateToGoogleWorkspaceAppsSettings} and uninstall the Notion AI app.",values:{NavigateToGoogleWorkspaceAppsSettings:(0,U.jsx)("a",{style:o,href:s,target:"_blank",onClick:()=>{(0,b().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_screen_marketplace_app_disconnect_btn",integration_type:"google-drive",setup_session_id:c,from:l}}})},children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.post_disconnect_screen.disconnect_google_marketplace_app",defaultMessage:"Google Workspace {ArrowIcon}",values:{ArrowIcon:(0,te().q)(m.icon)}})})}},"note2-2")})]},"note-2")]}),[m,s,d,c,l]);return"post_disconnect_screen"===n?(0,U.jsx)(oe,{onClickGotItBtn:()=>{p("none")},onDismiss:()=>{p("none")},open:"post_disconnect_screen"===n,connectorType:"google-drive",title:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.post_disconnect_modal.title",defaultMessage:"Google Drive is Disconnecting from Notion"}),descriptionMessage:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.post_disconnect_modal.description",defaultMessage:"Here’s what’s next:"}),message:(0,U.jsx)("div",{style:m.notesSectionWrapper,children:h().map(((e,n)=>(0,U.jsxs)(W().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:[(0,U.jsx)(N().A,{number:n+1}),(0,U.jsx)("div",{style:m.note,children:e})]},n)))})}):(0,U.jsx)(D().a,{showCloseIcon:!0,open:"disconnect_screen"===n,onDismiss:()=>{(0,b().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_close",integration_type:"google-drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),p("none")},render:()=>(0,U.jsx)("div",{style:m.confirmWrapper,children:(0,U.jsxs)("div",{style:m.confirmContainer,children:[(0,U.jsx)("div",{style:m.confirmModalTitle,children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.title",defaultMessage:"Are you sure?"})}),(0,U.jsx)("div",{style:m.confirmModalSubTitle,children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.subTitle",defaultMessage:"Google Drive data will be permanently deleted from Notion."})}),(0,U.jsx)("div",{style:m.confirmModalDescription,children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."})}),(0,U.jsxs)(W().wt,{style:m.confirmModalActionButtons,children:[(0,U.jsx)(R().A,{colorPalette:"red",style:m.confirmDisconnectButton,disabled:e.isDisconnecting,onClick:async()=>{(0,b().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_confirm_disconnect_button",integration_type:"google-drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),await u(),p("post_disconnect_screen")},children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"})}),(0,U.jsx)(w().Ay,{style:m.goBackButton,onClick:()=>{(0,b().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_back_button",integration_type:"google-drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),p("settings")},children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.goBack",defaultMessage:"Go back"})})]})]})})})}function St(){const e=(0,a().K8)((()=>f().d.state.currentScreen),[]),n=(0,a().K8)((()=>f().d.state.sessionId),[]),t=(0,a().K8)((()=>f().d.state.analyticsFrom),[]),s=(0,r().v3)(),i=(0,I().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{fontSize:14,fontWeight:T().Wy.semibold,width:"100%"}})),[]),c="error"===e;return(0,o.useEffect)((()=>{c&&(0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect_error",integration_type:"google-drive",setup_session_id:n,from:t}}})}),[c,t,n,s]),(0,U.jsx)(D().a,{showCloseIcon:!0,onDismiss:()=>(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:t,sessionId:n}),open:c,render:()=>(0,U.jsxs)("div",{style:i.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"google-drive",title:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.error.title",defaultMessage:"Oops! Something went wrong"}),subtext:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.error.description",defaultMessage:"Something went wrong, please try again later."})}),(0,U.jsx)(W().wt,{style:i.footer,children:(0,U.jsx)(R().A,{colorPalette:"blue",style:i.connectButton,onClick:()=>{(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:t,sessionId:n})},children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.error.Dismiss",defaultMessage:"Close"})})})]})})}function xt(){const[e,n]=o.useState(!1),t=(0,r().v3)(),s=(0,o.useMemo)((()=>fe("google-drive")),[]),c=(0,o.useMemo)((()=>ve("google-drive")),[]),d=(0,g().r)(),u=(0,a().K8)((()=>f().d.state.sessionId),[]),p=(0,a().K8)((()=>f().d.state.currentScreen),[]),m=(0,a().K8)((()=>f().d.state.analyticsFrom),[]),h=(0,a().K8)((()=>v().zD.canUseAiConnectorSearchScope("google-drive")),[]),y=(0,a().K8)((()=>i().default.getConfigKey("ingestion","googleDrive").learnMoreUrl),[]),x=(0,de().J)(),j=t.currentUser.id,C=(0,_().P9)({name:"ai_connectors",spaceId:d,userId:j}),I="introduction"===p;return(0,o.useEffect)((()=>{I&&h&&(0,b().u)({environment:t,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"google-drive",setup_session_id:u,from:m,is_space_admin:x,is_ai_eligible:C??!1}}})}),[m,t,C,I,x,u,h]),h?t.device.isMobile?(0,U.jsx)(_e,{connectorType:"google-drive",open:I,onClosed:()=>{f().d.reset()},learnMoreUrl:y}):x?(0,U.jsx)(ke,{connectorType:"google-drive",notes:s,onLearnMore:()=>{const e=i().default.getConfigKey("ingestion","googleDrive"),n=null==e?void 0:e.learnMoreUrl;window.open(n,"_blank")},onConnect:async()=>{d&&(n(!0),await async function(e,n,t,o){(0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect",integration_type:"google-drive",setup_session_id:t,from:o}}}),(0,l().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"google-drive",moment:"started"});const s=await(0,_().Bw)(e,{name:"ai_connectors",spaceId:n,userId:e.currentUser.id});if(!(0,_().e2)(s))return void(0,le().pp)({connector:"google-drive",environment:e,analyticsFrom:"google_drive_connect_button",connectorsFeatureAvailability:s});if(i().default.checkGate({gateName:"ai_connector_unification_google_drive"})){if("failed"===(await(0,l().updateGoogleDriveConnectionStatus)({environment:e,spaceId:n})).status)return void(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:o,sessionId:t});const s=f().d.getState().initialSyncState;if("in_progress"===s)return(0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connection_complete_screen",integration_type:"google-drive",setup_session_id:t,from:o}}}),void(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"settings",analyticsFrom:o,sessionId:t});if("completed"===s)return(0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"already_connected_screen",integration_type:"google-drive",setup_session_id:t,from:o}}}),void(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"already_connected",analyticsFrom:o,sessionId:t});"pending_selection"===s&&(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"connection_complete_screen",analyticsFrom:o,sessionId:t})}else{var r,a;const s=await hn().callApi({eventName:"getGoogleDriveSyncProgress",environment:e,data:{spaceId:n},headers:(0,rt().WS)({spaceId:n})});if("failed"===s.type)return void(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:o,sessionId:t});const i=(null==s||null===(r=s.data)||void 0===r?void 0:r.status)||"not_started",c=(0,S().HB)(i);if(f().d.setState({...f().d.state,initialSyncState:c,ingestionProgress:null==s||null===(a=s.data)||void 0===a?void 0:a.ingestionProgress}),"success"===s.type&&"in_progress"===c)return(0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connection_complete_screen",integration_type:"google-drive",setup_session_id:t,from:o}}}),void(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"settings",analyticsFrom:o,sessionId:t});if("success"===s.type&&"completed"===c)return(0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"already_connected_screen",integration_type:"google-drive",setup_session_id:t,from:o}}}),void(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"already_connected",analyticsFrom:o,sessionId:t})}(0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen",integration_type:"google-drive",setup_session_id:t,from:o}}}),(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"auth_screen",analyticsFrom:o,sessionId:t});const c=i().default.getConfigKey("ingestion","googleDrive");window.open(c.googleAuthUrl,"_blank"),hn().callApi({eventName:"initiateGoogleDriveDelayedIngestion",environment:e,data:{spaceId:n,setupSessionId:t}})}(t,d,u,m),n(!1))},onDismiss:()=>{(0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_dismiss",integration_type:"google-drive",setup_session_id:u,from:m}}}),(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:m,sessionId:u})},title:c,isLoading:e,open:I}):(0,U.jsx)(Ie,{connector:"google-drive",handleClose:()=>(0,l().resetAiConnectorStatus)("google-drive"),open:I,analyticsFrom:m,setupSessionId:u,messages:ye().Fn}):(0,U.jsx)(U.Fragment,{})}function jt(){const e=(0,a().K8)((()=>f().d.state.currentScreen),[]),n=(0,a().K8)((()=>f().d.state.sessionId),[]),t=(0,a().K8)((()=>f().d.state.analyticsFrom),[]),o=(0,I().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{fontSize:14,fontWeight:T().Wy.semibold,width:"100%"},iconWrapper:{width:16,height:16}})),[]);return(0,U.jsx)(D().a,{showCloseIcon:!0,onDismiss:()=>(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:t,sessionId:n}),open:"not_admin_screen"===e,render:()=>(0,U.jsxs)("div",{style:o.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"google-drive",title:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.notAdmin.title",defaultMessage:"Only Google Workspace Administrators can connect"}),subtext:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.notAdmin.description",defaultMessage:"We can’t verify that this account is a Google Workspace Administrator. Please contact your admin to link Notion using their account."})}),(0,U.jsx)(W().wt,{style:o.footer,children:(0,U.jsxs)(R().A,{colorPalette:"blue",style:o.connectButton,onClick:()=>{const e=i().default.getConfigKey("ingestion","googleDrive"),n=null==e?void 0:e.learnMoreUrl;window.open(n,"_blank")},children:[(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.notAdmin.learnMore",defaultMessage:"Learn more"}),(0,U.jsx)("div",{style:o.iconWrapper,children:(0,k().X)()})]})})]})})}var bt=()=>t(921030);function Ct(e){const{styles:n,events:t,isEditButtonEnabled:o,navigateToScreen:s}=e,i=(0,r().v3)(),c=(0,a().O$)(f().d);return(0,U.jsx)(H().A,{...t,size:"lg",style:n,disabled:!o,onClick:()=>{(0,b().u)({environment:i,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_edit_drives_button",integration_type:"google-drive",setup_session_id:c.sessionId,from:c.analyticsFrom}}}),s("select_shared_drives_screen")},children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.editSyncControls",defaultMessage:"Edit Drives"})})}function It(e){const{styles:n,events:t,isDisconnectButtonEnabled:o,navigateToScreen:s}=e,i=(0,r().v3)(),c=(0,a().O$)(f().d),l=(0,g().r)(),d=(0,a().K8)((()=>f().d.state.initialSyncState),[]);return(0,U.jsx)(Be().E,{...t,style:n,disabled:!o,onClick:async()=>{if(l)if((0,b().u)({environment:i,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_disconnect_button",integration_type:"google-drive",setup_session_id:c.sessionId,from:c.analyticsFrom}}}),"completed"!==d){if("not_started"===d){if("success"===(await hn().callApi({eventName:"disconnectGoogleDriveAIIngestion",environment:i,data:{spaceId:l,disconnectReason:"admin_disconnect"}})).type)return void s("none")}s("error")}else s("disconnect_screen")},children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.disconnectGoogleDrive",defaultMessage:"Disconnect"})})}const wt=function(){const e=(0,a().O$)(f().d),n=(0,g().r)(),t=(0,a().K8)((()=>f().d.state.analyticsFrom),[]),s=(0,a().K8)((()=>f().d.state.currentScreen),[]),d=(0,a().K8)((()=>f().d.state.initialSyncState),[]),u=(0,a().K8)((()=>f().d.state.sessionId),[]),[p,m]=(0,o.useState)(!0),[h,v]=(0,o.useState)(!1),[y,_]=(0,o.useState)(!1),[x,j]=(0,o.useState)([]),C=(0,r().v3)();(0,c().Yb)((async()=>{if(!n||!C||"settings"!==s)return;m(!0);let e=d;if("none"===d)if(i().default.checkGate({gateName:"ai_connector_unification_google_drive"})){if("failed"===(await(0,l().updateGoogleDriveConnectionStatus)({environment:C,spaceId:n})).status)return void(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:t,sessionId:u});e=f().d.getState().initialSyncState}else{var o;const s=await hn().callApi({eventName:"getGoogleDriveSyncProgress",environment:C,data:{spaceId:n},headers:(0,rt().WS)({spaceId:n})});if("failed"===s.type)return void(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:t,sessionId:u});const i=(null==s||null===(o=s.data)||void 0===o?void 0:o.status)||"not_started";e=(0,S().HB)(i),f().d.setState({...f().d.state,initialSyncState:e})}}),[t,C,d,s,u,n]),(0,c().Yb)((async()=>{if(n&&C&&"settings"===s&&"none"!==d)if("in_progress"===d)m(!1),v(!1),_(!1);else if("completed"===d||"not_started"===d||"pending_selection"===d){const e=await hn().callApi({eventName:"getSyncControlsForGoogleDriveAIIngestion",environment:C,data:{spaceId:n}});if("success"===(null==e?void 0:e.type)){const n=e.data;m(!1),v(!0),"not_started"===d||"pending_selection"===d?f().d.setState({...f().d.state,availableSyncControlOptions:n.options}):(f().d.setState({...f().d.state,availableSyncControlOptions:n.options,syncControlSelection:n.selection}),j(n.options.filter((e=>n.selection.driveIds.includes(e.id))))),f().d.state.isEditing||"in_progress"===f().d.state.initialSyncState||_(!0)}else v(!1),_(!1),J().D6({label:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.userError",defaultMessage:"Cannot disconnect Google Drive. Please contact Notion workspace admin."}),position:"bottom",style:{width:"600px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(w().Ay,{onClick:J().N2,children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.closeSnackbarError",defaultMessage:"Close"})})})}}),[n,C,s,d]);const k=n=>{(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:n,analyticsFrom:e.analyticsFrom,sessionId:e.sessionId})},A=function(e){return(0,I().IS)((n=>({wrapper:{width:400,padding:"0 24px",minHeight:e?478:void 0},settingsWrapper:{justifyContent:"center",gap:12},googleDriveDetailsContainer:{fontSize:14,fontWeight:T().Wy.regular,color:n.text.secondary,gap:12},driveNamesContainer:{gap:2,color:n.text.primary},footer:{justifyContent:"center",alignItems:"center",width:"100%",gap:8},disconnectButton:{fontSize:14,fontWeight:T().Wy.medium,width:"100%"},moreDrivesContainer:{paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},learnMoreSection:{padding:"24px 0"},learnMoreButton:{fontSize:14,fontWeight:T().Wy.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:T().Wy.medium,fontSize:12,gap:5,justifyContent:"center",alignItems:"center",paddingTop:4,paddingInlineEnd:8,paddingBottom:4,paddingInlineStart:8,color:`${n.text.secondary}`},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:T().Wy.semibold,color:n.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:T().Wy.regular,color:n.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:T().Wy.regular,color:n.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:T().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:14,fontWeight:T().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,justifyContent:"center",alignItems:"center"},driveItemWrapper:{width:"100%",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0,alignItems:"center"},driveName:{fontSize:14},driveIcon:{width:20,color:n.text.secondary}})),[e])}(p);return(0,U.jsx)(D().a,{showCloseIcon:!0,open:"settings"===s,onDismiss:()=>{(0,b().u)({environment:C,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_close",integration_type:"google-drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),j([]),k("none")},render:()=>{var n,t,o;return(0,U.jsxs)("div",{style:A.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"google-drive",title:"completed"===d?(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.settingsModalTitle",defaultMessage:"Google Drive is connected to Notion AI"}):(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.settingsModalTitle2",defaultMessage:"Google Drive is connecting to Notion AI"})}),p?(0,U.jsx)(W().Ye,{style:A.spinner,children:(0,U.jsx)(We().k,{})}):(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(W().Ye,{style:A.settingsWrapper,children:(0,U.jsxs)(W().wt,{style:A.googleDriveDetailsContainer,children:[(0,U.jsx)(W().wt,{children:"completed"===d?(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.canAnswerFrom",defaultMessage:"Notion AI is connected and can answer questions with content from {driveCountMessage}{futureDrivesMessage}",values:{driveCountMessage:x.length?`${x.length} Google Drives`:"Google Drive",futureDrivesMessage:null!==(n=e.syncControlSelection)&&void 0!==n&&n.enableSyncingFutureUsersAndDrives?", including future drives and users.":"."}}):(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.canAnswerFrom2",defaultMessage:"This can take up to 36h. You can cancel or modify your settings when the connection is complete. "})}),(0,U.jsxs)(W().wt,{children:[(0,U.jsxs)(W().wt,{style:A.driveNamesContainer,children:[null!==(t=e.syncControlSelection)&&void 0!==t&&t.enableSyncingFutureUsersAndDrives?(0,U.jsxs)(W().Ye,{style:A.driveItemWrapper,children:[(0,U.jsx)(W().wt,{style:A.driveIcon,children:(0,U.jsx)(De().I,{icon:bt().F,size:"xs"})}),(0,U.jsx)(W().wt,{style:A.driveName,children:(0,U.jsx)("div",{children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.includeCurrentAndFutureDrives",defaultMessage:"Includes current and future drives"})})})]}):void 0,null===(o=x.slice(0,4))||void 0===o?void 0:o.map((e=>(0,U.jsx)("div",{children:(0,U.jsxs)(W().Ye,{style:A.driveItemWrapper,children:[(0,U.jsx)(W().wt,{style:A.driveIcon,children:(0,U.jsx)(De().I,{icon:bt().F,size:"xs"})}),(0,U.jsx)(W().wt,{style:A.driveName,children:`${e.name}`})]})},e.id)))]}),(0,U.jsx)(W().Ye,{style:A.moreDrivesContainer,children:x.length-4>0?(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.moreDrives",defaultMessage:"... and {moreDriveCount} more",values:{moreDriveCount:x.length-4}}):(0,U.jsx)(U.Fragment,{})})]})]})}),(0,U.jsxs)(W().wt,{style:A.footer,children:[y?(0,U.jsx)(Ct,{styles:A.disconnectButton,isEditButtonEnabled:y,navigateToScreen:k}):(0,U.jsx)(Fe().A,{allowHover:!0,textWrap:!0,renderTooltip:()=>(0,U.jsx)("div",{style:{width:240},children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.editDrive.tooltip",defaultMessage:"You can cancel or modify your settings when the connection is complete. "})}),render:e=>(0,U.jsx)(Ct,{events:e,styles:A.disconnectButton,isEditButtonEnabled:y,navigateToScreen:k})}),h?(0,U.jsx)(It,{styles:A.disconnectButton,isDisconnectButtonEnabled:h,navigateToScreen:k}):(0,U.jsx)(Fe().A,{allowHover:!0,textWrap:!0,renderTooltip:()=>(0,U.jsx)("div",{style:{width:240},children:(0,U.jsx)(M().sA,{id:"universalSearch.googleDriveIngestion.editDrive.tooltip",defaultMessage:"You can cancel or modify your settings when the connection is complete. "})}),render:e=>(0,U.jsx)(It,{events:e,styles:A.disconnectButton,isDisconnectButtonEnabled:h,navigateToScreen:k})})]}),(0,U.jsx)(W().Ye,{style:A.learnMoreSection,children:(0,U.jsx)(w().Ay,{style:A.learnMoreButton,onClick:()=>{(0,b().u)({environment:C,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_learn_more_url_click",integration_type:"google-drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),(()=>{const e=i().default.getConfigKey("ingestion","googleDrive"),n=null==e?void 0:e.learnMoreUrl;n&&window.open(n,"_blank")})()},children:(0,U.jsxs)(W().Ye,{style:A.learnMoreText,children:[(0,U.jsx)(M().sA,{id:"universalSearch.integration.learnMore",defaultMessage:"Learn more"}),(0,U.jsx)(De().I,{icon:Pe().arrowUpRightSquareSmallIcon,size:"sm"})]})})})]})]})}})};function kt(){const e=(0,a().K8)((()=>f().d.state.currentScreen),[]),n=(0,a().K8)((()=>f().d.state.sessionId),[]),t=(0,a().K8)((()=>f().d.state.analyticsFrom),[]),o=(0,I().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{fontSize:14,fontWeight:T().Wy.semibold,width:"100%"},iconWrapper:{width:16,height:16}})),[]);return(0,U.jsx)(D().a,{showCloseIcon:!0,onDismiss:()=>(0,l().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",sessionId:n,analyticsFrom:t}),open:"service_account_not_added"===e,render:()=>(0,U.jsxs)("div",{style:o.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"google-drive",title:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.accountNotAdded.title",defaultMessage:"First, get your Google Workspace ready"}),subtext:(0,U.jsx)(M().sA,{id:"universalSearch.googleDrive.accountNotAdded.description",defaultMessage:"Before linking Google Drive with Notion, you’ll need to modify a few settings in your Google Workspace."})}),(0,U.jsx)(W().wt,{style:o.footer,children:(0,U.jsxs)(R().A,{colorPalette:"blue",style:o.connectButton,onClick:()=>{const e=i().default.getConfigKey("ingestion","googleDrive"),n=null==e?void 0:e.learnMoreUrl;window.open(n,"_blank")},children:[(0,U.jsx)(M().sA,{id:"universalSearch.integration.seeInstruction",defaultMessage:"See instructions"}),(0,U.jsx)("div",{style:o.iconWrapper,children:(0,k().X)()})]})})]})})}function At(){const e=(0,a().K8)((()=>y().y.state.currentScreen),[]);return(0,U.jsx)(qe,{open:"already_connected"===e,onDismiss:()=>{y().y.reset()},connector:"jira"})}var Mt=()=>t(124749);function Tt(){const[e,n]=o.useState(!1),t=(0,r().v3)(),s=(0,I().IS)((e=>({noteHeading:{fontWeight:T().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:T().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{width:18,height:17,color:"#D7813A",marginTop:2},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingInlineStart:14,fontweight:T().Wy.regular},warningContainer:{marginInlineStart:5,marginInlineEnd:5,marginBottom:15}})),[]),c=(0,a().K8)((()=>y().y.state.currentScreen),[]),d=(0,a().K8)((()=>y().y.state.analyticsFrom),[]),u=(0,a().K8)((()=>y().y.state.sessionId),[]),p=(0,Mt().$)(),m=(0,g().r)(),h=(0,o.useCallback)((async()=>{if(!m)return;var e;(0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_button_clicked",integration_type:"jira",setup_session_id:u,from:d}}}),await(e=5e3,new Promise((n=>setTimeout(n,e))));const o=await hn().callApi({eventName:"checkNotionToJiraConnection",environment:t,data:{spaceId:m}});"success"===o.type&&o.data.isConnected?(y().y.setState({...y().y.state,currentScreen:"connection_complete_screen",jiraSiteId:o.data.jiraSiteId}),(0,l().navigateToJiraUniversalScreen)({screenToShow:"connection_complete_screen",analyticsFrom:d,sessionId:u})):n(!0)}),[d,t,u,m]),v=(0,a().K8)((()=>i().default.getConfigKey("jira_ai_ingestion_config","jiraMarketPlaceAppUrl")),[]),f=(0,a().K8)((()=>i().default.getConfigKey("jira_ai_ingestion_config","learnMoreUrl")),[]);if(!p||!m)return null;const _=e?(0,U.jsxs)(W().Ye,{style:s.warningContainer,children:[(0,L().Q)(s.icon),(0,U.jsx)("div",{style:s.warningText,children:(0,U.jsx)(M().sA,{id:"universalQnA.jira.AuthScreen.warning",defaultMessage:"We couldn’t connect to Jira. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{TroubleshootingGuide:(0,U.jsx)("a",{style:{...s.link,color:"#D7813A"},href:f,target:"_blank",onClick:()=>{(0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"trouble_shooting_guide_clicked",integration_type:"jira",setup_session_id:u,from:d}}})},children:(0,U.jsx)(M().sA,{id:"universalSearch.jira.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,U.jsx)(q,{title:(0,U.jsx)(M().sA,{id:"universalQnA.jira.AuthScreen",defaultMessage:"Follow instructions from Jira in your browser"}),open:"check_connection"===c,onDismiss:()=>{n(!1),(0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_dismiss",integration_type:"jira",setup_session_id:u,from:d}}}),(0,l().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:d,sessionId:u})},warningMessage:_,notes:[(0,U.jsxs)(W().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:s.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.jira.waitingForConnectionNoteHeading1",defaultMessage:"Jira should open automatically on a new browser tab."},"note1-1")}),(0,U.jsx)("div",{style:s.noteBody,children:(0,U.jsx)(M().sA,{id:"universalSearch.jira.authWaiting2",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,U.jsx)("a",{style:s.link,href:v,target:"_blank",onClick:()=>{(0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_open_auth_url",integration_type:"jira",setup_session_id:u,from:d}}})},children:(0,U.jsx)(M().sA,{id:"universalSearch.jira.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,U.jsxs)(W().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:s.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.jira.workspaceAdminHeading",defaultMessage:"Follow Jira’s instructions to connect"},"note2")}),(0,U.jsx)("div",{style:s.noteBody,children:(0,U.jsx)(M().sA,{id:"universalSearch.jira.authWaiting",defaultMessage:"Install the Notion connector in a Jira site of your choice and return to this window"},"note1-2")})]},"note-2"),(0,U.jsx)(W().wt,{style:{gap:4},children:(0,U.jsx)("div",{style:s.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.jira.workspaceAdminHeading2",defaultMessage:"When you’re done, click the button below"},"note3")})},"note-3")],openLearnMoreUrl:()=>{window.open(f,"_blank")},connectorType:"jira",primaryButtonText:(0,U.jsx)(M().sA,{id:"universalSearch.jira.Button.finishedSetup",defaultMessage:"Check connection"},"note3-1"),onClickPrimaryButton:h})}var Nt=()=>t(280746),Dt=()=>t(231297),Wt=()=>t(548487),Bt=()=>t(525884),Pt=()=>t(187820);function Ft(e){const{connector:n,learnMoreUrl:t,from:s,to:i,subtext:c,onDismiss:l,close:u,onConfirm:g,open:p,title:m}=e,[h,f]=o.useState(!1),y=(0,r().v3)(),_=(0,a().K8)((()=>v().zD.canUseAiConnectorSearchScope(n)),[n]),S=(0,I().IS)((e=>({wrapper:{width:400},selectionContainer:{padding:20,width:400,paddingTop:12,justifyContent:"center"},waitingForConnectionWrapper:{display:"flex",flexDirection:"column",alignItems:"center"},note:{fontWeight:T().Wy.regular,fontSize:T().J.UIRegular.desktop,lineHeight:"18px",marginInlineStart:8},dismissButton:{gap:4,width:"100%",alignItems:"center",fontSize:T().J.UISmall.desktop,color:e.text.primary,justifyContent:"center"},noteHeading:{fontWeight:T().Wy.medium,fontSize:T().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{fontWeight:T().Wy.regular,color:e.text.secondary,fontSize:T().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"},noteContainer:{backgroundColor:e.blue.background.secondary,color:e.blue.text.accentPrimary,padding:"10px",margin:"10px 20px",borderRadius:8,width:"auto"},connectorInfoContainer:{alignItems:"center",border:"1px solid",borderColor:e.pill.hover.border.white,borderRadius:6,paddingTop:4,paddingInlineEnd:12,paddingBottom:4,paddingInlineStart:12,justifyContent:"space-between"},connectorIconContainer:{justifyContent:"center"},connectorIcon:{width:24,height:24,size:24},verticalHr:{width:12,marginTop:2,marginInlineEnd:0,marginBottom:2,marginInlineStart:0,transform:"rotate(90deg)"},footer:{justifyContent:"center",alignItems:"center",width:"100%",paddingTop:12,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{width:"100%"}})),[]),x=(0,M().tz)(),j=(0,o.useCallback)((async()=>{f(!0);try{await g()}finally{f(!1)}}),[g,f]);return _?y.device.isMobile?(0,U.jsx)(_e,{connectorType:n,open:p,onClosed:()=>d().NT[n].reset(),learnMoreUrl:t}):(0,U.jsx)(D().a,{ariaLabel:x.formatMessage({id:"universalSearch.pendingConnection.ariaLabel",defaultMessage:"Pending connection modal"}),showCloseIcon:null==u?void 0:u.showCloseButton,open:p,onDismiss:null==u?void 0:u.onClose,render:()=>(0,U.jsxs)("div",{style:S.wrapper,children:[(0,U.jsx)(F().b,{connectorType:n,title:m,subtext:c}),(0,U.jsx)(W().Ye,{style:S.selectionContainer,children:(0,U.jsxs)(W().wt,{style:S.waitingForConnectionWrapper,children:[(0,U.jsxs)(W().Ye,{style:S.connectorInfoContainer,children:[(0,U.jsx)(W().Ye,{style:S.connectorIconContainer,children:s.icon(S.connectorIcon)}),(0,U.jsx)(W().Ye,{children:(0,U.jsxs)(W().wt,{style:S.note,children:[(0,U.jsx)("div",{style:S.noteHeading,children:s.title||""}),(0,U.jsx)("div",{style:S.noteBody,children:s.label})]})})]}),(0,U.jsx)("div",{style:S.verticalHr,children:(0,U.jsx)("hr",{})}),(0,U.jsx)("div",{style:S.noteBody,children:(0,U.jsx)(M().sA,{id:"universalSearch.confirmConnection.willConnectToLabel",defaultMessage:"will connect to:"})}),(0,U.jsx)("div",{style:S.verticalHr,children:(0,U.jsx)("hr",{})}),(0,U.jsx)("div",{style:S.connectorInfoContainer,children:(0,U.jsxs)(W().Ye,{children:[(0,U.jsx)(W().wt,{style:S.connectorIconContainer,children:(0,U.jsx)(Pt().B6,{disabled:!0,icon:i.icon,iconRecordCategory:"workspace",isEmptyPage:!1,title:i.title,size:S.connectorIcon.size,isLarge:!0})}),(0,U.jsxs)(W().wt,{style:S.note,children:[(0,U.jsx)("div",{style:S.noteHeading,children:i.title}),(0,U.jsx)("div",{style:S.noteBody,children:i.label})]})]})})]})}),(0,U.jsxs)(W().Ye,{style:{...S.selectionContainer,...S.noteContainer},children:[(0,U.jsx)(W().wt,{style:S.connectorIconContainer,children:(0,Bt().infoCircleIcon)(S.connectorIcon)}),(0,U.jsx)(W().Ye,{style:S.note,children:(0,U.jsx)(M().sA,{id:"universalSearch.integration.confirmConnectionNoteLabel",defaultMessage:"To connect a different Notion workspace, switch to that workspace and try again."})})]}),(0,U.jsxs)(W().wt,{style:S.footer,children:[(0,U.jsx)(R().A,{colorPalette:"blue",size:"xl",isLoading:h,disabled:h,style:S.connectButton,onClick:j,children:(0,U.jsx)(M().sA,{id:"universalSearch.integration.confirmConnection",defaultMessage:"Confirm connection"})}),(0,U.jsx)(H().A,{size:"lg",style:S.dismissButton,onClick:l,children:(0,U.jsx)(M().sA,{id:"universalSearch.integrations.dismissConnectionButton",defaultMessage:"Dismiss"})})]})]})}):null}function Ut(){const[e,n]=o.useState(!1),t=(0,r().v3)(),s=(0,a().K8)((()=>y().y.state.currentScreen),[]),c=(0,a().O$)(h().AppStoreSidebarSpaceStore),d=(0,a().K8)((()=>y().y.state.analyticsFrom),[]),u=(0,a().K8)((()=>y().y.state.sessionId),[]),g=(0,Mt().$)(),p=(0,a().K8)((()=>{const e=y().y.state.jiraSiteUrl.match(/^https:\/\/([a-zA-Z0-9-]+)\.atlassian\.net/);return e?e[1]:y().y.state.jiraSiteUrl}),[]),m=(0,a().O$)(h().AppStoreSidebarSpaceViewStore),v=(0,a().O$)(h().AppStoreCurrentUserSettingsStore),{spaceId:f,notionIcon:_,notionSpaceName:S}=(0,a().K8)((()=>({spaceId:null==c?void 0:c.getSpaceId(),notionIcon:null==c?void 0:c.getIcon(),notionSpaceName:(null==c?void 0:c.getName())||""})),[c]),x=(0,a().K8)((()=>i().default.getConfigKey("jira_ai_ingestion_config","learnMoreUrl")),[]),j=(0,o.useCallback)((async()=>{if(!f)return;var e;(0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"resume_pending_connection_button_clicked",integration_type:"jira",setup_session_id:u,from:d}}}),await(e=5e3,new Promise((n=>setTimeout(n,e))));await Wt().aiQnaActions.connectSpaceToJiraSite({environment:t,spaceId:f})?(0,l().navigateToJiraUniversalScreen)({screenToShow:"connection_complete_screen",analyticsFrom:d,sessionId:u}):n(!0)}),[d,t,u,f]),C=(0,o.useCallback)((()=>{v&&m&&(Dt().createAndCommit({userAction:"jiraAIConnector.onboarding.dismissPersonalAuthPrompt",environment:t,canUndo:!0,perform:e=>{Dt().applyOperation({store:m,operation:{pointer:m.pointer,path:["settings"],command:"update",args:{...m.getSettings(),dismissed_jira_installation_pending_prompt:!0}},transaction:e})}}),(0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"pending_connection_dismiss",integration_type:"jira",setup_session_id:u,from:d}}}),(0,l().navigateToJiraUniversalScreen)({screenToShow:"connection_dismiss_screen",analyticsFrom:d,sessionId:u}))}),[v,m,t,d,u]);if(!g||!c)return null;const I=(0,U.jsx)(M().sA,{id:"universalSearch.jira.confirmConnection.jiraWorkspaceLabel",defaultMessage:"Jira workspace"}),w=(0,U.jsx)(M().sA,{id:"universalSearch.jira.confirmConnection.notionWorkspaceLabel",defaultMessage:"Notion workspace"});return(0,U.jsx)(Ft,{connector:"jira",close:{showCloseButton:!0,onClose:()=>{n(!1),(0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"pending_connection_close",integration_type:"jira",setup_session_id:u,from:d}}}),(0,l().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:d,sessionId:u})}},open:"connection_pending_screen"===s,title:(0,U.jsx)(M().sA,{id:"universalQnA.jira.ConfirmConnectionScreen",defaultMessage:"Confirm Jira connection"}),subtext:(0,U.jsx)(M().sA,{id:"universalSearch.jira.subtext.confirmConnectionScreen",defaultMessage:"A connection was started from the Jira App Marketplace. Review details below:"}),onDismiss:C,onConfirm:j,from:{icon:Nt().jiraIcon,title:p,label:I},to:{icon:_,title:S,label:w},learnMoreUrl:x})}const Et=K().w0.jira;function zt(){const e=(0,r().v3)(),n=(0,a().K8)((()=>y().y.state.currentScreen),[]),t=(0,a().K8)((()=>y().y.state.sessionId),[]),s=(0,a().K8)((()=>y().y.state.analyticsFrom),[]),i=(0,a().K8)((()=>y().y.state.sessionId),[]),c=(0,g().r)();let d=(0,a().K8)((()=>y().y.state.jiraSiteId),[]);const u=(0,a().K8)((()=>y().y.state.jiraSyncState),[]);(0,o.useEffect)((()=>{"connection_complete_screen"===n&&(0,l().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"jira",moment:"finished"})}),[e,n]);const p="in_progress"===u;return(0,U.jsx)(V,{open:"connection_complete_screen"===n,onDismiss:()=>{(0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_dismiss",integration_type:"jira",setup_session_id:t,from:s}}})},connectorType:"jira",notes:[(0,U.jsx)(X,{number:1,title:{...{...$.connectionInProgressTitle,values:{appName:Et}}},description:$.defaultConnectionTime},"item1"),(0,U.jsx)(X,{number:2,title:{...{...$.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:Et}}}},"item2")],onEditSettingsClick:p?void 0:async()=>{if(!c)return;(0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"jira_settings",integration_type:"jira",setup_session_id:t,from:s}}});const n=await(0,l().getJiraAIConnectionStatusAction)({environment:e,spaceId:c});if(n){var o;const e=null===(o=n.connectionState)||void 0===o?void 0:o.status;"in_progress"===e?(0,l().navigateToJiraUniversalScreen)({analyticsFrom:s,sessionId:t,screenToShow:"settings"}):"not_started"===e||"pending_selection"===e?(0,l().navigateToJiraUniversalScreen)({analyticsFrom:s,sessionId:t,screenToShow:"select_projects"}):(0,l().navigateToJiraUniversalScreen)({analyticsFrom:s,sessionId:t,screenToShow:"error"})}else(0,l().navigateToJiraUniversalScreen)({analyticsFrom:s,sessionId:t,screenToShow:"error"})},onPrimaryButtonClick:async()=>{var n,o;if(!c)return;if((0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_done",integration_type:"jira",setup_session_id:t,from:s}}}),p||"completed"===u)return void(0,l().navigateToJiraUniversalScreen)({analyticsFrom:s,sessionId:i,screenToShow:"none"});const r=await(0,l().getJiraAIConnectionStatusAction)({environment:e,spaceId:c});if(d=(null==r?void 0:r.jiraSiteId)??"",d){if("in_progress"===(null==r||null===(n=r.connectionState)||void 0===n?void 0:n.status)||"completed"===(null==r||null===(o=r.connectionState)||void 0===o?void 0:o.status))return J().D6({label:Mn().A.getIntl().formatMessage({defaultMessage:"Jira sync started. This can take up to 36 hours.",id:"jira.sync.started.background.3"}),position:"bottom"}),void(0,l().navigateToJiraUniversalScreen)({analyticsFrom:s,sessionId:i,screenToShow:"none"});await(0,l().startJiraBulkIngestionAction)({environment:e,spaceId:c,jiraSiteId:d,sessionId:i}),(0,l().navigateToJiraUniversalScreen)({analyticsFrom:s,sessionId:i,screenToShow:"none"})}else(0,l().navigateToJiraUniversalScreen)({analyticsFrom:s,sessionId:i,screenToShow:"error"})}})}const Lt=(0,M().YK)({note1Heading:{id:"universalSearch.jiraIngestion.post_disconnect_screen.note_1.heading",defaultMessage:"Jira data will be permanently deleted from Notion"},note1Body:{id:"universalSearch.jiraIngestion.post_disconnect_screen.note_1.body",defaultMessage:"This process can take up to 3 hours. You’ll only be able to reconnect after disconnecting is complete."},note2Heading:{id:"universalSearch.jiraIngestion.post_disconnect_screen.note_2.heading",defaultMessage:"Uninstall the Notion AI app from your Jira Site (optional)"},postDisconnectTitle:{id:"universalSearch.jiraIngestion.post_disconnect_modal.title",defaultMessage:"Jira is disconnecting from Notion AI"},postDisconnectDescription:{id:"universalSearch.jiraIngestion.post_disconnect_modal.description",defaultMessage:"Here’s what’s next:"},disconnectTitle:{id:"universalSearch.jiraIngestion.disconnectModal.title",defaultMessage:"Are you sure?"},disconnectSubTitle:{id:"universalSearch.jiraIngestion.disconnectModal.subTitle",defaultMessage:"Jira data will be permanently deleted from Notion."},disconnectDescription:{id:"universalSearch.jiraIngestion.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."},primaryButtonLabel:{id:"universalSearch.jiraIngestion.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"},goBackButtonLabel:{id:"universalSearch.jiraIngestion.disconnectModal.goBack",defaultMessage:"Go back"}});function Kt(){const e=(0,I().IS)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:T().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.medium,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{paddingTop:12,paddingInlineEnd:12,paddingBottom:12,paddingInlineStart:12,gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:T().Wy.regular,fontSize:T().J.UIRegular.desktop,lineHeight:"18px"},noteHeading:{fontWeight:T().Wy.medium,fontSize:T().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{fontWeight:T().Wy.regular,color:e.text.secondary,fontSize:T().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{rotate:"45deg",width:12,height:12,cursor:"pointer",display:"inline",padding:0,margin:0}})),[]),[n,t]=(0,o.useState)(!1),s=(0,a().O$)(y().y),i=(0,a().K8)((()=>s.jiraSiteId),[s]),c=(0,a().K8)((()=>s.jiraSiteUrl),[s]),d=(0,a().K8)((()=>y().y.state.currentScreen),[]),u=(0,g().r)(),p=(0,a().K8)((()=>y().y.state.analyticsFrom),[]),m=(0,a().K8)((()=>y().y.state.sessionId),[]),h=(0,r().v3)(),v=async()=>{if(!u)return;const e=await async function(e){const{environment:n,spaceId:t,jiraSiteId:o}=e,s=await hn().callApi({eventName:"disconnectJiraConnector",environment:n,data:{spaceId:t,jiraSiteId:o}});if("success"===s.type)return J().D6({label:Mn().A.getIntl().formatMessage({defaultMessage:"Started disconnecting Jira. This can take up to 3 hours.",id:"jira.disconnect.started"}),position:"bottom",style:{width:"400px",display:"flex",justifyContent:"space-between"}}),!0;return!1}({environment:h,spaceId:u,jiraSiteId:i});e&&y().y.setState({...s,jiraSyncState:"disconnecting",isDisconnecting:!0,currentScreen:"post_disconnect_screen"})},f=(0,o.useCallback)((()=>{const{noteBlockWrapper:n,noteHeading:t,noteBody:o,link:s}=e;return[(0,U.jsxs)(W().wt,{style:n,children:[(0,U.jsx)("div",{style:t,children:(0,U.jsx)(M().sA,{...Lt.note1Heading})}),(0,U.jsx)("div",{style:o,children:(0,U.jsx)(M().sA,{...Lt.note1Body})})]},"note-1"),(0,U.jsxs)(W().wt,{style:n,children:[(0,U.jsx)("div",{style:t,children:(0,U.jsx)(M().sA,{...Lt.note2Heading})}),(0,U.jsx)("div",{style:o,children:(0,U.jsx)(M().sA,{id:"universalSearch.jiraIngestion.post_disconnect_screen.note_2.body",defaultMessage:"Go to your {NavigateToJiraSiteSettings} and uninstall the Notion AI app.",values:{NavigateToJiraSiteSettings:(0,U.jsx)("a",{style:s,href:`${c}/plugins/servlet/upm`,target:"_blank",onClick:()=>{(0,b().u)({environment:h,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_screen_marketplace_app_disconnect_btn",integration_type:"jira",setup_session_id:m,from:p}}})},children:(0,U.jsx)(M().sA,{id:"universalSearch.jiraIngestion.post_disconnect_screen.disconnect_jira_marketplace_app",defaultMessage:"Jira Site {ArrowIcon}",values:{ArrowIcon:(0,te().q)(e.icon)}})})}},"note2-2")})]},"note-2")]}),[e,c,h,m,p]);return"post_disconnect_screen"===d?(0,U.jsx)(oe,{onClickGotItBtn:()=>{y().y.setState({...s,currentScreen:"none"})},onDismiss:()=>{y().y.setState({...s,currentScreen:"none"})},open:"post_disconnect_screen"===d,connectorType:"jira",title:(0,U.jsx)(M().sA,{...Lt.postDisconnectTitle}),descriptionMessage:(0,U.jsx)(M().sA,{...Lt.postDisconnectDescription}),message:(0,U.jsx)("div",{style:e.notesSectionWrapper,children:f().map(((n,t)=>(0,U.jsxs)(W().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:[(0,U.jsx)(N().A,{number:t+1}),(0,U.jsx)("div",{style:e.note,children:n})]},t)))})}):(0,U.jsx)(D().a,{showCloseIcon:!0,open:"disconnect_screen"===d,onDismiss:()=>{y().y.setState({...s,currentScreen:"none"})},render:()=>(0,U.jsx)("div",{style:e.confirmWrapper,children:(0,U.jsxs)("div",{style:e.confirmContainer,children:[(0,U.jsx)("div",{style:e.confirmModalTitle,children:(0,U.jsx)(M().sA,{...Lt.disconnectTitle})}),(0,U.jsx)("div",{style:e.confirmModalSubTitle,children:(0,U.jsx)(M().sA,{...Lt.disconnectSubTitle})}),(0,U.jsx)("div",{style:e.confirmModalDescription,children:(0,U.jsx)(M().sA,{...Lt.disconnectDescription})}),(0,U.jsxs)(W().wt,{style:e.confirmModalActionButtons,children:[(0,U.jsx)(R().A,{colorPalette:"red",style:e.confirmDisconnectButton,isLoading:n,onClick:async()=>{(0,b().u)({environment:h,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_confirm_disconnect_button",integration_type:"jira",setup_session_id:m,from:p}}}),t(!0),await v(),t(!1)},children:(0,U.jsx)(M().sA,{...Lt.primaryButtonLabel})}),(0,U.jsx)(w().Ay,{style:e.goBackButton,onClick:()=>{(0,l().navigateToJiraUniversalScreen)({screenToShow:"settings",analyticsFrom:s.analyticsFrom,sessionId:s.sessionId})},children:(0,U.jsx)(M().sA,{...Lt.goBackButtonLabel})})]})]})})})}var Ht=()=>t(209660);function Rt(e){const{notes:n,connectorType:t,open:s,onDismiss:i,title:r,subText:a,onClickPrimaryButton:c,primaryButtonText:l,warningMessage:d}=e,[u,g]=(0,o.useState)(!1),p=(0,I().IS)((e=>({wrapper:{width:400},selectionContainer:{padding:20,width:400,paddingTop:12},dismissConnectionWrapper:{display:"flex",flexDirection:"column",alignItems:"center"},buttonContainer:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",marginTop:"16px"},primaryButton:{fontSize:14,fontWeight:T().Wy.regular,width:"100%"}})),[]),m=(0,M().tz)();return(0,U.jsx)(D().a,{ariaLabel:m.formatMessage({id:"universalSearch.dismissConnection.ariaLabel",defaultMessage:"Dismiss Connection modal"}),showCloseIcon:!0,open:s,onDismiss:i,render:()=>(0,U.jsxs)("div",{style:p.wrapper,children:[(0,U.jsx)(F().b,{connectorType:t,title:r,subtext:a,disconnectFlow:!0}),(0,U.jsx)(W().Ye,{style:p.selectionContainer,children:(0,U.jsx)(W().wt,{children:(0,U.jsxs)(W().wt,{style:p.dismissConnectionWrapper,children:[n.map(((e,n)=>(0,U.jsx)(X,{number:n+1,title:e.title,description:e.description},`note${n}`))),(0,U.jsxs)(W().Ye,{style:p.buttonContainer,children:[d,c?(0,U.jsx)(R().A,{colorPalette:"blue",isLoading:u,disabled:u,style:p.primaryButton,onClick:()=>{g(!0),c(),g(!1)},children:l}):void 0]})]})})})]})})}const Gt=(0,M().YK)({connectToJiratitle:{id:"universalSearch.jira.connectToJiraLaterNoteHeading1",defaultMessage:"To connect Jira later:"},connectToJiraDescription:{id:"universalSearch.jira.connectToJiraLaterNote1",defaultMessage:"Go to your {aiConnectorSettingElem} and click on the Jira AI connector."},fullyDisconnectJiraTitle:{id:"universalSearch.jira.toDisconnectJiraCompleteHeading",defaultMessage:"To fully disconnect Jira:"},fullyDisconnectJiraDescription:{id:"universalSearch.jira.toDisconnectJiraCompleteNote",defaultMessage:"Go to your {atlassianDashboardElem} and uninstall the Notion AI app."}});function qt(){const e=(0,r().v3)(),n=(0,I().IS)((e=>({link:{display:"inline",color:e.text.secondary,textDecoration:"underline",cursor:"pointer"}})),[]),t=(0,a().K8)((()=>y().y.state.currentScreen),[]),s=(0,a().O$)(h().AppStoreSidebarSpaceStore),i=(0,a().K8)((()=>y().y.state.analyticsFrom),[]),c=(0,a().K8)((()=>y().y.state.jiraSiteUrl),[]),d=(0,a().K8)((()=>y().y.state.sessionId),[]),u=(0,Mt().$)(),g=(0,o.useCallback)((()=>{(0,l().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:i,sessionId:d})}),[i,d]);if(!u||!s)return null;const p=(0,U.jsx)(w().Ay,{style:{...n.link,display:"inline"},hoveredStyle:{background:"transparent"},onClick:()=>{(0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"ai_settings_redirect",integration_type:"jira",setup_session_id:d,from:i}}}),y().y.setState({...y().y.state,currentScreen:"none"}),Ht().Ow({currentTab:"ai"})},children:(0,U.jsx)(M().sA,{id:"universalSearch.jira.aiConnectorsSettingsNote1",defaultMessage:"AI Connectors Settings"})}),m=(0,U.jsx)("a",{style:n.link,href:`${c}/plugins/servlet/upm`,target:"_blank",onClick:()=>{(0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"jira_uninstall_marketplace_admin",integration_type:"jira",setup_session_id:d,from:i}}})},children:(0,U.jsx)(M().sA,{id:"universalSearch.jira.jiraAdminMarketplace",defaultMessage:"Atlassian admin dashboard"})});return(0,U.jsx)(Rt,{title:(0,U.jsx)(M().sA,{id:"universalQnA.jira.DismissedConnectionScreen",defaultMessage:"Connection dismissed"}),subText:(0,U.jsx)(M().sA,{id:"universalSearch.jira.DismissedConnectionScreenLabel",defaultMessage:"Here’s what you should know:"}),open:"connection_dismiss_screen"===t,onDismiss:()=>{(0,l().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:i,sessionId:d})},notes:[{title:Gt.connectToJiratitle,description:{...{...Gt.connectToJiraDescription,values:{aiConnectorSettingElem:p}}}},{title:Gt.fullyDisconnectJiraTitle,description:{...{...Gt.fullyDisconnectJiraDescription,values:{atlassianDashboardElem:m}}}}],connectorType:"jira",primaryButtonText:(0,U.jsx)(M().sA,{id:"universalSearch.jira.Button.dismissedConnectionConfirmation",defaultMessage:"Got it"},"note3-1"),onClickPrimaryButton:g,openLearnMoreUrl:void 0})}function Ot(){const e=(0,a().K8)((()=>y().y.state.currentScreen),[]),n=(0,a().K8)((()=>y().y.state.sessionId),[]),t=(0,a().K8)((()=>y().y.state.analyticsFrom),[]),o=(0,I().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{fontSize:14,fontWeight:T().Wy.semibold,width:"100%"}})),[]),s="error"===e;return(0,U.jsx)(D().a,{showCloseIcon:!0,onDismiss:()=>(0,l().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:t,sessionId:n}),open:s,render:()=>(0,U.jsxs)("div",{style:o.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"jira",title:(0,U.jsx)(M().sA,{id:"universalSearch.jira.error.title",defaultMessage:"Oops! Something went wrong"}),subtext:(0,U.jsx)(M().sA,{id:"universalSearch.jira.error.description",defaultMessage:"Something went wrong, please try again later."})}),(0,U.jsx)(W().wt,{style:o.footer,children:(0,U.jsx)(R().A,{colorPalette:"blue",style:o.connectButton,onClick:()=>{(0,l().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:t,sessionId:n})},children:(0,U.jsx)(M().sA,{id:"universalSearch.jira.error.Dismiss",defaultMessage:"Close"})})})]})})}function Yt(){const[e,n]=o.useState(!1),t=(0,o.useMemo)((()=>fe("jira")),[]),s=(0,o.useMemo)((()=>ve("jira")),[]),c=(0,o.useRef)(!1),d=(0,r().v3)(),u=(0,g().r)(),p=(0,a().K8)((()=>y().y.state.currentScreen),[]),m=(0,a().K8)((()=>y().y.state.analyticsFrom),[]),h=(0,a().K8)((()=>y().y.state.sessionId),[]),f=(0,a().K8)((()=>v().zD.isAiConnectorEnabled("jira")),[]),S=d.currentUser.id,x=(0,_().P9)({name:"ai_connectors",spaceId:u,userId:S}),j=(0,Mt().$)(),C=(0,de().J)(),I="introduction"===p,w=(0,a().K8)((()=>i().default.getConfigKey("jira_ai_ingestion_config","learnMoreUrl")),[]);return(0,o.useEffect)((()=>{u&&C&&"introduction"===p&&(c.current||((0,b().u)({environment:d,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"jira",setup_session_id:h,from:m,is_space_admin:C,is_ai_eligible:x??!1}}}),c.current=!0))}),[u,d,p,h,m,C,x]),f?d.device.isMobile?(0,U.jsx)(_e,{connectorType:"jira",open:I,onClosed:()=>{y().y.reset()},learnMoreUrl:w}):C?(0,U.jsx)(ke,{connectorType:"jira",notes:t,onLearnMore:()=>{window.open(w,"_blank")},onConnect:async()=>{u&&j&&await async function(e,n,t,o,s,r){(0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect",integration_type:"jira",setup_session_id:o,from:s}}}),r(!0),(0,l().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"jira",moment:"started"});const a=await(0,l().getJiraAIConnectionStatusAction)({environment:e,spaceId:t});if(a){const{connectionState:n}=a;if("not_started"===n.status){(0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_screen_open",integration_type:"jira",setup_session_id:o,from:s}}});if("success"===(await hn().callApi({eventName:"addNotionInfoForJiraAIConnection",environment:e,data:{spaceId:t}})).type){(0,l().navigateToJiraUniversalScreen)({screenToShow:"check_connection",analyticsFrom:s,sessionId:o});const n=i().default.getConfigKey("jira_ai_ingestion_config","jiraMarketPlaceAppUrl");n&&((0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"app_install_url_opened",integration_type:"jira",setup_session_id:o,from:s}}}),window.open(n,"_blank"))}}else"pending_selection"===n.status?((0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"project_selection_screen_open",integration_type:"jira",setup_session_id:o,from:s}}}),(0,l().navigateToJiraUniversalScreen)({screenToShow:"connection_complete_screen",analyticsFrom:s,sessionId:o})):"in_progress"===n.status||"editing"===n.status?((0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_open",integration_type:"jira",setup_session_id:o,from:s}}}),(0,l().navigateToJiraUniversalScreen)({screenToShow:"settings",analyticsFrom:s,sessionId:o})):"completed"===n.status?((0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"already_connected_screen_open",integration_type:"jira",setup_session_id:o,from:s}}}),(0,l().navigateToJiraUniversalScreen)({screenToShow:"already_connected",analyticsFrom:s,sessionId:o})):(0,l().navigateToJiraUniversalScreen)({screenToShow:"error",analyticsFrom:s,sessionId:o})}r(!1)}(d,0,u,h,m,n)},onDismiss:()=>{(0,b().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_dismiss",integration_type:"jira",setup_session_id:h,from:m}}}),(0,l().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:m,sessionId:h}),c.current=!1},title:s,isLoading:e,open:I}):(0,U.jsx)(Ie,{connector:"jira",handleClose:()=>(0,l().resetAiConnectorStatus)("jira"),open:I,analyticsFrom:m,setupSessionId:h,messages:ye().z$}):(0,U.jsx)(U.Fragment,{})}var Jt=()=>t(831098),Qt=()=>t(496603),$t=()=>t(623580);const Vt=(0,M().YK)({searchForAProject:{id:"universalQnA.jira.searchForAProject",defaultMessage:"Search for a Project"},disabledTooltip:{id:"universalSearch.jira.disabledTooltip",defaultMessage:"You can only interact after all projects are loaded"}});function Xt(){const[e,n]=o.useState(""),[t,s]=o.useState(!1),[i,d]=o.useState(!1),u=(0,a().K8)((()=>y().y.state.syncControl),[]),[p,m]=o.useState([]),[h,v]=o.useState(!0),[f,_]=o.useState(!0),[S,x]=o.useState(0),[j,C]=o.useState(!1),w=function(e){return(0,I().IS)((n=>({wrapper:{width:400,display:"flex",flexDirection:"column",minHeight:530},jiraIcon:{fill:n.blue.icon.accentPrimary,width:40,height:40},jiraSmallIcon:{fill:n.blue.icon.accentPrimary,width:18,height:18},logoSection:{paddingTop:20,paddingInlineEnd:20,paddingBottom:9,paddingInlineStart:20,gap:8,justifyContent:"center",alignItems:"center",height:84},logos:{width:40,height:40},arrowLogo:{width:20,height:20,color:n.icon.secondary},titleWrapper:{width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center"},title:{fontSize:17,fontWeight:T().Wy.medium,lineHeight:"22px",marginBottom:"9px"},subtext:{fontSize:12,lineHeight:"14.52px",color:n.text.secondary},footer:{position:"absolute",width:"100%",justifySelf:"flex-end",boxShadow:"0px 9px 24px 0px #0F0F0F33",paddingTop:16,paddingInlineEnd:20,paddingBottom:16,paddingInlineStart:20,gap:12,bottom:0},connectButton:{fontSize:14,fontWeight:T().Wy.semibold,width:360},searchBarWrapper:{justifyContent:"center"},searchBar:{width:360,padding:4},selectionContainer:{marginTop:18,marginBottom:0,width:"100%",height:"100%",justifyContent:"center",padding:"0px 20px 0px"},selection:{width:"100%"},waitingForConnection:{fontSize:12,lineHeight:"16px",color:n.text.secondary},waitingForConnectionWrapper:{gap:4},tryAgainWrapper:{marginTop:16,gap:4},tryAgainSection:{gap:4,alignItems:"center",marginBottom:16,color:n.text.secondary},tryAgainText:{fontSize:14},channelItem:{gap:4,alignItems:"center"},channelsText:{fontSize:12,lineHeight:"16px",display:"flex",flexDirection:"row",gap:4},divider:{marginTop:5,marginBottom:5},alertIcon:{width:16,height:16},tryAgainButton:{fontSize:12,width:80},futureChannelsCheckboxWrapper:{gap:4,visibility:"visible"},loadingChannelsWrapper:{alignItems:"center",gap:8,fontSize:12,color:n.text.secondary,marginTop:8},selectionWrapper:{overflowY:"scroll",maxHeight:e?170:124},loadMoreButtonWrapper:{fontSize:12,paddingTop:8,paddingBottom:4},loadMoreButtonhoveredStyle:{background:"none"},channelItemWrapper:{marginTop:12},workspaceAdministratorHeading:{fontSize:14,fontWeight:T().Wy.regular,color:n.text.primary},orderedList:{paddingInlineStart:18,fontSize:14,fontWeight:T().Wy.regular,color:n.text.secondary},waitingForConnectionNote:{paddingBottom:4},note:{fontWeight:T().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginInlineStart:8},noteHeading:{fontWeight:T().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:T().Wy.regular,color:n.text.secondary,fontSize:14,lineHeight:"18px"},learnMoreButton:{gap:4,alignItems:"center",fontSize:14,color:n.text.secondary,justifyContent:"center"},buttonContainer:{justifyContent:"center"},link:{color:n.text.secondary,textDecoration:"underline",cursor:"pointer"},loadingChannels:{color:n.text.secondary},loadingWrapper:{alignItems:"center",gap:4}})),[e])}(i),k=(0,a().K8)((()=>y().y.state.analyticsFrom),[]),A=(0,a().K8)((()=>y().y.state.sessionId),[]),N=(0,a().K8)((()=>y().y.state.jiraSiteId),[]),B=(0,a().K8)((()=>y().y.state.currentScreen),[]),P=(0,r().v3)(),E=(0,g().r)(),z=(0,a().O$)(y().y),L="completed"===(0,a().K8)((()=>y().y.state.jiraSyncState),[]),K=(0,o.useCallback)((async()=>{if(!E)return;(0,b().u)({environment:P,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"project_selection_connect_button_clicked",integration_type:"jira",setup_session_id:A,from:k}}});let e,n=[],t=[];if(f?t=p.filter((e=>!e.checked)).map((e=>({id:e.id,name:e.name}))):n=p.filter((e=>e.checked)).map((e=>({id:e.id,name:e.name}))),s(!0),L)e=await(0,l().startJiraEditFlow)({environment:P,spaceId:E,jiraSiteId:N,inclusionList:n,exclusionList:t});else{var o,i;const s=await(0,l().getJiraAIConnectionStatusAction)({environment:P,spaceId:E});if("in_progress"===(null==s||null===(o=s.connectionState)||void 0===o?void 0:o.status)||"completed"===(null==s||null===(i=s.connectionState)||void 0===i?void 0:i.status))return J().D6({label:Mn().A.getIntl().formatMessage({defaultMessage:"Jira is already syncing. This can take up to 36 hours.",id:"jira.sync.started.background.2"}),position:"bottom"}),void(0,l().navigateToJiraUniversalScreen)({analyticsFrom:k,sessionId:A,screenToShow:"none"});e=await(0,l().startJiraBulkIngestionAction)({environment:P,spaceId:E,jiraSiteId:N,sessionId:A,inclusionList:n,exclusionList:t})}e?(0,l().navigateToJiraUniversalScreen)({analyticsFrom:k,screenToShow:"none",sessionId:A}):(0,l().navigateToJiraUniversalScreen)({analyticsFrom:k,screenToShow:"error",sessionId:A}),s(!1)}),[E,f,P,N,p,k,A,L]),H=(0,o.useCallback)((()=>p.find((e=>e.checked))),[p]),G=(0,o.useCallback)((e=>{const n=p.map((n=>n.id===e?{...n,checked:!n.checked}:n));m(n);const t=n.find((e=>e.checked)),o=n.find((e=>!e.checked));let s=!1;t&&o?s="partial":t&&(s=!0),v(s)}),[p]);(0,o.useEffect)((()=>{"select_projects"===B&&(0===u.inclusionList.length&&0===u.exclusionList.length?v(!0):v("partial"),_(0===u.inclusionList.length))}),[B,u]);const q=(0,o.useCallback)((()=>{v(!h),m((e=>e.map((e=>({...e,checked:!h})))))}),[h]),O=(0,o.useCallback)((e=>{const n=p.find((n=>n.id===e));return Boolean(null==n?void 0:n.checked)}),[p]),Y=(0,o.useCallback)((async e=>{if(!E)return;C(!0);const n=await hn().callApi({eventName:"getJiraProjects",environment:P,data:{spaceId:E,jiraSiteId:N,startAt:e}});if("success"===n.type){m((e=>{const t=n.data.projects.map((e=>{let n=!1;return 0===u.inclusionList.length&&0===u.exclusionList.length?n=!0:u.inclusionList.length>0?n=Boolean(u.inclusionList.find((n=>n.id===e.id))):u.exclusionList.length>0&&(n=!u.exclusionList.find((n=>n.id===e.id))),{...e,checked:n}}));return(0,Qt().hS)([...e,...t],(e=>e.id))})),x(n.data.total);const t=e+n.data.projects.length;t>e?Y(t):d(!0)}}),[P,E,N,u]),Q=(0,o.useCallback)((()=>(0,U.jsxs)(W().wt,{children:[(0,U.jsxs)(W().Ye,{style:w.channelItem,children:[(0,U.jsx)(Fe().A,{render:e=>(0,U.jsx)("div",{...e,children:(0,U.jsx)(at().S,{checked:h,size:14,disabled:!i,onClick:()=>{(0,b().u)({environment:P,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:h?"all_projects_deselected":"all_projects_selected",integration_type:"jira",setup_session_id:z.sessionId,from:z.analyticsFrom}}}),q()}})}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:280},children:(0,U.jsx)(M().sA,{...Vt.disabledTooltip})}),disableTooltip:i}),(0,U.jsxs)("div",{style:w.channelsText,children:[(0,Jt().y)(w.jiraSmallIcon),(0,U.jsx)(M().sA,{id:"universalSearch.integration.jiraIngestion.allProjects",defaultMessage:"All projects"})]})]}),(0,U.jsx)(lt().A,{style:w.divider,size:4}),(0,U.jsxs)(U.Fragment,{children:[i?(0,U.jsx)(U.Fragment,{}):(0,U.jsxs)(W().Ye,{style:w.loadingChannelsWrapper,children:[(0,U.jsx)(We().k,{}),(0,U.jsxs)(W().wt,{children:[(0,U.jsx)("div",{children:(0,U.jsx)(M().sA,{id:"universalSearch.integration.jiraIngestion.loadedXProjects",defaultMessage:"{projectsCount} of {totalProjects} projects loaded",values:{projectsCount:p.length,totalProjects:S}})}),(0,U.jsx)("div",{children:(0,U.jsx)(M().sA,{id:"universalSearch.integration.jiraIngestion.loading1000PerMinute",defaultMessage:"This can take one minute per every 1,000 projects."})})]})]}),(0,U.jsx)(W().wt,{style:w.selectionWrapper,children:(e?p.filter((n=>n.name.toLowerCase().includes(e.toLowerCase()))):p).map((e=>(0,U.jsxs)(W().Ye,{gap:8,style:w.channelItemWrapper,children:[(0,U.jsx)(Fe().A,{render:n=>(0,U.jsx)("div",{...n,children:(0,U.jsx)(at().S,{checked:O(e.id),disabled:!i,onClick:()=>{(0,b().u)({environment:P,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:O(e.id)?"specific_project_deselected":"specific_project_selected",integration_type:"jira",setup_session_id:z.sessionId,from:z.analyticsFrom}}}),G(e.id)},size:14},`${e.id}-checkbox`)}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:280},children:(0,U.jsx)(M().sA,{...Vt.disabledTooltip})}),disableTooltip:i}),(0,Jt().y)(w.jiraSmallIcon),(0,U.jsx)("div",{style:w.channelsText,children:` ${e.name}`},`${e.id}-label`)]},e.id)))})]})]})),[w,i,p,S,e,h,P,z.sessionId,z.analyticsFrom,q,O,G]);return(0,c().Yb)((async()=>{E&&N&&"select_projects"===B&&!i&&!j&&await Y(0)}),[E,Y,B,N,i,j]),(0,U.jsx)(D().a,{showCloseIcon:!0,open:"select_projects"===B,onDismiss:()=>{(0,b().u)({environment:P,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_close",integration_type:"jira",setup_session_id:A,from:k}}}),(0,l().navigateToJiraUniversalScreen)({analyticsFrom:k,screenToShow:"none",sessionId:A})},render:()=>(0,U.jsxs)("div",{style:w.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"jira",title:(0,U.jsx)(M().sA,{id:"universalQnA.jira.projectSelectionScreenTitle",defaultMessage:"Select projects to connect"}),subtext:(0,U.jsx)(M().sA,{id:"universalQnA.jira.projectSelectionScreenSubtext",defaultMessage:"Connecting more Jira projects will give you more relevant and useful Notion AI responses"})}),(0,U.jsx)(dt().A,{capture:!0,allowEsc:!0,render:()=>(0,U.jsx)(Fe().A,{textWrap:!0,placement:"top",render:t=>(0,U.jsx)("div",{...t,children:(0,U.jsx)(W().Ye,{...t,style:w.searchBarWrapper,children:(0,U.jsx)($t().A,{id:"jiraUniversalQnASearchBar",style:w.searchBar,disabled:!i,placeholder:Mn().A.formatMessage(Vt.searchForAProject),value:e,onChange:e=>{n(e.target.value),(0,b().u)({environment:P,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"filter_jira_projects",integration_type:"jira",setup_session_id:A,from:k}}})}},"jiraUniversalQnASearchBar")})}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:280},children:(0,U.jsx)(M().sA,{...Vt.disabledTooltip})}),disableTooltip:i})}),(0,U.jsx)(W().Ye,{style:w.selectionContainer,children:(0,U.jsx)(W().wt,{style:w.selection,children:Q()})}),(0,U.jsxs)(W().wt,{style:w.footer,children:[(0,U.jsxs)(W().Ye,{style:w.futureChannelsCheckboxWrapper,children:[(0,U.jsx)(Fe().A,{render:e=>(0,U.jsx)("div",{...e,children:(0,U.jsx)(at().S,{checked:f,disabled:!i,size:14,onClick:()=>{(0,b().u)({environment:P,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:f?"dont_join_future_projects":"join_future_projects",integration_type:"jira",setup_session_id:z.sessionId,from:z.analyticsFrom}}}),_(!f)}})}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:280},children:(0,U.jsx)(M().sA,{...Vt.disabledTooltip})}),disableTooltip:i}),(0,U.jsx)("div",{style:w.channelsText,children:(0,U.jsx)(M().sA,{id:"universalSearch.integration.jiraIngestion.allFutureProjects",defaultMessage:"Add projects created in future"})})]}),(0,U.jsx)(Fe().A,{render:e=>(0,U.jsx)("div",{...e,children:(0,U.jsx)(R().A,{colorPalette:"blue",isLoading:t,style:w.connectButton,onClick:K,disabled:!H()||!i,children:(0,U.jsx)(M().sA,{id:"universalSearch.integration.connect",defaultMessage:"Connect"})})}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:280},children:(0,U.jsx)(M().sA,{...Vt.disabledTooltip})}),disableTooltip:i})]})]})})}const Zt=(0,M().YK)({settingsModalTitle:{id:"universalSearch.jiraIngestion.settingsModalTitle",defaultMessage:"Jira is connected to Notion AI"},settingsModalPendingTitle:{id:"universalSearch.jiraIngestion.settingsModalTitle2",defaultMessage:"Jira is connecting to Notion AI"},settingModalConnectionIsPending:{id:"universalSearch.jiraIngestion.settingsModal.connectionIsPending",defaultMessage:"This can take up to 36h. You can cancel or modify your settings when the connection is complete."},tooltipText:{id:"universalSearch.jiraIngestion.settingsModal.tooltipText",defaultMessage:"You can cancel or modify your settings when the connection is complete. "},learnMoreText:{id:"universalSearch.integration.learnMore",defaultMessage:"Learn more"},editProjectsButton:{id:"universalSearch.jiraIngestion.settingsModal.editSyncControls",defaultMessage:"Edit Projects"},disconnectJira:{id:"universalSearch.jiraIngestion.settingsModal.disconnectJira",defaultMessage:"Disconnect"}});function eo(){const[e,n]=(0,o.useState)(!0),[t,s]=(0,o.useState)([]),[d,u]=(0,o.useState)(!1),[p,m]=(0,o.useState)(0),h=(0,a().O$)(y().y),v=(0,a().K8)((()=>y().y.state.jiraSiteId),[]),f=(0,r().v3)(),_=(0,g().r)(),S=(0,a().K8)((()=>y().y.state.analyticsFrom),[]),x=(0,a().K8)((()=>y().y.state.currentScreen),[]),j=(0,a().K8)((()=>y().y.state.jiraSyncState),[]),C=(0,a().K8)((()=>i().default.getConfigKey("jira_ai_ingestion_config","learnMoreUrl")),[]),k="completed"===j;(0,c().Yb)((async()=>{if(!_||"settings"!==x)return;if(!k)return void n(!1);n(!0);const[e,t]=await Promise.all([(0,l().getJiraAIConnectionStatusAction)({environment:f,spaceId:_}),(0,l().getJiraSyncControlAction)({environment:f,spaceId:_,jiraSiteId:v})]);e&&t&&(s(t.data.sampleProjects),m(t.data.totalConnectedProjects),u(t.data.isFutureProjectsSyncEnabled),n(!1))}),[_,f,x,v,k]);const A=e=>{(0,l().navigateToJiraUniversalScreen)({screenToShow:e,analyticsFrom:h.analyticsFrom,sessionId:h.sessionId})},N=function(e){return(0,I().IS)((n=>({wrapper:{width:400,padding:"0 24px",minHeight:e?428:void 0},settingsWrapper:{justifyContent:"center",gap:12},jiraDetailsContainer:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.regular,color:n.text.secondary,gap:12,paddingBottom:12},projectNameContainer:{gap:2,color:n.text.primary},footer:{justifyContent:"center",alignItems:"center",width:"100%",gap:8},disconnectButton:{width:"100%"},moreProjectsContainer:{paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},learnMoreSection:{padding:"24px 0"},learnMoreButton:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:T().Wy.medium,fontSize:T().J.UISmall.desktop,gap:5,justifyContent:"center",alignItems:"center",paddingTop:4,paddingInlineEnd:8,paddingBottom:4,paddingInlineStart:8,color:`${n.text.secondary}`},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:T().Wy.semibold,color:n.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.regular,color:n.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.regular,color:n.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,justifyContent:"center",alignItems:"center"},projectItemWrapper:{width:"100%",paddingTop:2,paddingInlineEnd:0,paddingBottom:2,paddingInlineStart:0,alignItems:"center"},projectName:{fontSize:T().J.UIRegular.desktop},projectIcon:{width:20,color:n.text.secondary},jiraIcon:{fill:n.blue.icon.accentPrimary,width:40,height:40},jiraIconSmall:{fill:n.blue.icon.accentPrimary,width:14,height:14}})),[e])}(e);return(0,U.jsx)(D().a,{showCloseIcon:!0,open:"settings"===x,onDismiss:()=>{(0,l().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:S,sessionId:h.sessionId}),s([]),m(0),u(!1)},render:()=>(0,U.jsxs)("div",{style:N.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"jira",title:k?(0,U.jsx)(M().sA,{...Zt.settingsModalTitle}):(0,U.jsx)(M().sA,{...Zt.settingsModalPendingTitle})}),e?(0,U.jsx)(W().Ye,{style:N.spinner,children:(0,U.jsx)(We().k,{})}):(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(W().Ye,{style:N.settingsWrapper,children:(0,U.jsxs)(W().wt,{style:N.jiraDetailsContainer,children:[(0,U.jsx)(W().wt,{children:k?(0,U.jsx)(M().sA,{id:"universalSearch.jiraIngestion.settingsModal.canAnswerFrom",defaultMessage:"Notion AI is connected and can answer questions with content from {jiraCountMessage}{futureProjectsMessage}",values:{jiraCountMessage:p?`${p} Jira Projects`:"Jira Project",futureProjectsMessage:d?", including future projects.":"."}}):(0,U.jsx)(M().sA,{...Zt.settingModalConnectionIsPending})}),k?(0,U.jsx)(W().wt,{children:d?(0,U.jsxs)(W().Ye,{style:N.projectItemWrapper,children:[(0,U.jsx)(W().wt,{style:N.projectIcon,children:(0,Jt().y)(N.jiraIconSmall)}),(0,U.jsx)(W().wt,{style:N.projectName,children:(0,U.jsx)("div",{children:(0,U.jsx)(M().sA,{id:"universalSearch.jiraIngestion.settingsModal.includeCurrentAndFutureProjects",defaultMessage:"Includes current and future projects"})})})]}):void 0}):null,k?t.map((e=>(0,U.jsx)("div",{children:(0,U.jsxs)(W().Ye,{style:N.projectItemWrapper,children:[(0,U.jsx)(W().wt,{style:N.projectIcon,children:(0,Jt().y)(N.jiraIconSmall)}),(0,U.jsx)(W().wt,{style:N.projectName,children:e.name})]})},e.id))):void 0,k?(0,U.jsx)(W().Ye,{style:N.moreProjectsContainer,children:p-3>0?(0,U.jsx)(M().sA,{id:"universalSearch.jiraIngestion.settingsModal.moreProjects",defaultMessage:"... and {moreProjectCount} more",values:{moreProjectCount:p-3}}):(0,U.jsx)(U.Fragment,{})}):void 0]})}),(0,U.jsxs)(W().wt,{style:N.footer,children:[k?(0,U.jsx)(no,{styles:N.disconnectButton,isEditButtonEnabled:!1,navigateToScreen:A}):(0,U.jsx)(Fe().A,{allowHover:!0,textWrap:!0,renderTooltip:()=>(0,U.jsx)("div",{style:{width:240},children:(0,U.jsx)(M().sA,{...Zt.tooltipText})}),render:e=>(0,U.jsx)(no,{events:e,styles:N.disconnectButton,isEditButtonEnabled:!1,navigateToScreen:()=>{}})}),k?(0,U.jsx)(to,{styles:N.disconnectButton,isDisconnectButtonEnabled:k,navigateToScreen:A}):(0,U.jsx)(Fe().A,{allowHover:!0,textWrap:!0,renderTooltip:()=>(0,U.jsx)("div",{style:{width:240},children:(0,U.jsx)(M().sA,{...Zt.tooltipText})}),render:e=>(0,U.jsx)(to,{events:e,styles:N.disconnectButton,isDisconnectButtonEnabled:k,navigateToScreen:A})})]}),(0,U.jsx)(W().Ye,{style:N.learnMoreSection,children:(0,U.jsx)(w().Ay,{style:N.learnMoreButton,onClick:()=>{(0,b().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_learn_more_url_click",integration_type:"jira",setup_session_id:h.sessionId,from:h.analyticsFrom}}}),window.open(C,"_blank")},children:(0,U.jsxs)(W().Ye,{style:N.learnMoreText,children:[(0,U.jsx)(M().sA,{...Zt.learnMoreText}),(0,U.jsx)(De().I,{icon:Pe().arrowUpRightSquareSmallIcon,size:"sm"})]})})})]})]})})}function no(e){const{styles:n,events:t,isEditButtonEnabled:o,navigateToScreen:s}=e,i=(0,r().v3)(),c=(0,a().O$)(y().y);return(0,U.jsx)(H().A,{...t,size:"lg",style:n,disabled:!o,onClick:()=>{(0,b().u)({environment:i,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_edit_projects_button",integration_type:"jira",setup_session_id:c.sessionId,from:c.analyticsFrom}}}),s("select_projects")},children:(0,U.jsx)(M().sA,{...Zt.editProjectsButton})})}function to(e){const{styles:n,events:t,isDisconnectButtonEnabled:o,navigateToScreen:s}=e,i=(0,r().v3)(),c=(0,a().O$)(y().y),l=(0,g().r)();(0,a().K8)((()=>y().y.state.jiraSyncState),[]);return(0,U.jsx)(Be().E,{...t,style:n,disabled:!o,onClick:()=>{l&&((0,b().u)({environment:i,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_disconnect_button",integration_type:"jira",setup_session_id:c.sessionId,from:c.analyticsFrom}}}),s("disconnect_screen"))},children:(0,U.jsx)(M().sA,{...Zt.disconnectJira})})}t(16280);var oo=()=>t(765974),so=()=>t(874480),io=()=>t(903706),ro=()=>t(479350);const ao=(0,M().YK)({tokenPlaceholder:{id:"universalQnA.jira.authScreen.tokenPlaceholder",defaultMessage:"Paste your API Token here"},siteUrlPlaceholder:{id:"universalQnA.jira.authScreen.siteUrlPlaceholder",defaultMessage:"https://your-company.atlassian.net"},createTokenLink:{id:"universalQnA.jira.authScreen.createTokenLink",defaultMessage:"Create API Token"}});function co(){const[e,n]=(0,o.useState)(""),[t,s]=(0,o.useState)(""),[c,l]=(0,o.useState)(!1),d=(0,g().r)(),u=(0,r().v3)(),p=(0,M().tz)(),m=(0,a().K8)((()=>ro().E.state.sessionId),[]),h=(0,a().K8)((()=>ro().E.state.analyticsFrom),[]),v=(0,a().K8)((()=>ro().E.state.currentScreen),[]),f=(0,a().K8)((()=>i().default.getConfigKey("jira_ingestion_config_v2","learnMoreUrl")),[]),y=(0,I().IS)((e=>({noteHeading:{fontWeight:T().Wy.medium,fontSize:T().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{marginTop:8,fontWeight:T().Wy.regular,color:e.text.secondary,fontSize:T().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,cursor:"pointer",textDecoration:"underline",fontSize:T().J.UISmall.desktop,marginInlineStart:3},inputContainer:{marginTop:8},input:{width:"100%"},bulletPoint:{marginTop:4,marginBottom:4,position:"relative",paddingInlineStart:8},bulletPointText:{fontSize:T().J.UISmall.desktop,lineHeight:"16px",lineBreak:"anywhere"},bulletDot:{position:"absolute",insetInlineStart:-4,top:6,width:4,height:4,borderRadius:"50%",backgroundColor:"#9B9A97"},warningText:{fontSize:T().J.UIRegular.desktop,lineHeight:"18px",color:"#D7813A",paddingInlineStart:14,fontWeight:T().Wy.regular},warningContainer:{marginInlineStart:5,marginInlineEnd:5,marginBottom:15},warningIcon:{width:18,height:17,color:"#D7813A",marginTop:2}})),[]),_=(0,o.useCallback)((async()=>{try{if((0,b().u)({environment:u,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"jira_auth_submit",integration_type:"jira",setup_session_id:m,from:h}}}),!d)throw new Error("Space ID is required");if("failed"===(await so().R({environment:u,spaceId:d,jiraApiToken:t,jiraSiteUrl:e})).status)return void l(!0);l(!1),ro().E.setState({...ro().E.state,currentScreen:"connection_complete_screen",jiraSyncState:"pending_selection"})}catch(n){l(!0)}}),[h,u,m,d,t,e]),S=(0,a().K8)((()=>i().default.getConfigKey("jira_ingestion_config_v2","createTokenHelpUrl")),[]),x=c?(0,U.jsxs)(W().Ye,{style:y.warningContainer,children:[(0,oo().exclamationMarkTriangleFillIcon)(y.warningIcon),(0,U.jsx)("div",{style:y.warningText,children:(0,U.jsx)(M().sA,{id:"universalQnA.jira.authScreen.warning",defaultMessage:"We couldn’t authenticate with the provided credentials. Please check your Jira Site URL and API Token and try again."})})]}):void 0;return d?(0,U.jsx)(q,{title:(0,U.jsx)(M().sA,{id:"universalQnA.jira.authScreen.title",defaultMessage:"Step 2: Create a Forge App"}),subText:(0,U.jsx)(M().sA,{id:"universalQnA.jira.authScreen.description",defaultMessage:"We’ll help you create an Atlassian Forge App with the credentials below"}),open:"auth_input_screen"===v,onDismiss:()=>{l(!1),(0,b().u)({environment:u,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_dismiss",integration_type:"jira",setup_session_id:m,from:h}}}),ro().E.setState({...ro().E.state,currentScreen:"none"})},warningMessage:x,connectorType:"jira",primaryButtonText:(0,U.jsx)(M().sA,{id:"universalQnA.jira.authScreen.createAppButton",defaultMessage:"Create app"}),onClickPrimaryButton:_,openLearnMoreUrl:()=>{window.open(f,"_blank")},notes:[(0,U.jsxs)(W().wt,{children:[(0,U.jsx)("div",{style:y.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalQnA.jira.authScreen.siteUrlTitle",defaultMessage:"Paste your Jira Site URL"})}),(0,U.jsx)("div",{style:y.inputContainer,children:(0,U.jsx)(io().A,{value:e,onChange:e=>n(e.target.value),placeholder:p.formatMessage(ao.siteUrlPlaceholder),style:y.input,showClearButton:!0})})]},"note-1"),(0,U.jsxs)(W().wt,{children:[(0,U.jsx)("div",{style:y.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalQnA.jira.authScreen.createTokenTitle",defaultMessage:"Create an API Token in Atlassian"})}),(0,U.jsxs)("div",{style:y.noteBody,children:[(0,U.jsxs)("div",{style:y.bulletPoint,children:[(0,U.jsx)("div",{style:y.bulletDot}),(0,U.jsx)("div",{style:y.bulletPointText,children:(0,U.jsx)(M().sA,{id:"universalQnA.jira.authScreen.createTokenStep1",defaultMessage:"Log in to:{tokenLink}",values:{tokenLink:(0,U.jsx)("a",{href:S,target:"_blank",rel:"noopener noreferrer",style:y.link,onClick:()=>{(0,b().u)({environment:u,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"input_subtext_link_click",integration_type:"jira",setup_session_id:m,from:h}}})},children:S})}})})]}),(0,U.jsxs)("div",{style:y.bulletPoint,children:[(0,U.jsx)("div",{style:y.bulletDot}),(0,U.jsx)("div",{style:y.bulletPointText,children:(0,U.jsx)(M().sA,{id:"universalQnA.jira.authScreen.createTokenStep2",defaultMessage:"Select {createTokenLink}",values:{createTokenLink:(0,U.jsx)("span",{style:{fontWeight:T().Wy.medium},children:p.formatMessage(ao.createTokenLink)})}})})]}),(0,U.jsxs)("div",{style:y.bulletPoint,children:[(0,U.jsx)("div",{style:y.bulletDot}),(0,U.jsx)("div",{style:y.bulletPointText,children:(0,U.jsx)(M().sA,{id:"universalQnA.jira.authScreen.createTokenStep3",defaultMessage:"Give your token a name and expiration date of 1 year"})})]})]})]},"note-2"),(0,U.jsxs)(W().wt,{children:[(0,U.jsx)("div",{style:y.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalQnA.jira.authScreen.pasteTokenTitle",defaultMessage:"Paste your API Token here"})}),(0,U.jsx)("div",{style:y.inputContainer,children:(0,U.jsx)(io().A,{value:t,onChange:e=>s(e.target.value),placeholder:p.formatMessage(ao.tokenPlaceholder),style:y.input,type:"password",showClearButton:!0})})]},"note-3")]}):null}const lo=K().w0.jira;function uo(){const e=(0,a().K8)((()=>ro().E.state.currentScreen),[]),n=(0,g().r)(),t=(0,r().v3)(),s=(0,a().K8)((()=>ro().E.state.analyticsFrom),[]),i=(0,a().K8)((()=>ro().E.state.sessionId),[]),c=(0,o.useCallback)((()=>{ro().E.setState({...ro().E.state,currentScreen:"settings"})}),[]),l=(0,o.useCallback)((async()=>{if(!n)return;await so().vq({environment:t,spaceId:n,projectSelection:{allProjects:!0,includedProjects:[],excludedProjects:[],includeFutureProjects:!0}})&&(await so().Zh({environment:t,spaceId:n,analyticsProperties:{analyticsFrom:s,buttonName:"start_ingestion",sessionId:i}}),ro().E.setState({...ro().E.state,currentScreen:"none"}))}),[n,t,s,i]);return(0,U.jsx)(V,{open:"connection_complete_screen"===e,onDismiss:()=>{},connectorType:"jira",notes:[(0,U.jsx)(X,{number:1,title:{...{...$.connectionInProgressTitle,values:{appName:lo}}},description:$.defaultConnectionTime},"item1"),(0,U.jsx)(X,{number:2,title:{...{...$.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:lo}}}},"item2")],onEditSettingsClick:c,onPrimaryButtonClick:l})}function go(){const e=(0,M().tz)(),n=(0,I().IS)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:T().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.medium,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{paddingTop:12,paddingInlineEnd:12,paddingBottom:12,paddingInlineStart:12,gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:T().Wy.regular,fontSize:T().J.UIRegular.desktop,lineHeight:"18px"},noteHeading:{fontWeight:T().Wy.medium,fontSize:T().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{fontWeight:T().Wy.regular,color:e.text.secondary,fontSize:T().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{rotate:"45deg",width:12,height:12,cursor:"pointer",display:"inline",padding:0,margin:0}})),[]),[t,s]=(0,o.useState)(!1),i=(0,a().K8)((()=>ro().E.state.currentScreen),[]),c=(0,a().K8)((()=>ro().E.state.analyticsFrom),[]),l=(0,a().K8)((()=>ro().E.state.sessionId),[]),d=(0,g().r)(),u=(0,r().v3)(),p=(0,o.useCallback)((()=>{so().G({analyticsFrom:c,screenToShow:"none",sessionId:l})}),[c,l]),m=(0,o.useCallback)((()=>{}),[]),h=(0,o.useCallback)((async()=>{s(!0),d&&(await so().Rr({environment:u,spaceId:d}),so().G({analyticsFrom:c,screenToShow:"none",sessionId:l}),s(!1))}),[c,u,l,d]),v=(0,o.useCallback)((()=>{so().G({analyticsFrom:c,screenToShow:"settings",sessionId:l})}),[c,l]),f=(0,o.useCallback)((()=>{const{noteBlockWrapper:e,noteHeading:t,noteBody:o}=n;return[(0,U.jsxs)(W().wt,{style:e,children:[(0,U.jsx)("div",{style:t,children:(0,U.jsx)(M().sA,{...po.note1Heading})}),(0,U.jsx)("div",{style:o,children:(0,U.jsx)(M().sA,{...po.note1Body})})]},"note-1")]}),[n]);return"post_disconnect"===i?(0,U.jsx)(oe,{onClickGotItBtn:m,onDismiss:p,open:"post_disconnect"===i,connectorType:"jira",title:(0,U.jsx)(M().sA,{...po.postDisconnectTitle}),descriptionMessage:(0,U.jsx)(M().sA,{...po.postDisconnectDescription}),message:(0,U.jsx)("div",{style:n.notesSectionWrapper,children:f().map(((e,t)=>(0,U.jsx)(W().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:(0,U.jsx)("div",{style:n.note,children:e})},t)))})}):(0,U.jsx)(D().a,{showCloseIcon:!0,open:"disconnect_screen"===i,onDismiss:p,render:()=>(0,U.jsx)("div",{style:n.confirmWrapper,children:(0,U.jsxs)("div",{style:n.confirmContainer,children:[(0,U.jsx)("div",{style:n.confirmModalTitle,children:(0,U.jsx)(M().sA,{...po.disconnectTitle})}),(0,U.jsx)("div",{style:n.confirmModalSubTitle,children:(0,U.jsx)(M().sA,{...po.disconnectSubTitle})}),(0,U.jsx)("div",{style:n.confirmModalDescription,children:(0,U.jsx)(M().sA,{...po.disconnectDescription})}),(0,U.jsxs)(W().wt,{style:n.confirmModalActionButtons,children:[(0,U.jsx)(R().A,{colorPalette:"red",style:n.confirmDisconnectButton,isLoading:t,onClick:h,children:(0,U.jsx)(M().sA,{...po.primaryButtonLabel})}),(0,U.jsx)(w().Ay,{style:n.goBackButton,onClick:v,children:(0,U.jsx)(M().sA,{...po.goBackButtonLabel})})]})]})}),ariaLabel:e.formatMessage(po.disconnectModalAriaLabel)})}const po=(0,M().YK)({note1Heading:{id:"universalSearch.jira.postDisconnect.note_1.heading",defaultMessage:"Jira data will be permanently deleted from Notion"},note1Body:{id:"universalSearch.jira.postDisconnect.note_1.body",defaultMessage:"This process can take up to 3 hours. You’ll only be able to reconnect after disconnecting is complete."},postDisconnectTitle:{id:"universalSearch.jira.postDisconnect.title",defaultMessage:"Jira is disconnecting from Notion AI"},postDisconnectDescription:{id:"universalSearch.jira.postDisconnect.description",defaultMessage:"Here’s what you should know:"},disconnectTitle:{id:"universalSearch.jira.disconnectModal.title",defaultMessage:"Are you sure?"},disconnectSubTitle:{id:"universalSearch.jira.disconnectModal.subTitle",defaultMessage:"Jira data will be permanently deleted from Notion."},disconnectDescription:{id:"universalSearch.jira.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."},primaryButtonLabel:{id:"universalSearch.jira.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"},goBackButtonLabel:{id:"universalSearch.jira.disconnectModal.goBack",defaultMessage:"Go back"},disconnectModalAriaLabel:{id:"universalSearch.jira.disconnectModal.label",defaultMessage:"Disconnect Jira Modal"}});function mo(){return(0,U.jsx)(re,{connector:"jira",screenName:"error"})}async function ho(e){const{environment:n,spaceId:t}=e,o=await hn().callApi({eventName:"checkMarketplaceInstallation",environment:n,data:{spaceId:t}});return"failed"!==o.type&&o.data.isInstalled}function vo(){const[e,n]=o.useState(!1),t=(0,r().v3)(),s=(0,I().IS)((e=>({noteHeading:{fontWeight:T().Wy.medium,fontSize:T().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{fontWeight:T().Wy.regular,color:e.text.secondary,fontSize:T().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{width:18,height:17,color:"#D7813A",marginTop:2},warningText:{fontSize:T().J.UIRegular.desktop,lineHeight:"18px",color:"#D7813A",paddingInlineStart:14,fontWeight:T().Wy.regular},warningContainer:{marginInlineStart:5,marginInlineEnd:5,marginBottom:15}})),[]),c=(0,a().K8)((()=>ro().E.state.currentScreen),[]),l=(0,a().K8)((()=>ro().E.state.analyticsFrom),[]),d=(0,a().K8)((()=>ro().E.state.sessionId),[]),u=(0,Mt().$)(),p=(0,g().r)(),m=(0,o.useCallback)((async()=>{if(!p)return;(0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_installation_button_clicked",integration_type:"jira",setup_session_id:d,from:l}}});await ho({environment:t,spaceId:p})?so().G({screenToShow:"auth_input_screen",analyticsFrom:l,sessionId:d}):n(!0)}),[l,t,d,p]),h=(0,a().K8)((()=>i().default.getConfigKey("jira_ingestion_config_v2","jiraMarketPlaceAppUrl")),[]),v=(0,a().K8)((()=>i().default.getConfigKey("jira_ingestion_config_v2","learnMoreUrl")),[]);if(!u||!p)return null;const f=e?(0,U.jsxs)(W().Ye,{style:s.warningContainer,children:[(0,oo().exclamationMarkTriangleFillIcon)(s.icon),(0,U.jsx)("div",{style:s.warningText,children:(0,U.jsx)(M().sA,{id:"universalQnA.jira.MarketplaceScreen.warning",defaultMessage:"We couldn’t confirm that the Notion app was installed correctly. Please read the instructions and try again."})})]}):void 0;return(0,U.jsx)(q,{title:(0,U.jsx)(M().sA,{id:"universalQnA.jira.MarketplaceScreen",defaultMessage:"Step 1: Install the Notion app in Jira Marketplace"}),open:"install_marketplace_screen"===c,onDismiss:()=>{n(!1),(0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"marketplace_screen_dismiss",integration_type:"jira",setup_session_id:d,from:l}}}),so().G({screenToShow:"none",analyticsFrom:l,sessionId:d})},warningMessage:f,notes:[(0,U.jsxs)(W().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:s.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.jira.marketplaceShouldOpenHeading",defaultMessage:"Atlassian Marketplace should open automatically on a new browser tab."},"note1-1")}),(0,U.jsx)("div",{style:s.noteBody,children:(0,U.jsx)(M().sA,{id:"universalSearch.jira.marketplaceShouldOpenBody",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,U.jsx)("a",{style:s.link,href:h,target:"_blank",onClick:()=>{(0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"marketplace_screen_open_url",integration_type:"jira",setup_session_id:d,from:l}}})},children:(0,U.jsx)(M().sA,{id:"universalSearch.jira.marketplaceRetryLink",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,U.jsxs)(W().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:s.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.jira.installNotionAppHeading",defaultMessage:"Install the Notion app in your Jira site"},"note2")}),(0,U.jsx)("div",{style:s.noteBody,children:(0,U.jsx)(M().sA,{id:"universalSearch.jira.installNotionAppBody",defaultMessage:"Click ”Get it now”, then grant access to the Jira site of your choice."},"note2-2")})]},"note-2"),(0,U.jsx)(W().wt,{style:{gap:4},children:(0,U.jsx)("div",{style:s.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.jira.whenDoneHeading",defaultMessage:"When you’re done, click the button below"},"note3")})},"note-3")],openLearnMoreUrl:()=>{window.open(v,"_blank")},connectorType:"jira",primaryButtonText:(0,U.jsx)(M().sA,{id:"universalSearch.jira.Button.checkInstallation",defaultMessage:"Check installation"},"note3-1"),onClickPrimaryButton:m})}var fo=()=>t(726637);function yo(){const e=(0,M().tz)(),n=(0,o.useMemo)((()=>ve("jira")),[]),t=(0,o.useMemo)((()=>fe("jira")),[]),s=(0,r().v3)(),[d,u]=(0,o.useState)("CLOSED"),p=(0,g().r)(),m=(0,a().O$)(ro().E),[h,f]=o.useState(!1),y=(0,I().IS)((()=>({loadingWrapper:{padding:20,fontSize:12,fontWeight:T().Wy.regular,justifyContent:"center",gap:8,alignItems:"center"}})),[]),S=(0,a().K8)((()=>ro().E.state.analyticsFrom),[]),x=(0,a().K8)((()=>ro().E.state.sessionId),[]),j=(0,a().K8)((()=>v().zD.isJiraForgeEnabled()),[]),C=s.currentUser.id,w=(0,_().P9)({name:"ai_connectors",spaceId:p,userId:C}),k=(0,de().J)(),A=(0,a().K8)((()=>i().default.getConfigKey("jira_ingestion_config_v2","learnMoreUrl")),[]),[N]=(0,c().Yb)((async()=>{if(!p||"introduction"!==m.currentScreen)return;const e=await hn().callApi({eventName:"listAIConnectors",environment:s,data:{spaceId:p}});return"success"===e.type?{isJiraConnected:e.data.connectedConnectors.map((e=>e.id)).some((e=>"jira"===e))}:void 0}),[s,m.currentScreen,p]);(0,o.useEffect)((()=>{"introduction"===m.currentScreen?"resolved"===N.status?u("OPEN"):u("LOADING"):u("CLOSED")}),[N.status,m.currentScreen]);const B=(0,o.useRef)(!1);(0,o.useEffect)((()=>{p&&k&&"resolved"===N.status&&"introduction"===m.currentScreen&&(B.current||((0,b().u)({environment:s,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"jira",setup_session_id:x,from:S,is_space_admin:k,is_ai_eligible:w??!1}}}),B.current=!0))}),[p,s,x,m.currentScreen,S,k,w,N.status]);const P=(0,o.useCallback)((()=>{ro().E.reset(),(0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_jira_intro_modal",integration_type:"jira",setup_session_id:ro().E.state.sessionId,from:ro().E.state.analyticsFrom}}}),B.current=!1}),[s]),F=(0,o.useCallback)((async()=>{if(!p)return;(0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect",integration_type:"jira",setup_session_id:ro().E.state.sessionId,from:ro().E.state.analyticsFrom}}}),f(!0);"failed"!==(await(0,l().updateJiraAIV2ConnectionStatus)({environment:s,spaceId:p})).status?"pending_selection"!==m.jiraSyncState?("not_started"===m.jiraSyncState&&await async function(e){const{environment:n,spaceId:t,setupSessionId:o,analyticsFrom:s}=e,r=await ho({environment:n,spaceId:t});if(r)return void so().G({screenToShow:"auth_input_screen",analyticsFrom:s,sessionId:o});const a=await(0,l().addNotionInfoForJiraAIConnection)({environment:n,spaceId:t});if("success"===a.status){so().G({analyticsFrom:s,sessionId:o,screenToShow:"install_marketplace_screen"});const e=i().default.getConfigKey("jira_ingestion_config_v2","jiraMarketPlaceAppUrl");return void(e&&window.open(e,"_blank"))}so().G({analyticsFrom:s,sessionId:o,screenToShow:"error"})}({environment:s,spaceId:p,setupSessionId:x,analyticsFrom:S}),f(!1)):so().G({analyticsFrom:S,sessionId:x,screenToShow:"connection_complete_screen"}):so().G({analyticsFrom:S,sessionId:x,screenToShow:"error"})}),[s,p,x,S,m.jiraSyncState]);return j&&p&&"CLOSED"!==d?fo().A.isMobile?(0,U.jsx)(_e,{connectorType:"jira",open:"introduction"===m.currentScreen,onClosed:()=>{ro().E.reset()},learnMoreUrl:A}):"LOADING"===d?(0,U.jsx)(D().a,{ariaLabel:e.formatMessage({id:"jira.oauthPopupTitle.ariaLabel",defaultMessage:"Loading Jira AI connector status"}),open:"LOADING"===d,render:()=>(0,U.jsxs)(W().Ye,{style:y.loadingWrapper,children:[(0,U.jsx)(M().sA,{id:"universalQna.jira.isFetchingConnection",defaultMessage:"Getting connection status"}),(0,U.jsx)(We().k,{})]})}):k?(0,U.jsx)(ke,{connectorType:"jira",notes:t,onLearnMore:()=>{window.open(A,"_blank")},onConnect:F,onDismiss:P,title:n,isLoading:h,open:"OPEN"===d}):(0,U.jsx)(Ie,{connector:"jira",handleClose:()=>(0,l().resetAiConnectorStatus)("jira"),open:"OPEN"===d,analyticsFrom:S,setupSessionId:x,messages:ye().z$}):null}const _o=(0,M().YK)({searchForAProject:{id:"universalQnA.jira.searchForAProject",defaultMessage:"Search for a Project"},disabledTooltip:{id:"universalSearch.jira.disabledTooltip",defaultMessage:"You can only interact after all projects are loaded"}});function So(){const[e,n]=o.useState(""),[t,s]=o.useState(!1),[i,l]=o.useState(!1),[d,u]=o.useState({allProjects:!0,includedProjects:[],excludedProjects:[],includeFutureProjects:!0}),[p,m]=o.useState([]),[h,v]=o.useState(!0),[f,y]=o.useState(!0),[_,S]=o.useState(0),[x,j]=o.useState(!1),C=function(e){return(0,I().IS)((n=>({wrapper:{width:400,display:"flex",flexDirection:"column",minHeight:530},jiraIcon:{fill:n.blue.icon.accentPrimary,width:40,height:40},jiraSmallIcon:{fill:n.blue.icon.accentPrimary,width:18,height:18},logoSection:{paddingTop:20,paddingInlineEnd:20,paddingBottom:9,paddingInlineStart:20,gap:8,justifyContent:"center",alignItems:"center",height:84},logos:{width:40,height:40},arrowLogo:{width:20,height:20,color:n.icon.secondary},titleWrapper:{width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center"},title:{fontSize:17,fontWeight:T().Wy.medium,lineHeight:"22px",marginBottom:"9px"},subtext:{fontSize:12,lineHeight:"14.52px",color:n.text.secondary},footer:{width:"100%",justifySelf:"flex-end",boxShadow:"0px 9px 24px 0px #0F0F0F33",paddingTop:16,paddingInlineEnd:20,paddingBottom:16,paddingInlineStart:20,gap:12},connectButton:{fontSize:14,fontWeight:T().Wy.semibold,width:360},searchBarWrapper:{justifyContent:"center"},searchBar:{width:360,padding:4},selectionContainer:{marginTop:18,marginBottom:0,width:"100%",height:"100%",justifyContent:"center",padding:"0px 20px 0px",flexGrow:1},selection:{width:"100%"},waitingForConnection:{fontSize:12,lineHeight:"16px",color:n.text.secondary},waitingForConnectionWrapper:{gap:4},tryAgainWrapper:{marginTop:16,gap:4},tryAgainSection:{gap:4,alignItems:"center",marginBottom:16,color:n.text.secondary},tryAgainText:{fontSize:14},channelItem:{gap:4,alignItems:"center"},channelsText:{fontSize:12,lineHeight:"16px",display:"flex",flexDirection:"row",gap:4},divider:{marginTop:5,marginBottom:5},alertIcon:{width:16,height:16},tryAgainButton:{fontSize:12,width:80},futureChannelsCheckboxWrapper:{gap:4,visibility:"visible"},loadingChannelsWrapper:{alignItems:"center",gap:8,fontSize:12,color:n.text.secondary,marginTop:8},selectionWrapper:{overflowY:"scroll",maxHeight:e?170:124},loadMoreButtonWrapper:{fontSize:12,paddingTop:8,paddingBottom:4},loadMoreButtonhoveredStyle:{background:"none"},channelItemWrapper:{marginTop:12},workspaceAdministratorHeading:{fontSize:14,fontWeight:T().Wy.regular,color:n.text.primary},orderedList:{paddingInlineStart:18,fontSize:14,fontWeight:T().Wy.regular,color:n.text.secondary},waitingForConnectionNote:{paddingBottom:4},note:{fontWeight:T().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginInlineStart:8},noteHeading:{fontWeight:T().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:T().Wy.regular,color:n.text.secondary,fontSize:14,lineHeight:"18px"},learnMoreButton:{gap:4,alignItems:"center",fontSize:14,color:n.text.secondary,justifyContent:"center"},buttonContainer:{justifyContent:"center"},link:{color:n.text.secondary,textDecoration:"underline",cursor:"pointer"},loadingChannels:{color:n.text.secondary},loadingWrapper:{alignItems:"center",gap:4}})),[e])}(i),w=(0,a().K8)((()=>ro().E.state.analyticsFrom),[]),k=(0,a().K8)((()=>ro().E.state.sessionId),[]),A=(0,a().K8)((()=>ro().E.state.currentScreen),[]),N=(0,r().v3)(),B=(0,g().r)(),P=(0,M().tz)(),E=(0,a().O$)(ro().E),z="completed"===(0,a().K8)((()=>ro().E.state.jiraSyncState),[]),[L,K]=o.useState(!1),G=(0,o.useCallback)((async()=>{if(!B)return;(0,b().u)({environment:N,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"project_selection_connect_button_clicked",integration_type:"jira",setup_session_id:k,from:w}}});let e=[],n=[];f?n=p.filter((e=>!e.checked)).map((e=>e.id)):e=p.filter((e=>e.checked)).map((e=>e.id)),s(!0);await so().vq({environment:N,spaceId:B,projectSelection:{allProjects:!0===h,includedProjects:e,excludedProjects:n,includeFutureProjects:f}})?(z?await so().zn({environment:N,spaceId:B}):await so().Zh({environment:N,spaceId:B,analyticsProperties:{analyticsFrom:w,buttonName:"project_selection_connect_button_clicked",sessionId:k}}),so().G({analyticsFrom:w,screenToShow:"none",sessionId:k}),s(!1)):s(!1)}),[B,f,N,p,h,w,k,z]),q=(0,o.useCallback)((()=>{B?((0,b().u)({environment:N,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_jira_button_clicked",integration_type:"jira",setup_session_id:k,from:w}}}),so().G({analyticsFrom:w,screenToShow:"disconnect_screen",sessionId:k})):so().G({analyticsFrom:w,screenToShow:"none",sessionId:k})}),[B,N,w,k]),O=(0,o.useCallback)((()=>p.find((e=>e.checked))),[p]),Y=(0,o.useCallback)((e=>{const n=p.map((n=>n.id===e?{...n,checked:!n.checked}:n));m(n);const t=n.find((e=>e.checked)),o=n.find((e=>!e.checked));let s=!1;t&&o?s="partial":t&&(s=!0),v(s)}),[p]);(0,o.useEffect)((()=>{"settings"===A&&(d.allProjects?v(!0):v("partial"),y(d.includeFutureProjects))}),[A,d]);const J=(0,o.useCallback)((()=>{v(!h),m((e=>e.map((e=>({...e,checked:!h})))))}),[h]),Q=(0,o.useCallback)((e=>{const n=p.find((n=>n.id===e));return Boolean(null==n?void 0:n.checked)}),[p]),$=(0,o.useCallback)((async(e,n)=>{if(!B)return;j(!0);const t=await hn().callApi({eventName:"getJiraProjectsV2",environment:N,data:{spaceId:B,startAt:e}});if("success"===t.type){m((e=>{const o=t.data.projects.map((e=>{var t,o;let s=!1;return 0===(null===(t=n.includedProjects)||void 0===t?void 0:t.length)&&0===(null===(o=n.excludedProjects)||void 0===o?void 0:o.length)?s=!0:n.includedProjects.length>0?s=Boolean(n.includedProjects.find((n=>n===e.id))):n.excludedProjects.length>0&&(s=!n.excludedProjects.find((n=>n===e.id))),{...e,checked:s}}));return(0,Qt().hS)([...e,...o],(e=>e.id))})),S(t.data.total);const o=e+t.data.projects.length;o<t.data.total?$(o,n):l(!0)}}),[N,B]),V=(0,o.useCallback)((()=>(0,U.jsxs)(W().wt,{children:[(0,U.jsxs)(W().Ye,{style:C.channelItem,children:[(0,U.jsx)(Fe().A,{render:e=>(0,U.jsx)("div",{...e,children:(0,U.jsx)(at().S,{checked:h,size:14,disabled:!i,onClick:()=>{(0,b().u)({environment:N,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:h?"all_projects_deselected":"all_projects_selected",integration_type:"jira",setup_session_id:E.sessionId,from:E.analyticsFrom}}}),J()}})}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:280},children:(0,U.jsx)(M().sA,{..._o.disabledTooltip})}),disableTooltip:i}),(0,U.jsxs)("div",{style:C.channelsText,children:[(0,Jt().y)(C.jiraSmallIcon),(0,U.jsx)(M().sA,{id:"universalSearch.integration.jiraIngestion.allProjects",defaultMessage:"All projects"})]})]}),(0,U.jsx)(lt().A,{style:C.divider,size:4}),(0,U.jsxs)(U.Fragment,{children:[i?null:(0,U.jsxs)(W().Ye,{style:C.loadingChannelsWrapper,children:[(0,U.jsx)(We().k,{}),(0,U.jsxs)(W().wt,{children:[(0,U.jsx)("div",{children:(0,U.jsx)(M().sA,{id:"universalSearch.integration.jiraIngestion.loadedXProjects",defaultMessage:"{projectsCount} of {totalProjects} projects loaded",values:{projectsCount:p.length,totalProjects:_}})}),(0,U.jsx)("div",{children:(0,U.jsx)(M().sA,{id:"universalSearch.integration.jiraIngestion.loading1000PerMinute",defaultMessage:"This can take one minute per every 1,000 projects."})})]})]}),(0,U.jsx)(W().wt,{style:C.selectionWrapper,children:(e?p.filter((n=>n.name.toLowerCase().includes(e.toLowerCase()))):p).map((e=>(0,U.jsxs)(W().Ye,{gap:8,style:C.channelItemWrapper,children:[(0,U.jsx)(Fe().A,{render:n=>(0,U.jsx)("div",{...n,children:(0,U.jsx)(at().S,{checked:Q(e.id),disabled:!i,onClick:()=>{(0,b().u)({environment:N,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:Q(e.id)?"specific_project_deselected":"specific_project_selected",integration_type:"jira",setup_session_id:E.sessionId,from:E.analyticsFrom}}}),Y(e.id)},size:14},`${e.id}-checkbox`)}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:280},children:(0,U.jsx)(M().sA,{..._o.disabledTooltip})}),disableTooltip:i}),(0,Jt().y)(C.jiraSmallIcon),(0,U.jsx)("div",{style:C.channelsText,children:` ${e.name}`},`${e.id}-label`)]},e.id)))})]})]})),[C,i,p,_,e,h,N,E.sessionId,E.analyticsFrom,J,Q,Y]);return(0,c().Yb)((async()=>{if(!z||!B||"settings"!==A)return;const e=await so().Df({environment:N,spaceId:B});e&&u(e),K(!0)}),[z,N,B,A]),(0,c().Yb)((async()=>{!B||"settings"!==A||i||x||z&&!L||await $(0,d)}),[B,$,A,i,x,z,L,d]),(0,U.jsx)(D().a,{showCloseIcon:!0,open:"settings"===A,ariaLabel:P.formatMessage({id:"universalQnA.jira.projectSelectionScreenTitle",defaultMessage:"Select projects to connect"}),onDismiss:()=>{(0,b().u)({environment:N,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_close",integration_type:"jira",setup_session_id:k,from:w}}}),so().G({analyticsFrom:w,screenToShow:"none",sessionId:k})},render:()=>(0,U.jsxs)("div",{style:C.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"jira",title:(0,U.jsx)(M().sA,{id:"universalQnA.jira.projectSelectionScreenTitle",defaultMessage:"Select projects to connect"}),subtext:(0,U.jsx)(M().sA,{id:"universalQnA.jira.projectSelectionScreenSubtext",defaultMessage:"Connecting more Jira projects will give you more relevant and useful Notion AI responses"})}),(0,U.jsx)(dt().A,{capture:!0,allowEsc:!0,render:()=>(0,U.jsx)(Fe().A,{textWrap:!0,placement:"top",render:t=>(0,U.jsx)("div",{...t,children:(0,U.jsx)(W().Ye,{...t,style:C.searchBarWrapper,children:(0,U.jsx)($t().A,{id:"jiraUniversalQnASearchBar",style:C.searchBar,disabled:!i,placeholder:P.formatMessage(_o.searchForAProject),value:e,onChange:e=>{n(e.target.value),(0,b().u)({environment:N,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"filter_jira_projects",integration_type:"jira",setup_session_id:k,from:w}}})}},"jiraUniversalQnASearchBar")})}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:280},children:(0,U.jsx)(M().sA,{..._o.disabledTooltip})}),disableTooltip:i})}),(0,U.jsx)(W().Ye,{style:C.selectionContainer,children:(0,U.jsx)(W().wt,{style:C.selection,children:V()})}),(0,U.jsxs)(W().wt,{style:C.footer,children:[(0,U.jsxs)(W().Ye,{style:C.futureChannelsCheckboxWrapper,children:[(0,U.jsx)(Fe().A,{render:e=>(0,U.jsx)("div",{...e,children:(0,U.jsx)(at().S,{checked:f,disabled:!i,size:14,onClick:()=>{(0,b().u)({environment:N,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:f?"dont_join_future_projects":"join_future_projects",integration_type:"jira",setup_session_id:E.sessionId,from:E.analyticsFrom}}}),y(!f)}})}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:280},children:(0,U.jsx)(M().sA,{..._o.disabledTooltip})}),disableTooltip:i}),(0,U.jsx)("div",{style:C.channelsText,children:(0,U.jsx)(M().sA,{id:"universalSearch.integration.jiraIngestion.allFutureProjects",defaultMessage:"Add projects created in future"})})]}),(0,U.jsx)(Fe().A,{render:e=>(0,U.jsx)("div",{...e,children:(0,U.jsx)(R().A,{colorPalette:"blue",isLoading:t,style:C.connectButton,onClick:G,disabled:!O()||!i,children:(0,U.jsx)(M().sA,{id:"universalSearch.integration.connect",defaultMessage:"Connect"})})}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:280},children:(0,U.jsx)(M().sA,{..._o.disabledTooltip})}),disableTooltip:i}),(0,U.jsx)(H().A,{colorPalette:"red",style:C.connectButton,disabled:!i,onClick:q,children:(0,U.jsx)(M().sA,{id:"universalSearch.integration.disconnect",defaultMessage:"Disconnect"})})]})]})})}var xo=()=>t(866515),jo=()=>t(46657);function bo(){const[e,n]=o.useState(!1),[t,s]=o.useState(void 0),i=(0,r().v3)(),d=(0,g().r)(),u=(0,a().K8)((()=>jo().W.state.currentScreen),[]);(0,c().Yb)((async()=>{if(!d||"authentication_pending"!==u)return;const e=await hn().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:i,data:{connector:"linear",authorizationType:"workspace",spaceId:d,sessionId:jo().W.state.sessionId,client:i.device.isElectron?"desktop":"web"}});if("success"!==e.type)return;const n=e.data.authorizationUrl;s(n)}),[i,u,d]);const p=(0,I().IS)((e=>({noteHeading:{fontWeight:T().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:T().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{width:18,height:17,color:"#D7813A",marginTop:2},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingInlineStart:14,fontWeight:T().Wy.regular},warningContainer:{marginInlineStart:5,marginInlineEnd:5,marginBottom:15}})),[]),m=(0,Mt().$)();(0,xo().n)((async()=>{if(!d)return;if("authentication_pending"!==jo().W.state.currentScreen)return;"not_started"!==await(0,l().getLinearConnectorStatus)({environment:i,spaceId:d})&&jo().W.setState({...jo().W.state,currentScreen:"confirmation"})}),2e3,!0);const h=(0,o.useCallback)((async()=>{if(!d)return;"not_started"!==await(0,l().getLinearConnectorStatus)({environment:i,spaceId:d})?(0,l().navigateToLinearUniversalScreen)({currentScreen:"confirmation"}):n(!0),(0,b().u)({environment:i,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_button_clicked",integration_type:"linear",setup_session_id:jo().W.state.sessionId,from:jo().W.state.analyticsFrom}}})}),[i,d]),v=(0,o.useCallback)((()=>{n(!1),(0,b().u)({environment:i,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_modal_dismissed",integration_type:"linear",setup_session_id:jo().W.state.sessionId,from:jo().W.state.analyticsFrom}}}),jo().W.reset()}),[i]);if(!m||!d)return null;const f=e?(0,U.jsxs)(W().Ye,{style:p.warningContainer,children:[(0,L().Q)(p.icon),(0,U.jsx)("div",{style:p.warningText,children:(0,U.jsx)(M().sA,{id:"universalSearch.linear.checkConnection.warning",defaultMessage:"We couldn’t connect to Linear. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{TroubleshootingGuide:(0,U.jsx)("a",{style:{...p.link,color:"#D7813A"},href:(0,B().x)("guides.aiConnectorLinear"),target:"_blank",onClick:()=>{(0,b().u)({environment:i,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"troubleshooting_guide_clicked",integration_type:"linear",setup_session_id:jo().W.state.sessionId,from:jo().W.state.analyticsFrom}}})},children:(0,U.jsx)(M().sA,{id:"universalSearch.linear.checkConnection.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,U.jsx)(q,{title:(0,U.jsx)(M().sA,{id:"universalSearch.linear.checkConnection.title",defaultMessage:"Follow instructions from Linear in your browser"}),open:"authentication_pending"===u,onDismiss:v,warningMessage:f,notes:[(0,U.jsxs)(W().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:p.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.linear.checkConnection.openAuthorizationUrlInNewTabTitle",defaultMessage:"Linear should open automatically on a new browser tab."},"note1-1")}),(0,U.jsx)("div",{style:p.noteBody,children:(0,U.jsx)(M().sA,{id:"universalSearch.linear.checkConnection.authWaiting2",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,U.jsx)("a",{style:p.link,href:t,target:"_blank",onClick:()=>{(0,b().u)({environment:i,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"retry_opening_linear_auth_url",integration_type:"linear",setup_session_id:jo().W.state.sessionId,from:jo().W.state.analyticsFrom}}})},children:(0,U.jsx)(M().sA,{id:"universalSearch.linear.checkConnection.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,U.jsxs)(W().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:p.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.linear.checkConnection.followInstructions",defaultMessage:"Follow Linear’s instructions to connect"},"note2")}),(0,U.jsx)("div",{style:p.noteBody,children:(0,U.jsx)(M().sA,{id:"universalSearch.linear.checkConnection.followInstructionsDescription",defaultMessage:"Install the Notion connector in a Linear workspace and return to this window"},"note1-2")})]},"note-2"),(0,U.jsx)(W().wt,{style:{gap:4},children:(0,U.jsx)("div",{style:p.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.linear.checkConnection.returnToNotion",defaultMessage:"Return to this window, and the process will continue automatically."},"note3")})},"note-3")],openLearnMoreUrl:()=>{window.open((0,B().x)("guides.aiConnectorLinear"),"_blank")},connectorType:"linear",primaryButtonText:(0,U.jsx)(M().sA,{id:"universalSearch.linear.checkConnection.checkConnectionButton",defaultMessage:"Check Connection"},"note3-1"),onClickPrimaryButton:h})}const Co=K().w0.linear;function Io(){const e=(0,r().v3)(),n=(0,a().K8)((()=>jo().W.state.currentScreen),[]),t=(0,g().r)(),s=(0,o.useCallback)((()=>{t&&((0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"ingestion_started",integration_type:"linear",setup_session_id:jo().W.state.sessionId,from:jo().W.state.analyticsFrom}}}),J().D6({label:(0,U.jsx)(M().sA,{id:"aiConnectors.linear.acknowledge",defaultMessage:"Started syncing from Linear. This can take up to 36 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(w().Ay,{onClick:J().N2,children:(0,U.jsx)(M().sA,{id:"aiConnectors.linear.startedMessageDismiss",defaultMessage:"Close"})})}),jo().W.reset())}),[t,e]);return(0,o.useEffect)((()=>{"confirmation"===n&&(0,l().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"linear",moment:"finished"})}),[e,n]),(0,U.jsx)(V,{open:"confirmation"===n,onDismiss:s,connectorType:"linear",notes:[(0,U.jsx)(X,{number:1,title:{...{...$.connectionInProgressTitle,values:{appName:Co}}},description:$.defaultConnectionTime},"item1"),(0,U.jsx)(X,{number:2,title:{...{...$.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:Co}}}},"item2")],onPrimaryButtonClick:s})}const wo=(0,M().YK)({linearAIConnectorOauthPopupTitle:{defaultMessage:"Connect Linear AI Connector",id:"linearAIConnector.oauthPopupTitle"}});function ko(){const e=(0,M().tz)(),n=(0,o.useMemo)((()=>ve("linear")),[]),t=(0,o.useMemo)((()=>fe("linear")),[]),s=(0,r().v3)(),[i,d]=(0,o.useState)("CLOSED"),u=(0,g().r)(),p=(0,a().O$)(jo().W),m=(0,a().K8)((()=>jo().W.state.sessionId),[]),h=(0,a().K8)((()=>jo().W.state.analyticsFrom),[]),v=(0,I().IS)((()=>({loadingWrapper:{padding:20,fontSize:12,fontWeight:T().Wy.regular,justifyContent:"center",gap:8,alignItems:"center"}})),[]),f=(0,de().J)(),y=(0,_().P9)({name:"ai_connectors",spaceId:u,userId:s.currentUser.id}),S=(0,o.useCallback)((()=>{const e=(0,B().x)("guides.aiConnectorLinear");(0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_intro_modal",integration_type:"linear",setup_session_id:jo().W.state.sessionId,from:jo().W.state.analyticsFrom}}}),s.device.isElectron?(0,C().P)(e):window.open(e,"_blank")}),[s]),x=(0,o.useCallback)((async()=>{if(!u||"introduction"!==p.currentScreen)return null;const e=await hn().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:s,data:{connector:"linear",authorizationType:"workspace",spaceId:u,client:s.device.isElectron?"desktop":"web",sessionId:jo().W.state.sessionId}});if("success"!==e.type)return null;const n=e.data.authorizationUrl;s.device.isElectron?(0,C().P)(n):ce().P(s,{width:800,height:600,url:n,titleMessage:wo.linearAIConnectorOauthPopupTitle})}),[u,s,p.currentScreen]),[j]=(0,c().Yb)((async()=>{if(!u||"introduction"!==p.currentScreen)return;const e=await hn().callApi({eventName:"listAIConnectors",environment:s,data:{spaceId:u}});return"success"===e.type?{isLinearConnected:e.data.connectedConnectors.map((e=>e.id)).some((e=>"linear"===e))}:void 0}),[s,p.currentScreen,u]);(0,o.useEffect)((()=>{"introduction"===p.currentScreen?"resolved"===j.status?d("OPEN"):d("LOADING"):d("CLOSED")}),[j.status,p.currentScreen]);const w=(0,o.useRef)(!1),k=(0,o.useCallback)((()=>{jo().W.reset(),(0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_linear_intro_modal",integration_type:"linear",setup_session_id:jo().W.state.sessionId,from:jo().W.state.analyticsFrom}}}),w.current=!1}),[s]),A=(0,o.useCallback)((async()=>{await x(),(0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"linear_ai_connector_auth_url_open",integration_type:"linear",setup_session_id:jo().W.state.sessionId,from:jo().W.state.analyticsFrom}}}),(0,l().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:s,connector:"linear",moment:"started"}),(0,l().navigateToLinearUniversalScreen)({currentScreen:"authentication_pending"})}),[s,x]);return(0,o.useEffect)((()=>{u&&f&&"resolved"===j.status&&"introduction"===p.currentScreen&&(w.current||((0,b().u)({environment:s,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"linear",setup_session_id:p.sessionId,from:p.analyticsFrom,is_space_admin:f,is_ai_eligible:y??!1}}}),w.current=!0))}),[u,s,j.status,p.sessionId,p.analyticsFrom,f,y,p.currentScreen]),u&&"CLOSED"!==i?s.device.isMobile?(0,U.jsx)(_e,{connectorType:"linear",open:"introduction"===p.currentScreen,onClosed:()=>{jo().W.reset()},learnMoreUrl:(0,B().x)("guides.aiConnectorLinear")}):"LOADING"===i?(0,U.jsx)(D().a,{ariaLabel:e.formatMessage({id:"linearAIConnector.oauthPopupTitle.ariaLabel",defaultMessage:"Loading Linear AI connector status"}),open:"LOADING"===i,render:()=>(0,U.jsxs)(W().Ye,{style:v.loadingWrapper,children:[(0,U.jsx)(M().sA,{id:"universalQna.linear.isFetchingConnection",defaultMessage:"Getting connection status"}),(0,U.jsx)(We().k,{})]})}):p.isConnected?null:f?(0,U.jsx)(ke,{onConnect:A,onDismiss:k,onLearnMore:S,title:n,connectorType:"linear",notes:t,open:"OPEN"===i}):(0,U.jsx)(Ie,{connector:"linear",analyticsFrom:h,setupSessionId:m,handleClose:()=>(0,l().resetAiConnectorStatus)("linear"),open:"OPEN"===i,messages:ye().A3}):null}function Ao(){const[e,n]=(0,o.useState)(!1),t=(0,r().v3)(),s=(0,g().r)(),c=(0,M().tz)(),l=(0,a().K8)((()=>jo().W.state.currentScreen),[]),d=(0,a().K8)((()=>i().default.getConfigKey("linear_ingestion","clientId")),[]),u=(0,o.useCallback)((()=>{(0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"close_settings",integration_type:"linear",setup_session_id:jo().W.state.sessionId,from:jo().W.state.analyticsFrom}}}),jo().W.setState({...jo().W.state,currentScreen:"none"})}),[t]),p=(0,o.useCallback)((()=>{n(!1)}),[]),m=(0,I().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:8},disconnectButton:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.medium,width:"100%"},learnMoreButton:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:T().Wy.medium,fontSize:T().J.UISmall.desktop,gap:5,justifyContent:"center",alignItems:"center",paddingTop:4,paddingInlineEnd:8,paddingBottom:4,paddingInlineStart:8,color:`${e.text.secondary}`},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:T().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},editTeamsButton:{width:"100%"}})),[]);return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(D().a,{ariaLabel:c.formatMessage({id:"linearAIConnector.settings.title",defaultMessage:"Linear AI Connector Settings Modal"}),ariaLabelledBy:"Linear AI Connector Settings Modal",showCloseIcon:!0,onDismiss:p,open:e,render:()=>(0,U.jsx)("div",{style:m.confirmWrapper,children:(0,U.jsxs)("div",{style:m.confirmContainer,children:[(0,U.jsx)("div",{style:m.confirmModalTitle,children:(0,U.jsx)(M().sA,{id:"linearAIConnector.settings.confirmation.title",defaultMessage:"Are you sure?"})}),(0,U.jsx)("div",{style:m.confirmModalSubTitle,children:(0,U.jsx)(M().sA,{id:"linearAIConnector.settings.confirmation.subTitle",defaultMessage:"Your Linear data will be permanently deleted from Notion."})}),(0,U.jsx)("div",{style:m.confirmModalDescription,children:(0,U.jsx)(M().sA,{id:"linearAIConnector.settings.confirmation.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."})}),(0,U.jsxs)(W().wt,{style:m.confirmModalActionButtons,children:[(0,U.jsx)(R().A,{colorPalette:"red",style:m.confirmDisconnectButton,onClick:async()=>{s&&((0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_button_clicked",integration_type:"linear",setup_session_id:jo().W.state.sessionId,from:jo().W.state.analyticsFrom}}}),await hn().callApi({eventName:"disconnectAiConnector",environment:t,data:{spaceId:s,connector:"linear"}}),jo().W.reset(),n(!1),J().D6({label:Mn().A.getIntl().formatMessage({defaultMessage:"Linear disconnected. This can take up to 3 hours.",id:"linearAIConnector.settings.confirmation.disconnected"}),position:"bottom"}))},children:(0,U.jsx)(M().sA,{id:"linearAIConnector.settings.confirmDisconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"})}),(0,U.jsx)(w().Ay,{style:m.goBackButton,onClick:p,children:(0,U.jsx)(M().sA,{id:"linearAIConnector.settings.confirmDisconnectModal.goBack",defaultMessage:"Go back"})})]})]})})}),(0,U.jsx)(D().a,{ariaLabel:c.formatMessage({id:"linearAIConnector.settings.settingsModalTitle",defaultMessage:"Linear AI Connector Settings Modal"}),ariaLabelledBy:"Linear AI Connector Settings Modal",showCloseIcon:!0,onDismiss:u,open:"settings"===l,render:()=>(0,U.jsxs)("div",{style:m.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"linear",title:(0,U.jsx)(M().sA,{id:"linearAIConnector.settings.linearIsConnected",defaultMessage:"Linear is connected to Notion AI"}),subtext:(0,U.jsx)(M().sA,{id:"linearAIConnector.settings.canAnswerFrom",defaultMessage:"Notion AI can answer questions about your Linear issues and projects."})}),(0,U.jsxs)(W().wt,{style:m.footer,children:[(0,U.jsx)(H().A,{size:"lg",style:m.editTeamsButton,onClick:()=>{(0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"open_linear_for_edit_selection",integration_type:"linear",setup_session_id:jo().W.state.sessionId,from:jo().W.state.analyticsFrom}}}),window.open(`https://linear.app/settings/applications/${d}`,"_blank")},children:(0,U.jsx)(M().sA,{id:"linearAIConnector.settings.editTeams",defaultMessage:"Edit Selected Teams"})}),(0,U.jsx)(Be().E,{style:m.disconnectButton,onClick:()=>{(0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"account_disconnect",integration_type:"linear",setup_session_id:jo().W.state.sessionId,from:"connection_settings"}}}),n(!0)},children:(0,U.jsx)(M().sA,{id:"linearAIConnector.settings.disconnectLinear",defaultMessage:"Disconnect"})}),(0,U.jsx)(w().Ay,{style:m.learnMoreButton,onClick:()=>{(0,b().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_settings_modal",integration_type:"linear",setup_session_id:jo().W.state.sessionId,from:"connection_settings"}}});const e=(0,B().x)("guides.aiConnectorLinear");window.open(e,"_blank")},children:(0,U.jsxs)(W().Ye,{style:m.learnMoreText,children:[(0,U.jsx)(M().sA,{id:"linearAIConnector.settings.learnMore",defaultMessage:"Learn more"}),(0,U.jsx)(De().I,{icon:Pe().arrowUpRightSquareSmallIcon,size:"sm"})]})})]})]})})]})}function Mo(){const e=(0,a().K8)((()=>m().F.state.currentScreen),[]);return(0,U.jsx)(qe,{open:"already_connected_screen"===e,onDismiss:()=>{m().F.reset()},connector:"microsoft-teams"})}function To(e){const[n,t]=o.useState(!1),[s,i]=o.useState(void 0),d=(0,r().v3)(),u=(0,g().r)(),p=(0,a().K8)((()=>m().F.state.currentScreen),[]);(0,c().Yb)((async()=>{if(!u||"check_connection_screen"!==p)return;const e=await hn().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:d,data:{connector:"microsoft-teams",authorizationType:"workspace",spaceId:u,sessionId:m().F.state.sessionId,client:d.device.isElectron?"desktop":"web"}});if("success"!==e.type)return;const n=e.data.authorizationUrl;i(n)}),[d,p,u]);const h=(0,I().IS)((e=>({noteHeading:{fontWeight:T().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:T().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{width:18,height:17,color:"#D7813A",marginTop:2},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingInlineStart:14,fontweight:T().Wy.regular},warningContainer:{marginInlineStart:5,marginInlineEnd:5,marginBottom:15}})),[]),v=(0,a().K8)((()=>m().F.state.analyticsFrom),[]),f=(0,a().K8)((()=>m().F.state.sessionId),[]),y=(0,Mt().$)(),_=(0,o.useCallback)((async({key:e,value:n})=>{if(u)return"already_connected"===n?(await(0,l().getMicrosoftTeamsAIConnectorStatusAction)({environment:d,spaceId:u,sessionId:f}),void(0,l().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"connected_to_another_workspace_screen",analyticsFrom:v,sessionId:f})):void("connected"===n&&(await(0,l().getMicrosoftTeamsAIConnectorStatusAction)({environment:d,spaceId:u,sessionId:f}),(0,l().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"connection_complete_screen",analyticsFrom:v,sessionId:f})))}),[v,f,d,u]);(0,o.useEffect)((()=>{if(!u||null==y||!y.id||!f)return;const e=P().Ay.addListener((0,A().Vz)({spaceId:u,connectorType:"microsoft-teams",userId:y.id,sessionId:f}),void 0,_,void 0,d);return()=>{e&&P().Ay.removeListener(e,d)}}),[d,_,u,null==y?void 0:y.id,f]);const S=(0,o.useCallback)((async()=>{var e;if(!u)return;if((0,b().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_button_clicked",integration_type:"microsoft-teams",setup_session_id:f,from:v}}}),await(0,l().getMicrosoftTeamsAIConnectorStatusAction)({environment:d,spaceId:u,sessionId:f}),"connected_to_another_workspace"===(null===(e=m().F.state.error)||void 0===e?void 0:e.reason))return void(0,l().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"connected_to_another_workspace_screen",analyticsFrom:v,sessionId:f});"not_started"!==m().F.state.connectionStatus?(0,l().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"connection_complete_screen",analyticsFrom:v,sessionId:f}):t(!0)}),[v,d,f,u]),x=(0,o.useCallback)((()=>{t(!1),(0,b().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_dismiss",integration_type:"microsoft-teams",setup_session_id:f,from:v}}}),(0,l().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:v,sessionId:f})}),[v,d,f]),j=(0,o.useCallback)((()=>{(0,b().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"trouble_shooting_guide_clicked",integration_type:"microsoft-teams",setup_session_id:f,from:v}}})}),[v,d,f]),C=(0,o.useCallback)((()=>{(0,b().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_open_auth_url",integration_type:"microsoft-teams",setup_session_id:f,from:v}}})}),[v,d,f]);if(!y||!u)return null;const w=n?(0,U.jsxs)(W().Ye,{style:h.warningContainer,children:[(0,L().Q)(h.icon),(0,U.jsx)("div",{style:h.warningText,children:(0,U.jsx)(M().sA,{id:"universalSearch.microsoftTeams.checkConnection.warning",defaultMessage:"We couldn’t connect to Microsoft Teams. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{TroubleshootingGuide:(0,U.jsx)("a",{style:{...h.link,color:"#D7813A"},href:(0,B().x)("guides.aiConnectorMicrosoftTeams"),target:"_blank",onClick:j,children:(0,U.jsx)(M().sA,{id:"universalSearch.microsoftTeams.checkConnection.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,U.jsx)(q,{title:(0,U.jsx)(M().sA,{id:"universalSearch.microsoftTeams.checkConnection.title",defaultMessage:"Follow instructions from Microsoft Teams in your browser"}),open:"check_connection_screen"===p,onDismiss:x,warningMessage:w,notes:[(0,U.jsxs)(W().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:h.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.microsoftTeams.checkConnection.openAuthorizationUrlInNewTabTitle",defaultMessage:"Teams should open automatically on a new browser tab."},"note1-1")}),(0,U.jsx)("div",{style:h.noteBody,children:(0,U.jsx)(M().sA,{id:"universalSearch.microsoftTeams.checkConnection.authWaiting2",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,U.jsx)("a",{style:h.link,href:s,target:"_blank",onClick:C,children:(0,U.jsx)(M().sA,{id:"universalSearch.microsoftTeams.checkConnection.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,U.jsxs)(W().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:h.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.microsoftTeams.checkConnection.followInstructions",defaultMessage:"Follow Team’s instructions to connect"},"note2")}),(0,U.jsx)("div",{style:h.noteBody,children:(0,U.jsx)(M().sA,{id:"universalSearch.microsoftTeams.checkConnection.followInstructionsDescription",defaultMessage:"Install the Notion connector in a Microsoft Teams workspace and return to this window"},"note1-2")})]},"note-2"),(0,U.jsx)(W().wt,{style:{gap:4},children:(0,U.jsx)("div",{style:h.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.microsoftTeams.checkConnection.returnToNotion",defaultMessage:"Return to this window, and the process will continue automatically."},"note3")})},"note-3")],openLearnMoreUrl:()=>{window.open((0,B().x)("guides.aiConnectorMicrosoftTeams"),"_blank")},connectorType:"microsoft-teams",primaryButtonText:(0,U.jsx)(M().sA,{id:"universalSearch.microsoftTeams.checkConnection.checkConnectionButton",defaultMessage:"Check Connection"},"note3-1"),onClickPrimaryButton:S})}var No=()=>t(631524);const Do={"google-drive":{pageVisitSource:Pn().y8.AIGoogleDriveQna},"microsoft-teams":{pageVisitSource:Pn().y8.AIMicrosoftTeamsQna},slack:{pageVisitSource:Pn().y8.AISlackQna}},Wo=(0,M().YK)({alreadyConnected:{id:"universalQna.connector.connectedToAnotherSpace.title",defaultMessage:"You’ve already connected {connector} to another Notion workspace."},subTitle:{id:"universalQna.connector.connectedToAnotherSpace.subtitle",defaultMessage:"Currently, only one workspace can be connected to {connector}. To connect this workspace, please disconnect the existing connection."},visitAnotherSpace:{id:"universalQna.connector.connectedToAnotherSpace.visitAnotherSpaceButton",defaultMessage:"Visit the other workspace"},gotIt:{id:"universalQna.connector.connectedToAnotherSpace.gotItButton",defaultMessage:"Got it"}});function Bo({open:e,onNavigateToSpace:n,connector:t,connectedSpaceId:s}){const i=(0,r().v3)(),c=(0,M().tz)(),l=Do[t],u=K().w0[t],g=(0,a().O$)(d().NT[t]),{sessionId:p,analyticsFrom:m}=g,v=(0,I().IS)((e=>({container:{padding:16,maxWidth:400},tryItButton:{marginTop:16},gotItButton:{marginTop:16,justifyContent:"center"}})),[]),f=(0,o.useCallback)((async()=>{const e=h().default.state.currentUserRootStore;if(!e)return;const o=e.getSpaceViewStores().filter((e=>e.getSpaceId()===s))[0];o&&((0,b().u)({environment:i,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"visit_other_workspace",integration_type:t,setup_session_id:p,from:m}}}),await Fn().tR({environment:i,navigationType:"switchingToOrLoadingSpace",pageVisitSource:l.pageVisitSource,spaceViewStore:o,userRootStore:h().default.state.currentUserRootStore,userSettingsStore:h().default.state.currentUserSettingsStore}),n())}),[i,t,p,m,l.pageVisitSource,n,s]),y=(0,o.useCallback)((()=>{(0,b().u)({environment:i,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connected_to_another_space_dismiss",integration_type:t,setup_session_id:p,from:m}}}),d().NT[t].setState({...g,currentScreen:"none"})}),[m,i,p,t,g]),_=c.formatMessage(Wo.alreadyConnected,{connector:u});return(0,U.jsx)(D().a,{showCloseIcon:!0,onDismiss:y,open:e,ariaLabel:_,render:()=>(0,U.jsxs)(W().wt,{style:v.container,children:[(0,U.jsx)(F().b,{titleSubtitleGap:!0,fullWidthTitle:!0,subtext:(0,U.jsx)(M().sA,{...Wo.subTitle,values:{connector:u}}),connectorType:t,title:(0,U.jsx)(M().sA,{...Wo.alreadyConnected,values:{connector:u}})}),(0,U.jsx)(R().A,{colorPalette:"blue",size:"lg",style:v.tryItButton,onClick:f,children:(0,U.jsx)(M().sA,{...Wo.visitAnotherSpace})}),(0,U.jsx)(No().p,{size:"lg",style:v.gotItButton,onClick:y,children:(0,U.jsx)(M().sA,{...Wo.gotIt})})]})})}function Po(){const e=(0,a().K8)((()=>m().F.state.currentScreen),[]),n=(0,a().K8)((()=>{var e;return null===(e=m().F.state.error)||void 0===e?void 0:e.connectedSpaceId}),[]),t=(0,a().K8)((()=>m().F.state.analyticsFrom),[]),s=(0,a().K8)((()=>m().F.state.sessionId),[]);return(0,o.useEffect)((()=>{"connected_to_another_workspace_screen"===e&&(n||(0,l().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:t,sessionId:s}))}),[n,t,s,e]),(0,U.jsx)(Bo,{open:"connected_to_another_workspace_screen"===e,connector:"microsoft-teams",setupSessionId:s,onNavigateToSpace:()=>{m().F.reset()},connectedSpaceId:n??""})}const Fo=K().w0["microsoft-teams"];function Uo(){const e=(0,M().tz)(),n=(0,r().v3)(),t=(0,a().K8)((()=>m().F.state.currentScreen),[]),s=(0,a().K8)((()=>m().F.state.sessionId),[]),i=(0,a().K8)((()=>m().F.state.analyticsFrom),[]),c=(0,g().r)(),d="in_progress"===(0,a().K8)((()=>m().F.state.connectionStatus),[]),u=(0,o.useCallback)((()=>{(0,b().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_dismiss",integration_type:"microsoft-teams",setup_session_id:s,from:i}}}),(0,l().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:i,sessionId:s})}),[i,n,s]),p=(0,o.useCallback)((async()=>{if(!c)return;(0,b().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_done",integration_type:"microsoft-teams",setup_session_id:s,from:i}}});const t=await(0,l().getMicrosoftTeamsAIConnectorStatusAction)({environment:n,spaceId:c});if(!t)return J().D6({label:e.formatMessage({defaultMessage:"Action failed. Please try again.",id:"universalSearch.microsoftTeams.connectionComplete.retryActionRequest"}),position:"bottom"}),void(0,l().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:i,sessionId:s,currentScreen:"none"});if(["disconnecting","editing"].includes(null==t?void 0:t.connectionStatus))return J().D6({label:e.formatMessage({defaultMessage:"Failed to update the connection. Please try again later.",id:"universalSearch.microsoftTeams.connectionComplete.failedToStartSync"}),position:"bottom"}),void(0,l().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:i,sessionId:s,currentScreen:"none"});if(["in_progress","completed"].includes(null==t?void 0:t.connectionStatus))return void(0,l().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:i,sessionId:s,currentScreen:"none"});await(0,l().getMicrosoftTeamsSyncControlsAction)({environment:n,spaceId:c})||await(0,l().setMicrosoftTeamsSyncControlsAction)({environment:n,spaceId:c,syncControls:{syncFutureTeams:!0,teamsToExcludeFromSync:[],teamsToSync:[]}});await(0,l().startMicrosoftTeamsBulkIngestionAction)({environment:n,spaceId:c,sessionId:s})?(0,l().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:i,sessionId:s,currentScreen:"none"}):J().D6({label:e.formatMessage({defaultMessage:"Failed to start ingestion. Please try again later.",id:"universalSearch.microsoftTeams.connectionComplete.failedToStartIngestion"}),position:"bottom"})}),[c,n,i,s,e]),h=(0,o.useCallback)((async()=>{if(!c)return;(0,b().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"microsoft_teams_settings",integration_type:"microsoft-teams",setup_session_id:s,from:i}}});const e=await(0,l().getMicrosoftTeamsAIConnectorStatusAction)({environment:n,spaceId:c});if(!e||"not_started"===e.connectionStatus)return void(0,l().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:i,sessionId:s,currentScreen:"error_screen"});const t=e.connectionStatus;"in_progress"!==t&&"editing"!==t?"pending_selection"!==t&&"completed"!==t?(0,l().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:i,sessionId:s,currentScreen:"error_screen"}):(0,l().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:i,sessionId:s,currentScreen:"settings"}):(0,l().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:i,sessionId:s,currentScreen:"edit_blocked_screen"})}),[i,n,s,c]);return(0,o.useEffect)((()=>{"connection_complete_screen"===t&&(0,l().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:n,connector:"microsoft-teams",moment:"finished"})}),[n,t]),(0,U.jsx)(V,{open:"connection_complete_screen"===t,onDismiss:u,connectorType:"microsoft-teams",notes:[(0,U.jsx)(X,{number:1,title:{...{...$.connectionInProgressTitle,values:{appName:Fo}}},description:$.defaultConnectionTime},"item1"),(0,U.jsx)(X,{number:2,title:{...{...$.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:Fo}}}},"item2")],onPrimaryButtonClick:p,onEditSettingsClick:d?void 0:h})}function Eo(){const e=(0,M().tz)(),n=(0,I().IS)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:T().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.medium,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{paddingTop:12,paddingInlineEnd:12,paddingBottom:12,paddingInlineStart:12,gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:T().Wy.regular,fontSize:T().J.UIRegular.desktop,lineHeight:"18px"},noteHeading:{fontWeight:T().Wy.medium,fontSize:T().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{fontWeight:T().Wy.regular,color:e.text.secondary,fontSize:T().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"}})),[]),[t,s]=(0,o.useState)(!1),i=(0,a().K8)((()=>m().F.state.currentScreen),[]),c=(0,g().r)(),d=(0,a().K8)((()=>m().F.state.analyticsFrom),[]),u=(0,a().K8)((()=>m().F.state.sessionId),[]),p=(0,r().v3)(),h=(0,o.useCallback)((()=>{(0,l().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:d,sessionId:u})}),[d,u]),v=(0,o.useCallback)((()=>{(0,l().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:d,sessionId:u})}),[d,u]),f=(0,o.useCallback)((async()=>{if(s(!0),!c)return void s(!1);(0,b().u)({environment:p,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_confirm_disconnect_button",integration_type:"microsoft-teams",setup_session_id:u,from:d}}});const e=await async function(e){const{environment:n,spaceId:t}=e,o=await hn().callApi({eventName:"disconnectAiConnector",environment:n,data:{spaceId:t,connector:"microsoft-teams"}});if("success"===o.type)return J().D6({label:Mn().A.getIntl().formatMessage({defaultMessage:"Started disconnecting Microsoft Teams. This can take up to 3 hours.",id:"microsoftTeams.disconnect.started"}),position:"bottom",style:{width:"400px",display:"flex",justifyContent:"space-between"}}),!0;return!1}({environment:p,spaceId:c});e&&m().F.setState({...m().F.state,connectionStatus:"disconnecting",currentScreen:"post_disconnect_screen"}),s(!1)}),[p,c,d,u]),y=(0,o.useCallback)((()=>{(0,l().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"settings",analyticsFrom:d,sessionId:u})}),[d,u]),_=(0,o.useCallback)((()=>{const{noteBlockWrapper:e,noteHeading:t,noteBody:o}=n;return[(0,U.jsxs)(W().wt,{style:e,children:[(0,U.jsx)("div",{style:t,children:(0,U.jsx)(M().sA,{...zo.note1Heading})}),(0,U.jsx)("div",{style:o,children:(0,U.jsx)(M().sA,{...zo.note1Body})})]},"note-1")]}),[n]);return"post_disconnect_screen"===i?(0,U.jsx)(oe,{onClickGotItBtn:v,onDismiss:h,open:"post_disconnect_screen"===i,connectorType:"microsoft-teams",title:(0,U.jsx)(M().sA,{...zo.postDisconnectTitle}),descriptionMessage:(0,U.jsx)(M().sA,{...zo.postDisconnectDescription}),message:(0,U.jsx)("div",{style:n.notesSectionWrapper,children:_().map(((e,t)=>(0,U.jsx)(W().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:(0,U.jsx)("div",{style:n.note,children:e})},t)))})}):(0,U.jsx)(D().a,{showCloseIcon:!0,open:"disconnect_screen"===i,onDismiss:h,render:()=>(0,U.jsx)("div",{style:n.confirmWrapper,children:(0,U.jsxs)("div",{style:n.confirmContainer,children:[(0,U.jsx)("div",{style:n.confirmModalTitle,children:(0,U.jsx)(M().sA,{...zo.disconnectTitle})}),(0,U.jsx)("div",{style:n.confirmModalSubTitle,children:(0,U.jsx)(M().sA,{...zo.disconnectSubTitle})}),(0,U.jsx)("div",{style:n.confirmModalDescription,children:(0,U.jsx)(M().sA,{...zo.disconnectDescription})}),(0,U.jsxs)(W().wt,{style:n.confirmModalActionButtons,children:[(0,U.jsx)(R().A,{colorPalette:"red",style:n.confirmDisconnectButton,isLoading:t,onClick:f,children:(0,U.jsx)(M().sA,{...zo.primaryButtonLabel})}),(0,U.jsx)(w().Ay,{style:n.goBackButton,onClick:y,children:(0,U.jsx)(M().sA,{...zo.goBackButtonLabel})})]})]})}),ariaLabel:e.formatMessage(zo.disconnectModalAriaLabel)})}const zo=(0,M().YK)({note1Heading:{id:"universalSearch.microsoftTeams.postDisconnect.note_1.heading",defaultMessage:"Teams data will be permanently deleted from Notion"},note1Body:{id:"universalSearch.microsoftTeams.postDisconnect.note_1.body",defaultMessage:"This process can take up to 3 hours. You’ll only be able to reconnect after disconnecting is complete."},postDisconnectTitle:{id:"universalSearch.microsoftTeams.postDisconnect.title",defaultMessage:"Teams is disconnecting from Notion AI"},postDisconnectDescription:{id:"universalSearch.microsoftTeams.postDisconnect.description",defaultMessage:"Here’s what you should know:"},disconnectTitle:{id:"universalSearch.microsoftTeams.disconnectModal.title",defaultMessage:"Are you sure?"},disconnectSubTitle:{id:"universalSearch.microsoftTeams.disconnectModal.subTitle",defaultMessage:"Teams data will be permanently deleted from Notion."},disconnectDescription:{id:"universalSearch.microsoftTeams.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."},primaryButtonLabel:{id:"universalSearch.microsoftTeams.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"},goBackButtonLabel:{id:"universalSearch.microsoftTeams.disconnectModal.goBack",defaultMessage:"Go back"},disconnectModalAriaLabel:{id:"universalSearch.microsoftTeams.disconnectModal.label",defaultMessage:"Disconnect Microsoft Teams Modal"}}),Lo=(0,M().YK)({primedTextInput:{id:"aiConnectors.microsoftTeams.primedTextInput",defaultMessage:"Search for messages in Microsoft Teams"}});function Ko(){const e=(0,M().tz)(),n=(0,r().v3)(),t=(0,a().K8)((()=>m().F.state.currentScreen),[]),s=(0,a().K8)((()=>m().F.state.sessionId),[]),i=(0,a().K8)((()=>m().F.state.analyticsFrom),[]),c=(0,I().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{fontSize:14,fontWeight:T().Wy.semibold,width:"100%"}})),[]),d=(0,o.useCallback)((()=>{(0,b().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connection_in_progress_got_it",integration_type:"microsoft-teams",setup_session_id:s,from:i}}}),(0,l().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none"})}),[i,n,s]),u=(0,o.useCallback)((()=>{(0,b().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connection_in_progress_dismiss",integration_type:"microsoft-teams",setup_session_id:s,from:i}}}),(0,l().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none"})}),[i,n,s]);return(0,U.jsx)(D().a,{showCloseIcon:!0,onDismiss:u,open:"edit_blocked_screen"===t,render:()=>(0,U.jsxs)("div",{style:c.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"microsoft-teams",title:(0,U.jsx)(M().sA,{id:"aiConnectors.microsoftTeams.editBlocked.title",defaultMessage:"Connection is in Progress"}),subtext:(0,U.jsx)(M().sA,{id:"aiConnectors.microsoftTeams.editBlocked.description",defaultMessage:"You’ll be able to ask questions and manage your settings soon. This can take up to 72h."})}),(0,U.jsx)(W().wt,{style:c.footer,children:(0,U.jsx)(R().A,{colorPalette:"blue",style:c.connectButton,onClick:d,children:(0,U.jsx)(M().sA,{id:"aiConnectors.microsoftTeams.editBlocked.gotItButton",defaultMessage:"Got it"})})})]}),ariaLabel:e.formatMessage(Lo.primedTextInput)})}function Ho(){const e=(0,M().tz)(),n=(0,a().K8)((()=>m().F.state.currentScreen),[]),t=(0,a().K8)((()=>m().F.state.sessionId),[]),o=(0,a().K8)((()=>m().F.state.analyticsFrom),[]),s=(0,I().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{fontSize:14,fontWeight:T().Wy.semibold,width:"100%"}})),[]);return(0,U.jsx)(D().a,{open:"error_screen"===n,showCloseIcon:!0,onDismiss:()=>(0,l().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:o,sessionId:t}),render:()=>(0,U.jsxs)("div",{style:s.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"microsoft-teams",title:(0,U.jsx)(M().sA,{id:"universalSearch.microsoftTeams.error.title",defaultMessage:"Oops! Something went wrong"}),subtext:(0,U.jsx)(M().sA,{id:"universalSearch.microsoftTeams.error.description",defaultMessage:"Something went wrong, please try again later."})}),(0,U.jsx)(W().wt,{style:s.footer,children:(0,U.jsx)(R().A,{colorPalette:"blue",style:s.connectButton,onClick:()=>{(0,l().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:o,sessionId:t})},children:(0,U.jsx)(M().sA,{id:"universalSearch.microsoftTeams.Dismiss",defaultMessage:"Close"})})})]}),ariaLabel:e.formatMessage({id:"universalSearch.microsoftTeams.error.ariaLabel",defaultMessage:"Microsoft Teams error modal"})})}const Ro=(0,M().YK)({microsoftTeamsAIConnectorOauthPopupTitle:{defaultMessage:"Connect Microsoft Teams AI Connector",id:"microsoftTeamsAIConnector.oauthPopupTitle"}});function Go(){const e=(0,r().v3)(),n=(0,de().J)(),t=(0,g().r)(),s=e.currentUser.id,i=(0,_().P9)({name:"ai_connectors",spaceId:t,userId:s}),c=(0,o.useRef)(!1),d=(0,o.useMemo)((()=>fe("microsoft-teams")),[]),u=(0,a().K8)((()=>m().F.state.currentScreen),[]),p=(0,a().K8)((()=>m().F.state.connectionStatus),[]),h=(0,a().K8)((()=>m().F.state.sessionId),[]),f=(0,a().K8)((()=>m().F.state.analyticsFrom),[]),y=(0,a().K8)((()=>v().zD.isAiConnectorEnabled("microsoft-teams")),[]),S=(0,o.useCallback)((async()=>{if(!t)return;(0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"microsoft_teams_ai_connector_auth_url_open",integration_type:"microsoft-teams",setup_session_id:h,from:f}}});const n=await hn().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:e,data:{connector:"microsoft-teams",authorizationType:"workspace",spaceId:t,sessionId:h,client:e.device.isElectron?"desktop":"web"}});if("success"!==n.type)return;(0,l().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"microsoft-teams",moment:"started"});const o=n.data.authorizationUrl;e.device.isElectron?(0,C().P)(o):ce().P(e,{width:800,height:600,url:o,titleMessage:Ro.microsoftTeamsAIConnectorOauthPopupTitle}),(0,l().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"check_connection_screen",analyticsFrom:f,sessionId:h})}),[t,e,f,h]),x=(0,o.useCallback)((()=>{(0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_microsoft_teams_intro_modal",integration_type:"microsoft-teams",setup_session_id:h,from:f}}}),c.current=!1,m().F.reset()}),[f,h,e]);(0,o.useCallback)((()=>{t&&n&&"introduction"===u&&(c.current||((0,b().u)({environment:e,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"microsoft-teams",setup_session_id:h,from:f,is_space_admin:n,is_ai_eligible:i??!1}}}),c.current=!0),"completed"===p&&(0,l().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"already_connected_screen",analyticsFrom:f,sessionId:h}),"in_progress"!==p&&"editing"!==p||(0,l().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"edit_blocked_screen",analyticsFrom:f,sessionId:h}))}),[t,n,u,p,e,h,f,i]);const j=(0,o.useCallback)((()=>{const n=(0,B().x)("guides.aiConnectorMicrosoftTeams");(0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_intro_modal",integration_type:"microsoft-teams",setup_session_id:h,from:f}}}),e.device.isElectron?(0,C().P)(n):window.open(n,"_blank")}),[e,f,h]);return y&&t&&"introduction"===u?e.device.isMobile?(0,U.jsx)(_e,{connectorType:"microsoft-teams",open:"introduction"===u,onClosed:()=>{m().F.reset()},learnMoreUrl:(0,B().x)("guides.aiConnectorMicrosoftTeams")}):n?(0,U.jsx)(ke,{connectorType:"microsoft-teams",notes:d,onLearnMore:j,onConnect:S,onDismiss:x,title:(0,U.jsx)(M().sA,{id:"universalSearch.microsoftTeams.intro.microsoftTeamsTitle",defaultMessage:"To start, install the Notion AI app in Microsoft Teams"}),open:"introduction"===u}):(0,U.jsx)(Ie,{connector:"microsoft-teams",handleClose:()=>m().F.reset(),open:"introduction"===u,analyticsFrom:f,setupSessionId:h,messages:ye().Fj}):null}const qo=(0,M().YK)({primedTextInput:{id:"aiConnectors.microsoftTeams.postEdit.primedTextInput",defaultMessage:"Search for messages in Microsoft Teams"}});function Oo(){const e=(0,M().tz)(),n=(0,a().K8)((()=>m().F.state.currentScreen),[]),t=(0,I().IS)((e=>({wrapper:{width:400},section:{marginTop:4,marginBottom:6},note:{fontWeight:T().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginInlineStart:8},sectionContainer:{padding:20,width:400,paddingTop:12},bottomSectionContainer:{padding:20,width:400,paddingTop:0}})),[]),s=(0,o.useCallback)((()=>{(0,l().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none"})}),[]),i=(0,o.useCallback)((()=>{(0,l().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none"})}),[]),r=[(0,U.jsx)(W().wt,{children:(0,U.jsx)(M().sA,{id:"assistantOverflowMenu.MicrosoftTeamsIngestion.postEdit.listpoint1",defaultMessage:"Teams content is being updated according to your new selection"},"note-1-message")},"note-1"),(0,U.jsx)(W().wt,{children:(0,U.jsx)(M().sA,{id:"assistantOverflowMenu.MicrosoftTeamsIngestion.postEdit.listpoint2",defaultMessage:"This can take up to 48h and AI answers will be unavailable until it is complete."},"note-2-message")},"note-2")];return(0,U.jsx)(D().a,{showCloseIcon:!0,onDismiss:i,open:"post_edit_screen"===n,render:()=>(0,U.jsxs)("div",{style:t.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"microsoft-teams",title:(0,U.jsx)(M().sA,{id:"aiConnectors.microsoftTeams.postEdit.title",defaultMessage:"Update in Progress"}),subtext:(0,U.jsx)(M().sA,{id:"aiConnectors.microsoftTeams.postEdit.description",defaultMessage:"Here’s what you should know:"})}),(0,U.jsx)(W().wt,{style:t.sectionContainer,children:r.map(((e,n)=>(0,U.jsxs)(W().Ye,{gap:8,style:t.section,children:[(0,U.jsx)(N().A,{number:n+1}),(0,U.jsx)("div",{style:t.note,children:e})]},n)))}),(0,U.jsx)(W().wt,{style:t.bottomSectionContainer,children:(0,U.jsx)(R().A,{colorPalette:"blue",onClick:s,children:(0,U.jsx)(M().sA,{id:"aiConnectors.microsoftTeams.postEdit.primaryButton",defaultMessage:"Done"})})})]}),ariaLabel:e.formatMessage(qo.primedTextInput)})}var Yo=()=>t(980933),Jo=()=>t(645200);function Qo(){const{learnMoreUrl:e}=(0,d().hP)("notion-calendar"),n=(0,r().v3)(),t=(0,g().r)();return(0,U.jsx)(Te,{connector:"notion-calendar",screenName:"introduction",nextScreens:{notStarted:"authentication",inProgress:"connection_complete_screen",alreadyConnected:"already_connected",error:"error"},usesPopup:!1,learnMoreUrl:e,openAuthUrl:()=>{!async function(e){var n,t;const{environment:o}=e,s=null===(n=h().default.state.currentUserStore)||void 0===n?void 0:n.getEmail(),i=null===(t=h().default.state.sidebarSpaceViewStore)||void 0===t?void 0:t.getSpaceId();if(!s||!i)return;const r=await(0,Jo().II)({environment:o,email:s});if(!r)return;const a=await(0,Jo().Qz)({environment:o,code:r.code,encryptedToken:r.encryptedToken,spaceId:i,from:"agentSetup"})}({environment:n})},onNavigateToInProgressScreen:async()=>{if(!t)return;const e=await hn().callApi({eventName:"connectAiConnector",environment:n,data:{spaceId:t,connector:"notion-calendar"}});if(!("success"===e.type&&e.data.success))return;const o="success"===e.type?e.data:void 0,s=null!=o&&o.success?o.externalSourceName:void 0;Jn().g.setState({...Jn().g.state,status:"authenticated",isConnected:!0,isPersonalAuthComplete:!0,externalSourceName:s})}})}function $o(){const e=(0,a().K8)((()=>Jn().g.state.currentScreen),[]);return(0,U.jsx)(qe,{connector:"notion-calendar",open:"already_connected"===e,onDismiss:()=>{Jn().g.reset()}})}function Vo(){const{learnMoreUrl:e}=(0,d().hP)("notion-calendar");return(0,U.jsx)(Je,{connector:"notion-calendar",screenName:"not_admin_screen",learnMoreUrl:e})}function Xo(){return(0,U.jsx)(Z,{connector:"notion-calendar",screenName:"connection_complete_screen",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},ingestionNotNeeded:!0,onStartIngestion:void 0})}function Zo(){return(0,U.jsx)(Un,{connector:"notion-calendar",screenName:"connection_exist_screen",nextScreens:{settings:"none"},connectedSpaceId:""})}function es(){const e=(0,r().v3)(),n=(0,g().r)(),{learnMoreUrl:t,notionAuthUrl:o,troubleShootingUrl:s}=(0,d().hP)("notion-calendar");return n?(0,U.jsx)(O,{connector:"notion-calendar",screenName:"authentication",nextScreens:{notAdminOfConnectorAccount:"not_admin_screen",connectionConflict:"connection_exist_screen",connectionSuccess:"connection_complete_screen",error:"error"},learnMoreUrl:t,troubleShootingUrl:s,staticConnectorAuthUrl:o,setConnectionStateAsConnected:()=>{Jn().g.setState({...Jn().g.state,status:"authenticated",isConnected:!0,isPersonalAuthComplete:!0})},callConnectionApi:async()=>{const t=await hn().callApi({eventName:"connectAiConnector",environment:e,data:{spaceId:n,connector:"notion-calendar"}});return"success"===t.type&&t.data.success?Promise.resolve({type:"success",data:{connectionSuccess:!0}}):Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:401}}})}}):null}function ns(){return(0,U.jsx)(Ue,{connector:"notion-calendar",screenName:"settings",nextScreens:{disconnect:"disconnect_screen",error:"error"},settings:void 0})}function ts(){return(0,U.jsx)(se,{connector:"notion-calendar",postDisconnectScreenName:"post_disconnect_screen",disconnectScreenName:"disconnect_screen",settingsScreenName:"settings",errorScreenName:"error",setStatusAsDisconnected:()=>{Jn().g.setState({...Jn().g.state,status:"not_started",isConnected:!1,isLoaded:!0,isBackendConnected:!1})},showGoogleWorkspaceNote:!1})}function os(){return(0,U.jsx)(re,{connector:"notion-calendar",screenName:"error"})}function ss(){const{learnMoreUrl:e}=(0,d().hP)("notion-mail"),n=(0,r().v3)(),t=(0,g().r)(),o=(0,a().K8)((()=>{var e;const n=null===(e=h().default.state.currentUserStore)||void 0===e?void 0:e.id;return n?function(e){const{env:n,userId:t}=e;return`${function(e){return"local"===e?"http://localhost:4201":"development"===e?"https://mail.dev.notion.so":"https://mail.notion.so"}(n)}/inbox?hideExistingMailAccounts=true#activeUserID=${t}`}({env:"production",userId:n}):""}),[]);return(0,U.jsx)(Te,{connector:"notion-mail",screenName:"introduction",nextScreens:{notStarted:"authentication",inProgress:"connection_complete_screen",alreadyConnected:"already_connected",error:"error"},usesPopup:!1,learnMoreUrl:e,staticAuthUrl:o,onNavigateToInProgressScreen:async()=>{if(!t)return;const e=await hn().callApi({eventName:"connectAiConnector",environment:n,data:{spaceId:t,connector:"notion-mail"}});if(!("success"===e.type&&e.data.success))return;const o="success"===e.type?e.data:void 0,s=null!=o&&o.success?o.externalSourceName:void 0;Bn().L.setState({...Bn().L.state,status:"authenticated",isConnected:!0,isPersonalAuthComplete:!0,externalSourceName:s})}})}function is(){const e=(0,a().K8)((()=>Bn().L.state.currentScreen),[]);return(0,U.jsx)(qe,{connector:"notion-mail",open:"already_connected"===e,onDismiss:()=>{Bn().L.reset()}})}function rs(){const{learnMoreUrl:e}=(0,d().hP)("notion-mail");return(0,U.jsx)(Je,{connector:"notion-mail",screenName:"not_admin_screen",learnMoreUrl:e})}function as(){return(0,U.jsx)(Z,{connector:"notion-mail",screenName:"connection_complete_screen",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},ingestionNotNeeded:!0,onStartIngestion:void 0})}function cs(){return(0,U.jsx)(Un,{connector:"notion-mail",screenName:"connection_exist_screen",nextScreens:{settings:"none"},connectedSpaceId:""})}function ls(){const e=(0,r().v3)(),n=(0,g().r)(),{learnMoreUrl:t,notionAuthUrl:o,troubleShootingUrl:s}=(0,d().hP)("notion-mail");return n?(0,U.jsx)(O,{connector:"notion-mail",screenName:"authentication",nextScreens:{notAdminOfConnectorAccount:"not_admin_screen",connectionConflict:"connection_exist_screen",connectionSuccess:"connection_complete_screen",error:"error"},learnMoreUrl:t,troubleShootingUrl:s,staticConnectorAuthUrl:o,setConnectionStateAsConnected:()=>{Bn().L.setState({...Bn().L.state,status:"authenticated",isConnected:!0,isPersonalAuthComplete:!0})},callConnectionApi:async()=>{const t=await hn().callApi({eventName:"connectAiConnector",environment:e,data:{spaceId:n,connector:"notion-mail"}});return"success"===t.type&&t.data.success?Promise.resolve({type:"success",data:{connectionSuccess:!0}}):Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:401}}})}}):null}function ds(){return(0,U.jsx)(Ue,{connector:"notion-mail",screenName:"settings",nextScreens:{disconnect:"disconnect_screen",error:"error"},settings:void 0})}function us(){return(0,U.jsx)(se,{connector:"notion-mail",postDisconnectScreenName:"post_disconnect_screen",disconnectScreenName:"disconnect_screen",settingsScreenName:"settings",errorScreenName:"error",setStatusAsDisconnected:()=>{Bn().L.setState({...Bn().L.state,status:"not_started",isConnected:!1,isLoaded:!0,isBackendConnected:!1})},showGoogleWorkspaceNote:!1})}function gs(){return(0,U.jsx)(re,{connector:"notion-mail",screenName:"error"})}var ps=()=>t(291657);function ms(){const{learnMoreUrl:e}=(0,d().hP)("outlook");return(0,U.jsx)(Te,{connector:"outlook",screenName:"introduction",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},learnMoreUrl:e,usesPopup:!0})}function hs(){const e=(0,a().K8)((()=>ps().y.state.currentScreen),[]);return(0,U.jsx)(qe,{connector:"outlook",open:"already_connected"===e,onDismiss:()=>{ps().y.reset()}})}function vs(){const{learnMoreUrl:e}=(0,d().hP)("outlook");return(0,U.jsx)(Je,{connector:"outlook",screenName:"not_admin_screen",learnMoreUrl:e})}function fs(){return(0,U.jsx)(Z,{connector:"outlook",screenName:"connection_complete_screen",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},ingestionNotNeeded:!0,onStartIngestion:void 0})}function ys(){return(0,U.jsx)(Un,{connector:"outlook",screenName:"connection_exist_screen",nextScreens:{settings:"none"},connectedSpaceId:""})}function _s(){const e=(0,r().v3)(),n=(0,g().r)(),{learnMoreUrl:t,troubleShootingUrl:o}=(0,d().hP)("outlook");return n?(0,U.jsx)(O,{connector:"outlook",screenName:"authentication",nextScreens:{notAdminOfConnectorAccount:"not_admin_screen",connectionConflict:"connection_exist_screen",connectionSuccess:"connection_complete_screen",error:"error"},learnMoreUrl:t,troubleShootingUrl:o,setConnectionStateAsConnected:()=>{ps().y.setState({...ps().y.state,status:"authenticated",isConnected:!0,isPersonalAuthComplete:!0})},callConnectionApi:async()=>(await(0,l().updateOutlookAIConnectorStatus)({environment:e,spaceId:n}),(0,S().wd)().includes("outlook")?{type:"success",data:{connectionSuccess:!0}}:{type:"success",data:{connectionSuccess:!1,errorResponse:{status:401}}})}):null}function Ss(){return(0,U.jsx)(Ue,{connector:"outlook",screenName:"settings",nextScreens:{disconnect:"disconnect_screen",error:"error"},settings:void 0})}function xs(){return(0,U.jsx)(se,{connector:"outlook",postDisconnectScreenName:"post_disconnect_screen",disconnectScreenName:"disconnect_screen",settingsScreenName:"settings",errorScreenName:"error",showGoogleWorkspaceNote:!0,marketplaceAppConfigureUrl:"",marketplaceAppName:"",setStatusAsDisconnected:()=>{ps().y.reset()}})}function js(){return(0,U.jsx)(re,{connector:"outlook",screenName:"error"})}var bs=()=>t(723771);function Cs(){const{learnMoreUrl:e}=(0,d().hP)("salesforce");return(0,U.jsx)(Te,{connector:"salesforce",screenName:"introduction",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},usesPopup:!0,learnMoreUrl:e})}function Is(){const e=(0,r().v3)(),n=(0,g().r)(),{learnMoreUrl:t}=(0,d().hP)("salesforce");return n?(0,U.jsx)(O,{connector:"salesforce",screenName:"authentication",nextScreens:{connectionSuccess:"none",notAdminOfConnectorAccount:"none",connectionConflict:"none",error:"error"},learnMoreUrl:t,troubleShootingUrl:t,setConnectionStateAsConnected:()=>{bs().C.setState({...bs().C.state,status:"in_progress",ingestionProgress:1,isConnected:!1})},callConnectionApi:async()=>(await(0,l().updateSalesforceAIConnectorStatus)({environment:e,spaceId:n}),bs().C.state.ingestionProgress?{type:"success",data:{connectionSuccess:!0}}:{type:"success",data:{connectionSuccess:!1,errorResponse:{status:401}}})}):null}function ws(){return(0,U.jsx)(Z,{connector:"salesforce",screenName:"connection_complete_screen",nextScreens:{notStarted:"authentication",inProgress:"settings",alreadyConnected:"already_connected",error:"error"},ingestionNotNeeded:!1,onStartIngestion:void 0})}function ks(){return(0,U.jsx)(Ue,{connector:"salesforce",screenName:"settings",nextScreens:{disconnect:"disconnect",error:"error"},settings:void 0})}var As=()=>t(92383);function Ms(){const[e,n]=o.useState(!1),[t,s]=o.useState(void 0),i=(0,r().v3)(),d=(0,g().r)(),u=(0,a().K8)((()=>As().E.state.currentScreen),[]);(0,c().Yb)((async()=>{if(!d||"connecting"!==u)return;const e=await hn().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:i,data:{connector:"sharepoint",authorizationType:"workspace",spaceId:d,sessionId:As().E.state.sessionId,client:i.device.isElectron?"desktop":"web"}});if("success"!==e.type)return;const n=e.data.authorizationUrl;s(n)}),[i,u,d]);const p=(0,I().IS)((e=>({noteHeading:{fontWeight:T().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:T().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{width:18,height:17,color:"#D7813A",marginTop:2},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingInlineStart:14,fontWeight:T().Wy.regular},warningContainer:{marginInlineStart:5,marginInlineEnd:5,marginBottom:15}})),[]),m=(0,Mt().$)();(0,xo().n)((async()=>{if(!d)return;if("connecting"!==As().E.state.currentScreen)return;const e=await(0,l().getSharepointConnectorDetails)({environment:i,spaceId:d});"not_started"!==e.status&&As().E.setState({...As().E.state,currentScreen:"confirmation",connectionDetails:{status:"pending_selection",progress:0,externalSourceName:e.externalSourceName}})}),2e3,!0);const h=(0,o.useCallback)((async()=>{if(!d)return;"not_started"!==(await(0,l().getSharepointConnectorDetails)({environment:i,spaceId:d})).status?(0,l().navigateToSharepointUniversalScreen)({currentScreen:"confirmation"}):n(!0),(0,b().u)({environment:i,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_button_clicked",integration_type:"sharepoint",setup_session_id:As().E.state.sessionId,from:As().E.state.analyticsFrom}}})}),[i,d]),v=(0,o.useCallback)((()=>{n(!1),(0,b().u)({environment:i,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_modal_dismissed",integration_type:"sharepoint",setup_session_id:As().E.state.sessionId,from:As().E.state.analyticsFrom}}}),As().E.reset()}),[i]);if(!m||!d)return null;const f=e?(0,U.jsxs)(W().Ye,{style:p.warningContainer,children:[(0,L().Q)(p.icon),(0,U.jsx)("div",{style:p.warningText,children:(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.checkConnection.warning",defaultMessage:"We couldn’t connect to SharePoint. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{TroubleshootingGuide:(0,U.jsx)("a",{style:{...p.link,color:"#D7813A"},href:(0,B().x)("guides.aiConnectorSharepoint"),target:"_blank",onClick:()=>{(0,b().u)({environment:i,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"troubleshooting_guide_clicked",integration_type:"sharepoint",setup_session_id:As().E.state.sessionId,from:As().E.state.analyticsFrom}}})},children:(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.checkConnection.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,U.jsx)(q,{title:(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.checkConnection.title",defaultMessage:"Follow instructions from SharePoint in your browser"}),open:"connecting"===u,onDismiss:v,warningMessage:f,notes:[(0,U.jsxs)(W().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:p.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.checkConnection.openAuthorizationUrlInNewTabTitle",defaultMessage:"SharePoint should open automatically on a new browser tab."},"note1-1")}),(0,U.jsx)("div",{style:p.noteBody,children:(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.checkConnection.authWaiting2",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,U.jsx)("a",{style:p.link,href:t,target:"_blank",onClick:()=>{(0,b().u)({environment:i,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"retry_opening_sharepoint_auth_url",integration_type:"sharepoint",setup_session_id:As().E.state.sessionId,from:As().E.state.analyticsFrom}}})},children:(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.checkConnection.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,U.jsxs)(W().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:p.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.checkConnection.followInstructions",defaultMessage:"Follow SharePoint’s instructions to connect"},"note2")}),(0,U.jsx)("div",{style:p.noteBody,children:(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.checkConnection.followInstructionsDescription",defaultMessage:"Install the Notion connector in a SharePoint workspace and return to this window"},"note1-2")})]},"note-2"),(0,U.jsx)(W().wt,{style:{gap:4},children:(0,U.jsx)("div",{style:p.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.checkConnection.returnToNotion",defaultMessage:"Return to this window, and the process will continue automatically."},"note3")})},"note-3")],openLearnMoreUrl:()=>{window.open((0,B().x)("guides.aiConnectorSharepoint"),"_blank")},connectorType:"sharepoint",primaryButtonText:(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.checkConnection.checkConnectionButton",defaultMessage:"Check Connection"},"note3-1"),onClickPrimaryButton:h})}const Ts=K().w0.sharepoint;function Ns(){const e=(0,M().tz)(),n=(0,r().v3)(),t=(0,a().K8)((()=>As().E.state.currentScreen),[]),s=(0,g().r)(),i=(0,o.useCallback)((async()=>{if(!s)return;(0,b().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_settings_button_clicked",integration_type:"sharepoint",setup_session_id:As().E.state.sessionId,from:As().E.state.analyticsFrom}}});const e=await(0,l().getSharepointConnectorDetails)({environment:n,spaceId:s});e?"in_progress"!==e.status&&"editing"!==e.status?"pending_selection"!==e.status&&"completed"!==e.status?(0,l().navigateToSharepointUniversalScreen)({currentScreen:"error"}):(0,l().navigateToSharepointUniversalScreen)({currentScreen:"settings"}):(0,l().navigateToSharepointUniversalScreen)({currentScreen:"edit_blocked"}):(0,l().navigateToSharepointUniversalScreen)({currentScreen:"error"})}),[s,n]),c=(0,o.useCallback)((async()=>{if(!s)return;(0,b().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"ingestion_started",integration_type:"sharepoint",setup_session_id:As().E.state.sessionId,from:As().E.state.analyticsFrom}}});const t=await(0,l().getSharepointConnectorDetails)({environment:n,spaceId:s});if(!t)return J().D6({label:e.formatMessage({defaultMessage:"Action failed. Please try again.",id:"universalSearch.sharepoint.connectionComplete.retryActionRequest"}),position:"bottom"}),void As().E.reset();if(["disconnecting","editing"].includes(t.status))return J().D6({label:e.formatMessage({defaultMessage:"Failed to update the connection. Please try again later.",id:"universalSearch.sharepoint.connectionComplete.failedToUpdateConnection"}),position:"bottom"}),void As().E.reset();if(["in_progress","completed"].includes(t.status))return void As().E.reset();await hn().callApi({eventName:"startIngestion",environment:n,data:{connector:"sharepoint",spaceId:s,setupSessionId:As().E.state.sessionId}})?As().E.reset():J().D6({label:e.formatMessage({defaultMessage:"Failed to start sync. Please try again later.",id:"universalSearch.sharepoint.connectionComplete.failedToStartSync"}),position:"bottom"})}),[s,n,e]);return(0,o.useEffect)((()=>{"confirmation"===t&&(0,l().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:n,connector:"sharepoint",moment:"finished"})}),[n,t]),(0,U.jsx)(V,{open:"confirmation"===t,onDismiss:c,connectorType:"sharepoint",notes:[(0,U.jsx)(X,{number:1,title:{...{...$.connectionInProgressTitle,values:{appName:Ts}}},description:$.defaultConnectionTime},"item1"),(0,U.jsx)(X,{number:2,title:{...{...$.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:Ts}}}},"item2")],onEditSettingsClick:i,onPrimaryButtonClick:c})}function Ds(){const e=(0,M().tz)(),n=(0,I().IS)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:T().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.medium,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:T().J.UIRegular.desktop,fontWeight:T().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{paddingTop:12,paddingInlineEnd:12,paddingBottom:12,paddingInlineStart:12,gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:T().Wy.regular,fontSize:T().J.UIRegular.desktop,lineHeight:"18px"},noteHeading:{fontWeight:T().Wy.medium,fontSize:T().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{fontWeight:T().Wy.regular,color:e.text.secondary,fontSize:T().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{rotate:"45deg",width:12,height:12,cursor:"pointer",display:"inline",padding:0,margin:0}})),[]),[t,s]=(0,o.useState)(!1),i=(0,a().K8)((()=>As().E.state.currentScreen),[]),c=(0,g().r)(),l=(0,r().v3)(),d=(0,o.useCallback)((()=>{As().E.reset()}),[]),u=(0,o.useCallback)((()=>{As().E.reset()}),[]),p=(0,o.useCallback)((async()=>{if(s(!0),!c)return void s(!1);(0,b().u)({environment:l,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_button_clicked",integration_type:"sharepoint",setup_session_id:As().E.state.sessionId,from:As().E.state.analyticsFrom}}});const e=await async function(e){const{environment:n,spaceId:t}=e,o=await hn().callApi({eventName:"disconnectAiConnector",environment:n,data:{spaceId:t,connector:"sharepoint"}});if("success"===o.type)return J().D6({label:Mn().A.getIntl().formatMessage({defaultMessage:"Started disconnecting SharePoint. This can take up to 3 hours.",id:"sharepoint.disconnect.started"}),position:"bottom",style:{width:"400px",display:"flex",justifyContent:"space-between"}}),!0;return!1}({environment:l,spaceId:c});e&&As().E.setState({...As().E.state,status:"disconnecting",currentScreen:"post_disconnect"}),s(!1)}),[l,c]),m=(0,o.useCallback)((()=>{As().E.setState({...As().E.state,currentScreen:"settings"})}),[]),h=(0,o.useCallback)((()=>{const{noteBlockWrapper:e,noteHeading:t,noteBody:o}=n;return[(0,U.jsxs)(W().wt,{style:e,children:[(0,U.jsx)("div",{style:t,children:(0,U.jsx)(M().sA,{...Ws.note1Heading})}),(0,U.jsx)("div",{style:o,children:(0,U.jsx)(M().sA,{...Ws.note1Body})})]},"note-1")]}),[n]);return"post_disconnect"===i?(0,U.jsx)(oe,{onClickGotItBtn:u,onDismiss:d,open:"post_disconnect"===i,connectorType:"sharepoint",title:(0,U.jsx)(M().sA,{...Ws.postDisconnectTitle}),descriptionMessage:(0,U.jsx)(M().sA,{...Ws.postDisconnectDescription}),message:(0,U.jsx)("div",{style:n.notesSectionWrapper,children:h().map(((e,t)=>(0,U.jsx)(W().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:(0,U.jsx)("div",{style:n.note,children:e})},t)))})}):(0,U.jsx)(D().a,{showCloseIcon:!0,open:"disconnect"===i,onDismiss:d,render:()=>(0,U.jsx)("div",{style:n.confirmWrapper,children:(0,U.jsxs)("div",{style:n.confirmContainer,children:[(0,U.jsx)("div",{style:n.confirmModalTitle,children:(0,U.jsx)(M().sA,{...Ws.disconnectTitle})}),(0,U.jsx)("div",{style:n.confirmModalSubTitle,children:(0,U.jsx)(M().sA,{...Ws.disconnectSubTitle})}),(0,U.jsx)("div",{style:n.confirmModalDescription,children:(0,U.jsx)(M().sA,{...Ws.disconnectDescription})}),(0,U.jsxs)(W().wt,{style:n.confirmModalActionButtons,children:[(0,U.jsx)(R().A,{colorPalette:"red",style:n.confirmDisconnectButton,isLoading:t,onClick:p,children:(0,U.jsx)(M().sA,{...Ws.primaryButtonLabel})}),(0,U.jsx)(w().Ay,{style:n.goBackButton,onClick:m,children:(0,U.jsx)(M().sA,{...Ws.goBackButtonLabel})})]})]})}),ariaLabel:e.formatMessage(Ws.disconnectModalAriaLabel)})}const Ws=(0,M().YK)({note1Heading:{id:"universalSearch.sharepoint.postDisconnect.note_1.heading",defaultMessage:"SharePoint data will be permanently deleted from Notion"},note1Body:{id:"universalSearch.sharepoint.postDisconnect.note_1.body",defaultMessage:"This process can take up to 3 hours. You’ll only be able to reconnect after disconnecting is complete."},postDisconnectTitle:{id:"universalSearch.sharepoint.postDisconnect.title",defaultMessage:"SharePoint is disconnecting from Notion AI"},postDisconnectDescription:{id:"universalSearch.sharepoint.postDisconnect.description",defaultMessage:"Here’s what you should know:"},disconnectTitle:{id:"universalSearch.sharepoint.disconnectModal.title",defaultMessage:"Are you sure?"},disconnectSubTitle:{id:"universalSearch.sharepoint.disconnectModal.subTitle",defaultMessage:"SharePoint data will be permanently deleted from Notion."},disconnectDescription:{id:"universalSearch.sharepoint.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."},primaryButtonLabel:{id:"universalSearch.sharepoint.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"},goBackButtonLabel:{id:"universalSearch.sharepoint.disconnectModal.goBack",defaultMessage:"Go back"},disconnectModalAriaLabel:{id:"universalSearch.sharepoint.disconnectModal.label",defaultMessage:"Disconnect SharePoint Modal"}});function Bs(){const e=(0,M().tz)(),n=(0,a().K8)((()=>As().E.state.currentScreen),[]),t=(0,I().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{fontSize:14,fontWeight:T().Wy.semibold,width:"100%"}})),[]);return(0,U.jsx)(D().a,{open:"error"===n,showCloseIcon:!0,onDismiss:()=>{As().E.reset()},render:()=>(0,U.jsxs)("div",{style:t.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"sharepoint",title:(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.error.title",defaultMessage:"Oops! Something went wrong"}),subtext:(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.error.description",defaultMessage:"Something went wrong, please try again later."})}),(0,U.jsx)(W().wt,{style:t.footer,children:(0,U.jsx)(R().A,{colorPalette:"blue",style:t.connectButton,onClick:()=>{As().E.reset()},children:(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.dismissButton",defaultMessage:"Close"})})})]}),ariaLabel:e.formatMessage({id:"universalSearch.sharepoint.error.ariaLabel",defaultMessage:"SharePoint error modal"})})}function Ps(e){const{open:n}=e;return(0,U.jsx)(qe,{open:n,onDismiss:()=>{As().E.reset()},connector:"sharepoint"})}const Fs=(0,M().YK)({sharepointAIConnectorOauthPopupTitle:{defaultMessage:"Connect SharePoint AI Connector",id:"sharepointAIConnector.oauthPopupTitle"}});function Us(){const e=(0,M().tz)(),n=(0,o.useMemo)((()=>ve("sharepoint")),[]),t=(0,o.useMemo)((()=>fe("sharepoint")),[]),s=(0,r().v3)(),[i,d]=(0,o.useState)("CLOSED"),u=(0,g().r)(),p=(0,a().O$)(As().E),m=(0,a().K8)((()=>As().E.state.sessionId),[]),h=(0,a().K8)((()=>As().E.state.analyticsFrom),[]),v=(0,I().IS)((()=>({loadingWrapper:{padding:20,fontSize:12,fontWeight:T().Wy.regular,justifyContent:"center",gap:8,alignItems:"center"}})),[]),f=(0,de().J)(),y=(0,_().P9)({name:"ai_connectors",spaceId:u,userId:s.currentUser.id}),S=(0,o.useCallback)((()=>{const e=(0,B().x)("guides.aiConnectorSharepoint");(0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_intro_modal",integration_type:"sharepoint",setup_session_id:As().E.state.sessionId,from:As().E.state.analyticsFrom}}}),s.device.isElectron?(0,C().P)(e):window.open(e,"_blank")}),[s]),x=(0,o.useCallback)((async()=>{if(!u)return;const e=await hn().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:s,data:{connector:"sharepoint",authorizationType:"workspace",spaceId:u,client:s.device.isElectron?"desktop":"web",sessionId:As().E.state.sessionId}});if("success"!==e.type)return;const n=e.data.authorizationUrl;s.device.isElectron?(0,C().P)(n):ce().P(s,{width:800,height:600,url:n,titleMessage:Fs.sharepointAIConnectorOauthPopupTitle}),As().E.setState({...As().E.state,authUrl:n,currentScreen:"connecting"})}),[u,s]),[j]=(0,c().Yb)((async()=>{if(!u||"introduction"!==p.currentScreen)return;const e=await hn().callApi({eventName:"listAIConnectors",environment:s,data:{spaceId:u}});return"success"===e.type?{isSharepointConnected:e.data.connectedConnectors.map((e=>e.id)).some((e=>"sharepoint"===e))}:void 0}),[s,p.currentScreen,u]);(0,o.useEffect)((()=>{"introduction"===p.currentScreen?"resolved"===j.status?d("OPEN"):d("LOADING"):d("CLOSED")}),[j.status,p.currentScreen]);const w=(0,o.useRef)(!1),k=(0,o.useCallback)((()=>{As().E.reset(),(0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_sharepoint_intro_modal",integration_type:"sharepoint",setup_session_id:As().E.state.sessionId,from:As().E.state.analyticsFrom}}}),w.current=!1}),[s]),A=(0,o.useCallback)((async()=>{await x(),(0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"sharepoint_ai_connector_auth_url_open",integration_type:"sharepoint",setup_session_id:As().E.state.sessionId,from:As().E.state.analyticsFrom}}}),(0,l().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:s,connector:"sharepoint",moment:"started"}),As().E.setState({...As().E.state,currentScreen:"connecting"})}),[s,x]);return(0,o.useEffect)((()=>{u&&f&&"resolved"===j.status&&"introduction"===p.currentScreen&&(w.current||((0,b().u)({environment:s,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"sharepoint",setup_session_id:p.sessionId,from:p.analyticsFrom,is_space_admin:f,is_ai_eligible:y??!1}}}),w.current=!0))}),[u,s,j.status,p.sessionId,p.analyticsFrom,f,y,p.currentScreen]),u&&"CLOSED"!==i?s.device.isMobile?(0,U.jsx)(_e,{connectorType:"sharepoint",open:"introduction"===p.currentScreen,onClosed:()=>{As().E.reset()},learnMoreUrl:(0,B().x)("guides.aiConnectorSharepoint")}):"LOADING"===i?(0,U.jsx)(D().a,{ariaLabel:e.formatMessage({id:"sharepointAIConnector.oauthPopupTitle.ariaLabel",defaultMessage:"Loading SharePoint AI connector status"}),open:"LOADING"===i,render:()=>(0,U.jsxs)(W().Ye,{style:v.loadingWrapper,children:[(0,U.jsx)(M().sA,{id:"universalQna.sharepoint.isFetchingConnection",defaultMessage:"Getting connection status"}),(0,U.jsx)(We().k,{})]})}):p.isConnected?(0,U.jsx)(Ps,{open:!0}):f?(0,U.jsx)(ke,{onConnect:A,onDismiss:k,onLearnMore:S,title:n,connectorType:"sharepoint",notes:t,open:"OPEN"===i}):(0,U.jsx)(Ie,{connector:"sharepoint",analyticsFrom:h,setupSessionId:m,handleClose:()=>(0,l().resetAiConnectorStatus)("sharepoint"),open:"OPEN"===i,messages:ye().oO}):null}t(814603),t(147566),t(198721);var Es=()=>t(493552),zs=()=>t(784892),Ls=()=>t(842599),Ks=()=>t(484595),Hs=()=>t(288864),Rs=()=>t(881690),Gs=()=>t(856952);function qs(e){const{onSaveSettings:n,disabled:t}=e,o=Js();return(0,U.jsx)(R().A,{colorPalette:"blue",style:o.connectButton,onClick:n,disabled:t,children:(0,U.jsx)(M().sA,{...Ys.saveButton})})}function Os(){const[e,n]=(0,o.useState)(!0),[t,s]=(0,o.useState)(!1),[i,d]=(0,o.useState)(""),[u,p]=(0,o.useState)([]),[m,h]=(0,o.useState)([]),[v,f]=(0,o.useState)([]),[y,_]=(0,o.useState)(!0),[S,x]=(0,o.useState)(!1),j=Js(),C=(0,r().v3)(),I=(0,M().tz)(),w=(0,g().r)(),k=(0,a().K8)((()=>As().E.state.currentScreen),[]),A=(0,a().K8)((()=>{var e;return null===(e=As().E.state.connectionDetails)||void 0===e?void 0:e.status}),[]);(0,c().Yb)((async()=>{if(!w||"settings"!==k)return;if(!A)return n(!1),void As().E.reset();if(["in_progress","disconnecting","editing"].includes(A))return n(!1),void As().E.reset();n(!0);const e=await hn().callApi({eventName:"getAllSharepointSites",environment:C,data:{spaceId:w}}),t=await hn().callApi({eventName:"getSharepointSelection",environment:C,data:{spaceId:w}});if("failed"===e.type||"failed"===t.type)return;const o=e.data;p(t.data.includedSites),h(t.data.excludedSites),x(t.data.includeFutureSites),f(o),n(!1)}),[w,k,A,C]),(0,o.useEffect)((()=>{const e=v.filter((e=>![...u,...m].includes(e.id)));if(e.length>0){const n=S?e.map((e=>e.id)):[],t=S?[]:e.map((e=>e.id));n.length>0&&p((e=>[...e,...n])),t.length>0&&h((e=>[...e,...t]))}}),[v,S,u,m]),(0,o.useEffect)((()=>{u.length===v.length?_(!0):u.length>0?_("partial"):_(!1)}),[u,v]);const T=(0,o.useCallback)((e=>u.includes(e)),[u]),N=(0,o.useCallback)((e=>{u.includes(e)?(p((n=>n.filter((n=>n!==e)))),h((n=>[...n,e]))):(h((n=>n.filter((n=>n!==e)))),p((n=>[...n,e])))}),[u]),B=(0,o.useCallback)((()=>{u.length>0?(p([]),h(v.map((e=>e.id)))):(p(v.map((e=>e.id))),h([]))}),[u,v]),P=(0,o.useCallback)((()=>u.length>0),[u]),E=(0,a().K8)((()=>He().AssistantFeatureGateStore.isSharepointSelectionV2Enabled()),[]),z=(0,o.useCallback)((()=>{(0,b().u)({environment:C,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_close",integration_type:"sharepoint",setup_session_id:As().E.state.sessionId,from:As().E.state.analyticsFrom}}}),As().E.setState({...As().E.state,currentScreen:"none"})}),[C]),L=(0,o.useCallback)((async()=>{if(!w)return;(0,b().u)({environment:C,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"save_settings_button_clicked",integration_type:"sharepoint",setup_session_id:As().E.state.sessionId,from:As().E.state.analyticsFrom}}}),s(!0);const e=await(0,l().getSharepointConnectorDetails)({environment:C,spaceId:w});return e?"completed"!==e.status&&"pending_selection"!==e.status?(J().D6({label:I.formatMessage(Ys.alreadySyncing),position:"bottom"}),s(!1),void As().E.reset()):(await hn().callApi({eventName:"setSharepointSelection",environment:C,data:{spaceId:w,allSites:!0===y,includedSites:u,excludedSites:m,includeFutureSites:S}}),await hn().callApi({eventName:"startIngestion",environment:C,data:{connector:"sharepoint",spaceId:w,setupSessionId:As().E.state.sessionId}}),s(!1),J().D6({label:I.formatMessage(Ys.syncingWithNewSyncControl),position:"bottom"}),void(0,l().navigateToSharepointUniversalScreen)({currentScreen:"post_edit"})):(J().D6({label:I.formatMessage(Ys.retryActionRequest),position:"bottom"}),void s(!1))}),[w,C,I,y,u,m,S]),K=(0,o.useCallback)((()=>{w?(0,l().navigateToSharepointUniversalScreen)({currentScreen:"disconnect"}):As().E.reset()}),[w]),H=(0,o.useCallback)((()=>(0,U.jsxs)(W().wt,{children:[(0,U.jsxs)(W().Ye,{style:j.siteItem,children:[(0,U.jsx)("div",{children:(0,U.jsx)(at().S,{disabled:t,checked:y,size:14,onClick:()=>{B()}})}),(0,U.jsx)("div",{style:j.sitesText,children:(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.settings.allSitesToggle",defaultMessage:"All sites"})}),E?(0,U.jsx)("div",{style:j.manualSettingsLink,children:(0,U.jsx)(Hs()._,{href:"#",external:!0,onClick:()=>{(0,l().navigateToSharepointUniversalScreen)({currentScreen:"manual_settings"})},children:(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.manualSettings.manualSettings",defaultMessage:"Manual Settings"})})}):void 0]}),(0,U.jsx)(lt().A,{style:j.divider,size:4}),(0,U.jsx)(U.Fragment,{children:e?(0,U.jsxs)(W().Ye,{style:j.futureSitesCheckboxWrapper,children:[(0,U.jsx)(We().k,{}),(0,U.jsx)("div",{style:j.sitesText,children:(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.settings.loadingSites",defaultMessage:"Fetching sites. This can take up to a few minutes based on the number of sites in your account."})})]}):(0,U.jsx)(W().wt,{style:j.selectionWrapper,children:(i?v.filter((e=>(e.name||e.id).toLowerCase().includes(i.toLowerCase()))):v).map((e=>(0,U.jsxs)(W().Ye,{gap:8,style:j.siteItemWrapper,children:[(0,U.jsx)("div",{children:(0,U.jsx)(at().S,{disabled:t,checked:T(e.id),onClick:()=>{N(e.id)},size:14},`${e.id}-checkbox`)}),(0,U.jsx)("div",{style:j.sitesText,children:` ${e.name||e.id}`},`${e.id}-label`)]},e.id)))})})]})),[j,t,y,e,i,v,B,T,N,E]);return(0,U.jsx)(D().a,{open:"settings"===k,showCloseIcon:!0,onDismiss:z,render:()=>(0,U.jsxs)("div",{style:j.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"sharepoint",title:(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.settings.title",defaultMessage:"Connection Settings"})}),(0,U.jsx)(dt().A,{capture:!0,allowEsc:!0,render:()=>(0,U.jsx)("div",{children:(0,U.jsx)(W().Ye,{style:j.searchBarWrapper,children:(0,U.jsx)($t().A,{id:"sharepointUniversalQnASearchBar",style:j.searchBar,placeholder:I.formatMessage(Ys.searchBoxPlaceholder),value:i,onChange:e=>{d(e.target.value)},disabled:e},"sharepointUniversalQnASearchBar")})})}),(0,U.jsx)(W().Ye,{style:j.selectionContainer,children:(0,U.jsx)(W().wt,{style:j.selection,children:H()})}),(0,U.jsxs)(W().wt,{style:j.footer,children:[(0,U.jsxs)(W().Ye,{style:j.futureSitesCheckboxWrapper,children:[(0,U.jsx)("div",{children:(0,U.jsx)(at().S,{disabled:t,checked:S,size:14,onClick:()=>{x(!S)}})}),(0,U.jsx)("div",{style:j.sitesText,children:(0,U.jsx)(M().sA,{...Ys.syncFutureSitesCheckboxLabel})})]}),(0,U.jsx)(qs,{onSaveSettings:L,disabled:t||e||!P()&&!S}),(0,U.jsx)(Qs,{onDisconnect:K,disabled:t||e||"in_progress"===A})]})]}),ariaLabel:I.formatMessage(Ys.modalAriaLabel)})}const Ys=(0,M().YK)({saveButton:{id:"universalSearch.sharepoint.settings.settingsModal.saveChangesButtonText",defaultMessage:"Save Changes"},disconnectButton:{id:"universalSearch.sharepoint.settings.settingsModal.disconnectButtonText",defaultMessage:"Disconnect"},modalAriaLabel:{id:"universalSearch.sharepoint.settings.modalAriaLabel",defaultMessage:"SharePoint error modal"},searchBoxPlaceholder:{id:"universalSearch.sharepoint.settings.searchBoxPlaceholder",defaultMessage:"Search for a site"},alreadySyncing:{defaultMessage:"SharePoint is already syncing. This can take up to 72 hours.",id:"universalSearch.sharepoint.settings.alreadySyncing"},retryActionRequest:{defaultMessage:"Action failed. Please try again.",id:"universalSearch.sharepoint.settings.retryActionRequest"},syncFutureSitesCheckboxLabel:{id:"universalSearch.sharepoint.settings.syncFutureSitesCheckboxLabel",defaultMessage:"Include sites created in the future"},syncingWithNewSyncControl:{id:"universalSearch.sharepoint.settings.syncingWithNewSyncControl",defaultMessage:"Started syncing from SharePoint. This can take up to 72 hours."}});function Js(){return(0,I().IS)((e=>({wrapper:{width:400,display:"flex",flexDirection:"column",minHeight:530},footer:{width:"100%",justifySelf:"flex-end",boxShadow:"0px 9px 24px 0px #0F0F0F33",paddingTop:16,paddingInlineEnd:20,paddingBottom:16,paddingInlineStart:20,gap:12,bottom:0},connectButton:{fontSize:14,fontWeight:T().Wy.semibold,width:360},searchBarWrapper:{justifyContent:"center"},searchBar:{width:360,padding:4},selectionContainer:{marginTop:18,marginBottom:0,width:"100%",height:"100%",justifyContent:"center",padding:"0px 20px 0px",flexGrow:1},selection:{width:"100%"},siteItem:{gap:4,alignItems:"center"},sitesText:{fontSize:12,lineHeight:"16px",display:"flex",flexDirection:"row",gap:4},divider:{marginTop:5,marginBottom:5},futureSitesCheckboxWrapper:{gap:12,visibility:"visible"},selectionWrapper:{overflowY:"scroll",maxHeight:170},siteItemWrapper:{marginTop:12},manualSettingsLink:{fontSize:12,paddingInlineStart:"200px"}})),[])}function Qs(e){const{onDisconnect:n,disabled:t}=e,o=Js();return(0,U.jsx)(H().A,{colorPalette:"red",style:o.connectButton,disabled:t,onClick:n,children:(0,U.jsx)(M().sA,{...Ys.disconnectButton})})}function $s(){const[e,n]=(0,o.useState)([]),[t,s]=(0,o.useState)(""),[i,d]=(0,o.useState)([]),[u,p]=(0,o.useState)(""),[m,h]=(0,o.useState)("inclusion"),[v,f]=(0,o.useState)(!0),[y,_]=(0,o.useState)(!0),S=(0,I().IS)((e=>({wrapper:{width:400,maxHeight:"80vh",paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20},content:{flex:1,overflowY:"auto",paddingInlineEnd:4},section:{marginTop:6,marginBottom:8},sectionHeader:{fontSize:12,fontWeight:T().Wy.medium,marginBottom:6},listTypeSection:{marginBottom:6},listTypeLabel:{fontSize:12,fontWeight:T().Wy.medium,color:e.text.secondary,marginBottom:8},listTypeInput:{fontSize:12,fontWeight:T().Wy.medium,color:e.text.secondary},radioOption:{display:"flex",alignItems:"center",cursor:"pointer",userSelect:"none"},radioLabel:{fontSize:14,color:e.text.primary},inputContainer:{minHeight:56,padding:"8px 12px"},browseSitesWrapper:{marginBottom:4,paddingInlineStart:204},tokenInput:{borderRadius:6,padding:"6px 8px"},infoCircleIcon:{width:21,height:24,paddingInlineStart:4,paddingBottom:5},footer:{gap:12,marginTop:6,paddingTop:12}})),[]),x=(0,r().v3)(),j=(0,M().tz)(),C=(0,g().r)(),w=(0,a().K8)((()=>As().E.state.currentScreen),[]);(0,c().Yb)((async()=>{if(!C||"manual_settings"!==w)return void _(!1);_(!0);const e=await hn().callApi({eventName:"getSharepointManualSelection",environment:x,data:{spaceId:C}});"success"!==e.type&&404!==e.status||("success"===e.type&&(n(e.data.sites.map((e=>({id:e,url:e})))),d(e.data.users.map((e=>({id:e,email:e})))),h(e.data.listType),f(!1)),_(!1))}),[C,x,w]);const k=(0,o.useCallback)((()=>{(0,b().u)({environment:x,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"manual_settings_modal_close",integration_type:"sharepoint",setup_session_id:As().E.state.sessionId,from:As().E.state.analyticsFrom}}}),As().E.setState({...As().E.state,currentScreen:"none"})}),[x]),A=(0,o.useCallback)((async()=>{if(!C)return;(0,b().u)({environment:x,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"save_manual_settings_button_clicked",integration_type:"sharepoint",setup_session_id:As().E.state.sessionId,from:As().E.state.analyticsFrom}}}),f(!0);const n=await(0,l().getSharepointConnectorDetails)({environment:x,spaceId:C});if(!n)return J().D6({label:j.formatMessage(Ys.retryActionRequest),position:"bottom"}),void f(!1);if("completed"!==n.status&&"pending_selection"!==n.status)return J().D6({label:j.formatMessage(Ys.alreadySyncing),position:"bottom"}),f(!1),void As().E.reset();const t=e.map((e=>e.url)),o=i.map((e=>e.email));await hn().callApi({eventName:"setSharepointManualSelection",environment:x,data:{spaceId:C,sites:t,users:o,listType:m}}),await hn().callApi({eventName:"startIngestion",environment:x,data:{connector:"sharepoint",spaceId:C,setupSessionId:As().E.state.sessionId}}),f(!1),J().D6({label:j.formatMessage(Ys.syncingWithNewSyncControl),position:"bottom"}),(0,l().navigateToSharepointUniversalScreen)({currentScreen:"post_edit"})}),[C,x,e,i,m,j]),N=(0,o.useCallback)((()=>{C?(0,l().navigateToSharepointUniversalScreen)({currentScreen:"disconnect"}):As().E.reset()}),[C]),B=(0,o.useCallback)((n=>{const t=n.target.value,{extractedEmails:o,newInputValue:s}=(0,Ls().Ct)(t),r=o.filter((e=>(0,Ls().DT)(e.trim()))).map((e=>({id:Date.now().toString()+Math.random().toString(36).substr(2,9),email:e.trim()}))).filter((e=>!i.some((n=>n.email===e.email))));r.length>0?d((n=>{const t=[...n,...r];return f(!(t.length>0||e.length>0)),t})):f(!(i.length>0||e.length>0)),p(s)}),[i,e]),P=(0,o.useCallback)((n=>{if("Enter"===n.key){const n=u.trim();if(n&&(0,Ls().DT)(n)&&!i.some((e=>e.email===n))){const t={id:Date.now().toString()+Math.random().toString(36).substr(2,9),email:n};d((n=>{const o=[...n,t];return f(!(o.length>0||e.length>0)),o})),p("")}}}),[u,i,e]),E=(0,o.useCallback)((n=>{d((t=>{const o=t.filter((e=>e.id!==n.id));return f(!(o.length>0||e.length>0)),o}))}),[e]),z=(0,o.useCallback)((()=>{d((n=>{const t=n.slice(0,-1);return f(!(t.length>0||e.length>0)),t}))}),[e]),L=(0,o.useCallback)((()=>{const n=u.trim();if(n&&(0,Ls().DT)(n)&&!i.some((e=>e.email===n))){const t={id:Date.now().toString()+Math.random().toString(36).substr(2,9),email:n};d((n=>{const o=[...n,t];return f(!(o.length>0||e.length>0)),o})),p("")}}),[u,i,e]),K=(0,o.useCallback)((e=>{try{const n=new URL(e);return n.hostname.includes("sharepoint.com")&&n.pathname.includes("/sites/")}catch{return!1}}),[]),H=(0,o.useCallback)((t=>{const o=t.target.value;if(s(o),o.includes(",")||o.includes("\n")){const t=o.split(/[,\n]/).filter((e=>e.trim())).filter((e=>K(e.trim()))).map((e=>({id:Date.now().toString()+Math.random().toString(36).substr(2,9),url:e.trim()}))).filter((n=>!e.some((e=>e.url===n.url))));t.length>0?(n((e=>{const n=[...e,...t];return f(!(n.length>0||i.length>0)),n})),s("")):f(!(e.length>0||i.length>0))}}),[e,K,i]),R=(0,o.useCallback)((o=>{if("Enter"===o.key){const o=t.trim();if(o&&K(o)&&!e.some((e=>e.url===o))){const e={id:Date.now().toString()+Math.random().toString(36).substr(2,9),url:o};n((n=>{const t=[...n,e];return f(!(t.length>0||i.length>0)),t})),s("")}}}),[t,e,K,i]),G=(0,o.useCallback)((()=>{const o=t.trim();if(o&&K(o)&&!e.some((e=>e.url===o))){const e={id:Date.now().toString()+Math.random().toString(36).substr(2,9),url:o};n((n=>{const t=[...n,e];return f(!(t.length>0||i.length>0)),t})),s("")}}),[t,e,K,i]),q=(0,o.useCallback)((e=>{n((n=>{const t=n.filter((n=>n.id!==e.id));return f(!(t.length>0||i.length>0)),t}))}),[i]),O=(0,o.useCallback)((()=>{n((e=>{const n=e.slice(0,-1);return f(!(n.length>0||i.length>0)),n}))}),[i]),Y=(0,o.useCallback)(((e,n=30)=>e.length<=n?e:e.substring(0,n-3)+"..."),[]),Q=(0,o.useCallback)(((e,n=30)=>{const t=e.indexOf("/sites/");if(-1===t)return e;const o=".../sites/"+e.substring(t+7).split("?")[0].split("/")[0];return o.length<=n?o:o.substring(0,n-3)+"..."}),[]);return(0,U.jsx)(D().a,{open:"manual_settings"===w,showCloseIcon:!0,onDismiss:k,render:()=>(0,U.jsxs)(W().wt,{style:S.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"sharepoint",title:(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.manualSettings.subtitle",defaultMessage:"Manually configure sites"}),subtext:(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.manualSettings.description",defaultMessage:"Pick which Sites Notion AI can access"})}),y?(0,U.jsx)(W().wt,{style:S.content,children:(0,U.jsx)(We().A,{style:{alignSelf:"center"}})}):(0,U.jsxs)(W().wt,{style:S.content,children:[(0,U.jsxs)("div",{style:S.section,children:[(0,U.jsxs)(W().Ye,{children:[(0,U.jsx)("div",{style:S.listTypeLabel,children:(0,U.jsxs)(W().Ye,{children:[(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.manualSettings.listType",defaultMessage:"List type"}),(0,U.jsx)(Fe().A,{renderTooltip:()=>(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.manualSettings.listType.tooltip",defaultMessage:"Select whether the entered inputs are allowed (Inclusion) or blocked (Exclusion)."}),render:e=>(0,U.jsx)("div",{...e,children:(0,U.jsx)(De().I,{icon:Bt().infoCircleIcon,style:S.infoCircleIcon})})})]})}),(0,U.jsx)(Es().D,{styleKey:"Caption/Regular",colorVariant:"secondary",style:S.browseSitesWrapper,children:(0,U.jsx)(Hs()._,{href:"#",external:!0,onClick:()=>{(0,l().navigateToSharepointUniversalScreen)({currentScreen:"settings"})},children:(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.manualSettings.browseSites",defaultMessage:"Browse sites"})})})]}),(0,U.jsx)(W().Ye,{gap:8,children:(0,U.jsx)("div",{style:S.listTypeSection,children:(0,U.jsxs)(W().Ye,{gap:16,children:[(0,U.jsxs)("div",{style:S.radioOption,role:"radio",tabIndex:0,"aria-checked":"inclusion"===m,onClick:()=>h("inclusion"),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),h("inclusion"))},children:[(0,U.jsx)(Ks().A,{isSelected:"inclusion"===m}),(0,U.jsx)("span",{style:S.listTypeInput,children:"Inclusion list"})]}),(0,U.jsxs)("div",{style:S.radioOption,role:"radio",tabIndex:0,"aria-checked":"exclusion"===m,onClick:()=>h("exclusion"),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),h("exclusion"))},children:[(0,U.jsx)(Ks().A,{isSelected:"exclusion"===m}),(0,U.jsx)("span",{style:S.listTypeInput,children:"Exclusion list"})]})]})})})]}),(0,U.jsxs)("div",{style:S.section,children:[(0,U.jsx)("div",{style:S.listTypeLabel,children:(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.manualSettings.siteList",defaultMessage:"Site list"})}),(0,U.jsx)(Gs().Ay,{focusInitial:!1,focus:!1,showBorder:!0,format:Gs().le.Select,tokenWrapStyle:{gap:4},value:t,onChange:H,onSubmit:R,onBlur:G,onRemoveLastToken:O,type:"url",placeholder:j.formatMessage({id:"universalSearch.sharepoint.manualSettings.siteInput.placeholder",defaultMessage:"Enter SharePoint site URLs"}),tokens:e.map((e=>(0,U.jsx)(Fe().A,{renderTooltip:()=>e.url,render:n=>(0,U.jsx)("div",{...n,children:(0,U.jsx)(Rs().A,{value:Q(e.url,45),format:zs().NY.Medium,isSingle:!0,showRemoveButton:!0,onClickRemove:()=>q(e)})})},e.id))),focusAfterAnimation:!1,style:S.tokenInput})]}),(0,U.jsxs)("div",{style:S.section,children:[(0,U.jsx)("div",{style:S.listTypeLabel,children:(0,U.jsxs)(W().Ye,{children:[(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.manualSettings.userList",defaultMessage:"OneDrive user emails"}),(0,U.jsx)(Fe().A,{renderTooltip:()=>(0,U.jsx)(M().sA,{id:"universalSearch.sharepoint.manualSettings.siteList.tooltip",defaultMessage:"List of OneDrive user emails."}),render:e=>(0,U.jsx)("div",{...e,children:(0,U.jsx)(De().I,{icon:Bt().infoCircleIcon,style:S.infoCircleIcon})})})]})}),(0,U.jsx)(Gs().Ay,{focusInitial:!1,focus:!1,showBorder:!0,format:Gs().le.Select,tokenWrapStyle:{gap:4},value:u,onChange:B,onSubmit:P,onBlur:L,onRemoveLastToken:z,type:"email",placeholder:j.formatMessage({id:"universalSearch.sharepoint.manualSettings.userInput.placeholder",defaultMessage:"Enter OneDrive user emails"}),tokens:i.map((e=>(0,U.jsx)(Fe().A,{renderTooltip:()=>e.email,render:n=>(0,U.jsx)("div",{...n,children:(0,U.jsx)(Rs().A,{value:Y(e.email,50),format:zs().NY.Medium,isSingle:!0,showRemoveButton:!0,onClickRemove:()=>E(e)})})},e.id))),focusAfterAnimation:!1,style:S.tokenInput})]})]}),(0,U.jsxs)(W().wt,{style:S.footer,children:[(0,U.jsx)(qs,{onSaveSettings:A,disabled:v}),(0,U.jsx)(Qs,{onDisconnect:N,disabled:!1})]})]}),ariaLabel:j.formatMessage(Ys.modalAriaLabel)})}const Vs=(0,M().YK)({primedTextInput:{id:"aiConnectors.sharepoint.postEdit.primedTextInput",defaultMessage:"Search for content in SharePoint"}});function Xs(){const e=(0,M().tz)(),n=(0,a().K8)((()=>As().E.state.currentScreen),[]),t=(0,I().IS)((e=>({wrapper:{width:400},section:{marginTop:4,marginBottom:6},note:{fontWeight:T().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginInlineStart:8},sectionContainer:{padding:20,width:400,paddingTop:12},bottomSectionContainer:{padding:20,width:400,paddingTop:0}})),[]),s=(0,o.useCallback)((()=>{As().E.reset()}),[]),i=(0,o.useCallback)((()=>{As().E.reset()}),[]),r=[(0,U.jsx)(W().wt,{children:(0,U.jsx)(M().sA,{id:"assistantOverflowMenu.sharepointIngestion.postEdit.listpoint1",defaultMessage:"SharePoint content will be updated according to the new selection."},"note-1-message")},"note-1"),(0,U.jsx)(W().wt,{children:(0,U.jsx)(M().sA,{id:"assistantOverflowMenu.sharepointIngestion.postEdit.listpoint2",defaultMessage:"This can take up to 72 hours and AI answers will be unavailable until it’s complete"},"note-2-message")},"note-2")];return(0,U.jsx)(D().a,{showCloseIcon:!0,onDismiss:i,open:"post_edit"===n,render:()=>(0,U.jsxs)("div",{style:t.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"sharepoint",title:(0,U.jsx)(M().sA,{id:"aiConnectors.sharepoint.postEdit.title",defaultMessage:"Update in Progress"}),subtext:(0,U.jsx)(M().sA,{id:"aiConnectors.sharepoint.postEdit.description",defaultMessage:"Here’s what you should know:"})}),(0,U.jsx)(W().wt,{style:t.sectionContainer,children:r.map(((e,n)=>(0,U.jsxs)(W().Ye,{gap:8,style:t.section,children:[(0,U.jsx)(N().A,{number:n+1}),(0,U.jsx)("div",{style:t.note,children:e})]},n)))}),(0,U.jsx)(W().wt,{style:t.bottomSectionContainer,children:(0,U.jsx)(R().A,{colorPalette:"blue",onClick:s,children:(0,U.jsx)(M().sA,{id:"aiConnectors.sharepoint.postEdit.primaryButton",defaultMessage:"Done"})})})]}),ariaLabel:e.formatMessage(Vs.primedTextInput)})}var Zs=()=>t(252105),ei=()=>t(656633),ni=()=>t(404141);function ti(){const e=(0,r().v3)(),n=(0,de().J)(),t=(0,g().r)(),s=e.currentUser.id,i=(0,_()._X)({name:"ai_connectors",spaceId:t,userId:s}),c=(0,M().tz)(),d=(0,a().K8)((()=>Se().O.state.open&&"slack_announcement"===Se().O.state.modal),[]),u=(0,o.useCallback)((({source:n,upsell:o})=>{if(!h().default.state.sidebarSpaceViewStore||!t)return;const s=(0,ei().vp)(e,t);Se().O.setState({...Se().O.state,open:!1}),"closeButton"!==n&&(o?s?(ni().A.setState({...ni().A.state,open:!0,openedFrom:"slack_universal_qna_announcement_modal",currentTab:"plans",defaultSubtab:void 0,highlightedSetting:void 0}),Zs().QP(e,{from:"slack_universal_qna_announcement_modal"})):tn().K(e,{from:"slack_universal_qna_announcement_modal",upsell:o}):(0,l().navigateToAIConnectorOnboarding)({analyticsFrom:"slack_universal_qna_announcement_modal",connector:"slack"}))}),[e,t]);return i?(0,U.jsx)(D().a,{ariaLabel:c.formatMessage(ye().vK.title),open:d,render:()=>(0,U.jsx)(je().Y,{messages:ye().vK,aiConnectorsFeatureAvailability:i,onDismiss:u,calloutKey:"ai_slack_ai_connector_announcement",eventName:"ai_slack_universal_qna_announcement_modal_shown",learnMoreHref:(0,B().x)("guides.aiConnectorSlack"),connector:"slack",showNarrowCta:n})}):null}var oi=()=>t(901389);const si=(0,M().YK)({userAccessNotAllowed:{id:"universalSearch.slackChannelSelection.errorModal.userAccessNotAllowed.title",defaultMessage:"User does not have access to Slack channels"},default:{id:"universalSearch.slackChannelSelection.errorModal.default.title",defaultMessage:"Oops! Something went wrong"}}),ii=(0,M().YK)({userAccessNotAllowed:{id:"universalSearch.slackChannelSelection.errorModal.userAccessNotAllowed.subtext",defaultMessage:"User {email} does not have access to Slack channels"},default:{id:"universalSearch.slackChannelSelection.errorModal.default.subtext",defaultMessage:"Oops! Something went wrong"}});function ri(e){const{title:n,subtext:t}=e;return(0,U.jsx)(re,{connector:"slack",screenName:"error",title:n,subtext:t,handleErrorDismissClick:()=>{j().R.setState({...j().R.state,errorCode:void 0})}})}const ai=(0,M().YK)({searchForAChannel:{id:"universalQnA.slack.searchForAChannel",defaultMessage:"Search for a Channel"}});function ci(){const e=(0,M().tz)(),[n,t]=o.useState(""),[s,c]=o.useState(!1),[d,p]=o.useState(!0),[m,h]=o.useState([]),v=(0,o.useRef)(!1),f=(0,r().v3)(),y=(0,g().r)(),_=(0,a().O$)(j().R),S="error"===_.currentScreen,x=_.errorCode,C=(0,o.useCallback)((()=>{const e=i().default.getConfigKey("ingestion","slack");window.open(null==e?void 0:e.learnMoreUrl,"_blank")}),[]),B=(0,u().T)(),E=(0,Mt().$)(),z=(0,a().K8)((()=>null==E?void 0:E.getEmail()),[E]),L=(0,o.useCallback)((()=>{v.current=!1,c(!1),t(""),p(!0),h([])}),[]),K=(0,o.useCallback)((async(e,n=0,t)=>{try{const a=await hn().callApi({eventName:"getSlackPublicChannels",environment:f,data:{spaceId:e,cursor:t}});if("success"===a.type){h((e=>(0,Qt().hS)([...e,...a.data.channels],(e=>e.id))));const n=a.data.cursor;j().R.state.isEditing&&(p(!1),j().R.setState({...j().R.state,isEditing:!1})),n?K(e,0,n):c(!0)}else{if(n>=10){var o,s,i,r;if("SlackError"===(null==a||null===(o=a.body)||void 0===o?void 0:o.name)&&"slack_ai_connector_error"===(null==a||null===(s=a.body)||void 0===s||null===(s=s.clientData)||void 0===s?void 0:s.type)&&"USER_ACCESS_NOT_ALLOWED"===(null==a||null===(i=a.body)||void 0===i||null===(i=i.clientData)||void 0===i?void 0:i.code))j().R.setState({...j().R.state,currentScreen:"error",errorCode:null==a||null===(r=a.body)||void 0===r||null===(r=r.clientData)||void 0===r?void 0:r.code});else j().R.setState({...j().R.state,currentScreen:"error"});return}setTimeout((()=>{K(e,n+1,t)}),3e4)}}catch{if(n>=10)return;setTimeout((()=>{K(e,n+1,t)}),3e4)}}),[f]),H=(0,o.useCallback)((async()=>{j().R.setState({..._,currentScreen:"confirmation"}),L(),y&&(await hn().callApi({eventName:"ingestSlackPublicData",environment:f,data:{spaceId:y,selection:_.selection,setupSessionId:_.sessionId}}),(0,b().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"confirm_slack_public_data_ingestion",integration_type:"slack",setup_session_id:_.sessionId,from:_.analyticsFrom}}}))}),[f,L,_,y]),G=(0,o.useCallback)((async()=>{var e;if(!y)return;const n=j().R.state;if(!y||v.current||"data-selection"!==n.currentScreen)return;if(n.isEditing)return v.current=!0,void K(y);let t=!1;if("failed"!==(await(0,l().updateSlackQnAConnectionState)({environment:f,spaceId:y})).status){if(null!==(e=j().R.state.connectedApps)&&void 0!==e&&e.includes("slack-admin")&&(t=!0),t){if(j().R.state.isSlackGridAiConnectorEnabled){const e=await hn().callApi({eventName:"getUrlForGridSetup",environment:f,data:{spaceId:y}});return void("success"===e.type&&j().R.setState({...j().R.state,currentScreen:"confirmation",gridSetupUrl:e.data.url}))}p(!1),v.current=!0,K(y)}}else j().R.setState({...n,currentScreen:"alreadyConnected"})}),[y,v,K,f]),q=(0,o.useCallback)((({key:e,value:n})=>{const t=j().R.state;"already_connected"!==n?"connected"===n&&G():j().R.setState({...t,currentScreen:"alreadyConnected"})}),[G]);(0,o.useEffect)((()=>{if(!y||!B)return;const e=P().Ay.addListener((0,A().Vz)({spaceId:y,connectorType:"slack",userId:B,sessionId:_.sessionId}),void 0,q,void 0,f);return()=>{e&&P().Ay.removeListener(e,f)}}),[f,q,y,B,_.sessionId]),(0,o.useEffect)((()=>{"data-selection"===_.currentScreen&&(v.current=!1,G())}),[G,_.currentScreen]);const O=function(e,n){return(0,I().IS)((t=>({wrapper:{width:400,display:"flex",flexDirection:"column",minHeight:e?void 0:530},logoSection:{paddingTop:20,paddingInlineEnd:20,paddingBottom:9,paddingInlineStart:20,gap:8,justifyContent:"center",alignItems:"center",height:84},logos:{width:40,height:40},arrowLogo:{width:20,height:20,color:t.icon.secondary},titleWrapper:{width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center"},title:{fontSize:17,fontWeight:T().Wy.medium,lineHeight:"22px",marginBottom:"9px"},subtext:{fontSize:12,lineHeight:"14.52px",color:t.text.secondary},footer:{position:"absolute",width:"100%",justifySelf:"flex-end",boxShadow:"0px 9px 24px 0px #0F0F0F33",paddingTop:16,paddingInlineEnd:20,paddingBottom:16,paddingInlineStart:20,gap:12,bottom:0},connectButton:{fontSize:14,fontWeight:T().Wy.semibold,width:360},searchBarWrapper:{justifyContent:"center"},searchBar:{width:360,padding:4},selectionContainer:{marginTop:18,marginBottom:e?24:0,width:"100%",height:"100%",justifyContent:"center",padding:"0px 20px 0px"},selection:{width:"100%"},waitingForConnection:{fontSize:12,lineHeight:"16px",color:t.text.secondary},waitingForConnectionWrapper:{gap:4},tryAgainWrapper:{marginTop:16,gap:4},tryAgainSection:{gap:4,alignItems:"center",marginBottom:16,color:t.text.secondary},tryAgainText:{fontSize:14},channelItem:{gap:4,alignItems:"center"},channelsText:{fontSize:12,lineHeight:"16px"},divider:{marginTop:5,marginBottom:5},alertIcon:{width:16,height:16},tryAgainButton:{fontSize:12,width:80},futureChannelsCheckboxWrapper:{gap:4,visibility:e?"hidden":"visible"},loadingChannelsWrapper:{alignItems:"center",gap:8,fontSize:12,color:t.text.secondary,marginTop:8},selectionWrapper:{overflowY:"scroll",maxHeight:n?170:124},loadMoreButtonWrapper:{fontSize:12,paddingTop:8,paddingBottom:4},loadMoreButtonhoveredStyle:{background:"none"},channelItemWrapper:{marginTop:12},workspaceAdministratorHeading:{fontSize:14,fontWeight:T().Wy.regular,color:t.text.primary},orderedList:{paddingInlineStart:18,fontSize:14,fontWeight:T().Wy.regular,color:t.text.secondary},waitingForConnectionNote:{paddingBottom:4},note:{fontWeight:T().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginInlineStart:8},noteHeading:{fontWeight:T().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:T().Wy.regular,color:t.text.secondary,fontSize:14,lineHeight:"18px"},learnMoreButton:{gap:4,alignItems:"center",fontSize:14,color:t.text.secondary,justifyContent:"center"},buttonContainer:{justifyContent:"center"},link:{color:t.text.secondary,textDecoration:"underline",cursor:"pointer"},loadingChannels:{color:t.text.secondary},loadingWrapper:{alignItems:"center",gap:4,justifyContent:"center"}})),[e,n])}(d,s),Y=(0,o.useCallback)((e=>{const{selection:n}=_;return n.allSelected?!n.excludedChannels.includes(e):!!n.selectedChannels.includes(e)}),[_]),J=(0,o.useCallback)((()=>{const{selection:e}=_;return e.allSelected?!(e.excludedChannels.length>0)||"partial":e.selectedChannels.length>0&&"partial"}),[_]),Q=(0,o.useCallback)((()=>{const{selection:e}=_;return!!e.allSelected||(!!e.joinFutureChannels||e.selectedChannels.length>0)}),[_]),$=(0,o.useCallback)((()=>[(0,U.jsxs)(W().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:O.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.slack.waitingForConnectionNoteHeading1",defaultMessage:"Slack should open automatically on a new tab."},"note1-1")}),(0,U.jsx)("div",{style:O.noteBody,children:(0,U.jsx)(M().sA,{id:"universalSearch.slack.waitingForConnectionNoteBody1",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,U.jsx)("a",{style:O.link,href:_.authUrl,target:"_blank",children:(0,U.jsx)(M().sA,{id:"universalSearch.slack.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,U.jsxs)(W().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:O.noteHeading,children:_.isSlackGridAiConnectorEnabled?(0,U.jsx)(M().sA,{id:"universalSearch.slack.grid.workspaceOrAdminHeading",defaultMessage:"If you are a Slack organization owner:"},"gridNote2-2"):(0,U.jsx)(M().sA,{id:"universalSearch.slack.workspaceAdminHeading",defaultMessage:"If you are a Slack workspace owner:"},"note2-2")}),(0,U.jsx)("div",{style:O.noteBody,children:(0,U.jsx)(M().sA,{id:"universalSearch.slack.workspaceAdminBody",defaultMessage:"Follow Slack’s instructions to connect. Return to this window, and the process will continue automatically."},"note2-3")}),(0,U.jsxs)(W().wt,{style:{marginTop:16,gap:4},children:[(0,U.jsx)("div",{style:O.noteHeading,children:(0,U.jsx)(M().sA,{id:"universalSearch.slack.notWorkspaceAdminHeading",defaultMessage:"If you are not authorized to install external apps:"},"note2-4")}),(0,U.jsx)("div",{style:O.noteBody,children:(0,U.jsx)(M().sA,{id:"universalSearch.slack.notWorkspaceAdminBody",defaultMessage:"Follow the instructions to request access to the connection. Then, revisit the connect menu to continue setup."},"note2-5")})]})]},"note-2")]),[_,O]),V=(0,o.useCallback)((()=>_.isEditing?(0,U.jsxs)(W().Ye,{style:O.loadingWrapper,children:[(0,U.jsx)(We().k,{}),(0,U.jsx)("div",{style:O.loadingChannels,children:(0,U.jsx)(M().sA,{defaultMessage:"Loading channels",id:"slackChannelSelection.isLoadingChannels"})})]}):d?(0,U.jsxs)(W().wt,{style:O.waitingForConnectionWrapper,children:[$().map(((e,n)=>(0,U.jsxs)(W().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:[(0,U.jsx)(N().A,{number:n+1}),(0,U.jsx)("div",{style:O.note,children:e})]},n))),(0,U.jsx)(W().Ye,{style:O.buttonContainer,children:(0,U.jsx)(w().Ay,{style:{marginTop:16,width:120,borderRadius:6},onClick:C,children:(0,U.jsxs)(W().Ye,{style:O.learnMoreButton,children:[(0,U.jsx)(M().sA,{id:"universalSearch.slack.waitingForConnection.learnMore",defaultMessage:"Learn More"}),(0,k().X)({width:16,height:16})]})})})]}):(0,U.jsxs)(W().wt,{children:[(0,U.jsxs)(W().Ye,{style:O.channelItem,children:[(0,U.jsx)(at().S,{checked:J(),size:14,onClick:()=>{(0,b().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:_.selection.allSelected?"all_channels_deselected":"all_channels_selected",integration_type:"slack",setup_session_id:_.sessionId,from:_.analyticsFrom}}}),j().R.setState({..._,selection:{..._.selection,allSelected:!_.selection.allSelected,selectedChannels:[],excludedChannels:[]}})}}),(0,U.jsx)("div",{style:O.channelsText,children:(0,U.jsx)(M().sA,{id:"universalSearch.integration.slackIngestion.allPublicChannels",defaultMessage:"All public channels"})})]}),(0,U.jsx)(lt().A,{style:O.divider,size:4}),(0,U.jsxs)(U.Fragment,{children:[s?(0,U.jsx)(U.Fragment,{}):(0,U.jsxs)(W().Ye,{style:O.loadingChannelsWrapper,children:[(0,U.jsx)(We().k,{}),(0,U.jsxs)(W().wt,{children:[(0,U.jsx)("div",{children:(0,U.jsx)(M().sA,{id:"universalSearch.integration.slackIngestion.loadedXChannels",defaultMessage:"{channelsCount} channels loaded...",values:{channelsCount:m.length}})}),(0,U.jsx)("div",{children:(0,U.jsx)(M().sA,{id:"universalSearch.integration.slackIngestion.loading1000PerMinute",defaultMessage:"This can take one minute per every 1,000 public channels."})})]})]}),(0,U.jsx)(W().wt,{style:O.selectionWrapper,children:(n?m.filter((e=>e.name.includes(n))):m).map((e=>(0,U.jsxs)(W().Ye,{gap:8,style:O.channelItemWrapper,children:[(0,U.jsx)(at().S,{checked:Y(e.id),onClick:()=>{const{selection:n}=_;(0,b().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:Y(e.id)?"specific_channel_deselected":"specific_channel_selected",integration_type:"slack",setup_session_id:_.sessionId,from:_.analyticsFrom}}}),n.allSelected?n.excludedChannels.includes(e.id)?j().R.setState({..._,selection:{...n,excludedChannels:n.excludedChannels.filter((n=>n!==e.id))}}):j().R.setState({..._,selection:{...n,excludedChannels:n.excludedChannels.concat(e.id)}}):j().R.setState({..._,selection:{...n,allSelected:!1,selectedChannels:n.selectedChannels.includes(e.id)?n.selectedChannels.filter((n=>n!==e.id)):n.selectedChannels.concat(e.id),excludedChannels:[]}})},size:14},`${e.id}-checkbox`),(0,U.jsx)("div",{style:O.channelsText,children:`# ${e.name}`},`${e.id}-label`)]},e.id)))})]})]})),[_,d,O,J,n,m,s,$,C,f,Y]);return S?(0,U.jsx)(ri,{title:"USER_ACCESS_NOT_ALLOWED"===x?(0,U.jsx)(U.Fragment,{children:e.formatMessage(si.userAccessNotAllowed)}):(0,U.jsx)(U.Fragment,{children:e.formatMessage(si.default)}),subtext:"USER_ACCESS_NOT_ALLOWED"===x?(0,U.jsx)(U.Fragment,{children:e.formatMessage(ii.userAccessNotAllowed,{email:z})}):(0,U.jsx)(U.Fragment,{children:e.formatMessage(ii.default)})}):(0,U.jsx)(D().a,{overlayZIndex:999,showCloseIcon:!0,onDismiss:async()=>{const{accept:e}=await oi().Gh({message:(0,U.jsx)(M().sA,{id:"universalQna.slackChannelSelection.closeConfirm",defaultMessage:"Are you sure you want to dismiss? You will lose all the progress you made."}),acceptLabel:(0,U.jsx)(M().sA,{id:"universalQna.slackChannelSelection.dismiss",defaultMessage:"Dismiss"})});e&&(j().R.reset(),L(),(0,b().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_slack_data_selection",integration_type:"slack",setup_session_id:_.sessionId,from:_.analyticsFrom}}}))},open:"data-selection"===_.currentScreen,render:()=>(0,U.jsxs)("div",{style:O.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"slack",title:!d||_.isEditing?(0,U.jsx)(M().sA,{id:"universalQnA.slack.channelSelectionScreenTitle",defaultMessage:"Select channels to connect"}):(0,U.jsx)(M().sA,{id:"universalQnA.slack.channelSelectionWaitingScreenTitle",defaultMessage:"Follow instructions from Slack in your browser"}),subtext:!d||_.isEditing?(0,U.jsx)(M().sA,{id:"universalQnA.slack.channelSelectionScreenSubtext",defaultMessage:"Connecting more Slack channels will give you more relevant and useful Notion AI responses"}):(0,U.jsx)(U.Fragment,{})}),d?(0,U.jsx)(U.Fragment,{}):(0,U.jsx)(dt().A,{capture:!0,allowEsc:!0,render:()=>(0,U.jsx)(Fe().A,{textWrap:!0,placement:"top",render:e=>(0,U.jsx)("div",{...e,children:(0,U.jsx)(W().Ye,{...e,style:O.searchBarWrapper,children:(0,U.jsx)($t().A,{id:"slackUniversalQnASearchBar",style:O.searchBar,placeholder:Mn().A.formatMessage(ai.searchForAChannel),value:n,onChange:e=>{t(e.target.value),(0,b().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"filter_slack_channels",integration_type:"slack",setup_session_id:_.sessionId,from:_.analyticsFrom}}})}},"slackUniversalQnASearchBar")})}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:250},children:(0,U.jsx)(M().sA,{id:"universalSearch.slack.searchBarTooltip",defaultMessage:"All channels may not have been searched. Full search will be available once all channels are loaded."})}),disableTooltip:s})}),(0,U.jsx)(W().Ye,{style:O.selectionContainer,children:(0,U.jsx)(W().wt,{style:O.selection,children:V()})}),d?void 0:(0,U.jsxs)(W().wt,{style:O.footer,children:[(0,U.jsxs)(W().Ye,{style:O.futureChannelsCheckboxWrapper,children:[(0,U.jsx)(at().S,{checked:_.selection.joinFutureChannels,size:14,onClick:()=>{(0,b().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:_.selection.joinFutureChannels?"dont_join_future_channels":"join_future_channels",integration_type:"slack",setup_session_id:_.sessionId,from:_.analyticsFrom}}}),j().R.setState({..._,selection:{..._.selection,joinFutureChannels:!_.selection.joinFutureChannels}})}}),(0,U.jsx)("div",{style:O.channelsText,children:(0,U.jsx)(M().sA,{id:"universalSearch.integration.slackIngestion.allFuturePublicChannels",defaultMessage:"Add public channels created in future"})})]}),(0,U.jsx)(R().A,{colorPalette:"blue",style:O.connectButton,onClick:H,disabled:!Q(),children:(0,U.jsx)(M().sA,{id:"universalSearch.integration.connect",defaultMessage:"Connect"})})]})]})})}const li=(0,M().YK)({instruction1:{id:"universalSearch.slack.grid.confirmModalNote1",defaultMessage:"Select your workspaces on your Slack Admin Dashboard"}}),di=(0,M().YK)({instruction1:{id:"universalSearch.slack.confirmModalNote1",defaultMessage:"Notion AI will join your selected channels in Slack"}});const ui=function(){const e=(0,r().v3)(),n=(0,a().O$)(j().R),t=(0,o.useCallback)((()=>{const e=n.isSlackGridAiConnectorEnabled?li:di;return[(0,U.jsx)(X,{number:1,title:e.instruction1},"item1"),(0,U.jsx)(X,{number:2,title:$.defaultConnectionTime},"item2"),(0,U.jsx)(X,{number:3,title:{...{...$.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:"Slack"}}}},"item3")]}),[n.isSlackGridAiConnectorEnabled]),s=(0,o.useCallback)((()=>{J().D6({label:(0,U.jsx)(M().sA,{id:"slackIngestionConfirmModal.ingestion.acknowledge",defaultMessage:"Started syncing from Slack. This can take up to 36 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(w().Ay,{onClick:J().N2,children:(0,U.jsx)(M().sA,{id:"slackIngestionConfirmModal.ingestion.startedMessageDismiss",defaultMessage:"Close"})})})}),[]),i=(0,o.useCallback)((()=>{if((0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:n.isSlackGridAiConnectorEnabled?"slack_grid_select_workspaces_clicked":"completion_screen_done",integration_type:"slack",setup_session_id:n.sessionId,from:n.analyticsFrom}}}),n.isSlackGridAiConnectorEnabled){const t=n.gridSetupUrl;if(!t)return;e.device.isElectron?(0,C().P)(t):window.open(t,"_blank")}else j().R.setState({...n,isPublicSync:!0,inProgress:!0,currentScreen:"none",ingestionProgress:1}),s()}),[e,n,s]),c=(0,o.useCallback)((()=>{j().R.reset(),(0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_dismiss",integration_type:"slack",setup_session_id:n.sessionId,from:n.analyticsFrom}}})}),[e,n.analyticsFrom,n.sessionId]);return(0,o.useEffect)((()=>{"confirmation"===n.currentScreen&&(0,l().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"slack",moment:"finished"})}),[e,n.currentScreen]),(0,U.jsx)(V,{open:"confirmation"===n.currentScreen,connectorType:"slack",notes:t(),onDismiss:c,title:n.isSlackGridAiConnectorEnabled?(0,U.jsx)(M().sA,{id:"universalSearch.slack.heresWhatToDoNext",defaultMessage:"Here’s what to do next"}):void 0,onPrimaryButtonClick:i,primaryButtonText:n.isSlackGridAiConnectorEnabled?(0,U.jsx)(M().sA,{id:"universalSearch.integration.girdConfirmIngestion",defaultMessage:"Select Slack workspaces"}):void 0})};const gi=function(){const e=(0,a().O$)(j().R),[n,t]=(0,o.useState)(!1),s=(0,r().v3)(),l=(0,g().r)(),[d,u]=(0,o.useState)(!1),[p,m]=(0,o.useState)(!0),[h,v]=(0,o.useState)([]),[f,y]=(0,o.useState)(!1);(0,c().Yb)((async()=>{if(!l||"settings"!==e.currentScreen)return;m(!0);const n=await hn().callApi({eventName:"getIngestedSlackChannels",environment:s,data:{spaceId:l}});"success"===n.type&&(m(!1),v(n.data.channels))}),[s,e.currentScreen,l]);const _=(0,o.useCallback)((()=>{const e=i().default.getConfigKey("ingestion","slack"),n=null==e?void 0:e.learnMoreUrl;n&&window.open(n,"_blank")}),[]),S=(0,o.useCallback)((()=>{j().R.setState({...j().R.state,currentScreen:"none"})}),[]),x=(0,o.useCallback)((()=>{t(!1)}),[]),k=(0,o.useCallback)((async()=>{if(!l)return;u(!0);"success"===(await hn().callApi({eventName:"disconnectSlackIngestion",environment:s,data:{spaceId:l,disconnectForWorkspace:!0,disconnectReason:"admin_disconnect"}})).type?(j().R.setState({...j().R.state,isDisconnecting:!0}),J().D6({label:(0,U.jsx)(M().sA,{id:"slackIngestionConfirmModal.ingestion.acknowledgeDisconnect",defaultMessage:"Started disconnecting Slack. This can take up to 3 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(w().Ay,{onClick:J().N2,children:(0,U.jsx)(M().sA,{id:"slackIngestionConfirmModal.ingestion.dismissAcknowledgeDisconnect",defaultMessage:"Close"})})}),t(!1),j().R.reset()):(u(!1),J().D6({label:(0,U.jsx)(M().sA,{id:"slackIngestionConfirmModal.ingestion.disconnectError",defaultMessage:"Failed to disconnect Slack. Please try again later."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(w().Ay,{onClick:J().N2,children:(0,U.jsx)(M().sA,{id:"slackIngestionConfirmModal.ingestion.closeSnackbarError",defaultMessage:"Close"})})})),u(!1)}),[s,l]),A=(0,I().IS)((e=>({wrapper:{width:400},channelDetailsContainer:{width:352,fontSize:14,fontWeight:T().Wy.regular,color:e.text.secondary},channelDetailsSubtitle:{textAlign:"center",marginBottom:"16px"},channelDetailsWrapper:{justifyContent:"center",paddingTop:"12px",paddingBottom:"12px"},channelNamesContainer:{gap:2,color:e.text.primary},footer:{justifyContent:"center",alignItems:"center",width:"100%",paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:8},disconnectButton:{fontSize:14,fontWeight:T().Wy.medium,width:"100%"},moreChannelsContainer:{paddingTop:8},learnMoreButton:{fontSize:14,fontWeight:T().Wy.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:T().Wy.medium,fontSize:12,gap:5,justifyContent:"center",alignItems:"center",paddingTop:4,paddingInlineEnd:8,paddingBottom:4,paddingInlineStart:8,color:`${e.text.secondary}`},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:T().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:T().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:T().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:T().Wy.regular,width:"100%",textAlign:"center",paddingTop:4,paddingInlineEnd:0,paddingBottom:4,paddingInlineStart:0},confirmDisconnectButton:{fontSize:14,fontWeight:T().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,paddingBottom:40,justifyContent:"center",alignItems:"center"},editChannelsButton:{fontSize:14,fontWeight:T().Wy.medium,width:"100%"}})),[]);return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(D().a,{showCloseIcon:!0,onDismiss:x,open:n,render:()=>(0,U.jsx)("div",{style:A.confirmWrapper,children:(0,U.jsxs)("div",{style:A.confirmContainer,children:[(0,U.jsx)("div",{style:A.confirmModalTitle,children:(0,U.jsx)(M().sA,{id:"slackIngestionSettings.confirmation.title",defaultMessage:"Are you sure?"})}),(0,U.jsx)("div",{style:A.confirmModalSubTitle,children:(0,U.jsx)(M().sA,{id:"slackIngestionSettings.confirmation.subTitle",defaultMessage:"Your Slack data will be permanently deleted from Notion."})}),(0,U.jsx)("div",{style:A.confirmModalDescription,children:(0,U.jsx)(M().sA,{id:"slackIngestionSettings.confirmation.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."})}),(0,U.jsxs)(W().wt,{style:A.confirmModalActionButtons,children:[(0,U.jsx)(R().A,{colorPalette:"red",style:A.confirmDisconnectButton,disabled:d,onClick:k,children:(0,U.jsx)(M().sA,{id:"slackIngestion.confirmDisconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"})}),(0,U.jsx)(w().Ay,{style:A.goBackButton,onClick:x,children:(0,U.jsx)(M().sA,{id:"slackIngestion.confirmDisconnectModal.goBack",defaultMessage:"Go back"})})]})]})})}),(0,U.jsx)(D().a,{showCloseIcon:!0,onDismiss:S,open:"settings"===e.currentScreen,render:()=>(0,U.jsxs)("div",{style:A.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"slack",title:(0,U.jsx)(M().sA,{id:"universalSearch.slack.settingsModalTitle",defaultMessage:"Slack is connected to Notion AI"}),subtext:p||e.isSlackGridAiConnectorEnabled?void 0:(0,U.jsx)(M().sA,{id:"universalSearch.slackIngestion.settingsModal.canAnswerFrom",defaultMessage:"Notion AI can answer questions about {channelsCount} public channels in Slack.",values:{channelsCount:h.length}})}),p?(0,U.jsx)(W().Ye,{style:A.spinner,children:(0,U.jsx)(We().k,{})}):(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(W().Ye,{style:A.channelDetailsWrapper,children:e.isSlackGridAiConnectorEnabled?(0,U.jsx)(W().wt,{style:A.channelDetailsContainer,children:(0,U.jsx)(M().sA,{id:"slackSettings.grid.note",defaultMessage:"This Notion workspace is connected to Slack Enterprise Grid. Settings can be only configured in the Slack Admin Dashboard."})}):(0,U.jsxs)(W().wt,{style:A.channelDetailsContainer,children:[(0,U.jsx)(W().wt,{style:A.channelNamesContainer,children:h.slice(0,4).map((e=>(0,U.jsx)("div",{children:`# ${e}`},e)))}),h.length-4>0?(0,U.jsx)(W().Ye,{style:A.moreChannelsContainer,children:(0,U.jsx)(M().sA,{id:"universalSearch.slackIngestion.settingsModal.moreChannels",defaultMessage:"{moreChannelsCount} more",values:{moreChannelsCount:h.length-4}})}):(0,U.jsx)(U.Fragment,{})]})}),(0,U.jsxs)(W().wt,{style:A.footer,children:[(0,U.jsx)(H().A,{size:"lg",disabled:f,style:A.editChannelsButton,onClick:async()=>{if(!l)return;if(e.isSlackGridAiConnectorEnabled){y(!0);const e=await hn().callApi({eventName:"getUrlForGridSetup",environment:s,data:{spaceId:l}});return"success"===e.type&&(s.device.isElectron?(0,C().P)(e.data.url):window.open(e.data.url,"_blank")),void y(!1)}y(!0);const n=await hn().callApi({eventName:"getIngestionOptions",environment:s,data:{spaceId:l}});"success"===n.type&&((0,b().u)({environment:s,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_channels",integration_type:"slack",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),j().R.setState({...e,currentScreen:"data-selection",selection:{allSelected:n.data.selection.allSelected,selectedChannels:n.data.selection.selectedChannels,excludedChannels:n.data.selection.excludedChannels,joinFutureChannels:n.data.selection.joinFutureChannels},isEditing:!0})),y(!1)},children:f?(0,U.jsxs)(W().Ye,{style:{alignItems:"center",gap:4,fontWeight:T().Wy.regular},children:[(0,U.jsx)(We().k,{}),(0,U.jsx)(M().sA,{id:"slackUniversalSearch.integration.loadingPreviousSelection",defaultMessage:"Loading previous selection"})]}):e.isSlackGridAiConnectorEnabled?(0,U.jsx)(M().sA,{id:"slackUniversalSearch.integration.editTeams",defaultMessage:"Edit settings"}):(0,U.jsx)(M().sA,{id:"slackUniversalSearch.integration.editChannels",defaultMessage:"Edit channels"})}),(0,U.jsx)(Be().E,{style:A.disconnectButton,onClick:()=>{t(!0)},children:(0,U.jsx)(M().sA,{id:"slackUniversalSearch.integration.disconnectSlack",defaultMessage:"Disconnect"})}),(0,U.jsx)(w().Ay,{style:A.learnMoreButton,onClick:_,children:(0,U.jsxs)(W().Ye,{style:A.learnMoreText,children:[(0,U.jsx)(M().sA,{id:"universalSearch.integration.learnMore",defaultMessage:"Learn more"}),(0,U.jsx)(De().I,{icon:Pe().arrowUpRightSquareSmallIcon,size:"sm"})]})})]})]})]})})]})};var pi=()=>t(438177);function mi(e){const{open:n}=e,t=(0,I().IS)((()=>({loadingWrapper:{padding:20,fontSize:T().J.UISmall.desktop,fontWeight:T().Wy.regular,justifyContent:"center",gap:8,alignItems:"center"}})),[]);return(0,U.jsx)(D().a,{showCloseIcon:!0,open:n,render:()=>(0,U.jsxs)(W().Ye,{style:t.loadingWrapper,children:[(0,U.jsx)(M().sA,{id:"aiConnectors.common.isFetchingConnection",defaultMessage:"Getting connection status"}),(0,U.jsx)(We().k,{})]})})}function hi(){const e=(0,M().tz)(),n=(0,I().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,paddingTop:20,paddingInlineEnd:20,paddingBottom:20,paddingInlineStart:20,gap:6},connectButton:{fontSize:14,fontWeight:T().Wy.semibold,width:"100%"}})),[]);return(0,U.jsx)(D().a,{ariaLabel:e.formatMessage({defaultMessage:"Slack AI Connector is currently facing issues and cannot be connected.",id:"slackAiConnector.facingIssues.ariaLabel"}),showCloseIcon:!0,onDismiss:()=>j().R.reset(),open:!0,render:()=>(0,U.jsxs)("div",{style:n.wrapper,children:[(0,U.jsx)(F().b,{connectorType:"slack",title:(0,U.jsx)(M().sA,{id:"slackAiConnector.facingIssues.title",defaultMessage:"Slack AI Connector is currently facing issues"}),subtext:(0,U.jsx)(M().sA,{id:"slackAiConnector.facingIssues.description",defaultMessage:"Apologies, we are currently facing issues with the Slack AI Connector and can not allow new connections. Please try again later."})}),(0,U.jsx)(W().wt,{style:n.footer,children:(0,U.jsx)(R().A,{colorPalette:"blue",style:n.connectButton,onClick:()=>j().R.reset(),children:(0,U.jsx)(M().sA,{id:"slackAiConnector.facingIssues.dismiss",defaultMessage:"Close"})})})]})})}function vi(e){const{open:n}=e;return(0,U.jsx)(qe,{open:n,onDismiss:()=>{j().R.reset()},connector:"slack"})}const fi=(0,M().YK)({slackUniversalSearchOauthPopupTitle:{id:"universalSearch.slack.slackOauthPopupTitle",defaultMessage:"Authenticate Slack"}});function yi(){var e,n;const t=(0,o.useMemo)((()=>ve("slack")),[]),s=(0,o.useMemo)((()=>fe("slack")),[]),d=(0,r().v3)(),u=(0,g().r)(),p=d.currentUser.id,m=(0,_().P9)({name:"ai_connectors",spaceId:u,userId:p}),f=(0,a().K8)((()=>v().zD.state.isAiEnabled()),[]),y=(0,a().O$)(h().AppStoreSidebarSpaceStore),S=(0,a().O$)(j().R),x=(0,a().K8)((()=>i().default.getConfigKey("ingestion","slack").learnMoreUrl),[]),I=(0,a().K8)((()=>i().default.getConfigKey("ai_connectors_onboarding_blocked","currently_facing_issues")),[]),w=null==I?void 0:I.includes("slack"),[k]=(0,c().Yb)((async()=>{if(!u||"introduction"!==S.currentScreen)return;const e=await(0,l().getConnectorStatus)({environment:d,spaceId:u,connector:"slack"});return void 0!==e&&"failed"!==e?{isPublicConnected:void 0!==e.details.connectionDetails}:{isPublicConnected:!1}}),[d,S.currentScreen,u]),A=(0,a().K8)((()=>y&&(0,pi().o)(y)),[y]),M=(0,de().J)(),T=!y||!u||(null===(e=k.value)||void 0===e?void 0:e.isPublicConnected)||!f||!A,N="resolved"===k.status&&"introduction"===S.currentScreen,D=M?"proceed_to_slack_data_selection":"contact_workspace_owners";(0,o.useEffect)((()=>{!T&&N&&(M?(0,b().u)({environment:d,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"slack",setup_session_id:S.sessionId,from:S.analyticsFrom,is_space_admin:M,is_ai_eligible:m??!1}}}):(0,b().u)({environment:d,event:{eventName:"universal_qna_request_modal_open",eventProperties:{integration_type:"slack",from:S.analyticsFrom,is_ai_eligible:m??!1}}}))}),[d,T,S.sessionId,S.analyticsFrom,N,M,m]);const W=(0,o.useCallback)((()=>{j().R.reset(),(0,b().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_slack_intro_modal",integration_type:"slack",setup_session_id:S.sessionId,from:S.analyticsFrom}}})}),[d,S]);if(!u)return(0,U.jsx)(U.Fragment,{});if(!d.device.isMobile&&T){var B;const e=Boolean(null===(B=k.value)||void 0===B?void 0:B.isPublicConnected);return e?(0,U.jsx)(vi,{open:N&&e}):(0,U.jsx)(U.Fragment,{})}return d.device.isMobile?(0,U.jsx)(_e,{connectorType:"slack",open:"introduction"===S.currentScreen,onClosed:()=>{j().R.reset()},learnMoreUrl:x}):!w||"introduction"!==S.currentScreen||"resolved"!==k.status||null!==(n=k.value)&&void 0!==n&&n.isPublicConnected?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(mi,{open:"introduction"===S.currentScreen&&"resolved"!==k.status}),M?(0,U.jsx)(ke,{onConnect:async()=>{if((0,l().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:d,connector:"slack",moment:"started"}),!m)return(0,b().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"show_purchase_ai",integration_type:"slack",setup_session_id:S.sessionId,from:S.analyticsFrom}}}),Ht().Ow({openedFrom:"slack_qna_intro_modal",currentTab:"plans"}),void j().R.reset();j().R.setState({...j().R.state,currentScreen:"data-selection"});const e=await hn().callApi({eventName:"getSlackIngestionAuthorizeUrl",environment:d,data:{spaceId:u,isAdminAuth:!0,isDesktopApp:d.device.isElectron,sessionId:S.sessionId}});"success"===e.type&&(j().R.setState({...j().R.state,authUrl:e.data.url}),d.device.isElectron?(0,C().P)(e.data.url):await ce().P(d,{width:800,height:600,url:e.data.url,titleMessage:fi.slackUniversalSearchOauthPopupTitle}),(0,b().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:D,integration_type:"slack",setup_session_id:S.sessionId,from:S.analyticsFrom}}}))},onDismiss:W,onLearnMore:()=>{window.open(x,"_blank")},title:t,connectorType:"slack",notes:s,open:N}):(0,U.jsx)(Ie,{connector:"slack",handleClose:()=>(0,l().resetAiConnectorStatus)("slack"),open:N,analyticsFrom:S.analyticsFrom,setupSessionId:S.sessionId,messages:ye().vK})]}):(0,U.jsx)(hi,{})}const _i=function(){const e=(0,r().v3)(),n=(0,a().O$)(j().R),t=(0,I().IS)((e=>({wrapper:{width:400,padding:24},logoSection:{paddingTop:"40px",paddingBottom:"16px",gap:8,justifyContent:"center",alignItems:"center"},titleWrapper:{width:"100%",justifyContent:"center",textAlign:"center"},title:{fontSize:17,fontWeight:T().Wy.medium,lineHeight:"22px",marginBottom:"24px",textWrap:"balance"},nextStepsWrapper:{width:"100%",justifyContent:"center",color:e.text.secondary},footer:{justifyContent:"center",alignItems:"center",bottom:0,width:"100%",gap:12,marginTop:12},gotIt:{fontSize:14,fontWeight:T().Wy.medium,width:"100%"},pickAnother:{fontSize:14,fontWeight:T().Wy.medium,width:"100%",textAlign:"center"}})),[]),s=(0,o.useCallback)((()=>{j().R.reset()}),[]),i=(0,o.useCallback)((()=>{j().R.setState({...j().R.getInitialState(),currentScreen:"introduction"})}),[]);return(0,U.jsx)(D().a,{showCloseIcon:!0,onDismiss:()=>{j().R.reset(),(0,b().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"slack_workspace_already_connected_modal_close",integration_type:"slack",setup_session_id:n.sessionId,from:n.analyticsFrom}}})},open:"alreadyConnected"===n.currentScreen,render:()=>(0,U.jsxs)("div",{style:t.wrapper,children:[(0,U.jsx)(W().Ye,{style:t.logoSection,children:(0,L().Q)({width:24,height:24})}),(0,U.jsx)(W().Ye,{style:t.titleWrapper,children:(0,U.jsx)(W().Ye,{style:t.title,children:(0,U.jsx)(M().sA,{id:"universalSearch.slack.workspaceAlreadyConnected",defaultMessage:"Slack is already connected to another Notion workspace"})})}),(0,U.jsx)(W().Ye,{style:t.nextStepsWrapper,children:(0,U.jsx)(M().sA,{id:"universalSearch.slack.onlyOneWorkspaceCanBeConnected",defaultMessage:"Currently, Slack can be only connected to one workspace at a time"})}),(0,U.jsxs)(W().wt,{style:t.footer,children:[(0,U.jsx)(H().A,{size:"lg",style:t.gotIt,onClick:s,children:(0,U.jsx)(M().sA,{id:"universalSearch.slack.gotItOneWorkspaceConnected",defaultMessage:"Got it"})}),(0,U.jsx)(w().Ay,{style:t.pickAnother,onClick:i,children:(0,U.jsx)(M().sA,{id:"universalSearch.slack.pickDifferentWorkspace",defaultMessage:"Pick a different Slack workspace"})})]})]})})};function Si(){const e=(0,g().r)(),n=(0,u().T)(),t=(0,r().v3)(),b=(0,a().O$)(x().A),C=(0,_().P9)({name:"ai_connectors",spaceId:e,userId:n}),I=(0,a().K8)((()=>v().zD.canUseAiConnectorSearchScope("github")),[]),w=(0,a().K8)((()=>v().zD.canUseAiConnectorSearchScope("gmail")),[]),k=(0,a().K8)((()=>v().zD.canUseAiConnectorSearchScope("google-calendar")),[]),A=(0,a().K8)((()=>v().zD.canUseAiConnectorSearchScope("notion-mail")),[]),M=(0,a().K8)((()=>v().zD.canUseAiConnectorSearchScope("notion-calendar")),[]),T=(0,a().K8)((()=>v().zD.canUseAiConnectorSearchScope("outlook")),[]),N=(0,a().K8)((()=>v().zD.canUseAiConnectorSearchScope("jira")),[]),D=(0,s().X)("jira_qna_ingestion_v2"),W=(0,a().K8)((()=>v().zD.canUseAiConnectorSearchScope("microsoft-teams")),[]),B=(0,a().K8)((()=>v().zD.canUseAiConnectorSearchScope("sharepoint")),[]),P=(0,a().K8)((()=>v().zD.canUseAiConnectorSearchScope("linear")),[]),F=(0,a().K8)((()=>v().zD.canUseAiConnectorSearchScope("salesforce")),[]),z=(0,a().K8)((()=>v().zD.canUseAiConnectorSearchScope("discord")),[]),L=(0,a().K8)((()=>v().zD.canUseAiConnectorSearchScope("box")),[]),K=(0,a().K8)((()=>v().zD.canUseAiConnectorSearchScope("asana")),[]),H=(0,a().K8)((()=>h().default.getState().sidebarSpaceViewStore),[]);(0,o.useEffect)((()=>{"introduction"!==p().o.state.currentScreen&&p().o.reset()}),[]);const R=(0,a().K8)((()=>(0,S().wd)()),[]),G=(0,a().K8)((()=>(0,S().kB)()),[]);(0,o.useEffect)((()=>{if(H)for(const e of G)(0,l().maybeTrackSprigAiConnectorOnboardingSurvey)({environment:t,connector:e,connectedApps:R})}),[t,R,G,H]);const q=(0,s().X)("install_from_jira_marketplace");return(0,d().ts)(),(0,c().Yb)((async()=>{e&&W&&("introduction"!==m().F.state.currentScreen&&m().F.reset(),await(0,l().getMicrosoftTeamsAIConnectorStatusAction)({environment:t,spaceId:e}))}),[e,W,t]),(0,o.useEffect)((()=>{const{connectorTriggeringUpsell:e,upsellTriggeredAt:n}=b,t=i().default.getConfigKey("ingestion","upsellMaxDurationInSeconds")||36e5;if(C&&e&&n){if(Date.now()-n>t)return void x().A.reset();switch(e){case"slack":j().R.setState({...j().R.state,currentScreen:"introduction"});break;case"google-drive":f().d.setState({...f().d.state,currentScreen:"introduction"});break;case"jira":y().y.setState({...y().y.state,currentScreen:"introduction"});break;case"github":p().o.setState({...p().o.state,currentScreen:"introduction"})}x().A.reset()}}),[b,C]),(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(Ce,{}),(0,U.jsx)(sn,{}),(0,U.jsx)(mn,{}),(0,U.jsx)(un,{}),(0,U.jsx)(dn,{}),(0,U.jsx)(ti,{}),(0,U.jsx)(yi,{}),(0,U.jsx)(ci,{}),(0,U.jsx)(ui,{}),(0,U.jsx)(gi,{}),(0,U.jsx)(_i,{}),(0,U.jsx)(kt,{}),(0,U.jsx)(St,{}),(0,U.jsx)(xt,{}),(0,U.jsx)(jt,{}),(0,U.jsx)(wt,{}),(0,U.jsx)(_t,{}),(0,U.jsx)(ft,{}),(0,U.jsx)(st,{}),(0,U.jsx)(it,{}),(0,U.jsx)(ht,{}),(0,U.jsx)(yt,{}),k?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(Qn,{}),(0,U.jsx)($n,{}),(0,U.jsx)(et,{}),(0,U.jsx)(Xn,{}),(0,U.jsx)(Vn,{}),(0,U.jsx)(Zn,{}),(0,U.jsx)(ot,{}),(0,U.jsx)(nt,{}),(0,U.jsx)(tt,{})]}):void 0,w?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(En,{}),(0,U.jsx)(zn,{}),(0,U.jsx)(Rn,{}),(0,U.jsx)(Kn,{}),(0,U.jsx)(Ln,{}),(0,U.jsx)(Hn,{}),(0,U.jsx)(On,{}),(0,U.jsx)(Gn,{}),(0,U.jsx)(qn,{})]}):void 0,A?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(ss,{}),(0,U.jsx)(is,{}),(0,U.jsx)(ls,{}),(0,U.jsx)(as,{}),(0,U.jsx)(rs,{}),(0,U.jsx)(cs,{}),(0,U.jsx)(gs,{}),(0,U.jsx)(ds,{}),(0,U.jsx)(us,{})]}):void 0,M?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(Qo,{}),(0,U.jsx)($o,{}),(0,U.jsx)(es,{}),(0,U.jsx)(Xo,{}),(0,U.jsx)(Vo,{}),(0,U.jsx)(Zo,{}),(0,U.jsx)(os,{}),(0,U.jsx)(ns,{}),(0,U.jsx)(ts,{})]}):void 0,T?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(ms,{}),(0,U.jsx)(hs,{}),(0,U.jsx)(_s,{}),(0,U.jsx)(fs,{}),(0,U.jsx)(vs,{}),(0,U.jsx)(ys,{}),(0,U.jsx)(js,{}),(0,U.jsx)(Ss,{}),(0,U.jsx)(xs,{})]}):void 0,I?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(An,{}),(0,U.jsx)(E,{}),(0,U.jsx)(Dn,{}),(0,U.jsx)(Tn,{})]}):void 0,N?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(Yt,{}),(0,U.jsx)(Tt,{}),(0,U.jsx)(zt,{}),(0,U.jsx)(Kt,{}),(0,U.jsx)(eo,{}),(0,U.jsx)(At,{}),(0,U.jsx)(Xt,{}),(0,U.jsx)(Ot,{}),q?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(Ut,{}),(0,U.jsx)(qt,{})]}):void 0]}):void 0,D?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(yo,{}),(0,U.jsx)(co,{}),(0,U.jsx)(uo,{}),(0,U.jsx)(mo,{}),(0,U.jsx)(So,{}),(0,U.jsx)(go,{}),(0,U.jsx)(vo,{})]}):void 0,W?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(Go,{}),(0,U.jsx)(To,{}),(0,U.jsx)(Uo,{}),(0,U.jsx)(Ko,{}),(0,U.jsx)(Oo,{}),(0,U.jsx)(Ho,{}),(0,U.jsx)(Mo,{}),(0,U.jsx)(Yo().n,{}),(0,U.jsx)(Eo,{}),(0,U.jsx)(Po,{})]}):void 0,B?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(Us,{}),(0,U.jsx)(Ms,{}),(0,U.jsx)(Ns,{}),(0,U.jsx)(Os,{}),(0,U.jsx)($s,{}),(0,U.jsx)(Ds,{}),(0,U.jsx)(Bs,{}),(0,U.jsx)(Xs,{})]}):void 0,P?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(ko,{}),(0,U.jsx)(bo,{}),(0,U.jsx)(Io,{}),(0,U.jsx)(Ao,{})]}):void 0,F?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(Cs,{}),(0,U.jsx)(Is,{}),(0,U.jsx)(ws,{}),(0,U.jsx)(ks,{})]}):void 0,z?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(Sn,{}),(0,U.jsx)(xn,{}),(0,U.jsx)(jn,{}),(0,U.jsx)(bn,{}),(0,U.jsx)(Cn,{}),(0,U.jsx)(In,{})]}):void 0,K?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(Ne,{}),(0,U.jsx)(Y,{}),(0,U.jsx)(ee,{}),(0,U.jsx)(ze,{}),(0,U.jsx)(ie,{}),(0,U.jsx)(ae,{})]}):void 0,L?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(Qe,{}),(0,U.jsx)($e,{}),(0,U.jsx)(Ze,{}),(0,U.jsx)(Ve,{}),(0,U.jsx)(Xe,{}),(0,U.jsx)(en,{}),(0,U.jsx)(nn,{})]}):void 0]})}},701545:(e,n,t)=>{t.d(n,{p:()=>s});t(296540);var o=t(474848);const s=(0,t(340498).wt)("checkMarkLine",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M6.79297 13.2871C6.48047 13.2871 6.21484 13.1523 5.99609 12.8828L2.96094 9.14453C2.875 9.04297 2.8125 8.94336 2.77344 8.8457C2.73828 8.74805 2.7207 8.64648 2.7207 8.54102C2.7207 8.30664 2.79883 8.11328 2.95508 7.96094C3.11133 7.80859 3.30859 7.73242 3.54688 7.73242C3.81641 7.73242 4.04297 7.84766 4.22656 8.07812L6.76953 11.3008L11.7324 3.4375C11.834 3.28125 11.9395 3.17188 12.0488 3.10938C12.1582 3.04297 12.2949 3.00977 12.459 3.00977C12.6973 3.00977 12.8926 3.08398 13.0449 3.23242C13.1973 3.38086 13.2734 3.57031 13.2734 3.80078C13.2734 3.89453 13.2578 3.98828 13.2266 4.08203C13.1953 4.17578 13.1465 4.27344 13.0801 4.375L7.5957 12.8594C7.4082 13.1445 7.14062 13.2871 6.79297 13.2871Z"})})},821983:(e,n,t)=>{t.r(n),t.d(n,{iconDefinition:()=>o,keyFillIcon:()=>s});t(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"5.31 1.92 9.37 16.15",svg:(0,t(474848).jsx)("path",{d:"M12.02 10.83a.3.3 0 0 0 .062-.023 4.684 4.684 0 1 0-4.164 0q.03.014.062.023v5.225c0 .086.034.169.095.23L9.77 17.98a.325.325 0 0 0 .46 0l1.695-1.695a.325.325 0 0 0 0-.46l-1.465-1.466 1.465-1.465a.33.33 0 0 0 .095-.23zM10 6.67a1 1 0 1 1 0-2 1 1 0 0 1 0 2"})},s=(0,t(340498).wt)("keyFill",o)},831098:(e,n,t)=>{t.d(n,{y:()=>s});t(296540);var o=t(474848);const s=(0,t(340498).wt)("jira",{viewBox:"0 0 20 20",svg:(0,o.jsx)("path",{d:"M16.8784 2.5H9.65698C9.65698 4.3 11.1141 5.75714 12.9141 5.75714H14.2427V7.04288C14.2427 8.84288 15.6998 10.3 17.4998 10.3V3.12143C17.4998 2.77857 17.2212 2.5 16.8784 2.5Z M13.3001 6.10001H6.07861C6.07861 7.9 7.53574 9.35713 9.33574 9.35713H10.6643V10.6429C10.6643 12.4429 12.1215 13.9 13.9215 13.9V6.72144C13.9215 6.37856 13.6429 6.10001 13.3001 6.10001Z M9.72144 9.70001H2.5C2.5 11.5 3.95714 12.9571 5.75714 12.9571H7.08569V14.2429C7.08569 16.0429 8.54287 17.5 10.3429 17.5V10.3214C10.3429 9.97857 10.0643 9.70001 9.72144 9.70001Z"})})},852219:(e,n,t)=>{t.r(n),t.d(n,{bookSmallIcon:()=>s,iconDefinition:()=>o});t(296540);const o={viewBox:"0 0 16 16",fittedViewBox:"1.48 2.62 13.03 10.76",svg:(0,t(474848).jsx)("path",{d:"M1.73 3.768C3.598 2.34 6.058 2.25 8 3.501c1.942-1.251 4.402-1.162 6.27.267a.63.63 0 0 1 .245.497v8.485a.625.625 0 0 1-1.005.496c-1.543-1.18-3.584-1.18-5.128-.001l-.015.01a.7.7 0 0 1-.19.094.62.62 0 0 1-.56-.105c-1.543-1.18-3.584-1.178-5.127.002a.625.625 0 0 1-1.005-.496V4.265c0-.195.09-.379.245-.497m1.005 7.87a5.37 5.37 0 0 1 4.64 0V4.586a4.14 4.14 0 0 0-4.64 0zm5.89 0a5.37 5.37 0 0 1 4.64 0V4.586a4.14 4.14 0 0 0-4.64 0z"})},s=(0,t(340498).wt)("bookSmall",o)},890494:(e,n,t)=>{t.d(n,{A:()=>r});t(296540);var o=()=>t(401497),s=()=>t(284371),i=t(474848);function r(e){const n=(0,o().IS)((n=>({numberCircleBaseStyle:{display:"flex",flexShrink:0,borderRadius:"100%",backgroundColor:e.isHighlighted?n.palette.uiBlue[600]:e.isLightBlueHighlighted?n.blue.background.primaryTranslucent:"dark"===n.mode?n.palette.gray[300]:n.palette.gray[75],width:20,height:20,color:e.isHighlighted?"white":e.isLightBlueHighlighted?n.blue.text.accentPrimary:n.palette.gray[600],textAlign:"center",alignItems:"center",justifyContent:"center",fontWeight:s().Wy.semibold,fontSize:"10px"}})),[e.isHighlighted,e.isLightBlueHighlighted]);return(0,i.jsx)("div",{style:{...n.numberCircleBaseStyle,...e.style},children:e.number})}},921030:(e,n,t)=>{t.d(n,{F:()=>s});t(296540);const o={viewBox:"0 0 16 16",fittedViewBox:"2.12 2.73 11.71 9.9",svg:(0,t(474848).jsx)("path",{d:"M3.25 2.73c-.621 0-1.125.504-1.125 1.125V10.5c0 1.174.951 2.125 2.125 2.125h7.458a2.125 2.125 0 0 0 2.125-2.125V6.184a2.125 2.125 0 0 0-2.125-2.125H7.374l-.744-.914a1.13 1.13 0 0 0-.872-.415zm.125 3.445V3.98h2.324l.744.914c.213.263.534.415.872.415h4.393c.48 0 .87.387.875.866zm0 4.325V7.325h9.208V10.5a.875.875 0 0 1-.875.875H4.25a.875.875 0 0 1-.875-.875"})},s=(0,t(340498).wt)("folderSmall",o)}}]);