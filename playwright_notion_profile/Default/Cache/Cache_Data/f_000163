"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[50856],{44750:(e,t,o)=>{o.d(t,{Z:()=>k,p:()=>C});o(16280),o(581454),o(296540);var n=()=>o(564884),i=()=>o(484714),r=()=>o(56366),a=()=>o(401497),l=()=>o(663077),s=()=>o(898244),c=()=>o(534177),p=()=>o(231297),d=()=>o(147503),u=()=>o(736982),m=()=>o(403905),y=()=>o(972435),g=()=>o(317053),f=()=>o(101926),S=()=>o(513349),h=()=>o(922952),b=()=>o(913454),v=()=>o(204067),w=()=>o(272752),T=()=>o(362941),x=()=>o(960127),I=()=>o(342288),_=()=>o(902842),A=o(474848);function k({environment:e,template:t,isInSuggestedSection:o,collectionContextStore:n}){return{key:t.templateId,action:()=>{if(o)C({environment:e,template:t,collectionContextStore:n,suggestedFeatureAnalytics:void 0});else{const{collectionStore:o,collectionViewStore:i,collectionSettingsStore:r}=(0,w().i)(n);(0,S().UD)({template:t,environment:e,collectionStore:o,collectionViewStore:i,collectionSettingsStore:r,collectionContextStore:n})}},render:e=>(0,A.jsx)(P,{buttonMenuItemProps:e,template:t,isInSuggestedSection:o})}}function C({environment:e,collectionContextStore:t,template:o,suggestedFeatureAnalytics:i}){const r=t.collectionStore();if(!r)throw new Error("collectionStore not found");const a=r.getWorkflowTemplateId();i&&(0,n().u)({environment:e,event:{eventName:"suggested_feature_template_clicked",eventProperties:{origin:i.origin,selected_index:i.selectedIndex,template_ids_shown:i.shownTemplateIds,template_id_clicked:o.templateId,collection_template_id:a}}});const s=t.settingsStore;if((0,x().isWorkflowTemplateWithConfirmStep)(o))d().a2({collectionSettingsStore:s,item:{type:"confirmAddTemplate",template:o}});else if((0,l().Sz)(o)){const{relatedCollectionTemplateId:t}=o;!function({environment:e,template:t,collectionStore:o,relatedCollectionTemplateId:n}){var i;const r=null===(i=o.getParentBlockStore())||void 0===i?void 0:i.getParentStore();if(!r)throw new Error(`parentStore not found for ${o.id}`);if(!(0,h().u)(r))throw new Error(`Incorrect parent store: ${r.table} ${r.id}`);const a=b().globalWorkflowTemplates.fromIdOfType({templateId:n,type:"collection"});(0,g().openSelectedTemplateOnboardingModalForInAppFlows)({environment:e,template:a,origin:"suggested_feature_template",parentStore:r,navigateToOnFinish:"skip",relationInfos:[{type:"source",collectionStore:o,relationPropertyTemplate:t}],aiPrompt:void 0})}({environment:e,template:o,collectionStore:r,relatedCollectionTemplateId:t})}else p().createAndCommit({userAction:"FeatureTemplateMenuItem.addFeatureTemplateToTarget",environment:e,canUndo:!0,perform:l=>{f().ai({environment:e,transaction:l,collectionStore:r,template:o,logger:new(b().WorkflowTemplateLogger),origin:"suggested_feature"}),i&&(0,n().u)({environment:e,event:{eventName:"suggested_feature_template_added",eventProperties:{origin:i.origin,template_id_added:o.templateId,collection_template_id:a}}});const c=t.collectionViewStore();c&&S().UD({template:o,environment:e,collectionStore:r,collectionViewStore:c,collectionSettingsStore:s,collectionContextStore:t})}})}function P({buttonMenuItemProps:e,template:t,isInSuggestedSection:o}){const n=(0,a().IS)((e=>({iconContainer:{height:28,width:28,display:"flex",alignItems:"center",justifyContent:"center"},icon:{fill:e.icon.primary}})),[]),{collectionStore:l}=(0,w().V)(),p=(0,i().v3)(),d=(0,r().K8)((()=>(0,v().NU)({environment:p,collectionStore:l,templateId:t.templateId})),[p,l,t.templateId]),g=(0,r().K8)((()=>function({template:e,collectionStore:t}){const{type:o}=e;switch(o){case"property":const{value:n}=e;if((0,s().DQ)(n)){const o=function({templateId:e,propertyTemplateSchema:t,collectionStore:o}){const n=(0,v().S1)({collectionStore:o,templateId:e,instancePointerType:"property"});if(!n)return t.options??[];const i=o.getSchema()[n.id];if(!i||!(0,s().DQ)(i))return[];return i.options??[]}({templateId:e.templateId,propertyTemplateSchema:n,collectionStore:t}).map((e=>e.value));return(0,b().getWorkflowTemplateItemsCaption)(o)}return;case"collection_view":return`${y().A.formatMessage(m().X[e.value.type])} view`;case"compound":return;default:(0,c().HB)(o)}}({template:t,collectionStore:l})),[t,l]),f=(0,b().getWorkflowTemplateName)(t);return o?(0,A.jsx)(u().I,{buttonMenuItemProps:e,title:f,icon:(0,A.jsx)(_().n,{template:t}),right:(0,A.jsx)(I().z,{isAdded:d})}):(0,A.jsx)(u().I,{buttonMenuItemProps:e,title:f,caption:g,icon:(0,A.jsx)("div",{style:n.iconContainer,children:(0,A.jsx)(_().z,{template:t,iconStyle:n.icon})}),right:(0,A.jsx)(T()._,{})})}},200277:(e,t,o)=>{o.d(t,{$:()=>u,N:()=>p});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(430670),o(581454);var n=()=>o(536095),i=()=>o(663077),r=()=>o(496603),a=()=>o(534177),l=()=>o(299545),s=()=>o(913454),c=()=>o(204067);function p(e,t){const o=(0,c().Xg)(e,t),n=new Set(function(e){const t=e.getParentBlockStore();if(null==t||!t.isDefined())return[];return(null==t?void 0:t.getCollectionViewStores().map((e=>e.getName())).filter(a().O9))??[]}(t));return function(e){const t=new Set(e.map((e=>e.templateId))),o=[];for(const n of e)o.push(...d(n).filter((e=>!t.has(e))).map((e=>s().globalWorkflowTemplates.fromId(e))).filter(i().bz).filter((e=>!(0,i().Sz)(e))));return o}(o).filter((e=>"collection_view"!==e.type||!n.has(e.value.name??"")))}function d(e){return"compound"===e.type||"collection"===e.type?e.value.templateItems.filter((e=>"optionalDefaultOn"===e.optionality||"optionalDefaultOff"===e.optionality)).map((e=>e.pointer)):[]}function u({persona:e,parentStore:t}){const o=e?(0,n().Qf)({persona:e}):[],i=s().globalWorkflowTemplates.allOfType({templateIds:o??[],type:"collection"}),a=r().hS(function({collectionTemplates:e,parentStore:t}){if(!t)return e;if((0,l().Yu)(t))return e;const o=(0,l().$R)(t)?t.getTeamPageStores():t.getContentStores(),n=new Set((0,r().oE)(o.flatMap((e=>e.getOwnedAndLinkedCollectionStores().map((e=>e.getWorkflowTemplateId()))??[])))),i=[],a=[];for(const r of e)n.has(r.templateId)?i.push(r):a.push(r);return[...a,...i]}({collectionTemplates:[...i,...s().globalWorkflowTemplates.allOfType({templateIds:(0,n().dj)(),type:"collection"})],parentStore:t}),(e=>e.templateId));return a}},272752:(e,t,o)=>{o.d(t,{V:()=>a,i:()=>l});var n=()=>o(56366),i=()=>o(220719),r=()=>o(908201);function a(){const e=(0,r().ET)(),{collectionStore:t,collectionViewStore:o,collectionSettingsStore:i}=(0,n().K8)((()=>l(e)),[e]);return{collectionStore:t,collectionViewStore:o,collectionSettingsStore:i,collectionContextStore:e}}function l(e){return{collectionStore:(0,i().o9)(e.collectionStore(),"collectionStore not found"),collectionViewStore:(0,i().o9)(e.collectionViewStore(),"collectionViewStore not found"),collectionSettingsStore:e.settingsStore}}},342288:(e,t,o)=>{o.d(t,{z:()=>l});o(296540);var n=()=>o(401497),i=()=>o(831310),r=()=>o(464699),a=o(474848);function l({isAdded:e}){const t=(0,n().IS)((t=>({circle:{height:24,width:24,borderRadius:50,display:"flex",alignItems:"center",justifyContent:"center",background:e?"dark"===t.mode?t.palette.blue[100]:t.palette.blue[50]:t.lightGrayButtonBackground},plusIcon:{height:15,width:15,fill:t.icon.secondary},checkIcon:{height:12,width:12,fill:t.blue.icon.accentPrimary}})),[e]);return(0,a.jsx)("div",{style:t.circle,children:e?(0,i().o)(t.checkIcon):(0,r().b)(t.plusIcon)})}},362941:(e,t,o)=>{o.d(t,{_:()=>l});o(296540);var n=()=>o(401497),i=()=>o(252291),r=()=>o(158115),a=o(474848);function l(){const e=(0,n().IS)((e=>({icon:{marginInlineStart:6}})),[]);return(0,a.jsx)("span",{style:e.icon,children:(0,a.jsx)(i().I,{icon:r().arrowChevronSingleRightFillSmallIcon,size:"xs",colorVariant:"tertiary"})})}},513349:(e,t,o)=>{o.d(t,{Sj:()=>s,UD:()=>l});o(16280);var n=()=>o(147503),i=()=>o(180762),r=()=>o(204067);const a={property:function({template:e,collectionStore:t,collectionViewStore:i,collectionSettingsStore:a}){const l=(0,r().S1)({collectionStore:t,templateId:e.templateId,instancePointerType:"property"});if(!l)throw new Error(`No property instance found for property template ${e.templateId}`);const s=i.getType();n().a2({collectionSettingsStore:a,item:{type:"property",property:l.id,formatKey:s?o(651124).u9(s):void 0}})},collection_view:function({template:e,environment:t,collectionStore:o,collectionContextStore:n}){const i=(0,r().S1)({collectionStore:o,templateId:e.templateId,instancePointerType:"collection_view"});if(!i)throw new Error(`No collection view instance found for property template ${e.templateId}`);s({environment:t,collectionContextStore:n,collectionViewId:i.id})},compound:function(e){}};function l(e){a[e.template.type](e)}function s({environment:e,collectionContextStore:t,collectionViewId:o}){var r;(null===(r=t.collectionViewStore())||void 0===r?void 0:r.id)!==o&&(0,i().t)({environment:e,collectionContextStore:t,collectionViewId:o,isFullScreen:t.isFullScreenStore.state,isRootChild:t.isRootChildStore.state,isInPeekRenderer:t.isInPeekRendererStore.state}),n().a2({collectionSettingsStore:t.settingsStore,item:{type:"main"}})}},736982:(e,t,o)=>{o.d(t,{I:()=>p,h:()=>c});o(296540);var n=()=>o(484714),i=()=>o(401497),r=()=>o(284371),a=()=>o(760217),l=()=>o(115512),s=o(474848);function c({environment:e}){return{padding:e.device.isMobile?"12px 2px":"6px",alignItems:"center"}}function p({buttonMenuItemProps:e,title:t,caption:o,icon:p,onClick:d,right:u,isDisabled:m}){const y=(0,n().v3)(),g=(0,i().IS)((e=>({menuItem:{display:"flex",...c({environment:y}),opacity:m?.4:void 0},title:{fontSize:(0,l().ny)(y,"UIRegular"),...r().RC},caption:{fontSize:(0,l().ny)(y,"UISmall"),overflow:"hidden",color:e.text.secondary,whiteSpace:"nowrap",textOverflow:"ellipsis"}})),[y,m]),f={};return d&&(f.onClick=d),(0,s.jsx)(a().A,{...e,style:g.menuItem,disabled:m,title:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{style:g.title,children:t}),o?(0,s.jsx)("div",{style:g.caption,children:o}):void 0]}),icon:p,right:u,...f})}},878665:(e,t,o)=>{o.d(t,{d:()=>r});var n=o(296540),i=o(474848);const r=n.memo((function(e){const{caption:t,description:r,hideTooltipBeforeImageLoaded:a,imageContainerStyle:l,placement:s,render:c,showImage:p,tooltipDelayThreshold:d,tooltipImage:u,tooltipImageScale:m=1}=e,[y,g]=(0,n.useState)(!1),[f,S]=(0,n.useState)({width:0,height:0});(0,n.useEffect)((()=>{if(!u)return;const e=new Image;e.src=u,e.onload=()=>{S({width:"number"==typeof m?e.width*m:m.widthPx,height:"number"==typeof m?e.width*m:m.heightPx}),g(!0)}}),[u,m]);const h=(0,o(401497).IS)((()=>({tooltip:{whiteSpace:"break-spaces",width:"max-content",maxWidth:300},description:{fontWeight:"normal",color:o(100622).Tj.uiLightGray}})),[]),b=(0,n.useCallback)((()=>{const e=(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{children:t}),r?(0,i.jsx)("div",{style:h.description,children:r}):void 0]});return u&&y&&p?(0,i.jsx)(o(103448).A,{caption:e,imageURL:u,imageWidth:f.width,imageHeight:f.height,imageContainerStyle:l}):e}),[t,r,l,f.height,f.width,y,p,h.description,u]);return(0,i.jsx)(o(859428).A,{placement:s??"left",disableTooltip:void 0===t||!y&&a,delayThreshold:d,style:h.tooltip,render:c,renderTooltip:b})}))},933371:(e,t,o)=>{o.d(t,{X:()=>n});const n=o(757695).Store.createValue({shouldReset:!1},{name:"MobileAssistantMenuStore"})},938946:(e,t,o)=>{o.d(t,{il:()=>Ee,DZ:()=>lt,xv:()=>ct,Re:()=>Fe,bj:()=>qe,D1:()=>Ve,b9:()=>$e,f1:()=>Ye,p1:()=>Ge,bi:()=>He,Dm:()=>Le,D9:()=>We,ds:()=>Ke});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(823215),o(354520),o(672577),o(430670),o(803949),o(581454),o(737550);var n=o(296540),i=()=>o(564884),r=()=>o(59226),a=()=>o(242422),l=()=>o(726637),s=()=>o(484714),c=()=>o(56366),p=()=>o(401497),d=()=>o(929219),u=()=>o(66689),m=()=>o(489242),y=()=>o(536095),g=()=>o(663077),f=()=>o(716016),S=()=>o(898244),h=()=>o(713998),b=()=>o(455348),v=()=>o(852424),w=()=>o(617871),T=()=>o(412237),x=()=>o(344417),I=()=>o(340498),_=()=>o(386164),A=()=>o(985529),k=()=>o(470020),C=()=>o(69708),P=()=>o(496603),M=()=>o(534177),j=()=>o(284371),N=()=>o(10521),D=()=>o(559506),O=()=>o(36629),E=()=>o(896628),R=()=>o(231297),K=()=>o(67103),W=()=>o(774952),F=()=>o(413955),B=()=>o(374562),z=()=>o(235059);function U(e){return"variants"in e&&(0,m().ec)(e.collectionUri)}var G=()=>o(652079),H=()=>o(908201),L=()=>o(551882),V=()=>o(13898),$=()=>o(760217),q=()=>o(285790),Y=()=>o(419357),X=()=>o(710149),Q=()=>o(147294),J=()=>o(89924),Z=()=>o(933117),ee=()=>o(859428),te=()=>o(125565),oe=()=>o(921855),ne=()=>o(852353),ie=()=>o(68465),re=()=>o(521488),ae=()=>o(148307),le=()=>o(53137),se=()=>o(252833);const ce=[w().ob,w().Hd,w().e1,w().io,w().k0,w().zG];var pe=()=>o(229778),de=()=>o(310001),ue=()=>o(553965),me=()=>o(41223),ye=()=>o(470928),ge=()=>o(817126),fe=()=>o(249847),Se=()=>o(176983),he=()=>o(255824),be=()=>o(765957),ve=()=>o(463830),we=()=>o(411671),Te=()=>o(991249),xe=()=>o(112698),Ie=()=>o(118849),_e=()=>o(44750),Ae=()=>o(902842),ke=()=>o(913454),Ce=()=>o(204067),Pe=()=>o(265793),Me=()=>o(200277);var je=()=>o(147503),Ne=()=>o(334684),De=()=>o(878665),Oe=o(474848);const Ee=4,Re=4;function Ke({collectionContextStore:e,propertySchema:t,disableSuggestions:o,hasAiEnabled:r,showAiSuggestions:a,getFilteredSuggestedItemKeys:l,onAccept:y,iconStyle:g,buttonStyle:f,onAfterAccept:S,nameInput:h}){const v=(0,s().v3)(),w=(0,p().DP)(),T=(0,C().tz)(),x=(0,p().IS)((e=>({aiIconStyle:{fill:e.aiPurpleColor},defaultIconStyle:{fill:e.icon.primary}})),[]),I=(0,c().K8)((()=>{var t;const o=null===(t=e.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.app_config_uri;return o?(0,z().l)((0,F().appConfigs)(),o):void 0}),[e]);(0,Pe().b)(e);const A=function(e){const t=(0,s().v3)();return(0,Pe().b)(e),(0,c().K8)((()=>{const o=e.collectionStore();return o?(0,Me().N)(t,o):[]}),[t,e])}(e),k=function({collectionContextStore:e,showAiSuggestions:t}){const o=(0,s().v3)(),i=(0,c().K8)((()=>{var t;const o=null===(t=e.collectionStore())||void 0===t?void 0:t.getSchema();return o?P().oE(Object.values(o).map((e=>null==e?void 0:e.name.toLocaleLowerCase()))):[]}),[e]),r=(0,n.useCallback)((e=>e.filter((e=>!i.includes(e.name.toLocaleLowerCase())))),[i]),a=(0,c().K8)((()=>{const t=e.collectionStore(),o=null==t?void 0:t.getFormat();if(null!=o&&o.ai_suggested_properties&&(null==o?void 0:o.ai_suggested_properties.length)>0)return r(null==o?void 0:o.ai_suggested_properties)}),[e,r]),[l,p]=(0,n.useState)(a||"loading"),d=(0,n.useRef)(!1);return(0,n.useEffect)((()=>{if(d.current||a)return;(async()=>{const t=e.collectionStore(),n=null==t?void 0:t.getSpaceId(),a=null==t?void 0:t.id,l=[];if(n&&a&&t.getName()){const e=await D().callApi({eventName:"getAiSuggestedProperties",environment:o,data:{spaceId:null==t?void 0:t.getSpaceId(),collectionId:null==t?void 0:t.id,schema:P().oE(Object.values(t.getSchema())),collectionName:(0,oe().r4)(t.getName(),t),numSuggestion:Re},headers:(0,_().WS)({spaceId:n})});if("success"===e.type){const n=e.data.properties.filter((e=>!i.includes(e.name.toLocaleLowerCase())));l.push(...n),R().createAndCommit({environment:o,perform:e=>{E().zA({stores:[t],update:{ai_suggested_properties:n},transaction:e})},canUndo:!0,userAction:"propertyType.generateAiSuggestion"})}}const s=r(l);p(s)})(),d.current=!0}),[e,o,l,t,a,i,r]),l}({collectionContextStore:e,showAiSuggestions:a}),M=(0,c().K8)((()=>(0,ie().QV)()),[]),j=!(0,c().O$)(d().e),N=(0,c().K8)((()=>{if(t||o||j)return[];const n=A.filter((e=>(0,ke().shouldShowInSuggestedProperties)(e))),i=e.collectionStore(),l=null==i?void 0:i.getSchema(),s=null==i?void 0:i.getFormat();if(I){const e=function({appConfig:e,collectionFormat:t,collectionSchema:o,hasAiEnabled:n}){if(!t||!o)return[];const i=e=>{const i=t.app_config_uri,r=b().u9.derivePropertyUris(o??{},t.app_uri_map);if(e.collectionUri!==i)return!1;let a=!0;e.uri===(0,B().Jb)().uri&&r.has(u().yx.GithubPrsRelation)&&(a=!1);return e.dependencies.some((e=>"property"===e.type&&e.collectionUri===i&&(0,m().LE)(e.uri)&&!r.has(e.uri)))&&(!e.isAi||n)&&a},r={};e.allFeatures.forEach((t=>{U(t)&&t.variants.every((t=>Boolean(e.allFeatures.find((e=>e.uri===t&&(0,G().l)(e)&&i(e))))))&&(r[t.uri]=t.variants)}));const a=Object.values(r).flat(),l=e.allFeatures.filter((e=>(0,G().l)(e)&&!a.find((t=>t===e.uri))?i(e):!!U(e)&&Boolean(r[e.uri])));return l.sort(((e,t)=>U(e)?-1:U(t)?1:e.dependencies.length-t.dependencies.length))}({appConfig:I,collectionFormat:s,collectionSchema:l,hasAiEnabled:r});return(M?e.filter((e=>"notion://tasks/task_summary_feature"!==e.uri)):e).map((e=>({type:"typed",appConfigFeature:e})))}if(n.length>0)return n.map((e=>({type:"workflow",template:e})));if(a)return"loading"===k?"loading":k.map((e=>({type:"ai_suggestion",propertySchema:e})));if(!M){return function(e,t){const o=t?function(e){const t=new Set;for(const n in e){const i=e[n];if(i&&"ai_inference"in i){var o;const e=null===(o=i.ai_inference)||void 0===o?void 0:o.type;if(e)switch(e){case"custom":t.add("ai_custom_prompt");break;case"summarize":t.add("ai_summary");break;case"extract":t.add("ai_extract");break;case"translate":t.add("ai_translate")}}else i&&"select_ai_inference"in i&&t.add("ai_keywords")}return t}(t):new Set;return e.map((e=>({type:"derived_ai_property",propertyType:e}))).filter((e=>!at.includes(e.propertyType)||!o.has(e.propertyType)))}((0,ne().lO)({environment:v,collectionContextStore:e}),l)}return[]}),[t,o,A,I,a,M,r,k,v,e,j],{useDeepEqual:!0}),O=(0,n.useMemo)((()=>{if("loading"===N)return[];const e=N.filter((e=>"workflow"===e.type)).map((e=>Qe(e.template.templateId)));return l(e).map(Je)}),[N,l]);!function({collectionContextStore:e,shownTemplateIds:t,origin:o}){const r=(0,s().v3)(),a=(0,c().K8)((()=>{var t;return null===(t=e.collectionStore())||void 0===t?void 0:t.getWorkflowTemplateId()}),[e]),l=(0,n.useRef)(!1);(0,n.useEffect)((()=>{!l.current&&t.length>0&&((0,i().u)({environment:r,event:{eventName:"suggested_feature_templates_shown",eventProperties:{origin:o,collection_template_id:a,template_ids_shown:t}}}),l.current=!0)}))}({collectionContextStore:e,origin:"suggested_properties",shownTemplateIds:O});return(0,c().K8)((()=>"loading"===N?"loading":Object.fromEntries(N.map(((t,o)=>{switch(t.type){case"ai_suggestion":return[t.propertySchema.name.toLowerCase(),tt({collectionContextStore:e,propertyType:t.propertySchema.type,propertyName:t.propertySchema.name,disablePropertyTooltip:!0,intl:T,onAccept:y,isSuggestedProperty:!0,iconStyle:g,isOffline:j,buttonStyle:f})];case"typed":return[t.appConfigFeature.name.toLowerCase(),et({appConfig:I,suggestedProperty:t.appConfigFeature,isDisabled:!1,environment:v,collectionContextStore:e,theme:w,iconStyle:g??x.defaultIconStyle,buttonStyle:f,onAfterAccept:S,nameInput:h})];case"workflow":return[(0,ke().getWorkflowTemplateName)(t.template).toLowerCase(),Ze({environment:v,template:t.template,collectionContextStore:e,iconStyle:g??x.defaultIconStyle,suggestedFeatureAnalytics:{origin:"suggested_properties",selectedIndex:O.indexOf(t.template.templateId),shownTemplateIds:O},buttonStyle:f,onAccept:S})];case"derived_ai_property":return[ne().dC[t.propertyType].toLowerCase(),tt({collectionContextStore:e,propertyType:t.propertyType,propertyName:ne().dC[t.propertyType],disablePropertyTooltip:!0,intl:T,iconStyle:x.aiIconStyle,onAccept:y,isSuggestedProperty:!0,isOffline:j,buttonStyle:f})]}})))),[I,e,v,T,N,w,y,O,g,x,j,f,S,h])}function We(e){const{filteredSuggestedPropertyItems:t,showAiSuggestions:o,hasSearchInput:i,disableSuggestions:r,isLoading:a,title:l,from:s}=e,c=(0,p().IS)((e=>({loadingTitleStyle:{marginTop:8,marginBottom:0,paddingInlineStart:"tableHeader"===s?14:10},titleContainer:{display:"flex",alignItems:"center"},aiIcon:{display:"inline-flex",width:I().Ev.sm,height:I().Ev.sm,fill:e.icon.secondary,marginInlineEnd:6},desktopTitleStyleTableHeader:{fontSize:12,fontWeight:j().Wy.medium,color:e.text.secondary,marginInlineStart:3},desktopStyleTableHeader:{padding:8,gap:2,display:"flex",flexDirection:"column",margin:0},shimmerContainer:{display:"flex",alignItems:"center",paddingInlineStart:12,paddingInlineEnd:8,gap:8,minHeight:"tableHeader"===s?35:27,maxWidth:192,minWidth:192},shimmerIcon:{width:16,height:16,borderRadius:3,flexShrink:0},shimmerText:{height:12,borderRadius:3}})),[s]),d=(0,n.useMemo)((()=>({key:"suggested",render:e=>(0,Oe.jsx)(J().A,{...e,title:(0,Oe.jsxs)("span",{style:c.titleContainer,children:[(0,T().aiFaceSmallIcon)(c.aiIcon),(0,Oe.jsx)(W().c,{styleKey:"Caption/Medium"})]}),disableMobileBorders:!0,desktopTitleStyle:c.loadingTitleStyle,mobileTitleStyle:c.loadingTitleStyle}),items:Array.from({length:Ee},((e,t)=>{const o=["35%","42%","28%","48%"],n=o[t%o.length];return{key:`property-shimmer-${t}`,action:()=>{},render:()=>(0,Oe.jsxs)("div",{style:c.shimmerContainer,children:[(0,Oe.jsx)(X().A,{style:c.shimmerIcon}),(0,Oe.jsx)(X().A,{style:{...c.shimmerText,width:n}})]})}}))})),[c.titleContainer,c.aiIcon,c.loadingTitleStyle,c.shimmerContainer,c.shimmerIcon,c.shimmerText]);return(0,n.useMemo)((()=>r?{key:"suggested",render:()=>null,items:[]}:t.length?{key:"suggested",render:e=>(0,Oe.jsx)(J().A,{...e,title:l,desktopTitleStyle:"tableHeader"===s?c.desktopTitleStyleTableHeader:{},desktopStyle:"tableHeader"===s?c.desktopStyleTableHeader:{}}),items:t}:a&&o&&!i?d:{key:"suggested",render:()=>null,items:[]}),[r,t,i,a,o,d,l,s,c.desktopStyleTableHeader,c.desktopTitleStyleTableHeader])}function Fe({environment:e,collectionContextStore:t,propertySchema:o,onAccept:i,section:r,iconStyle:a,buttonStyle:l}){const s=(0,C().tz)(),p=(0,c().K8)((()=>(0,ne().xm)({collectionContextStore:t,environment:e})),[t,e]),u=(0,n.useMemo)((()=>"all"===r?p:r.flatMap((e=>{switch(e){case"basic":return Be;case"advanced":return ze;case"metadata":return Ue;default:(0,M().HB)(e)}})).filter((e=>p.includes(e)))),[r,p]),m=!(0,c().O$)(d().e);return(0,c().K8)((()=>Object.fromEntries(u.map((e=>{const n=(0,ne().GN)(s,e);return[n.toLowerCase(),tt({propertyType:e,propertyName:n,collectionContextStore:t,disablePropertyTooltip:!1,onAccept:i,intl:s,propertySchema:o,isSuggestedProperty:!1,iconStyle:a,isOffline:m,buttonStyle:l})]})))),[t,s,i,o,u,a,m,l])}const Be=["text","number","select","multi_select","status","date","person","file","checkbox","url","phone_number","email"],ze=["relation","rollup","formula","button","auto_increment_id","place"],Ue=["created_time","last_edited_time","created_by","last_edited_by"];function Ge({iconStyle:e,buttonStyle:t,onAfterAccept:o}){const n=(0,C().tz)(),r=(0,s().v3)(),a=(0,H().ET)(),l=(0,p().IS)((e=>({defaultIconStyle:{fill:e.icon.primary}})),[]),d=(0,c().K8)((()=>a.collectionStore()),[a]),u=(0,c().K8)((()=>{const s=function({environment:e,collectionContextStore:t,spaceStore:o}){var n;if(!(0,me().I)())return!1;const i=null==o?void 0:o.getModel();if(!i||!(0,k().X)(i))return!1;const r=null===(n=t.collectionViewBlockStore())||void 0===n?void 0:n.isCollectionViewPageWithContent();if(r)return!1;const a=t.collectionStore();if(!a)return!1;const l=(0,Ce().NU)({environment:e,collectionStore:a,templateId:y().z$});if(l)return!1;return!0}({environment:r,collectionContextStore:a,spaceStore:null==d?void 0:d.getSpaceStore()}),c=(0,ye().$3)({environment:r,collectionStore:d});if(!s&&!c)return{};const p=ke().globalWorkflowTemplates.fromId(y().z$);if(!(0,g().bz)(p))return{};const u=(0,ye().xE)(r),m="verification_upsell_item_collection_entrypoint",f=c?(0,Oe.jsx)(Ie().A,{subscriptionTier:"business",analyticsName:m}):u?(0,Oe.jsx)(Q().Ee,{style:{marginInlineStart:2},newBadgeKey:"verification",didUserEngage:!1,keyType:"date"}):void 0;return{[p.templateId]:Ze({environment:r,template:p,collectionContextStore:a,suggestedFeatureAnalytics:void 0,titleBadge:f,onAccept:()=>{var e,t;c?(0,Te().K)(r,{from:m,upsell:{type:"product",product:"business",limit:{type:"none"},trialability:"none"}}):((0,i().u)({environment:r,event:{eventName:"page_verification_property_added",eventProperties:{space_id:null===(e=be().default.getState().sidebarSpaceStore)||void 0===e?void 0:e.id,collection_id:null===(t=a.collectionStore())||void 0===t?void 0:t.id}}}),null==o||o())},titleOverride:n.formatMessage(K().Gl.verificationPropertyName),isUpsell:c,tooltip:(0,Oe.jsx)(C().sA,{...st.verification}),iconStyle:e??l.defaultIconStyle,buttonStyle:t})}}),[o,n,a,r,e,l.defaultIconStyle,t,d]);return u}function He({searchProperties:e,titleText:t,desktopTitleStyle:o,desktopStyle:i,topBorder:r,inputStyle:a}){const{searchInput:s,showSearchInput:c,handleSearchInputChange:d,handleToggleSearchInput:u}=e,m=(0,C().tz)(),y=(0,n.useCallback)((e=>{e&&l().A.isMobile&&e.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}),[]),g=(0,p().IS)((()=>({titleContainer:{display:"flex",alignItems:"center"},icon:{width:I().Ev.xs,height:I().Ev.xs},button:{width:20,height:20,margin:4}})),[]),f=(0,n.useMemo)((()=>(0,Oe.jsxs)("span",{style:g.titleContainer,children:[(0,Oe.jsx)("span",{children:t}),(0,Oe.jsx)(ee().A,{placement:"top",renderTooltip:()=>(0,Oe.jsx)(C().sA,{id:"tableHeaderPropertyCreationMenu.searchTooltip",defaultMessage:"Search types"}),render:e=>(0,Oe.jsx)(q().A,{ariaLabel:m.formatMessage(lt.newSearchPlaceholder),icon:x().u,iconStyle:g.icon,style:g.button,onClick:u,...e})})]})),[u,g,t,m]),S=(0,n.useCallback)((e=>{"ArrowLeft"!==e.key&&"ArrowRight"!==e.key||e.stopPropagation(),"ArrowDown"!==e.key&&"ArrowUp"!==e.key||e.currentTarget.blur()}),[]),h=(0,n.useMemo)((()=>({key:"search-input",render:e=>(0,Oe.jsx)(Y().Ay,{...e,ref:y,placeholder:m.formatMessage(lt.newSearchPlaceholder),value:s,onChange:d,autoFocus:!0,focusInitial:!0,style:a,preventCaptureArrowShortcuts:!0,onKeyDown:S}),action:()=>{}})),[y,d,s,a,m,S]);return(0,n.useMemo)((()=>({key:"search-input",render:e=>(0,Oe.jsx)(J().A,{...e,topBorder:r,title:f,desktopStyle:i,desktopTitleStyle:o}),items:c?[h]:[]})),[i,o,f,h,c,r])}function Le({title:e,filteredStandardPropertyItems:t,key:o,desktopStyle:i,topBorder:r}){return(0,n.useMemo)((()=>t.length?{key:o,render:t=>(0,Oe.jsx)(J().A,{...t,topBorder:r,desktopStyle:i,title:e}),items:t}:{key:o,render:()=>null,items:[]}),[t,r,i,o,e])}function Ve({collectionContextStore:e,propertySchema:t,propertyGroupId:o,buttonStyle:i,propertyName:r,onAfterAccept:l}){const p=(0,s().v3)(),m=(0,C().tz)(),y=(0,c().K8)((()=>le().A.bots.state),[]),g=(0,c().K8)((()=>e.collectionStore()),[e]),f=(0,c().K8)((()=>(null==g?void 0:g.getSchema())??{}),[g]),S=(0,c().K8)((()=>Boolean(null==g?void 0:g.isPageTreeCollection())),[g]),b=(0,c().K8)((()=>e.databaseType),[e]),v=(0,c().K8)((()=>{var e;return null===(e=be().default.state.sidebarSpaceStore)||void 0===e?void 0:e.canEdit()}),[]),T=(0,Se().J)(),x=(0,c().K8)((()=>{if(void 0!==t)return;const e=function(e,t){if(!e)return[];const o=a().default.checkGate({gateName:"cron_connected_relation"}),n=a().default.checkGate({gateName:"connected_relation"}),i=a().default.checkGate({gateName:"slack_connected_relation"}),r=a().default.checkGate({gateName:"salesforce_connected_relation_database_actions_enabled"}),l=e.getDatabaseType()===u().dC,s=le().A.state;if(!s.loaded)return[];const c=s.integrations,p={};if(!l){const e=c.find((e=>e.id===w().ob)),t=(0,B().Jb)();var d;e&&(p[t.name]={name:t.name,pattern:re().Y,integration:e,tooltipImage:{img:ae().A.images.tooltips.properties.githubSyncPullStatusPng,scale:.5},description:t.description,canOnlyAdminAuth:{disabledPropertyTooltipMessage:null===(d=t.canOnlyAdminAuth)||void 0===d?void 0:d.disabledPropertyTooltipMessage}})}const m=[];if(t&&(m.push(w().Hd,w().e1,w().k0),i&&m.push(w().zG)),o&&m.push(w().io),m.forEach((e=>{const t=c.find((t=>t.id===e));if(null!=t&&t.info.original_url_patterns)for(const n of t.info.original_url_patterns){var o;null!==(o=n.additional_types)&&void 0!==o&&o.connectedRelation&&(p[n.name]||(p[n.name]={name:(0,se().Fe)({pattern:n,integration:t}),pattern:n,integration:t}))}})),!n)return Object.values(p);for(const a of c)if(a.info.original_url_patterns&&t&&![...ce,w().F6].includes(a.id))for(const e of a.info.original_url_patterns){var y;null!==(y=e.additional_types)&&void 0!==y&&y.connectedRelation&&(p[e.name]||(a.id===w().mn&&r?p[a.name]={name:w().Aj,pattern:e,integration:a}:p[e.name]={name:(0,se().Fe)({pattern:e,integration:a}),pattern:e,integration:a}))}return Object.values(p)}(g,v),o=(0,de().Yn)(T);return e.sort(((e,t)=>o[e.integration.id]-o[t.integration.id])),e}),[g,t,v,T]),I=(0,c().K8)((()=>{var t;return null===(t=e.collectionStore())||void 0===t?void 0:t.getSpaceId()}),[e]),_=(0,fe().T)(),k=(0,ge().Ld)({spaceId:I,userId:_}),P=(0,c().K8)((()=>Boolean(null==g?void 0:g.isSyncedCollection())),[g]),j=(0,he().a)(),N=!(0,c().O$)(d().e),D=(0,n.useMemo)((()=>{if(null!=x&&x.length&&!j&&!N)return Object.fromEntries(x.map((t=>{const{isDisabled:n,featureAvailability:a,propertyDisabledTooltip:s}=function({propertyConfig:e,databaseType:t,bots:o,isSpaceAdmin:n,isMobile:i,isWikiCollection:r,isSyncedCollection:a,schema:l,intl:s,featureAvailabilities:c}){const p="integration"in e?e.integration.id:e.integrationId;if(!p)return{isDisabled:!1};const d=c[p];if(d&&!(0,A().e2)(d))return{isDisabled:!1,featureAvailability:d};var m;if((0,h().iY)({isAuthed:Boolean(o.find((e=>e.integration_id===p))),isSpaceAdmin:n,isPropertyAdminAuthOnly:Boolean(e.canOnlyAdminAuth),isMobile:i}))return{isDisabled:!0,propertyDisabledTooltip:null===(m=e.canOnlyAdminAuth)||void 0===m?void 0:m.disabledPropertyTooltipMessage};if(p===w().ob){if(rt(l,w().ob))return{isDisabled:!0,propertyDisabledTooltip:s.formatMessage(lt.duplicateGithubPropertyTooltip)};if(r)return{isDisabled:!0,propertyDisabledTooltip:s.formatMessage(lt.wikiGithubPropertyTooltip)};if(a)return{isDisabled:!0,propertyDisabledTooltip:s.formatMessage(lt.syncedDatabaseGithubPropertyTooltip)}}else if(p===w().io){if(rt(l,w().io),t!==u().TC)return{isDisabled:!0,propertyDisabledTooltip:s.formatMessage(lt.nonMeetingsCronPropertyTooltip)};if(rt(l,w().io))return{isDisabled:!0,propertyDisabledTooltip:s.formatMessage(lt.duplicateCronEventPropertyTooltip)}}return{isDisabled:!1}}({propertyConfig:t,bots:y,isSpaceAdmin:T,environment:p,isWikiCollection:S,databaseType:b,isSyncedCollection:P,schema:f,intl:m,isMobile:p.device.isMobile,featureAvailabilities:k});return[t.name.toLowerCase(),ot({connectedRelationProperty:t,isDisabled:n,propertyDisabledTooltip:s,environment:p,intl:m,collectionContextStore:e,propertyGroupId:o,featureAvailability:a,buttonStyle:i,propertyName:r,onAfterAccept:l})]})).filter(M().O9))}),[x,j,y,T,p,S,b,P,f,m,e,o,k,N,i,r,l]);return D}function $e(e){const{collectionContextStore:t,buttonStyle:o,onAfterAccept:i}=e,a=(0,s().v3)(),l=(0,C().tz)(),p=(0,c().K8)((()=>{var e;return(null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema())??{}}),[t]),u=(0,r().X)("connected_relations_database_actions_enabled"),m=!(0,c().O$)(d().e),[y,g]=(0,n.useMemo)((()=>{if(!u)return[{},[]];const e={};for(const[n,r]of Object.entries(p)){if(!r||!(0,S().UU)(r))continue;const s=r.connectedRelation.integration_id;if(!s||!(0,w().KB)(s))continue;const c=nt({propertySchema:r,environment:a,intl:l,collectionContextStore:t,propertyId:n,integrationId:s,isOffline:m,buttonStyle:o,onAfterAccept:i});e[s]||(e[s]={}),e[s][r.name.toLowerCase()]=c}return[e,Object.values(e).flat()]}),[l,p,u,a,t,m,o,i]);return[y,g]}function qe({filteredConnectedPropertyItems:e,hideTitle:t,desktopStyle:o}){const i=(0,C().tz)();return(0,n.useMemo)((()=>e.length?{key:"connected",render:e=>(0,Oe.jsx)(J().A,{...e,title:i.formatMessage(lt.connectedRelationSectionTitle),hideTitle:t,topBorder:t,desktopStyle:o}),items:e}:{key:"connected",render:()=>null,items:[]}),[e,t,o,i])}function Ye({filteredConnectedPropertyItemsPerIntegration:e}){const t=(0,C().tz)();return(0,n.useMemo)((()=>0===Object.keys(e).length?[{key:"existingConnectedRelations",render:()=>null,items:[]}]:Object.entries(e).map((([e,o])=>0===o.length?{key:e,render:()=>null,items:[]}:{key:e,render:o=>(0,Oe.jsx)("div",{style:{padding:4,gap:2,display:"flex",flexDirection:"column",margin:0},children:(0,Oe.jsx)(J().A,{...o,title:t.formatMessage(lt.existingConnectedRelationSectionTitle,{integrationName:(0,w().mi)(e)})})}),items:o}))),[e,t])}const Xe="workflow.";function Qe(e){return`${Xe}${e}`}function Je(e){return e.replace(Xe,"")}function Ze({environment:e,template:t,collectionContextStore:o,suggestedFeatureAnalytics:n,titleBadge:i,titleOverride:r,isUpsell:a,onAccept:l,tooltip:s,iconStyle:c,buttonStyle:p}){const d=r||(0,ke().getWorkflowTemplateName)(t);return{key:Qe(t.templateId),searchKeys:[d],action:()=>{a||(0,_e().p)({environment:e,template:t,collectionContextStore:o,suggestedFeatureAnalytics:n}),null==l||l()},render:e=>(0,Oe.jsx)(ee().A,{style:{whiteSpace:"break-spaces"},placement:"left",renderTooltip:()=>s,disableTooltip:!s,render:o=>(0,Oe.jsx)($().A,{...(0,ue().A)(o,e),title:(0,Oe.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,Oe.jsx)(te().A,{style:{marginInlineEnd:4},children:d}),i]}),icon:(0,Oe.jsx)(Ae().z,{template:t,size:16,iconStyle:c}),style:p})})}}function et({appConfig:e,suggestedProperty:t,isDisabled:o,propertyDisabledTooltip:n,environment:i,collectionContextStore:r,theme:a,iconStyle:l,buttonStyle:s,onAfterAccept:c,nameInput:p}){const d=r.collectionStore(),u=b().u9.derivePropertyUris((null==d?void 0:d.getSchema())??{},null==d?void 0:d.getPropertyMapping()),y=(e,t,n,i)=>{const r=n.dependencies.find((e=>{var t;return"property"===e.type&&e.collectionUri===(null==d||null===(t=d.getFormat())||void 0===t?void 0:t.app_config_uri)&&(0,m().LE)(e.uri)&&!u.has(e.uri)})),c=n.dependencies.find((e=>"property"===e.type&&(0,S().$M)(e.propertySchema)&&(0,S().om)(e.propertySchema)));if(r)return(0,Oe.jsx)($().A,{...e,disabled:o,disabledFeedback:o,title:(0,Oe.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[t,c?(0,Oe.jsx)(L().A,{}):null,n.isNew?"notion://projects/tasks_with_sprints_feature"===n.uri&&(0,Oe.jsx)(V().A,{}):null]}),icon:(0,Oe.jsx)(v().zB,{type:r.propertySchema.type,theme:a,icon:i,size:I().Ev.sm,style:l}),style:s})},g=new(ve().A);return{key:t.name,searchKeys:[t.name],render:o=>(0,Oe.jsx)(De().d,{showImage:!n,caption:n??t.description,render:n=>{if((0,G().l)(t))return y({...(0,ue().A)(o,n)},t.name,t,t.icon);{const a=P().oE(t.variants.map((t=>{const o=null==e?void 0:e.allFeatures.find((e=>e.uri===t));if(o&&(0,G().l)(o))return o})));return(0,Oe.jsx)(Z().A,{buttonPopupStore:g,items:a,getKey:e=>e.name,onSelect:async e=>{await O().h3({environment:i,feature:e,collectionContextStore:r,addFeatureFrom:"new_property",customPropertyName:p}),je().os({collectionSettingsStore:r.settingsStore}),null==c||c()},selectedItem:void 0,renderOrigin:e=>y({focused:Boolean(o.focused),...(0,ue().A)(P().cJ(o,"onClick","focused"),(0,ue().A)(n,e))},t.name,a[0],t.icon),renderItem:e=>(0,Oe.jsx)($().A,{...e,title:e.value.name,shouldWrapCaption:!0,shouldWrapTitle:!0,style:s})})}}}),action:async()=>{(0,G().l)(t)?(await O().h3({environment:i,feature:t,collectionContextStore:r,addFeatureFrom:"new_property",customPropertyName:p}),je().os({collectionSettingsStore:r.settingsStore})):g.setState({open:!0}),null==c||c()}}}function tt(e){const{collectionContextStore:t,propertySchema:o,propertyName:n,propertyType:i,disablePropertyTooltip:r,intl:a,onAccept:l,iconStyle:s,isSuggestedProperty:c,isOffline:p,buttonStyle:d}=e;return{key:n,searchKeys:[n,..."en"!==a.locale?[ne().Hp[i]]:[]],render:e=>{const l=o&&(null==o?void 0:o.type)===i,c=function({intl:e,collectionContextStore:t,propertyType:o,propertySchema:n,isOffline:i}){if(i&&(0,Ne().$)({propertyType:o,propertySchema:n,allowAIProperty:!1}))return e.formatMessage(N().AY.unavailableOfflineTooltip);if("auto_increment_id"===o){var r;if(null!=n&&n.type)return e.formatMessage(pe().q.convert_to_auto_increment_id_property);const o=t.collectionStore();if(null==o?void 0:o.isPageTreeCollection())return e.formatMessage(pe().q.wiki_forbidden_auto_increment_id_property);if(Boolean(null==o?void 0:o.isSyncedCollection()))return e.formatMessage(pe().q.synced_database_forbidden_auto_increment_id_property);const i=o&&o.id,a=o&&o.getFormat(),l=o&&(null===(r=o.getSpaceStore())||void 0===r?void 0:r.id),s=o&&o.getSchema(),c=o&&o.getDeletedSchema();if(!(i&&a&&l&&s&&c))return;const p=o.getModel();if(p&&(0,f().N_)(p))return e.formatMessage(pe().q.duplicate_auto_increment_id_property)}}({intl:a,collectionContextStore:t,propertyType:i,propertySchema:o,isOffline:p}),u=void 0!==c,m=!r&&st.hasOwnProperty(i)?a.formatMessage(st[i]):void 0;return(0,Oe.jsx)(it,{isChecked:l,buttonMenuItemProps:e,propertyName:n,propertyType:i,isDisabled:u,tooltip:c??m,iconStyle:s,buttonStyle:d})},action:()=>{l({propertyType:i,isSuggestedProperty:c,propertyName:n})}}}function ot({connectedRelationProperty:e,isDisabled:t,propertyDisabledTooltip:o,environment:n,collectionContextStore:r,intl:l,propertyGroupId:s,featureAvailability:c,buttonStyle:p,propertyName:d,onAfterAccept:u}){const m=c&&!(0,A().e2)(c);return{key:e.name,searchKeys:[e.name],render:n=>(0,Oe.jsx)(it,{buttonMenuItemProps:n,propertyName:e.name,propertyType:"relation",isDisabled:t,tooltip:o,icon:e.integration.info.icon,buttonStyle:p,badge:m?(0,Oe.jsx)(xe().B,{upsell:c.upsell,analyticsName:"collection_connected_property",disableTooltip:!0}):e.integration.id===w().mn&&(0,Oe.jsx)(V().A,{})}),action:async()=>{if(m)return void(0,Te().K)(n,{from:"collection_connected_property",upsell:c.upsell});const t=a().default.checkGate({gateName:"salesforce_connected_relation_database_actions_enabled"});if(e.integration.id===w().mn&&t){const t=r.collectionStore();(0,i().u)({environment:n,event:{eventName:"salesforce_actions",eventProperties:{actionType:"navigate_to_object_selection",integrationId:e.integration.id,collectionId:null==t?void 0:t.id}}}),je().a2({collectionSettingsStore:r.settingsStore,item:{type:"connectedRelationDatabaseActions",source:"ConnectedRelationObjectSelection",integrationId:e.integration.id}})}else await O().XO({environment:n,connectedRelationProperty:e,collectionContextStore:r,intl:l,from:"new_property",propertyGroupId:s,propertyName:d});null==u||u()}}}function nt(e){const{propertySchema:t,intl:o,collectionContextStore:n,propertyId:r,integrationId:a,isOffline:l,buttonStyle:s,onAfterAccept:c,environment:p}=e;return{key:r,searchKeys:[r],render:e=>(0,Oe.jsx)(it,{buttonMenuItemProps:e,propertyName:t.name,propertyType:"relation",icon:t.icon,isDisabled:l,tooltip:l?o.formatMessage(N().AY.unavailableOfflineTooltip):void 0,buttonStyle:s}),action:()=>{je().a2({collectionSettingsStore:n.settingsStore,item:{type:"connectedRelationDatabaseActions",source:"connectedRelationAddProperties",rootPropertyId:r,integrationId:a,rootPropertySchema:t,eventSource:"new_property_menu"}});const e=n.collectionStore();(0,i().u)({environment:p,event:{eventName:"salesforce_actions",eventProperties:{actionType:"add_properties_clicked",details:{source:"new_property_menu"},integrationId:a,collectionId:null==e?void 0:e.id}}}),null==c||c()}}}const it=n.memo((function(e){const{badge:t,buttonMenuItemProps:i,buttonStyle:r,icon:a,iconStyle:l,isChecked:s,isDisabled:c,propertyName:d,propertyType:u,tooltip:m,tooltipImage:y,tooltipImageScale:g}=e,[f,S]=(0,n.useState)(!1),h=(0,n.useCallback)((()=>{S(!0)}),[]),b=(0,n.useCallback)((()=>{S(!1)}),[]),w=(0,p().DP)(),T=(0,p().IS)((e=>({wrapper:{width:"100%"},container:{display:"inline-flex",alignItems:"center",justifyContent:"space-between",maxWidth:"100%",width:"100%",overflow:"hidden"},titleSection:{display:"inline-flex",flex:1,alignItems:"center",overflow:"hidden"},span:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginInlineEnd:4},questionIcon:{fill:e.icon.secondary,opacity:f?1:0,transition:"opacity 200ms ease-in-out",cursor:"pointer",flexShrink:0,display:"flex",alignItems:"center",width:I().Ev.xs,height:I().Ev.xs},defaultIconStyle:{fill:e.icon.primary}})),[f]);return(0,Oe.jsx)("div",{onMouseEnter:h,onMouseLeave:b,style:T.wrapper,children:(0,Oe.jsx)($().A,{...i,disabled:c,disabledFeedback:c,title:(0,Oe.jsxs)("div",{style:T.container,children:[(0,Oe.jsxs)("div",{style:T.titleSection,children:[(0,Oe.jsx)("span",{style:T.span,children:d}),t]}),m?(0,Oe.jsx)(De().d,{showImage:!c,caption:m,tooltipImage:c?void 0:y,tooltipImageScale:g,placement:"right",render:e=>(0,Oe.jsx)("div",{role:"button",tabIndex:0,style:T.questionIcon,onClick:e=>e.stopPropagation(),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||e.stopPropagation()},...e,children:(0,o(721479).questionMarkCircleSmallIcon)(T.questionIcon)})}):void 0]}),isChecked:s,icon:(0,Oe.jsx)(v().zB,{type:u,theme:w,icon:a,size:I().Ev.sm,style:l??T.defaultIconStyle}),buttonStyle:r})})}));function rt(e,t){for(const n in e){var o;const i=e[n];if(i&&"connectedRelation"in i&&(null===(o=i.connectedRelation)||void 0===o?void 0:o.integration_id)===t)return!0}return!1}const at=["ai_summary"];const lt=(0,C().YK)({propertyNameLabel:{defaultMessage:"Name",id:"database.viewSettings.propertyTypeSelect.propertyNameLabel"},searchPlaceholder:{defaultMessage:"Search or add new property",id:"database.viewSettings.propertyTypeSelect.searchPlaceholder"},newSearchPlaceholder:{defaultMessage:"Search types...",id:"database.viewSettings.propertyTypeSelect.newSearchPlaceholder"},searchToChangePlaceholder:{defaultMessage:"Search for property type",id:"database.viewSettings.propertyTypeSelect.searchToChangePlaceholder"},propertyNameInputPlaceholder:{defaultMessage:"Property name",id:"database.viewSettings.propertyTypeSelect.propertyNameInputPlaceholder"},suggestedSectionTitle:{defaultMessage:"Suggested",id:"database.viewSettings.propertyTypeSection.suggested"},loadingSuggestedSectionTitle:{defaultMessage:"Thinking...",id:"database.viewSettings.propertyTypeSection.loadingSuggested"},connectedRelationSectionTitle:{defaultMessage:"Connections",id:"database.viewSettings.propertyTypeSection.connected"},existingConnectedRelationSectionTitle:{defaultMessage:"{integrationName}",id:"database.viewSettings.propertyTypeSection.existingConnectedIntegrationTitle"},typesSectionTitle:{defaultMessage:"Type",id:"database.viewSettings.propertyTab.propertyType"},autofillSectionTitle:{defaultMessage:"AI autofill",id:"database.viewSettings.propertyTab.autofillProperties"},newProperty:{defaultMessage:"New property",id:"database.viewSettings.newProperty"},newPropertyWithDatabaseName:{defaultMessage:"New property on {databaseName}",id:"database.viewSettings.newPropertyOnDatabase"},changePropertyType:{defaultMessage:"Change property type",id:"database.viewSettings.changePropertyType"},selectToAddNewProperty:{defaultMessage:"Select to add",id:"database.viewSettings.selectToAdd"},newPill:{defaultMessage:"New",id:"database.viewSettings.newHighlightedFeature"},duplicateGithubPropertyTooltip:{defaultMessage:"A database can only have one GitHub Pull Requests property",id:"database.viewSettings.propertyTab.duplicateGithubProperty.tooltip"},wikiGithubPropertyTooltip:{defaultMessage:"A wiki cannot have a GitHub Pull Requests property",id:"database.viewSettings.propertyTab.wikiGithubProperty.tooltip"},syncedDatabaseGithubPropertyTooltip:{defaultMessage:"A synced database cannot have a GitHub Pull Requests property",id:"database.viewSettings.propertyTab.syncedDatabaseGithubProperty.tooltip"},nonMeetingsCronPropertyTooltip:{defaultMessage:"The Cron Calendar property can only be added to a Meetings database",id:"database.viewSettings.propertyTab.nonMeetingsCronProperty.tooltip"},duplicateCronEventPropertyTooltip:{defaultMessage:"A database can only have one Cron Calendar event property",id:"database.viewSettings.propertyTab.duplicateCronEventProperty.tooltip"},upgradeRequired:{defaultMessage:"Please upgrade to use this property",id:"database.viewSettings.propertyTab.upgradeRequired"},selectType:{defaultMessage:"Select type",id:"database.viewSettings.propertyTabGrid.selectType"}}),st=(0,C().YK)({text:{defaultMessage:"Add text that can be formatted. Great for summaries, notes, or descriptions.",id:"database.viewSettings.propertyTab.textProperty.tooltip"},number:{defaultMessage:"Accepts numbers. These can also be formatted as currency or progress bars. Useful for tracking counts, prices, and completion.",id:"database.viewSettings.propertyTab.numberProperty.tooltip"},select:{defaultMessage:"Select one option from a list of tags. Useful for categorization.",id:"database.viewSettings.propertyTab.selectProperty.tooltip"},multi_select:{defaultMessage:"Select one or more options from a list of tags. Useful for tagging items across multiple categories.",id:"database.viewSettings.propertyTab.multiSelectProperty.tooltip"},date:{defaultMessage:"Accepts a date or a date range (time optional). Useful for deadlines, especially with calendar and timeline views.",id:"database.viewSettings.propertyTab.dateProperty.tooltip"},formula:{defaultMessage:"Perform calculations based on other properties using Notion’s formula language.",id:"database.viewSettings.propertyTab.formulaProperty.tooltip"},relation:{defaultMessage:"Connect databases and mention database pages. Useful for connecting items across your workspace.",id:"database.viewSettings.propertyTab.relationProperty.tooltip"},rollup:{defaultMessage:"View and aggregate information about properties from relation properties. Useful for summarizing interconnected data.",id:"database.viewSettings.propertyTab.rollupProperty.tooltip"},person:{defaultMessage:"Tag anyone in your Notion workspace. Useful for assigning tasks or referencing relevant team members.",id:"database.viewSettings.propertyTab.personProperty.tooltip"},file:{defaultMessage:"Upload files and images for easy retrieval. Useful for storing documents and photos.",id:"database.viewSettings.propertyTab.filesProperty.tooltip"},checkbox:{defaultMessage:"Use a checkbox to indicate whether a condition is true or false. Useful for lightweight task tracking.",id:"database.viewSettings.propertyTab.checkboxProperty.tooltip"},url:{defaultMessage:"Accepts a link to a website and opens the link in a new tab when clicked.",id:"database.viewSettings.propertyTab.urlProperty.tooltip"},email:{defaultMessage:"Accepts an email address and launches your mail client when clicked.",id:"database.viewSettings.propertyTab.emailProperty.tooltip"},phone_number:{defaultMessage:"Accepts a phone number and prompts your device to call it when clicked.",id:"database.viewSettings.propertyTab.phoneNumberProperty.tooltip"},created_time:{defaultMessage:"Records the timestamp of an item’s creation. Auto-generated and not editable.",id:"database.viewSettings.propertyTab.createdTimeProperty.tooltip"},created_by:{defaultMessage:"Automatically records the person who created the item. Auto-generated and not editable.",id:"database.viewSettings.propertyTab.createdByProperty.tooltip"},last_edited_time:{defaultMessage:"Records the timestamp of an item’s last edit. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastEditedTimeProperty.tooltip"},last_edited_by:{defaultMessage:"Records the person who edited the item last. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastEditedByProperty.tooltip"},auto_increment_id:{defaultMessage:"Automatically creates a numerical ID for each item. IDs are unique and cannot be manually changed.",id:"database.viewSettings.propertyTab.uniqueIdProperty.tooltip"},status:{defaultMessage:"Track this item’s progress using status tags categorized by To-do, In progress, and Complete.",id:"database.viewSettings.propertyTab.statusProperty.tooltip"},verification:{defaultMessage:"Indicate whether a page has been verified by the page owner, with the option to set an expiration date.",id:"database.viewSettings.propertyTab.verificationProperty.tooltip"},button:{defaultMessage:"Trigger actions based on the item properties.",id:"database.viewSettings.propertyTab.buttonProperty.tooltip"},ai_summary:{defaultMessage:"Text property with AI summary set up for you. Generates a summary based on page content and properties.",id:"database.viewSettings.propertyTab.aiSummaryProperty.tooltip"},ai_translate:{defaultMessage:"Text property with AI translate set up for you. Translate a property to another language using AI. ",id:"database.viewSettings.propertyTab.aiTranslateProperty.tooltip"},ai_category:{defaultMessage:"Select property that automatically adds tags based on the page content and properties.",id:"database.viewSettings.propertyTab.aiCategoryProperty.tooltip"},ai_keywords:{defaultMessage:"Multi-select property that automatically adds tags based on the page content and properties.",id:"database.viewSettings.propertyTab.aiKeywordsProperty.tooltip"},ai_custom_prompt:{defaultMessage:"Text property with a custom AI prompt. Generate content based on the page content and properties.",id:"database.viewSettings.propertyTab.aiCustomPromptProperty.tooltip"},ai_extract:{defaultMessage:"Text property with a custom AI prompt. Extract key info based on the page content and properties.",id:"database.viewSettings.propertyTab.aiExtractProperty.tooltip"},title:{defaultMessage:"Add a title for your database item. This determines the page’s title.",id:"database.viewSettings.propertyTab.titleProperty.tooltip"},location:{defaultMessage:"Display the location of which database this item belongs to.",id:"database.viewSettings.propertyTab.locationProperty.tooltip"},last_visited_time:{defaultMessage:"Records the timestamp of the last time you visited this page. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastVisitedTimeProperty.tooltip"},place:{defaultMessage:"Display a physical location on a map.",id:"database.viewSettings.propertyTab.placeProperty.tooltip"}});function ct({environment:e,collectionContextStore:t,appConfig:o}){const n=(0,c().K8)((()=>{const o=t.collectionStore();return Boolean(o&&(0,ie().jq)(we().A.getMode(e,o),o))}),[e,t]),i=(0,c().K8)((()=>{var e,i;if(!n)return!1;if(void 0!==o)return!1;if(null===(e=t.collectionStore())||void 0===e||!e.getName())return!1;const r=null===(i=t.collectionStore())||void 0===i?void 0:i.getSchema();return!(r&&(0,M().uv)(r).length>S().Hm)&&(0,ie().QV)()}),[n,o,t]);return{hasAiEnabled:n,showAiSuggestions:i}}},960127:(e,t,o)=>{o.r(t),o.d(t,{WorkflowSettingsConfirmAddTemplate:()=>k,isWorkflowTemplateWithConfirmStep:()=>M});o(16280);var n=o(296540),i=()=>o(564884),r=()=>o(484714),a=()=>o(401497),l=()=>o(160432),s=()=>o(663077),c=()=>o(69708),p=()=>o(496603),d=()=>o(231297),u=()=>o(147503),m=()=>o(735695),y=()=>o(35091),g=()=>o(908201),f=()=>o(678553),S=()=>o(89924),h=()=>o(101926),b=()=>o(513349),v=()=>o(913454),w=(o(581454),()=>o(784892)),T=()=>o(399762),x=o(474848);function I({template:e,style:t}){const o=(0,a().IS)((e=>({container:{...t,padding:12,border:`1px solid ${e.regularDividerColor}`,borderRadius:6}})),[t]),n=function(e){if((0,s().Xq)(e,"property")&&(0,s().Io)(e)){const{options:t=[]}=e.value;if(0===t.length)return;return(0,x.jsx)(_,{options:t})}}(e);return n?(0,x.jsx)("div",{style:o.container,children:n}):null}function _({options:e}){const t=(0,a().IS)((()=>({container:{display:"flex",flexDirection:"column",gap:8}})),[]);return(0,x.jsx)("div",{style:t.container,children:e.map((e=>(0,x.jsx)("div",{children:(0,x.jsx)(T().O,{format:w().NY.Medium,isSingle:!0,value:e.value,color:e.color,showRemoveButton:!1})},e.id)))})}var A=()=>o(902842);function k({template:e,collectionSettingsStore:t}){const[o,i]=(0,n.useState)("sample"===e.propertyOptionsType),{device:{isMobile:l}}=(0,r().v3)(),s=(0,a().IS)((e=>{const t={display:"flex",flexDirection:"column",minHeight:0};return{shrinkableHeight:t,noShrink:{flexShrink:0},featurePreviewWrapper:{...t,width:"-webkit-fill-available"},featurePreviewBody:{...t,gap:16,...l?{margin:"16px 0"}:{margin:0}},featurePreview:{...t,overflow:"auto"},addButtonContainer:{...l?{margin:"12px 0"}:{marginBottom:6}}}}),[l]),p=(0,v().getWorkflowTemplateName)(e);return(0,x.jsxs)(m().Ay,{collectionSettingsStore:t,title:(0,x.jsx)(c().sA,{id:"workflowTemplateSettings.confirmAddTemplate.title",defaultMessage:"Turn on {templateName}",values:{templateName:p}}),disableScroller:!0,menuScrollerStyle:s.shrinkableHeight,innerContentWrapperStyle:s.shrinkableHeight,children:[(0,x.jsx)(S().A,{style:s.shrinkableHeight,children:(0,x.jsx)(f().Ay,{style:s.shrinkableHeight,textWrapperStyle:s.featurePreviewWrapper,bodyStyle:s.featurePreviewBody,body:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(C,{template:e,style:s.noShrink}),(0,x.jsx)(I,{template:e,style:s.featurePreview})]})})}),(0,x.jsx)(S().A,{style:s.noShrink,children:e.value.options&&e.value.options.length>0?(0,x.jsx)(y().A,{title:(0,x.jsx)(c().sA,{id:"workflowTemplateSettings.confirmAddTemplate.propertyOptionsToggle",defaultMessage:"Set my own options"}),switcherProps:{on:o,disallowTabbing:!0},onClick:()=>{i(!o)}}):void 0}),(0,x.jsx)(S().A,{style:s.noShrink,children:(0,x.jsx)(f().Ay,{body:(0,x.jsx)(P,{template:e,startEmpty:o}),bodyStyle:s.addButtonContainer})})]})}function C({template:e,style:t}){const o=(0,r().Y0)(),n=(0,a().IS)((()=>({container:{...t,display:"flex",alignItems:"center",gap:12},textWrapper:{lineHeight:o.isMobile?"20px":"18px"},title:{fontSize:o.isMobile?16:13},caption:{fontSize:o.isMobile?14:12,overflow:"hidden",color:"gray",whiteSpace:"nowrap",textOverflow:"ellipsis"}})),[o,t]),i=(0,v().getWorkflowTemplateName)(e),l=(0,s().Uy)(e);return(0,x.jsxs)("div",{style:n.container,children:[(0,x.jsx)(A().n,{template:e,backgroundSize:32}),(0,x.jsxs)("div",{style:n.textWrapper,children:[(0,x.jsx)("div",{style:n.title,children:i}),l?(0,x.jsx)("div",{style:n.caption,children:l}):void 0]})]})}function P({template:e,startEmpty:t}){const o=(0,a().IS)((()=>({button:{width:"100%"}})),[]),n=(0,r().v3)(),s=(0,g().ET)(),m=(0,v().getWorkflowTemplateName)(e),y=p().mg(e);return t&&delete y.value.options,(0,x.jsx)(l().A,{colorPalette:"blue",style:o.button,size:"lg",onClick:()=>{d().createAndCommit({userAction:"WorkflowSettingsConfirmAddTemplate.addFeatureTemplateToTarget",environment:n,canUndo:!0,perform:t=>{const o=s.collectionStore();if(!o)throw new Error("collectionStore not found");h().ai({environment:n,transaction:t,collectionStore:o,template:y,logger:new(v().WorkflowTemplateLogger),origin:"suggested_feature"});const r=s.settingsStore;u().yl({collectionSettingsStore:r});const a=o.getWorkflowTemplateId();(0,i().u)({environment:n,event:{eventName:"suggested_feature_template_added",eventProperties:{origin:"suggested_properties",template_id_added:e.templateId,collection_template_id:a}}});const l=s.collectionViewStore();l&&(0,b().UD)({template:e,environment:n,collectionStore:o,collectionViewStore:l,collectionSettingsStore:r,collectionContextStore:s})}})},children:(0,x.jsx)(c().sA,{id:"workflowTemplateSettings.confirmAddTemplate.button",defaultMessage:"Add {templateName}",values:{templateName:m}})})}function M(e){return"property"===e.type&&("select"===e.value.type||"multi_select"===e.value.type)}}}]);