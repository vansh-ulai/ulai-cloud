"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[16448],{179030:(e,t,o)=>{o.d(t,{l:()=>i().l});var i=()=>o(661764)},259476:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>n,trashSmallIcon:()=>r});o(296540);var i=o(474848);const n={viewBox:"0 0 16 16",fittedViewBox:"2.5 2.12 11 11.75",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M6.688 6.3a.575.575 0 0 0-.575.575v4.5a.575.575 0 1 0 1.15 0v-4.5a.575.575 0 0 0-.575-.575m2.625 0a.575.575 0 0 0-.575.575v4.5a.575.575 0 1 0 1.15 0v-4.5a.575.575 0 0 0-.575-.575"}),(0,i.jsx)("path",{d:"M6.625 2.125a1.5 1.5 0 0 0-1.5 1.5v.75h-2a.625.625 0 1 0 0 1.25h.528l.29 6.4c.048 1.035.9 1.85 1.936 1.85h4.242a1.937 1.937 0 0 0 1.935-1.85l.291-6.4h.528a.625.625 0 1 0 0-1.25h-2v-.75a1.5 1.5 0 0 0-1.5-1.5zm-.25 1.5a.25.25 0 0 1 .25-.25h2.75a.25.25 0 0 1 .25.25v.75h-3.25zm-1.183 8.344-.288-6.344h6.192l-.289 6.344a.687.687 0 0 1-.686.656H5.879a.687.687 0 0 1-.687-.656"})]})},r=(0,o(340498).wt)("trashSmall",n)},272200:(e,t,o)=>{o.r(t),o.d(t,{trackAIAction:()=>l,trackAIAssistantEngineError:()=>m,trackAICompletionPopupClose:()=>f,trackAICompletionPopupOpen:()=>p,trackAIFavoriteAction:()=>c,trackAiAutofillAction:()=>d,trackAiAutofillSettingsAction:()=>u,trackUserFlow:()=>s});var i=()=>o(314529),n=()=>o(242422),r=()=>o(650829),a=()=>o(430483);function l(e,t){const{user_comment:o,...n}=t;(0,i().DO_NOT_USE_trackLegacy)(e,"ai_action",n)}function s(e,t,o){const n={site:"client",...o};(0,i().DO_NOT_USE_trackLegacy)(e,t,n)}function c(e,t){(0,i().DO_NOT_USE_trackLegacy)(e,"ai_favorite_action",t)}function d(e,t){(0,i().DO_NOT_USE_trackLegacy)(e,"ai_autofill_action",t),n().default.logEvent("ai_autofill_action",1,{action_type:t.type})}function u(e,t){(0,i().DO_NOT_USE_trackLegacy)(e,"ai_autofill_settings_action",t)}function p(e,t){if(a().zD.isXMLAssistantEnabled()){var o;const i=(null===(o=t.sessionContext)||void 0===o?void 0:o.evaluator.getTranscript())??[];r().assistantDependency.load().then((({assistantAnalyticsActions:o})=>{o.trackAssistantOpened(e,{from:t.from,sessionId:t.session_id,isReminder:!1,reminderType:void 0,startTimestamp:Date.now(),transcript:i,hasQuery:!1,searchSessionId:void 0})}))}else(0,i().DO_NOT_USE_trackLegacy)(e,"ai_completion_popup_open",{session_id:t.session_id,prompt_key:t.prompt_key,from:t.from})}function f(e,t){(0,i().DO_NOT_USE_trackLegacy)(e,"ai_completion_popup_close",t),n().default.logEvent("ai_completion_popup_close",1,{exit_type:t.exit_type})}function m(e,t){(0,i().DO_NOT_USE_trackLegacy)(e,"ai_assistant_error",t)}},312540:(e,t,o)=>{o.r(t),o.d(t,{autofillPropertyForBlocks:()=>$,autofillPropertyForCollection:()=>G,fillAllPagesMessages:()=>z,getDefaultAiInference:()=>ne,saveOrRemovePropertyAiInference:()=>ie,triggerAiAutofillUpsell:()=>J});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(672577),o(803949),o(581454);var i=o(296540),n=()=>o(564884),r=()=>o(242422),a=()=>o(221844),l=()=>o(898244),s=()=>o(713998),c=()=>o(206267),d=()=>o(134025),u=()=>o(69708),p=()=>o(532659),f=()=>o(973647),m=()=>o(534177);const g=(0,o(583835).Dv)("fillAutofillPropertiesInViewTask");var A=()=>o(299709),y=()=>o(559506),h=()=>o(884107),_=()=>o(583289),v=()=>o(901389),S=()=>o(357625),M=()=>o(471995),k=()=>o(319975),I=()=>o(231297),C=()=>o(831566),T=()=>o(396896),w=()=>o(272200),x=()=>o(289190),P=()=>o(104012),b=o(474848);const R=function({environment:e,inferenceIds:t,aiInference:n}){const r=(0,o(56366).K8)((()=>{const{state:e}=x().m;return"uninitialized"===e.type?null:{numBlocksToAutofill:e.numBlocksToAutofill,numBlocksAutofilled:e.numBlocksAutofilled,propertySchema:e.propertySchema,collectionId:e.collectionId,sessionId:e.sessionId,haveAllBlocksCompletedAutofill:e.haveAllBlocksCompletedAutofill}}),[]),a=(0,i.useCallback)((()=>{r&&(t.forEach((t=>{w().trackAiAutofillAction(e,{ai_inference_type:n.type,type:"undo_from_snackbar",inference_id:t,collection_id:r.collectionId,session_id:r.sessionId})})),o(495262).tN({environment:e,preventSelectText:!0}),M().N2(),x().m.setState({type:"filling",...r,didInterruptStreaming:!0}))}),[r,e,n,t]);if(!r)return null;const{numBlocksToAutofill:l,numBlocksAutofilled:s,propertySchema:{name:c}}=r;return s===l?(0,b.jsxs)(T().fI,{gap:4,alignItems:"center",children:[(0,o(413267).b)({width:16}),(0,b.jsx)(u().sA,{defaultMessage:"AI updated “{propertyName}” on {numPages, plural, one {1 page} other {# pages}}",id:"snackbar.aiAutofill.autofillInProgress",values:{propertyName:c,numPages:l}}),(0,b.jsx)(P().Ag,{onClick:a,children:(0,b.jsx)(u().sA,{defaultMessage:"Undo",id:"snackbar.aiAutofill.undo"})}),(0,b.jsx)(P().Ag,{onClick:()=>{M().N2()},children:(0,b.jsx)(u().sA,{defaultMessage:"Close",id:"snackbar.aiAutofill.close"})})]}):(0,b.jsxs)(T().fI,{gap:4,alignItems:"center",children:[(0,b.jsx)(o(98126).k,{}),0===s?(0,b.jsx)(u().sA,{defaultMessage:"AI updating “{propertyName}” on {numPages, plural, one {1 page} other {# pages}}",id:"snackbar.aiAutofill.autofillStarting",values:{propertyName:c,numPages:l}}):(0,b.jsx)(u().sA,{defaultMessage:"AI updated “{propertyName}” on {numFilledPages} of {numTotalPages} pages",id:"snackbar.aiAutofill.completedAutofill",values:{propertyName:c,numFilledPages:s,numTotalPages:l}}),(0,b.jsx)(P().Ag,{onClick:a,children:(0,b.jsx)(u().sA,{defaultMessage:"Stop & undo",id:"snackbar.aiAutofill.undoAndStop"})})]})};var O=()=>o(659602),F=()=>o(335722),U=()=>o(972435),E=()=>o(71304),L=()=>o(765957),N=()=>o(878710),W=()=>o(666429),j=()=>o(991249),D=()=>o(329304),B=()=>o(108184);const z=(0,u().YK)({fillAllPagesTooltip:{defaultMessage:"Autofill all pages in this view",id:"aiAutofill.fillAllPages.buttonTooltip"},fillAllPagesAddOnMessage:{defaultMessage:"Only with Notion AI add-on",id:"aiAutofill.fillAllPages.onlyWithAiAddOnMessageInTooltip"},fillAllPagesAddAiMessage:{defaultMessage:"Only with upgraded Notion AI",id:"aiAutofill.fillAllPages.onlyWithAiBusinessMessageInTooltip"}});function V(e){const{environment:t,propertyId:o,propertySchema:i,storesWithCompletions:n,useTemporaryStore:r,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:l,clipboardActions:s,doneStreaming:c,aiInferenceOverride:d}=e;I().createAndCommit({userAction:"BlockPropertyValue.handleActionButtonClick.aiAutofill",environment:t,canUndo:!Boolean(r),undoCheckpoint:!0,perform:e=>{K({environment:t,propertyId:o,propertySchema:i,storesWithCompletions:n,useTemporaryStore:r,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:l,clipboardActions:s,doneStreaming:c,aiInferenceOverride:d,transaction:e})}})}function K(e){var t;const{environment:o,propertyId:i,propertySchema:n,storesWithCompletions:r,useTemporaryStore:a,markdownLinkifyIt:c,tinyMceMicrosoftWordPasteFilter:d,clipboardActions:u,doneStreaming:p,aiInferenceOverride:f,transaction:g}=e;for(const{store:A,temporaryStore:y,completion:h}of r){const e=a?y:A;let r;switch(n.type){case"text":r=u.getInlineTitleValueFromClipboardTextHtml({text:h.trim(),stripText:!1,stripSurroundingWhitespace:!0,markdownLinkifyIt:c,tinyMceMicrosoftWordPasteFilter:d});break;case"multi_select":case"select":const e=a?null===(t=A.getAssociatedCollectionStore())||void 0===t?void 0:t.clone(y.inMemoryRecordCache):A.getAssociatedCollectionStore(),o=(null==e?void 0:e.getSchema()[i])||n,_=f??n.select_ai_inference;let v=h.trim().split(",").map((e=>e.trim()));if(p||(v=v.slice(0,-1)),v.length>0&&"select"===n.type&&(v=v.slice(0,1)),e&&null!=_&&_.add_options){const t=(0,l().nP)({newTokenValues:[v],property:i,propertySchema:o,collectionId:e.id});if(t)for(const o of t)I().applyOperation({store:e,operation:o,transaction:g})}null!=_&&_.add_options||(v=v.filter((e=>{var t;return null===(t=n.options)||void 0===t?void 0:t.find((t=>t.value===e))}))),r=(0,s().rK)(v);break;default:(0,m().HB)(n)}k().R9({environment:o,store:e.getPropertyStore(i),value:r,transaction:g})}}const q=(0,u().YK)({FAILED_TO_AUTOFILL:{defaultMessage:"Something went wrong. Please try again later",id:"propertyCompletionActions.propertyCompletionActions.error.unableToAutofill"},INVALID_PROPERTY_FOR_AUTOFILL:{defaultMessage:"Invalid property configuration for AI autofill",id:"propertyCompletionActions.propertyCompletionActions.error.invalidPropertyForAutofill"},NO_BLOCKS_TO_AUTOFILL:{defaultMessage:"Nothing to update with AI",id:"propertyCompletionActions.propertyCompletionActions.error.noBlocksToAutofill"}}),H=(0,u().YK)({featureUnavailable:{id:"completionActions.featureNotEnabledError",defaultMessage:"This feature is not currently enabled"}});function Q({autofillPropertyResult:e}){const t=U().A.formatMessage(q[e]);M().N2(),v().c1(t)}const Y={ai_limit_property_autofill:(0,b.jsx)(u().sA,{defaultMessage:"This workspace has used all of its free AI responses. Contact your workspace owner to upgrade Notion AI.",id:"aiAutofill.outOfAiBusinessUpsellDialogMessage"}),ai_autofill_try_on_view:(0,b.jsx)(u().sA,{defaultMessage:"This workspace has used all of its free AI responses. Contact your workspace owner to upgrade Notion AI.",id:"aiAutofill.outOfAiUpgradedUpsellDialogMessage"}),ai_autofill_on_page_edit:(0,b.jsx)(u().sA,{defaultMessage:"Auto-update requires upgraded Notion AI. Contact your workspace owner to upgrade Notion AI.",id:"aiAutofill.autoUpdateOnPageEditAiUpgradedUpsellDialogMessage"}),ai_autofill_fill_all_pages:(0,b.jsx)(u().sA,{defaultMessage:"Updating all pages requires upgraded Notion AI. Contact your workspace owner to upgrade Notion AI.",id:"aiAutofill.fillAllPagesAiUpgradedUpsellDialogMessage"}),ai_autofill_bulk_fill:(0,b.jsx)(u().sA,{defaultMessage:"Filling more pages at once requires upgraded Notion AI. Contact your workspace owner to upgrade Notion AI.",id:"aiAutofill.bulkFillAiUpgradedUpsellDialogMessage"})};function J({environment:e,from:t,upsell:o}){var i;null!==(i=L().default.state.sidebarSpaceStore)&&void 0!==i&&i.canAdmin()||v().c1(Y[t]),j().K(e,{from:t,upsell:o})}function X({errorCode:e,environment:t,autofillAvailability:o}){return 405===e?M().D6({label:U().A.formatMessage(H.featureUnavailable)}):(402===e&&o.upsell&&(M().N2(),J({environment:t,from:"ai_limit_property_autofill",upsell:o.upsell})),B().showCompletionErrorWithCode(e))}async function $({environment:e,stores:t,property:o,propertySchema:i,userEventForAnalytics:n,sessionIdForAnalytics:r,collectionContextStore:s,from:d,isBulkAction:u,aiInferenceOverride:f,transaction:g}){var _,v;const S=r||c().JW(),k=o,I=t.map((e=>({spaceId:e.getSpaceId(),...e.pointer,propertyId:k,inferenceId:c().JW()}))),C=t[0].getAssociatedCollectionId()??(null==s||null===(_=s.collectionStore())||void 0===_?void 0:_.id)??(null===(v=t[0].getCollectionStoreIfSingleSource())||void 0===v?void 0:v.id),T=new(a().A)({name:"propertyCompletionActions.autofillPropertyForBlocks"});if(x().m.setIsWriting({stores:t,propertySchema:i,sessionIdForAnalytics:r,collectionId:C}),"uninitialized"!==x().m.state.type&&(0,l().$M)(i)&&C){M().D6({label:(0,b.jsx)(R,{environment:e,inferenceIds:I.map((e=>e.inferenceId)),aiInference:(0,l().om)(i)}),durationMs:W().LX});try{var P,U,E;if(e.defaultRecordCache.inMemoryRecordCache.addCacheOverride(T),!(0,m().EI)(I))return Q({autofillPropertyResult:"NO_BLOCKS_TO_AUTOFILL"});const o=f||(0,l().om)(i);if(!o)return Q({autofillPropertyResult:"INVALID_PROPERTY_FOR_AUTOFILL"});I.forEach((t=>{w().trackAiAutofillAction(e,{type:n,inference_id:t.inferenceId,ai_inference_type:o.type,collection_id:C,session_id:S})})),null!==(P=L().default.state.sidebarSpaceStore)&&void 0!==P&&P.id&&y().callApi({eventName:"publishAiSession",environment:e,data:{inference_type:"autofill",id:S,spaceId:L().default.state.sidebarSpaceStore.id,metadata:{blockPropertyPointers:I,aiInference:o,collection_id:C}}});const r=await(0,D().Bw)(e,{name:"collection_property_autofill",spaceId:null===(U=L().default.state.sidebarSpaceStore)||void 0===U?void 0:U.id,userId:null===(E=L().default.state.currentUserStore)||void 0===E?void 0:E.id,amount:"unknown"}),a=await y().callStreamApi({eventName:"getCompletionForProperty",environment:e,data:{blockPropertyPointers:I,aiInference:o,aiSessionId:S,model:"default"}});if("success"!==a.type)return Q({autofillPropertyResult:"FAILED_TO_AUTOFILL"});s&&(0,A().E)({block_id:t[0].pointer.id,property:k,property_type:i.type,from:d,environment:e,collectionContextStore:s,isFromBulkActionsToolbar:u});const c=Object.fromEntries(t.map((e=>[e.pointer.id,{store:e,temporaryStore:e.clone(T),completion:""}]))),_=new Set,[v,M,b]=await Promise.all([O().g.load(),F().S.load(),h().R.clipboardActions.load()]);if(p().hS.is(a.data)){for await(const t of a.data){if("error"===t.type)return x().m.setState({...x().m.state,didInterruptStreaming:!0}),X({errorCode:t.errorCode,environment:e,autofillAvailability:r});if(x().m.state.didInterruptStreaming)return;const o=c[t.blockPropertyPointer.id],n=o.completion+t.completion;c[t.blockPropertyPointer.id]={...o,completion:n},_.add(t.blockPropertyPointer.id),g?K({environment:e,propertyId:k,propertySchema:i,storesWithCompletions:Object.values(c),useTemporaryStore:!0,markdownLinkifyIt:v,tinyMceMicrosoftWordPasteFilter:M,clipboardActions:b,doneStreaming:!0,aiInferenceOverride:f,transaction:g}):V({environment:e,propertyId:k,propertySchema:i,storesWithCompletions:Object.values(c),useTemporaryStore:!0,markdownLinkifyIt:v,tinyMceMicrosoftWordPasteFilter:M,clipboardActions:b,aiInferenceOverride:f}),x().m.setState({...x().m.state,numBlocksAutofilled:_.size})}x().m.setState({...x().m.state,haveAllBlocksCompletedAutofill:!0})}e.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(T),g?K({environment:e,propertyId:k,propertySchema:i,storesWithCompletions:Object.values(c),useTemporaryStore:!1,markdownLinkifyIt:v,tinyMceMicrosoftWordPasteFilter:M,clipboardActions:b,doneStreaming:!0,aiInferenceOverride:f,transaction:g}):V({environment:e,propertyId:k,propertySchema:i,storesWithCompletions:Object.values(c),useTemporaryStore:!1,markdownLinkifyIt:v,tinyMceMicrosoftWordPasteFilter:M,clipboardActions:b,doneStreaming:!0,aiInferenceOverride:f})}finally{e.defaultRecordCache.inMemoryRecordCache.hasCacheOverride(T)&&e.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(T)}}}async function G(e){const t=r().default.checkGate({gateName:"autofill_all_pages_use_new_endpoint"})?te:oe;return await t(e)}const Z=(0,u().YK)({invalidCollectionSource:{id:"propertyCompletionActions.error.invalidCollectionSource",defaultMessage:"There was a problem with the database."},noMemcachedRecord:{id:"propertyCompletionActions.error.noMemcachedRecord",defaultMessage:"Something went wrong. Please try again."},lockAlreadyTaken:{id:"propertyCompletionActions.error.lockAlreadyTaken",defaultMessage:"A fill is already in progress"},invalidUser:{id:"propertyCompletionActions.error.invalidUser",defaultMessage:"The provided user information is not valid."},invalidCollectionView:{id:"propertyCompletionActions.error.invalidCollectionView",defaultMessage:"We encountered an issue accessing the collection view."},invalidCollection:{id:"propertyCompletionActions.error.invalidCollection",defaultMessage:"The collection you are trying to access is not valid."},noLoadedUser:{id:"propertyCompletionActions.error.noLoadedUser",defaultMessage:"User information is missing."},noUserTimeZone:{id:"propertyCompletionActions.error.noUserTimeZone",defaultMessage:"User time zone information is not available."},unauthorizedCollectionAccess:{id:"propertyCompletionActions.error.unauthorizedCollectionAccess",defaultMessage:"Insufficient permissions"},unableToQueryCollection:{id:"propertyCompletionActions.error.unableToQueryCollection",defaultMessage:"We couldn’t retrieve the collection details at this time."},invalidPropertyForAutofill:{id:"propertyCompletionActions.error.invalidPropertyForAutofill",defaultMessage:"The property provided for autofill is not valid."},NoResults:{id:"propertyCompletionActions.error.noResults",defaultMessage:"No results were found. Please try again."},somethingWentWrong:{id:"propertyCompletionActions.error.somethingWentWrong",defaultMessage:"Something went wrong. Please try again later."}});function ee(e){switch(e){case"invalidCollectionSource":return(0,b.jsx)(u().sA,{...Z.invalidCollectionSource});case"noMemcachedRecord":return(0,b.jsx)(u().sA,{...Z.noMemcachedRecord});case"lockAlreadyTaken":return(0,b.jsx)(u().sA,{...Z.lockAlreadyTaken});case"invalidUser":return(0,b.jsx)(u().sA,{...Z.invalidUser});case"invalidCollectionView":return(0,b.jsx)(u().sA,{...Z.invalidCollectionView});case"invalidCollection":return(0,b.jsx)(u().sA,{...Z.invalidCollection});case"noLoadedUser":return(0,b.jsx)(u().sA,{...Z.noLoadedUser});case"noUserTimeZone":return(0,b.jsx)(u().sA,{...Z.noUserTimeZone});case"unauthorizedCollectionAccess":return(0,b.jsx)(u().sA,{...Z.unauthorizedCollectionAccess});case"unableToQueryCollection":return(0,b.jsx)(u().sA,{...Z.unableToQueryCollection});case"invalidPropertyForAutofill":return(0,b.jsx)(u().sA,{...Z.invalidPropertyForAutofill});case"NoResults":return(0,b.jsx)(u().sA,{...Z.NoResults});case"somethingWentWrong":return(0,b.jsx)(u().sA,{...Z.somethingWentWrong});default:return(0,b.jsx)(u().sA,{defaultMessage:"An unexpected error occurred. Please try again.",id:"propertyCompletionActions.error.unknown"})}}async function te(e){var t,o;const{environment:i,collectionStore:r,propertySchema:a,property:s,collectionViewStore:c}=e;if(!(0,l().$M)(a))return;const d=(0,l().om)(a);if(!r||!a||!d)return;const u=null===(t=L().default.state.sidebarSpaceStore)||void 0===t?void 0:t.id;if(!u)return;if(!(null===(o=L().default.state.currentUserStore)||void 0===o?void 0:o.id))return;const p=U().A.getIntl(),m=(0,E().tS)({environment:i,intl:p,store:r});if(!(await _().U({sourceAction:"fill_all_pages",propertyName:a.name,collectionName:m})))return;(0,n().u)({environment:i,event:{eventName:"generate_from_fill_all_pages_in_view",eventProperties:{collection_id:r.id,ai_inference_type:d.type}}});const A=(0,S().UT)(i,g,{spaceId:u,collectionSource:{id:r.id,type:"collection",spaceId:u},collectionViewPointer:c.pointer,propertyId:s},{spaceIds:[]});for await(const n of A){var y;if(f().Q.isFail(n)||"failure"===n.taskStatus)return void M().D6({label:ee("somethingWentWrong")});if("error"===(null===(y=n.value)||void 0===y?void 0:y.status)){const e=n.value.errorType;return void M().D6({label:ee(e)})}}}async function oe({environment:e,collectionStore:t,propertySchema:o,property:i,sessionIdForAnalytics:n}){var r;if(!(0,l().$M)(o))return;const a=(0,l().om)(o);if(!t||!o||!a)return;const s=await(0,D().Bw)(e,{name:"collection_property_autofill",spaceId:t.getSpaceId(),userId:null===(r=L().default.state.currentUserStore)||void 0===r?void 0:r.id,amount:"unknown"});if(!(0,D().e2)(s))return void J({environment:e,from:"ai_autofill_fill_all_pages",upsell:s.upsell});const u=U().A.getIntl(),p=(0,E().tS)({environment:e,intl:u,store:t});if(!(await _().U({sourceAction:"fill_all_pages",propertyName:o.name,collectionName:p})))return;w().trackAiAutofillAction(e,{type:"generate_from_fill_all_pages",inference_id:c().JW(),ai_inference_type:a.type,collection_id:t.id,session_id:n??c().JW()});const f=[];f.push(d().op.update({pointer:t.pointer,path:["format","update_ai_inferences_status"],args:{[i]:{type:"requested",created_time:Date.now()}}})),(0,C().p)({environment:e,collectionStore:t,performTransaction:e=>{for(const o of f)I().applyOperation({store:(0,N().v3)(t,o.pointer),operation:o,transaction:e})}})}function ie(e){const{environment:t,propertySchema:o,collectionStore:i,property:n,draftAiInference:r}=e;let a="";switch(o.type){case"text":a="ai_inference";break;case"select":case"multi_select":a="select_ai_inference";break;default:return}const s=[];if(s.push({pointer:i.pointer,command:"set",path:["schema",n,a],args:r}),r)w().trackAiAutofillSettingsAction(t,{type:"set_ai_inference",ai_inference_type:r.type,collection_id:i.id});else{const e=(0,l().om)(o);w().trackAiAutofillSettingsAction(t,{type:"remove_ai_inference",ai_inference_type:null==e?void 0:e.type,collection_id:i.id})}(0,C().p)({environment:t,collectionStore:i,performTransaction:e=>{for(const t of s)I().applyOperation({store:(0,N().v3)(i,t.pointer),operation:t,transaction:e})}})}function ne(e,t){if(!(0,l().$M)(e))return;const o=(0,l().om)(e);return!o&&(0,l().lx)(e)?{type:e.type,auto_update_on_edit:t,add_options:!1}:o}},495159:(e,t,o)=>{o.d(t,{LB:()=>c,VT:()=>l,vr:()=>s});var i=()=>o(116089),n=()=>o(38337),r=()=>o(695625),a=()=>o(148832);const l=(0,o(69708).YK)({askAI:{defaultMessage:"Ask AI",id:"id.completions.askAI"},genericHelpMeWrite:{defaultMessage:"{filter}",id:"id.completions.genericHelpMeWrite"},summarize:{defaultMessage:"Summarize",id:"id.completions.summarize"},findActionItems:{defaultMessage:"Find action items",id:"id.completions.findActionItems"},autofillSummary:{defaultMessage:"Summary",id:"id.completions.autofillSummary"},autofillTranslate:{defaultMessage:"Translate",id:"id.completions.autofillTranslate"},autofillExtract:{defaultMessage:"Key info",id:"id.completions.autofillExtract"},autofillCustom:{defaultMessage:"Custom autofill",id:"id.completions.autofillCustom"}}),s={text:{summarize:{name:l.autofillSummary,svg:o(37719).P},translate:{name:l.autofillTranslate,svg:o(877235).textTranslateIcon},extract:{name:l.autofillExtract,svg:o(202017).n},custom:{name:l.autofillCustom,svg:i().x}},select:{select:{name:l.autofillCustom,svg:i().x}},multi_select:{select:{name:l.autofillCustom,svg:i().x}}};function c(e){const{origin:t}=e;return t instanceof a().B?function(e){let t=r().T.findNodeFromStore(e);if(t){if("table"===e.getType()){const e=t.querySelector(`.${n().rb2}.notion-table-block`);t=e??t}return t.getBoundingClientRect()}}(t):t instanceof HTMLElement?t.getBoundingClientRect():t}},583289:(e,t,o)=>{o.d(t,{U:()=>n});var i=()=>o(388182);async function n(e){return new Promise((t=>{i().A.setState({open:!0,onClose:()=>{i().A.setState({open:!1}),t(!1)},onConfirm:()=>{i().A.setState({open:!1}),t(!0)},...e})}))}},774952:(e,t,o)=>{o.d(t,{U:()=>p,c:()=>f});o(296540);var i=()=>o(401497),n=()=>o(69708),r=()=>o(284371),a=()=>o(135221),l=()=>o(176980),s=()=>o(781317),c=o(474848);const d=(0,n().YK)({brewing:{id:"AgentThinkingStep.brewing",defaultMessage:"Brewing"},pondering:{id:"AgentThinkingStep.pondering",defaultMessage:"Pondering"},crafting:{id:"AgentThinkingStep.crafting",defaultMessage:"Crafting"},processing:{id:"AgentThinkingStep.processing",defaultMessage:"Processing"},computing:{id:"AgentThinkingStep.computing",defaultMessage:"Computing"},generating:{id:"AgentThinkingStep.generating",defaultMessage:"Generating"},working:{id:"AgentThinkingStep.working",defaultMessage:"Working"},exploring:{id:"AgentThinkingStep.exploring",defaultMessage:"Exploring"},organizing:{id:"AgentThinkingStep.organizing",defaultMessage:"Organizing"},preparing:{id:"AgentThinkingStep.preparing",defaultMessage:"Preparing"},focusing:{id:"AgentThinkingStep.focusing",defaultMessage:"Focusing"},discovering:{id:"AgentThinkingStep.discovering",defaultMessage:"Discovering"},noodling:{id:"AgentThinkingStep.noodling",defaultMessage:"Noodling"},vibing:{id:"AgentThinkingStep.vibing",defaultMessage:"Vibing"},cooking:{id:"AgentThinkingStep.cooking",defaultMessage:"Cooking"}}),u=(0,o(534177).uv)(d);function p(e){if(void 0===e)return d.crafting;const t=function(e){let t=0;for(let o=0;o<e.length;o++)t=(t<<5)-t+e.charCodeAt(o),t&=t;return Math.abs(t)}(String(e)),o=t%u.length;return d[u[o]]}function f(e){const{styleKey:t,message:o=d.crafting,animationType:u="loading-dots"}=e,p=(0,i().IS)((e=>({messageContent:{fontSize:14,fontWeight:r().Wy.medium,color:e.text.secondary,display:"flex",alignItems:"center",gap:8,minWidth:0},messageWrapInner:{display:"flex",whiteSpace:"pre",alignItems:"center"},loadingDotsContainer:{width:24,height:24},scrollingSquiggleContainer:{opacity:.3}})),[]);return(0,c.jsxs)("div",{style:p.messageContent,children:["scrolling-squiggle"===u?(0,c.jsx)("div",{style:p.scrollingSquiggleContainer,children:(0,c.jsx)(s().J,{})}):"loading-dots"===u?(0,c.jsx)(a().A,{isTriColored:!0,styleParentContainer:p.loadingDotsContainer}):null,(0,c.jsx)("div",{style:p.messageWrapInner,children:(0,c.jsx)(l().N,{styleKey:t||"Body/Regular",animate:!0,colorVariant:"secondary",text:"string"==typeof o?o:(0,c.jsx)(n().sA,{...o})})})]})}},781317:(e,t,o)=>{o.d(t,{J:()=>s});var i=o(296540),n=()=>o(401497),r=()=>o(100622),a=o(474848);const l={width:24,height:16,tempo:18,minLoopSize:24,maxLoopSize:32,acceleration:.3,tailLength:72,strokeWidth:1.5,loopSpacing:1.3,modulationSpeed:.4,modulationPhaseOffset:2,tempoModulation:10,accelerationModulation:.12};function s(e){const{style:t,width:o=l.width,height:s=l.height,tempo:c=l.tempo,minLoopSize:d=l.minLoopSize,maxLoopSize:u=l.maxLoopSize,acceleration:p=l.acceleration,tailLength:f=l.tailLength,strokeWidth:m=l.strokeWidth,strokeColor:g,loopSpacing:A=l.loopSpacing,modulationSpeed:y=l.modulationSpeed,modulationPhaseOffset:h=l.modulationPhaseOffset,tempoModulation:_=l.tempoModulation,accelerationModulation:v=l.accelerationModulation}=e,S=(0,i.useRef)(null),M=(0,i.useRef)(),k=(0,i.useRef)(!0),I=(0,n().eP)(),C=(0,r().O4)({theme:I}),T=(0,i.useMemo)((()=>{const e=o,t=s,i=t/2,n=c,r=e/200*8*A,a=p,l=Math.min(d/100*t,.45*t),m=Math.min(u/100*t,.45*t);return{W:e,H:t,BASE_Y:i,FRAMES_PER_RAD:n,SUB_STEPS:3,DX_PER_RAD:r,ACC_FACTOR:a,MIN_R:l,MAX_R:m,R_BASE:(l+m)/2,R_VAR:(m-l)/2,R_FREQ1:.2,R_FREQ2:.1,TAIL_RADS:Math.max(3,f*Math.min(1,e/200)),PURGE_PAD_R:5,START_OFFSET:.95*e-m,D_THETA_PER_SECOND:Math.PI/n*60}}),[o,s,c,d,u,p,f,A]),w=(0,i.useMemo)((()=>({modulationSpeed:y,modulationPhaseOffset:h,tempoModulation:_,accelerationModulation:v})),[y,h,_,v]);return(0,i.useEffect)((()=>{const e=()=>{k.current=!document.hidden};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}}),[]),(0,i.useEffect)((()=>{const e=S.current;if(!e)return;const t=e.getContext("2d",{willReadFrequently:!1,alpha:!0,desynchronized:!0});if(!t)return;e.width=2*o,e.height=2*s,t.scale(2,2),t.imageSmoothingEnabled=!1;const{W:i,H:n,BASE_Y:r,SUB_STEPS:a,DX_PER_RAD:l,ACC_FACTOR:d,MIN_R:u,R_BASE:p,R_VAR:f,R_FREQ1:A,R_FREQ2:y,TAIL_RADS:h,PURGE_PAD_R:_,START_OFFSET:v}=T;t.lineCap="round",t.lineJoin="round",t.strokeStyle=g||C.text.primary,t.lineWidth=m;let I=0,x=performance.now();const P=performance.now(),b=1e3,R=new Array(b);let O=0,F=0,U=0,E=0;let L=0;function N(e){const t=function(e){const t=.6*Math.sin(A*e)+.4*Math.sin(y*e+1.1);return Math.max(u,p+f*t)}(e);return{x:e*l+t*Math.cos(e),y:r-t*Math.sin(e),t:e}}function W(e){const t=performance.now(),o=Math.min((t-x)/1e3,.1);x=t;const r=(t-P)/1e3,s=Math.sin(2*Math.PI*w.modulationSpeed*r+w.modulationPhaseOffset),u=c+w.tempoModulation*s,p=d+w.accelerationModulation*s,f=Math.PI/Math.max(1,u)*60,m=E>5?Math.max(1,Math.floor(a/2)):a,g=f*o*(1+p*-Math.sin(I))/m;for(let i=0;i<m;i++)I+=g,R[F]=N(I),F=(F+1)%b,U<b?U++:O=(O+1)%b;const A=I-h;for(;U>0&&R[O].t<A-_;)O=(O+1)%b,U--;const y=I*l-v,S=y-L;L=y,Math.abs(S)<i?(S>0?e.clearRect(0,0,Math.ceil(S)+10,n):S<0&&e.clearRect(i+Math.floor(S)-10,0,10-S,n),e.clearRect(0,0,i,n)):e.clearRect(0,0,i,n),e.save(),e.translate(-y,0);let C,T=O,j=0;for(;j<U&&R[T].t<A;)T=(T+1)%b,j++;if(0===j||0===U)C=R[O];else if(j<U){const e=R[(T-1+b)%b],t=R[T],o=(A-e.t)/(t.t-e.t);C={x:e.x+(t.x-e.x)*o,y:e.y+(t.y-e.y)*o}}if(C&&U>0){e.beginPath(),e.moveTo(C.x,C.y);let t=T;for(let o=j;o<U;o++)e.lineTo(R[t].x,R[t].y),t=(t+1)%b;e.stroke()}e.restore();performance.now()-t>16?E++:E>0&&(E=Math.max(0,E-.1)),k.current?M.current=requestAnimationFrame((()=>W(e))):setTimeout((()=>{k.current&&(M.current=requestAnimationFrame((()=>W(e))))}),100)}return M.current=requestAnimationFrame((()=>W(t))),()=>{M.current&&cancelAnimationFrame(M.current)}}),[T,w,o,s,m,g,C.text.primary,c]),(0,a.jsx)("canvas",{ref:S,style:{width:o,height:s,display:"block",...t}})}},831310:(e,t,o)=>{o.d(t,{o:()=>n});o(296540);var i=o(474848);const n=(0,o(340498).wt)("check",{viewBox:"0 0 14 14",svg:(0,i.jsx)("polygon",{points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})})},831566:(e,t,o)=>{o.d(t,{p:()=>r});var i=()=>o(231297),n=()=>o(724456);function r(e){const{environment:t,collectionStore:o,performTransaction:r}=e;return i().createAndCommit({userAction:"collectionViewActions.createSchemaUpdateTransaction",environment:t,canUndo:!0,perform:e=>{const i=o.getSchema(),a=r(e),l=o.getSchema();return(0,n().H)({environment:t,collectionStore:o,oldSchema:i,newSchema:l,transaction:e}),a}}).performResult}}}]);