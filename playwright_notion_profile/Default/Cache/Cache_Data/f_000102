"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[98339],{27178:(e,t,o)=>{o.d(t,{ZN:()=>s,mN:()=>a,qo:()=>u});var r=()=>o(69708),n=()=>o(972435);const i=(0,r().YK)({default:{defaultMessage:"Default",id:"colors.select.lightGray"},gray:{defaultMessage:"Gray",id:"colors.select.gray"},brown:{defaultMessage:"Brown",id:"colors.select.brown"},orange:{defaultMessage:"Orange",id:"colors.select.orange"},yellow:{defaultMessage:"Yellow",id:"colors.select.yellow"},green:{defaultMessage:"Green",id:"colors.select.green"},blue:{defaultMessage:"Blue",id:"colors.select.blue"},purple:{defaultMessage:"Purple",id:"colors.select.purple"},pink:{defaultMessage:"Pink",id:"colors.select.pink"},red:{defaultMessage:"Red",id:"colors.select.red"}});function a(e){const t=i[e]||i.gray;return n().A.formatMessage(t)}const l=(0,r().YK)({default_background:{defaultMessage:"Default",id:"colors.blockColor.lightGray"},gray_background:{defaultMessage:"Gray",id:"colors.blockColor.gray"},brown_background:{defaultMessage:"Brown",id:"colors.blockColor.brown"},orange_background:{defaultMessage:"Orange",id:"colors.blockColor.orange"},yellow_background:{defaultMessage:"Yellow",id:"colors.blockColor.yellow"},teal_background:{defaultMessage:"Green",id:"colors.blockColor.green"},blue_background:{defaultMessage:"Blue",id:"colors.blockColor.blue"},purple_background:{defaultMessage:"Purple",id:"colors.blockColor.purple"},pink_background:{defaultMessage:"Pink",id:"colors.blockColor.pink"},red_background:{defaultMessage:"Red",id:"colors.blockColor.red"}});function s(e){const t=l[e];return n().A.formatMessage(t)}const c=(0,r().YK)({foregroundColorDefault:{id:"action.foregroundColor.default.name",defaultMessage:"Default text"},foregroundColorGray:{id:"action.foregroundColor.gray.name",defaultMessage:"Gray text"},foregroundColorBrown:{id:"action.foregroundColor.brown.name",defaultMessage:"Brown text"},foregroundColorOrange:{id:"action.foregroundColor.orange.name",defaultMessage:"Orange text"},foregroundColorYellow:{id:"action.foregroundColor.yellow.name",defaultMessage:"Yellow text"},foregroundColorGreen:{id:"action.foregroundColor.green.name",defaultMessage:"Green text"},foregroundColorBlue:{id:"action.foregroundColor.blue.name",defaultMessage:"Blue text"},foregroundColorPurple:{id:"action.foregroundColor.purple.name",defaultMessage:"Purple text"},foregroundColorPink:{id:"action.foregroundColor.pink.name",defaultMessage:"Pink text"},foregroundColorRed:{id:"action.foregroundColor.red.name",defaultMessage:"Red text"},backgroundColorGray:{id:"action.backgroundColor.gray.name",defaultMessage:"Gray background"},backgroundColorBrown:{id:"action.backgroundColor.brown.name",defaultMessage:"Brown background"},backgroundColorOrange:{id:"action.backgroundColor.orange.name",defaultMessage:"Orange background"},backgroundColorYellow:{id:"action.backgroundColor.yellow.name",defaultMessage:"Yellow background"},backgroundColorGreen:{id:"action.backgroundColor.green.name",defaultMessage:"Green background"},backgroundColorBlue:{id:"action.backgroundColor.blue.name",defaultMessage:"Blue background"},backgroundColorPurple:{id:"action.backgroundColor.purple.name",defaultMessage:"Purple background"},backgroundColorPink:{id:"action.backgroundColor.pink.name",defaultMessage:"Pink background"},backgroundColorRed:{id:"action.backgroundColor.red.name",defaultMessage:"Red background"},backgroundColorDefault:{id:"action.backgroundColor.default.name",defaultMessage:"Default background"}}),d={default:{...c.foregroundColorDefault},gray:{...c.foregroundColorGray},brown:{...c.foregroundColorBrown},orange:{...c.foregroundColorOrange},yellow:{...c.foregroundColorYellow},teal:{...c.foregroundColorGreen},blue:{...c.foregroundColorBlue},purple:{...c.foregroundColorPurple},pink:{...c.foregroundColorPink},red:{...c.foregroundColorRed},default_background:{...c.backgroundColorDefault},gray_background:{...c.backgroundColorGray},brown_background:{...c.backgroundColorBrown},orange_background:{...c.backgroundColorOrange},yellow_background:{...c.backgroundColorYellow},teal_background:{...c.backgroundColorGreen},blue_background:{...c.backgroundColorBlue},purple_background:{...c.backgroundColorPurple},pink_background:{...c.backgroundColorPink},red_background:{...c.backgroundColorRed}};function u(e){return d[e]}},47218:(e,t,o)=>{o.r(t),o.d(t,{arrowExpandDiagonalBottomLeftToTopRightIcon:()=>n,iconDefinition:()=>r});o(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"3.23 3.23 13.54 13.54",svg:(0,o(474848).jsx)("path",{d:"M11.14 4.485h3.491l-4.073 4.073a.625.625 0 0 0 .884.884l4.073-4.073v3.49a.625.625 0 1 0 1.25 0v-5a.625.625 0 0 0-.625-.624h-5a.625.625 0 1 0 0 1.25M4.485 14.631l4.07-4.07a.625.625 0 0 1 .884.884l-4.07 4.07h3.49a.625.625 0 1 1 0 1.25h-5a.625.625 0 0 1-.624-.625v-5a.625.625 0 1 1 1.25 0z"})},n=(0,o(340498).wt)("arrowExpandDiagonalBottomLeftToTopRight",r)},61188:(e,t,o)=>{o.d(t,{u:()=>y});o(581454);var r=()=>o(584262),n=()=>o(700500),i=()=>o(179034),a=()=>o(970330),l=()=>o(557281),s=()=>o(384944),c=()=>o(281948),d=()=>o(778417),u=()=>o(177618),m=()=>o(476492),g=()=>o(148832),p=()=>o(622811),f=()=>o(174254),S=()=>o(476297),v=()=>o(482871);function y(e){const{environment:t,collectionContextStore:o,before:y,store:b,groupsPointer:C,collectionStore:_,transaction:h,subitemPath:k,subitemInsertDirection:w,from:P}=e,M=o.collectionViewStore();if(!M)return;const x=o.groupsStore.getGroupState(C),T=null==x?void 0:x.groupUiParentStore,R=(null==x?void 0:x.resultsStore.state)||[];if(!T)return;const B=s().Wv({environment:t,type:n().xd.page,inMemoryRecordCache:b.inMemoryRecordCache,transaction:h,spaceId:M.pointer.spaceId});if(P){const e="collectionTypedView"===o.contextType?B.getAssociatedCollectionId():void 0;a().vH(t,{from:P,type:"page",new_page_id:B.id,creating_block_id:B.id,...m().sl(o,e)})}const D=(0,p().j)({environment:t,store:B,collectionStore:_,collectionContextStore:o,groupsPointer:C,shouldCoerce:!0,transaction:h}),V=o.defaultPageTemplateStore.state;V&&l().n5({title:"template",environment:t,store:B,templateStore:V,isKeyboard:!1,isCreateIn:!1,transaction:h,from:"collection_group_actions"});const I=g().B.createChildStore(T,{table:i().ev,id:B.id});k&&k.length>0&&(0,f().i)({environment:t,collectionContextStore:o,subitemPath:k,collectionStore:_,store:b,before:!1,insertBlockStore:I,insertDirection:w,transaction:h});const O=R.indexOf(b),z=y?O:O+1,A=[...R.slice(0,z),I,...R.slice(z)];if((0,v().z)({resultIds:A.map((e=>e.id)),collectionViewStore:M,collectionContextStore:o,transaction:h}),D){if(k){var L;const e="into"===w?b:null===(L=k[k.length-2])||void 0===L?void 0:L.value.store;return e?g().B.createChildStore(e,I.pointer):I}return d().Lt({environment:t,store:I}),(0,S().f)({environment:t,collectionContextStore:o}),I}c().VU({environment:t,store:I,peekMode:u().hH(o),resultsStore:null==x?void 0:x.resultsStore,collectionContextStore:o,pageVisitSource:r().y8.Create})}},160811:(e,t,o)=>{o.d(t,{D:()=>l});o(944114),o(581454);var r=()=>o(179034),n=()=>o(148832),i=()=>o(622811),a=()=>o(482871);function l(e){var t,o;const{environment:l,collectionContextStore:s,before:c,insertStores:d,store:u,groupsPointer:m,transaction:g}=e,p=s.collectionViewStore(),f=(null===(t=s.groupsStore.getGroupState(m))||void 0===t?void 0:t.resultsStore.state)||[],S=null===(o=s.groupsStore.getGroupState(m))||void 0===o?void 0:o.groupUiParentStore;if(!S)return[];const v=[];for(const a of d){const t=e.collectionStore??a.getAssociatedCollectionStore();t&&((0,i().j)({environment:l,store:a,collectionStore:t,collectionContextStore:s,groupsPointer:m,shouldCoerce:!0,transaction:g}),v.push(n().B.createChildStore(S,{table:r().ev,id:a.id})))}const y=f.indexOf(u),b=c?y:y+1,C=[...f.slice(0,b),...v,...f.slice(b)];return p&&(0,a().z)({resultIds:C.map((e=>e.id)),collectionViewStore:p,collectionContextStore:s,transaction:g}),s.groupsStore.setLimitIfGreater(m,C.length),v}},174254:(e,t,o)=>{o.d(t,{i:()=>n});var r=()=>o(899453);function n(e){const{environment:t,collectionContextStore:o,subitemPath:n,collectionStore:i,store:a,before:l,insertBlockStore:s,insertDirection:c,transaction:d}=e,u=o.currentSubitemFormatStoreForCollectionStore.state;if(!u)return;const m=i.getSchema()[u.property];if(!m||"relation"!==m.type)return;if("into"===c){var g;const e=n[n.length-1],o=e.value.store;return void r().j$({environment:t,sourceStore:o,destStore:s,position:l?{type:"before",before:null===(g=e.children[0])||void 0===g?void 0:g.value.store.id}:{type:"after"},propertyWithInverse:u,transaction:d})}const p=n[n.length-2];if(!p)return;const f=p.value.store;r().j$({environment:t,sourceStore:f,destStore:s,propertyWithInverse:u,position:l?{type:"before",before:a.id}:{type:"after",after:a.id},transaction:d})}},301948:(e,t,o)=>{o.d(t,{A:()=>a});o(296540);var r=()=>o(970236),n=()=>o(69708),i=o(474848);function a(e){return(0,i.jsx)(r().E,{color:"blue",style:e.style,content:(0,i.jsx)(n().sA,{id:"AlphaBadgeComponent.label",defaultMessage:"Alpha"})})}},314660:(e,t,o)=>{o.d(t,{f:()=>n});var r=()=>o(384944);function n(e){const{collectionViewStore:t,update:o,transaction:n}=e;r().zv({store:t.getQueryStore(),data:o,transaction:n})}},317406:(e,t,o)=>{o.d(t,{$N:()=>W,GB:()=>K,GZ:()=>j,L_:()=>oe,MQ:()=>J,P7:()=>Z,Pt:()=>H,Tq:()=>te,Xt:()=>q,bu:()=>Y,cd:()=>ee,dO:()=>re,eW:()=>X,k3:()=>E,n_:()=>G,sd:()=>$,v7:()=>N,vt:()=>Q});o(944114),o(898992),o(672577),o(803949),o(581454),o(737550);var r=()=>o(906745),n=()=>o(908006),i=()=>o(929219),a=()=>o(584262),l=()=>o(66689),s=()=>o(13643),c=()=>o(604995),d=()=>o(416504),u=()=>o(763884),m=()=>o(209199),g=()=>o(496603),p=()=>o(534177),f=()=>o(299709),S=()=>o(878060),v=()=>o(896628),y=()=>o(384944),b=()=>o(899453),C=()=>o(857783),_=()=>o(281948),h=()=>o(778417),k=()=>o(319975),w=()=>o(190033),P=()=>o(903864),M=()=>o(231297),x=()=>o(766854),T=()=>o(160811),R=()=>o(61188),B=()=>o(147503),D=()=>o(357643),V=()=>o(177618),I=()=>o(476492),O=()=>o(186091),z=()=>o(148832),A=()=>o(502438),L=()=>o(50764),F=()=>o(839106),U=()=>o(378518);function G(e){const{collectionViewStore:t,collectionContextStore:o,timelineState:r,environment:n}=e,a=n.currentUser.id,l=(0,U().UA)(t.id),s=(0,U().yG)(t,n),c=o.permissionScopesStore.state,d=g().sg((()=>{if(r.destroyed)return;const e={zoomLevel:r.zoomLevelStore.state,centerTimestamp:(0,U().o$)(r)};u().K.set({userId:a,key:l,value:e})}),1e3),m=g().sg((()=>{if(r.destroyed||!i().A.state.online||!n.currentUser.isLoggedIn()||!c.canConfigureBlock)return;const e={zoomLevel:r.zoomLevelStore.state,centerTimestamp:(0,U().o$)(r)},o=t.getFormat().timeline_preference;g().n4(o,e)||M().createAndCommit({userAction:"timelineActions.setRemotePreference",environment:n,canUndo:!0,perform:o=>{v().zA({stores:[t],update:{timeline_preference:e},transaction:o})}})}),5e3);r.savePreference=()=>{d(),m()},E({timelineState:r,environment:n,...s})}function E(e){const{timelineState:t,zoomLevel:o,centerTimestamp:r,environment:i}=e;t.zoomLevelStore.setState(o);const a=i.WindowSizeStore.state.width+2*U().E6,l=(0,U().C1)(o,a),s=r-l/2,c=r+l/2;t.currentRangeStore.setState({startTimestamp:s,endTimestamp:c});const{savePreference:d}=t;n().default.afterNextFlush((()=>{Y({timelineState:t,centerTimestamp:r}),d&&d()}))}function Y(e){const{timelineState:t,centerTimestamp:o}=e,{horizontalScroller:r,outerSizeObserver:n}=t;if(!r)return;const i=t.zoomLevelStore.state,{startTimestamp:a,endTimestamp:l}=t.currentRangeStore.state,s=n.rect.state.width;if(s===(0,U().w0)(i,l-a))return;const c=(0,U().w0)(i,o-a)-s/2;r.scrollLeft=((0,m().A1)()?-1:1)*c,t.scrollLeftStore.setState(c)}function q(e){const{environment:t,store:o,query:r,date:n,schema:i,transaction:a}=e,{timeline_by:l}=r;if(!l)return;const s=o.getAssociatedCollectionStore(),c=(null==s?void 0:s.getMappedProperty(l))??l,d=r.timeline_by_end?(null==s?void 0:s.getMappedProperty(r.timeline_by_end))??r.timeline_by_end:void 0,u=(0,U().u9)({store:o,dateValue:n,query:r,schema:(null==s?void 0:s.getSchema())??i}),m=o.getPropertyValue(c),g=d?o.getPropertyValue(d):void 0;return y().zv({store:o.getPropertiesStore(),data:u,transaction:a}),S().O({environment:t,store:o,dateProperty:{id:c,newValue:(null==u?void 0:u[c])??[],oldValue:m},otherDateProperty:d?{id:d,newValue:(null==u?void 0:u[d])??[],oldValue:g}:void 0}),o}function W(e){var t;const{environment:o,timelineState:n,collectionStore:i,collectionContextStore:a,store:l,query:s,groupFormat:u,transaction:m}=e,g=n.zoomLevelStore.state,p=(0,U().o$)(n),{snapUnit:f,getDateRangePlaceholderDuration:S}=U().eM[g],{timeline_by:v}=s;if(!v)return;const y=null===(t=a.groupsStore.getGroupState(u))||void 0===t?void 0:t.resultsStore.state;if(!y)return;const b=r().c9.fromMillis(p),C=(0,U().DY)(b,f),_=(0,U().DY)(S(b),f),h=(0,U().oJ)({startValue:(0,c().Ec)((0,d().P)()),snapUnit:f,desiredStart:C,desiredEnd:_});return q({environment:o,store:l,query:s,schema:i.getSchema(),date:h,transaction:m}),(0,T().D)({environment:o,collectionStore:i,before:!0,store:y[0],insertStores:[l],collectionContextStore:a,groupsPointer:u?[u]:[],transaction:m}),l}function N(e){const{type:t,timelineState:o,store:r,startX:n,query:i,schema:a,intl:l,environment:s,formulasModule:c}=e,{horizontalScroller:d}=o,{startTimestamp:u}=o.currentRangeStore.state;if(!d)return;h().Lt({environment:s,store:r});const m=d.scrollLeft,p=(0,U().Ul)(m,d.scrollWidth,d.clientWidth),{stores:f}=A().default.state,S=g().oE(f.map((e=>{const t=(0,U().GM)({store:e,query:i,schema:a,userId:s.currentUser.id,intl:l,formulasModule:c});if(t)return{startValue:t,store:e}})));o.dragStateStore.setState({type:t,startStore:r,stores:S.map((({store:e})=>e)),startValues:S.map((({startValue:e})=>e)),temporaryValues:S.map((({startValue:e})=>e)),startX:n,startStartTimestamp:u,startScrollLeft:p})}function Q(e){const{timelineState:t,store:o,startX:r,startY:n,schema:i,collectionContextStore:a,verticalScroller:l}=e,{horizontalScroller:s}=t,{startTimestamp:c}=t.currentRangeStore.state;if(!s||!l)return;const d=s.scrollLeft,u=l.scrollTop,m=(0,U().GW)(a,o,i);t.drawStateStore.setState({startStore:o,startDependencyRelationPointers:m,temporaryDependencyRelationPointers:[...m],startX:r,startY:n,startScrollLeft:d,startScrollTop:u,startStartTimestamp:c,xOffsetPx:0,yOffsetPx:0,tryToCompleteDrawnArrow:!1})}function K(e){const{timelineState:t,currentX:o}=e,{horizontalScroller:r}=t,n=t.zoomLevelStore.state,i=t.dragStateStore.state,{startTimestamp:a}=t.currentRangeStore.state;if(!i||!r)return;const{type:l,startStartTimestamp:s,startValues:d,startScrollLeft:u,startX:f,startStore:S,stores:v}=i,y=U().eM[n],{snapUnit:b}=y,C=r.scrollLeft,_=(0,U().Ul)(C,r.scrollWidth,r.clientWidth)-u+((0,m().A1)()?f-o:o-f)+(0,U().w0)(n,a-s),h=(0,U().C1)(n,_),k=d[v.indexOf(S)];let w;if(l===U().MB.LeftResizer){const{start:e}=(0,U().yl)(k,b),t=e.plus(h);w=d.map((e=>{const o=(0,U().oJ)({startValue:e,snapUnit:b,desiredStart:t});return(0,c().u7)(o)}))}else if(l===U().MB.RightResizer){const{end:e}=(0,U().yl)(k,b),t=e.plus(h);w=d.map((e=>{const o=(0,U().oJ)({startValue:e,snapUnit:b,desiredEnd:t});return(0,c().rL)(o)}))}else l===U().MB.ItemDrag?w=d.map((e=>{const{start:t,end:o}=(0,U().yl)(e,b),r=t.plus(h),n=r.plus(o.valueOf()-t.valueOf());return(0,U().oJ)({startValue:e,snapUnit:b,desiredStart:r,desiredEnd:n})})):(0,p().HB)(l);g().n4(i.temporaryValues,w)||t.dragStateStore.setState({...i,temporaryValues:w})}function j(e){const{timelineState:t,currentX:o,currentY:r,verticalScroller:n}=e,i=t.drawStateStore.state,a=t.zoomLevelStore.state,{startTimestamp:l}=t.currentRangeStore.state,{horizontalScroller:s}=t;if(!i||!s||!n)return;const{startDependencyRelationPointers:c,startStore:d,startX:u,startY:p,startScrollLeft:f,startScrollTop:S,startStartTimestamp:v}=i,y=s.scrollLeft,b=(0,U().Ul)(y,s.scrollWidth,s.clientWidth),C=n.scrollTop,_=b-f+((0,m().A1)()?u-o:o-u)+(0,U().w0)(a,l-v),h=C-S+(r-p),k=t.hoveredItemStore.state;if(k&&k!==d&&!c.some((e=>e.id===k.id))){const e=[...c,{table:"block",id:k.id,spaceId:k.getSpaceId()}];g().n4(i.temporaryDependencyRelationPointers,e)||t.drawStateStore.setState({...i,temporaryDependencyRelationPointers:e,xOffsetPx:void 0,yOffsetPx:void 0})}else t.drawStateStore.setState({...i,temporaryDependencyRelationPointers:[...c],xOffsetPx:_,yOffsetPx:h})}function X(e){const{environment:t,collectionContextStore:o,timelineState:r,query:n,schema:i,transaction:a}=e,l=r.dragStateStore.state,{timeline_by:s}=n;if(!l||!s)return;const{temporaryValues:c,stores:d}=l;c.forEach(((e,r)=>{const l=d[r];q({environment:t,store:l,query:n,schema:i,transaction:a,date:e}),(0,f().E)({environment:t,collectionContextStore:o,block_id:l.id,property:s,property_type:"date",from:"timeline"})})),r.dragStateStore.setState(void 0)}function $(e){var t;const{timelineState:o,environment:r,transaction:n,collectionContextStore:i,isFullScreen:a,isRootChild:l}=e,s=o.drawStateStore.state,c=o.dateRangePlaceholderStore.state;if(!s)return;const{startStore:d,startDependencyRelationPointers:u,temporaryDependencyRelationPointers:m}=s;if(!d)return void o.drawStateStore.setState(void 0);let g;if(c.active){const{date:e,store:t,parentStore:a,groupFormat:l,newTimelineItemProps:s,existingTimelineItemProps:u}=c;if(t&&u){const{query:o,schema:i}=u;q({environment:r,store:t,query:o,schema:i,date:e,transaction:n}),g={table:"block",id:t.id,spaceId:d.getSpaceId()}}else if(s){const{query:o,schema:c,isFullScreen:u,canEditTimelineItems:m,subitemPath:p}=s,f=re({environment:r,date:e,store:t,parentStore:a,query:o,schema:c,isFullScreen:u,groupFormat:l,canEditTimelineItems:m,collectionContextStore:i,subitemPath:p,transaction:n,from:"timeline_complete_draw"});f&&(g={table:"block",id:f.id,spaceId:d.getSpaceId()})}o.dateRangePlaceholderStore.setState({active:!1})}else g=m.find((e=>!u.includes(e)));const p=(0,U().VC)(i);if(p){const{property:e}=p;g&&(b().j$({environment:r,propertyWithInverse:p,sourceStore:d,destStore:z().B.createChildStore(d,g),position:{type:"after"},transaction:n}),(0,f().E)({environment:r,collectionContextStore:i,block_id:d.id,property:e,property_type:"relation",from:"timeline",isFromBulkActionsToolbar:!1,isUnthrottled:!0})),o.drawStateStore.setState(void 0)}else B().R8({item:{type:"dependencies",from:"view_options"},collectionSettingsStore:i.settingsStore}),o.drawStateStore.setState({...s,tryToCompleteDrawnArrow:!0});const S=null===(t=g)||void 0===t?void 0:t.id;S&&(0,F().xY)(r,{...(0,I().sl)(i),...(0,F().ZR)({environment:r,collectionContextStore:i,timelineState:o,isFullScreen:a,isRootChild:l}),dependenciesPropertyID:null==p?void 0:p.property,blockedByStoreID:d.id,blockingStoreID:S})}function H(e){const{timelineState:t,environment:o}=e;t.dragStateStore.state&&(t.dragStateStore.setState(void 0),h().IU({environment:o}))}function Z(e){const{timelineState:t,environment:o}=e;t.drawStateStore.state&&(t.drawStateStore.setState(void 0),h().IU({environment:o}))}function J(e){const{stores:t,collectionViewStore:o,schema:r,transaction:n}=e,i=o.getType(),a=(0,O().$)({collectionViewStore:o,schema:r}),l=[];a&&("calendar"===i?a.calendar_by&&l.push(a.calendar_by):"timeline"===i&&(a.timeline_by&&l.push(a.timeline_by),a.timeline_by_end&&l.push(a.timeline_by_end)));for(const s of t)for(const e of l)k().R9({environment:s.environment,store:s.getPropertyStore(e),value:void 0,transaction:n})}function ee(e){const{dependency:t,collectionContextStore:o,environment:r,timelineState:n,isFullScreen:i,isRootChild:a}=e,l=(0,U().VC)(o),s=o.collectionStore();if(!l||!s)return;const{property:c}=l,{store:d,relationPointer:u}=t,m=d.getSchema()[c];m&&"relation"===m.type&&(M().createAndCommit({userAction:"CollectionTimelineDependenciesOverlay.handleRemoveRelation",environment:r,canUndo:!0,perform:e=>{b().c3({environment:r,propertyWithInverse:l,sourceStore:d,destStore:z().B.createChildStore(d,u),transaction:e}),(0,f().E)({environment:r,block_id:u.id,property:c,property_type:m.type,from:"timeline",collectionContextStore:o,isFromBulkActionsToolbar:!1,isUnthrottled:!0})}}),(0,F().m2)(r,{...(0,I().sl)(o),...(0,F().ZR)({environment:r,collectionContextStore:o,timelineState:n,isFullScreen:i,isRootChild:a}),dependenciesPropertyID:c,blockedByStoreID:d.id,blockingStoreID:u.id}))}function te(e){const{collectionViewStore:t,newProperty:o,transaction:r}=e;v().zA({stores:[t],update:{timeline_arrows_by:{property:o}},transaction:r})}function oe(e){var t;const{collectionContextStore:o,relationPropertyId:r,transaction:n}=e,i=o.collectionStore();if(!i)return;const a=r?i.getSchema()[r]:void 0,c="relation"===(null==a?void 0:a.type)&&a.property&&"relation"===(null===(t=i.getSchema()[a.property])||void 0===t?void 0:t.type)?a.property:void 0;v().zA({stores:[i],update:{collection_default_arrows_by:r,...i.getFormat().app_config_uri===s().dC?{app_uri_map:{...i.getFormat().app_uri_map?i.getFormat().app_uri_map:{},[l().yx.BlockingRelation]:r,[l().yx.BlockedRelation]:c}}:{}},transaction:n})}function re(e){const{environment:t,transaction:o,date:r,parentStore:n,query:i,schema:l,isFullScreen:s,groupFormat:c,canEditTimelineItems:d,collectionContextStore:u,from:m}=e;if(!(0,L().E)(t))return;const g=c?[c]:[],p=u.groupsStore.getGroupState(g);if(!p)return;if(n)return function(e){const{environment:t,transaction:o,date:r,store:n,parentStore:i,query:l,schema:s,groupFormat:c,canEditTimelineItems:d,collectionContextStore:u,subitemPath:m}=e;if(!n||!i)return;const g=c?[c]:[],p=(0,R().u)({environment:t,collectionContextStore:u,groupsPointer:g,store:n,before:!1,collectionStore:i,transaction:o,subitemPath:m,subitemInsertDirection:"into"});if(p){if(q({environment:t,store:p,query:l,schema:s,date:r,transaction:o}),t.device.isMobile)C().uK({environment:t,store:p,pageVisitSource:a().y8.Create});else if(p&&d){const e=p.getBlockTitleStore();(0,P().e)({store:e})}return p}}(e);u.searchQueryStore.state&&(0,D().S)({searchQuery:"",collectionContextStore:u,isFullScreen:s});const f=(0,x().Q)({environment:t,collectionContextStore:u,groupsPointer:g,shouldCoerce:!0,templateStore:u.defaultPageTemplateStore.state,transaction:o,from:{createBlock:m},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache});if(!f)return;const S=f.coercionSucceeded,v=f.newStore;if(q({environment:t,store:v,query:i,schema:l,date:r,transaction:o}),t.device.isMobile)C().uK({environment:t,store:v,pageVisitSource:a().y8.Create});else if(S&&d){const e=v.getBlockTitleStore();(0,w().z)({store:e})}else _().VU({environment:t,store:v,peekMode:(0,V().hH)(u),resultsStore:null==p?void 0:p.resultsStore,collectionContextStore:u,pageVisitSource:a().y8.Create});return v}},357643:(e,t,o)=>{function r(e){const{searchQuery:t,collectionContextStore:o}=e;o.collectionViewStore()&&(o.searchQueryStore.setState(t||""),o.groupsStore.resetAllLimits())}o.d(t,{S:()=>r})},476297:(e,t,o)=>{o.d(t,{f:()=>d});var r=()=>o(901389),n=()=>o(231297),i=()=>o(314660),a=()=>o(942125),l=()=>o(852353),s=()=>o(972435);const c=(0,o(69708).YK)({removeSortingConfirmation:{id:"databaseActions.removeSortingConfirmationDialog.prompt",defaultMessage:"Would you like to remove sorting?"},removeSortingButton:{id:"databaseActions.removeSortingConfirmationDialog.removeSortingButton.label",defaultMessage:"Remove"},removeSortingCancel:{id:"databaseActions.removeSortingConfirmationDialog.cancelRemoveSortingButton.label",defaultMessage:"Donâ€™t remove"}});function d(e){const{environment:t,collectionContextStore:o}=e,d=o.collectionViewBlockStore(),u=o.collectionViewStore();if(!u||!d)return!1;const m=o.currentViewHasSort(),g=(0,a().gv)(o),p=m||g,f=u.getType(),S=o.permissionScopesStore.state;return!!(p&&f&&l().gP[f]&&S.canConfigureBlock)&&(r().ui({message:s().A.formatMessage(c.removeSortingConfirmation),items:[{label:s().A.formatMessage(c.removeSortingButton),color:"red",onAccept:()=>{n().createAndCommit({userAction:"collectionGroupActions.offerToRemoveSort",environment:t,canUndo:!0,perform:e=>{(0,i().f)({collectionViewStore:u,update:{sort:[]},transaction:e})}});const e=o.temporaryStateStore.state;o.temporaryStateStore.setState({...e,sorts:void 0})}},{label:s().A.formatMessage(c.removeSortingCancel),onAccept:()=>{}}],showCancel:!1,keepFocus:!0}),!0)}},839106:(e,t,o)=>{o.d(t,{AP:()=>s,VD:()=>d,ZR:()=>f,gp:()=>m,i6:()=>c,iH:()=>a,iT:()=>u,m2:()=>p,xY:()=>g,z2:()=>l});o(898992),o(354520);var r=()=>o(314529),n=()=>o(999202),i=()=>o(378518);function a(e,t){(0,n().W)(e,"timeline_view","timeline_view",5,t)}function l(e,t){(0,r().DO_NOT_USE_trackLegacy)(e,"timeline_zoom_level_update",t)}function s(e,t){(0,r().DO_NOT_USE_trackLegacy)(e,"timeline_today_click",t)}function c(e,t){(0,r().DO_NOT_USE_trackLegacy)(e,"timeline_shift_time_click",t)}function d(e,t){(0,r().DO_NOT_USE_trackLegacy)(e,"timeline_toggle_table_click",t)}function u(e,t){(0,r().DO_NOT_USE_trackLegacy)(e,"timeline_item_scroll_arrow_click",t)}function m(e,t){(0,r().DO_NOT_USE_trackLegacy)(e,"timeline_item_resize",t)}function g(e,t){(0,r().DO_NOT_USE_trackLegacy)(e,"timeline_dependency_arrow_add",t)}function p(e,t){(0,r().DO_NOT_USE_trackLegacy)(e,"timeline_dependency_arrow_delete",t)}function f(e){const{environment:t,collectionContextStore:o,timelineState:r,isFullScreen:n,isRootChild:a}=e,l=r.zoomLevelStore.state,s=o.normalizedFormatStore.state,c=(0,i().iw)({environment:t,format:s,isFullScreen:n,isRootChild:a}),d=c&&s.timeline_table_properties?s.timeline_table_properties.length:0,u=s.timeline_properties||[],m=u.filter((e=>"title"!==e.property));return{zoom_level:l,show_table:c,show_table_properties_count:d,show_timeline_title:u.length!==m.length,show_timeline_properties_count:m.length}}},942125:(e,t,o)=>{o.d(t,{I6:()=>u,Ml:()=>c,gv:()=>g,y_:()=>d,ye:()=>m});o(898992),o(354520),o(672577),o(581454),o(737550);var r=()=>o(214388),n=()=>o(329199),i=()=>o(837788),a=()=>o(448801),l=()=>o(496603),s=()=>o(701684);function c(e,t){var o,c,d;const u=e.collectionViewStore();if(!u)return{combinatorFilter:void 0,filters:{moveOps:[],removed:[],updated:[],moved:[],added:[]},sorts:void 0};const m="persisted"===t?u.getQueryStore().getKeyStore("sort").getValue()||[]:(null===(o=e.normalizedQueryStore.state)||void 0===o?void 0:o.sort)||[],g=e.currentSortsStore.state,p="persisted"===t?u.getQueryStore().getKeyStore("filter").getValue():null===(c=e.normalizedQueryStore.state)||void 0===c?void 0:c.filter,f=e.currentCombinatorFilterStore.state,S="persisted"===t?(null===(d=u.getPropertyFiltersStore().getValue())||void 0===d?void 0:d.sort((0,s().I)()))||[]:function(e){const t=e.normalizedSchemaStore.state,o=e.normalizedFormatStore.state.property_filters||[];return l().oE(o.filter((o=>{const i=(0,n().hs)(o.filter,t),a=e.collectionViewBlockStore();if(t[o.filter.property]&&i&&(0,r().tn)(t,o.filter.property,i.filter,null==a?void 0:a.getRecordModel))return i&&{id:o.id,filter:i}})).sort((0,s().I)()))}(e),v=e.currentPropertyFiltersStore.state,y=S.map((e=>e.id)),b=v.map((e=>e.id)),{beforeOps:C,removeOps:_}=(0,a().i)(y,b),h=Array.from(_).filter((e=>!b.includes(e))),k=Object.keys(C).map((e=>({id:e,beforeId:C[e]}))),w=k.filter((({id:e})=>y.includes(e))).map((({id:e})=>e)),P=k.filter((({id:e})=>!y.includes(e))).map((({id:e})=>e)),M=v.filter((e=>S.find((t=>{if(e.id!==t.id)return!1;const o=l().mg(t),r=l().mg(e);return!l().n4((0,i().A)(r,"ignore-class-instances"),(0,i().A)(o,"ignore-class-instances"))})))).map((e=>e.id));return{combinatorFilter:l().n4(p,f)?void 0:{value:f},filters:{moveOps:k,removed:h,updated:M,moved:w,added:P},sorts:l().n4(m,g)?void 0:{value:g}}}function d(e){const t=c(e,"normalized");return Boolean(t.filters.moved.length>0||t.filters.added.length>0||t.filters.removed.length>0||t.filters.updated.length>0||void 0!==t.combinatorFilter||void 0!==t.sorts)}function u(e){const t=c(e,"normalized");return Boolean(t.filters.moved.length>0||t.filters.added.length>0||t.filters.removed.length>0||t.filters.updated.length>0||void 0!==t.combinatorFilter)}function m(e){const t=c(e,"normalized"),o=e.currentPropertyFiltersStore.state.filter((e=>!(0,r().t_)(e.filter))),n=t.filters.added.some((e=>o.some((t=>t.id===e))));return Boolean(n||t.filters.moved.length>0||t.filters.removed.length>0||t.filters.updated.length>0||void 0!==t.combinatorFilter)}function g(e){const t=c(e,"normalized");return Boolean(void 0!==t.sorts)}}}]);