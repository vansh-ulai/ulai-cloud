"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[12341],{3486:(e,t,o)=>{o.d(t,{P:()=>i,_:()=>l});var n=()=>o(278238);function i(e){const t=(0,n().VA)(e);return"lightgray"===t?"gray":t}function l(e,t){const o=(0,n().VA)(e),i="lightgray"===o?"gray":o;return n().l8[t.mode][i]}},167170:(e,t,o)=>{o.d(t,{_:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"3.29 3.29 13.41 13.41",svg:(0,o(474848).jsx)("path",{d:"M3.3 4.825c0-.842.683-1.525 1.525-1.525h3.15c.842 0 1.525.683 1.525 1.525v10.35c0 .842-.683 1.525-1.525 1.525h-3.15A1.525 1.525 0 0 1 3.3 15.175zm1.525-.275a.275.275 0 0 0-.275.275v10.35c0 .152.123.275.275.275h3.15a.275.275 0 0 0 .275-.275V4.825a.275.275 0 0 0-.275-.275zm5.675.275v3.15c0 .842.683 1.525 1.525 1.525h3.15c.842 0 1.525-.683 1.525-1.525v-3.15c0-.842-.683-1.525-1.525-1.525h-3.15c-.842 0-1.525.683-1.525 1.525m1.525-.275h3.15c.152 0 .275.123.275.275v3.15a.275.275 0 0 1-.275.275h-3.15a.275.275 0 0 1-.275-.275v-3.15c0-.152.123-.275.275-.275m0 5.95c-.842 0-1.525.683-1.525 1.525v3.15c0 .842.683 1.525 1.525 1.525h3.15c.842 0 1.525-.683 1.525-1.525v-3.15c0-.842-.683-1.525-1.525-1.525zm-.275 1.525c0-.152.123-.275.275-.275h3.15c.152 0 .275.123.275.275v3.15a.275.275 0 0 1-.275.275h-3.15a.275.275 0 0 1-.275-.275z"})},i=(0,o(340498).wt)("layout",n)},199483:(e,t,o)=>{o.d(t,{o:()=>i});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"3.7 1.41 8.6 12.78",svg:(0,o(474848).jsx)("path",{d:"M9.635 1.955a.5.5 0 0 0-.905-.328l-4.935 6.84a.5.5 0 0 0 .405.793h2.478l-.32 4.4a.5.5 0 0 0 .903.33l4.944-6.833a.5.5 0 0 0-.405-.793H9.32z"})},i=(0,o(340498).wt)("lightningFillSmall",n)},231314:(e,t,o)=>{o.d(t,{y:()=>l});o(296540);var n=()=>o(401497),i=o(474848);function l({icon:e,backgroundColor:t,backgroundSize:o}){const l=(0,n().IS)((e=>({iconContainer:{height:o??28,width:o??28,borderRadius:6,display:"flex",alignItems:"center",justifyContent:"center",background:t??e.background.tertiaryTranslucent}})),[t,o]);return(0,i.jsx)("div",{style:l.iconContainer,children:e})}},235773:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>i,notionTemplateTintableIcon:()=>l});o(296540);var n=o(474848);const i={viewBox:"0 0 20 20",fittedViewBox:"1.58 3 16.83 14",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{fillRule:"evenodd",d:"M6.014 16.338a4.43 4.43 0 0 0 4.43-4.48H8.88c-.254 0-.512 0-.732-.018a2.3 2.3 0 0 1-.86-.226 2.24 2.24 0 0 1-.979-.979 2.3 2.3 0 0 1-.226-.86 10 10 0 0 1-.018-.731V7.48a4.44 4.44 0 0 1 2.297.678 4.431 4.431 0 0 0-6.777 3.751 4.43 4.43 0 0 0 4.43 4.43z",clipRule:"evenodd"}),(0,n.jsx)("path",{d:"M12.902 11.044c.463-.802.694-1.203.997-1.338a1.02 1.02 0 0 1 .828 0c.302.135.534.536.996 1.338l2.028 3.512c.463.802.695 1.203.66 1.532-.03.287-.18.548-.414.718-.267.194-.73.194-1.656.194h-4.057c-.925 0-1.388 0-1.656-.194a1.02 1.02 0 0 1-.414-.718c-.035-.329.197-.73.66-1.532z"}),(0,n.jsx)("path",{fillRule:"evenodd",d:"M7.287 4.63c0-.571 0-.856.111-1.074.098-.192.254-.347.445-.445C8.061 3 8.346 3 8.916 3h4.38c.57 0 .854 0 1.072.111.191.098.347.253.445.445.11.218.11.503.11 1.073v3.852a2.24 2.24 0 0 0-1.52.109c-.46.204-.75.56-.94.83q-.318.472-.595.97l-.024.043-.118.203h-2.81c-.57 0-.855 0-1.073-.11a1 1 0 0 1-.445-.445c-.11-.218-.11-.503-.11-1.074z",clipRule:"evenodd"})]})},l=(0,o(340498).wt)("notionTemplateTintable",i)},344482:(e,t,o)=>{o.d(t,{A:()=>i});o(898992),o(672577);class n extends(()=>o(959180))().A{findTableHeaderCell(e,t){return this.find((o=>o.collectionContextStore===e&&o.property===t))}}const i=new n},507807:(e,t,o)=>{o.d(t,{S:()=>m,f:()=>f});o(944114);var n=o(296540),i=()=>o(484714),l=()=>o(56366),r=()=>o(165358),c=(o(16280),()=>o(439180)),a=()=>o(878710),s=()=>o(231297);var d=()=>o(878423),p=()=>o(733539),u=()=>o(246125);function m(e,{canUndo:t,shouldPersistOperation:o}){const m=(0,i().v3)(),f=(0,n.useRef)([]).current,v=(0,n.useCallback)((e=>{f.push(...e)}),[f]),h=(0,n.useCallback)((e=>{o&&!o(e)||v([e])}),[v,o]),S=(0,u().l)(e,{cacheFallback:m.defaultRecordCache.inMemoryRecordCache,isTemporaryData:!0,onOperationCallback:h});(0,n.useEffect)((()=>{d().A.initializeCache(e,S)}),[e,S]);const g=(0,n.useCallback)((()=>{p().default.reset(),d().A.clearCache(e)}),[e]);(0,n.useEffect)((()=>(p().default.reset(),()=>{p().default.reset(),d().A.expire(e)})),[e]);const y=(0,l().K8)((()=>p().default.state.undoStack.length>0),[]);(0,n.useEffect)((()=>{d().A.updateUnsavedCacheState(e,y)}),[e,y]);const x=(0,n.useCallback)((async e=>{if(0===f.length)return void 0;S.assertUnexpired(),function(e){for(const t of p().default.state.undoStack)for(const o of t.transactions)for(const t of o.stores)if(t.inMemoryRecordCache!==e&&!t.inMemoryRecordCache.isMockTextStore){const n=o.getUserActionForAnalyticsPurposesOnly(),i=t.inMemoryRecordCache.name,l=e.name,c=`Undoable user action "${n}" was applied to cache "${i}", but only operations in the cache "${l}" should be in the undo stack!`;(0,r().log)({from:"useLocalDraft",type:"invalidStoreInRevisionStack",level:"error",data:{message:c,miscDataToConvertToString:{userAction:n,inMemoryRecordCacheName:i,expectedInMemoryRecordCacheName:l}}})}}(S);const{serverCommitResult:o}=s().createAndCommit({environment:m,userAction:e,perform(e){!function({environment:e,transaction:t,operationsWithStores:o}){for(const{operation:n,store:i}of o){if(!(i instanceof a().pm))continue;const o=i.clone(e.defaultRecordCache.inMemoryRecordCache);(0,c().ph)(n)?s().applyCrdtTextOperation({store:i,operation:n,transaction:t,invertedOperation:void 0}):s().applyOperation({transaction:t,store:o,operation:n})}}({environment:m,transaction:e,operationsWithStores:f}),e.postSubmitCallbacks.push((e=>{e||(S.expire(),p().default.reset())}))},canUndo:t});return o}),[e,t,m,f,S]);return(0,n.useMemo)((()=>({cache:S,hasChanges:y,persist:x,reset:g})),[y,x,g,S])}function f(e,t){return(0,l().K8)((()=>t.clone(e.cache)),[t,e.cache])}},529099:(e,t,o)=>{o.r(t),o.d(t,{aiFaceIcon:()=>l,iconDefinition:()=>i});o(296540);var n=o(474848);const i={viewBox:"0 0 20 20",fittedViewBox:"4.13 2.52 13.27 14.61",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M12.758 9.976a1.178 1.178 0 1 0 .377-2.326 1.178 1.178 0 0 0-.377 2.326M6.547 8.97a1.178 1.178 0 1 0 .377-2.327 1.178 1.178 0 0 0-.377 2.326"}),(0,n.jsx)("path",{d:"M10.573 5.554a3.917 3.917 0 0 1 6.743.035.625.625 0 1 1-1.08.63 2.667 2.667 0 0 0-4.591-.023l-5.398 9.015 4.192.68a.625.625 0 0 1-.2 1.233l-5.102-.827a.625.625 0 0 1-.436-.938zM4.36 3.517a3.92 3.92 0 0 1 5.572.356.625.625 0 1 1-.945.818 2.67 2.67 0 0 0-3.795-.243.625.625 0 1 1-.833-.931"})]})},l=(0,o(340498).wt)("aiFace",i)},609819:(e,t,o)=>{o.d(t,{Z:()=>Q,c:()=>q});o(898992),o(354520),o(581454);var n=o(296540),i=()=>o(484714),l=()=>o(56366),r=()=>o(401497),c=()=>o(611648),a=()=>o(699143),s=()=>o(591779),d=()=>o(106065),p=()=>o(2143),u=()=>o(125565),m=()=>o(106412),f=()=>o(953418),v=()=>o(53798),h=()=>o(344482),S=()=>o(902842),g=(o(672577),()=>o(180762)),y=()=>o(458097);var x=()=>o(663077),w=()=>o(231297),b=()=>o(254497),C=()=>o(312296),k=()=>o(177618),I=()=>o(799832),T=()=>o(101926),j=()=>o(290966),P=()=>o(913454),V=()=>o(204067);function B({environment:e,collectionTemplate:t,featureTemplate:o,collectionViewBlockStore:n,previousFeatureSelections:i,examplePageStores:l}){var r;const c=null==n?void 0:n.getCollectionStoreIfSingleSource();if(!c)return;const a=(0,V().Zp)({environment:e,scopeStore:c,templateId:o.templateId});if(a&&!(0,V().DM)(a))return;(null===(r=i.find((e=>e.template.templateId===o.templateId)))||void 0===r?void 0:r.selected)??!1?a&&w().createAndCommit({userAction:"workflowTemplatesOnboardingPreview.removeFeatureTemplate",environment:e,canUndo:!1,perform:t=>{F({environment:e,transaction:t,collectionViewBlockStore:n,collectionStore:c,instancePointer:a,previousSelectionIds:i.map((e=>e.template.templateId))})}}):w().createAndCommit({userAction:"workflowTemplatesOnboardingPreview.addFeatureTemplate",environment:e,canUndo:!1,perform:i=>{M({environment:e,transaction:i,collectionViewBlockStore:n,collectionStore:c,collectionTemplate:t,featureTemplate:o,existingInstancePointer:a,examplePageStores:l})}})}function M({environment:e,transaction:t,collectionViewBlockStore:o,collectionStore:n,featureTemplate:i,existingInstancePointer:l,examplePageStores:r,collectionTemplate:c}){if(!o||!(0,x().Jb)(i))return;const a=l&&(0,V().aI)({environment:e,instancePointer:l,inMemoryRecordCache:n.inMemoryRecordCache});if(!a||"compound"===l.type)if(a&&"compound"===l.type)for(const s of l.instancePointers)if("property"===s.type)z({environment:e,transaction:t,propertyId:s.id,collectionStore:n});else{const i=(0,V().Fy)({environment:e,collectionStore:n,instancePointerId:s.id});if(!i)return;M({environment:e,transaction:t,collectionViewBlockStore:o,collectionStore:n,collectionTemplate:c,featureTemplate:i,existingInstancePointer:s,examplePageStores:r})}else if(!_({environment:e,transaction:t,collectionViewBlockStore:o,collectionStore:n,featureTemplate:i})){if("compound"===i.type)for(const l of i.value.templateItems){const i=P().globalWorkflowTemplates.fromId(l.pointer);"property"===i.type&&_({environment:e,transaction:t,collectionViewBlockStore:o,collectionStore:n,featureTemplate:i})}(0,T().ai)({environment:e,transaction:t,collectionStore:n,template:i,logger:new(P().WorkflowTemplateLogger),origin:"onboarding_preview",preserveCollectionFeatureOrdering:c,examplePageStores:r})}}function _(e){var t,o;const{environment:n,transaction:i,collectionStore:l,collectionViewBlockStore:r,featureTemplate:c}=e,a=null===(t=(0,I().U)(r))||void 0===t?void 0:t.normalizedDeletedSchemaStore.state,s=a&&(null===(o=Object.entries(a))||void 0===o?void 0:o.find((([e,t])=>{var o;return(null==t||null===(o=t.workflow_template_instance)||void 0===o?void 0:o.template_id)===c.templateId})));return!!s&&(z({environment:n,transaction:i,propertyId:s[0],collectionStore:l}),!0)}function F({environment:e,transaction:t,collectionViewBlockStore:o,collectionStore:n,instancePointer:i,previousSelectionIds:l}){"compound"===i.type?function({environment:e,transaction:t,collectionViewBlockStore:o,collectionStore:n,instancePointer:i,previousSelectionIds:l}){if("compound"!==i.type)return;const r=(0,V().FE)({environment:e,collectionStore:n}).find((e=>e.instancePointer.id===i.id));if(!r)return;const c=(0,V().aL)({environment:e,collectionStore:n,compoundTemplateInstancesToDelete:[r]}).filter((t=>{const o=(0,V().Fy)({environment:e,collectionStore:n,instancePointerId:t.id});return o&&!l.includes(o.templateId)}));for(const a of c)F({environment:e,transaction:t,collectionViewBlockStore:o,collectionStore:n,instancePointer:a,previousSelectionIds:l});(0,j().HQ)({environment:e,transaction:t,collectionStore:n,instance:i})}({environment:e,transaction:t,collectionViewBlockStore:o,collectionStore:n,instancePointer:i,previousSelectionIds:l}):(0,T().Z5)({environment:e,transaction:t,collectionViewBlockStore:o,collectionStore:n,instancePointer:i})}function z({environment:e,transaction:t,collectionStore:o,propertyId:n}){const i=k().KA({deletedSchema:o.getDeletedSchema(),property:n});i&&((0,C().F)({environment:e,collectionStore:o,update:i.updateSchema,transaction:t}),(0,b().E)({collectionStore:o,update:i.updateDeletedSchema,transaction:t}))}function A(){const e=(0,i().v3)(),{featureTemplateSelections:t,prevFeatureTemplateSelections:o}=(0,l().K8)((()=>{const e=y().default.state;return e.open&&e.collectionTemplate?{featureTemplateSelections:e.userCustomizations.featureTemplateSelections,prevFeatureTemplateSelections:e.userCustomizations.prevFeatureTemplateSelections}:{}}),[]);(0,n.useEffect)((()=>{o&&function({environment:e,featureTemplateSelections:t,prevFeatureTemplateSelections:o}){const n=y().default.state;if(!n.open||!n.collectionTemplate||!n.previewCollectionInfo)return;const{collectionTemplate:i,previewCollectionInfo:l}=n,r=o.filter((e=>{const o=t.find((t=>t.template.templateId===e.template.templateId));return o&&o.selected!==e.selected}));for(const c of r)B({environment:e,collectionTemplate:i,featureTemplate:c.template,previousFeatureSelections:o,collectionViewBlockStore:l.collectionViewBlockStore,examplePageStores:l.examplePageStores})}({environment:e,featureTemplateSelections:t,prevFeatureTemplateSelections:o})}),[e,t,o])}var R=()=>o(766854),O=()=>o(688742),K=()=>o(342),D=()=>o(507807),W=()=>o(253141);const H=3;o(430670),o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(737550);var Y=()=>o(534177);function E({normalizedSchema:e,collectionView:t,considerGroupByAsVisible:o=!1}){const n=function({collectionView:e,includeGroupByProperties:t=!1}){const o={},n=e=>{if(e)for(const t of e)o[t.property]||(o[t.property]=[]),o[t.property].push(t)},i=e.getType(),l=e.getFormatStore();switch(i){case"board":if(n(l.getKeyValue("board_properties")),t){const e=l.getKeyValue("board_columns_by");e&&n([{property:e.property,visible:!0}])}break;case"calendar":n(l.getKeyValue("calendar_properties"));break;case"gallery":n(l.getKeyValue("gallery_properties"));break;case"list":n(l.getKeyValue("list_properties"));break;case"timeline":n(l.getKeyValue("timeline_properties")),n(l.getKeyValue("timeline_table_properties"));break;case"table":n(l.getKeyValue("table_properties"));break;case"chart":case"chat":case"feed":case"page":case"form_editor":case"map":case"custom":case"dashboard":break;default:(0,Y().HB)(i)}if(t){const e=l.getKeyValue("collection_group_by");e&&n([{property:e.property,visible:!0}])}return o}({collectionView:t,includeGroupByProperties:o}),i={visibleProperties:new Set,invisibleProperties:new Set};for(const l of Object.keys(e)){const e=n[l];(null==e?void 0:e.some((e=>e.visible)))??!1?i.visibleProperties.add(l):i.invisibleProperties.add(l)}return i}var L=()=>o(852424),U=()=>o(284371),$=o(474848);function N({collectionContextStore:e}){const t=(0,l().K8)((()=>{var t;const o=e.collectionStore(),n=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getModel();if(!o||!n)return[];const{invisibleProperties:i}=E({normalizedSchema:o.getSchema(),collectionView:n,considerGroupByAsVisible:!0});return Array.from(i)}),[e]),n=t.length,i=(0,r().IS)((e=>({container:{position:"absolute",zIndex:1,bottom:0,insetInlineEnd:0,margin:8,color:e.text.primary,opacity:0===n?0:1,transition:0===n?"opacity 0s ease":"opacity 0.1s ease"},button:{backdropFilter:"blur(40px)"}})),[n]);return(0,$.jsx)("div",{style:i.container,children:(0,$.jsx)(o(859428).A,{alignment:"start",renderTooltip:()=>(0,$.jsx)(G,{collectionContextStore:e,invisibleProperties:t}),render:e=>(0,$.jsx)(o(631524).p,{hovered:!0,disabled:!0,...e,style:i.button,children:(0,$.jsx)(o(493552).D,{styleKey:"Caption/Medium",colorVariant:"secondary",children:(0,$.jsx)(o(69708).sA,{id:"hiddenPropertiesIndicator.hiddenCount",defaultMessage:"{numHiddenProperties, plural, one {1 hidden property} other {# hidden properties}}",values:{numHiddenProperties:n}})})})})})}function G({collectionContextStore:e,invisibleProperties:t}){const o=(0,r().IS)((e=>({container:{display:"flex",flexDirection:"column",gap:4,marginTop:2,marginBottom:2},propertyContainer:{display:"flex",flexDirection:"row",alignItems:"center",gap:2},propertyIcon:{verticalAlign:"middle",display:"inline-block",marginInlineEnd:3,marginBottom:2},propertyName:{maxWidth:150,...U().RC}})),[]),n=(0,l().K8)((()=>{var o;const n=(null===(o=e.collectionStore())||void 0===o?void 0:o.getSchema())??{},i={};for(const e of t){const t=n[e];t&&(i[e]=t)}return i}),[e,t]),i=(0,r().DP)();return(0,$.jsx)("div",{style:o.container,children:t.flatMap((e=>{const t=n[e];return t?[(0,$.jsxs)("div",{style:o.propertyContainer,children:[(0,$.jsx)(L().zB,{icon:t.icon,type:t.type,size:14,style:o.propertyIcon,theme:i,willShowOnTooltip:!0}),(0,$.jsx)("span",{style:o.propertyName,children:t.name})]},t.name)]:[]}))})}const Z=n.memo(N);function Q({collectionTemplate:e,flowId:t}){const o=(0,i().v3)(),{isPhone:f}=(0,i().Y0)(),v=f?10:32,h=(0,n.useMemo)((()=>({flowId:t,location:"workflow_templates_onboarding",isPreviewing:!0,disableHeaderPointerEvents:!0,disableEditsAndConfiguration:!0,disableContentPointerEvents:!0,disablePageLinks:!0,hideAggregation:!0,hideViewBlockSource:!0,enableHorizontalScroll:!1})),[t]),x=function(){const e=(0,i().v3)(),t=(0,D().S)(K().Zu,{canUndo:!0}),o=(0,n.useRef)(void 0),r=(0,l().O$)(y().default);return(0,n.useEffect)((()=>{if(r.open&&r.collectionTemplate&&r.parentStore&&!o.current){var n;const{performResult:{collectionStore:i,collectionViewBlockStore:l,collectionViewStore:c,examplePageStores:a}}=w().createAndCommit({userAction:"workflowTemplateCustomizationOnboarding.previewCollection",environment:e,perform:o=>{const{collectionStore:n,collectionViewBlockStore:i,collectionViewStore:l,examplePageStores:c}=(0,W().mm)({environment:e,existingCollectionInfo:void 0,inMemoryRecordCache:t.cache,parentStore:r.parentStore.clone(t.cache),template:r.collectionTemplate,transaction:o,logger:new(P().WorkflowTemplateLogger)});if(0===c.length){const t=new(O().B)(e);for(let i=0;i<H;i++)(0,R().Q)({environment:e,collectionContextStore:t,groupsPointer:[],insertAtIndex:0,shouldCoerce:!0,templateStore:t.defaultPageTemplateStore.state,transaction:o,from:{createBlock:"workflow_template"},inMemoryRecordCache:n.inMemoryRecordCache})}return{collectionViewBlockStore:i,collectionViewStore:l,collectionStore:n,examplePageStores:c}},canUndo:!1});o.current={collectionStore:i,collectionViewBlockStore:l,collectionViewStore:c},y().default.setState({...r,previewCollectionInfo:{collectionViewBlockStore:l,examplePageStores:a,collectionContextStore:void 0,focusViewTemplateId:null===(n=r.previewCollectionInfo)||void 0===n?void 0:n.focusViewTemplateId}})}}),[r,t,e]),o.current}(),b=(0,l().K8)((()=>y().default.getPreviewCollectionContextStore()),[]),C=(0,l().K8)((()=>{const e=null==b?void 0:b.getViewType();return"gallery"===e||"list"===e?v:0}),[b,v]),k=(0,l().K8)((()=>x?function({collectionStore:e,collectionViewStore:t}){const o=e.getSchema(),n=t.getFormat().table_properties;return null==n?void 0:n.filter((({property:e})=>e in o)).map((({property:e})=>e))}(x):void 0),[x]),I=(0,s().ZC)(k),T=(0,n.useCallback)((e=>{y().default.updatePreviewCollectionContextStore(e)}),[]);A(),function(){const{viewTemplateId:e,collectionViewBlockStore:t,collectionContextStore:o}=(0,l().K8)((()=>{var e;const t=y().default.state;return t.open&&t.collectionTemplate&&null!==(e=t.previewCollectionInfo)&&void 0!==e&&e.collectionContextStore?{viewTemplateId:t.previewCollectionInfo.focusViewTemplateId,collectionViewBlockStore:t.previewCollectionInfo.collectionViewBlockStore,collectionContextStore:t.previewCollectionInfo.collectionContextStore}:{viewTemplateId:void 0,collectionViewBlockStore:void 0,collectionContextStore:void 0}}),[]),r=(0,s().ZC)(e),c=(0,i().v3)();(0,n.useEffect)((()=>{var n;if(e===r)return;if((null==o||null===(n=o.collectionViewStore())||void 0===n||null===(n=n.getFormat().workflow_template_instance)||void 0===n?void 0:n.template_id)===e)return;const i=null==t?void 0:t.getCollectionViewStores().find((t=>{var o;return(null===(o=t.getFormat().workflow_template_instance)||void 0===o?void 0:o.template_id)===e}));i&&o&&(0,g().t)({environment:c,collectionContextStore:o,collectionViewId:i.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1})}),[e,r,t,o,c])}(),(0,n.useEffect)((()=>{!function({collectionContextStore:e,previousPropertyIds:t,propertyIds:o,environment:n}){const i=null==e?void 0:e.collectionViewStore(),l=e&&"table"===(null==i?void 0:i.getType())&&o&&t&&o!==t;if(!l)return;if(o.length===t.length)return;if(o.length<t.length){const i=t.findIndex((e=>!o.includes(e)));q({propertyId:0===i?o[0]:o[i-1],collectionContextStore:e,environment:n})}else{const i=o.filter((e=>!t.includes(e)));q({propertyId:i[i.length-1],collectionContextStore:e,environment:n})}}({collectionContextStore:b,previousPropertyIds:I,propertyIds:k,environment:o})}),[b,I,k,o]);const j=(0,r().IS)((e=>({container:{position:"relative",backgroundColor:e.background.primary,paddingTop:v,overflowY:"auto",borderRadius:12,border:`1px solid ${e.border.primary}`},titleWrapper:{display:"flex",alignItems:"center",paddingInlineStart:f?v+10:v+8,margin:"8px 0"},titleText:{fontSize:24,fontWeight:700,lineHeight:"26px",whiteSpace:"pre-line",marginInlineStart:12,overflow:"initial"},collectionViewScroller:{height:"100%",paddingBottom:v-8}})),[v,f]);return e?(0,$.jsxs)(a().Y1,{height:"fill",style:j.container,children:[(0,$.jsxs)("div",{style:j.titleWrapper,children:[(0,$.jsx)(S().z,{template:e,size:28}),(0,$.jsx)(u().A,{style:j.titleText,children:e.value.targetCollection.name})]}),(0,$.jsx)(p().H,{type:c().A.All,style:j.collectionViewScroller,children:(0,$.jsx)(m().tx,{value:h,children:x?(0,$.jsx)(d().dN,{store:x.collectionViewBlockStore,disabled:!0,productUseCase:"preview_collection",forceLocalQueryCollection:!0,headerActionsBehavior:"hidden",overridePaddingLeft:f?v+4:v,overridePaddingRight:C,setCollectionContextStore:T}):void 0})}),b?(0,$.jsx)(Z,{collectionContextStore:b}):void 0]}):(0,$.jsx)(a().Y1,{height:"fill",style:j.container})}function q({propertyId:e,collectionContextStore:t,environment:o,padding:n=150}){const i=h().A.findTableHeaderCell(t,e);if(!i)return;const l=i.getNode();if(!l)return;const r=(0,v().T8)(l);if(!r)return;const c=l.getBoundingClientRect(),a=r.getBoundingClientRect(),s=c.left-a.left,d=c.right-a.left,p=r.clientWidth;let u;d>p-n?u=d-p+n:s<n&&(u=s-n),u&&f().VG({element:r,environment:o,options:{left:r.scrollLeft+u,behavior:"smooth"}})}},712341:(e,t,o)=>{o.d(t,{Cx:()=>T,Dr:()=>z,If:()=>j,aZ:()=>F,n9:()=>A});var n=o.n(o(794148)),i=o(296540),l=()=>o(564884),r=()=>o(484714),c=()=>o(56366),a=()=>o(401497),s=()=>o(611648),d=()=>o(988083),p=()=>o(699143),u=()=>o(631524),m=()=>o(160432),f=()=>o(493552),v=()=>o(149375),h=()=>o(212050),S=()=>o(69708),g=()=>o(2143),y=()=>o(581495),x=()=>o(953418),w=()=>o(317053),b=()=>o(466934),C=()=>o(458097),k=()=>o(609819),I=o(474848);function T(e){const{sidebar:t,cornerButton:o,preview:n,featuresStep:l}=e,{isPhone:u}=(0,r().Y0)(),m=(0,r().v3)(),f=(0,a().IS)((()=>({scroller:{margin:"0 auto",width:"90%",maxWidth:"100%"}})),[]),v=(0,i.useRef)(null),h=(0,c().K8)((()=>d().A.keyboardHeight()),[]);return(0,i.useEffect)((()=>{h>0&&v.current&&(0,x().$v)({element:v.current,environment:m})}),[h,m]),(0,I.jsxs)(I.Fragment,{children:[o,(0,I.jsx)(p().Y1,{direction:u?"vertical":"horizontal",height:"fill",padding:u?32:24,gap:u?28:24,style:{minHeight:u?"100vh":0},children:u?(0,I.jsxs)(g().H,{type:s().A.Y,style:f.scroller,children:[n?(0,I.jsx)(p().Y1,{width:"fill",height:450,padding:"60px 0 16px 0",style:{maxWidth:u?"100%":400,minHeight:`max(${l?"49vh":"54vh"}, 250px)`},children:n}):void 0,t?(0,I.jsx)(p().Y1,{width:"fill",height:320,gap:25,style:{flexShrink:0,maxWidth:u?"100%":400,minHeight:`max(${l?"51vh":"46vh"}, 250px)`},children:t}):void 0,(0,I.jsx)("div",{ref:v})]}):(0,I.jsxs)(I.Fragment,{children:[t?(0,I.jsx)(p().Y1,{width:320,height:"fill",padding:"60px 0 0 0",gap:25,style:{flexShrink:0},children:t}):void 0,n]})})]})}function j({children:e,overrides:t={hideCornerButton:!1},featuresStep:o}){const{isPhone:n}=(0,r().Y0)(),i=(0,a().IS)((()=>({sidebarFooter:{flexShrink:0,position:"relative",top:n?-16:void 0}})),[n]),l=(0,c().O$)(C().default);if(!l.open||!l.collectionTemplate)return null;const s=(0,I.jsx)(k().Z,{collectionTemplate:l.collectionTemplate,flowId:l.flowId},l.collectionTemplate.setupId);return(0,I.jsx)(T,{sidebar:(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(p().Y1,{height:n?300:"fill",padding:2,children:e}),(0,I.jsx)(p().Y1,{style:i.sidebarFooter,children:(0,I.jsx)(V,{modalState:l})})]}),cornerButton:t.hideCornerButton?null:(0,I.jsx)(z,{modalState:l}),preview:s,featuresStep:o})}const P=!1;function V({modalState:e}){const t=(0,S().tz)(),{isPhone:o}=(0,r().Y0)(),{isOnFirstModalStep:n,isOnLastModalStep:i}=(0,c().K8)((()=>({isOnFirstModalStep:!(0,b().pp)(e,o),isOnLastModalStep:!(0,b().Rh)(e,o)})),[e,o]),l=(0,c().K8)((()=>{if(e.isSaving)return!1;const{setupGenerator:t}=e;return!t||(!e.isFollowUpInputFocused||!t.store.derivedUiStore.getState().canFollowUp)&&!t.store.state.isBusy}),[e]);if(!e.collectionTemplate)return null;const a=t.formatMessage({id:"workflowTemplatesOnboardingModalStep.getStarted",defaultMessage:"Get started"}),s=n&&i;return i?(0,I.jsx)(_,{disabled:!l,label:s?a:(0,I.jsx)(S().sA,{id:"workflowTemplatesOnboardingModalStep.done",defaultMessage:"Done"})}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(B,{disabled:!l,modalState:e,label:n?a:t.formatMessage({id:"workflowTemplatesOnboardingModalStep.continue",defaultMessage:"Continue"})}),P&&!s?(0,I.jsx)(M,{}):void 0]})}function B({modalState:e,label:t,isLoading:o,disabled:n,onClick:i}){const c=(0,a().IS)((()=>({button:{padding:10,width:"100%",height:32,borderRadius:8}})),[]),s=(0,r().v3)(),{isPhone:d}=(0,r().Y0)();return e.collectionTemplate?(0,I.jsx)(m().A,{colorPalette:"blue",style:c.button,isLoading:o,disabled:n,onClick:async()=>{C().default.update((e=>({...e,isSaving:!0})));const t=await(null==i?void 0:i());if(C().default.update((e=>({...e,isSaving:!1}))),!1===t)return;const o=(0,b().aO)(e,d);o>=0&&((0,l().u)({environment:s,event:{eventName:"workflow_template_onboarding_next_step",eventProperties:{next_step:(0,b().Wm)(e)[o],step:(0,b().hq)(e),...(0,b().gM)(e)}}}),C().default.update((e=>({...e,currentStepIndex:o}))))},children:t}):null}function M(){const e=(0,r().v3)(),t=(0,c().O$)(C().default);return n()(t.open,"Modal should always be open for this to render."),(0,I.jsx)(u().p,{colorPalette:"gray",style:{height:32,borderRadius:8,justifyContent:"center",marginTop:8},isLoading:t.isSaving,disabled:t.isSaving,onClick:()=>(0,w().createCollectionTemplateFromModalState)({environment:e,modalState:t}),children:(0,I.jsx)("span",{children:"Customize later"})})}function _(e){const{label:t,disabled:o}=e,l=(0,r().v3)(),a=(0,c().O$)(C().default);n()(a.open,"Modal should always be open for this to render.");const s=(0,i.useCallback)((()=>{(0,w().createCollectionTemplateFromModalState)({environment:l,modalState:a})}),[l,a]);return(0,I.jsx)(m().A,{colorPalette:"blue",style:{height:32,borderRadius:8},isLoading:a.isSaving,disabled:o,onClick:s,children:t})}function F({title:e,caption:t}){var o;const n=(0,c().O$)(C().default),i=n.open?null===(o=n.collectionTemplate)||void 0===o?void 0:o.value.targetCollection.name:void 0,l=(0,a().IS)((e=>({title:{whiteSpace:"pre-line",hangingPunctuation:"first",textWrap:"balance"}})),[]);return(0,I.jsx)("div",{style:{flexShrink:0},children:(0,I.jsxs)(p().Y1,{gap:4,children:[(0,I.jsx)(f().D,{styleKey:"Title-lg/Semibold",style:l.title,children:e??(0,I.jsx)(S().sA,{id:"workflowTemplatesOnboardingModal.customizeCollection",defaultMessage:"Customize {collectionName}",values:{collectionName:i}})}),t?(0,I.jsx)(f().D,{styleKey:"Body/Regular",colorVariant:"secondary",children:t}):null]})})}function z(e){const{modalState:t}=e;return 0===t.currentStepIndex?(0,I.jsx)(R,{}):(0,I.jsx)(O,{modalState:t})}function A(e){const{iconFn:t,onClick:o,style:n}=e,{isPhone:i}=(0,r().Y0)(),l=(0,r().v3)(),s=(0,c().K8)((()=>l.WindowSizeStore.isLandscape()),[l.WindowSizeStore]),d=(0,a().IS)((e=>({button:{position:"absolute",top:i&&!s?56:20,insetInlineStart:20,zIndex:1,height:26,paddingInlineStart:5,paddingInlineEnd:5,...n},icon:{width:i?20:16,height:i?20:16,fill:e.icon.secondary}})),[i,s,n]);return(0,I.jsx)(u().p,{onClick:o,style:d.button,children:t(d.icon)})}function R(){const e=(0,i.useContext)(y().eh);return(0,I.jsx)(A,{iconFn:h().u,onClick:()=>null==e?void 0:e()})}function O(e){const{modalState:t,style:o}=e,n=(0,r().v3)(),{isPhone:c}=(0,r().Y0)(),a=(0,i.useCallback)((()=>{const e=t.currentStepIndex,o=Math.max(0,t.currentStepIndex-1);(0,w().moveToPreviousOnboardingStep)(c),(0,l().u)({environment:n,event:{eventName:"workflow_template_onboarding_previous_step",eventProperties:{previous_step:(0,b().Wm)(t)[o],step:(0,b().Wm)(t)[e],...(0,b().gM)(t)}}})}),[n,t,c]);return t.collectionTemplate?(0,I.jsx)(A,{style:o,iconFn:v().v,onClick:a}):null}},902842:(e,t,o)=>{o.d(t,{n:()=>k,z:()=>b});o(16280),o(296540);var n=()=>o(56366),i=()=>o(401497),l=()=>o(252291),r=()=>o(663077),c=()=>o(632625),a=()=>o(852424),s=()=>o(278238),d=()=>o(529099),p=()=>o(167170),u=()=>o(199483),m=()=>o(235773),f=()=>o(534177),v=()=>o(745266),h=()=>o(231314),S=()=>o(3486),g=()=>o(913454),y=o(474848);const x=16;function w({icon:e,theme:t,size:o,style:n}){const l=(0,i().IS)((t=>({icon:{fill:(0,S()._)(e,t),...n}})),[e,n]);return(0,y.jsx)(c().p,{icon:e,theme:t,size:o,style:l.icon})}function b({template:e,size:t,iconStyle:o}){var n;const c=t??x,a=(0,i().IS)((()=>({icon:{width:c,height:c,...o}})),[c,o]),h=(0,i().DP)();if((0,r().cB)(e.templateId))return(0,d().aiFaceIcon)(a.icon);const{type:S}=e;switch(S){case"property":return(0,y.jsx)(C,{template:e,iconSize:c,styles:a});case"collection_view":return(0,y.jsx)(v().h,{viewIcon:null===(n=e.value.format)||void 0===n?void 0:n.collection_view_icon,viewType:e.value.type,color:"lightGray",style:a.icon});case"layout":return(0,y.jsx)(l().I,{style:a.icon,icon:p()._});case"block":return(0,y.jsx)(y.Fragment,{children:(0,m().notionTemplateTintableIcon)(a.icon)});case"collection":case"compound":const t="collection"===e.type?e.value.targetCollection.icon:e.icon;if(!(0,s().T8)(t))throw new Error("Only Notion static icons are allowed for template icons");return(0,y.jsx)(w,{icon:t,theme:h,size:c,style:a.icon});case"automation":return(0,y.jsx)(y.Fragment,{children:(0,u().o)(a.icon)});default:(0,f().HB)(S)}}function C({template:e,iconSize:t,styles:o}){const l=(0,i().DP)(),r=(0,n().K8)((()=>{const{relatedCollectionTemplateId:t}=e;if("relation"===e.value.type&&t){return g().globalWorkflowTemplates.fromIdOfType({templateId:t,type:"collection"}).value.targetCollection.icon}return e.value.icon}),[e]);return(0,y.jsx)(a().zB,{type:e.value.type,icon:r,size:t,style:o.icon,theme:l})}function k({template:e,backgroundSize:t}){const o=(0,i().IS)((t=>({iconContainer:{background:I({theme:t,template:e})[30]},icon:{fill:I({theme:t,template:e})[400]}})),[e]);return(0,y.jsx)(h().y,{backgroundColor:o.iconContainer.background,backgroundSize:t,icon:(0,y.jsx)(b,{template:e,iconStyle:o.icon})})}function I({theme:e,template:t}){const{type:o}=t;switch(o){case"collection_view":case"automation":return e.palette.blue;case"property":return"relation"===t.value.type?e.palette.yellow:e.palette.red;case"layout":return e.palette.orange;case"block":return e.palette.purple;case"compound":return e.palette.green;case"collection":return e.palette.pink;default:(0,f().HB)(o)}}}}]);