"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[15517],{3284:(e,t,o)=>{o.r(t),o.d(t,{arrowSquarePathUpDownIcon:()=>n,iconDefinition:()=>r});o(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"0.64 3.12 18.71 13.76",svg:(0,o(474848).jsx)("path",{d:"M6.475 3.125a.625.625 0 1 0 0 1.25h7.975c.65 0 1.175.526 1.175 1.175v6.057l-1.408-1.408a.625.625 0 1 0-.884.884l2.475 2.475a.625.625 0 0 0 .884 0l2.475-2.475a.625.625 0 0 0-.884-.884l-1.408 1.408V5.55a2.425 2.425 0 0 0-2.425-2.425zM3.308 6.442a.625.625 0 0 1 .884 0l2.475 2.475a.625.625 0 1 1-.884.884L4.375 8.393v6.057c0 .649.526 1.175 1.175 1.175h7.975a.625.625 0 0 1 0 1.25H5.55a2.425 2.425 0 0 1-2.425-2.425V8.393L1.717 9.801a.625.625 0 1 1-.884-.884z"})},n=(0,o(340498).wt)("arrowSquarePathUpDown",r)},150987:(e,t,o)=>{o.d(t,{A:()=>f});o(898992),o(354520),o(581454),o(737550);var r=o.n(o(844751)),n=o(296540),i=()=>o(898244),l=()=>o(713998),a=()=>o(69708),s=()=>o(496603),c=()=>o(722872),d=()=>o(939740),p=()=>o(89924),u=()=>o(250202),x=o(474848);const f=function({selectedProperty:e,onAccept:t,schema:f,onClose:h,allowProperty:g,isRelationProperty:m}){const y=(0,o(484714).v3)(),v=(0,a().tz)(),[S,C]=(0,n.useState)("");let j=Object.keys(f);const b=j.some(o(443239).u);j=s().Ul(j,(e=>{const t=(0,l()._g)({schema:f,property:e});return t?t.name:""}));const M=b?i().Ho:i().rn;if(j=s().FF(j,M),j.unshift(M),g&&(j=j.filter((e=>{const t=(0,l()._g)({schema:f,property:e});return t&&g(t)}))),S){let e=j.map((e=>{const t=(0,l()._g)({schema:f,property:e});return t&&t.name}));e=r().filter(S,e).map((({original:e})=>e)),j=j.filter((t=>{const o=(0,l()._g)({schema:f,property:t});return o&&o.name&&e.includes(o.name)}))}const w=S||j.length>o(527438).R8,A=s().oE(j.map((o=>{const r=(0,l()._g)({schema:f,property:o});if(!r)return null;return{key:o,render:t=>(0,x.jsx)(u().G,{...t,propertySchema:r,format:u().e.Name,isChecked:o===e}),action:()=>t(o)}}))),V=[{key:0,render:e=>(0,x.jsx)(p().A,{...e}),items:A}],{device:T}=y,F=w?(0,x.jsx)(p().A,{isInput:!0,children:(0,x.jsx)(o(419357).Ay,{focus:!T.isMobile||void 0,focusAfterAnimation:!0,value:S,onChange:e=>C(e.target.value),placeholder:m?v.formatMessage({defaultMessage:"Search for a relation property…",id:"propertySelectMenu.searchForProperty.relation.placeholder"}):v.formatMessage({defaultMessage:"Search for a property…",id:"propertySelectMenu.searchForProperty.default.placeholder"})})}):null;let I;return I=T.isMobile?{menuType:c().gu.Modal,title:m?v.formatMessage({defaultMessage:"Relation property",id:"propertySelectMenu.mobileMenu.relationProperty.header"}):v.formatMessage({defaultMessage:"Property",id:"propertySelectMenu.mobileMenu.property.header"}),right:(0,x.jsx)(o(45552).CancelMenuText,{}),onClickRight:h,header:F}:{menuType:c().gu.Popup,width:280,maxHeight:480,header:F},(0,x.jsx)(o(404277).A,{...I,children:0===A.length?(0,x.jsx)(p().A,{children:(0,x.jsx)(o(64e3).A,{title:(0,x.jsx)(a().sA,{defaultMessage:"No results",id:"propertySelectMenu.search.noResults.title"})})}):(0,x.jsx)(d().Ay,{type:d().Oh.Vertical,sections:V,onAccept:h,initialFocus:S.length>0?0:void 0})})}},170356:(e,t,o)=>{o.d(t,{NS:()=>p,Pq:()=>f,Z3:()=>d,sw:()=>u});o(296540);var r=()=>o(484714),n=()=>o(297872),i=()=>o(404277),l=()=>o(678553),a=()=>o(45552),s=()=>o(722872),c=o(474848);const d=8,p=8,u=32,x={height:u+d-2,paddingTop:d-2};function f({title:e,helpButton:t,onCancel:o,desktopMinWidth:l,desktopMaxWidth:d,desktopWidth:p,children:u}){const{device:x}=(0,r().v3)();return(0,c.jsx)(n().A,{capture:!0,allowEsc:!0,allowUndo:!0,render:r=>{let n;return n=x.isMobile?{menuType:s().gu.Modal,title:e,right:(0,c.jsx)(a().DoneMenuText,{}),onClickRight:o,...r}:{menuType:s().gu.Popup,...l&&{minWidth:l},...d&&{maxWidth:d},...p&&{width:p},...r},(0,c.jsx)(i().A,{...n,header:e&&(0,c.jsx)(h,{title:e,helpButton:t}),children:u})}})}function h({title:e,helpButton:t}){return(0,r().v3)().device.isMobile?null:(0,c.jsx)(l().Ay,{style:x,title:e,right:t})}},184979:(e,t,o)=>{o.d(t,{tY:()=>Y,tv:()=>W,G$:()=>N});o(944114),o(898992),o(354520),o(430670),o(581454);var r=o(296540),n=()=>o(484714),i=()=>o(401497),l=()=>o(252291),a=()=>o(30537),s=()=>o(214388),c=()=>o(3284),d=()=>o(668725),p=()=>o(30626),u=()=>o(764781),x=()=>o(617668),f=()=>o(904789),h=()=>o(236262),g=()=>o(69708),m=()=>o(496603),y=()=>o(534177),v=()=>o(436696),S=()=>o(755022),C=()=>o(170356),j=()=>o(274652),b=()=>o(760217),M=()=>o(406699),w=()=>o(44935),A=()=>o(285790),V=()=>o(404277),T=()=>o(939740),F=()=>o(45552),I=()=>o(89924),P=()=>o(125565),_=()=>o(722872),k=()=>o(463830),O=()=>o(790515),R=()=>o(649746),z=()=>o(360843),B=()=>o(108791),D=()=>o(933117),G=()=>o(272630),U=o(474848);const K=(0,g().YK)({operatorPlaceholder:{defaultMessage:"Operator",id:"database.filterMenu.operatorPlaceholder"}});function E(e){const{filterOperator:t,onChange:o,disableMargins:r}=e,n=(0,g().tz)(),i={width:"auto",menuTitle:n.formatMessage({defaultMessage:"Operator",id:"database.filterMenu.filterOperatorMenu.title"}),items:s().Ak,getKey:e=>e,selectedItem:t,onSelect:o,renderItem:e=>(0,U.jsx)(b().A,{title:(0,R().Az)(e.value,n),caption:(0,R().YL)(e.value,n),...e}),renderOrigin:e=>(0,U.jsx)(G().A,{...e,title:t&&(0,R().Az)(t,n),placeholder:n.formatMessage(K.operatorPlaceholder),disableMargins:r})};return(0,U.jsx)(D().A,{...i,menuTypeOverride:(0,_().PK)()},"operator")}const H=60,$=120,L=110,N=170,W=400;function Y(e){const{combinatorFilter:t,index:o,level:i,schema:l,onChange:a,parentStore:c,collectionContextStore:d,collectionViewType:p,collectionViewId:u}=e,x=(0,n().Y0)(),f=(0,r.useRef)([]),h=(t.filters??[]).flatMap((e=>(0,s().LB)(e)?[]:[e]));return(0,U.jsxs)(r.Fragment,{children:[xe(t,i)?void 0:(0,U.jsx)("div",{style:x.isMobile?void 0:{display:"grid",gridTemplateColumns:`\n             [boolean-start] ${H}px\n             [boolean-end property-start] minmax(min-content, ${$}px)\n             [property-end operator-start] ${L}px\n             [operator-end value-start] auto\n             [value-end menu-start] ${C().sw}px\n             [menu-end]\n        `,gridAutoRows:`minmax(${C().sw}px, auto)`,gridColumnGap:C().NS,gridRowGap:C().Z3,padding:`${C().Z3}px ${C().NS}px 0 ${C().NS}px`,justifyItems:"stretch",alignItems:"start"},children:h.map(((o,r)=>(0,U.jsx)(q,{childFilter:o,newIndex:r,schema:l,level:i,combinatorFilter:t,onChange:a,index:e.index,collectionContextStore:d,collectionViewType:p,buttonPopupStores:f.current,parentStore:c,collectionViewId:u},r)))}),(0,U.jsx)(ee,{schema:l,level:i,combinatorFilter:t,onChange:a,index:o,buttonPopupStores:f.current,collectionContextStore:d,collectionViewType:p})]})}function q(e){const{childFilter:t,newIndex:o,...r}=e,i=(0,n().Y0)();return(0,s().dU)(t)?i.isMobile?(0,U.jsx)(Q,{childFilter:t,newIndex:o,...r}):(0,U.jsx)(J,{childFilter:t,newIndex:o,...r}):(0,s().yX)(t)?i.isMobile?(0,U.jsx)(Z,{childFilter:t,newIndex:o,...r}):(0,U.jsx)(X,{childFilter:t,newIndex:o,...r}):null}function X(e){const{newIndex:t,childFilter:o}=e;return(0,U.jsxs)(r.Fragment,{children:[(0,U.jsx)(z().A,{index:t,propertyFilter:o,schema:e.schema,filterOperator:(0,U.jsx)(ve,{combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,newIndex:t}),parentStore:e.parentStore,onChange:(t,o)=>me(t,o,e.combinatorFilter,e.onChange,e.index),collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId},t),(0,U.jsx)(te,{filter:o,indexToChange:t,level:e.level,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,buttonPopupStores:e.buttonPopupStores})]},t)}function Z(e){const{childFilter:t,newIndex:o}=e;return(0,U.jsxs)(r.Fragment,{children:[(0,U.jsx)(ve,{combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,newIndex:o}),(0,U.jsxs)(I().A,{title:(0,U.jsx)(g().sA,{defaultMessage:"Filter {index}",id:"database.filterMenu.filterIndex",values:{index:o+1}}),children:[(0,U.jsx)(z().A,{index:o,propertyFilter:t,schema:e.schema,filterOperator:null,parentStore:e.parentStore,onChange:(t,o)=>me(t,o,e.combinatorFilter,e.onChange,e.index),collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId},o),(0,U.jsx)(te,{filter:t,indexToChange:o,level:e.level,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,buttonPopupStores:e.buttonPopupStores})]})]},o)}function J(e){const{newIndex:t,childFilter:o}=e,n=(0,i().IS)((e=>({wrapperStyles:{gridColumn:"property-start / value-end",...ge(e)}})),[]);return(0,U.jsxs)(r.Fragment,{children:[(0,U.jsx)(ve,{combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,newIndex:t}),(0,U.jsx)("div",{style:n.wrapperStyles,children:(0,U.jsx)(Y,{index:t,level:e.level+1,combinatorFilter:o,onChange:(t,o)=>me(t,o,e.combinatorFilter,e.onChange,e.index),parentStore:e.parentStore,schema:e.schema,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId})}),(0,U.jsx)(te,{filter:o,indexToChange:t,level:e.level,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,buttonPopupStores:e.buttonPopupStores})]},t)}function Q(e){const{childFilter:t,newIndex:o}=e,n=(t.filters||[]).length,i=(0,U.jsx)(g().sA,{defaultMessage:"Filter Group {index}",id:"database.filterMenu.filterGroupIndex",values:{index:o+1}});return(0,U.jsxs)(r.Fragment,{children:[(0,U.jsx)(ve,{combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,newIndex:o}),(0,U.jsxs)(I().A,{title:i,children:[(0,U.jsx)(M().A,{buttonPopupStore:le(o,e.buttonPopupStores),popupType:M().z.SlideUp,renderOrigin:o=>(0,U.jsx)(b().A,{focused:!1,...o,showExtensionArrow:!0,right:n.toString(),title:(0,R().Dz)({filter:t,schema:e.schema})}),render:r=>(0,U.jsx)(V().A,{menuType:_().gu.Modal,title:i,left:(0,U.jsx)(F().BackMenuText,{}),onClickLeft:r.close,children:(0,U.jsx)(Y,{index:o,level:e.level+1,combinatorFilter:t,onChange:(t,o)=>me(t,o,e.combinatorFilter,e.onChange,e.index),parentStore:e.parentStore,schema:e.schema,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId})})}),(0,U.jsx)(te,{filter:t,indexToChange:o,level:e.level,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,buttonPopupStores:e.buttonPopupStores})]})]},o)}function ee(e){const t=(0,n().v3)(),o=(0,n().Y0)(),{schema:r,level:l,combinatorFilter:s,onChange:c,index:p,buttonPopupStores:u,collectionContextStore:x,collectionViewType:f}=e,h=(0,i().IS)((()=>({buttonMenuItemStyles:{height:32}})),[]);return o.isMobile?(0,U.jsxs)(I().A,{topBorder:xe(s,l),children:[(0,U.jsx)(fe,{props:{onClick:()=>ye(t,r,s,c,p,x,f)}}),de(e.level)?(0,U.jsx)(he,{props:{onClick:()=>ne(t,r,s,c,p,x,f,u)}}):void 0]}):de(l)?(0,U.jsx)(I().A,{topBorder:xe(s,l),children:(0,U.jsx)(M().A,{alignmentToOrigin:"start",popupType:a().n.Popup,renderOrigin:e=>(0,U.jsx)(w().H,{action:()=>e.onClick(),render:t=>{const{focused:o,...r}=t;return(0,U.jsx)(j().o,{...e,...r,focused:o,color:"secondary",style:h.buttonMenuItemStyles,title:(0,U.jsxs)("div",{children:[(0,U.jsx)(B().Kp,{}),(0,d().b)({width:10,marginInlineStart:6,display:"inline"})]})})}}),render:e=>(0,U.jsx)(T().Ay,{type:T().Oh.Vertical,initialFocus:0,sections:[{key:"actions",render:e=>(0,U.jsx)(I().A,{...e}),items:[{key:"add_filter",render:e=>(0,U.jsx)(fe,{props:e}),action:o=>{e.close(),ye(t,r,s,c,p,x,f)}},{key:"add_filter_group",render:e=>(0,U.jsx)(he,{props:e}),action:o=>{e.close(),ne(t,r,s,c,p,x,f,u)}}]}]})})}):(0,U.jsx)(I().A,{topBorder:xe(s,l),children:(0,U.jsx)(w().H,{action:()=>ye(t,e.schema,e.combinatorFilter,e.onChange,e.index,e.collectionContextStore,e.collectionViewType),render:e=>{const{focused:o,...n}=e;return(0,U.jsx)(j().o,{...n,focused:e.focused,color:"secondary",style:h.buttonMenuItemStyles,onClick:()=>ye(t,r,s,c,p,x,f),title:(0,U.jsx)(B().Kp,{})})}})})}function te(e){const t=(0,n().Y0)(),o=(0,g().tz)();return t.isMobile?(0,U.jsx)(oe,{filter:e.filter,indexToChange:e.indexToChange,level:e.level,parent:void 0,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,buttonPopupStores:e.buttonPopupStores,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType}):(0,U.jsx)(M().A,{popupType:a().n.Popup,renderOrigin:e=>(0,U.jsx)(w().H,{action:()=>e.onClick(),render:e=>(0,U.jsx)(A().A,{...e,hovered:e.focused,style:{width:"100%",height:32},icon:p()._,ariaLabel:o.formatMessage({id:"collections.CollectionFilterCombinatorGrid.RowActions.threeDotActionMenu",defaultMessage:"Edit filter actions"})})}),render:t=>(0,U.jsx)(oe,{filter:e.filter,indexToChange:e.indexToChange,level:e.level,parent:t,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,buttonPopupStores:e.buttonPopupStores,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType})})}function oe(e){const{filter:t,indexToChange:o,parent:r}=e,i=(0,n().v3)(),a=(0,n().Y0)(),d=(0,s().dU)(t),p=d?(0,U.jsx)(g().sA,{defaultMessage:"Remove",id:"database.filterMenu.removeFilterGroupMenuTitle"}):(0,U.jsx)(g().sA,{defaultMessage:"Remove",id:"database.filterMenu.removeFilterMenuTitle"}),x=d?(0,U.jsx)(g().sA,{defaultMessage:"Duplicate",id:"database.filterMenu.duplicateFilterGroupMenuTitle"}):(0,U.jsx)(g().sA,{defaultMessage:"Duplicate",id:"database.filterMenu.duplicateFilterMenuTitle"}),f=[{key:"delete",action:()=>{var t,n,i,l,a;r&&r.close(),t=o,n=e.buttonPopupStores,i=e.combinatorFilter,l=e.onChange,a=e.index,ue((e=>e.splice(t,1)),i,l,a),le(t,n).reset(),n.splice(t,1)},render:e=>(0,U.jsx)(b().A,{...e,icon:(0,U.jsx)(l().I,{icon:h().trashIcon}),isRedOnHover:!0,title:p})},{key:"duplicate",action:()=>{r&&r.close(),function(e,t,o,r,n,i,l){ue((t=>{const o=t[e];if(o){const r={...o};t.splice(e,0,r)}}),t,o,r),n?(0,v().X)({environment:l,collectionContextStore:n,action:"add_filter_group"}):(0,S().D)(l,{view_type:i,action:"duplicate_filter"})}(o,e.combinatorFilter,e.onChange,e.index,e.collectionContextStore,e.collectionViewType,i)},render:e=>(0,U.jsx)(b().A,{...e,icon:(0,U.jsx)(l().I,{icon:u().V}),title:x})}];if((0,s().yX)(t)&&de(e.level)&&f.push({key:"turn_into_group",action:()=>{r&&r.close(),re(i,o,t,e.combinatorFilter,e.onChange,e.index,e.buttonPopupStores,e.collectionContextStore,e.collectionViewType)},render:e=>(0,U.jsx)(b().A,{...e,icon:(0,U.jsx)(l().I,{icon:c().arrowSquarePathUpDownIcon}),title:(0,U.jsx)(g().sA,{defaultMessage:"Turn into group",id:"database.filterMenu.turnIntoGroupMenuTitle"})})}),(0,s().dU)(t)&&t.filters&&1===t.filters.length){const n=(0,s().dU)(t.filters[0])?(0,U.jsx)(g().sA,{defaultMessage:"Unwrap group",id:"database.filterMenu.unwrapGroupMenuTitle"}):(0,U.jsx)(g().sA,{defaultMessage:"Turn into filter",id:"database.filterMenu.turnIntoFilterMenuTitle"});f.push({key:"turn_into_filter",action:()=>{r&&r.close(),function(e,t,o,r,n,i,l,a){const c=m().$1(t.filters||[]);c&&!(0,s().LB)(c)&&me(e,c,r,n,i);l?(0,v().X)({environment:o,collectionContextStore:l,action:"turn_into_filter"}):(0,S().D)(o,{view_type:a,action:"turn_into_filter"})}(o,t,i,e.combinatorFilter,e.onChange,e.index,e.collectionContextStore,e.collectionViewType)},render:e=>(0,U.jsx)(b().A,{...e,icon:(0,U.jsx)(l().I,{icon:c().arrowSquarePathUpDownIcon}),title:n})})}const y=ae(t);return(0,s().dU)(t)&&e.level+y+1<3&&f.push({key:"wrap_in_group",action:()=>{r&&r.close(),re(i,o,t,e.combinatorFilter,e.onChange,e.index,e.buttonPopupStores,e.collectionContextStore,e.collectionViewType)},render:e=>(0,U.jsx)(b().A,{...e,icon:(0,U.jsx)(l().I,{icon:c().arrowSquarePathUpDownIcon}),title:(0,U.jsx)(g().sA,{defaultMessage:"Wrap in group",id:"database.filterMenu.wrapInGroupMenuTitle"}),caption:(0,U.jsx)(g().sA,{defaultMessage:"Create a filter group around this",id:"database.filterMenu.wrapInGroupMenuCaption"})})}),(0,U.jsx)(T().Ay,{initialFocus:a.isMobile?void 0:0,type:T().Oh.Vertical,sections:[{key:"actions",render:a.isMobile?e=>(0,U.jsx)("div",{...e}):e=>(0,U.jsx)(I().A,{...e}),items:f}]})}function re(e,t,o,r,n,i,l,a,s){me(t,{operator:ce(r),filters:[o]},r,n,i),ie(t,l),a?(0,v().X)({environment:e,collectionContextStore:a,action:"turn_into_filter_group"}):(0,S().D)(e,{view_type:s,action:"turn_into_filter_group"})}function ne(e,t,o,r,n,i,l,a){const s=pe(t,o),c={operator:ce(o),filters:[s]};ie(ue((e=>e.push(c)),o,r,n)-1,a),i?(0,v().X)({environment:e,collectionContextStore:i,action:"add_filter_group"}):(0,S().D)(e,{view_type:l,action:"add_filter_group"})}function ie(e,t){le(e,t).setState({open:!0})}function le(e,t){for(;t.length<e+1;){const e=new(k().A);t.push(e)}return t[e]}function ae(e){if((0,s().dU)(e)){const t=(e.filters||[]).filter(s().dU);return 1+(m().T9(t.map(ae))||0)}return 0}function se(e){const{operator:t,lowercase:o}=e;return"or"===t?o?(0,U.jsx)(g().sA,{id:"collectionFilterCombinatorGrid.filterOperator.or.lowercase",defaultMessage:"or"}):(0,U.jsx)(g().sA,{id:"collectionFilterCombinatorGrid.filterOperator.or",defaultMessage:"Or"}):"and"===t?o?(0,U.jsx)(g().sA,{id:"collectionFilterCombinatorGrid.filterOperator.and.lowercase",defaultMessage:"and"}):(0,U.jsx)(g().sA,{id:"collectionFilterCombinatorGrid.filterOperator.and",defaultMessage:"And"}):(0,y().HB)(t)}function ce(e){return"or"===e.operator?"and":"or"}function de(e){return e<2}function pe(e,t){const o=(t.filters||[]).filter(s().yX),r=o[o.length-1];return r?m().mg(r):(0,O().MI)(e)}function ue(e,t,o,r){const n=[...t.filters||[]],i=e(n);return o(r,{...t,filters:n}),i}function xe(e,t){return(0,s().U0)(e)&&0===t}function fe({props:e}){const t=(0,U.jsx)(l().I,{icon:x().plusIcon});return(0,U.jsx)(b().A,{focused:!1,...e,icon:t,title:(0,U.jsx)(B().Kp,{})})}function he({props:e}){const t=(0,U.jsx)(l().I,{icon:f().squareOnSquarePlusIcon});return(0,U.jsx)(b().A,{focused:!1,...e,icon:t,title:(0,U.jsx)(g().sA,{defaultMessage:"Add filter group",id:"database.filterMenu.addFilterGroup2ButtonTitle"}),caption:(0,U.jsx)(g().sA,{defaultMessage:"A group to nest more filters",id:"database.filterMenu.addFilterGroupButtonCaption"})})}function ge(e){return{background:e.filterGroupBackground,borderRadius:6,boxShadow:`0 0 0 1px ${e.filterGroupBorder}`,margin:1,alignSelf:"stretch"}}function me(e,t,o,r,n){ue((o=>o.splice(e,1,t)),o,r,n)}function ye(e,t,o,r,n,i,l){const a=pe(t,o);ue((e=>e.push(a)),o,r,n),i?(0,v().X)({environment:e,collectionContextStore:i,action:"add_filter"}):(0,S().D)(e,{view_type:l,action:"add_filter"})}function ve({newIndex:e,combinatorFilter:t,onChange:o,index:r,collectionContextStore:i,collectionViewType:l}){const a=(0,n().v3)(),s=t.operator,{device:c}=a,d={justifySelf:"end"},p={...d,lineHeight:"32px",paddingInlineEnd:4};if(0===e)return c.isMobile?null:(0,U.jsx)(P().A,{style:p,children:(0,U.jsx)(g().sA,{defaultMessage:"Where",id:"database.filterMenu.where"})});if(1===e){const e=(0,U.jsx)(E,{disableMargins:!0,filterOperator:s,onChange:e=>function(e,t,o,r,n,i,l){r(n,{...o,operator:e}),i?(0,v().X)({environment:t,collectionContextStore:i,action:"set_filter_operator"}):(0,S().D)(t,{view_type:l,action:"set_filter_operator"})}(e,a,t,o,r,i,l)});return a.device.isMobile?(0,U.jsx)(I().A,{children:e}):(0,U.jsx)("div",{style:d,children:e})}return c.isMobile?null:(0,U.jsx)(P().A,{style:p,children:(0,U.jsx)(se,{operator:s})})}},250202:(e,t,o)=>{o.d(t,{G:()=>a,e:()=>l});var r=o(296540),n=()=>o(401497),i=o(474848);let l=function(e){return e[e.Name=0]="Name",e}({});const a=r.forwardRef((function(e,t){const{propertySchema:r,format:a}=e,{name:s,type:c,icon:d}=r,{isMobile:p}=(0,o(484714).Y0)(),u=(0,n().IS)((e=>({propertyIcon:{fill:e.icon.primary,marginInlineStart:6,marginInlineEnd:2}})),[]),x=(0,n().DP)(),f=a===l.Name?s:o(852353).dC[c];return(0,i.jsx)(o(760217).A,{title:f,icon:(0,i.jsx)(o(852424).zB,{icon:d,type:c,size:p?18:16,theme:x,style:u.propertyIcon}),...e})}))},360843:(e,t,o)=>{o.d(t,{A:()=>z});o(898992),o(354520),o(737550);var r=o(296540),n=()=>o(726637),i=()=>o(484714),l=()=>o(56366),a=()=>o(927826),s=()=>o(478367),c=()=>o(214388),d=()=>o(713998),p=()=>o(329199),u=()=>o(69708),x=()=>o(436696),f=()=>o(755022),h=()=>o(406699),g=()=>o(649746),m=()=>o(754195),y=()=>o(93745),v=()=>o(404070),S=()=>o(760217),C=()=>o(933117),j=()=>o(859428),b=()=>o(125565),M=()=>o(272630),w=()=>o(722872),A=()=>o(553965),V=o(474848);function T(e){const{filter:t}=e,o=(0,u().tz)(),r={width:190,menuTitle:o.formatMessage({defaultMessage:"Date Options",id:"database.filterMenu.mobileDateFilterModeMenu.title"}),items:m().$N,selectedItem:(0,y().C)(t),getKey:e=>e,onSelect:o=>{const r={...t,use_end:(0,v().Z)(o)};e.onChange(r)},renderItem:e=>(0,V.jsx)(j().A,{renderTooltip:()=>(0,g().WG)(e.value),render:t=>(0,V.jsx)(S().A,{title:(0,g().h0)(e.value),...(0,A().A)(e,t)}),placement:"right",textWrap:!0,style:{width:"260px"}}),renderOrigin:e=>(0,V.jsx)(M().A,{...e,placeholder:o.formatMessage({defaultMessage:"Date Options",id:"database.filterMenu.dateFilterModeMenu.label"}),title:(0,V.jsx)(b().A,{isMobile:n().A.isMobile,children:(0,g().h0)((0,y().C)(t))}),disableMargins:!0,desktopStyle:{width:"100px"}})};return(0,V.jsx)(C().A,{...r,menuTypeOverride:(0,w().PK)()},"date-filter-mode")}var F=()=>o(568063),I=()=>o(170356);function P(e){const t=(0,i().v3)(),o=(0,u().tz)(),{filterValueType:r,filter:n}=e,l=(0,c().U6)({filterValueType:r}),a={width:190,menuTitle:o.formatMessage({defaultMessage:"Comparator",id:"database.filterMenu.mobileComparatorValueMenu.title"}),items:l,selectedItem:n.operator,getKey:e=>e,onSelect:o=>{const i=(0,g().iI)(r,n,o,"combinator");e.onChange(i),e.collectionContextStore?(0,x().X)({environment:t,collectionContextStore:e.collectionContextStore,action:"set_filter_comparator"}):(0,f().D)(t,{view_type:e.collectionViewType,action:"set_filter_comparator"})},renderItem:e=>(0,V.jsx)(S().A,{title:(0,g().J)(e.value),...e}),renderOrigin:e=>(0,V.jsx)(M().A,{...e,placeholder:o.formatMessage({defaultMessage:"Comparator",id:"database.filterMenu.comparatorMenuDropdownButton.label"}),title:(0,V.jsx)(b().A,{isMobile:t.device.isMobile,children:(0,g().J)(n.operator)}),disableMargins:!0})};return(0,V.jsx)(C().A,{...a,menuTypeOverride:(0,w().PK)()},"comparator")}var _=()=>o(890801);const k=(0,u().YK)({setFilter:{defaultMessage:"Set filter",id:"database.filterMenu.rollupPropertyValue.mobileMenu.title"}});function O(e){const t=(0,i().v3)(),o=(0,u().tz)();if((0,c().s1)(e.filter))return(0,V.jsx)(R,{intl:o,onChange:e.onChange,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,property:e.property,schema:e.schema,parentStore:e.parentStore,collectionViewId:e.collectionViewId,filter:e.filter});const n=(0,c().HF)({schema:e.schema,property:e.property,getRecordModel:e.parentStore.getRecordModel});if(!(0,c().$S)(n,e.filter)){const t=(0,g().xt)(n);return(0,V.jsxs)(r.Fragment,{children:[(0,V.jsx)(P,{filterValueType:n,filter:t,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,onChange:e.onChange}),(0,V.jsx)(_().A,{filterValueType:n,filter:t,schema:e.schema,property:e.property,parentStore:e.parentStore,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId,onChange:e.onChange})]})}const l=(0,V.jsx)(u().sA,{...g().Jk[n],values:{property:(0,V.jsx)(u().sA,{id:"collectionFilterMenuFilter.property.name",defaultMessage:"Property"}),operator:(0,V.jsx)(P,{filterValueType:n,filter:e.filter,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,onChange:e.onChange}),operatorValue:(0,V.jsx)(_().A,{filterValueType:n,filter:e.filter,schema:e.schema,property:e.property,parentStore:e.parentStore,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId,onChange:e.onChange})}});return t.device.isMobile?l:(0,V.jsx)("div",{style:{alignItems:"center",display:"grid",gridAutoFlow:"column",gridAutoColumns:"1fr",gridColumnEnd:e.isArrayFilter?void 0:"span 2",gridColumnGap:`${I().NS}px`,gridTemplateRows:`${I().sw}px`,gridTemplateColumns:"[value-start] max-content auto [value-end operator-start] auto"},children:l})}function R({filter:e,intl:t,onChange:o,collectionContextStore:n,collectionViewType:a,property:s,schema:d,parentStore:p,collectionViewId:u}){const h=(0,i().v3)(),m={menuTitle:t.formatMessage(k.setFilter),items:c().$X,getKey:e=>e,selectedItem:e.operator,onSelect:t=>{const r={...e,operator:t};o(r),n?(0,x().X)({environment:h,collectionContextStore:n,action:"set_rollup_set_filter"}):(0,f().D)(h,{view_type:a,action:"set_rollup_set_filter"})},renderItem:e=>(0,V.jsx)(S().A,{title:(0,g().wE)(e.value,t),...e}),renderOrigin:o=>(0,V.jsx)(M().A,{...o,placeholder:t.formatMessage(k.setFilter),title:(0,g().wE)(e.operator,t),disableMargins:!0,desktopStyle:{minWidth:70}})},{targetProperty:y,targetCollectionSchema:v}=(0,l().K8)((()=>{var e;if("rollup"===(null==d||null===(e=d[s])||void 0===e?void 0:e.type)){var t;const e=null===(t=p.pointer)||void 0===t?void 0:t.spaceId;if(!e)return{targetProperty:void 0,targetCollectionSchema:void 0};const o=h.idCreator.getSpaceIdCreatorSync(e),r=(0,F().eY)({schema:d,property:s,getRecordModel:p.getRecordModel,spaceIdCreator:o});return"person"===(null==r?void 0:r.rollupType)?{targetProperty:void 0,targetCollectionSchema:void 0}:{targetProperty:null==r?void 0:r.targetProperty,targetCollectionSchema:null==r?void 0:r.targetCollectionSchema}}return{targetProperty:s,targetCollectionSchema:d}}),[s,d,p,h]);if(!y||!v)return(0,V.jsx)("div",{style:{gridColumnEnd:"span 2"}});const j=(0,V.jsxs)(r.Fragment,{children:[(0,V.jsx)(C().A,{...m,menuTypeOverride:(0,w().PK)()},"set_filter"),(0,V.jsx)(O,{collectionViewId:u,filter:e.subfilter,schema:v,property:y,parentStore:p,collectionContextStore:n,collectionViewType:a,onChange:t=>{const r={...e,subfilter:t};o(r)},isArrayFilter:!0})]});return h.device.isMobile?j:(0,V.jsx)("div",{style:{display:"grid",gridAutoFlow:"column",gridAutoColumns:"1fr",gridColumnEnd:"span 2",gridColumnGap:`${I().NS}px`,gridTemplateColumns:"max-content",gridTemplateRows:`${I().sw}px`},children:j})}const z=function({schema:e,propertyFilter:t,parentStore:m,index:y,collectionContextStore:v,collectionViewType:S,onChange:C,filterOperator:j,collectionViewId:b,disablePropertyChange:M=!1}){const w=(0,i().v3)(),A=(0,d()._g)({schema:e,property:t.property}),F=(0,l().K8)((()=>{const e=null==v?void 0:v.collectionViewStore();return null==e?void 0:e.getCollectionSource()}),[v]),I=(0,l().K8)((()=>(0,c().tn)(e,t.property,t.filter,m.getRecordModel)),[m,t,e]);if(!A)return null;if(!I)return null;const P=(0,o(335452).n)(t.filter)&&(0,c().gc)(t.filter)&&(0,o(359889).q)(A),_=P?{width:"120px",marginInlineEnd:"4px"}:{},k=(0,V.jsxs)(r.Fragment,{children:[(0,V.jsx)(h().A,{popupType:n().A.isMobile?h().z.SlideUp:h().z.Popup,renderOrigin:e=>(0,V.jsx)(o(992510).A,{...e,propertySchema:A,disableMargins:!0,disabled:M,textWrapperStyle:{width:"100%",..._}}),disabled:M,render:r=>(0,V.jsx)(o(150987).A,{isRelationProperty:!1,schema:e,onAccept:o=>function(e,t,o,r,n,i,l,d,u){const{property:h,filter:m}=r,y=o[h],v=o[e],S={property:e,filter:m},C=v&&(0,c().tn)(o,e,m,n.getRecordModel),j=v&&"relation"===v.type&&h!==e,b=y&&("created_by"===y.type||"last_edited_by"===y.type)&&v&&"person"===v.type,M=(0,s().I)(m)&&!(0,c().fZ)(m)&&(0,a().W)(m).some((e=>"exact"===e.type&&e.value&&"bot"===e.value.table));var w;(!C||j||b&&M||!(0,p().hs)(S,o))&&(S.filter=(0,g().SN)({schema:o,property:e,getRecordModel:n.getRecordModel,spaceIdCreator:t.idCreator.getSpaceIdCreatorSync((null===(w=n.pointer)||void 0===w?void 0:w.spaceId)??"")}));null==u||u(i,S),l?(0,x().X)({environment:t,collectionContextStore:l,action:"set_filter_property"}):(0,f().D)(t,{view_type:d,action:"set_filter_property"})}(o,w,e,t,m,y,v,S,C),onClose:r.close,allowProperty:e=>(0,d().ah)(e,F)})}),P?(0,V.jsx)(T,{filter:t.filter,onChange:e=>{const o={...t,filter:e};null==C||C(y,o)}}):void 0]});return(0,V.jsxs)(r.Fragment,{children:[j,n().A.isMobile?k:(0,V.jsx)("div",{style:{display:"flex"},children:k}),(0,V.jsx)(u().sA,{id:"collectionFilterMenuRow.propertyConjunction.label",defaultMessage:" "}),(0,V.jsx)(O,{filter:t.filter,schema:e,property:t.property,parentStore:m,collectionViewId:b,collectionContextStore:v,collectionViewType:S,onChange:e=>{const o={...t,filter:e};null==C||C(y,o)},isArrayFilter:!1})]})}},890801:(e,t,o)=>{o.d(t,{A:()=>Q,j:()=>J});o(898992),o(354520),o(581454);var r=o(296540),n=()=>o(726637),i=()=>o(484714),l=()=>o(56366),a=()=>o(401497),s=()=>o(729108),c=()=>o(764880),d=()=>o(754195);var p=()=>o(431955),u=()=>o(214388),x=()=>o(898244),f=()=>o(713998),h=()=>o(784892),g=()=>o(597777),m=()=>o(681873),y=()=>o(799829),v=()=>o(437607),S=()=>o(69708),C=()=>o(534177),j=()=>o(284371),b=()=>o(436696),M=()=>o(755022),w=()=>o(170356),A=()=>o(448061),V=()=>o(184979),T=()=>o(972435),F=()=>o(44935),I=()=>o(297872),P=()=>o(623580),_=()=>o(419357),k=o(474848);const O=(0,S().YK)({value:{defaultMessage:"Value",id:"database.filterAndSort.propertyValueInput.placeholder"}});function R({value:e,onChange:t}){const{device:o}=(0,i().v3)(),n=(0,r.useRef)(null),[l,s]=(0,r.useState)(!1),c=(0,r.useCallback)((()=>s(!0)),[s]),d=(0,r.useCallback)((()=>s(!1)),[s]),p=(0,r.useCallback)((e=>{t(e.target.value)}),[t]),u=(0,r.useCallback)((()=>{if(n.current){var e;(null===(e=window)||void 0===e?void 0:e.document.activeElement)===n.current&&n.current.blur(),d()}}),[d]),x=(0,a().IS)((e=>({focused:{background:e.buttonHoveredBackground},unfocused:{background:"transparent"}})),[]),f=e||"";return(0,k.jsx)("div",{style:{display:"flex",margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},onClick:c,children:o.isMobile?(0,k.jsx)(_().Ay,{value:f,onChange:p,placeholder:T().A.formatMessage(O.value),onBlur:d,rightMobileEditLabel:(0,k.jsx)(S().sA,{defaultMessage:"Edit",id:"database.filterAndSort.mobileEditButton.label"}),textWrapperStyle:{marginInlineStart:48}}):(0,k.jsx)(F().H,{action:c,render:e=>(0,k.jsx)("div",{ref:e.ref,onMouseEnter:e.onMouseEnter,style:{...e.focused&&!l?x.focused:x.unfocused,margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},children:(0,k.jsx)(I().A,{capture:l,render:e=>(0,k.jsx)("div",{...e,style:{margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},children:(0,k.jsx)(P().A,{focus:l,ref:n,value:f,onChange:p,placeholder:T().A.formatMessage(O.value),onBlur:d,onCancel:u,style:{marginInlineEnd:8,paddingInlineStart:6,paddingInlineEnd:0,width:80,height:30,...{margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},minWidth:V().G$}})})})})})})}var z=()=>o(760217),B=()=>o(406699),D=()=>o(933117),G=()=>o(448693),U=()=>o(27356),K=()=>o(654734),E=()=>o(272630),H=()=>o(204358),$=()=>o(903400),L=()=>o(399762),N=()=>o(722872),W=()=>o(685889),Y=()=>o(543665),q=()=>o(649746),X=()=>o(249947);const Z=(0,S().YK)({dateTitle:{defaultMessage:"Date",id:"database.filterMenu.mobileDateSelectMenu.title"},emptyPlaceholder:{defaultMessage:"Empty",id:"database.filterMenu.dateSelectMenu.emptyPlaceholder"}});function J(e){return e?(0,k.jsx)(S().sA,{defaultMessage:"Select one",id:"database.personPropertyValue.selectPersonOrGroup.searchPlaceholderWithLimit"}):(0,k.jsx)(S().sA,{defaultMessage:"Select as many as you like",id:"database.personPropertyValue.selectPersonOrGroup.searchPlaceholder"})}const Q=function({schema:e,property:t,parentStore:r,filter:n,collectionViewId:l,filterValueType:a,onChange:s,collectionContextStore:c,collectionViewType:d}){const p=(0,i().v3)(),x=(0,S().tz)(),f=(0,k.jsx)("span",{});if("date"===a)return(0,o(335452).n)(n)?(0,u().fZ)(n)?f:(0,u().Cw)(n)?(0,k.jsx)(se,{intl:x,parentStore:r,schema:e,collectionViewId:l,property:t,onChange:s,collectionContextStore:c,collectionViewType:d,filter:n}):(0,k.jsx)(ae,{intl:x,collectionViewId:l,property:t,schema:e,parentStore:r,onChange:s,collectionContextStore:c,collectionViewType:d,filter:n}):f;if("text"===a){if(!(0,o(662149).Y)(n))return f;const e=n;if((0,u().fZ)(e))return f;if("string_has_no_alphabet_prefix"===e.operator)return null;const t=e.value;return(0,k.jsx)(R,{value:t.value,onChange:t=>{const o={type:"exact",value:t},r={...e,value:o};s(r)}})}if("number"===a){if(!(0,o(343462).M)(n))return f;const e=n;if((0,u().fZ)(e))return f;const t=e.value;return(0,k.jsx)(R,{value:void 0===t.value?"":t.value.toString(),onChange:t=>{const r={type:"exact",value:(0,o(668766).q)(t,x)},n={...e,value:r};s(n)}})}if("checkbox"===a){if(!(0,u().Ui)(n)||!l)return f;const o=n,i=o.value;return(0,k.jsx)(B().A,{popupType:p.device.isMobile?B().z.SlideUp:B().z.Popup,renderOrigin:e=>(0,k.jsx)(oe,{operatorValue:i,events:e}),render:n=>(0,k.jsx)(X().td,{collectionViewId:l,propertyFilter:{property:t,filter:o},schema:e,onChange:e=>{s(e)},onClose:n.close,parentStore:r,context:X().mL.AdvancedFilter,allowRelativePersonFilter:!0,collectionContextStore:c})})}if("select"===a||"multi_select"===a||"status"===a){if(!((0,u().v0)(n)||(0,u().as)(n)||(0,u().H$)(n))||!l)return f;const o=n;if((0,u().fZ)(o))return f;const i=e[t];if(!i)return f;const a=(0,u().v0)(o)?(0,u().Zl)(o):(0,u().as)(o)?(0,u().SM)(o):(0,u().Wc)(i,(0,u().V6)(o));return(0,k.jsx)(B().A,{popupType:p.device.isMobile?B().z.SlideUp:B().z.Popup,renderOrigin:o=>(0,k.jsx)(le,{schema:e,property:t,operatorValues:a,events:o}),render:n=>(0,k.jsx)(X().td,{collectionViewId:l,propertyFilter:{property:t,filter:o},schema:e,onChange:e=>{s(e)},onClose:n.close,parentStore:r,context:X().mL.AdvancedFilter,allowRelativePersonFilter:!0,collectionContextStore:c})})}if("location"===a){if(!(0,u().G)(n))return f;const o=n,i=(0,u().GK)(o);return(0,k.jsx)(B().A,{popupType:p.device.isMobile?B().z.SlideUp:B().z.Popup,renderOrigin:e=>(0,k.jsx)(ne,{parentStore:r,operatorValues:i,events:e}),render:n=>(0,k.jsx)(X().td,{collectionViewId:l,propertyFilter:{property:t,filter:o},schema:e,onChange:e=>{s(e)},onClose:n.close,parentStore:r,context:X().mL.AdvancedFilter,allowRelativePersonFilter:!0,collectionContextStore:c})})}if("relation"===a){if(!(0,u().Pq)(n)||!l)return f;const o=n;if((0,u().fZ)(o))return f;const i=(0,u().Rh)(o);return(0,k.jsx)(B().A,{popupType:p.device.isMobile?B().z.SlideUp:B().z.Popup,renderOrigin:o=>(0,k.jsx)(pe,{parentStore:r,operatorValues:i,events:o,schema:e,property:t}),render:n=>(0,k.jsx)(X().td,{collectionViewId:l,propertyFilter:{property:t,filter:o},schema:e,onChange:e=>{s(e)},onClose:n.close,parentStore:r,context:X().mL.AdvancedFilter,allowRelativePersonFilter:!0,collectionContextStore:c})})}if("person"===a){if(!(0,o(478367).I)(n)||!l)return f;const i=n;if((0,u().fZ)(i))return f;const a=(0,o(927826).W)(i);return(0,k.jsx)(B().A,{popupType:p.device.isMobile?B().z.SlideUp:B().z.Popup,renderOrigin:e=>(0,k.jsx)(de,{parentStore:r,operatorValues:a,events:e}),render:o=>(0,k.jsx)(X().td,{collectionViewId:l,propertyFilter:{property:t,filter:i},schema:e,onChange:e=>{s(e)},onClose:o.close,parentStore:r,context:X().mL.AdvancedFilter,allowRelativePersonFilter:!0,collectionContextStore:c})})}if("file"===a){if(!(0,u().B6)(n))return f;const e=n;if((0,u().fZ)(e))return f;(0,C().HB)(e)}if("verification"===a)return(0,u().uU)(n)?(0,k.jsx)(B().A,{popupType:p.device.isMobile?B().z.SlideUp:B().z.Popup,renderOrigin:e=>(0,k.jsx)(re,{operatorValues:(0,u().ms)(n),events:e}),render:o=>(0,k.jsx)(X().td,{collectionViewId:l,propertyFilter:{property:t,filter:n},schema:e,onChange:e=>{s(e)},onClose:o.close,parentStore:r,context:X().mL.AdvancedFilter,allowRelativePersonFilter:!1,collectionContextStore:c})}):f;if("place"===a){if(!(0,u().Ol)(n))return f;const e=n;if((0,u().fZ)(e))return f;(0,C().HB)(e)}(0,C().HB)(a)};function ee(){return{maxWidth:V().tv}}function te(e){return{paddingTop:e?6:void 0,overflow:"hidden"}}function oe({operatorValue:e,events:t}){const o=null==e?void 0:e.value;return(0,k.jsx)(E().A,{...t,disableMargins:!0,placeholder:(0,k.jsx)(S().sA,{defaultMessage:"Select a value",id:"database.filterOperatorValue.checkboxPlaceholder.title"}),title:"boolean"==typeof o&&(0,k.jsx)(s().S,{checked:o,size:16,disabled:!0})})}function re({operatorValues:e,events:t}){const o=e.filter((({value:e})=>Boolean(e))).map(q().w0);return(0,k.jsx)(E().A,{...t,disableMargins:!0,placeholder:(0,k.jsx)(S().sA,{defaultMessage:"Select an option",id:"CollectionFilterMenuFilterOperatorValue.verificationFilterSelect.placeholder"}),title:o.length&&(0,k.jsx)("span",{children:(0,m().G)(o,(e=>(0,k.jsx)("span",{style:{whiteSpace:"pre"},children:(0,k.jsx)(S().sA,{defaultMessage:", ",id:"CollectionFilterMenuFilterOperatorValue.verificationFilterSelect.commaSeparator"})},e)))})})}function ne({operatorValues:e,events:t,parentStore:o}){return(0,k.jsx)(E().A,{...t,disableMargins:!0,desktopStyle:ee(),innerStyle:te(e.length>0),placeholder:(0,k.jsx)(S().sA,{defaultMessage:"Select a location",id:"databaseLocationOperators.selectPlaceholder"}),title:e.length>0&&e.map((e=>e.value&&(0,k.jsx)("div",{style:{marginTop:0,marginInlineEnd:10,marginBottom:6,marginInlineStart:0},children:(0,k.jsx)(A().A,{collectionStore:Y().m.createChildStore(o,{table:"collection",id:e.value})})},e.value)))})}function ie({operatorValue:e,events:t,isRange:o,schema:r,property:n}){const i=r[n],l=i&&"date"===i.type?i.date_format:void 0;let a;if("exact"===e.type&&e.value)if((0,g().$P)(e.value))a=e.value;else if((0,g().jS)(e.value)){const t=(0,g().dq)(e.value);t&&(a=t.value)}return(0,k.jsx)(E().A,{...t,placeholder:o?(0,k.jsx)(S().sA,{defaultMessage:"Select a range",id:"database.filterAndSort.dateRangePropertyValue.placeholder"}):(0,k.jsx)(S().sA,{defaultMessage:"Select a date",id:"database.filterAndSort.datePropertyValue.placeholder"}),desktopStyle:{minWidth:165},title:a&&(0,k.jsx)("span",{style:{...j().RC},children:(0,k.jsx)(K().A,{value:a,dateFormat:l||g().vz})}),disableMargins:!0})}function le({operatorValues:e,events:t,schema:o,property:r}){const n=(0,i().v3)(),{device:l}=n,a=o[r],s=a&&((0,x().lx)(a)||"status"===a.type)&&a.options||[];return(0,k.jsx)(E().A,{...t,disableMargins:!0,desktopStyle:ee(),innerStyle:te(e.length>0),placeholder:(0,k.jsx)(S().sA,{defaultMessage:"Select an option",id:"collections.operatorValueSelect.placeholder"}),title:e.length>0&&(0,k.jsx)(k.Fragment,{children:e.map((e=>{if(void 0===e.value)return null;const t=(0,f().jy)(s,e.value);return t?(0,k.jsx)(L().O,{format:l.isMobile?h().NY.Large:h().NY.Medium,isSingle:!1,value:t.value,color:t.color,showRemoveButton:!1},e.value):null}))})})}function ae({filter:e,intl:t,collectionViewId:o,property:r,schema:n,parentStore:l,onChange:a,collectionContextStore:s,collectionViewType:c}){const p=(0,i().v3)();if(!o)return null;const u={menuTitle:t.formatMessage(Z.dateTitle),items:d().ty,getKey:e=>"relative"===e.type?e.value:e.type,selectedItem:e.value,onSelect:t=>{const o={...e,value:t};a(o),s?(0,b().X)({environment:p,collectionContextStore:s,action:"set_filter_value_type"}):(0,M().D)(p,{view_type:c,action:"set_filter_value_type"})},renderItem:e=>(0,k.jsx)(z().A,{title:(0,q().RR)(e.value),...e}),renderOrigin:o=>(0,k.jsx)(E().A,{...o,disableMargins:!0,placeholder:t.formatMessage(Z.emptyPlaceholder),title:(0,q().RR)(e.value)})},x=e.value;if("exact"===x.type){const t=(0,k.jsx)(S().sA,{id:"collectionFilterMenuFilterOperatorValue.date.exact.order",defaultMessage:"{exact}{dateValue}",values:{exact:(0,k.jsx)(D().A,{...u,menuTypeOverride:(0,N().PK)()},"date-filter-value-type"),dateValue:(0,k.jsx)(B().A,{popupType:p.device.isMobile?B().z.SlideUp:B().z.Popup,renderOrigin:e=>(0,k.jsx)(ie,{schema:n,property:r,operatorValue:x,events:e,isRange:!1}),render:t=>(0,k.jsx)(X().td,{collectionViewId:o,propertyFilter:{property:r,filter:e},schema:n,onChange:e=>{a(e)},onClose:t.close,parentStore:l,context:X().mL.AdvancedFilter,allowRelativePersonFilter:!0,collectionContextStore:s})})}}),i=p.device.isDesktop?{display:"grid",justifyContent:"stretch",gridTemplateColumns:"1fr 1fr",gridColumnGap:w().NS,width:"100%"}:void 0;return(0,k.jsx)("div",{style:i,children:t})}return(0,k.jsx)(D().A,{...u,menuTypeOverride:(0,N().PK)()},"date-filter-value-type")}function se({filter:e,intl:t,parentStore:o,schema:r,collectionViewId:n,property:l,onChange:a,collectionContextStore:s,collectionViewType:c}){const u=(0,i().v3)();if(!n)return null;const x={menuTitle:t.formatMessage(Z.dateTitle),items:d().py,getKey:e=>(0,p().q)(e),selectedItem:e.value,onSelect:t=>{const o={...e,value:t};a(o),s?(0,b().X)({environment:u,collectionContextStore:s,action:"set_filter_value_type"}):(0,M().D)(u,{view_type:c,action:"set_filter_value_type"})},renderItem:e=>(0,k.jsx)(z().A,{title:(0,q().kz)(e.value),...e}),renderOrigin:o=>(0,k.jsx)(E().A,{...o,disableMargins:!0,placeholder:t.formatMessage(Z.emptyPlaceholder),title:(0,q().kz)(e.value)})},f=e.value;if("exact"===f.type){const t=(0,k.jsx)(S().sA,{id:"collectionFilterMenuFilterOperatorValue.dateRange.exact.order",defaultMessage:"{dateValue}",values:{exact:(0,k.jsx)(D().A,{...x,menuTypeOverride:(0,N().PK)()},"date-filter-value-type"),dateValue:(0,k.jsx)(B().A,{popupType:u.device.isMobile?B().z.SlideUp:B().z.Popup,renderOrigin:e=>(0,k.jsx)(ie,{schema:r,property:l,operatorValue:f,events:e,isRange:!0}),render:t=>(0,k.jsx)(X().td,{collectionViewId:n,propertyFilter:{property:l,filter:e},schema:r,onChange:e=>{a(e)},onClose:t.close,parentStore:o,context:X().mL.AdvancedFilter,allowRelativePersonFilter:!0,collectionContextStore:s})})}}),i=u.device.isDesktop?{display:"grid",justifyContent:"stretch",gridTemplateColumns:"1fr 1fr",gridColumnGap:w().NS,width:"100%"}:void 0;return(0,k.jsx)("div",{style:i,children:t})}return"relative"!==f.type||"custom"!==f.value&&"surrounding"!==f.value?(0,k.jsx)(D().A,{...x,menuTypeOverride:(0,N().PK)()},"date-filter-value-type"):(0,k.jsx)($().i,{renderAsQueryDropdown:u.device.isMobile,filter:f,onUpdate:t=>{const o={...e,value:t};a(o),s?(0,b().X)({environment:u,collectionContextStore:s,action:"set_filter_value_type"}):(0,M().D)(u,{view_type:c,action:"set_filter_value_type"})}})}function ce({operatorValue:e,parentStore:t}){var o;const r=(0,i().v3)(),{device:a}=r,s=(0,l().K8)((()=>e.value&&("relative"!==e.type||"me"!==e.value)&&(0,c().Pu)(e.value)?(0,c().xC)({pointer:e.value,getRecordValue:t.getRecordValue}):void 0),[e,t]);if(!e.value)return null;if("me"!==e.value&&e.value.table===v().n){const o=(0,v().S4)({spacePermissionGroupId:e.value.id,spaceId:e.value.spaceId});return(0,k.jsx)(U().UISpacePermissionGroupToken,{parentStore:t,groupPointer:o,isSingle:!1,shouldShrink:!1,format:n().A.isMobile?G().t_.Format.Large:G().t_.Format.Medium,showRemoveButton:!1},o.id)}return"relative"===e.type&&"me"===e.value?(0,k.jsx)("span",{style:{marginTop:1,marginInlineEnd:10,marginBottom:6},children:(0,k.jsx)(S().sA,{defaultMessage:"Me",id:"database.filterAndSort.firstPersonPropertyValue.title"},"relative")}):s?(0,k.jsx)(G().Ay,{actor:s,isSingle:!1,shouldShrink:!1,format:a.isMobile?G().t_.Format.Large:G().t_.Format.Medium,showRemoveButton:!1,hasPersonHoverCard:!1},null===(o=s.asActor)||void 0===o?void 0:o.id):null}function de({operatorValues:e,events:t,parentStore:o}){return(0,k.jsx)(E().A,{...t,placeholder:J(void 0),disableMargins:!0,desktopStyle:ee(),innerStyle:te(e.length>0),title:e.length>0&&e.map((e=>{var t;return(0,k.jsx)(ce,{operatorValue:e,parentStore:o},`${e.type}__${"me"===e.value?"me":null===(t=e.value)||void 0===t?void 0:t.id}`)}))})}function pe({operatorValues:e,events:t,parentStore:o,schema:r,property:n}){const s=(0,a().DP)(),c=(0,i().v3)(),{device:d}=c,p=r[n],u=(0,l().K8)((()=>{if(p&&(0,x().nC)(p))return(0,W().LQ)(p,o)}),[p,o]);return(0,k.jsx)(E().A,{...t,disableMargins:!0,desktopStyle:ee(),innerStyle:te(e.length>0),placeholder:(0,k.jsx)(S().sA,{defaultMessage:"Select a page",id:"databaseRelationOperators.selectPlaceholder"}),title:e.length>0&&e.map(((e,t)=>{if(!e.value)return null;const r=e.type,n={isSingle:!1,shouldShrink:!1,format:d.isMobile?h().NY.Large:h().NY.Medium};if("exact"===r)return(0,k.jsx)(H().A,{blockId:e.value,parentStore:o,...n},e.value);if("relative"===r){if("builtin"===e.value.type)return u?(0,k.jsx)(h().Ay,{value:(0,k.jsx)(S().sA,{...y().n$[u][e.value.variable].messageDescriptor}),backgroundColor:"transparent",theme:s,...n},t):null;if("current_page_in_related_collection"===e.value.type)return(0,k.jsx)(h().Ay,{value:(0,k.jsx)(S().sA,{defaultMessage:"This page",id:"database.filterAndSort.currentPagePropertyValue.title"}),backgroundColor:"transparent",theme:s,...n},t)}else(0,C().HB)(r)}))})}},904789:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>n,squareOnSquarePlusIcon:()=>i});o(296540);var r=o(474848);const n={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.51 15.51",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M12 8.875c.345 0 .625.28.625.625v1.875H14.5a.625.625 0 1 1 0 1.25h-1.875V14.5a.625.625 0 1 1-1.25 0v-1.875H9.5a.625.625 0 1 1 0-1.25h1.875V9.5c0-.345.28-.625.625-.625"}),(0,r.jsx)("path",{d:"M4.5 2.375A2.125 2.125 0 0 0 2.375 4.5V12c0 1.174.951 2.125 2.125 2.125h1.625v1.625c0 1.174.951 2.125 2.125 2.125h7.5a2.125 2.125 0 0 0 2.125-2.125v-7.5a2.125 2.125 0 0 0-2.125-2.125h-1.625V4.5A2.125 2.125 0 0 0 12 2.375zm8.375 3.75H8.25A2.125 2.125 0 0 0 6.125 8.25v4.625H4.5A.875.875 0 0 1 3.625 12V4.5c0-.483.392-.875.875-.875H12c.483 0 .875.392.875.875zm-5.5 2.125c0-.483.392-.875.875-.875h7.5c.483 0 .875.392.875.875v7.5a.875.875 0 0 1-.875.875h-7.5a.875.875 0 0 1-.875-.875z"})]})},i=(0,o(340498).wt)("squareOnSquarePlus",n)},992510:(e,t,o)=>{o.d(t,{A:()=>l});o(296540);var r=()=>o(69708),n=()=>o(250202),i=o(474848);const l=function(e){const t=(0,o(484714).v3)(),{device:l}=t;if(l.isMobile)return e.propertySchema?(0,i.jsx)(n().G,{propertySchema:e.propertySchema,onClick:e.onClick,focused:!1,format:n().e.Name,showExtensionArrow:!e.disabled}):(0,i.jsx)(o(760217).A,{focused:!1,title:(0,i.jsx)(r().sA,{defaultMessage:"Property",id:"database.mobileFilterAndSortMenu.property.buttonMenuItem.label"})});{const t=e.propertySchema&&(0,i.jsx)(o(398217).mA,{propertySchema:e.propertySchema,showIcon:!0,style:{lineHeight:1.4}}),n=(0,i.jsx)(r().sA,{defaultMessage:"Property",id:"database.filterAndSortMenu.propertyButton.label"});return(0,i.jsx)(o(272630).A,{title:t,placeholder:n,onClick:e.onClick,disabled:e.disabled,disableMargins:e.disableMargins,desktopStyle:e.textWrapperStyle})}}}}]);